Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 521.9971308708191
Epoch: 1, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.909 Vali Acc: 0.251 Test Loss: 1.909 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 506.68778944015503
Epoch: 2, Steps: 17 | Train Loss: 1.920 Vali Loss: 2.352 Vali Acc: 0.243 Test Loss: 2.352 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 478.56575655937195
Epoch: 3, Steps: 17 | Train Loss: 2.014 Vali Loss: 2.058 Vali Acc: 0.232 Test Loss: 2.058 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 475.2525267601013
Epoch: 4, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.767 Vali Acc: 0.262 Test Loss: 1.767 Test Acc: 0.262
Validation loss decreased (-0.250931 --> -0.262340).  Saving model ...
Epoch: 5 cost time: 467.21524715423584
Epoch: 5, Steps: 17 | Train Loss: 2.028 Vali Loss: 2.484 Vali Acc: 0.240 Test Loss: 2.484 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 482.5834746360779
Epoch: 6, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.191 Vali Acc: 0.266 Test Loss: 2.191 Test Acc: 0.266
Validation loss decreased (-0.262340 --> -0.266138).  Saving model ...
Epoch: 7 cost time: 481.6027274131775
Epoch: 7, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.911 Vali Acc: 0.266 Test Loss: 1.911 Test Acc: 0.266
Validation loss decreased (-0.266138 --> -0.266141).  Saving model ...
Epoch: 8 cost time: 490.2832052707672
Epoch: 8, Steps: 17 | Train Loss: 1.598 Vali Loss: 2.086 Vali Acc: 0.240 Test Loss: 2.086 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 487.964896440506
Epoch: 9, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.818 Vali Acc: 0.255 Test Loss: 1.818 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 484.0889048576355
Epoch: 10, Steps: 17 | Train Loss: 1.747 Vali Loss: 2.250 Vali Acc: 0.262 Test Loss: 2.250 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 521.7234907150269
Epoch: 11, Steps: 17 | Train Loss: 1.551 Vali Loss: 2.454 Vali Acc: 0.247 Test Loss: 2.454 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 521.6272232532501
Epoch: 12, Steps: 17 | Train Loss: 1.266 Vali Loss: 2.775 Vali Acc: 0.247 Test Loss: 2.775 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 520.5491721630096
Epoch: 13, Steps: 17 | Train Loss: 1.076 Vali Loss: 2.341 Vali Acc: 0.274 Test Loss: 2.341 Test Acc: 0.274
Validation loss decreased (-0.266141 --> -0.273741).  Saving model ...
Epoch: 14 cost time: 515.0851049423218
Epoch: 14, Steps: 17 | Train Loss: 1.072 Vali Loss: 2.662 Vali Acc: 0.251 Test Loss: 2.662 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 520.9659752845764
Epoch: 15, Steps: 17 | Train Loss: 0.939 Vali Loss: 3.033 Vali Acc: 0.243 Test Loss: 3.033 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 514.7449972629547
Epoch: 16, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.946 Vali Acc: 0.278 Test Loss: 2.946 Test Acc: 0.278
Validation loss decreased (-0.273741 --> -0.277537).  Saving model ...
Epoch: 17 cost time: 482.2547342777252
Epoch: 17, Steps: 17 | Train Loss: 0.553 Vali Loss: 3.002 Vali Acc: 0.259 Test Loss: 3.002 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 482.77422642707825
Epoch: 18, Steps: 17 | Train Loss: 0.501 Vali Loss: 3.176 Vali Acc: 0.255 Test Loss: 3.176 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 481.546861410141
Epoch: 19, Steps: 17 | Train Loss: 0.488 Vali Loss: 3.785 Vali Acc: 0.259 Test Loss: 3.785 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 477.54444909095764
Epoch: 20, Steps: 17 | Train Loss: 0.428 Vali Loss: 4.516 Vali Acc: 0.247 Test Loss: 4.516 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 479.78150820732117
Epoch: 21, Steps: 17 | Train Loss: 0.400 Vali Loss: 4.709 Vali Acc: 0.266 Test Loss: 4.709 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 469.0978479385376
Epoch: 22, Steps: 17 | Train Loss: 0.323 Vali Loss: 5.165 Vali Acc: 0.247 Test Loss: 5.165 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 478.10992312431335
Epoch: 23, Steps: 17 | Train Loss: 0.396 Vali Loss: 5.877 Vali Acc: 0.251 Test Loss: 5.877 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 472.2598628997803
Epoch: 24, Steps: 17 | Train Loss: 0.438 Vali Loss: 5.676 Vali Acc: 0.228 Test Loss: 5.676 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 478.48742175102234
Epoch: 25, Steps: 17 | Train Loss: 0.283 Vali Loss: 5.949 Vali Acc: 0.255 Test Loss: 5.949 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 461.22108936309814
Epoch: 26, Steps: 17 | Train Loss: 0.177 Vali Loss: 4.169 Vali Acc: 0.247 Test Loss: 4.169 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 75880836
model size : 291.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 156.48536729812622
Epoch: 1, Steps: 17 | Train Loss: 1.626 Vali Loss: 2.525 Vali Acc: 0.255 Test Loss: 2.525 Test Acc: 0.255
Validation loss decreased (inf --> -0.254728).  Saving model ...
Epoch: 2 cost time: 145.94579243659973
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.616 Vali Acc: 0.236 Test Loss: 1.616 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 148.14585185050964
Epoch: 3, Steps: 17 | Train Loss: 1.789 Vali Loss: 2.268 Vali Acc: 0.236 Test Loss: 2.268 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 152.29684853553772
Epoch: 4, Steps: 17 | Train Loss: 1.501 Vali Loss: 3.260 Vali Acc: 0.243 Test Loss: 3.260 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 158.9504189491272
Epoch: 5, Steps: 17 | Train Loss: 2.095 Vali Loss: 2.598 Vali Acc: 0.293 Test Loss: 2.598 Test Acc: 0.293
Validation loss decreased (-0.254728 --> -0.292750).  Saving model ...
Epoch: 6 cost time: 167.01025319099426
Epoch: 6, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.965 Vali Acc: 0.243 Test Loss: 1.965 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 169.28877997398376
Epoch: 7, Steps: 17 | Train Loss: 1.584 Vali Loss: 2.082 Vali Acc: 0.217 Test Loss: 2.082 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 167.35796356201172
Epoch: 8, Steps: 17 | Train Loss: 1.422 Vali Loss: 3.592 Vali Acc: 0.243 Test Loss: 3.592 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 161.40569233894348
Epoch: 9, Steps: 17 | Train Loss: 1.812 Vali Loss: 2.517 Vali Acc: 0.262 Test Loss: 2.517 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 166.39293217658997
Epoch: 10, Steps: 17 | Train Loss: 1.351 Vali Loss: 2.474 Vali Acc: 0.240 Test Loss: 2.474 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 170.06222701072693
Epoch: 11, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.121 Vali Acc: 0.240 Test Loss: 2.121 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 166.23144912719727
Epoch: 12, Steps: 17 | Train Loss: 1.176 Vali Loss: 2.215 Vali Acc: 0.281 Test Loss: 2.215 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 169.05520677566528
Epoch: 13, Steps: 17 | Train Loss: 0.946 Vali Loss: 2.790 Vali Acc: 0.240 Test Loss: 2.790 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 163.67078256607056
Epoch: 14, Steps: 17 | Train Loss: 0.732 Vali Loss: 3.013 Vali Acc: 0.251 Test Loss: 3.013 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 159.89867496490479
Epoch: 15, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.718 Vali Acc: 0.251 Test Loss: 2.718 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 22924676
model size : 89.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 333.6574206352234
Epoch: 1, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.909 Vali Acc: 0.251 Test Loss: 1.909 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 325.094740152359
Epoch: 2, Steps: 17 | Train Loss: 1.920 Vali Loss: 2.352 Vali Acc: 0.243 Test Loss: 2.352 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 331.0663409233093
Epoch: 3, Steps: 17 | Train Loss: 2.014 Vali Loss: 2.058 Vali Acc: 0.232 Test Loss: 2.058 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 319.6600589752197
Epoch: 4, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.767 Vali Acc: 0.262 Test Loss: 1.767 Test Acc: 0.262
Validation loss decreased (-0.250931 --> -0.262340).  Saving model ...
Epoch: 5 cost time: 310.3361039161682
Epoch: 5, Steps: 17 | Train Loss: 2.028 Vali Loss: 2.484 Vali Acc: 0.240 Test Loss: 2.484 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 296.69419527053833
Epoch: 6, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.190 Vali Acc: 0.266 Test Loss: 2.190 Test Acc: 0.266
Validation loss decreased (-0.262340 --> -0.266138).  Saving model ...
Epoch: 7 cost time: 300.4567105770111
Epoch: 7, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.897 Vali Acc: 0.266 Test Loss: 1.897 Test Acc: 0.266
Validation loss decreased (-0.266138 --> -0.266141).  Saving model ...
Epoch: 8 cost time: 306.08482813835144
Epoch: 8, Steps: 17 | Train Loss: 1.565 Vali Loss: 2.230 Vali Acc: 0.247 Test Loss: 2.230 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 297.9609260559082
Epoch: 9, Steps: 17 | Train Loss: 1.509 Vali Loss: 4.402 Vali Acc: 0.251 Test Loss: 4.402 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 320.3142547607422
Epoch: 10, Steps: 17 | Train Loss: 1.486 Vali Loss: 2.136 Vali Acc: 0.285 Test Loss: 2.136 Test Acc: 0.285
Validation loss decreased (-0.266141 --> -0.285150).  Saving model ...
Epoch: 11 cost time: 299.34912300109863
Epoch: 11, Steps: 17 | Train Loss: 1.444 Vali Loss: 2.220 Vali Acc: 0.259 Test Loss: 2.220 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 302.51508045196533
Epoch: 12, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.271 Vali Acc: 0.240 Test Loss: 2.271 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 332.68765020370483
Epoch: 13, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.347 Vali Acc: 0.262 Test Loss: 2.347 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 309.18023586273193
Epoch: 14, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.744 Vali Acc: 0.259 Test Loss: 2.744 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 318.9041941165924
Epoch: 15, Steps: 17 | Train Loss: 0.847 Vali Loss: 3.386 Vali Acc: 0.243 Test Loss: 3.386 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 322.54128646850586
Epoch: 16, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.792 Vali Acc: 0.285 Test Loss: 2.792 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 325.31811785697937
Epoch: 17, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.427 Vali Acc: 0.251 Test Loss: 3.427 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 304.07899951934814
Epoch: 18, Steps: 17 | Train Loss: 0.462 Vali Loss: 3.895 Vali Acc: 0.266 Test Loss: 3.895 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 328.30360102653503
Epoch: 19, Steps: 17 | Train Loss: 0.536 Vali Loss: 4.475 Vali Acc: 0.259 Test Loss: 4.475 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 307.2060718536377
Epoch: 20, Steps: 17 | Train Loss: 0.450 Vali Loss: 4.154 Vali Acc: 0.247 Test Loss: 4.154 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 75880836
model size : 291.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 109.28252482414246
Epoch: 1, Steps: 17 | Train Loss: 1.626 Vali Loss: 2.525 Vali Acc: 0.255 Test Loss: 2.525 Test Acc: 0.255
Validation loss decreased (inf --> -0.254728).  Saving model ...
Epoch: 2 cost time: 101.25043296813965
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.616 Vali Acc: 0.236 Test Loss: 1.616 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 102.17338943481445
Epoch: 3, Steps: 17 | Train Loss: 1.789 Vali Loss: 2.269 Vali Acc: 0.240 Test Loss: 2.269 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 105.72643971443176
Epoch: 4, Steps: 17 | Train Loss: 1.500 Vali Loss: 3.267 Vali Acc: 0.243 Test Loss: 3.267 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 103.98535776138306
Epoch: 5, Steps: 17 | Train Loss: 2.100 Vali Loss: 2.617 Vali Acc: 0.289 Test Loss: 2.617 Test Acc: 0.289
Validation loss decreased (-0.254728 --> -0.288947).  Saving model ...
Epoch: 6 cost time: 108.0360209941864
Epoch: 6, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.891 Vali Acc: 0.243 Test Loss: 1.891 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 105.79349875450134
Epoch: 7, Steps: 17 | Train Loss: 1.462 Vali Loss: 2.903 Vali Acc: 0.240 Test Loss: 2.903 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 99.25694227218628
Epoch: 8, Steps: 17 | Train Loss: 1.426 Vali Loss: 3.261 Vali Acc: 0.236 Test Loss: 3.261 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 104.5181131362915
Epoch: 9, Steps: 17 | Train Loss: 1.649 Vali Loss: 3.128 Vali Acc: 0.243 Test Loss: 3.128 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 112.09422779083252
Epoch: 10, Steps: 17 | Train Loss: 1.754 Vali Loss: 2.137 Vali Acc: 0.255 Test Loss: 2.137 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 102.19386768341064
Epoch: 11, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.915 Vali Acc: 0.251 Test Loss: 1.915 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 95.00015139579773
Epoch: 12, Steps: 17 | Train Loss: 1.250 Vali Loss: 2.351 Vali Acc: 0.251 Test Loss: 2.351 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 106.58642578125
Epoch: 13, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.598 Vali Acc: 0.274 Test Loss: 2.598 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 104.52637147903442
Epoch: 14, Steps: 17 | Train Loss: 0.980 Vali Loss: 2.761 Vali Acc: 0.270 Test Loss: 2.761 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 102.8306496143341
Epoch: 15, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.643 Vali Acc: 0.259 Test Loss: 2.643 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 22924676
model size : 89.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 161.30825996398926
Epoch: 1, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.909 Vali Acc: 0.251 Test Loss: 1.909 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 176.64325618743896
Epoch: 2, Steps: 17 | Train Loss: 1.920 Vali Loss: 2.352 Vali Acc: 0.243 Test Loss: 2.352 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 181.80132246017456
Epoch: 3, Steps: 17 | Train Loss: 2.014 Vali Loss: 2.058 Vali Acc: 0.232 Test Loss: 2.058 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 187.2149748802185
Epoch: 4, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.767 Vali Acc: 0.262 Test Loss: 1.767 Test Acc: 0.262
Validation loss decreased (-0.250931 --> -0.262340).  Saving model ...
Epoch: 5 cost time: 186.3878858089447
Epoch: 5, Steps: 17 | Train Loss: 2.028 Vali Loss: 2.484 Vali Acc: 0.240 Test Loss: 2.484 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 186.67109632492065
Epoch: 6, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.191 Vali Acc: 0.266 Test Loss: 2.191 Test Acc: 0.266
Validation loss decreased (-0.262340 --> -0.266138).  Saving model ...
Epoch: 7 cost time: 183.9526240825653
Epoch: 7, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.911 Vali Acc: 0.266 Test Loss: 1.911 Test Acc: 0.266
Validation loss decreased (-0.266138 --> -0.266141).  Saving model ...
Epoch: 8 cost time: 186.03991103172302
Epoch: 8, Steps: 17 | Train Loss: 1.599 Vali Loss: 2.081 Vali Acc: 0.240 Test Loss: 2.081 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 188.67984056472778
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.813 Vali Acc: 0.255 Test Loss: 1.813 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 180.72108578681946
Epoch: 10, Steps: 17 | Train Loss: 1.753 Vali Loss: 2.232 Vali Acc: 0.259 Test Loss: 2.232 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 189.69585967063904
Epoch: 11, Steps: 17 | Train Loss: 1.598 Vali Loss: 2.486 Vali Acc: 0.262 Test Loss: 2.486 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 170.14905834197998
Epoch: 12, Steps: 17 | Train Loss: 1.190 Vali Loss: 2.191 Vali Acc: 0.240 Test Loss: 2.191 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 171.2855441570282
Epoch: 13, Steps: 17 | Train Loss: 1.108 Vali Loss: 2.137 Vali Acc: 0.255 Test Loss: 2.137 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 171.59629106521606
Epoch: 14, Steps: 17 | Train Loss: 0.860 Vali Loss: 2.382 Vali Acc: 0.221 Test Loss: 2.382 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 168.1125249862671
Epoch: 15, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.817 Vali Acc: 0.236 Test Loss: 2.817 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 170.66461896896362
Epoch: 16, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.711 Vali Acc: 0.209 Test Loss: 2.711 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 170.3983669281006
Epoch: 17, Steps: 17 | Train Loss: 0.517 Vali Loss: 3.419 Vali Acc: 0.278 Test Loss: 3.419 Test Acc: 0.278
Validation loss decreased (-0.266141 --> -0.277532).  Saving model ...
Epoch: 18 cost time: 173.39928698539734
Epoch: 18, Steps: 17 | Train Loss: 0.691 Vali Loss: 4.027 Vali Acc: 0.243 Test Loss: 4.027 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 166.81893610954285
Epoch: 19, Steps: 17 | Train Loss: 0.606 Vali Loss: 3.894 Vali Acc: 0.262 Test Loss: 3.894 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 187.61429119110107
Epoch: 20, Steps: 17 | Train Loss: 0.485 Vali Loss: 5.211 Vali Acc: 0.221 Test Loss: 5.211 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 178.44133687019348
Epoch: 21, Steps: 17 | Train Loss: 0.440 Vali Loss: 5.520 Vali Acc: 0.213 Test Loss: 5.520 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 189.36995100975037
Epoch: 22, Steps: 17 | Train Loss: 0.354 Vali Loss: 6.335 Vali Acc: 0.262 Test Loss: 6.335 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 190.91304111480713
Epoch: 23, Steps: 17 | Train Loss: 0.395 Vali Loss: 4.910 Vali Acc: 0.202 Test Loss: 4.910 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 182.44463801383972
Epoch: 24, Steps: 17 | Train Loss: 0.560 Vali Loss: 5.556 Vali Acc: 0.221 Test Loss: 5.556 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 192.64596557617188
Epoch: 25, Steps: 17 | Train Loss: 0.324 Vali Loss: 4.749 Vali Acc: 0.289 Test Loss: 4.749 Test Acc: 0.289
Validation loss decreased (-0.277532 --> -0.288926).  Saving model ...
Epoch: 26 cost time: 187.55921721458435
Epoch: 26, Steps: 17 | Train Loss: 0.220 Vali Loss: 4.593 Vali Acc: 0.232 Test Loss: 4.593 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 189.54766201972961
Epoch: 27, Steps: 17 | Train Loss: 0.194 Vali Loss: 6.085 Vali Acc: 0.259 Test Loss: 6.085 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 186.55829000473022
Epoch: 28, Steps: 17 | Train Loss: 0.166 Vali Loss: 8.144 Vali Acc: 0.270 Test Loss: 8.144 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 187.45560932159424
Epoch: 29, Steps: 17 | Train Loss: 0.181 Vali Loss: 7.351 Vali Acc: 0.285 Test Loss: 7.351 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 173.40477538108826
Epoch: 30, Steps: 17 | Train Loss: 0.263 Vali Loss: 5.690 Vali Acc: 0.236 Test Loss: 5.690 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 75880836
model size : 291.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 66.79856896400452
Epoch: 1, Steps: 17 | Train Loss: 1.626 Vali Loss: 2.525 Vali Acc: 0.255 Test Loss: 2.525 Test Acc: 0.255
Validation loss decreased (inf --> -0.254728).  Saving model ...
Epoch: 2 cost time: 67.72295355796814
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.617 Vali Acc: 0.236 Test Loss: 1.617 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 63.34131741523743
Epoch: 3, Steps: 17 | Train Loss: 1.789 Vali Loss: 2.268 Vali Acc: 0.236 Test Loss: 2.268 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 63.99283742904663
Epoch: 4, Steps: 17 | Train Loss: 1.501 Vali Loss: 3.255 Vali Acc: 0.243 Test Loss: 3.255 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 62.13200378417969
Epoch: 5, Steps: 17 | Train Loss: 2.090 Vali Loss: 2.580 Vali Acc: 0.293 Test Loss: 2.580 Test Acc: 0.293
Validation loss decreased (-0.254728 --> -0.292750).  Saving model ...
Epoch: 6 cost time: 59.66645836830139
Epoch: 6, Steps: 17 | Train Loss: 1.768 Vali Loss: 2.089 Vali Acc: 0.240 Test Loss: 2.089 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 64.66414666175842
Epoch: 7, Steps: 17 | Train Loss: 1.562 Vali Loss: 2.120 Vali Acc: 0.274 Test Loss: 2.120 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 66.34523391723633
Epoch: 8, Steps: 17 | Train Loss: 1.315 Vali Loss: 3.273 Vali Acc: 0.228 Test Loss: 3.273 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 70.48302602767944
Epoch: 9, Steps: 17 | Train Loss: 1.841 Vali Loss: 2.859 Vali Acc: 0.255 Test Loss: 2.859 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 67.4936876296997
Epoch: 10, Steps: 17 | Train Loss: 1.375 Vali Loss: 2.285 Vali Acc: 0.232 Test Loss: 2.285 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 66.75011324882507
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 2.103 Vali Acc: 0.266 Test Loss: 2.103 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 63.26986575126648
Epoch: 12, Steps: 17 | Train Loss: 1.054 Vali Loss: 2.445 Vali Acc: 0.262 Test Loss: 2.445 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 61.45912718772888
Epoch: 13, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.342 Vali Acc: 0.281 Test Loss: 2.342 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 71.60619950294495
Epoch: 14, Steps: 17 | Train Loss: 0.781 Vali Loss: 3.060 Vali Acc: 0.262 Test Loss: 3.060 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 69.59116268157959
Epoch: 15, Steps: 17 | Train Loss: 0.870 Vali Loss: 3.312 Vali Acc: 0.247 Test Loss: 3.312 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 22924676
model size : 89.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 208.01928687095642
Epoch: 1, Steps: 17 | Train Loss: 1.792 Vali Loss: 2.512 Vali Acc: 0.259 Test Loss: 2.512 Test Acc: 0.259
Validation loss decreased (inf --> -0.258530).  Saving model ...
Epoch: 2 cost time: 234.2592854499817
Epoch: 2, Steps: 17 | Train Loss: 2.025 Vali Loss: 2.238 Vali Acc: 0.243 Test Loss: 2.238 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 223.71053075790405
Epoch: 3, Steps: 17 | Train Loss: 2.169 Vali Loss: 1.609 Vali Acc: 0.262 Test Loss: 1.609 Test Acc: 0.262
Validation loss decreased (-0.258530 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 236.4849123954773
Epoch: 4, Steps: 17 | Train Loss: 1.774 Vali Loss: 2.045 Vali Acc: 0.217 Test Loss: 2.045 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 229.89601230621338
Epoch: 5, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.906 Vali Acc: 0.232 Test Loss: 1.906 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 234.76712846755981
Epoch: 6, Steps: 17 | Train Loss: 1.807 Vali Loss: 3.044 Vali Acc: 0.251 Test Loss: 3.044 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 235.7568166255951
Epoch: 7, Steps: 17 | Train Loss: 2.323 Vali Loss: 2.093 Vali Acc: 0.224 Test Loss: 2.093 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 228.70322728157043
Epoch: 8, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.903 Vali Acc: 0.262 Test Loss: 1.903 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 234.52157735824585
Epoch: 9, Steps: 17 | Train Loss: 1.337 Vali Loss: 2.353 Vali Acc: 0.259 Test Loss: 2.353 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 234.82992219924927
Epoch: 10, Steps: 17 | Train Loss: 1.611 Vali Loss: 2.330 Vali Acc: 0.247 Test Loss: 2.330 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 229.2161738872528
Epoch: 11, Steps: 17 | Train Loss: 1.191 Vali Loss: 2.256 Vali Acc: 0.251 Test Loss: 2.256 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 224.36731100082397
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 2.232 Vali Acc: 0.240 Test Loss: 2.232 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 207.33308243751526
Epoch: 13, Steps: 17 | Train Loss: 0.981 Vali Loss: 2.374 Vali Acc: 0.243 Test Loss: 2.374 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 38391172
model size : 148.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 85.93191194534302
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.982 Vali Acc: 0.251 Test Loss: 1.982 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 85.51537466049194
Epoch: 2, Steps: 17 | Train Loss: 2.004 Vali Loss: 2.904 Vali Acc: 0.247 Test Loss: 2.904 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 81.70581126213074
Epoch: 3, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.756 Vali Acc: 0.289 Test Loss: 1.756 Test Acc: 0.289
Validation loss decreased (-0.250931 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 85.54999041557312
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 2.519 Vali Acc: 0.255 Test Loss: 2.519 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 86.23961925506592
Epoch: 5, Steps: 17 | Train Loss: 1.731 Vali Loss: 2.381 Vali Acc: 0.247 Test Loss: 2.381 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 88.54378938674927
Epoch: 6, Steps: 17 | Train Loss: 1.861 Vali Loss: 2.760 Vali Acc: 0.243 Test Loss: 2.760 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 84.86404371261597
Epoch: 7, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.877 Vali Acc: 0.228 Test Loss: 1.877 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 86.96285343170166
Epoch: 8, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.702 Vali Acc: 0.236 Test Loss: 2.702 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 84.57393527030945
Epoch: 9, Steps: 17 | Train Loss: 1.564 Vali Loss: 2.456 Vali Acc: 0.259 Test Loss: 2.456 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 86.01177287101746
Epoch: 10, Steps: 17 | Train Loss: 1.460 Vali Loss: 2.055 Vali Acc: 0.274 Test Loss: 2.055 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 86.11738610267639
Epoch: 11, Steps: 17 | Train Loss: 1.454 Vali Loss: 2.020 Vali Acc: 0.274 Test Loss: 2.020 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 88.16232371330261
Epoch: 12, Steps: 17 | Train Loss: 1.128 Vali Loss: 2.558 Vali Acc: 0.243 Test Loss: 2.558 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 87.48920440673828
Epoch: 13, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.236 Vali Acc: 0.232 Test Loss: 2.236 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 11912580
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 162.8739573955536
Epoch: 1, Steps: 17 | Train Loss: 1.792 Vali Loss: 2.512 Vali Acc: 0.259 Test Loss: 2.512 Test Acc: 0.259
Validation loss decreased (inf --> -0.258530).  Saving model ...
Epoch: 2 cost time: 169.45917773246765
Epoch: 2, Steps: 17 | Train Loss: 2.025 Vali Loss: 2.238 Vali Acc: 0.243 Test Loss: 2.238 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 166.6876368522644
Epoch: 3, Steps: 17 | Train Loss: 2.169 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
Validation loss decreased (-0.258530 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 168.8306655883789
Epoch: 4, Steps: 17 | Train Loss: 1.774 Vali Loss: 2.045 Vali Acc: 0.217 Test Loss: 2.045 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 168.71301126480103
Epoch: 5, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.906 Vali Acc: 0.232 Test Loss: 1.906 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 159.71936511993408
Epoch: 6, Steps: 17 | Train Loss: 1.807 Vali Loss: 3.043 Vali Acc: 0.251 Test Loss: 3.043 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 168.632905960083
Epoch: 7, Steps: 17 | Train Loss: 2.321 Vali Loss: 2.095 Vali Acc: 0.224 Test Loss: 2.095 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 162.07247734069824
Epoch: 8, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.897 Vali Acc: 0.262 Test Loss: 1.897 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 165.7643527984619
Epoch: 9, Steps: 17 | Train Loss: 1.336 Vali Loss: 2.352 Vali Acc: 0.259 Test Loss: 2.352 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 156.11408376693726
Epoch: 10, Steps: 17 | Train Loss: 1.618 Vali Loss: 2.341 Vali Acc: 0.247 Test Loss: 2.341 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 158.21811437606812
Epoch: 11, Steps: 17 | Train Loss: 1.189 Vali Loss: 2.285 Vali Acc: 0.266 Test Loss: 2.285 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266137).  Saving model ...
Epoch: 12 cost time: 158.0448625087738
Epoch: 12, Steps: 17 | Train Loss: 1.202 Vali Loss: 2.911 Vali Acc: 0.247 Test Loss: 2.911 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 155.441814661026
Epoch: 13, Steps: 17 | Train Loss: 1.192 Vali Loss: 2.468 Vali Acc: 0.255 Test Loss: 2.468 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 159.68800020217896
Epoch: 14, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.536 Vali Acc: 0.247 Test Loss: 2.536 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 156.69241333007812
Epoch: 15, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.848 Vali Acc: 0.247 Test Loss: 2.848 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 154.86775851249695
Epoch: 16, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.911 Vali Acc: 0.247 Test Loss: 2.911 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 156.48190641403198
Epoch: 17, Steps: 17 | Train Loss: 0.512 Vali Loss: 2.830 Vali Acc: 0.270 Test Loss: 2.830 Test Acc: 0.270
Validation loss decreased (-0.266137 --> -0.269934).  Saving model ...
Epoch: 18 cost time: 172.67208075523376
Epoch: 18, Steps: 17 | Train Loss: 0.388 Vali Loss: 3.829 Vali Acc: 0.251 Test Loss: 3.829 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 181.07442927360535
Epoch: 19, Steps: 17 | Train Loss: 0.393 Vali Loss: 3.966 Vali Acc: 0.278 Test Loss: 3.966 Test Acc: 0.278
Validation loss decreased (-0.269934 --> -0.277527).  Saving model ...
Epoch: 20 cost time: 171.27646780014038
Epoch: 20, Steps: 17 | Train Loss: 0.293 Vali Loss: 5.015 Vali Acc: 0.247 Test Loss: 5.015 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 182.16316080093384
Epoch: 21, Steps: 17 | Train Loss: 0.301 Vali Loss: 4.254 Vali Acc: 0.228 Test Loss: 4.254 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 175.76119184494019
Epoch: 22, Steps: 17 | Train Loss: 0.238 Vali Loss: 4.166 Vali Acc: 0.259 Test Loss: 4.166 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 174.94617009162903
Epoch: 23, Steps: 17 | Train Loss: 0.318 Vali Loss: 5.725 Vali Acc: 0.221 Test Loss: 5.725 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 182.35756659507751
Epoch: 24, Steps: 17 | Train Loss: 0.269 Vali Loss: 5.989 Vali Acc: 0.236 Test Loss: 5.989 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 172.16278076171875
Epoch: 25, Steps: 17 | Train Loss: 0.275 Vali Loss: 5.310 Vali Acc: 0.289 Test Loss: 5.310 Test Acc: 0.289
Validation loss decreased (-0.277527 --> -0.288920).  Saving model ...
Epoch: 26 cost time: 171.95207047462463
Epoch: 26, Steps: 17 | Train Loss: 0.234 Vali Loss: 5.547 Vali Acc: 0.217 Test Loss: 5.547 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 159.19982719421387
Epoch: 27, Steps: 17 | Train Loss: 0.124 Vali Loss: 5.878 Vali Acc: 0.240 Test Loss: 5.878 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 165.48339819908142
Epoch: 28, Steps: 17 | Train Loss: 0.195 Vali Loss: 6.144 Vali Acc: 0.217 Test Loss: 6.144 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 167.93824434280396
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 6.759 Vali Acc: 0.274 Test Loss: 6.759 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 162.76188850402832
Epoch: 30, Steps: 17 | Train Loss: 0.100 Vali Loss: 6.359 Vali Acc: 0.285 Test Loss: 6.359 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 38391172
model size : 148.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 63.05356764793396
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.982 Vali Acc: 0.251 Test Loss: 1.982 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 61.26883602142334
Epoch: 2, Steps: 17 | Train Loss: 2.004 Vali Loss: 2.904 Vali Acc: 0.247 Test Loss: 2.904 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 61.472044706344604
Epoch: 3, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.756 Vali Acc: 0.289 Test Loss: 1.756 Test Acc: 0.289
Validation loss decreased (-0.250931 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 63.393011808395386
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 2.521 Vali Acc: 0.255 Test Loss: 2.521 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 66.3073570728302
Epoch: 5, Steps: 17 | Train Loss: 1.729 Vali Loss: 2.339 Vali Acc: 0.243 Test Loss: 2.339 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 65.855220079422
Epoch: 6, Steps: 17 | Train Loss: 1.853 Vali Loss: 2.751 Vali Acc: 0.240 Test Loss: 2.751 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 65.28549575805664
Epoch: 7, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.952 Vali Acc: 0.236 Test Loss: 1.952 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 63.51894164085388
Epoch: 8, Steps: 17 | Train Loss: 1.606 Vali Loss: 2.682 Vali Acc: 0.236 Test Loss: 2.682 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 61.24121356010437
Epoch: 9, Steps: 17 | Train Loss: 1.527 Vali Loss: 2.665 Vali Acc: 0.240 Test Loss: 2.665 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 61.028868436813354
Epoch: 10, Steps: 17 | Train Loss: 1.563 Vali Loss: 2.368 Vali Acc: 0.270 Test Loss: 2.368 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 63.99414277076721
Epoch: 11, Steps: 17 | Train Loss: 1.473 Vali Loss: 2.261 Vali Acc: 0.266 Test Loss: 2.261 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 63.86807894706726
Epoch: 12, Steps: 17 | Train Loss: 1.183 Vali Loss: 2.094 Vali Acc: 0.247 Test Loss: 2.094 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 62.99204611778259
Epoch: 13, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.139 Vali Acc: 0.270 Test Loss: 2.139 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 11912580
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 98.74186944961548
Epoch: 1, Steps: 17 | Train Loss: 1.792 Vali Loss: 2.512 Vali Acc: 0.259 Test Loss: 2.512 Test Acc: 0.259
Validation loss decreased (inf --> -0.258530).  Saving model ...
Epoch: 2 cost time: 99.26793932914734
Epoch: 2, Steps: 17 | Train Loss: 2.025 Vali Loss: 2.238 Vali Acc: 0.243 Test Loss: 2.238 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 103.66703915596008
Epoch: 3, Steps: 17 | Train Loss: 2.169 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
Validation loss decreased (-0.258530 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 104.96424555778503
Epoch: 4, Steps: 17 | Train Loss: 1.774 Vali Loss: 2.045 Vali Acc: 0.217 Test Loss: 2.045 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 100.61759161949158
Epoch: 5, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.906 Vali Acc: 0.232 Test Loss: 1.906 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 104.64869546890259
Epoch: 6, Steps: 17 | Train Loss: 1.807 Vali Loss: 3.043 Vali Acc: 0.251 Test Loss: 3.043 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 106.93194437026978
Epoch: 7, Steps: 17 | Train Loss: 2.321 Vali Loss: 2.095 Vali Acc: 0.224 Test Loss: 2.095 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 103.5924003124237
Epoch: 8, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.897 Vali Acc: 0.262 Test Loss: 1.897 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 98.21678161621094
Epoch: 9, Steps: 17 | Train Loss: 1.335 Vali Loss: 2.352 Vali Acc: 0.255 Test Loss: 2.352 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 101.73363161087036
Epoch: 10, Steps: 17 | Train Loss: 1.618 Vali Loss: 2.341 Vali Acc: 0.247 Test Loss: 2.341 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 101.42924070358276
Epoch: 11, Steps: 17 | Train Loss: 1.189 Vali Loss: 2.286 Vali Acc: 0.266 Test Loss: 2.286 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266137).  Saving model ...
Epoch: 12 cost time: 102.93519854545593
Epoch: 12, Steps: 17 | Train Loss: 1.200 Vali Loss: 2.900 Vali Acc: 0.247 Test Loss: 2.900 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 101.02378916740417
Epoch: 13, Steps: 17 | Train Loss: 1.196 Vali Loss: 2.433 Vali Acc: 0.255 Test Loss: 2.433 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 97.5825514793396
Epoch: 14, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.434 Vali Acc: 0.236 Test Loss: 2.434 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 97.6992757320404
Epoch: 15, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.787 Vali Acc: 0.251 Test Loss: 2.787 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 96.69066619873047
Epoch: 16, Steps: 17 | Train Loss: 0.687 Vali Loss: 2.893 Vali Acc: 0.262 Test Loss: 2.893 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 88.27344965934753
Epoch: 17, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.840 Vali Acc: 0.293 Test Loss: 2.840 Test Acc: 0.293
Validation loss decreased (-0.266137 --> -0.292747).  Saving model ...
Epoch: 18 cost time: 89.69106483459473
Epoch: 18, Steps: 17 | Train Loss: 0.488 Vali Loss: 3.482 Vali Acc: 0.274 Test Loss: 3.482 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 93.97920107841492
Epoch: 19, Steps: 17 | Train Loss: 0.488 Vali Loss: 4.121 Vali Acc: 0.243 Test Loss: 4.121 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 92.90338921546936
Epoch: 20, Steps: 17 | Train Loss: 0.352 Vali Loss: 4.729 Vali Acc: 0.221 Test Loss: 4.729 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 87.8628032207489
Epoch: 21, Steps: 17 | Train Loss: 0.335 Vali Loss: 4.298 Vali Acc: 0.251 Test Loss: 4.298 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 90.62694144248962
Epoch: 22, Steps: 17 | Train Loss: 0.241 Vali Loss: 4.487 Vali Acc: 0.228 Test Loss: 4.487 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 98.69782257080078
Epoch: 23, Steps: 17 | Train Loss: 0.291 Vali Loss: 4.734 Vali Acc: 0.243 Test Loss: 4.734 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 90.0016758441925
Epoch: 24, Steps: 17 | Train Loss: 0.308 Vali Loss: 5.901 Vali Acc: 0.224 Test Loss: 5.901 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 88.10571885108948
Epoch: 25, Steps: 17 | Train Loss: 0.289 Vali Loss: 4.490 Vali Acc: 0.194 Test Loss: 4.490 Test Acc: 0.194
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 94.20885443687439
Epoch: 26, Steps: 17 | Train Loss: 0.224 Vali Loss: 5.287 Vali Acc: 0.259 Test Loss: 5.287 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 97.93187713623047
Epoch: 27, Steps: 17 | Train Loss: 0.195 Vali Loss: 6.368 Vali Acc: 0.270 Test Loss: 6.368 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 38391172
model size : 148.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 38.58861684799194
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.982 Vali Acc: 0.251 Test Loss: 1.982 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 37.57327461242676
Epoch: 2, Steps: 17 | Train Loss: 2.004 Vali Loss: 2.904 Vali Acc: 0.247 Test Loss: 2.904 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.75308895111084
Epoch: 3, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.756 Vali Acc: 0.289 Test Loss: 1.756 Test Acc: 0.289
Validation loss decreased (-0.250931 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 40.18588995933533
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 2.519 Vali Acc: 0.255 Test Loss: 2.519 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 41.19718790054321
Epoch: 5, Steps: 17 | Train Loss: 1.732 Vali Loss: 2.400 Vali Acc: 0.247 Test Loss: 2.400 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 38.57442831993103
Epoch: 6, Steps: 17 | Train Loss: 1.862 Vali Loss: 2.758 Vali Acc: 0.243 Test Loss: 2.758 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 38.89902901649475
Epoch: 7, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.819 Vali Acc: 0.251 Test Loss: 1.819 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 38.37183499336243
Epoch: 8, Steps: 17 | Train Loss: 1.629 Vali Loss: 2.739 Vali Acc: 0.232 Test Loss: 2.739 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.29937481880188
Epoch: 9, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.841 Vali Acc: 0.270 Test Loss: 1.841 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 35.05662679672241
Epoch: 10, Steps: 17 | Train Loss: 1.313 Vali Loss: 2.012 Vali Acc: 0.297 Test Loss: 2.012 Test Acc: 0.297
Validation loss decreased (-0.288956 --> -0.296558).  Saving model ...
Epoch: 11 cost time: 38.531697034835815
Epoch: 11, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.811 Vali Acc: 0.293 Test Loss: 1.811 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 39.40332508087158
Epoch: 12, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.255 Vali Acc: 0.224 Test Loss: 2.255 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 37.64092516899109
Epoch: 13, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.222 Vali Acc: 0.259 Test Loss: 2.222 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 41.67403793334961
Epoch: 14, Steps: 17 | Train Loss: 1.390 Vali Loss: 3.836 Vali Acc: 0.243 Test Loss: 3.836 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 38.68415856361389
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.577 Vali Acc: 0.255 Test Loss: 2.577 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 35.85096859931946
Epoch: 16, Steps: 17 | Train Loss: 0.978 Vali Loss: 3.056 Vali Acc: 0.262 Test Loss: 3.056 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 38.256508111953735
Epoch: 17, Steps: 17 | Train Loss: 0.998 Vali Loss: 2.672 Vali Acc: 0.240 Test Loss: 2.672 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 32.71367883682251
Epoch: 18, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.668 Vali Acc: 0.300 Test Loss: 2.668 Test Acc: 0.300
Validation loss decreased (-0.296558 --> -0.300354).  Saving model ...
Epoch: 19 cost time: 37.778159856796265
Epoch: 19, Steps: 17 | Train Loss: 0.676 Vali Loss: 3.188 Vali Acc: 0.228 Test Loss: 3.188 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 39.88175892829895
Epoch: 20, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.990 Vali Acc: 0.236 Test Loss: 2.990 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 40.09592628479004
Epoch: 21, Steps: 17 | Train Loss: 0.388 Vali Loss: 3.348 Vali Acc: 0.236 Test Loss: 3.348 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 42.9170618057251
Epoch: 22, Steps: 17 | Train Loss: 0.409 Vali Loss: 3.477 Vali Acc: 0.236 Test Loss: 3.477 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 42.06978225708008
Epoch: 23, Steps: 17 | Train Loss: 0.223 Vali Loss: 4.488 Vali Acc: 0.228 Test Loss: 4.488 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 38.446351528167725
Epoch: 24, Steps: 17 | Train Loss: 0.444 Vali Loss: 4.628 Vali Acc: 0.259 Test Loss: 4.628 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 41.27543568611145
Epoch: 25, Steps: 17 | Train Loss: 0.378 Vali Loss: 4.635 Vali Acc: 0.247 Test Loss: 4.635 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 39.256004095077515
Epoch: 26, Steps: 17 | Train Loss: 0.381 Vali Loss: 4.405 Vali Acc: 0.236 Test Loss: 4.405 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 36.69627499580383
Epoch: 27, Steps: 17 | Train Loss: 0.213 Vali Loss: 4.979 Vali Acc: 0.232 Test Loss: 4.979 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 41.21083092689514
Epoch: 28, Steps: 17 | Train Loss: 0.089 Vali Loss: 5.132 Vali Acc: 0.255 Test Loss: 5.132 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 11912580
model size : 47.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 274.377432346344
Epoch: 1, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.764 Vali Acc: 0.247 Test Loss: 1.764 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 263.27487111091614
Epoch: 2, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.925 Vali Acc: 0.262 Test Loss: 1.925 Test Acc: 0.262
Validation loss decreased (-0.247131 --> -0.262338).  Saving model ...
Epoch: 3 cost time: 274.7368018627167
Epoch: 3, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.843 Vali Acc: 0.247 Test Loss: 1.843 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 277.65241503715515
Epoch: 4, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.644 Vali Acc: 0.217 Test Loss: 1.644 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 277.44154596328735
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.557 Vali Acc: 0.251 Test Loss: 1.557 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 255.8073172569275
Epoch: 6, Steps: 17 | Train Loss: 1.500 Vali Loss: 2.166 Vali Acc: 0.213 Test Loss: 2.166 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 249.39662408828735
Epoch: 7, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.773 Vali Acc: 0.236 Test Loss: 1.773 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 265.01327681541443
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 2.113 Vali Acc: 0.266 Test Loss: 2.113 Test Acc: 0.266
Validation loss decreased (-0.262338 --> -0.266139).  Saving model ...
Epoch: 9 cost time: 259.7772696018219
Epoch: 9, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.111 Vali Acc: 0.262 Test Loss: 2.111 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 253.9142768383026
Epoch: 10, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.770 Vali Acc: 0.289 Test Loss: 1.770 Test Acc: 0.289
Validation loss decreased (-0.266139 --> -0.288956).  Saving model ...
Epoch: 11 cost time: 277.4491710662842
Epoch: 11, Steps: 17 | Train Loss: 1.183 Vali Loss: 2.973 Vali Acc: 0.251 Test Loss: 2.973 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 278.3909201622009
Epoch: 12, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.892 Vali Acc: 0.243 Test Loss: 1.892 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 266.5296456813812
Epoch: 13, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.165 Vali Acc: 0.262 Test Loss: 2.165 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 273.0544695854187
Epoch: 14, Steps: 17 | Train Loss: 0.756 Vali Loss: 2.459 Vali Acc: 0.262 Test Loss: 2.459 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 275.3615849018097
Epoch: 15, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.771 Vali Acc: 0.281 Test Loss: 2.771 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 272.16891741752625
Epoch: 16, Steps: 17 | Train Loss: 0.523 Vali Loss: 3.030 Vali Acc: 0.278 Test Loss: 3.030 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 235.27241373062134
Epoch: 17, Steps: 17 | Train Loss: 0.390 Vali Loss: 2.748 Vali Acc: 0.266 Test Loss: 2.748 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 256.3808641433716
Epoch: 18, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.182 Vali Acc: 0.243 Test Loss: 3.182 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 255.21522092819214
Epoch: 19, Steps: 17 | Train Loss: 0.337 Vali Loss: 4.126 Vali Acc: 0.274 Test Loss: 4.126 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 235.04541611671448
Epoch: 20, Steps: 17 | Train Loss: 0.297 Vali Loss: 4.607 Vali Acc: 0.278 Test Loss: 4.607 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 37943492
model size : 146.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 93.09435081481934
Epoch: 1, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.946 Vali Acc: 0.251 Test Loss: 1.946 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 90.8093204498291
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.816 Vali Acc: 0.247 Test Loss: 1.816 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 94.49031066894531
Epoch: 3, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.540 Vali Acc: 0.293 Test Loss: 1.540 Test Acc: 0.293
Validation loss decreased (-0.250931 --> -0.292760).  Saving model ...
Epoch: 4 cost time: 95.88543510437012
Epoch: 4, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.920 Vali Acc: 0.262 Test Loss: 1.920 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 95.38748979568481
Epoch: 5, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.764 Vali Acc: 0.259 Test Loss: 1.764 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 94.18618130683899
Epoch: 6, Steps: 17 | Train Loss: 1.717 Vali Loss: 2.435 Vali Acc: 0.266 Test Loss: 2.435 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 94.33241677284241
Epoch: 7, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.962 Vali Acc: 0.247 Test Loss: 1.962 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 95.26825737953186
Epoch: 8, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.686 Vali Acc: 0.312 Test Loss: 1.686 Test Acc: 0.312
Validation loss decreased (-0.292760 --> -0.311770).  Saving model ...
Epoch: 9 cost time: 101.15442085266113
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 97.67913031578064
Epoch: 10, Steps: 17 | Train Loss: 1.375 Vali Loss: 2.747 Vali Acc: 0.247 Test Loss: 2.747 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 99.94709539413452
Epoch: 11, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.695 Vali Acc: 0.251 Test Loss: 1.695 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 104.94348931312561
Epoch: 12, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.332 Vali Acc: 0.278 Test Loss: 2.332 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 100.42689228057861
Epoch: 13, Steps: 17 | Train Loss: 1.168 Vali Loss: 2.212 Vali Acc: 0.232 Test Loss: 2.212 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 103.01256489753723
Epoch: 14, Steps: 17 | Train Loss: 1.042 Vali Loss: 2.045 Vali Acc: 0.232 Test Loss: 2.045 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 104.55601644515991
Epoch: 15, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.174 Vali Acc: 0.266 Test Loss: 2.174 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 101.72593402862549
Epoch: 16, Steps: 17 | Train Loss: 1.069 Vali Loss: 2.538 Vali Acc: 0.259 Test Loss: 2.538 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 104.04703569412231
Epoch: 17, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.144 Vali Acc: 0.266 Test Loss: 2.144 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 102.04936408996582
Epoch: 18, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.598 Vali Acc: 0.255 Test Loss: 2.598 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 11464388
model size : 44.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 200.72947907447815
Epoch: 1, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.764 Vali Acc: 0.247 Test Loss: 1.764 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 200.94886469841003
Epoch: 2, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.925 Vali Acc: 0.262 Test Loss: 1.925 Test Acc: 0.262
Validation loss decreased (-0.247131 --> -0.262338).  Saving model ...
Epoch: 3 cost time: 199.13209557533264
Epoch: 3, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.843 Vali Acc: 0.247 Test Loss: 1.843 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 202.98343682289124
Epoch: 4, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.644 Vali Acc: 0.217 Test Loss: 1.644 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 193.71090292930603
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.557 Vali Acc: 0.251 Test Loss: 1.557 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 198.0577745437622
Epoch: 6, Steps: 17 | Train Loss: 1.500 Vali Loss: 2.166 Vali Acc: 0.213 Test Loss: 2.166 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 185.25208044052124
Epoch: 7, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.773 Vali Acc: 0.236 Test Loss: 1.773 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 187.88048720359802
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 2.113 Vali Acc: 0.266 Test Loss: 2.113 Test Acc: 0.266
Validation loss decreased (-0.262338 --> -0.266139).  Saving model ...
Epoch: 9 cost time: 186.25675988197327
Epoch: 9, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.111 Vali Acc: 0.262 Test Loss: 2.111 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 186.79271793365479
Epoch: 10, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.770 Vali Acc: 0.289 Test Loss: 1.770 Test Acc: 0.289
Validation loss decreased (-0.266139 --> -0.288956).  Saving model ...
Epoch: 11 cost time: 190.61696648597717
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 2.974 Vali Acc: 0.251 Test Loss: 2.974 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 186.5513892173767
Epoch: 12, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.890 Vali Acc: 0.240 Test Loss: 1.890 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 196.06891417503357
Epoch: 13, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.167 Vali Acc: 0.266 Test Loss: 2.167 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 191.2828402519226
Epoch: 14, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.454 Vali Acc: 0.262 Test Loss: 2.454 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 190.08650159835815
Epoch: 15, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.759 Vali Acc: 0.289 Test Loss: 2.759 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 189.00946640968323
Epoch: 16, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.035 Vali Acc: 0.274 Test Loss: 3.035 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 192.2484266757965
Epoch: 17, Steps: 17 | Train Loss: 0.392 Vali Loss: 2.769 Vali Acc: 0.270 Test Loss: 2.769 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 188.0583827495575
Epoch: 18, Steps: 17 | Train Loss: 0.391 Vali Loss: 3.220 Vali Acc: 0.247 Test Loss: 3.220 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 187.57408714294434
Epoch: 19, Steps: 17 | Train Loss: 0.333 Vali Loss: 4.121 Vali Acc: 0.278 Test Loss: 4.121 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 188.60108137130737
Epoch: 20, Steps: 17 | Train Loss: 0.310 Vali Loss: 4.716 Vali Acc: 0.270 Test Loss: 4.716 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 37943492
model size : 146.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 67.94888377189636
Epoch: 1, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.946 Vali Acc: 0.251 Test Loss: 1.946 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 68.74713492393494
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.816 Vali Acc: 0.247 Test Loss: 1.816 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 65.14578795433044
Epoch: 3, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.540 Vali Acc: 0.293 Test Loss: 1.540 Test Acc: 0.293
Validation loss decreased (-0.250931 --> -0.292760).  Saving model ...
Epoch: 4 cost time: 68.70824933052063
Epoch: 4, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.920 Vali Acc: 0.262 Test Loss: 1.920 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 66.62038207054138
Epoch: 5, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.764 Vali Acc: 0.259 Test Loss: 1.764 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 70.65425658226013
Epoch: 6, Steps: 17 | Train Loss: 1.716 Vali Loss: 2.435 Vali Acc: 0.266 Test Loss: 2.435 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 65.22578263282776
Epoch: 7, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.962 Vali Acc: 0.247 Test Loss: 1.962 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 68.6038556098938
Epoch: 8, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.686 Vali Acc: 0.312 Test Loss: 1.686 Test Acc: 0.312
Validation loss decreased (-0.292760 --> -0.311770).  Saving model ...
Epoch: 9 cost time: 64.82139253616333
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 69.09573578834534
Epoch: 10, Steps: 17 | Train Loss: 1.375 Vali Loss: 2.746 Vali Acc: 0.247 Test Loss: 2.746 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 65.2803099155426
Epoch: 11, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.709 Vali Acc: 0.247 Test Loss: 1.709 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 72.36992835998535
Epoch: 12, Steps: 17 | Train Loss: 1.113 Vali Loss: 2.345 Vali Acc: 0.281 Test Loss: 2.345 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 70.00427865982056
Epoch: 13, Steps: 17 | Train Loss: 1.171 Vali Loss: 2.218 Vali Acc: 0.228 Test Loss: 2.218 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 72.3388569355011
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.007 Vali Acc: 0.217 Test Loss: 2.007 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 76.81845712661743
Epoch: 15, Steps: 17 | Train Loss: 0.889 Vali Loss: 2.261 Vali Acc: 0.274 Test Loss: 2.261 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 77.64390587806702
Epoch: 16, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.209 Vali Acc: 0.259 Test Loss: 2.209 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 77.66379380226135
Epoch: 17, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.250 Vali Acc: 0.221 Test Loss: 2.250 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 75.48533344268799
Epoch: 18, Steps: 17 | Train Loss: 0.646 Vali Loss: 2.545 Vali Acc: 0.281 Test Loss: 2.545 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 11464388
model size : 44.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 122.2290563583374
Epoch: 1, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.764 Vali Acc: 0.247 Test Loss: 1.764 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 115.63911986351013
Epoch: 2, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.925 Vali Acc: 0.262 Test Loss: 1.925 Test Acc: 0.262
Validation loss decreased (-0.247131 --> -0.262338).  Saving model ...
Epoch: 3 cost time: 114.79487562179565
Epoch: 3, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.843 Vali Acc: 0.247 Test Loss: 1.843 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 117.52454423904419
Epoch: 4, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.644 Vali Acc: 0.217 Test Loss: 1.644 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 120.06518149375916
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.557 Vali Acc: 0.251 Test Loss: 1.557 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 116.70162558555603
Epoch: 6, Steps: 17 | Train Loss: 1.500 Vali Loss: 2.166 Vali Acc: 0.213 Test Loss: 2.166 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 117.73393273353577
Epoch: 7, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.773 Vali Acc: 0.236 Test Loss: 1.773 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 119.39895534515381
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 2.113 Vali Acc: 0.266 Test Loss: 2.113 Test Acc: 0.266
Validation loss decreased (-0.262338 --> -0.266139).  Saving model ...
Epoch: 9 cost time: 117.74251770973206
Epoch: 9, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.111 Vali Acc: 0.262 Test Loss: 2.111 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 119.68031883239746
Epoch: 10, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.770 Vali Acc: 0.289 Test Loss: 1.770 Test Acc: 0.289
Validation loss decreased (-0.266139 --> -0.288956).  Saving model ...
Epoch: 11 cost time: 122.13427972793579
Epoch: 11, Steps: 17 | Train Loss: 1.183 Vali Loss: 2.973 Vali Acc: 0.251 Test Loss: 2.973 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 110.77699661254883
Epoch: 12, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.892 Vali Acc: 0.243 Test Loss: 1.892 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 111.1744556427002
Epoch: 13, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.165 Vali Acc: 0.262 Test Loss: 2.165 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 113.08969736099243
Epoch: 14, Steps: 17 | Train Loss: 0.756 Vali Loss: 2.460 Vali Acc: 0.262 Test Loss: 2.460 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 108.66733527183533
Epoch: 15, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.771 Vali Acc: 0.285 Test Loss: 2.771 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 109.67459535598755
Epoch: 16, Steps: 17 | Train Loss: 0.523 Vali Loss: 3.029 Vali Acc: 0.278 Test Loss: 3.029 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 109.16907286643982
Epoch: 17, Steps: 17 | Train Loss: 0.390 Vali Loss: 2.752 Vali Acc: 0.266 Test Loss: 2.752 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 103.87205290794373
Epoch: 18, Steps: 17 | Train Loss: 0.384 Vali Loss: 3.168 Vali Acc: 0.243 Test Loss: 3.168 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 106.72076773643494
Epoch: 19, Steps: 17 | Train Loss: 0.335 Vali Loss: 4.119 Vali Acc: 0.274 Test Loss: 4.119 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 109.18879175186157
Epoch: 20, Steps: 17 | Train Loss: 0.294 Vali Loss: 4.553 Vali Acc: 0.274 Test Loss: 4.553 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 37943492
model size : 146.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 46.5190167427063
Epoch: 1, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.946 Vali Acc: 0.251 Test Loss: 1.946 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 44.68383169174194
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.816 Vali Acc: 0.247 Test Loss: 1.816 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 43.46700072288513
Epoch: 3, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.540 Vali Acc: 0.293 Test Loss: 1.540 Test Acc: 0.293
Validation loss decreased (-0.250931 --> -0.292760).  Saving model ...
Epoch: 4 cost time: 45.54165768623352
Epoch: 4, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.920 Vali Acc: 0.262 Test Loss: 1.920 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.67226266860962
Epoch: 5, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.764 Vali Acc: 0.259 Test Loss: 1.764 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 47.065040826797485
Epoch: 6, Steps: 17 | Train Loss: 1.717 Vali Loss: 2.435 Vali Acc: 0.266 Test Loss: 2.435 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 40.83022952079773
Epoch: 7, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.962 Vali Acc: 0.247 Test Loss: 1.962 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 60.19472360610962
Epoch: 8, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.686 Vali Acc: 0.312 Test Loss: 1.686 Test Acc: 0.312
Validation loss decreased (-0.292760 --> -0.311770).  Saving model ...
Epoch: 9 cost time: 59.29246783256531
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 60.159773111343384
Epoch: 10, Steps: 17 | Train Loss: 1.375 Vali Loss: 2.747 Vali Acc: 0.247 Test Loss: 2.747 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 61.969186544418335
Epoch: 11, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 60.999077558517456
Epoch: 12, Steps: 17 | Train Loss: 1.115 Vali Loss: 2.331 Vali Acc: 0.281 Test Loss: 2.331 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 61.41189432144165
Epoch: 13, Steps: 17 | Train Loss: 1.169 Vali Loss: 2.217 Vali Acc: 0.232 Test Loss: 2.217 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 60.00778579711914
Epoch: 14, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.020 Vali Acc: 0.224 Test Loss: 2.020 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 63.524842977523804
Epoch: 15, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.150 Vali Acc: 0.270 Test Loss: 2.150 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 57.193363189697266
Epoch: 16, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.965 Vali Acc: 0.236 Test Loss: 1.965 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 62.181357622146606
Epoch: 17, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.185 Vali Acc: 0.247 Test Loss: 2.185 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 60.21606802940369
Epoch: 18, Steps: 17 | Train Loss: 0.666 Vali Loss: 3.030 Vali Acc: 0.247 Test Loss: 3.030 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 11464388
model size : 44.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 204.44541001319885
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 205.0406255722046
Epoch: 2, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.572 Vali Acc: 0.259 Test Loss: 1.572 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 202.3761956691742
Epoch: 3, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.870 Vali Acc: 0.251 Test Loss: 1.870 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 197.75589156150818
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.712 Vali Acc: 0.285 Test Loss: 1.712 Test Acc: 0.285
Validation loss decreased (-0.258539 --> -0.285154).  Saving model ...
Epoch: 5 cost time: 190.3558337688446
Epoch: 5, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.877 Vali Acc: 0.247 Test Loss: 1.877 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 199.9296383857727
Epoch: 6, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.698 Vali Acc: 0.262 Test Loss: 1.698 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 198.32196426391602
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.645 Vali Acc: 0.247 Test Loss: 1.645 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 191.85501623153687
Epoch: 8, Steps: 17 | Train Loss: 1.244 Vali Loss: 2.724 Vali Acc: 0.240 Test Loss: 2.724 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 186.79967141151428
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.725 Vali Acc: 0.297 Test Loss: 1.725 Test Acc: 0.297
Validation loss decreased (-0.285154 --> -0.296561).  Saving model ...
Epoch: 10 cost time: 188.05513858795166
Epoch: 10, Steps: 17 | Train Loss: 1.308 Vali Loss: 2.220 Vali Acc: 0.243 Test Loss: 2.220 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 188.27161574363708
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 2.569 Vali Acc: 0.255 Test Loss: 2.569 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 178.56177639961243
Epoch: 12, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.801 Vali Acc: 0.270 Test Loss: 1.801 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 188.36781692504883
Epoch: 13, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.574 Vali Acc: 0.255 Test Loss: 2.574 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 178.3043248653412
Epoch: 14, Steps: 17 | Train Loss: 0.879 Vali Loss: 2.254 Vali Acc: 0.270 Test Loss: 2.254 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 185.10290265083313
Epoch: 15, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.418 Vali Acc: 0.293 Test Loss: 2.418 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 181.48321533203125
Epoch: 16, Steps: 17 | Train Loss: 0.945 Vali Loss: 2.098 Vali Acc: 0.274 Test Loss: 2.098 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 183.12965893745422
Epoch: 17, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.849 Vali Acc: 0.247 Test Loss: 2.849 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 180.31596493721008
Epoch: 18, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.710 Vali Acc: 0.289 Test Loss: 2.710 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 185.18209314346313
Epoch: 19, Steps: 17 | Train Loss: 0.479 Vali Loss: 2.592 Vali Acc: 0.274 Test Loss: 2.592 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 19197124
model size : 74.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 73.38928627967834
Epoch: 1, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.519 Vali Acc: 0.232 Test Loss: 1.519 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 65.46923398971558
Epoch: 2, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.877 Vali Acc: 0.259 Test Loss: 1.877 Test Acc: 0.259
Validation loss decreased (-0.231924 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 63.50520658493042
Epoch: 3, Steps: 17 | Train Loss: 1.647 Vali Loss: 2.129 Vali Acc: 0.251 Test Loss: 2.129 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 65.8271255493164
Epoch: 4, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.775 Vali Acc: 0.259 Test Loss: 1.775 Test Acc: 0.259
Validation loss decreased (-0.258536 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 64.45037961006165
Epoch: 5, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.896 Vali Acc: 0.331 Test Loss: 1.896 Test Acc: 0.331
Validation loss decreased (-0.258537 --> -0.330780).  Saving model ...
Epoch: 6 cost time: 62.39605760574341
Epoch: 6, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.595 Vali Acc: 0.278 Test Loss: 1.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 64.58265972137451
Epoch: 7, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.914 Vali Acc: 0.266 Test Loss: 1.914 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 64.2535183429718
Epoch: 8, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.730 Vali Acc: 0.262 Test Loss: 1.730 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 60.85912346839905
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.633 Vali Acc: 0.289 Test Loss: 1.633 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 68.95487999916077
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 2.161 Vali Acc: 0.300 Test Loss: 2.161 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 69.11815047264099
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.688 Vali Acc: 0.308 Test Loss: 1.688 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 66.53612112998962
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.857 Vali Acc: 0.323 Test Loss: 1.857 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 65.32518601417542
Epoch: 13, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.201 Vali Acc: 0.262 Test Loss: 2.201 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 66.10518383979797
Epoch: 14, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.985 Vali Acc: 0.255 Test Loss: 1.985 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 67.80020570755005
Epoch: 15, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.895 Vali Acc: 0.266 Test Loss: 2.895 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 5957316
model size : 23.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 127.25033569335938
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 124.74700570106506
Epoch: 2, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.572 Vali Acc: 0.259 Test Loss: 1.572 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 118.80926585197449
Epoch: 3, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.870 Vali Acc: 0.251 Test Loss: 1.870 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 113.97338461875916
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.712 Vali Acc: 0.285 Test Loss: 1.712 Test Acc: 0.285
Validation loss decreased (-0.258539 --> -0.285154).  Saving model ...
Epoch: 5 cost time: 116.20526719093323
Epoch: 5, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.877 Vali Acc: 0.247 Test Loss: 1.877 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 123.96931099891663
Epoch: 6, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.698 Vali Acc: 0.262 Test Loss: 1.698 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 120.89480566978455
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.645 Vali Acc: 0.247 Test Loss: 1.645 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 118.04233026504517
Epoch: 8, Steps: 17 | Train Loss: 1.244 Vali Loss: 2.724 Vali Acc: 0.240 Test Loss: 2.724 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 124.57907629013062
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.725 Vali Acc: 0.297 Test Loss: 1.725 Test Acc: 0.297
Validation loss decreased (-0.285154 --> -0.296561).  Saving model ...
Epoch: 10 cost time: 115.44058108329773
Epoch: 10, Steps: 17 | Train Loss: 1.308 Vali Loss: 2.220 Vali Acc: 0.243 Test Loss: 2.220 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 124.12022995948792
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 2.570 Vali Acc: 0.255 Test Loss: 2.570 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 122.91226649284363
Epoch: 12, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.801 Vali Acc: 0.270 Test Loss: 1.801 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 129.17094445228577
Epoch: 13, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.574 Vali Acc: 0.255 Test Loss: 2.574 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 133.031320810318
Epoch: 14, Steps: 17 | Train Loss: 0.879 Vali Loss: 2.255 Vali Acc: 0.270 Test Loss: 2.255 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 136.4091076850891
Epoch: 15, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.417 Vali Acc: 0.293 Test Loss: 2.417 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 124.30556392669678
Epoch: 16, Steps: 17 | Train Loss: 0.945 Vali Loss: 2.099 Vali Acc: 0.278 Test Loss: 2.099 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 126.90456676483154
Epoch: 17, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.856 Vali Acc: 0.247 Test Loss: 2.856 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 140.53057479858398
Epoch: 18, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.706 Vali Acc: 0.285 Test Loss: 2.706 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 137.83257007598877
Epoch: 19, Steps: 17 | Train Loss: 0.482 Vali Loss: 2.600 Vali Acc: 0.278 Test Loss: 2.600 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 19197124
model size : 74.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 55.37359571456909
Epoch: 1, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.519 Vali Acc: 0.232 Test Loss: 1.519 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 50.342989444732666
Epoch: 2, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.877 Vali Acc: 0.259 Test Loss: 1.877 Test Acc: 0.259
Validation loss decreased (-0.231924 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 52.92765927314758
Epoch: 3, Steps: 17 | Train Loss: 1.647 Vali Loss: 2.129 Vali Acc: 0.251 Test Loss: 2.129 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 49.72713565826416
Epoch: 4, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.775 Vali Acc: 0.259 Test Loss: 1.775 Test Acc: 0.259
Validation loss decreased (-0.258536 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 52.26095509529114
Epoch: 5, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.896 Vali Acc: 0.331 Test Loss: 1.896 Test Acc: 0.331
Validation loss decreased (-0.258537 --> -0.330780).  Saving model ...
Epoch: 6 cost time: 52.34281802177429
Epoch: 6, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.595 Vali Acc: 0.278 Test Loss: 1.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 53.5362024307251
Epoch: 7, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.914 Vali Acc: 0.266 Test Loss: 1.914 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 53.01087665557861
Epoch: 8, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.730 Vali Acc: 0.262 Test Loss: 1.730 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 51.66104865074158
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.633 Vali Acc: 0.289 Test Loss: 1.633 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 53.85355186462402
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 2.161 Vali Acc: 0.300 Test Loss: 2.161 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 49.32885217666626
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.688 Vali Acc: 0.308 Test Loss: 1.688 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 51.76205563545227
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.857 Vali Acc: 0.323 Test Loss: 1.857 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 48.257020235061646
Epoch: 13, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.201 Vali Acc: 0.262 Test Loss: 2.201 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 50.637248039245605
Epoch: 14, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.985 Vali Acc: 0.255 Test Loss: 1.985 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 50.21775484085083
Epoch: 15, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.896 Vali Acc: 0.266 Test Loss: 2.896 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 5957316
model size : 23.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 81.07748365402222
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 69.62148594856262
Epoch: 2, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.572 Vali Acc: 0.259 Test Loss: 1.572 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 78.89504218101501
Epoch: 3, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.870 Vali Acc: 0.251 Test Loss: 1.870 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 78.61013603210449
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.712 Vali Acc: 0.285 Test Loss: 1.712 Test Acc: 0.285
Validation loss decreased (-0.258539 --> -0.285154).  Saving model ...
Epoch: 5 cost time: 74.059157371521
Epoch: 5, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.877 Vali Acc: 0.247 Test Loss: 1.877 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 78.72037696838379
Epoch: 6, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.698 Vali Acc: 0.262 Test Loss: 1.698 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 78.13792896270752
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.645 Vali Acc: 0.247 Test Loss: 1.645 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 74.17665338516235
Epoch: 8, Steps: 17 | Train Loss: 1.244 Vali Loss: 2.724 Vali Acc: 0.240 Test Loss: 2.724 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 79.43759155273438
Epoch: 9, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.725 Vali Acc: 0.297 Test Loss: 1.725 Test Acc: 0.297
Validation loss decreased (-0.285154 --> -0.296561).  Saving model ...
Epoch: 10 cost time: 72.15080332756042
Epoch: 10, Steps: 17 | Train Loss: 1.308 Vali Loss: 2.220 Vali Acc: 0.243 Test Loss: 2.220 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 75.9034812450409
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 2.570 Vali Acc: 0.255 Test Loss: 2.570 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 78.48472213745117
Epoch: 12, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.800 Vali Acc: 0.270 Test Loss: 1.800 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 71.69946265220642
Epoch: 13, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.573 Vali Acc: 0.255 Test Loss: 2.573 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 72.64947199821472
Epoch: 14, Steps: 17 | Train Loss: 0.879 Vali Loss: 2.256 Vali Acc: 0.270 Test Loss: 2.256 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 74.3550968170166
Epoch: 15, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.415 Vali Acc: 0.293 Test Loss: 2.415 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 75.46680569648743
Epoch: 16, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.101 Vali Acc: 0.285 Test Loss: 2.101 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 79.13485622406006
Epoch: 17, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.877 Vali Acc: 0.251 Test Loss: 2.877 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 78.96568131446838
Epoch: 18, Steps: 17 | Train Loss: 0.612 Vali Loss: 2.701 Vali Acc: 0.285 Test Loss: 2.701 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 74.03334259986877
Epoch: 19, Steps: 17 | Train Loss: 0.479 Vali Loss: 2.606 Vali Acc: 0.270 Test Loss: 2.606 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 19197124
model size : 74.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 35.441789865493774
Epoch: 1, Steps: 17 | Train Loss: 1.621 Vali Loss: 1.519 Vali Acc: 0.232 Test Loss: 1.519 Test Acc: 0.232
Validation loss decreased (inf --> -0.231924).  Saving model ...
Epoch: 2 cost time: 30.72535228729248
Epoch: 2, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.877 Vali Acc: 0.259 Test Loss: 1.877 Test Acc: 0.259
Validation loss decreased (-0.231924 --> -0.258536).  Saving model ...
Epoch: 3 cost time: 32.43055772781372
Epoch: 3, Steps: 17 | Train Loss: 1.647 Vali Loss: 2.129 Vali Acc: 0.251 Test Loss: 2.129 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.49356770515442
Epoch: 4, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.775 Vali Acc: 0.259 Test Loss: 1.775 Test Acc: 0.259
Validation loss decreased (-0.258536 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 28.93404245376587
Epoch: 5, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.896 Vali Acc: 0.331 Test Loss: 1.896 Test Acc: 0.331
Validation loss decreased (-0.258537 --> -0.330780).  Saving model ...
Epoch: 6 cost time: 28.292709350585938
Epoch: 6, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.595 Vali Acc: 0.278 Test Loss: 1.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.620932817459106
Epoch: 7, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.914 Vali Acc: 0.266 Test Loss: 1.914 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 27.674506425857544
Epoch: 8, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.730 Vali Acc: 0.262 Test Loss: 1.730 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 29.16121006011963
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.633 Vali Acc: 0.289 Test Loss: 1.633 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 30.749093532562256
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 2.161 Vali Acc: 0.300 Test Loss: 2.161 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 30.753676891326904
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.688 Vali Acc: 0.308 Test Loss: 1.688 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 32.04008865356445
Epoch: 12, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.857 Vali Acc: 0.323 Test Loss: 1.857 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 32.288082122802734
Epoch: 13, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.201 Vali Acc: 0.262 Test Loss: 2.201 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 30.327741861343384
Epoch: 14, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.985 Vali Acc: 0.255 Test Loss: 1.985 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 32.30913329124451
Epoch: 15, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.895 Vali Acc: 0.266 Test Loss: 2.895 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 5957316
model size : 23.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 110.55850791931152
Epoch: 1, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.800 Vali Acc: 0.251 Test Loss: 1.800 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 109.18450474739075
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 2.088 Vali Acc: 0.228 Test Loss: 2.088 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 101.74802494049072
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.619 Vali Acc: 0.232 Test Loss: 1.619 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 104.09459590911865
Epoch: 4, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.907 Vali Acc: 0.278 Test Loss: 1.907 Test Acc: 0.278
Validation loss decreased (-0.250933 --> -0.277547).  Saving model ...
Epoch: 5 cost time: 101.3938217163086
Epoch: 5, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 107.68955540657043
Epoch: 6, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.055 Vali Acc: 0.278 Test Loss: 2.055 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 110.52067494392395
Epoch: 7, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.694 Vali Acc: 0.243 Test Loss: 1.694 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 106.44368100166321
Epoch: 8, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.979 Vali Acc: 0.262 Test Loss: 1.979 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 106.83554267883301
Epoch: 9, Steps: 17 | Train Loss: 1.486 Vali Loss: 2.103 Vali Acc: 0.278 Test Loss: 2.103 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 108.02594375610352
Epoch: 10, Steps: 17 | Train Loss: 1.289 Vali Loss: 2.213 Vali Acc: 0.251 Test Loss: 2.213 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 104.40141344070435
Epoch: 11, Steps: 17 | Train Loss: 1.572 Vali Loss: 2.273 Vali Acc: 0.300 Test Loss: 2.273 Test Acc: 0.300
Validation loss decreased (-0.277547 --> -0.300357).  Saving model ...
Epoch: 12 cost time: 103.58531355857849
Epoch: 12, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.788 Vali Acc: 0.266 Test Loss: 1.788 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 100.84357261657715
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 2.045 Vali Acc: 0.236 Test Loss: 2.045 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 107.57286334037781
Epoch: 14, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.570 Vali Acc: 0.274 Test Loss: 2.570 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 104.48115587234497
Epoch: 15, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.343 Vali Acc: 0.247 Test Loss: 2.343 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 99.86945056915283
Epoch: 16, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.218 Vali Acc: 0.289 Test Loss: 2.218 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 101.2311143875122
Epoch: 17, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.849 Vali Acc: 0.259 Test Loss: 2.849 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 109.05857563018799
Epoch: 18, Steps: 17 | Train Loss: 0.835 Vali Loss: 2.676 Vali Acc: 0.251 Test Loss: 2.676 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 107.68651700019836
Epoch: 19, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.636 Vali Acc: 0.247 Test Loss: 2.636 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 97.01490235328674
Epoch: 20, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.435 Vali Acc: 0.262 Test Loss: 3.435 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 97.99650311470032
Epoch: 21, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.937 Vali Acc: 0.243 Test Loss: 2.937 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 9823940
model size : 38.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 42.94517946243286
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.608 Vali Acc: 0.247 Test Loss: 1.608 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 42.84895348548889
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.621 Vali Acc: 0.243 Test Loss: 1.621 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 40.0842342376709
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.936 Vali Acc: 0.255 Test Loss: 1.936 Test Acc: 0.255
Validation loss decreased (-0.247132 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 44.21760010719299
Epoch: 4, Steps: 17 | Train Loss: 1.875 Vali Loss: 2.810 Vali Acc: 0.251 Test Loss: 2.810 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 42.49108529090881
Epoch: 5, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.681 Vali Acc: 0.262 Test Loss: 1.681 Test Acc: 0.262
Validation loss decreased (-0.254733 --> -0.262341).  Saving model ...
Epoch: 6 cost time: 43.7449049949646
Epoch: 6, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.566 Vali Acc: 0.247 Test Loss: 1.566 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 39.31936240196228
Epoch: 7, Steps: 17 | Train Loss: 1.558 Vali Loss: 2.097 Vali Acc: 0.243 Test Loss: 2.097 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 40.6525821685791
Epoch: 8, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.905 Vali Acc: 0.274 Test Loss: 1.905 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273745).  Saving model ...
Epoch: 9 cost time: 40.021743059158325
Epoch: 9, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.888 Vali Acc: 0.270 Test Loss: 1.888 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 39.676108598709106
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.690 Vali Acc: 0.247 Test Loss: 1.690 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 38.573134660720825
Epoch: 11, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.757 Vali Acc: 0.255 Test Loss: 1.757 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 40.45306634902954
Epoch: 12, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.956 Vali Acc: 0.255 Test Loss: 1.956 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 43.06057143211365
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.319 Vali Acc: 0.259 Test Loss: 2.319 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 40.8431978225708
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.071 Vali Acc: 0.240 Test Loss: 2.071 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 42.997519731521606
Epoch: 15, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.448 Vali Acc: 0.251 Test Loss: 2.448 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 36.415679931640625
Epoch: 16, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.802 Vali Acc: 0.259 Test Loss: 2.802 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 41.836833477020264
Epoch: 17, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.361 Vali Acc: 0.224 Test Loss: 2.361 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 38.229854106903076
Epoch: 18, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.575 Vali Acc: 0.228 Test Loss: 2.575 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3203780
model size : 13.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 85.58797788619995
Epoch: 1, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.800 Vali Acc: 0.251 Test Loss: 1.800 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 82.42325186729431
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 2.088 Vali Acc: 0.228 Test Loss: 2.088 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 79.88452124595642
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.619 Vali Acc: 0.232 Test Loss: 1.619 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 77.52174091339111
Epoch: 4, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.907 Vali Acc: 0.278 Test Loss: 1.907 Test Acc: 0.278
Validation loss decreased (-0.250933 --> -0.277547).  Saving model ...
Epoch: 5 cost time: 79.90552401542664
Epoch: 5, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 76.22594404220581
Epoch: 6, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.055 Vali Acc: 0.278 Test Loss: 2.055 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 80.54883790016174
Epoch: 7, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.694 Vali Acc: 0.243 Test Loss: 1.694 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 81.62892055511475
Epoch: 8, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.979 Vali Acc: 0.262 Test Loss: 1.979 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 74.17501664161682
Epoch: 9, Steps: 17 | Train Loss: 1.486 Vali Loss: 2.103 Vali Acc: 0.278 Test Loss: 2.103 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 77.3902497291565
Epoch: 10, Steps: 17 | Train Loss: 1.289 Vali Loss: 2.212 Vali Acc: 0.251 Test Loss: 2.212 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 76.6002471446991
Epoch: 11, Steps: 17 | Train Loss: 1.572 Vali Loss: 2.274 Vali Acc: 0.297 Test Loss: 2.274 Test Acc: 0.297
Validation loss decreased (-0.277547 --> -0.296555).  Saving model ...
Epoch: 12 cost time: 79.04142689704895
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.787 Vali Acc: 0.266 Test Loss: 1.787 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 81.35893559455872
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 2.046 Vali Acc: 0.236 Test Loss: 2.046 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 76.78008460998535
Epoch: 14, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.572 Vali Acc: 0.274 Test Loss: 2.572 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 78.48071002960205
Epoch: 15, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.344 Vali Acc: 0.247 Test Loss: 2.344 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 77.71371579170227
Epoch: 16, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.219 Vali Acc: 0.289 Test Loss: 2.219 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 72.4134635925293
Epoch: 17, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.851 Vali Acc: 0.259 Test Loss: 2.851 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 74.7554259300232
Epoch: 18, Steps: 17 | Train Loss: 0.836 Vali Loss: 2.668 Vali Acc: 0.251 Test Loss: 2.668 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 75.39087748527527
Epoch: 19, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.636 Vali Acc: 0.243 Test Loss: 2.636 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 70.10521245002747
Epoch: 20, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.427 Vali Acc: 0.262 Test Loss: 3.427 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 72.21749687194824
Epoch: 21, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.946 Vali Acc: 0.243 Test Loss: 2.946 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 9823940
model size : 38.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 30.460366010665894
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.608 Vali Acc: 0.247 Test Loss: 1.608 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 30.05856966972351
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.621 Vali Acc: 0.243 Test Loss: 1.621 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.43395471572876
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.936 Vali Acc: 0.255 Test Loss: 1.936 Test Acc: 0.255
Validation loss decreased (-0.247132 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 29.51963758468628
Epoch: 4, Steps: 17 | Train Loss: 1.875 Vali Loss: 2.810 Vali Acc: 0.251 Test Loss: 2.810 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.684680938720703
Epoch: 5, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.681 Vali Acc: 0.262 Test Loss: 1.681 Test Acc: 0.262
Validation loss decreased (-0.254733 --> -0.262341).  Saving model ...
Epoch: 6 cost time: 29.00885272026062
Epoch: 6, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.566 Vali Acc: 0.247 Test Loss: 1.566 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.600762367248535
Epoch: 7, Steps: 17 | Train Loss: 1.558 Vali Loss: 2.098 Vali Acc: 0.243 Test Loss: 2.098 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 30.068286180496216
Epoch: 8, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.905 Vali Acc: 0.274 Test Loss: 1.905 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273745).  Saving model ...
Epoch: 9 cost time: 30.012566089630127
Epoch: 9, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.888 Vali Acc: 0.270 Test Loss: 1.888 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.971049070358276
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.690 Vali Acc: 0.247 Test Loss: 1.690 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 24.548194885253906
Epoch: 11, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.757 Vali Acc: 0.255 Test Loss: 1.757 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 30.34609580039978
Epoch: 12, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.956 Vali Acc: 0.255 Test Loss: 1.956 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 28.523065090179443
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.319 Vali Acc: 0.259 Test Loss: 2.319 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 31.559569835662842
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.070 Vali Acc: 0.240 Test Loss: 2.070 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 30.434224605560303
Epoch: 15, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.447 Vali Acc: 0.251 Test Loss: 2.447 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 27.34748411178589
Epoch: 16, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.797 Vali Acc: 0.262 Test Loss: 2.797 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 32.0757269859314
Epoch: 17, Steps: 17 | Train Loss: 1.023 Vali Loss: 2.362 Vali Acc: 0.224 Test Loss: 2.362 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 31.532113075256348
Epoch: 18, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.571 Vali Acc: 0.228 Test Loss: 2.571 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3203780
model size : 13.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 45.643369913101196
Epoch: 1, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.800 Vali Acc: 0.251 Test Loss: 1.800 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 46.214946031570435
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 2.088 Vali Acc: 0.228 Test Loss: 2.088 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 43.02208065986633
Epoch: 3, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.619 Vali Acc: 0.232 Test Loss: 1.619 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 40.14971876144409
Epoch: 4, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.907 Vali Acc: 0.278 Test Loss: 1.907 Test Acc: 0.278
Validation loss decreased (-0.250933 --> -0.277547).  Saving model ...
Epoch: 5 cost time: 43.07665514945984
Epoch: 5, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 41.06671476364136
Epoch: 6, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.055 Vali Acc: 0.278 Test Loss: 2.055 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 41.99298620223999
Epoch: 7, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.694 Vali Acc: 0.243 Test Loss: 1.694 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 44.19674372673035
Epoch: 8, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.979 Vali Acc: 0.262 Test Loss: 1.979 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 41.59745526313782
Epoch: 9, Steps: 17 | Train Loss: 1.486 Vali Loss: 2.103 Vali Acc: 0.278 Test Loss: 2.103 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 40.280669927597046
Epoch: 10, Steps: 17 | Train Loss: 1.289 Vali Loss: 2.212 Vali Acc: 0.251 Test Loss: 2.212 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 39.60803151130676
Epoch: 11, Steps: 17 | Train Loss: 1.572 Vali Loss: 2.274 Vali Acc: 0.297 Test Loss: 2.274 Test Acc: 0.297
Validation loss decreased (-0.277547 --> -0.296555).  Saving model ...
Epoch: 12 cost time: 46.77431869506836
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.787 Vali Acc: 0.266 Test Loss: 1.787 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 44.84593415260315
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 2.046 Vali Acc: 0.236 Test Loss: 2.046 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 44.00075554847717
Epoch: 14, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.572 Vali Acc: 0.274 Test Loss: 2.572 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 43.758159160614014
Epoch: 15, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.343 Vali Acc: 0.247 Test Loss: 2.343 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 43.48670816421509
Epoch: 16, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.219 Vali Acc: 0.289 Test Loss: 2.219 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 40.939940214157104
Epoch: 17, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.849 Vali Acc: 0.259 Test Loss: 2.849 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 41.81960320472717
Epoch: 18, Steps: 17 | Train Loss: 0.836 Vali Loss: 2.672 Vali Acc: 0.247 Test Loss: 2.672 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 43.06708240509033
Epoch: 19, Steps: 17 | Train Loss: 0.721 Vali Loss: 2.637 Vali Acc: 0.240 Test Loss: 2.637 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 44.11950945854187
Epoch: 20, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.423 Vali Acc: 0.262 Test Loss: 3.423 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 43.4897198677063
Epoch: 21, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.941 Vali Acc: 0.236 Test Loss: 2.941 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 9823940
model size : 38.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.125657320022583
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.608 Vali Acc: 0.247 Test Loss: 1.608 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 17.059905767440796
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.621 Vali Acc: 0.243 Test Loss: 1.621 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.54591131210327
Epoch: 3, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.936 Vali Acc: 0.255 Test Loss: 1.936 Test Acc: 0.255
Validation loss decreased (-0.247132 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 16.97943377494812
Epoch: 4, Steps: 17 | Train Loss: 1.875 Vali Loss: 2.810 Vali Acc: 0.251 Test Loss: 2.810 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.543303728103638
Epoch: 5, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.681 Vali Acc: 0.262 Test Loss: 1.681 Test Acc: 0.262
Validation loss decreased (-0.254733 --> -0.262341).  Saving model ...
Epoch: 6 cost time: 18.52358913421631
Epoch: 6, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.566 Vali Acc: 0.247 Test Loss: 1.566 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 16.923420429229736
Epoch: 7, Steps: 17 | Train Loss: 1.558 Vali Loss: 2.098 Vali Acc: 0.243 Test Loss: 2.098 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.174396753311157
Epoch: 8, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.905 Vali Acc: 0.274 Test Loss: 1.905 Test Acc: 0.274
Validation loss decreased (-0.262341 --> -0.273745).  Saving model ...
Epoch: 9 cost time: 19.181740522384644
Epoch: 9, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.888 Vali Acc: 0.270 Test Loss: 1.888 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.843040943145752
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.690 Vali Acc: 0.247 Test Loss: 1.690 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.0853488445282
Epoch: 11, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.757 Vali Acc: 0.255 Test Loss: 1.757 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.720653533935547
Epoch: 12, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.956 Vali Acc: 0.255 Test Loss: 1.956 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.163333892822266
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.319 Vali Acc: 0.259 Test Loss: 2.319 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 17.528287410736084
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.070 Vali Acc: 0.240 Test Loss: 2.070 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 17.35021686553955
Epoch: 15, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.448 Vali Acc: 0.251 Test Loss: 2.448 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 15.612107992172241
Epoch: 16, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.800 Vali Acc: 0.259 Test Loss: 2.800 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 18.68048930168152
Epoch: 17, Steps: 17 | Train Loss: 1.024 Vali Loss: 2.361 Vali Acc: 0.224 Test Loss: 2.361 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 19.559287071228027
Epoch: 18, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.573 Vali Acc: 0.228 Test Loss: 2.573 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3203780
model size : 13.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 96.12765836715698
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.526 Vali Acc: 0.243 Test Loss: 1.526 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 97.58528971672058
Epoch: 2, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.787 Vali Acc: 0.274 Test Loss: 1.787 Test Acc: 0.274
Validation loss decreased (-0.243331 --> -0.273746).  Saving model ...
Epoch: 3 cost time: 96.24595642089844
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.515 Vali Acc: 0.217 Test Loss: 1.515 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 95.24887895584106
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.612 Vali Acc: 0.243 Test Loss: 1.612 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 93.66949462890625
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.807 Vali Acc: 0.251 Test Loss: 1.807 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 89.81755042076111
Epoch: 6, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.471 Vali Acc: 0.285 Test Loss: 1.471 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 87.32768654823303
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.637 Vali Acc: 0.281 Test Loss: 1.637 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 86.55036664009094
Epoch: 8, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.683 Vali Acc: 0.266 Test Loss: 1.683 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 89.63727140426636
Epoch: 9, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.776 Vali Acc: 0.266 Test Loss: 1.776 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 81.60220956802368
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 2.099 Vali Acc: 0.266 Test Loss: 2.099 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 89.47634887695312
Epoch: 11, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.837 Vali Acc: 0.262 Test Loss: 1.837 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 89.54078340530396
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.806 Vali Acc: 0.224 Test Loss: 1.806 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 95.60626077651978
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.673 Vali Acc: 0.274 Test Loss: 1.673 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 99.275887966156
Epoch: 14, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.004 Vali Acc: 0.278 Test Loss: 2.004 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 94.53830003738403
Epoch: 15, Steps: 17 | Train Loss: 1.035 Vali Loss: 2.131 Vali Acc: 0.247 Test Loss: 2.131 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 85.6120924949646
Epoch: 16, Steps: 17 | Train Loss: 0.924 Vali Loss: 2.088 Vali Acc: 0.259 Test Loss: 2.088 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 9600100
model size : 37.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 37.048120737075806
Epoch: 1, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.841 Vali Acc: 0.251 Test Loss: 1.841 Test Acc: 0.251
Validation loss decreased (inf --> -0.250932).  Saving model ...
Epoch: 2 cost time: 39.811150312423706
Epoch: 2, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.464 Vali Acc: 0.262 Test Loss: 1.464 Test Acc: 0.262
Validation loss decreased (-0.250932 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 34.494200229644775
Epoch: 3, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.643 Vali Acc: 0.289 Test Loss: 1.643 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288957).  Saving model ...
Epoch: 4 cost time: 38.003730058670044
Epoch: 4, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.448 Vali Acc: 0.221 Test Loss: 1.448 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 40.128758907318115
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.639 Vali Acc: 0.232 Test Loss: 1.639 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 43.49863409996033
Epoch: 6, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.622 Vali Acc: 0.274 Test Loss: 1.622 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 39.337138652801514
Epoch: 7, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.732 Vali Acc: 0.255 Test Loss: 1.732 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 40.80556607246399
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.634 Vali Acc: 0.259 Test Loss: 1.634 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 36.53073072433472
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.055 Vali Acc: 0.262 Test Loss: 2.055 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 39.42475152015686
Epoch: 10, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.697 Vali Acc: 0.236 Test Loss: 1.697 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 40.06811261177063
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.819 Vali Acc: 0.300 Test Loss: 1.819 Test Acc: 0.300
Validation loss decreased (-0.288957 --> -0.300362).  Saving model ...
Epoch: 12 cost time: 42.045984506607056
Epoch: 12, Steps: 17 | Train Loss: 1.162 Vali Loss: 2.474 Vali Acc: 0.255 Test Loss: 2.474 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 44.1329607963562
Epoch: 13, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.633 Vali Acc: 0.278 Test Loss: 1.633 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 39.1607780456543
Epoch: 14, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.891 Vali Acc: 0.278 Test Loss: 1.891 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 40.4453501701355
Epoch: 15, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.066 Vali Acc: 0.217 Test Loss: 2.066 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 34.213101387023926
Epoch: 16, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.808 Vali Acc: 0.274 Test Loss: 1.808 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 37.849547386169434
Epoch: 17, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.946 Vali Acc: 0.240 Test Loss: 1.946 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 34.75418543815613
Epoch: 18, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.078 Vali Acc: 0.278 Test Loss: 2.078 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 36.8737268447876
Epoch: 19, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.068 Vali Acc: 0.270 Test Loss: 2.068 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 35.261616706848145
Epoch: 20, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.443 Vali Acc: 0.259 Test Loss: 2.443 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 37.365978717803955
Epoch: 21, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.323 Vali Acc: 0.213 Test Loss: 2.323 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 2979684
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 74.88568043708801
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.526 Vali Acc: 0.243 Test Loss: 1.526 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 69.88985395431519
Epoch: 2, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.787 Vali Acc: 0.274 Test Loss: 1.787 Test Acc: 0.274
Validation loss decreased (-0.243331 --> -0.273746).  Saving model ...
Epoch: 3 cost time: 73.79637908935547
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.515 Vali Acc: 0.217 Test Loss: 1.515 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 76.08317279815674
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.612 Vali Acc: 0.243 Test Loss: 1.612 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 68.4288170337677
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.807 Vali Acc: 0.251 Test Loss: 1.807 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 69.7222249507904
Epoch: 6, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.471 Vali Acc: 0.285 Test Loss: 1.471 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 74.66710424423218
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.637 Vali Acc: 0.281 Test Loss: 1.637 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 75.6228699684143
Epoch: 8, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.683 Vali Acc: 0.266 Test Loss: 1.683 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 78.9214129447937
Epoch: 9, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.776 Vali Acc: 0.266 Test Loss: 1.776 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 68.40804958343506
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 2.099 Vali Acc: 0.266 Test Loss: 2.099 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 65.5603654384613
Epoch: 11, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.837 Vali Acc: 0.262 Test Loss: 1.837 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 68.86681747436523
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.806 Vali Acc: 0.224 Test Loss: 1.806 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 65.45307850837708
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.673 Vali Acc: 0.274 Test Loss: 1.673 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 68.79735016822815
Epoch: 14, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.005 Vali Acc: 0.278 Test Loss: 2.005 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 71.28642439842224
Epoch: 15, Steps: 17 | Train Loss: 1.035 Vali Loss: 2.131 Vali Acc: 0.247 Test Loss: 2.131 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 70.23331427574158
Epoch: 16, Steps: 17 | Train Loss: 0.924 Vali Loss: 2.088 Vali Acc: 0.259 Test Loss: 2.088 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 9600100
model size : 37.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 27.99569535255432
Epoch: 1, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.841 Vali Acc: 0.251 Test Loss: 1.841 Test Acc: 0.251
Validation loss decreased (inf --> -0.250932).  Saving model ...
Epoch: 2 cost time: 24.493572235107422
Epoch: 2, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.464 Vali Acc: 0.262 Test Loss: 1.464 Test Acc: 0.262
Validation loss decreased (-0.250932 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 26.66683840751648
Epoch: 3, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.643 Vali Acc: 0.289 Test Loss: 1.643 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288957).  Saving model ...
Epoch: 4 cost time: 28.044081211090088
Epoch: 4, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.448 Vali Acc: 0.221 Test Loss: 1.448 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.97779130935669
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.639 Vali Acc: 0.232 Test Loss: 1.639 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 30.325478315353394
Epoch: 6, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.622 Vali Acc: 0.274 Test Loss: 1.622 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 30.61477828025818
Epoch: 7, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.732 Vali Acc: 0.255 Test Loss: 1.732 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.399505853652954
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.634 Vali Acc: 0.259 Test Loss: 1.634 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 27.542850494384766
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.055 Vali Acc: 0.262 Test Loss: 2.055 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.225114583969116
Epoch: 10, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.697 Vali Acc: 0.236 Test Loss: 1.697 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.784719944000244
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.819 Vali Acc: 0.300 Test Loss: 1.819 Test Acc: 0.300
Validation loss decreased (-0.288957 --> -0.300362).  Saving model ...
Epoch: 12 cost time: 28.20660424232483
Epoch: 12, Steps: 17 | Train Loss: 1.163 Vali Loss: 2.474 Vali Acc: 0.255 Test Loss: 2.474 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 27.161729335784912
Epoch: 13, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.633 Vali Acc: 0.278 Test Loss: 1.633 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 27.668193578720093
Epoch: 14, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.891 Vali Acc: 0.278 Test Loss: 1.891 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 25.30359125137329
Epoch: 15, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.066 Vali Acc: 0.217 Test Loss: 2.066 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 25.918297290802002
Epoch: 16, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.809 Vali Acc: 0.270 Test Loss: 1.809 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 26.547556161880493
Epoch: 17, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.944 Vali Acc: 0.240 Test Loss: 1.944 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 28.07247495651245
Epoch: 18, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.072 Vali Acc: 0.278 Test Loss: 2.072 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 30.047693252563477
Epoch: 19, Steps: 17 | Train Loss: 0.777 Vali Loss: 2.054 Vali Acc: 0.270 Test Loss: 2.054 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 28.390443086624146
Epoch: 20, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.387 Vali Acc: 0.262 Test Loss: 2.387 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 29.827631950378418
Epoch: 21, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.609 Vali Acc: 0.259 Test Loss: 2.609 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 2979684
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 35.4489905834198
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.526 Vali Acc: 0.243 Test Loss: 1.526 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 36.542211294174194
Epoch: 2, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.787 Vali Acc: 0.274 Test Loss: 1.787 Test Acc: 0.274
Validation loss decreased (-0.243331 --> -0.273746).  Saving model ...
Epoch: 3 cost time: 35.51039505004883
Epoch: 3, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.515 Vali Acc: 0.217 Test Loss: 1.515 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.18750047683716
Epoch: 4, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.612 Vali Acc: 0.243 Test Loss: 1.612 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 39.827094078063965
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.807 Vali Acc: 0.251 Test Loss: 1.807 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 38.182472944259644
Epoch: 6, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.471 Vali Acc: 0.285 Test Loss: 1.471 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 38.91869521141052
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.637 Vali Acc: 0.281 Test Loss: 1.637 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 37.16665005683899
Epoch: 8, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.683 Vali Acc: 0.266 Test Loss: 1.683 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 36.5663583278656
Epoch: 9, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.776 Vali Acc: 0.266 Test Loss: 1.776 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 36.837892293930054
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 2.099 Vali Acc: 0.266 Test Loss: 2.099 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 36.33736753463745
Epoch: 11, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.837 Vali Acc: 0.262 Test Loss: 1.837 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 38.96050453186035
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.806 Vali Acc: 0.224 Test Loss: 1.806 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 35.4807243347168
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.673 Vali Acc: 0.274 Test Loss: 1.673 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 36.601956605911255
Epoch: 14, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.005 Vali Acc: 0.278 Test Loss: 2.005 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 33.54607343673706
Epoch: 15, Steps: 17 | Train Loss: 1.035 Vali Loss: 2.131 Vali Acc: 0.247 Test Loss: 2.131 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 49.94723439216614
Epoch: 16, Steps: 17 | Train Loss: 0.924 Vali Loss: 2.088 Vali Acc: 0.259 Test Loss: 2.088 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 9600100
model size : 37.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.85703945159912
Epoch: 1, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.841 Vali Acc: 0.251 Test Loss: 1.841 Test Acc: 0.251
Validation loss decreased (inf --> -0.250932).  Saving model ...
Epoch: 2 cost time: 22.73465871810913
Epoch: 2, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.464 Vali Acc: 0.262 Test Loss: 1.464 Test Acc: 0.262
Validation loss decreased (-0.250932 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 20.22438669204712
Epoch: 3, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.643 Vali Acc: 0.289 Test Loss: 1.643 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288957).  Saving model ...
Epoch: 4 cost time: 23.139820337295532
Epoch: 4, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.448 Vali Acc: 0.221 Test Loss: 1.448 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.877808570861816
Epoch: 5, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.639 Vali Acc: 0.232 Test Loss: 1.639 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.031596183776855
Epoch: 6, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.622 Vali Acc: 0.274 Test Loss: 1.622 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.438416719436646
Epoch: 7, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.732 Vali Acc: 0.255 Test Loss: 1.732 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.203877687454224
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.634 Vali Acc: 0.259 Test Loss: 1.634 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.5678071975708
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.055 Vali Acc: 0.262 Test Loss: 2.055 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.786680698394775
Epoch: 10, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.697 Vali Acc: 0.236 Test Loss: 1.697 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.324239015579224
Epoch: 11, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.819 Vali Acc: 0.300 Test Loss: 1.819 Test Acc: 0.300
Validation loss decreased (-0.288957 --> -0.300362).  Saving model ...
Epoch: 12 cost time: 23.53668999671936
Epoch: 12, Steps: 17 | Train Loss: 1.163 Vali Loss: 2.475 Vali Acc: 0.255 Test Loss: 2.475 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.630606174468994
Epoch: 13, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.633 Vali Acc: 0.278 Test Loss: 1.633 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.472397327423096
Epoch: 14, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.891 Vali Acc: 0.278 Test Loss: 1.891 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.103228092193604
Epoch: 15, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.067 Vali Acc: 0.221 Test Loss: 2.067 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.959969758987427
Epoch: 16, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.812 Vali Acc: 0.266 Test Loss: 1.812 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.517711639404297
Epoch: 17, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.955 Vali Acc: 0.228 Test Loss: 1.955 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 22.781415224075317
Epoch: 18, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.094 Vali Acc: 0.281 Test Loss: 2.094 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 23.824103593826294
Epoch: 19, Steps: 17 | Train Loss: 0.783 Vali Loss: 2.065 Vali Acc: 0.262 Test Loss: 2.065 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 22.80976414680481
Epoch: 20, Steps: 17 | Train Loss: 0.798 Vali Loss: 2.460 Vali Acc: 0.259 Test Loss: 2.460 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 22.93708896636963
Epoch: 21, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.261 Vali Acc: 0.232 Test Loss: 2.261 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 2979684
model size : 12.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 69.62742137908936
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.431 Vali Acc: 0.262 Test Loss: 1.431 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 68.81749129295349
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 69.08437037467957
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.524 Vali Acc: 0.297 Test Loss: 1.524 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296563).  Saving model ...
Epoch: 4 cost time: 62.61498546600342
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.956 Vali Acc: 0.251 Test Loss: 1.956 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 59.83599638938904
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.470 Vali Acc: 0.289 Test Loss: 1.470 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 63.66383719444275
Epoch: 6, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.699 Vali Acc: 0.243 Test Loss: 1.699 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 65.49193048477173
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.841 Vali Acc: 0.262 Test Loss: 1.841 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 65.31002378463745
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.809 Vali Acc: 0.240 Test Loss: 1.809 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 56.472243547439575
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.788 Vali Acc: 0.236 Test Loss: 1.788 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 64.48110556602478
Epoch: 10, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.750 Vali Acc: 0.281 Test Loss: 1.750 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 65.22594451904297
Epoch: 11, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.657 Vali Acc: 0.270 Test Loss: 1.657 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 65.33720755577087
Epoch: 12, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.823 Vali Acc: 0.274 Test Loss: 1.823 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 65.75689697265625
Epoch: 13, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.857 Vali Acc: 0.266 Test Loss: 1.857 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 4912740
model size : 19.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 31.47981882095337
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 31.01536202430725
Epoch: 2, Steps: 17 | Train Loss: 1.740 Vali Loss: 1.952 Vali Acc: 0.262 Test Loss: 1.952 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262338).  Saving model ...
Epoch: 3 cost time: 28.190539836883545
Epoch: 3, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.917 Vali Acc: 0.247 Test Loss: 1.917 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.02274990081787
Epoch: 4, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.190 Vali Acc: 0.247 Test Loss: 2.190 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.84513020515442
Epoch: 5, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.881 Vali Acc: 0.323 Test Loss: 1.881 Test Acc: 0.323
Validation loss decreased (-0.262338 --> -0.323175).  Saving model ...
Epoch: 6 cost time: 28.569833517074585
Epoch: 6, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.528 Vali Acc: 0.278 Test Loss: 1.528 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.374430656433105
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.561 Vali Acc: 0.240 Test Loss: 1.561 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 28.666133642196655
Epoch: 8, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.511083602905273
Epoch: 9, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.525 Vali Acc: 0.274 Test Loss: 1.525 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.880574226379395
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.603 Vali Acc: 0.236 Test Loss: 1.603 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.66407060623169
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.923 Vali Acc: 0.293 Test Loss: 1.923 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 29.169661045074463
Epoch: 12, Steps: 17 | Train Loss: 1.386 Vali Loss: 2.300 Vali Acc: 0.323 Test Loss: 2.300 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 28.93589448928833
Epoch: 13, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.955 Vali Acc: 0.262 Test Loss: 1.955 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 27.8673574924469
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.748 Vali Acc: 0.270 Test Loss: 1.748 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 28.809043407440186
Epoch: 15, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.042 Vali Acc: 0.297 Test Loss: 2.042 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 1602404
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 46.339813232421875
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.431 Vali Acc: 0.262 Test Loss: 1.431 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 46.95690679550171
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 45.968459129333496
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.524 Vali Acc: 0.297 Test Loss: 1.524 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296563).  Saving model ...
Epoch: 4 cost time: 43.49874448776245
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.956 Vali Acc: 0.251 Test Loss: 1.956 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 46.18358039855957
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.470 Vali Acc: 0.289 Test Loss: 1.470 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 43.94338536262512
Epoch: 6, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.699 Vali Acc: 0.243 Test Loss: 1.699 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 40.96638631820679
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.841 Vali Acc: 0.262 Test Loss: 1.841 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 46.29315257072449
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.809 Vali Acc: 0.240 Test Loss: 1.809 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 47.54233002662659
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.788 Vali Acc: 0.236 Test Loss: 1.788 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 48.618703842163086
Epoch: 10, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.750 Vali Acc: 0.281 Test Loss: 1.750 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 44.37846565246582
Epoch: 11, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.657 Vali Acc: 0.270 Test Loss: 1.657 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 45.079723596572876
Epoch: 12, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.823 Vali Acc: 0.274 Test Loss: 1.823 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 44.22413492202759
Epoch: 13, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.857 Vali Acc: 0.266 Test Loss: 1.857 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 4912740
model size : 19.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 22.724671602249146
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 20.99568247795105
Epoch: 2, Steps: 17 | Train Loss: 1.740 Vali Loss: 1.952 Vali Acc: 0.262 Test Loss: 1.952 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262338).  Saving model ...
Epoch: 3 cost time: 15.883676528930664
Epoch: 3, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.917 Vali Acc: 0.247 Test Loss: 1.917 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.68913769721985
Epoch: 4, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.190 Vali Acc: 0.247 Test Loss: 2.190 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.526817560195923
Epoch: 5, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.881 Vali Acc: 0.323 Test Loss: 1.881 Test Acc: 0.323
Validation loss decreased (-0.262338 --> -0.323175).  Saving model ...
Epoch: 6 cost time: 21.29382300376892
Epoch: 6, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.528 Vali Acc: 0.278 Test Loss: 1.528 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.84299945831299
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.561 Vali Acc: 0.240 Test Loss: 1.561 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.92789077758789
Epoch: 8, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.552922248840332
Epoch: 9, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.525 Vali Acc: 0.274 Test Loss: 1.525 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.202375173568726
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.603 Vali Acc: 0.236 Test Loss: 1.603 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.08455228805542
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.923 Vali Acc: 0.293 Test Loss: 1.923 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 20.11829400062561
Epoch: 12, Steps: 17 | Train Loss: 1.386 Vali Loss: 2.300 Vali Acc: 0.323 Test Loss: 2.300 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 19.632503747940063
Epoch: 13, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.955 Vali Acc: 0.262 Test Loss: 1.955 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 18.811827659606934
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.747 Vali Acc: 0.270 Test Loss: 1.747 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 20.139972448349
Epoch: 15, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.042 Vali Acc: 0.297 Test Loss: 2.042 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 1602404
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 29.201883554458618
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.431 Vali Acc: 0.262 Test Loss: 1.431 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 29.63377618789673
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.412 Vali Acc: 0.236 Test Loss: 1.412 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.74193024635315
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.524 Vali Acc: 0.297 Test Loss: 1.524 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296563).  Saving model ...
Epoch: 4 cost time: 29.50335669517517
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.956 Vali Acc: 0.251 Test Loss: 1.956 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.81273317337036
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.470 Vali Acc: 0.289 Test Loss: 1.470 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.077887058258057
Epoch: 6, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.699 Vali Acc: 0.243 Test Loss: 1.699 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.862698078155518
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.841 Vali Acc: 0.262 Test Loss: 1.841 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 29.03789710998535
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.809 Vali Acc: 0.240 Test Loss: 1.809 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 29.06075644493103
Epoch: 9, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.788 Vali Acc: 0.236 Test Loss: 1.788 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 28.01567816734314
Epoch: 10, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.750 Vali Acc: 0.281 Test Loss: 1.750 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 28.60917067527771
Epoch: 11, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.657 Vali Acc: 0.270 Test Loss: 1.657 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 26.711945056915283
Epoch: 12, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.823 Vali Acc: 0.274 Test Loss: 1.823 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.093460083007812
Epoch: 13, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.857 Vali Acc: 0.266 Test Loss: 1.857 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 4912740
model size : 19.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.700082302093506
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 13.740170001983643
Epoch: 2, Steps: 17 | Train Loss: 1.740 Vali Loss: 1.952 Vali Acc: 0.262 Test Loss: 1.952 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262338).  Saving model ...
Epoch: 3 cost time: 13.563474893569946
Epoch: 3, Steps: 17 | Train Loss: 1.693 Vali Loss: 1.917 Vali Acc: 0.247 Test Loss: 1.917 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.238168001174927
Epoch: 4, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.190 Vali Acc: 0.247 Test Loss: 2.190 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.701056480407715
Epoch: 5, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.881 Vali Acc: 0.323 Test Loss: 1.881 Test Acc: 0.323
Validation loss decreased (-0.262338 --> -0.323175).  Saving model ...
Epoch: 6 cost time: 14.627676486968994
Epoch: 6, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.528 Vali Acc: 0.278 Test Loss: 1.528 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.061071157455444
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.561 Vali Acc: 0.240 Test Loss: 1.561 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.446273803710938
Epoch: 8, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.829798460006714
Epoch: 9, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.525 Vali Acc: 0.274 Test Loss: 1.525 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.197059392929077
Epoch: 10, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.603 Vali Acc: 0.236 Test Loss: 1.603 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.22279667854309
Epoch: 11, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.923 Vali Acc: 0.293 Test Loss: 1.923 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.647403240203857
Epoch: 12, Steps: 17 | Train Loss: 1.386 Vali Loss: 2.300 Vali Acc: 0.323 Test Loss: 2.300 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.646330118179321
Epoch: 13, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.955 Vali Acc: 0.262 Test Loss: 1.955 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.045916557312012
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.747 Vali Acc: 0.270 Test Loss: 1.747 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.71063232421875
Epoch: 15, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.042 Vali Acc: 0.297 Test Loss: 2.042 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 1602404
model size : 6.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 42.86327862739563
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 41.22626256942749
Epoch: 2, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.552 Vali Acc: 0.259 Test Loss: 1.552 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.920639753341675
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.563 Vali Acc: 0.243 Test Loss: 1.563 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.955939531326294
Epoch: 4, Steps: 17 | Train Loss: 1.433 Vali Loss: 2.043 Vali Acc: 0.247 Test Loss: 2.043 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 39.489904165267944
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.783 Vali Acc: 0.240 Test Loss: 1.783 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 38.44267296791077
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.802 Vali Acc: 0.281 Test Loss: 1.802 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281351).  Saving model ...
Epoch: 7 cost time: 41.66116213798523
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.4658362865448
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.680 Vali Acc: 0.270 Test Loss: 1.680 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 41.89085078239441
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.170 Vali Acc: 0.240 Test Loss: 2.170 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 41.049763441085815
Epoch: 10, Steps: 17 | Train Loss: 1.478 Vali Loss: 2.225 Vali Acc: 0.232 Test Loss: 2.225 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 40.11546325683594
Epoch: 11, Steps: 17 | Train Loss: 1.492 Vali Loss: 2.023 Vali Acc: 0.270 Test Loss: 2.023 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 40.37077713012695
Epoch: 12, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.282 Vali Acc: 0.255 Test Loss: 2.282 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 32.87427306175232
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.686 Vali Acc: 0.270 Test Loss: 1.686 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 37.82241773605347
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.848 Vali Acc: 0.274 Test Loss: 1.848 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 38.200669288635254
Epoch: 15, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.680 Vali Acc: 0.274 Test Loss: 1.680 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 37.08293175697327
Epoch: 16, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.064 Vali Acc: 0.247 Test Loss: 2.064 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2569060
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.95823311805725
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.770 Vali Acc: 0.266 Test Loss: 1.770 Test Acc: 0.266
Validation loss decreased (inf --> -0.266142).  Saving model ...
Epoch: 2 cost time: 17.64050793647766
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.565879583358765
Epoch: 3, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.696 Vali Acc: 0.319 Test Loss: 1.696 Test Acc: 0.319
Validation loss decreased (-0.266142 --> -0.319375).  Saving model ...
Epoch: 4 cost time: 19.237510442733765
Epoch: 4, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.529 Vali Acc: 0.274 Test Loss: 1.529 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.704057693481445
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.12712049484253
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.577 Vali Acc: 0.278 Test Loss: 1.577 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 19.68145990371704
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.543 Vali Acc: 0.266 Test Loss: 1.543 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.99573516845703
Epoch: 8, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.845 Vali Acc: 0.266 Test Loss: 1.845 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.868075609207153
Epoch: 9, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.044039487838745
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.648 Vali Acc: 0.293 Test Loss: 1.648 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 18.671067476272583
Epoch: 11, Steps: 17 | Train Loss: 1.392 Vali Loss: 2.219 Vali Acc: 0.243 Test Loss: 2.219 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.783811807632446
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.865 Vali Acc: 0.266 Test Loss: 1.865 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 18.14790153503418
Epoch: 13, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.654 Vali Acc: 0.300 Test Loss: 1.654 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 913764
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 32.748947858810425
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 30.59904193878174
Epoch: 2, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.552 Vali Acc: 0.259 Test Loss: 1.552 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.304731607437134
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.563 Vali Acc: 0.243 Test Loss: 1.563 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.53390669822693
Epoch: 4, Steps: 17 | Train Loss: 1.433 Vali Loss: 2.043 Vali Acc: 0.247 Test Loss: 2.043 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 28.478253602981567
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.783 Vali Acc: 0.240 Test Loss: 1.783 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 29.762842893600464
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.802 Vali Acc: 0.281 Test Loss: 1.802 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281351).  Saving model ...
Epoch: 7 cost time: 27.6770281791687
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 29.35243034362793
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.680 Vali Acc: 0.270 Test Loss: 1.680 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.87109398841858
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.170 Vali Acc: 0.240 Test Loss: 2.170 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.451354026794434
Epoch: 10, Steps: 17 | Train Loss: 1.478 Vali Loss: 2.225 Vali Acc: 0.232 Test Loss: 2.225 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.064502716064453
Epoch: 11, Steps: 17 | Train Loss: 1.492 Vali Loss: 2.023 Vali Acc: 0.270 Test Loss: 2.023 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 31.169022798538208
Epoch: 12, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.282 Vali Acc: 0.255 Test Loss: 2.282 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 29.80998396873474
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.686 Vali Acc: 0.270 Test Loss: 1.686 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 30.541845321655273
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.848 Vali Acc: 0.274 Test Loss: 1.848 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 29.93355965614319
Epoch: 15, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.680 Vali Acc: 0.274 Test Loss: 1.680 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 31.279327630996704
Epoch: 16, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.064 Vali Acc: 0.247 Test Loss: 2.064 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2569060
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.688739776611328
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.770 Vali Acc: 0.266 Test Loss: 1.770 Test Acc: 0.266
Validation loss decreased (inf --> -0.266142).  Saving model ...
Epoch: 2 cost time: 15.220831394195557
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.244579553604126
Epoch: 3, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.696 Vali Acc: 0.319 Test Loss: 1.696 Test Acc: 0.319
Validation loss decreased (-0.266142 --> -0.319375).  Saving model ...
Epoch: 4 cost time: 14.709368228912354
Epoch: 4, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.529 Vali Acc: 0.274 Test Loss: 1.529 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.244068622589111
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.81136965751648
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.577 Vali Acc: 0.278 Test Loss: 1.577 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.457934617996216
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.543 Vali Acc: 0.266 Test Loss: 1.543 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.249746322631836
Epoch: 8, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.845 Vali Acc: 0.266 Test Loss: 1.845 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.931835651397705
Epoch: 9, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.936863660812378
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.648 Vali Acc: 0.293 Test Loss: 1.648 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 14.258141040802002
Epoch: 11, Steps: 17 | Train Loss: 1.392 Vali Loss: 2.219 Vali Acc: 0.243 Test Loss: 2.219 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.510900735855103
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.865 Vali Acc: 0.266 Test Loss: 1.865 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.823807716369629
Epoch: 13, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.654 Vali Acc: 0.300 Test Loss: 1.654 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 913764
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.820379734039307
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 19.79814386367798
Epoch: 2, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.552 Vali Acc: 0.259 Test Loss: 1.552 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.64780569076538
Epoch: 3, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.563 Vali Acc: 0.243 Test Loss: 1.563 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.4599289894104
Epoch: 4, Steps: 17 | Train Loss: 1.433 Vali Loss: 2.043 Vali Acc: 0.247 Test Loss: 2.043 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.17675280570984
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.783 Vali Acc: 0.240 Test Loss: 1.783 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.568530797958374
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.802 Vali Acc: 0.281 Test Loss: 1.802 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281351).  Saving model ...
Epoch: 7 cost time: 19.898341417312622
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.681 Vali Acc: 0.236 Test Loss: 1.681 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.10030770301819
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.680 Vali Acc: 0.270 Test Loss: 1.680 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.67531132698059
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.170 Vali Acc: 0.240 Test Loss: 2.170 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.48049807548523
Epoch: 10, Steps: 17 | Train Loss: 1.478 Vali Loss: 2.225 Vali Acc: 0.232 Test Loss: 2.225 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.66304874420166
Epoch: 11, Steps: 17 | Train Loss: 1.492 Vali Loss: 2.023 Vali Acc: 0.270 Test Loss: 2.023 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 18.270813941955566
Epoch: 12, Steps: 17 | Train Loss: 1.355 Vali Loss: 2.282 Vali Acc: 0.255 Test Loss: 2.282 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 19.206796407699585
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.686 Vali Acc: 0.270 Test Loss: 1.686 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 19.70344042778015
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.848 Vali Acc: 0.274 Test Loss: 1.848 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.644126415252686
Epoch: 15, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.680 Vali Acc: 0.274 Test Loss: 1.680 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 19.509740114212036
Epoch: 16, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.064 Vali Acc: 0.247 Test Loss: 2.064 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 2569060
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.079466819763184
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.770 Vali Acc: 0.266 Test Loss: 1.770 Test Acc: 0.266
Validation loss decreased (inf --> -0.266142).  Saving model ...
Epoch: 2 cost time: 8.21802830696106
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.258239984512329
Epoch: 3, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.696 Vali Acc: 0.319 Test Loss: 1.696 Test Acc: 0.319
Validation loss decreased (-0.266142 --> -0.319375).  Saving model ...
Epoch: 4 cost time: 10.245626449584961
Epoch: 4, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.529 Vali Acc: 0.274 Test Loss: 1.529 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.80105209350586
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.532726049423218
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.577 Vali Acc: 0.278 Test Loss: 1.577 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.91538381576538
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.543 Vali Acc: 0.266 Test Loss: 1.543 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.98395824432373
Epoch: 8, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.845 Vali Acc: 0.266 Test Loss: 1.845 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.199223279953003
Epoch: 9, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.04914927482605
Epoch: 10, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.648 Vali Acc: 0.293 Test Loss: 1.648 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.471649885177612
Epoch: 11, Steps: 17 | Train Loss: 1.392 Vali Loss: 2.219 Vali Acc: 0.243 Test Loss: 2.219 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.849475383758545
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.865 Vali Acc: 0.266 Test Loss: 1.865 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.948493242263794
Epoch: 13, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.654 Vali Acc: 0.300 Test Loss: 1.654 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 913764
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 50.80671954154968
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 51.262939453125
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.571 Vali Acc: 0.262 Test Loss: 1.571 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 52.6967339515686
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.448 Vali Acc: 0.251 Test Loss: 1.448 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 49.55872964859009
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.510 Vali Acc: 0.228 Test Loss: 1.510 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 49.68199157714844
Epoch: 5, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 48.34105634689331
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.544 Vali Acc: 0.228 Test Loss: 1.544 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 48.03374361991882
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.493 Vali Acc: 0.293 Test Loss: 1.493 Test Acc: 0.293
Validation loss decreased (-0.262342 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 41.42748403549194
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 47.82287311553955
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.598 Vali Acc: 0.236 Test Loss: 1.598 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 50.14650368690491
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 50.60484266281128
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.527 Vali Acc: 0.262 Test Loss: 1.527 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 50.49204969406128
Epoch: 12, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.729 Vali Acc: 0.247 Test Loss: 1.729 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 52.37321209907532
Epoch: 13, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.641 Vali Acc: 0.228 Test Loss: 1.641 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 48.535645484924316
Epoch: 14, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.675 Vali Acc: 0.281 Test Loss: 1.675 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 48.18510174751282
Epoch: 15, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 47.81157636642456
Epoch: 16, Steps: 17 | Train Loss: 1.073 Vali Loss: 2.044 Vali Acc: 0.251 Test Loss: 2.044 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 47.50332045555115
Epoch: 17, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.879 Vali Acc: 0.259 Test Loss: 1.879 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2457140
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.416215419769287
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.382 Vali Acc: 0.240 Test Loss: 1.382 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 21.461392402648926
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.456 Vali Acc: 0.251 Test Loss: 1.456 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 20.042223691940308
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 21.454595804214478
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.070632934570312
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.561 Vali Acc: 0.228 Test Loss: 1.561 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.28581714630127
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 7 cost time: 20.935156106948853
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.577 Vali Acc: 0.247 Test Loss: 1.577 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.129085302352905
Epoch: 8, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.638 Vali Acc: 0.255 Test Loss: 1.638 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.453811407089233
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.631 Vali Acc: 0.232 Test Loss: 1.631 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.347636699676514
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.684 Vali Acc: 0.251 Test Loss: 1.684 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.569809675216675
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.032835960388184
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.695 Vali Acc: 0.281 Test Loss: 1.695 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281352).  Saving model ...
Epoch: 13 cost time: 21.395301342010498
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.562 Vali Acc: 0.251 Test Loss: 1.562 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.545161724090576
Epoch: 14, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.604 Vali Acc: 0.243 Test Loss: 1.604 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.08747696876526
Epoch: 15, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.958 Vali Acc: 0.278 Test Loss: 1.958 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.029283046722412
Epoch: 16, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.648 Vali Acc: 0.259 Test Loss: 1.648 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.949832439422607
Epoch: 17, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.829 Vali Acc: 0.285 Test Loss: 1.829 Test Acc: 0.285
Validation loss decreased (-0.281352 --> -0.285153).  Saving model ...
Epoch: 18 cost time: 22.037250995635986
Epoch: 18, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.930 Vali Acc: 0.266 Test Loss: 1.930 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.744138956069946
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.965 Vali Acc: 0.255 Test Loss: 1.965 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.108906030654907
Epoch: 20, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.975 Vali Acc: 0.247 Test Loss: 1.975 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.846078872680664
Epoch: 21, Steps: 17 | Train Loss: 0.778 Vali Loss: 2.307 Vali Acc: 0.232 Test Loss: 2.307 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 23.253281116485596
Epoch: 22, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.009 Vali Acc: 0.297 Test Loss: 2.009 Test Acc: 0.297
Validation loss decreased (-0.285153 --> -0.296558).  Saving model ...
Epoch: 23 cost time: 18.829737901687622
Epoch: 23, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.052 Vali Acc: 0.247 Test Loss: 2.052 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.41248059272766
Epoch: 24, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.112 Vali Acc: 0.300 Test Loss: 2.112 Test Acc: 0.300
Validation loss decreased (-0.296558 --> -0.300359).  Saving model ...
Epoch: 25 cost time: 21.453855991363525
Epoch: 25, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.357 Vali Acc: 0.281 Test Loss: 2.357 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 21.966090440750122
Epoch: 26, Steps: 17 | Train Loss: 0.669 Vali Loss: 2.417 Vali Acc: 0.240 Test Loss: 2.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 20.763049125671387
Epoch: 27, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.433 Vali Acc: 0.293 Test Loss: 2.433 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 21.960482835769653
Epoch: 28, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.626 Vali Acc: 0.243 Test Loss: 2.626 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 18.812535762786865
Epoch: 29, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.538 Vali Acc: 0.274 Test Loss: 2.538 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 23.320491790771484
Epoch: 30, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.695 Vali Acc: 0.240 Test Loss: 2.695 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 801716
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 39.59588384628296
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 40.0243444442749
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.571 Vali Acc: 0.262 Test Loss: 1.571 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 37.11282181739807
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.448 Vali Acc: 0.251 Test Loss: 1.448 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 39.75344753265381
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.510 Vali Acc: 0.228 Test Loss: 1.510 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 37.707048654556274
Epoch: 5, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 39.98361086845398
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.544 Vali Acc: 0.228 Test Loss: 1.544 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 34.63981294631958
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.493 Vali Acc: 0.293 Test Loss: 1.493 Test Acc: 0.293
Validation loss decreased (-0.262342 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 35.46566605567932
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.1379976272583
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.598 Vali Acc: 0.236 Test Loss: 1.598 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 34.43570852279663
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 36.78373074531555
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.527 Vali Acc: 0.262 Test Loss: 1.527 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 37.22056603431702
Epoch: 12, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.729 Vali Acc: 0.247 Test Loss: 1.729 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 39.13883662223816
Epoch: 13, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.640 Vali Acc: 0.228 Test Loss: 1.640 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 39.41862630844116
Epoch: 14, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.675 Vali Acc: 0.281 Test Loss: 1.675 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 37.78523397445679
Epoch: 15, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 39.292277097702026
Epoch: 16, Steps: 17 | Train Loss: 1.073 Vali Loss: 2.044 Vali Acc: 0.251 Test Loss: 2.044 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 34.472071409225464
Epoch: 17, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.879 Vali Acc: 0.259 Test Loss: 1.879 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2457140
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.60626745223999
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.382 Vali Acc: 0.240 Test Loss: 1.382 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 16.83412194252014
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.456 Vali Acc: 0.251 Test Loss: 1.456 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 15.636666059494019
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 17.20251154899597
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.994771003723145
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.561 Vali Acc: 0.228 Test Loss: 1.561 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.8860023021698
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 7 cost time: 17.649025440216064
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.577 Vali Acc: 0.247 Test Loss: 1.577 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.497214317321777
Epoch: 8, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.638 Vali Acc: 0.255 Test Loss: 1.638 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 18.40953016281128
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.631 Vali Acc: 0.232 Test Loss: 1.631 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.523227214813232
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.684 Vali Acc: 0.251 Test Loss: 1.684 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.996322631835938
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.157853841781616
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.695 Vali Acc: 0.281 Test Loss: 1.695 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281352).  Saving model ...
Epoch: 13 cost time: 17.88886046409607
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.562 Vali Acc: 0.251 Test Loss: 1.562 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.348556995391846
Epoch: 14, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.604 Vali Acc: 0.247 Test Loss: 1.604 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.192548751831055
Epoch: 15, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.958 Vali Acc: 0.278 Test Loss: 1.958 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.588697910308838
Epoch: 16, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.648 Vali Acc: 0.259 Test Loss: 1.648 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.293083906173706
Epoch: 17, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.829 Vali Acc: 0.285 Test Loss: 1.829 Test Acc: 0.285
Validation loss decreased (-0.281352 --> -0.285153).  Saving model ...
Epoch: 18 cost time: 17.268279790878296
Epoch: 18, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.930 Vali Acc: 0.266 Test Loss: 1.930 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.733372449874878
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.965 Vali Acc: 0.255 Test Loss: 1.965 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 17.659613370895386
Epoch: 20, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.975 Vali Acc: 0.247 Test Loss: 1.975 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 17.209637880325317
Epoch: 21, Steps: 17 | Train Loss: 0.778 Vali Loss: 2.307 Vali Acc: 0.232 Test Loss: 2.307 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 15.678318738937378
Epoch: 22, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.009 Vali Acc: 0.297 Test Loss: 2.009 Test Acc: 0.297
Validation loss decreased (-0.285153 --> -0.296558).  Saving model ...
Epoch: 23 cost time: 17.0079927444458
Epoch: 23, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.052 Vali Acc: 0.247 Test Loss: 2.052 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 17.188605546951294
Epoch: 24, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.112 Vali Acc: 0.304 Test Loss: 2.112 Test Acc: 0.304
Validation loss decreased (-0.296558 --> -0.304161).  Saving model ...
Epoch: 25 cost time: 14.982536554336548
Epoch: 25, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.358 Vali Acc: 0.281 Test Loss: 2.358 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 16.248645544052124
Epoch: 26, Steps: 17 | Train Loss: 0.669 Vali Loss: 2.417 Vali Acc: 0.240 Test Loss: 2.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 17.078190326690674
Epoch: 27, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.433 Vali Acc: 0.293 Test Loss: 2.433 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 17.775901317596436
Epoch: 28, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.626 Vali Acc: 0.243 Test Loss: 2.626 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 18.023897647857666
Epoch: 29, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.538 Vali Acc: 0.274 Test Loss: 2.538 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 17.782286882400513
Epoch: 30, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.695 Vali Acc: 0.240 Test Loss: 2.695 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 801716
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 25.57881236076355
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.419 Vali Acc: 0.251 Test Loss: 1.419 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 24.716081857681274
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.571 Vali Acc: 0.262 Test Loss: 1.571 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 24.801421403884888
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.448 Vali Acc: 0.251 Test Loss: 1.448 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.987865447998047
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.510 Vali Acc: 0.228 Test Loss: 1.510 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.523342847824097
Epoch: 5, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.722879648208618
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.544 Vali Acc: 0.228 Test Loss: 1.544 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.860256910324097
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.493 Vali Acc: 0.293 Test Loss: 1.493 Test Acc: 0.293
Validation loss decreased (-0.262342 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 20.505515813827515
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.004682064056396
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.598 Vali Acc: 0.236 Test Loss: 1.598 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.521454334259033
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.15189528465271
Epoch: 11, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.527 Vali Acc: 0.262 Test Loss: 1.527 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 21.532392978668213
Epoch: 12, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.729 Vali Acc: 0.247 Test Loss: 1.729 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.675719261169434
Epoch: 13, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.641 Vali Acc: 0.228 Test Loss: 1.641 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.853121519088745
Epoch: 14, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.675 Vali Acc: 0.281 Test Loss: 1.675 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 21.44032073020935
Epoch: 15, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 22.0992214679718
Epoch: 16, Steps: 17 | Train Loss: 1.073 Vali Loss: 2.044 Vali Acc: 0.251 Test Loss: 2.044 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.633843898773193
Epoch: 17, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.879 Vali Acc: 0.259 Test Loss: 1.879 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2457140
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.288628339767456
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.382 Vali Acc: 0.240 Test Loss: 1.382 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 11.861510515213013
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.456 Vali Acc: 0.251 Test Loss: 1.456 Test Acc: 0.251
Validation loss decreased (-0.239530 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 12.191696405410767
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 10.737355947494507
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.26862096786499
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.561 Vali Acc: 0.228 Test Loss: 1.561 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.109153032302856
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273749).  Saving model ...
Epoch: 7 cost time: 11.741616010665894
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.577 Vali Acc: 0.247 Test Loss: 1.577 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.70924425125122
Epoch: 8, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.638 Vali Acc: 0.255 Test Loss: 1.638 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.695589303970337
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.631 Vali Acc: 0.232 Test Loss: 1.631 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.649858713150024
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.684 Vali Acc: 0.251 Test Loss: 1.684 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.626846313476562
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.681302070617676
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.695 Vali Acc: 0.281 Test Loss: 1.695 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281352).  Saving model ...
Epoch: 13 cost time: 11.356887340545654
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.562 Vali Acc: 0.251 Test Loss: 1.562 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.852200746536255
Epoch: 14, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.604 Vali Acc: 0.247 Test Loss: 1.604 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.342636108398438
Epoch: 15, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.958 Vali Acc: 0.278 Test Loss: 1.958 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.384305477142334
Epoch: 16, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.648 Vali Acc: 0.259 Test Loss: 1.648 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.077546119689941
Epoch: 17, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.829 Vali Acc: 0.285 Test Loss: 1.829 Test Acc: 0.285
Validation loss decreased (-0.281352 --> -0.285153).  Saving model ...
Epoch: 18 cost time: 11.393885850906372
Epoch: 18, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.930 Vali Acc: 0.266 Test Loss: 1.930 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 11.103533744812012
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.965 Vali Acc: 0.255 Test Loss: 1.965 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 10.53310489654541
Epoch: 20, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.975 Vali Acc: 0.247 Test Loss: 1.975 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.334883451461792
Epoch: 21, Steps: 17 | Train Loss: 0.778 Vali Loss: 2.307 Vali Acc: 0.232 Test Loss: 2.307 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 10.596567392349243
Epoch: 22, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.009 Vali Acc: 0.297 Test Loss: 2.009 Test Acc: 0.297
Validation loss decreased (-0.285153 --> -0.296558).  Saving model ...
Epoch: 23 cost time: 10.067640781402588
Epoch: 23, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.052 Vali Acc: 0.247 Test Loss: 2.052 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.691683530807495
Epoch: 24, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.112 Vali Acc: 0.304 Test Loss: 2.112 Test Acc: 0.304
Validation loss decreased (-0.296558 --> -0.304161).  Saving model ...
Epoch: 25 cost time: 10.270930051803589
Epoch: 25, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.357 Vali Acc: 0.281 Test Loss: 2.357 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.148480892181396
Epoch: 26, Steps: 17 | Train Loss: 0.669 Vali Loss: 2.417 Vali Acc: 0.240 Test Loss: 2.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 10.770331382751465
Epoch: 27, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.433 Vali Acc: 0.293 Test Loss: 2.433 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 10.79951024055481
Epoch: 28, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.626 Vali Acc: 0.243 Test Loss: 2.626 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 10.53157377243042
Epoch: 29, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.538 Vali Acc: 0.274 Test Loss: 2.538 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.577149391174316
Epoch: 30, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.695 Vali Acc: 0.240 Test Loss: 2.695 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 801716
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.480762481689453
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.535 Vali Acc: 0.251 Test Loss: 1.535 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 30.41404414176941
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.584 Vali Acc: 0.255 Test Loss: 1.584 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254737).  Saving model ...
Epoch: 3 cost time: 27.960893392562866
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 32.15902876853943
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.604 Vali Acc: 0.255 Test Loss: 1.604 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.44769859313965
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.460 Vali Acc: 0.285 Test Loss: 1.460 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 33.284191608428955
Epoch: 6, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.478 Vali Acc: 0.285 Test Loss: 1.478 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.35543942451477
Epoch: 7, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 32.77597451210022
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.740 Vali Acc: 0.274 Test Loss: 1.740 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 31.700180530548096
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.701 Vali Acc: 0.247 Test Loss: 1.701 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 32.63550686836243
Epoch: 10, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.713 Vali Acc: 0.262 Test Loss: 1.713 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 32.83537530899048
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.596 Vali Acc: 0.270 Test Loss: 1.596 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 28.849891901016235
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.635 Vali Acc: 0.266 Test Loss: 1.635 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 32.19657230377197
Epoch: 13, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.624 Vali Acc: 0.266 Test Loss: 1.624 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 30.95993137359619
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.780 Vali Acc: 0.274 Test Loss: 1.780 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 32.72551965713501
Epoch: 15, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.613 Vali Acc: 0.278 Test Loss: 1.613 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1284916
model size : 5.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.54036545753479
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.413 Vali Acc: 0.247 Test Loss: 1.413 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 15.703964948654175
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.490 Vali Acc: 0.232 Test Loss: 1.490 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.341556310653687
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.850 Vali Acc: 0.247 Test Loss: 1.850 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.991665363311768
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.525 Vali Acc: 0.266 Test Loss: 1.525 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266144).  Saving model ...
Epoch: 5 cost time: 15.018072843551636
Epoch: 5, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.622 Vali Acc: 0.243 Test Loss: 1.622 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.849048852920532
Epoch: 6, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.694 Vali Acc: 0.251 Test Loss: 1.694 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.818046569824219
Epoch: 7, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.121370553970337
Epoch: 8, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.596 Vali Acc: 0.259 Test Loss: 1.596 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 15.246868133544922
Epoch: 9, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.858 Vali Acc: 0.274 Test Loss: 1.858 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273746).  Saving model ...
Epoch: 10 cost time: 14.336651802062988
Epoch: 10, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.604 Vali Acc: 0.236 Test Loss: 1.604 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.046384811401367
Epoch: 11, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.734 Vali Acc: 0.217 Test Loss: 1.734 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.110467910766602
Epoch: 12, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.800 Vali Acc: 0.300 Test Loss: 1.800 Test Acc: 0.300
Validation loss decreased (-0.273746 --> -0.300362).  Saving model ...
Epoch: 13 cost time: 14.164013624191284
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.763 Vali Acc: 0.221 Test Loss: 1.763 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.375514268875122
Epoch: 14, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.828 Vali Acc: 0.281 Test Loss: 1.828 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.426178216934204
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.860 Vali Acc: 0.236 Test Loss: 1.860 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.304642677307129
Epoch: 16, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.016 Vali Acc: 0.270 Test Loss: 2.016 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 14.186498641967773
Epoch: 17, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.881 Vali Acc: 0.217 Test Loss: 1.881 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.574610948562622
Epoch: 18, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.996 Vali Acc: 0.262 Test Loss: 1.996 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.883273601531982
Epoch: 19, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.105 Vali Acc: 0.236 Test Loss: 2.105 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 14.9935142993927
Epoch: 20, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.403 Vali Acc: 0.274 Test Loss: 2.403 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.810864210128784
Epoch: 21, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.311 Vali Acc: 0.240 Test Loss: 2.311 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.261198282241821
Epoch: 22, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.269 Vali Acc: 0.274 Test Loss: 2.269 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 457140
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.105806589126587
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.535 Vali Acc: 0.251 Test Loss: 1.535 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 24.304276704788208
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.584 Vali Acc: 0.255 Test Loss: 1.584 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254737).  Saving model ...
Epoch: 3 cost time: 24.394551753997803
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 23.36422610282898
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.604 Vali Acc: 0.255 Test Loss: 1.604 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.600058555603027
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.460 Vali Acc: 0.285 Test Loss: 1.460 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 21.466740608215332
Epoch: 6, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.478 Vali Acc: 0.285 Test Loss: 1.478 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.934354782104492
Epoch: 7, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.036314249038696
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.740 Vali Acc: 0.274 Test Loss: 1.740 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.225778818130493
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.701 Vali Acc: 0.247 Test Loss: 1.701 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.776408433914185
Epoch: 10, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.713 Vali Acc: 0.262 Test Loss: 1.713 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.2483651638031
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.596 Vali Acc: 0.270 Test Loss: 1.596 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.436737537384033
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.635 Vali Acc: 0.266 Test Loss: 1.635 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 22.89145040512085
Epoch: 13, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.624 Vali Acc: 0.266 Test Loss: 1.624 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 23.865436553955078
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.780 Vali Acc: 0.274 Test Loss: 1.780 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 24.085447311401367
Epoch: 15, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.613 Vali Acc: 0.278 Test Loss: 1.613 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1284916
model size : 5.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.81368374824524
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.413 Vali Acc: 0.247 Test Loss: 1.413 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 12.10043478012085
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.490 Vali Acc: 0.232 Test Loss: 1.490 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.337144374847412
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.850 Vali Acc: 0.247 Test Loss: 1.850 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.940790891647339
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.525 Vali Acc: 0.266 Test Loss: 1.525 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266144).  Saving model ...
Epoch: 5 cost time: 10.10015082359314
Epoch: 5, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.622 Vali Acc: 0.243 Test Loss: 1.622 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.878689765930176
Epoch: 6, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.694 Vali Acc: 0.251 Test Loss: 1.694 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.897434711456299
Epoch: 7, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.553352117538452
Epoch: 8, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.596 Vali Acc: 0.259 Test Loss: 1.596 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.40747594833374
Epoch: 9, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.858 Vali Acc: 0.274 Test Loss: 1.858 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273746).  Saving model ...
Epoch: 10 cost time: 11.634426832199097
Epoch: 10, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.604 Vali Acc: 0.236 Test Loss: 1.604 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.392296075820923
Epoch: 11, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.734 Vali Acc: 0.217 Test Loss: 1.734 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.665914058685303
Epoch: 12, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.800 Vali Acc: 0.300 Test Loss: 1.800 Test Acc: 0.300
Validation loss decreased (-0.273746 --> -0.300362).  Saving model ...
Epoch: 13 cost time: 10.57427453994751
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.763 Vali Acc: 0.221 Test Loss: 1.763 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.145658493041992
Epoch: 14, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.828 Vali Acc: 0.281 Test Loss: 1.828 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.56704068183899
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.860 Vali Acc: 0.236 Test Loss: 1.860 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.05767560005188
Epoch: 16, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.016 Vali Acc: 0.270 Test Loss: 2.016 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.854462623596191
Epoch: 17, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.881 Vali Acc: 0.217 Test Loss: 1.881 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.936395406723022
Epoch: 18, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.996 Vali Acc: 0.262 Test Loss: 1.996 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.04162073135376
Epoch: 19, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.105 Vali Acc: 0.236 Test Loss: 2.105 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.519824504852295
Epoch: 20, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.403 Vali Acc: 0.274 Test Loss: 2.403 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.126291036605835
Epoch: 21, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.311 Vali Acc: 0.240 Test Loss: 2.311 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.14247727394104
Epoch: 22, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.269 Vali Acc: 0.274 Test Loss: 2.269 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 457140
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.056228399276733
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.535 Vali Acc: 0.251 Test Loss: 1.535 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 11.09242558479309
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.584 Vali Acc: 0.255 Test Loss: 1.584 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254737).  Saving model ...
Epoch: 3 cost time: 13.835927248001099
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.401 Vali Acc: 0.266 Test Loss: 1.401 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 14.352604627609253
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.604 Vali Acc: 0.255 Test Loss: 1.604 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.30246114730835
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.460 Vali Acc: 0.285 Test Loss: 1.460 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 12.008468389511108
Epoch: 6, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.478 Vali Acc: 0.285 Test Loss: 1.478 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.675752401351929
Epoch: 7, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.680886268615723
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.740 Vali Acc: 0.274 Test Loss: 1.740 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.646281719207764
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.701 Vali Acc: 0.247 Test Loss: 1.701 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.75496768951416
Epoch: 10, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.713 Vali Acc: 0.262 Test Loss: 1.713 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.807826280593872
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.596 Vali Acc: 0.270 Test Loss: 1.596 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 15.657756090164185
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.635 Vali Acc: 0.266 Test Loss: 1.635 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 16.030884504318237
Epoch: 13, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.624 Vali Acc: 0.266 Test Loss: 1.624 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.597935914993286
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.780 Vali Acc: 0.274 Test Loss: 1.780 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.282928705215454
Epoch: 15, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.613 Vali Acc: 0.278 Test Loss: 1.613 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1284916
model size : 5.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.002656698226929
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.413 Vali Acc: 0.247 Test Loss: 1.413 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 7.537468433380127
Epoch: 2, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.490 Vali Acc: 0.232 Test Loss: 1.490 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.475078344345093
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.850 Vali Acc: 0.247 Test Loss: 1.850 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.4336395263671875
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.525 Vali Acc: 0.266 Test Loss: 1.525 Test Acc: 0.266
Validation loss decreased (-0.247134 --> -0.266144).  Saving model ...
Epoch: 5 cost time: 7.264277219772339
Epoch: 5, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.622 Vali Acc: 0.243 Test Loss: 1.622 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.9499945640563965
Epoch: 6, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.694 Vali Acc: 0.251 Test Loss: 1.694 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.6682822704315186
Epoch: 7, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.491219997406006
Epoch: 8, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.596 Vali Acc: 0.259 Test Loss: 1.596 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.654829502105713
Epoch: 9, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.858 Vali Acc: 0.274 Test Loss: 1.858 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273746).  Saving model ...
Epoch: 10 cost time: 7.985379457473755
Epoch: 10, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.604 Vali Acc: 0.236 Test Loss: 1.604 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.677446126937866
Epoch: 11, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.734 Vali Acc: 0.217 Test Loss: 1.734 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.873003244400024
Epoch: 12, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.800 Vali Acc: 0.300 Test Loss: 1.800 Test Acc: 0.300
Validation loss decreased (-0.273746 --> -0.300362).  Saving model ...
Epoch: 13 cost time: 7.867950439453125
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.763 Vali Acc: 0.221 Test Loss: 1.763 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.204072713851929
Epoch: 14, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.828 Vali Acc: 0.281 Test Loss: 1.828 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.476153135299683
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.860 Vali Acc: 0.236 Test Loss: 1.860 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.29970908164978
Epoch: 16, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.016 Vali Acc: 0.270 Test Loss: 2.016 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.751275300979614
Epoch: 17, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.881 Vali Acc: 0.217 Test Loss: 1.881 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.040529489517212
Epoch: 18, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.996 Vali Acc: 0.262 Test Loss: 1.996 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.697547435760498
Epoch: 19, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.105 Vali Acc: 0.236 Test Loss: 2.105 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.98745322227478
Epoch: 20, Steps: 17 | Train Loss: 0.905 Vali Loss: 2.403 Vali Acc: 0.274 Test Loss: 2.403 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.8753602504730225
Epoch: 21, Steps: 17 | Train Loss: 0.944 Vali Loss: 2.311 Vali Acc: 0.240 Test Loss: 2.311 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.184204339981079
Epoch: 22, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.269 Vali Acc: 0.274 Test Loss: 2.269 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 457140
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 25.315504789352417
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.393 Vali Acc: 0.266 Test Loss: 1.393 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 23.968875408172607
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.595 Vali Acc: 0.255 Test Loss: 1.595 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.756183385849
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 2.136 Vali Acc: 0.251 Test Loss: 2.136 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.078361988067627
Epoch: 4, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.495 Vali Acc: 0.259 Test Loss: 1.495 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 25.404393911361694
Epoch: 5, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.462 Vali Acc: 0.300 Test Loss: 1.462 Test Acc: 0.300
Validation loss decreased (-0.266146 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 24.04053544998169
Epoch: 6, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.434 Vali Acc: 0.293 Test Loss: 1.434 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.892692804336548
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.680 Vali Acc: 0.236 Test Loss: 1.680 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.252898693084717
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.673 Vali Acc: 0.266 Test Loss: 1.673 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 22.03018617630005
Epoch: 9, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.793 Vali Acc: 0.236 Test Loss: 1.793 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.25207257270813
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.899 Vali Acc: 0.266 Test Loss: 1.899 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.824214696884155
Epoch: 11, Steps: 17 | Train Loss: 1.322 Vali Loss: 2.073 Vali Acc: 0.262 Test Loss: 2.073 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.61483383178711
Epoch: 12, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.652 Vali Acc: 0.251 Test Loss: 1.652 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 27.124775171279907
Epoch: 13, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.606 Vali Acc: 0.259 Test Loss: 1.606 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 26.18501353263855
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 25.504961013793945
Epoch: 15, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.903 Vali Acc: 0.270 Test Loss: 1.903 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 698804
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.855541944503784
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.459 Vali Acc: 0.236 Test Loss: 1.459 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 10.49945592880249
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 10.453640222549438
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.559 Vali Acc: 0.255 Test Loss: 1.559 Test Acc: 0.255
Validation loss decreased (-0.243331 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 11.353321552276611
Epoch: 4, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.819 Vali Acc: 0.262 Test Loss: 1.819 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262339).  Saving model ...
Epoch: 5 cost time: 11.361720323562622
Epoch: 5, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.811 Vali Acc: 0.247 Test Loss: 1.811 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.271671056747437
Epoch: 6, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.537 Vali Acc: 0.262 Test Loss: 1.537 Test Acc: 0.262
Validation loss decreased (-0.262339 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 11.197645425796509
Epoch: 7, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.892 Vali Acc: 0.247 Test Loss: 1.892 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.287474155426025
Epoch: 8, Steps: 17 | Train Loss: 1.474 Vali Loss: 2.077 Vali Acc: 0.243 Test Loss: 2.077 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.06859564781189
Epoch: 9, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.735 Vali Acc: 0.274 Test Loss: 1.735 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273747).  Saving model ...
Epoch: 10 cost time: 11.415657043457031
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.577 Vali Acc: 0.228 Test Loss: 1.577 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.720765352249146
Epoch: 11, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.567 Vali Acc: 0.300 Test Loss: 1.567 Test Acc: 0.300
Validation loss decreased (-0.273747 --> -0.300365).  Saving model ...
Epoch: 12 cost time: 11.916091442108154
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.654 Vali Acc: 0.274 Test Loss: 1.654 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.411672115325928
Epoch: 13, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.617 Vali Acc: 0.232 Test Loss: 1.617 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.506771802902222
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.625 Vali Acc: 0.278 Test Loss: 1.625 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.079031705856323
Epoch: 15, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.639 Vali Acc: 0.247 Test Loss: 1.639 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.115017890930176
Epoch: 16, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.836 Vali Acc: 0.259 Test Loss: 1.836 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.3597571849823
Epoch: 17, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.814 Vali Acc: 0.240 Test Loss: 1.814 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.436667442321777
Epoch: 18, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.704 Vali Acc: 0.236 Test Loss: 1.704 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.374857664108276
Epoch: 19, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.716 Vali Acc: 0.266 Test Loss: 1.716 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.099219560623169
Epoch: 20, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.856 Vali Acc: 0.247 Test Loss: 1.856 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.383702754974365
Epoch: 21, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.760 Vali Acc: 0.270 Test Loss: 1.760 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 284852
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.027552843093872
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.393 Vali Acc: 0.266 Test Loss: 1.393 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 16.90716862678528
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.595 Vali Acc: 0.255 Test Loss: 1.595 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.22563147544861
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 2.136 Vali Acc: 0.251 Test Loss: 2.136 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.558825969696045
Epoch: 4, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.495 Vali Acc: 0.259 Test Loss: 1.495 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.03577756881714
Epoch: 5, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.462 Vali Acc: 0.300 Test Loss: 1.462 Test Acc: 0.300
Validation loss decreased (-0.266146 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 16.868446826934814
Epoch: 6, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.434 Vali Acc: 0.293 Test Loss: 1.434 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.175203323364258
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.680 Vali Acc: 0.236 Test Loss: 1.680 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.099124670028687
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.673 Vali Acc: 0.266 Test Loss: 1.673 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.42766261100769
Epoch: 9, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.793 Vali Acc: 0.236 Test Loss: 1.793 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 16.530646562576294
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.899 Vali Acc: 0.266 Test Loss: 1.899 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.356741666793823
Epoch: 11, Steps: 17 | Train Loss: 1.322 Vali Loss: 2.073 Vali Acc: 0.262 Test Loss: 2.073 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.34150767326355
Epoch: 12, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.652 Vali Acc: 0.251 Test Loss: 1.652 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 16.023433685302734
Epoch: 13, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.606 Vali Acc: 0.259 Test Loss: 1.606 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 18.11843752861023
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 19.76868963241577
Epoch: 15, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.903 Vali Acc: 0.270 Test Loss: 1.903 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 698804
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.597434043884277
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.459 Vali Acc: 0.236 Test Loss: 1.459 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 9.064690351486206
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 9.383232831954956
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.559 Vali Acc: 0.255 Test Loss: 1.559 Test Acc: 0.255
Validation loss decreased (-0.243331 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 9.564310312271118
Epoch: 4, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.819 Vali Acc: 0.262 Test Loss: 1.819 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262339).  Saving model ...
Epoch: 5 cost time: 9.330396890640259
Epoch: 5, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.811 Vali Acc: 0.247 Test Loss: 1.811 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.306834697723389
Epoch: 6, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.537 Vali Acc: 0.262 Test Loss: 1.537 Test Acc: 0.262
Validation loss decreased (-0.262339 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 7.689655542373657
Epoch: 7, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.892 Vali Acc: 0.247 Test Loss: 1.892 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.942178010940552
Epoch: 8, Steps: 17 | Train Loss: 1.474 Vali Loss: 2.077 Vali Acc: 0.243 Test Loss: 2.077 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.170668601989746
Epoch: 9, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.735 Vali Acc: 0.274 Test Loss: 1.735 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273747).  Saving model ...
Epoch: 10 cost time: 8.793810844421387
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.577 Vali Acc: 0.228 Test Loss: 1.577 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.717392444610596
Epoch: 11, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.567 Vali Acc: 0.300 Test Loss: 1.567 Test Acc: 0.300
Validation loss decreased (-0.273747 --> -0.300365).  Saving model ...
Epoch: 12 cost time: 8.848398685455322
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.654 Vali Acc: 0.274 Test Loss: 1.654 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.794795513153076
Epoch: 13, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.617 Vali Acc: 0.232 Test Loss: 1.617 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.232732772827148
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.625 Vali Acc: 0.278 Test Loss: 1.625 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.048127889633179
Epoch: 15, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.639 Vali Acc: 0.247 Test Loss: 1.639 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.771657466888428
Epoch: 16, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.836 Vali Acc: 0.259 Test Loss: 1.836 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.462893009185791
Epoch: 17, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.814 Vali Acc: 0.240 Test Loss: 1.814 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.566110610961914
Epoch: 18, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.704 Vali Acc: 0.236 Test Loss: 1.704 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.962417125701904
Epoch: 19, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.716 Vali Acc: 0.266 Test Loss: 1.716 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.502887725830078
Epoch: 20, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.856 Vali Acc: 0.247 Test Loss: 1.856 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.316847801208496
Epoch: 21, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.760 Vali Acc: 0.270 Test Loss: 1.760 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 284852
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.734015226364136
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.393 Vali Acc: 0.266 Test Loss: 1.393 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 11.386093378067017
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.595 Vali Acc: 0.255 Test Loss: 1.595 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.456101655960083
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 2.136 Vali Acc: 0.251 Test Loss: 2.136 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.266663789749146
Epoch: 4, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.495 Vali Acc: 0.259 Test Loss: 1.495 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.18215537071228
Epoch: 5, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.462 Vali Acc: 0.300 Test Loss: 1.462 Test Acc: 0.300
Validation loss decreased (-0.266146 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 10.62776780128479
Epoch: 6, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.434 Vali Acc: 0.293 Test Loss: 1.434 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.758505821228027
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.680 Vali Acc: 0.236 Test Loss: 1.680 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.711013555526733
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.673 Vali Acc: 0.266 Test Loss: 1.673 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.137340068817139
Epoch: 9, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.793 Vali Acc: 0.236 Test Loss: 1.793 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.301416635513306
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.899 Vali Acc: 0.266 Test Loss: 1.899 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.834872007369995
Epoch: 11, Steps: 17 | Train Loss: 1.322 Vali Loss: 2.073 Vali Acc: 0.262 Test Loss: 2.073 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.916654825210571
Epoch: 12, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.652 Vali Acc: 0.251 Test Loss: 1.652 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.055730819702148
Epoch: 13, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.606 Vali Acc: 0.259 Test Loss: 1.606 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.391350269317627
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.384602546691895
Epoch: 15, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.903 Vali Acc: 0.270 Test Loss: 1.903 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 698804
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.9068639278411865
Epoch: 1, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.459 Vali Acc: 0.236 Test Loss: 1.459 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 5.410465478897095
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 5.459400177001953
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.559 Vali Acc: 0.255 Test Loss: 1.559 Test Acc: 0.255
Validation loss decreased (-0.243331 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 5.12409520149231
Epoch: 4, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.819 Vali Acc: 0.262 Test Loss: 1.819 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262339).  Saving model ...
Epoch: 5 cost time: 5.208172798156738
Epoch: 5, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.811 Vali Acc: 0.247 Test Loss: 1.811 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.247610807418823
Epoch: 6, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.537 Vali Acc: 0.262 Test Loss: 1.537 Test Acc: 0.262
Validation loss decreased (-0.262339 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 5.561040163040161
Epoch: 7, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.892 Vali Acc: 0.247 Test Loss: 1.892 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.628544092178345
Epoch: 8, Steps: 17 | Train Loss: 1.474 Vali Loss: 2.077 Vali Acc: 0.243 Test Loss: 2.077 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.796447038650513
Epoch: 9, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.735 Vali Acc: 0.274 Test Loss: 1.735 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273747).  Saving model ...
Epoch: 10 cost time: 5.213932514190674
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.577 Vali Acc: 0.228 Test Loss: 1.577 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.254850149154663
Epoch: 11, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.567 Vali Acc: 0.300 Test Loss: 1.567 Test Acc: 0.300
Validation loss decreased (-0.273747 --> -0.300365).  Saving model ...
Epoch: 12 cost time: 4.985079288482666
Epoch: 12, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.654 Vali Acc: 0.274 Test Loss: 1.654 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.986752986907959
Epoch: 13, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.617 Vali Acc: 0.232 Test Loss: 1.617 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.995207786560059
Epoch: 14, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.625 Vali Acc: 0.278 Test Loss: 1.625 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.239101409912109
Epoch: 15, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.639 Vali Acc: 0.247 Test Loss: 1.639 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.258509874343872
Epoch: 16, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.836 Vali Acc: 0.259 Test Loss: 1.836 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.862452268600464
Epoch: 17, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.814 Vali Acc: 0.240 Test Loss: 1.814 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.953349590301514
Epoch: 18, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.704 Vali Acc: 0.236 Test Loss: 1.704 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.984911203384399
Epoch: 19, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.716 Vali Acc: 0.266 Test Loss: 1.716 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.879266738891602
Epoch: 20, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.856 Vali Acc: 0.247 Test Loss: 1.856 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.535616159439087
Epoch: 21, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.760 Vali Acc: 0.270 Test Loss: 1.760 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 284852
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 37.74713706970215
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 34.55171751976013
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.458 Vali Acc: 0.243 Test Loss: 1.458 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 34.33543276786804
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.560691833496094
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.470 Vali Acc: 0.281 Test Loss: 1.470 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 32.724244117736816
Epoch: 5, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 35.99742770195007
Epoch: 6, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.463 Vali Acc: 0.240 Test Loss: 1.463 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 36.11356735229492
Epoch: 7, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.610 Vali Acc: 0.217 Test Loss: 1.610 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 32.081170320510864
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.556 Vali Acc: 0.251 Test Loss: 1.556 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 34.14865827560425
Epoch: 9, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 33.50917387008667
Epoch: 10, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.442 Vali Acc: 0.278 Test Loss: 1.442 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 33.443514347076416
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.430 Vali Acc: 0.281 Test Loss: 1.430 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281355).  Saving model ...
Epoch: 12 cost time: 34.38454270362854
Epoch: 12, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.473 Vali Acc: 0.297 Test Loss: 1.473 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 29.219606161117554
Epoch: 13, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 31.080037117004395
Epoch: 14, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.448 Vali Acc: 0.262 Test Loss: 1.448 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 33.42805576324463
Epoch: 15, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 36.99735403060913
Epoch: 16, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 35.988136529922485
Epoch: 17, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.670 Vali Acc: 0.259 Test Loss: 1.670 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 38.16422367095947
Epoch: 18, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.630 Vali Acc: 0.285 Test Loss: 1.630 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 36.57596492767334
Epoch: 19, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.475 Vali Acc: 0.289 Test Loss: 1.475 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 39.47825837135315
Epoch: 20, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.652 Vali Acc: 0.270 Test Loss: 1.652 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 31.74227523803711
Epoch: 21, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.612 Vali Acc: 0.262 Test Loss: 1.612 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 36.28285837173462
Epoch: 22, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.553 Vali Acc: 0.278 Test Loss: 1.553 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1229340
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 17.907020807266235
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.397 Vali Acc: 0.232 Test Loss: 1.397 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 13.905377626419067
Epoch: 2, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.403 Vali Acc: 0.251 Test Loss: 1.403 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 16.88880443572998
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.392 Vali Acc: 0.247 Test Loss: 1.392 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.473623514175415
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.109357833862305
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.483 Vali Acc: 0.262 Test Loss: 1.483 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 15.933538675308228
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.560 Vali Acc: 0.255 Test Loss: 1.560 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.26034951210022
Epoch: 7, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.554332494735718
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.441 Vali Acc: 0.297 Test Loss: 1.441 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296564).  Saving model ...
Epoch: 9 cost time: 13.160542964935303
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.464 Vali Acc: 0.300 Test Loss: 1.464 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 16.14944291114807
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.533 Vali Acc: 0.247 Test Loss: 1.533 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.132000207901
Epoch: 11, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.577 Vali Acc: 0.251 Test Loss: 1.577 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.93190336227417
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.591 Vali Acc: 0.232 Test Loss: 1.591 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.978661060333252
Epoch: 13, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.748 Vali Acc: 0.278 Test Loss: 1.748 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.821619272232056
Epoch: 14, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.585 Vali Acc: 0.274 Test Loss: 1.585 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.618391752243042
Epoch: 15, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.604 Vali Acc: 0.259 Test Loss: 1.604 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 16.174234867095947
Epoch: 16, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.658 Vali Acc: 0.278 Test Loss: 1.658 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 16.773591995239258
Epoch: 17, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.873 Vali Acc: 0.262 Test Loss: 1.873 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.176039695739746
Epoch: 18, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 16.21052312850952
Epoch: 19, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.605 Vali Acc: 0.278 Test Loss: 1.605 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 401372
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.33525323867798
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 25.104660511016846
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.458 Vali Acc: 0.243 Test Loss: 1.458 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.144411325454712
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.274129390716553
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.470 Vali Acc: 0.281 Test Loss: 1.470 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 25.28247380256653
Epoch: 5, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.71699619293213
Epoch: 6, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.463 Vali Acc: 0.240 Test Loss: 1.463 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.682257890701294
Epoch: 7, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.610 Vali Acc: 0.217 Test Loss: 1.610 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 25.396913051605225
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.556 Vali Acc: 0.251 Test Loss: 1.556 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 26.948487281799316
Epoch: 9, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 24.61871075630188
Epoch: 10, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.442 Vali Acc: 0.278 Test Loss: 1.442 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 23.42393136024475
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.430 Vali Acc: 0.281 Test Loss: 1.430 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281355).  Saving model ...
Epoch: 12 cost time: 23.51625084877014
Epoch: 12, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.473 Vali Acc: 0.297 Test Loss: 1.473 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 25.516172647476196
Epoch: 13, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.230529069900513
Epoch: 14, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.448 Vali Acc: 0.262 Test Loss: 1.448 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.282336235046387
Epoch: 15, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.380109071731567
Epoch: 16, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.33581519126892
Epoch: 17, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.670 Vali Acc: 0.259 Test Loss: 1.670 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 25.85673189163208
Epoch: 18, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.630 Vali Acc: 0.285 Test Loss: 1.630 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 26.108919143676758
Epoch: 19, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.475 Vali Acc: 0.289 Test Loss: 1.475 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 26.103355169296265
Epoch: 20, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.652 Vali Acc: 0.270 Test Loss: 1.652 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.23277997970581
Epoch: 21, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.612 Vali Acc: 0.262 Test Loss: 1.612 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 24.632328510284424
Epoch: 22, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.553 Vali Acc: 0.278 Test Loss: 1.553 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1229340
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.602816343307495
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.397 Vali Acc: 0.232 Test Loss: 1.397 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 11.051175355911255
Epoch: 2, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.403 Vali Acc: 0.251 Test Loss: 1.403 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 10.587224245071411
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.392 Vali Acc: 0.247 Test Loss: 1.392 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.443206071853638
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.485939025878906
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.483 Vali Acc: 0.262 Test Loss: 1.483 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 11.632310390472412
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.560 Vali Acc: 0.255 Test Loss: 1.560 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.370084285736084
Epoch: 7, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.702237606048584
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.441 Vali Acc: 0.297 Test Loss: 1.441 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296564).  Saving model ...
Epoch: 9 cost time: 11.586490869522095
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.464 Vali Acc: 0.300 Test Loss: 1.464 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 11.314814329147339
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.533 Vali Acc: 0.247 Test Loss: 1.533 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.5600266456604
Epoch: 11, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.577 Vali Acc: 0.251 Test Loss: 1.577 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.588704824447632
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.591 Vali Acc: 0.232 Test Loss: 1.591 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.472637414932251
Epoch: 13, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.748 Vali Acc: 0.278 Test Loss: 1.748 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.909336805343628
Epoch: 14, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.585 Vali Acc: 0.274 Test Loss: 1.585 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.49306607246399
Epoch: 15, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.604 Vali Acc: 0.259 Test Loss: 1.604 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.706894159317017
Epoch: 16, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.658 Vali Acc: 0.278 Test Loss: 1.658 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.232356786727905
Epoch: 17, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.873 Vali Acc: 0.262 Test Loss: 1.873 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.340350151062012
Epoch: 18, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.417940378189087
Epoch: 19, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.605 Vali Acc: 0.278 Test Loss: 1.605 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 401372
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.851420402526855
Epoch: 1, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 15.518619537353516
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.458 Vali Acc: 0.243 Test Loss: 1.458 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.923079013824463
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.490 Vali Acc: 0.251 Test Loss: 1.490 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.382259130477905
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.470 Vali Acc: 0.281 Test Loss: 1.470 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 15.747794389724731
Epoch: 5, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.275939464569092
Epoch: 6, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.463 Vali Acc: 0.240 Test Loss: 1.463 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.183887481689453
Epoch: 7, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.610 Vali Acc: 0.217 Test Loss: 1.610 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.347054958343506
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.556 Vali Acc: 0.251 Test Loss: 1.556 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.709336519241333
Epoch: 9, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.376000165939331
Epoch: 10, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.442 Vali Acc: 0.278 Test Loss: 1.442 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.710856199264526
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.430 Vali Acc: 0.281 Test Loss: 1.430 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281355).  Saving model ...
Epoch: 12 cost time: 14.7881920337677
Epoch: 12, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.473 Vali Acc: 0.297 Test Loss: 1.473 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 13.78047800064087
Epoch: 13, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.146084785461426
Epoch: 14, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.448 Vali Acc: 0.262 Test Loss: 1.448 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.11657190322876
Epoch: 15, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.125799179077148
Epoch: 16, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.439884901046753
Epoch: 17, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.670 Vali Acc: 0.259 Test Loss: 1.670 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 15.36400055885315
Epoch: 18, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.630 Vali Acc: 0.285 Test Loss: 1.630 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.695555448532104
Epoch: 19, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.475 Vali Acc: 0.289 Test Loss: 1.475 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.272869348526001
Epoch: 20, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.652 Vali Acc: 0.270 Test Loss: 1.652 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.619475364685059
Epoch: 21, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.612 Vali Acc: 0.262 Test Loss: 1.612 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.892011642456055
Epoch: 22, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.553 Vali Acc: 0.278 Test Loss: 1.553 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 1229340
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.565608263015747
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.397 Vali Acc: 0.232 Test Loss: 1.397 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 7.0645599365234375
Epoch: 2, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.403 Vali Acc: 0.251 Test Loss: 1.403 Test Acc: 0.251
Validation loss decreased (-0.231925 --> -0.250937).  Saving model ...
Epoch: 3 cost time: 6.727842807769775
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.392 Vali Acc: 0.247 Test Loss: 1.392 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.799248456954956
Epoch: 4, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.036695957183838
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.483 Vali Acc: 0.262 Test Loss: 1.483 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262343).  Saving model ...
Epoch: 6 cost time: 6.46073055267334
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.560 Vali Acc: 0.255 Test Loss: 1.560 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.319469451904297
Epoch: 7, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.983064651489258
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.441 Vali Acc: 0.297 Test Loss: 1.441 Test Acc: 0.297
Validation loss decreased (-0.262343 --> -0.296564).  Saving model ...
Epoch: 9 cost time: 7.102055072784424
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.464 Vali Acc: 0.300 Test Loss: 1.464 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 7.28211522102356
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.533 Vali Acc: 0.247 Test Loss: 1.533 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.522059679031372
Epoch: 11, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.577 Vali Acc: 0.251 Test Loss: 1.577 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.215538024902344
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.591 Vali Acc: 0.232 Test Loss: 1.591 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.335482835769653
Epoch: 13, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.748 Vali Acc: 0.278 Test Loss: 1.748 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.0439934730529785
Epoch: 14, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.585 Vali Acc: 0.274 Test Loss: 1.585 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.3247926235198975
Epoch: 15, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.604 Vali Acc: 0.259 Test Loss: 1.604 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.81577205657959
Epoch: 16, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.658 Vali Acc: 0.278 Test Loss: 1.658 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.758214473724365
Epoch: 17, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.873 Vali Acc: 0.262 Test Loss: 1.873 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.042752265930176
Epoch: 18, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.6756532192230225
Epoch: 19, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.605 Vali Acc: 0.278 Test Loss: 1.605 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 401372
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.130151748657227
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.422 Vali Acc: 0.251 Test Loss: 1.422 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 18.90814518928528
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.173903942108154
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 26.100634813308716
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.0688796043396
Epoch: 5, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.418 Vali Acc: 0.247 Test Loss: 1.418 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.10229206085205
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.513 Vali Acc: 0.262 Test Loss: 1.513 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.762084245681763
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 25.727487087249756
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.412 Vali Acc: 0.278 Test Loss: 1.412 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 25.85258674621582
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.595 Vali Acc: 0.278 Test Loss: 1.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.72544550895691
Epoch: 10, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.779 Vali Acc: 0.255 Test Loss: 1.779 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.493808031082153
Epoch: 11, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.559 Vali Acc: 0.247 Test Loss: 1.559 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 32.61858534812927
Epoch: 12, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.502 Vali Acc: 0.262 Test Loss: 1.502 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 33.53764843940735
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 34.2354154586792
Epoch: 14, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.469 Vali Acc: 0.308 Test Loss: 1.469 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307970).  Saving model ...
Epoch: 15 cost time: 33.40380930900574
Epoch: 15, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.666 Vali Acc: 0.278 Test Loss: 1.666 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 33.96405339241028
Epoch: 16, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.791 Vali Acc: 0.209 Test Loss: 1.791 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 33.90822458267212
Epoch: 17, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.574 Vali Acc: 0.236 Test Loss: 1.574 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 33.38891792297363
Epoch: 18, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.596 Vali Acc: 0.243 Test Loss: 1.596 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 34.0677273273468
Epoch: 19, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.569 Vali Acc: 0.274 Test Loss: 1.569 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 33.68877673149109
Epoch: 20, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.737 Vali Acc: 0.300 Test Loss: 1.737 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 33.75438380241394
Epoch: 21, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.551 Vali Acc: 0.274 Test Loss: 1.551 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 33.176820039749146
Epoch: 22, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 32.97799873352051
Epoch: 23, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.607 Vali Acc: 0.289 Test Loss: 1.607 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 33.47968816757202
Epoch: 24, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.777 Vali Acc: 0.289 Test Loss: 1.777 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 642844
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.68415904045105
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.475 Vali Acc: 0.255 Test Loss: 1.475 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 16.641937017440796
Epoch: 2, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.392 Vali Acc: 0.255 Test Loss: 1.392 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 16.382556676864624
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.502 Vali Acc: 0.274 Test Loss: 1.502 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 16.71437358856201
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.628 Vali Acc: 0.281 Test Loss: 1.628 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281353).  Saving model ...
Epoch: 5 cost time: 16.558762311935425
Epoch: 5, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.471 Vali Acc: 0.270 Test Loss: 1.471 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.181251049041748
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.816859722137451
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.514 Vali Acc: 0.274 Test Loss: 1.514 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.019487380981445
Epoch: 8, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.478 Vali Acc: 0.266 Test Loss: 1.478 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.094873428344727
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.436 Vali Acc: 0.285 Test Loss: 1.436 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 15.731297254562378
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.707669973373413
Epoch: 11, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.3925461769104
Epoch: 12, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.442 Vali Acc: 0.297 Test Loss: 1.442 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 13 cost time: 15.45282530784607
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.626 Vali Acc: 0.266 Test Loss: 1.626 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.213553190231323
Epoch: 14, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.477 Vali Acc: 0.274 Test Loss: 1.477 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.359208822250366
Epoch: 15, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.345993518829346
Epoch: 16, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.603 Vali Acc: 0.259 Test Loss: 1.603 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.2255642414093
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.614 Vali Acc: 0.259 Test Loss: 1.614 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 15.962228059768677
Epoch: 18, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.739 Vali Acc: 0.247 Test Loss: 1.739 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 16.10133457183838
Epoch: 19, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.642 Vali Acc: 0.278 Test Loss: 1.642 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 16.135344743728638
Epoch: 20, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.626 Vali Acc: 0.262 Test Loss: 1.626 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 16.36040472984314
Epoch: 21, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.752 Vali Acc: 0.297 Test Loss: 1.752 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 16.558902263641357
Epoch: 22, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.611 Vali Acc: 0.297 Test Loss: 1.611 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 228828
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.80730438232422
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.422 Vali Acc: 0.251 Test Loss: 1.422 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 25.868966579437256
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.57654047012329
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 25.950887203216553
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.27314567565918
Epoch: 5, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.418 Vali Acc: 0.247 Test Loss: 1.418 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.0995090007782
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.513 Vali Acc: 0.262 Test Loss: 1.513 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.40186595916748
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 25.852803468704224
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.412 Vali Acc: 0.278 Test Loss: 1.412 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 25.80368161201477
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.595 Vali Acc: 0.278 Test Loss: 1.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.695749044418335
Epoch: 10, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.779 Vali Acc: 0.255 Test Loss: 1.779 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.555640697479248
Epoch: 11, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.559 Vali Acc: 0.247 Test Loss: 1.559 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.78358745574951
Epoch: 12, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.502 Vali Acc: 0.262 Test Loss: 1.502 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.085203886032104
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 25.61595892906189
Epoch: 14, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.469 Vali Acc: 0.308 Test Loss: 1.469 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307970).  Saving model ...
Epoch: 15 cost time: 24.899430513381958
Epoch: 15, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.666 Vali Acc: 0.278 Test Loss: 1.666 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 25.333881855010986
Epoch: 16, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.791 Vali Acc: 0.209 Test Loss: 1.791 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 25.493974208831787
Epoch: 17, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.574 Vali Acc: 0.236 Test Loss: 1.574 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 25.423804759979248
Epoch: 18, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.596 Vali Acc: 0.243 Test Loss: 1.596 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 25.377192974090576
Epoch: 19, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.569 Vali Acc: 0.274 Test Loss: 1.569 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 26.510100841522217
Epoch: 20, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.737 Vali Acc: 0.300 Test Loss: 1.737 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 25.775962114334106
Epoch: 21, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.551 Vali Acc: 0.274 Test Loss: 1.551 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 26.40492057800293
Epoch: 22, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 24.901570558547974
Epoch: 23, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.607 Vali Acc: 0.289 Test Loss: 1.607 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 25.29268789291382
Epoch: 24, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.777 Vali Acc: 0.289 Test Loss: 1.777 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 642844
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.955280542373657
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.475 Vali Acc: 0.255 Test Loss: 1.475 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 12.499311208724976
Epoch: 2, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.392 Vali Acc: 0.255 Test Loss: 1.392 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 12.505789279937744
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.502 Vali Acc: 0.274 Test Loss: 1.502 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 12.414123296737671
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.628 Vali Acc: 0.281 Test Loss: 1.628 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281353).  Saving model ...
Epoch: 5 cost time: 11.824099063873291
Epoch: 5, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.471 Vali Acc: 0.270 Test Loss: 1.471 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.086430549621582
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.312726259231567
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.514 Vali Acc: 0.274 Test Loss: 1.514 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.194955110549927
Epoch: 8, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.478 Vali Acc: 0.266 Test Loss: 1.478 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.01994514465332
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.436 Vali Acc: 0.285 Test Loss: 1.436 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 11.859644889831543
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.196932315826416
Epoch: 11, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.4094398021698
Epoch: 12, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.442 Vali Acc: 0.297 Test Loss: 1.442 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 13 cost time: 12.407871007919312
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.626 Vali Acc: 0.266 Test Loss: 1.626 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.060381412506104
Epoch: 14, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.477 Vali Acc: 0.274 Test Loss: 1.477 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.010223865509033
Epoch: 15, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.16935682296753
Epoch: 16, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.603 Vali Acc: 0.259 Test Loss: 1.603 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.316040992736816
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.614 Vali Acc: 0.259 Test Loss: 1.614 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.200582265853882
Epoch: 18, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.739 Vali Acc: 0.247 Test Loss: 1.739 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.06330943107605
Epoch: 19, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.642 Vali Acc: 0.278 Test Loss: 1.642 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.460377931594849
Epoch: 20, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.626 Vali Acc: 0.262 Test Loss: 1.626 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.764679431915283
Epoch: 21, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.752 Vali Acc: 0.297 Test Loss: 1.752 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.421239376068115
Epoch: 22, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.611 Vali Acc: 0.297 Test Loss: 1.611 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 228828
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.092517852783203
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.422 Vali Acc: 0.251 Test Loss: 1.422 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 16.711861848831177
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.505481243133545
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 16.43712282180786
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.441 Vali Acc: 0.247 Test Loss: 1.441 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.38936185836792
Epoch: 5, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.418 Vali Acc: 0.247 Test Loss: 1.418 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.937685489654541
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.513 Vali Acc: 0.262 Test Loss: 1.513 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.985981941223145
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 16.136922597885132
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.412 Vali Acc: 0.278 Test Loss: 1.412 Test Acc: 0.278
Validation loss decreased (-0.277552 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 15.93005657196045
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.595 Vali Acc: 0.278 Test Loss: 1.595 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.953100442886353
Epoch: 10, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.779 Vali Acc: 0.255 Test Loss: 1.779 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.273065090179443
Epoch: 11, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.559 Vali Acc: 0.247 Test Loss: 1.559 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 15.68413496017456
Epoch: 12, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.502 Vali Acc: 0.262 Test Loss: 1.502 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 16.345380783081055
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.5894558429718
Epoch: 14, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.469 Vali Acc: 0.308 Test Loss: 1.469 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307970).  Saving model ...
Epoch: 15 cost time: 16.37894034385681
Epoch: 15, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.666 Vali Acc: 0.278 Test Loss: 1.666 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 16.290525436401367
Epoch: 16, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.791 Vali Acc: 0.209 Test Loss: 1.791 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.477763414382935
Epoch: 17, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.574 Vali Acc: 0.236 Test Loss: 1.574 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.683348417282104
Epoch: 18, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.596 Vali Acc: 0.243 Test Loss: 1.596 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.9436936378479
Epoch: 19, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.569 Vali Acc: 0.274 Test Loss: 1.569 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.73913836479187
Epoch: 20, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.737 Vali Acc: 0.300 Test Loss: 1.737 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 16.078063011169434
Epoch: 21, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.551 Vali Acc: 0.274 Test Loss: 1.551 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 15.784567832946777
Epoch: 22, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.610 Vali Acc: 0.262 Test Loss: 1.610 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 16.075251579284668
Epoch: 23, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.607 Vali Acc: 0.289 Test Loss: 1.607 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 15.794560670852661
Epoch: 24, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.777 Vali Acc: 0.289 Test Loss: 1.777 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 642844
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.044843435287476
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.475 Vali Acc: 0.255 Test Loss: 1.475 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 7.948506116867065
Epoch: 2, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.392 Vali Acc: 0.255 Test Loss: 1.392 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 7.471161603927612
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.502 Vali Acc: 0.274 Test Loss: 1.502 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 6.166635751724243
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.628 Vali Acc: 0.281 Test Loss: 1.628 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281353).  Saving model ...
Epoch: 5 cost time: 8.239649057388306
Epoch: 5, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.471 Vali Acc: 0.270 Test Loss: 1.471 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.17052936553955
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.979252099990845
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.514 Vali Acc: 0.274 Test Loss: 1.514 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.298002004623413
Epoch: 8, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.478 Vali Acc: 0.266 Test Loss: 1.478 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.366727590560913
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.436 Vali Acc: 0.285 Test Loss: 1.436 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285157).  Saving model ...
Epoch: 10 cost time: 7.998337268829346
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.481 Vali Acc: 0.259 Test Loss: 1.481 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.252895832061768
Epoch: 11, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.25462293624878
Epoch: 12, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.442 Vali Acc: 0.297 Test Loss: 1.442 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 13 cost time: 8.029388189315796
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.626 Vali Acc: 0.266 Test Loss: 1.626 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.963083267211914
Epoch: 14, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.477 Vali Acc: 0.274 Test Loss: 1.477 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.263780117034912
Epoch: 15, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.10200572013855
Epoch: 16, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.603 Vali Acc: 0.259 Test Loss: 1.603 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.979351043701172
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.614 Vali Acc: 0.259 Test Loss: 1.614 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.226731538772583
Epoch: 18, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.739 Vali Acc: 0.247 Test Loss: 1.739 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.127598285675049
Epoch: 19, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.642 Vali Acc: 0.278 Test Loss: 1.642 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.01194715499878
Epoch: 20, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.626 Vali Acc: 0.262 Test Loss: 1.626 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.256873369216919
Epoch: 21, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.752 Vali Acc: 0.297 Test Loss: 1.752 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.14279294013977
Epoch: 22, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.611 Vali Acc: 0.297 Test Loss: 1.611 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 228828
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 29.754518032073975
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.395 Vali Acc: 0.251 Test Loss: 1.395 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 27.602592706680298
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 27.832159519195557
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 26.67222762107849
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.609 Vali Acc: 0.236 Test Loss: 1.609 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.079522132873535
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.516 Vali Acc: 0.232 Test Loss: 1.516 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.048096895217896
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.557 Vali Acc: 0.262 Test Loss: 1.557 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.29225444793701
Epoch: 7, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.756807804107666
Epoch: 8, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.505 Vali Acc: 0.247 Test Loss: 1.505 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.81511163711548
Epoch: 9, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.498 Vali Acc: 0.243 Test Loss: 1.498 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.33865475654602
Epoch: 10, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 26.237966775894165
Epoch: 11, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 26.625759840011597
Epoch: 12, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 26.900471925735474
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.516 Vali Acc: 0.228 Test Loss: 1.516 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 349596
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.229757308959961
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 12.378979921340942
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.338137865066528
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.412 Vali Acc: 0.255 Test Loss: 1.412 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.15283989906311
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 12.16658353805542
Epoch: 5, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.464 Vali Acc: 0.262 Test Loss: 1.464 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.193516492843628
Epoch: 6, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.489 Vali Acc: 0.224 Test Loss: 1.489 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.198361873626709
Epoch: 7, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.490 Vali Acc: 0.236 Test Loss: 1.490 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.265714883804321
Epoch: 8, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.542 Vali Acc: 0.289 Test Loss: 1.542 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 11.686322927474976
Epoch: 9, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.658 Vali Acc: 0.262 Test Loss: 1.658 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.116839170455933
Epoch: 10, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.710 Vali Acc: 0.266 Test Loss: 1.710 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.739035367965698
Epoch: 11, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.483 Vali Acc: 0.285 Test Loss: 1.483 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.78650188446045
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.479 Vali Acc: 0.312 Test Loss: 1.479 Test Acc: 0.312
Validation loss decreased (-0.288958 --> -0.311772).  Saving model ...
Epoch: 13 cost time: 12.116019248962402
Epoch: 13, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.590 Vali Acc: 0.255 Test Loss: 1.590 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.399388551712036
Epoch: 14, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.493 Vali Acc: 0.270 Test Loss: 1.493 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.11326551437378
Epoch: 15, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.399765491485596
Epoch: 16, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.497 Vali Acc: 0.289 Test Loss: 1.497 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.952711582183838
Epoch: 17, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.621 Vali Acc: 0.255 Test Loss: 1.621 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.295196056365967
Epoch: 18, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.480 Vali Acc: 0.274 Test Loss: 1.480 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.429211616516113
Epoch: 19, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.569 Vali Acc: 0.297 Test Loss: 1.569 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.076663494110107
Epoch: 20, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.954 Vali Acc: 0.243 Test Loss: 1.954 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.46535849571228
Epoch: 21, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.747 Vali Acc: 0.300 Test Loss: 1.747 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.024353981018066
Epoch: 22, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.748 Vali Acc: 0.262 Test Loss: 1.748 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 142556
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.0632266998291
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.395 Vali Acc: 0.251 Test Loss: 1.395 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 17.802144527435303
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 17.54210066795349
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 17.7853786945343
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.609 Vali Acc: 0.236 Test Loss: 1.609 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.178240537643433
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.516 Vali Acc: 0.232 Test Loss: 1.516 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.644633054733276
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.557 Vali Acc: 0.262 Test Loss: 1.557 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.42745542526245
Epoch: 7, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.527198314666748
Epoch: 8, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.505 Vali Acc: 0.247 Test Loss: 1.505 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.060473918914795
Epoch: 9, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.498 Vali Acc: 0.243 Test Loss: 1.498 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.769786596298218
Epoch: 10, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.71447205543518
Epoch: 11, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.70747470855713
Epoch: 12, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 17.683035612106323
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.516 Vali Acc: 0.228 Test Loss: 1.516 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 349596
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.873414278030396
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 9.029829025268555
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.099473476409912
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.412 Vali Acc: 0.255 Test Loss: 1.412 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.037882089614868
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 8.912394285202026
Epoch: 5, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.464 Vali Acc: 0.262 Test Loss: 1.464 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.857860565185547
Epoch: 6, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.489 Vali Acc: 0.224 Test Loss: 1.489 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.003844261169434
Epoch: 7, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.490 Vali Acc: 0.236 Test Loss: 1.490 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.727887153625488
Epoch: 8, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.542 Vali Acc: 0.289 Test Loss: 1.542 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 8.743868350982666
Epoch: 9, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.658 Vali Acc: 0.262 Test Loss: 1.658 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.175464630126953
Epoch: 10, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.710 Vali Acc: 0.266 Test Loss: 1.710 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.715562582015991
Epoch: 11, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.483 Vali Acc: 0.285 Test Loss: 1.483 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.889498472213745
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.479 Vali Acc: 0.312 Test Loss: 1.479 Test Acc: 0.312
Validation loss decreased (-0.288958 --> -0.311772).  Saving model ...
Epoch: 13 cost time: 9.071484804153442
Epoch: 13, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.590 Vali Acc: 0.255 Test Loss: 1.590 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.060106039047241
Epoch: 14, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.493 Vali Acc: 0.270 Test Loss: 1.493 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.733864068984985
Epoch: 15, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.072037935256958
Epoch: 16, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.497 Vali Acc: 0.289 Test Loss: 1.497 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.196308374404907
Epoch: 17, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.621 Vali Acc: 0.255 Test Loss: 1.621 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.957191228866577
Epoch: 18, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.480 Vali Acc: 0.274 Test Loss: 1.480 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.85349702835083
Epoch: 19, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.569 Vali Acc: 0.297 Test Loss: 1.569 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.137655258178711
Epoch: 20, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.954 Vali Acc: 0.243 Test Loss: 1.954 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.987001419067383
Epoch: 21, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.747 Vali Acc: 0.300 Test Loss: 1.747 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.853561162948608
Epoch: 22, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.748 Vali Acc: 0.262 Test Loss: 1.748 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 142556
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.12626051902771
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.395 Vali Acc: 0.251 Test Loss: 1.395 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 13.162421941757202
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 11.19381046295166
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.266146 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 12.173187732696533
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.609 Vali Acc: 0.236 Test Loss: 1.609 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.436035633087158
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.516 Vali Acc: 0.232 Test Loss: 1.516 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.337910413742065
Epoch: 6, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.557 Vali Acc: 0.262 Test Loss: 1.557 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.437309980392456
Epoch: 7, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.505 Vali Acc: 0.255 Test Loss: 1.505 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.377610921859741
Epoch: 8, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.505 Vali Acc: 0.247 Test Loss: 1.505 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.324465990066528
Epoch: 9, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.498 Vali Acc: 0.243 Test Loss: 1.498 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.267706632614136
Epoch: 10, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.330996036529541
Epoch: 11, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.952269315719604
Epoch: 12, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.96483063697815
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.516 Vali Acc: 0.228 Test Loss: 1.516 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 349596
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.723660945892334
Epoch: 1, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.404 Vali Acc: 0.255 Test Loss: 1.404 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 5.90277361869812
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.849016904830933
Epoch: 3, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.412 Vali Acc: 0.255 Test Loss: 1.412 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.636310577392578
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 5.8066911697387695
Epoch: 5, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.464 Vali Acc: 0.262 Test Loss: 1.464 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.8077898025512695
Epoch: 6, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.489 Vali Acc: 0.224 Test Loss: 1.489 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.28353476524353
Epoch: 7, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.490 Vali Acc: 0.236 Test Loss: 1.490 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.490091562271118
Epoch: 8, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.542 Vali Acc: 0.289 Test Loss: 1.542 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 6.47699499130249
Epoch: 9, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.658 Vali Acc: 0.262 Test Loss: 1.658 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.40970778465271
Epoch: 10, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.710 Vali Acc: 0.266 Test Loss: 1.710 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.45425009727478
Epoch: 11, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.483 Vali Acc: 0.285 Test Loss: 1.483 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.664740800857544
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.479 Vali Acc: 0.312 Test Loss: 1.479 Test Acc: 0.312
Validation loss decreased (-0.288958 --> -0.311772).  Saving model ...
Epoch: 13 cost time: 6.751476049423218
Epoch: 13, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.590 Vali Acc: 0.255 Test Loss: 1.590 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.560577630996704
Epoch: 14, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.493 Vali Acc: 0.270 Test Loss: 1.493 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.294908761978149
Epoch: 15, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.711411952972412
Epoch: 16, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.497 Vali Acc: 0.289 Test Loss: 1.497 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.706167459487915
Epoch: 17, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.621 Vali Acc: 0.255 Test Loss: 1.621 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.5996177196502686
Epoch: 18, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.480 Vali Acc: 0.274 Test Loss: 1.480 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.513080358505249
Epoch: 19, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.569 Vali Acc: 0.297 Test Loss: 1.569 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.706745147705078
Epoch: 20, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.954 Vali Acc: 0.243 Test Loss: 1.954 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.66219425201416
Epoch: 21, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.747 Vali Acc: 0.300 Test Loss: 1.747 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.5711870193481445
Epoch: 22, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.748 Vali Acc: 0.262 Test Loss: 1.748 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 142556
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 304.81065702438354
Epoch: 1, Steps: 17 | Train Loss: 1.701 Vali Loss: 2.094 Vali Acc: 0.243 Test Loss: 2.094 Test Acc: 0.243
Validation loss decreased (inf --> -0.243325).  Saving model ...
Epoch: 2 cost time: 345.8393371105194
Epoch: 2, Steps: 17 | Train Loss: 1.926 Vali Loss: 2.001 Vali Acc: 0.243 Test Loss: 2.001 Test Acc: 0.243
Validation loss decreased (-0.243325 --> -0.243326).  Saving model ...
Epoch: 3 cost time: 398.03044390678406
Epoch: 3, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.962 Vali Acc: 0.255 Test Loss: 1.962 Test Acc: 0.255
Validation loss decreased (-0.243326 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 395.3210275173187
Epoch: 4, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.839 Vali Acc: 0.274 Test Loss: 1.839 Test Acc: 0.274
Validation loss decreased (-0.254733 --> -0.273746).  Saving model ...
Epoch: 5 cost time: 389.5087707042694
Epoch: 5, Steps: 17 | Train Loss: 1.603 Vali Loss: 2.247 Vali Acc: 0.232 Test Loss: 2.247 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 390.6035566329956
Epoch: 6, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.893 Vali Acc: 0.285 Test Loss: 1.893 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285152).  Saving model ...
Epoch: 7 cost time: 382.75579023361206
Epoch: 7, Steps: 17 | Train Loss: 1.372 Vali Loss: 2.103 Vali Acc: 0.236 Test Loss: 2.103 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 391.96877574920654
Epoch: 8, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.708 Vali Acc: 0.259 Test Loss: 1.708 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 361.81146240234375
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 2.365 Vali Acc: 0.228 Test Loss: 2.365 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 379.1897077560425
Epoch: 10, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.008 Vali Acc: 0.255 Test Loss: 2.008 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 359.555278301239
Epoch: 11, Steps: 17 | Train Loss: 1.290 Vali Loss: 2.549 Vali Acc: 0.255 Test Loss: 2.549 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 360.91406631469727
Epoch: 12, Steps: 17 | Train Loss: 1.408 Vali Loss: 2.235 Vali Acc: 0.251 Test Loss: 2.235 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 354.95321440696716
Epoch: 13, Steps: 17 | Train Loss: 1.023 Vali Loss: 2.758 Vali Acc: 0.228 Test Loss: 2.758 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 366.48742747306824
Epoch: 14, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.542 Vali Acc: 0.251 Test Loss: 2.542 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 374.0121953487396
Epoch: 15, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.977 Vali Acc: 0.240 Test Loss: 2.977 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 342.71132230758667
Epoch: 16, Steps: 17 | Train Loss: 0.821 Vali Loss: 3.627 Vali Acc: 0.274 Test Loss: 3.627 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 57135236
model size : 220.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 140.06333208084106
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.830 Vali Acc: 0.236 Test Loss: 1.830 Test Acc: 0.236
Validation loss decreased (inf --> -0.235723).  Saving model ...
Epoch: 2 cost time: 131.73946738243103
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.663 Vali Acc: 0.251 Test Loss: 1.663 Test Acc: 0.251
Validation loss decreased (-0.235723 --> -0.250934).  Saving model ...
Epoch: 3 cost time: 136.84318494796753
Epoch: 3, Steps: 17 | Train Loss: 2.009 Vali Loss: 2.585 Vali Acc: 0.247 Test Loss: 2.585 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 127.35454535484314
Epoch: 4, Steps: 17 | Train Loss: 2.515 Vali Loss: 2.469 Vali Acc: 0.274 Test Loss: 2.469 Test Acc: 0.274
Validation loss decreased (-0.250934 --> -0.273740).  Saving model ...
Epoch: 5 cost time: 131.13704466819763
Epoch: 5, Steps: 17 | Train Loss: 1.746 Vali Loss: 2.425 Vali Acc: 0.228 Test Loss: 2.425 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 114.65409135818481
Epoch: 6, Steps: 17 | Train Loss: 1.868 Vali Loss: 2.342 Vali Acc: 0.243 Test Loss: 2.342 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 131.40871024131775
Epoch: 7, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.770 Vali Acc: 0.221 Test Loss: 1.770 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 128.11198568344116
Epoch: 8, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.963 Vali Acc: 0.228 Test Loss: 1.963 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 125.85887956619263
Epoch: 9, Steps: 17 | Train Loss: 1.443 Vali Loss: 2.611 Vali Acc: 0.274 Test Loss: 2.611 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 122.9188323020935
Epoch: 10, Steps: 17 | Train Loss: 1.622 Vali Loss: 2.677 Vali Acc: 0.224 Test Loss: 2.677 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 135.9033398628235
Epoch: 11, Steps: 17 | Train Loss: 1.357 Vali Loss: 2.376 Vali Acc: 0.228 Test Loss: 2.376 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 135.5006811618805
Epoch: 12, Steps: 17 | Train Loss: 1.184 Vali Loss: 2.683 Vali Acc: 0.232 Test Loss: 2.683 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 127.56508350372314
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 2.233 Vali Acc: 0.217 Test Loss: 2.233 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 105.00611758232117
Epoch: 14, Steps: 17 | Train Loss: 0.918 Vali Loss: 3.112 Vali Acc: 0.224 Test Loss: 3.112 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 17418116
model size : 68.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 253.12192392349243
Epoch: 1, Steps: 17 | Train Loss: 1.701 Vali Loss: 2.094 Vali Acc: 0.243 Test Loss: 2.094 Test Acc: 0.243
Validation loss decreased (inf --> -0.243325).  Saving model ...
Epoch: 2 cost time: 261.15748405456543
Epoch: 2, Steps: 17 | Train Loss: 1.926 Vali Loss: 2.001 Vali Acc: 0.243 Test Loss: 2.001 Test Acc: 0.243
Validation loss decreased (-0.243325 --> -0.243326).  Saving model ...
Epoch: 3 cost time: 248.84150338172913
Epoch: 3, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.962 Vali Acc: 0.255 Test Loss: 1.962 Test Acc: 0.255
Validation loss decreased (-0.243326 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 237.56407284736633
Epoch: 4, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.839 Vali Acc: 0.274 Test Loss: 1.839 Test Acc: 0.274
Validation loss decreased (-0.254733 --> -0.273746).  Saving model ...
Epoch: 5 cost time: 248.78778910636902
Epoch: 5, Steps: 17 | Train Loss: 1.603 Vali Loss: 2.247 Vali Acc: 0.232 Test Loss: 2.247 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 232.8182110786438
Epoch: 6, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.893 Vali Acc: 0.285 Test Loss: 1.893 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285152).  Saving model ...
Epoch: 7 cost time: 267.472989320755
Epoch: 7, Steps: 17 | Train Loss: 1.372 Vali Loss: 2.103 Vali Acc: 0.236 Test Loss: 2.103 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 268.77948904037476
Epoch: 8, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.708 Vali Acc: 0.259 Test Loss: 1.708 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 251.3945517539978
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 2.365 Vali Acc: 0.228 Test Loss: 2.365 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 243.75228595733643
Epoch: 10, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.003 Vali Acc: 0.259 Test Loss: 2.003 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 258.3649697303772
Epoch: 11, Steps: 17 | Train Loss: 1.290 Vali Loss: 2.555 Vali Acc: 0.255 Test Loss: 2.555 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 251.0065553188324
Epoch: 12, Steps: 17 | Train Loss: 1.408 Vali Loss: 2.249 Vali Acc: 0.251 Test Loss: 2.249 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 259.39875507354736
Epoch: 13, Steps: 17 | Train Loss: 1.028 Vali Loss: 2.835 Vali Acc: 0.232 Test Loss: 2.835 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 259.3694667816162
Epoch: 14, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.545 Vali Acc: 0.262 Test Loss: 2.545 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 243.81893968582153
Epoch: 15, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.814 Vali Acc: 0.259 Test Loss: 2.814 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 248.4546401500702
Epoch: 16, Steps: 17 | Train Loss: 0.800 Vali Loss: 3.573 Vali Acc: 0.278 Test Loss: 3.573 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 57135236
model size : 220.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 95.4468297958374
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.830 Vali Acc: 0.236 Test Loss: 1.830 Test Acc: 0.236
Validation loss decreased (inf --> -0.235723).  Saving model ...
Epoch: 2 cost time: 101.76092481613159
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.663 Vali Acc: 0.251 Test Loss: 1.663 Test Acc: 0.251
Validation loss decreased (-0.235723 --> -0.250934).  Saving model ...
Epoch: 3 cost time: 86.80622172355652
Epoch: 3, Steps: 17 | Train Loss: 2.009 Vali Loss: 2.586 Vali Acc: 0.247 Test Loss: 2.586 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 99.11667013168335
Epoch: 4, Steps: 17 | Train Loss: 2.516 Vali Loss: 2.470 Vali Acc: 0.274 Test Loss: 2.470 Test Acc: 0.274
Validation loss decreased (-0.250934 --> -0.273740).  Saving model ...
Epoch: 5 cost time: 85.21767401695251
Epoch: 5, Steps: 17 | Train Loss: 1.746 Vali Loss: 2.413 Vali Acc: 0.228 Test Loss: 2.413 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 100.54763984680176
Epoch: 6, Steps: 17 | Train Loss: 1.906 Vali Loss: 2.304 Vali Acc: 0.232 Test Loss: 2.304 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 91.07741355895996
Epoch: 7, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.885 Vali Acc: 0.255 Test Loss: 1.885 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 100.33718824386597
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.976 Vali Acc: 0.236 Test Loss: 1.976 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 84.2725419998169
Epoch: 9, Steps: 17 | Train Loss: 1.420 Vali Loss: 2.698 Vali Acc: 0.240 Test Loss: 2.698 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 89.4026837348938
Epoch: 10, Steps: 17 | Train Loss: 1.562 Vali Loss: 2.579 Vali Acc: 0.224 Test Loss: 2.579 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 81.08694648742676
Epoch: 11, Steps: 17 | Train Loss: 1.295 Vali Loss: 2.464 Vali Acc: 0.255 Test Loss: 2.464 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 74.78629088401794
Epoch: 12, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.242 Vali Acc: 0.270 Test Loss: 2.242 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 79.75619196891785
Epoch: 13, Steps: 17 | Train Loss: 1.070 Vali Loss: 2.270 Vali Acc: 0.224 Test Loss: 2.270 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 78.670405626297
Epoch: 14, Steps: 17 | Train Loss: 0.994 Vali Loss: 2.708 Vali Acc: 0.251 Test Loss: 2.708 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 17418116
model size : 68.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 136.62133598327637
Epoch: 1, Steps: 17 | Train Loss: 1.701 Vali Loss: 2.094 Vali Acc: 0.243 Test Loss: 2.094 Test Acc: 0.243
Validation loss decreased (inf --> -0.243325).  Saving model ...
Epoch: 2 cost time: 142.3348422050476
Epoch: 2, Steps: 17 | Train Loss: 1.926 Vali Loss: 2.001 Vali Acc: 0.243 Test Loss: 2.001 Test Acc: 0.243
Validation loss decreased (-0.243325 --> -0.243326).  Saving model ...
Epoch: 3 cost time: 128.77699756622314
Epoch: 3, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.962 Vali Acc: 0.255 Test Loss: 1.962 Test Acc: 0.255
Validation loss decreased (-0.243326 --> -0.254733).  Saving model ...
Epoch: 4 cost time: 140.16328763961792
Epoch: 4, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.839 Vali Acc: 0.274 Test Loss: 1.839 Test Acc: 0.274
Validation loss decreased (-0.254733 --> -0.273746).  Saving model ...
Epoch: 5 cost time: 143.54259705543518
Epoch: 5, Steps: 17 | Train Loss: 1.603 Vali Loss: 2.247 Vali Acc: 0.232 Test Loss: 2.247 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 140.9736897945404
Epoch: 6, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.893 Vali Acc: 0.285 Test Loss: 1.893 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285152).  Saving model ...
Epoch: 7 cost time: 140.64577889442444
Epoch: 7, Steps: 17 | Train Loss: 1.372 Vali Loss: 2.104 Vali Acc: 0.236 Test Loss: 2.104 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 150.67265272140503
Epoch: 8, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.708 Vali Acc: 0.259 Test Loss: 1.708 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 141.67751049995422
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 2.363 Vali Acc: 0.228 Test Loss: 2.363 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 155.42810893058777
Epoch: 10, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.010 Vali Acc: 0.255 Test Loss: 2.010 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 156.10741233825684
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 2.548 Vali Acc: 0.255 Test Loss: 2.548 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 142.7258861064911
Epoch: 12, Steps: 17 | Train Loss: 1.409 Vali Loss: 2.251 Vali Acc: 0.251 Test Loss: 2.251 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 143.3997664451599
Epoch: 13, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.776 Vali Acc: 0.224 Test Loss: 2.776 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 174.03103590011597
Epoch: 14, Steps: 17 | Train Loss: 0.765 Vali Loss: 2.422 Vali Acc: 0.270 Test Loss: 2.422 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 169.97416257858276
Epoch: 15, Steps: 17 | Train Loss: 0.776 Vali Loss: 3.231 Vali Acc: 0.224 Test Loss: 3.231 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 167.40281748771667
Epoch: 16, Steps: 17 | Train Loss: 0.853 Vali Loss: 3.490 Vali Acc: 0.270 Test Loss: 3.490 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 57135236
model size : 220.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 93.86022925376892
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.830 Vali Acc: 0.236 Test Loss: 1.830 Test Acc: 0.236
Validation loss decreased (inf --> -0.235723).  Saving model ...
Epoch: 2 cost time: 90.75362420082092
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.663 Vali Acc: 0.251 Test Loss: 1.663 Test Acc: 0.251
Validation loss decreased (-0.235723 --> -0.250934).  Saving model ...
Epoch: 3 cost time: 87.95377230644226
Epoch: 3, Steps: 17 | Train Loss: 2.009 Vali Loss: 2.585 Vali Acc: 0.247 Test Loss: 2.585 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 89.28478622436523
Epoch: 4, Steps: 17 | Train Loss: 2.515 Vali Loss: 2.469 Vali Acc: 0.274 Test Loss: 2.469 Test Acc: 0.274
Validation loss decreased (-0.250934 --> -0.273740).  Saving model ...
Epoch: 5 cost time: 86.23543953895569
Epoch: 5, Steps: 17 | Train Loss: 1.746 Vali Loss: 2.421 Vali Acc: 0.228 Test Loss: 2.421 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 90.16363334655762
Epoch: 6, Steps: 17 | Train Loss: 1.882 Vali Loss: 2.357 Vali Acc: 0.243 Test Loss: 2.357 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 91.06835269927979
Epoch: 7, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.793 Vali Acc: 0.232 Test Loss: 1.793 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 90.85775399208069
Epoch: 8, Steps: 17 | Train Loss: 1.388 Vali Loss: 2.002 Vali Acc: 0.224 Test Loss: 2.002 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 85.40545153617859
Epoch: 9, Steps: 17 | Train Loss: 1.418 Vali Loss: 2.348 Vali Acc: 0.270 Test Loss: 2.348 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 86.74802041053772
Epoch: 10, Steps: 17 | Train Loss: 1.546 Vali Loss: 2.704 Vali Acc: 0.224 Test Loss: 2.704 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 89.45216751098633
Epoch: 11, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.803 Vali Acc: 0.251 Test Loss: 1.803 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 90.52520966529846
Epoch: 12, Steps: 17 | Train Loss: 1.182 Vali Loss: 2.596 Vali Acc: 0.259 Test Loss: 2.596 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 91.15668606758118
Epoch: 13, Steps: 17 | Train Loss: 1.200 Vali Loss: 2.478 Vali Acc: 0.240 Test Loss: 2.478 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 84.54469203948975
Epoch: 14, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.838 Vali Acc: 0.251 Test Loss: 2.838 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 17418116
model size : 68.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 232.7668068408966
Epoch: 1, Steps: 17 | Train Loss: 1.817 Vali Loss: 2.606 Vali Acc: 0.247 Test Loss: 2.606 Test Acc: 0.247
Validation loss decreased (inf --> -0.247122).  Saving model ...
Epoch: 2 cost time: 237.99780893325806
Epoch: 2, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.425 Vali Acc: 0.255 Test Loss: 2.425 Test Acc: 0.255
Validation loss decreased (-0.247122 --> -0.254729).  Saving model ...
Epoch: 3 cost time: 229.69027948379517
Epoch: 3, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.447 Vali Acc: 0.240 Test Loss: 2.447 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 232.8511061668396
Epoch: 4, Steps: 17 | Train Loss: 1.774 Vali Loss: 2.549 Vali Acc: 0.243 Test Loss: 2.549 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 227.54326009750366
Epoch: 5, Steps: 17 | Train Loss: 1.810 Vali Loss: 2.138 Vali Acc: 0.240 Test Loss: 2.138 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 230.09455943107605
Epoch: 6, Steps: 17 | Train Loss: 1.630 Vali Loss: 2.078 Vali Acc: 0.240 Test Loss: 2.078 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 223.7058527469635
Epoch: 7, Steps: 17 | Train Loss: 1.477 Vali Loss: 2.060 Vali Acc: 0.278 Test Loss: 2.060 Test Acc: 0.278
Validation loss decreased (-0.254729 --> -0.277546).  Saving model ...
Epoch: 8 cost time: 222.64149236679077
Epoch: 8, Steps: 17 | Train Loss: 1.403 Vali Loss: 2.149 Vali Acc: 0.247 Test Loss: 2.149 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 218.60509061813354
Epoch: 9, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.954 Vali Acc: 0.270 Test Loss: 1.954 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 208.79955172538757
Epoch: 10, Steps: 17 | Train Loss: 1.298 Vali Loss: 2.865 Vali Acc: 0.236 Test Loss: 2.865 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 238.66501140594482
Epoch: 11, Steps: 17 | Train Loss: 1.379 Vali Loss: 2.748 Vali Acc: 0.278 Test Loss: 2.748 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 227.25069427490234
Epoch: 12, Steps: 17 | Train Loss: 1.043 Vali Loss: 2.522 Vali Acc: 0.285 Test Loss: 2.522 Test Acc: 0.285
Validation loss decreased (-0.277546 --> -0.285146).  Saving model ...
Epoch: 13 cost time: 226.88006925582886
Epoch: 13, Steps: 17 | Train Loss: 0.918 Vali Loss: 3.547 Vali Acc: 0.278 Test Loss: 3.547 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 225.04979300498962
Epoch: 14, Steps: 17 | Train Loss: 1.411 Vali Loss: 3.328 Vali Acc: 0.293 Test Loss: 3.328 Test Acc: 0.293
Validation loss decreased (-0.285146 --> -0.292742).  Saving model ...
Epoch: 15 cost time: 216.80981612205505
Epoch: 15, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.910 Vali Acc: 0.255 Test Loss: 2.910 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 225.2150218486786
Epoch: 16, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.742 Vali Acc: 0.266 Test Loss: 2.742 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 221.56487679481506
Epoch: 17, Steps: 17 | Train Loss: 0.502 Vali Loss: 3.674 Vali Acc: 0.251 Test Loss: 3.674 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 214.09989047050476
Epoch: 18, Steps: 17 | Train Loss: 0.444 Vali Loss: 3.828 Vali Acc: 0.266 Test Loss: 3.828 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 220.65489101409912
Epoch: 19, Steps: 17 | Train Loss: 0.499 Vali Loss: 4.310 Vali Acc: 0.228 Test Loss: 4.310 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 212.64499974250793
Epoch: 20, Steps: 17 | Train Loss: 0.467 Vali Loss: 4.398 Vali Acc: 0.278 Test Loss: 4.398 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 202.89397072792053
Epoch: 21, Steps: 17 | Train Loss: 0.323 Vali Loss: 4.420 Vali Acc: 0.236 Test Loss: 4.420 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 204.84417986869812
Epoch: 22, Steps: 17 | Train Loss: 0.424 Vali Loss: 5.103 Vali Acc: 0.270 Test Loss: 5.103 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 211.48593878746033
Epoch: 23, Steps: 17 | Train Loss: 0.262 Vali Loss: 5.333 Vali Acc: 0.259 Test Loss: 5.333 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 208.5929741859436
Epoch: 24, Steps: 17 | Train Loss: 0.267 Vali Loss: 5.227 Vali Acc: 0.270 Test Loss: 5.227 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 29017988
model size : 113.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 73.60589694976807
Epoch: 1, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.140 Vali Acc: 0.247 Test Loss: 2.140 Test Acc: 0.247
Validation loss decreased (inf --> -0.247127).  Saving model ...
Epoch: 2 cost time: 79.2748167514801
Epoch: 2, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.873 Vali Acc: 0.240 Test Loss: 1.873 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 81.65213370323181
Epoch: 3, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
Validation loss decreased (-0.247127 --> -0.258538).  Saving model ...
Epoch: 4 cost time: 77.39470338821411
Epoch: 4, Steps: 17 | Train Loss: 1.959 Vali Loss: 2.851 Vali Acc: 0.243 Test Loss: 2.851 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 80.61271905899048
Epoch: 5, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.954 Vali Acc: 0.236 Test Loss: 1.954 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 71.98212385177612
Epoch: 6, Steps: 17 | Train Loss: 1.753 Vali Loss: 2.426 Vali Acc: 0.236 Test Loss: 2.426 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 71.13432121276855
Epoch: 7, Steps: 17 | Train Loss: 1.851 Vali Loss: 2.221 Vali Acc: 0.274 Test Loss: 2.221 Test Acc: 0.274
Validation loss decreased (-0.258538 --> -0.273742).  Saving model ...
Epoch: 8 cost time: 72.03396153450012
Epoch: 8, Steps: 17 | Train Loss: 1.599 Vali Loss: 2.142 Vali Acc: 0.232 Test Loss: 2.142 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 75.1869261264801
Epoch: 9, Steps: 17 | Train Loss: 1.483 Vali Loss: 2.539 Vali Acc: 0.259 Test Loss: 2.539 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 79.90460133552551
Epoch: 10, Steps: 17 | Train Loss: 1.402 Vali Loss: 3.738 Vali Acc: 0.255 Test Loss: 3.738 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 74.58561778068542
Epoch: 11, Steps: 17 | Train Loss: 1.524 Vali Loss: 2.294 Vali Acc: 0.281 Test Loss: 2.294 Test Acc: 0.281
Validation loss decreased (-0.273742 --> -0.281346).  Saving model ...
Epoch: 12 cost time: 75.3038489818573
Epoch: 12, Steps: 17 | Train Loss: 1.299 Vali Loss: 2.705 Vali Acc: 0.240 Test Loss: 2.705 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 73.54496788978577
Epoch: 13, Steps: 17 | Train Loss: 1.263 Vali Loss: 2.086 Vali Acc: 0.281 Test Loss: 2.086 Test Acc: 0.281
Validation loss decreased (-0.281346 --> -0.281348).  Saving model ...
Epoch: 14 cost time: 67.45400810241699
Epoch: 14, Steps: 17 | Train Loss: 0.855 Vali Loss: 2.474 Vali Acc: 0.243 Test Loss: 2.474 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 69.77809476852417
Epoch: 15, Steps: 17 | Train Loss: 0.643 Vali Loss: 2.481 Vali Acc: 0.262 Test Loss: 2.481 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 70.7559871673584
Epoch: 16, Steps: 17 | Train Loss: 0.586 Vali Loss: 3.042 Vali Acc: 0.262 Test Loss: 3.042 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 82.0203857421875
Epoch: 17, Steps: 17 | Train Loss: 0.669 Vali Loss: 4.006 Vali Acc: 0.236 Test Loss: 4.006 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 82.27110314369202
Epoch: 18, Steps: 17 | Train Loss: 0.742 Vali Loss: 4.804 Vali Acc: 0.232 Test Loss: 4.804 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 78.01863527297974
Epoch: 19, Steps: 17 | Train Loss: 0.805 Vali Loss: 4.533 Vali Acc: 0.255 Test Loss: 4.533 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 72.06017327308655
Epoch: 20, Steps: 17 | Train Loss: 0.621 Vali Loss: 3.723 Vali Acc: 0.255 Test Loss: 3.723 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 75.62004780769348
Epoch: 21, Steps: 17 | Train Loss: 0.329 Vali Loss: 5.165 Vali Acc: 0.228 Test Loss: 5.165 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 72.92839646339417
Epoch: 22, Steps: 17 | Train Loss: 0.379 Vali Loss: 3.378 Vali Acc: 0.270 Test Loss: 3.378 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 74.93710470199585
Epoch: 23, Steps: 17 | Train Loss: 0.220 Vali Loss: 4.531 Vali Acc: 0.243 Test Loss: 4.531 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 9159044
model size : 37.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 142.8374891281128
Epoch: 1, Steps: 17 | Train Loss: 1.817 Vali Loss: 2.606 Vali Acc: 0.247 Test Loss: 2.606 Test Acc: 0.247
Validation loss decreased (inf --> -0.247122).  Saving model ...
Epoch: 2 cost time: 142.41673493385315
Epoch: 2, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.425 Vali Acc: 0.255 Test Loss: 2.425 Test Acc: 0.255
Validation loss decreased (-0.247122 --> -0.254729).  Saving model ...
Epoch: 3 cost time: 134.52013635635376
Epoch: 3, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.447 Vali Acc: 0.240 Test Loss: 2.447 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 133.28942012786865
Epoch: 4, Steps: 17 | Train Loss: 1.774 Vali Loss: 2.549 Vali Acc: 0.243 Test Loss: 2.549 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 136.2387056350708
Epoch: 5, Steps: 17 | Train Loss: 1.810 Vali Loss: 2.138 Vali Acc: 0.240 Test Loss: 2.138 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 141.594074010849
Epoch: 6, Steps: 17 | Train Loss: 1.630 Vali Loss: 2.078 Vali Acc: 0.240 Test Loss: 2.078 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 130.23193287849426
Epoch: 7, Steps: 17 | Train Loss: 1.477 Vali Loss: 2.060 Vali Acc: 0.278 Test Loss: 2.060 Test Acc: 0.278
Validation loss decreased (-0.254729 --> -0.277546).  Saving model ...
Epoch: 8 cost time: 136.66500282287598
Epoch: 8, Steps: 17 | Train Loss: 1.403 Vali Loss: 2.149 Vali Acc: 0.247 Test Loss: 2.149 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 135.73297452926636
Epoch: 9, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.954 Vali Acc: 0.270 Test Loss: 1.954 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 118.38405871391296
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 2.861 Vali Acc: 0.236 Test Loss: 2.861 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 124.14393520355225
Epoch: 11, Steps: 17 | Train Loss: 1.377 Vali Loss: 2.751 Vali Acc: 0.278 Test Loss: 2.751 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 128.1937575340271
Epoch: 12, Steps: 17 | Train Loss: 1.042 Vali Loss: 2.487 Vali Acc: 0.274 Test Loss: 2.487 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 120.40115904808044
Epoch: 13, Steps: 17 | Train Loss: 0.897 Vali Loss: 3.368 Vali Acc: 0.270 Test Loss: 3.368 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 123.24462008476257
Epoch: 14, Steps: 17 | Train Loss: 1.406 Vali Loss: 3.130 Vali Acc: 0.281 Test Loss: 3.130 Test Acc: 0.281
Validation loss decreased (-0.277546 --> -0.281338).  Saving model ...
Epoch: 15 cost time: 127.46881866455078
Epoch: 15, Steps: 17 | Train Loss: 0.712 Vali Loss: 3.520 Vali Acc: 0.262 Test Loss: 3.520 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 123.31754422187805
Epoch: 16, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.503 Vali Acc: 0.316 Test Loss: 2.503 Test Acc: 0.316
Validation loss decreased (-0.281338 --> -0.315564).  Saving model ...
Epoch: 17 cost time: 128.54954433441162
Epoch: 17, Steps: 17 | Train Loss: 0.572 Vali Loss: 3.602 Vali Acc: 0.274 Test Loss: 3.602 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 122.0688054561615
Epoch: 18, Steps: 17 | Train Loss: 0.565 Vali Loss: 3.822 Vali Acc: 0.259 Test Loss: 3.822 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 122.25178980827332
Epoch: 19, Steps: 17 | Train Loss: 0.441 Vali Loss: 3.822 Vali Acc: 0.266 Test Loss: 3.822 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 129.15569233894348
Epoch: 20, Steps: 17 | Train Loss: 0.476 Vali Loss: 3.841 Vali Acc: 0.247 Test Loss: 3.841 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 126.1615161895752
Epoch: 21, Steps: 17 | Train Loss: 0.352 Vali Loss: 4.699 Vali Acc: 0.262 Test Loss: 4.699 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 117.21058297157288
Epoch: 22, Steps: 17 | Train Loss: 0.475 Vali Loss: 4.526 Vali Acc: 0.221 Test Loss: 4.526 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 128.0554347038269
Epoch: 23, Steps: 17 | Train Loss: 0.280 Vali Loss: 4.967 Vali Acc: 0.221 Test Loss: 4.967 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 123.32412004470825
Epoch: 24, Steps: 17 | Train Loss: 0.199 Vali Loss: 5.722 Vali Acc: 0.236 Test Loss: 5.722 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 127.25987339019775
Epoch: 25, Steps: 17 | Train Loss: 0.305 Vali Loss: 5.984 Vali Acc: 0.262 Test Loss: 5.984 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 125.44769310951233
Epoch: 26, Steps: 17 | Train Loss: 0.221 Vali Loss: 6.166 Vali Acc: 0.243 Test Loss: 6.166 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 29017988
model size : 113.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 52.59454798698425
Epoch: 1, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.140 Vali Acc: 0.247 Test Loss: 2.140 Test Acc: 0.247
Validation loss decreased (inf --> -0.247127).  Saving model ...
Epoch: 2 cost time: 50.93882966041565
Epoch: 2, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.873 Vali Acc: 0.240 Test Loss: 1.873 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.946919202804565
Epoch: 3, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
Validation loss decreased (-0.247127 --> -0.258538).  Saving model ...
Epoch: 4 cost time: 50.61160206794739
Epoch: 4, Steps: 17 | Train Loss: 1.959 Vali Loss: 2.851 Vali Acc: 0.243 Test Loss: 2.851 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 49.55234932899475
Epoch: 5, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.954 Vali Acc: 0.236 Test Loss: 1.954 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 46.71058416366577
Epoch: 6, Steps: 17 | Train Loss: 1.753 Vali Loss: 2.426 Vali Acc: 0.236 Test Loss: 2.426 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 49.20852589607239
Epoch: 7, Steps: 17 | Train Loss: 1.851 Vali Loss: 2.222 Vali Acc: 0.274 Test Loss: 2.222 Test Acc: 0.274
Validation loss decreased (-0.258538 --> -0.273742).  Saving model ...
Epoch: 8 cost time: 50.01802730560303
Epoch: 8, Steps: 17 | Train Loss: 1.597 Vali Loss: 2.150 Vali Acc: 0.228 Test Loss: 2.150 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 51.540770530700684
Epoch: 9, Steps: 17 | Train Loss: 1.484 Vali Loss: 2.544 Vali Acc: 0.262 Test Loss: 2.544 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 52.243465185165405
Epoch: 10, Steps: 17 | Train Loss: 1.410 Vali Loss: 3.651 Vali Acc: 0.255 Test Loss: 3.651 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 52.27865219116211
Epoch: 11, Steps: 17 | Train Loss: 1.648 Vali Loss: 3.534 Vali Acc: 0.224 Test Loss: 3.534 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 50.65913677215576
Epoch: 12, Steps: 17 | Train Loss: 1.272 Vali Loss: 2.154 Vali Acc: 0.221 Test Loss: 2.154 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 49.87817025184631
Epoch: 13, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.496 Vali Acc: 0.232 Test Loss: 2.496 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 49.91922092437744
Epoch: 14, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.256 Vali Acc: 0.255 Test Loss: 2.256 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 49.77556490898132
Epoch: 15, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.964 Vali Acc: 0.240 Test Loss: 2.964 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 49.46714472770691
Epoch: 16, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.683 Vali Acc: 0.259 Test Loss: 2.683 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 50.369312047958374
Epoch: 17, Steps: 17 | Train Loss: 0.724 Vali Loss: 3.508 Vali Acc: 0.274 Test Loss: 3.508 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 9159044
model size : 37.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 78.2682032585144
Epoch: 1, Steps: 17 | Train Loss: 1.817 Vali Loss: 2.606 Vali Acc: 0.247 Test Loss: 2.606 Test Acc: 0.247
Validation loss decreased (inf --> -0.247122).  Saving model ...
Epoch: 2 cost time: 76.48854875564575
Epoch: 2, Steps: 17 | Train Loss: 2.125 Vali Loss: 2.425 Vali Acc: 0.255 Test Loss: 2.425 Test Acc: 0.255
Validation loss decreased (-0.247122 --> -0.254729).  Saving model ...
Epoch: 3 cost time: 78.14029884338379
Epoch: 3, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.447 Vali Acc: 0.240 Test Loss: 2.447 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 75.23689126968384
Epoch: 4, Steps: 17 | Train Loss: 1.774 Vali Loss: 2.549 Vali Acc: 0.243 Test Loss: 2.549 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 74.86384773254395
Epoch: 5, Steps: 17 | Train Loss: 1.809 Vali Loss: 2.139 Vali Acc: 0.243 Test Loss: 2.139 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 71.25326943397522
Epoch: 6, Steps: 17 | Train Loss: 1.630 Vali Loss: 2.078 Vali Acc: 0.240 Test Loss: 2.078 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 71.65112400054932
Epoch: 7, Steps: 17 | Train Loss: 1.477 Vali Loss: 2.060 Vali Acc: 0.278 Test Loss: 2.060 Test Acc: 0.278
Validation loss decreased (-0.254729 --> -0.277546).  Saving model ...
Epoch: 8 cost time: 77.34598469734192
Epoch: 8, Steps: 17 | Train Loss: 1.403 Vali Loss: 2.148 Vali Acc: 0.247 Test Loss: 2.148 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 77.80029559135437
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.950 Vali Acc: 0.270 Test Loss: 1.950 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 76.19970273971558
Epoch: 10, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.877 Vali Acc: 0.236 Test Loss: 2.877 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 76.33134889602661
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 2.729 Vali Acc: 0.285 Test Loss: 2.729 Test Acc: 0.285
Validation loss decreased (-0.277546 --> -0.285144).  Saving model ...
Epoch: 12 cost time: 75.05646419525146
Epoch: 12, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.683 Vali Acc: 0.289 Test Loss: 2.683 Test Acc: 0.289
Validation loss decreased (-0.285144 --> -0.288947).  Saving model ...
Epoch: 13 cost time: 75.51103687286377
Epoch: 13, Steps: 17 | Train Loss: 0.910 Vali Loss: 3.451 Vali Acc: 0.232 Test Loss: 3.451 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 78.34310340881348
Epoch: 14, Steps: 17 | Train Loss: 1.180 Vali Loss: 3.334 Vali Acc: 0.270 Test Loss: 3.334 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 74.8561623096466
Epoch: 15, Steps: 17 | Train Loss: 0.825 Vali Loss: 3.233 Vali Acc: 0.255 Test Loss: 3.233 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 77.71562433242798
Epoch: 16, Steps: 17 | Train Loss: 0.753 Vali Loss: 3.077 Vali Acc: 0.259 Test Loss: 3.077 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 76.30661368370056
Epoch: 17, Steps: 17 | Train Loss: 0.475 Vali Loss: 3.062 Vali Acc: 0.266 Test Loss: 3.062 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 75.135990858078
Epoch: 18, Steps: 17 | Train Loss: 0.599 Vali Loss: 3.564 Vali Acc: 0.259 Test Loss: 3.564 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 72.21187686920166
Epoch: 19, Steps: 17 | Train Loss: 0.445 Vali Loss: 4.111 Vali Acc: 0.259 Test Loss: 4.111 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 77.96533274650574
Epoch: 20, Steps: 17 | Train Loss: 0.366 Vali Loss: 3.523 Vali Acc: 0.281 Test Loss: 3.523 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 79.51359939575195
Epoch: 21, Steps: 17 | Train Loss: 0.234 Vali Loss: 4.496 Vali Acc: 0.247 Test Loss: 4.496 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 79.52649903297424
Epoch: 22, Steps: 17 | Train Loss: 0.466 Vali Loss: 5.338 Vali Acc: 0.247 Test Loss: 5.338 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 29017988
model size : 113.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 33.051064252853394
Epoch: 1, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.140 Vali Acc: 0.247 Test Loss: 2.140 Test Acc: 0.247
Validation loss decreased (inf --> -0.247127).  Saving model ...
Epoch: 2 cost time: 29.92053985595703
Epoch: 2, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.873 Vali Acc: 0.240 Test Loss: 1.873 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.329171180725098
Epoch: 3, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
Validation loss decreased (-0.247127 --> -0.258538).  Saving model ...
Epoch: 4 cost time: 31.387165784835815
Epoch: 4, Steps: 17 | Train Loss: 1.959 Vali Loss: 2.851 Vali Acc: 0.243 Test Loss: 2.851 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.301007986068726
Epoch: 5, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.954 Vali Acc: 0.236 Test Loss: 1.954 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 31.98911166191101
Epoch: 6, Steps: 17 | Train Loss: 1.753 Vali Loss: 2.426 Vali Acc: 0.236 Test Loss: 2.426 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 32.57743310928345
Epoch: 7, Steps: 17 | Train Loss: 1.851 Vali Loss: 2.221 Vali Acc: 0.274 Test Loss: 2.221 Test Acc: 0.274
Validation loss decreased (-0.258538 --> -0.273742).  Saving model ...
Epoch: 8 cost time: 32.6010000705719
Epoch: 8, Steps: 17 | Train Loss: 1.597 Vali Loss: 2.151 Vali Acc: 0.228 Test Loss: 2.151 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.64153528213501
Epoch: 9, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.544 Vali Acc: 0.262 Test Loss: 2.544 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 32.507805585861206
Epoch: 10, Steps: 17 | Train Loss: 1.410 Vali Loss: 3.634 Vali Acc: 0.255 Test Loss: 3.634 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 32.586658239364624
Epoch: 11, Steps: 17 | Train Loss: 1.637 Vali Loss: 3.582 Vali Acc: 0.228 Test Loss: 3.582 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 31.367176294326782
Epoch: 12, Steps: 17 | Train Loss: 1.263 Vali Loss: 2.191 Vali Acc: 0.232 Test Loss: 2.191 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.262213706970215
Epoch: 13, Steps: 17 | Train Loss: 0.997 Vali Loss: 2.592 Vali Acc: 0.236 Test Loss: 2.592 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 32.43818187713623
Epoch: 14, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.237 Vali Acc: 0.228 Test Loss: 2.237 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 31.329572677612305
Epoch: 15, Steps: 17 | Train Loss: 0.801 Vali Loss: 2.749 Vali Acc: 0.255 Test Loss: 2.749 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 32.09245991706848
Epoch: 16, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.515 Vali Acc: 0.236 Test Loss: 2.515 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 31.935288906097412
Epoch: 17, Steps: 17 | Train Loss: 0.818 Vali Loss: 3.876 Vali Acc: 0.262 Test Loss: 3.876 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 9159044
model size : 37.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 217.60717391967773
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.494 Vali Acc: 0.278 Test Loss: 1.494 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 215.44215440750122
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.608 Vali Acc: 0.259 Test Loss: 1.608 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 204.159015417099
Epoch: 3, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 217.5238287448883
Epoch: 4, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.686 Vali Acc: 0.247 Test Loss: 1.686 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 202.9274399280548
Epoch: 5, Steps: 17 | Train Loss: 1.497 Vali Loss: 2.048 Vali Acc: 0.251 Test Loss: 2.048 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 210.80113887786865
Epoch: 6, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.955 Vali Acc: 0.274 Test Loss: 1.955 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 208.5449995994568
Epoch: 7, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.883 Vali Acc: 0.251 Test Loss: 1.883 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 210.67637181282043
Epoch: 8, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.772 Vali Acc: 0.270 Test Loss: 1.772 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 210.94968509674072
Epoch: 9, Steps: 17 | Train Loss: 1.270 Vali Loss: 2.340 Vali Acc: 0.228 Test Loss: 2.340 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 205.22721147537231
Epoch: 10, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.673 Vali Acc: 0.278 Test Loss: 1.673 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 216.84353923797607
Epoch: 11, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.153 Vali Acc: 0.259 Test Loss: 2.153 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 28569924
model size : 110.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 78.86136484146118
Epoch: 1, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 73.89056706428528
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247132).  Saving model ...
Epoch: 3 cost time: 75.638995885849
Epoch: 3, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.313 Vali Acc: 0.262 Test Loss: 2.313 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262334).  Saving model ...
Epoch: 4 cost time: 77.70327544212341
Epoch: 4, Steps: 17 | Train Loss: 1.698 Vali Loss: 2.111 Vali Acc: 0.270 Test Loss: 2.111 Test Acc: 0.270
Validation loss decreased (-0.262334 --> -0.269941).  Saving model ...
Epoch: 5 cost time: 78.16843700408936
Epoch: 5, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.990 Vali Acc: 0.255 Test Loss: 1.990 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 74.88981771469116
Epoch: 6, Steps: 17 | Train Loss: 1.552 Vali Loss: 2.210 Vali Acc: 0.251 Test Loss: 2.210 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 80.57277846336365
Epoch: 7, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.821 Vali Acc: 0.213 Test Loss: 1.821 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 77.82148456573486
Epoch: 8, Steps: 17 | Train Loss: 1.246 Vali Loss: 2.876 Vali Acc: 0.232 Test Loss: 2.876 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 76.90704679489136
Epoch: 9, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.980 Vali Acc: 0.289 Test Loss: 1.980 Test Acc: 0.289
Validation loss decreased (-0.269941 --> -0.288954).  Saving model ...
Epoch: 10 cost time: 76.30540800094604
Epoch: 10, Steps: 17 | Train Loss: 1.198 Vali Loss: 2.195 Vali Acc: 0.236 Test Loss: 2.195 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 76.36028051376343
Epoch: 11, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.553 Vali Acc: 0.278 Test Loss: 2.553 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 78.34546256065369
Epoch: 12, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.901 Vali Acc: 0.259 Test Loss: 1.901 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 78.57563424110413
Epoch: 13, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.145 Vali Acc: 0.270 Test Loss: 2.145 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 76.19115376472473
Epoch: 14, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.255 Vali Acc: 0.255 Test Loss: 2.255 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 71.30504179000854
Epoch: 15, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.530 Vali Acc: 0.251 Test Loss: 2.530 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 65.26358199119568
Epoch: 16, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.202 Vali Acc: 0.240 Test Loss: 2.202 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 74.37983012199402
Epoch: 17, Steps: 17 | Train Loss: 1.084 Vali Loss: 2.647 Vali Acc: 0.243 Test Loss: 2.647 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 70.16638278961182
Epoch: 18, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.655 Vali Acc: 0.259 Test Loss: 2.655 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 74.69540071487427
Epoch: 19, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.886 Vali Acc: 0.247 Test Loss: 2.886 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 8710596
model size : 34.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 142.65073537826538
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.494 Vali Acc: 0.278 Test Loss: 1.494 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 143.595458984375
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.608 Vali Acc: 0.259 Test Loss: 1.608 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 147.73564171791077
Epoch: 3, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 149.413165807724
Epoch: 4, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.686 Vali Acc: 0.247 Test Loss: 1.686 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 140.8341248035431
Epoch: 5, Steps: 17 | Train Loss: 1.497 Vali Loss: 2.048 Vali Acc: 0.251 Test Loss: 2.048 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 147.2813527584076
Epoch: 6, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.955 Vali Acc: 0.274 Test Loss: 1.955 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 145.64251470565796
Epoch: 7, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.883 Vali Acc: 0.251 Test Loss: 1.883 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 143.454270362854
Epoch: 8, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.772 Vali Acc: 0.270 Test Loss: 1.772 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 150.11327004432678
Epoch: 9, Steps: 17 | Train Loss: 1.269 Vali Loss: 2.343 Vali Acc: 0.228 Test Loss: 2.343 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 147.16154861450195
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.673 Vali Acc: 0.285 Test Loss: 1.673 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285154).  Saving model ...
Epoch: 11 cost time: 141.7270748615265
Epoch: 11, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.121 Vali Acc: 0.259 Test Loss: 2.121 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 145.37793970108032
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.487 Vali Acc: 0.232 Test Loss: 2.487 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 150.1003897190094
Epoch: 13, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.169 Vali Acc: 0.281 Test Loss: 2.169 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 143.45539546012878
Epoch: 14, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.306 Vali Acc: 0.293 Test Loss: 2.306 Test Acc: 0.293
Validation loss decreased (-0.285154 --> -0.292753).  Saving model ...
Epoch: 15 cost time: 139.51329588890076
Epoch: 15, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.483 Vali Acc: 0.262 Test Loss: 2.483 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 130.41832876205444
Epoch: 16, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.979 Vali Acc: 0.228 Test Loss: 2.979 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 145.79124402999878
Epoch: 17, Steps: 17 | Train Loss: 0.696 Vali Loss: 2.780 Vali Acc: 0.255 Test Loss: 2.780 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 141.6679811477661
Epoch: 18, Steps: 17 | Train Loss: 0.534 Vali Loss: 2.831 Vali Acc: 0.285 Test Loss: 2.831 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 143.76543188095093
Epoch: 19, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.745 Vali Acc: 0.259 Test Loss: 2.745 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 140.81539177894592
Epoch: 20, Steps: 17 | Train Loss: 0.424 Vali Loss: 3.314 Vali Acc: 0.281 Test Loss: 3.314 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 139.26254153251648
Epoch: 21, Steps: 17 | Train Loss: 0.309 Vali Loss: 3.357 Vali Acc: 0.281 Test Loss: 3.357 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 144.24022793769836
Epoch: 22, Steps: 17 | Train Loss: 0.270 Vali Loss: 2.960 Vali Acc: 0.274 Test Loss: 2.960 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 138.37515234947205
Epoch: 23, Steps: 17 | Train Loss: 0.323 Vali Loss: 3.481 Vali Acc: 0.266 Test Loss: 3.481 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 141.395742893219
Epoch: 24, Steps: 17 | Train Loss: 0.185 Vali Loss: 3.697 Vali Acc: 0.274 Test Loss: 3.697 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 28569924
model size : 110.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 54.90277051925659
Epoch: 1, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 53.24410891532898
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247132).  Saving model ...
Epoch: 3 cost time: 50.64659833908081
Epoch: 3, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.313 Vali Acc: 0.262 Test Loss: 2.313 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262334).  Saving model ...
Epoch: 4 cost time: 55.50406861305237
Epoch: 4, Steps: 17 | Train Loss: 1.698 Vali Loss: 2.111 Vali Acc: 0.270 Test Loss: 2.111 Test Acc: 0.270
Validation loss decreased (-0.262334 --> -0.269941).  Saving model ...
Epoch: 5 cost time: 54.55003762245178
Epoch: 5, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.990 Vali Acc: 0.255 Test Loss: 1.990 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 57.525789737701416
Epoch: 6, Steps: 17 | Train Loss: 1.552 Vali Loss: 2.209 Vali Acc: 0.255 Test Loss: 2.209 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 56.32727098464966
Epoch: 7, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.821 Vali Acc: 0.213 Test Loss: 1.821 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 51.685290575027466
Epoch: 8, Steps: 17 | Train Loss: 1.246 Vali Loss: 2.875 Vali Acc: 0.232 Test Loss: 2.875 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 53.76007080078125
Epoch: 9, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.980 Vali Acc: 0.289 Test Loss: 1.980 Test Acc: 0.289
Validation loss decreased (-0.269941 --> -0.288954).  Saving model ...
Epoch: 10 cost time: 53.04361915588379
Epoch: 10, Steps: 17 | Train Loss: 1.198 Vali Loss: 2.196 Vali Acc: 0.236 Test Loss: 2.196 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 50.74638366699219
Epoch: 11, Steps: 17 | Train Loss: 1.311 Vali Loss: 2.554 Vali Acc: 0.278 Test Loss: 2.554 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 56.514392137527466
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.905 Vali Acc: 0.259 Test Loss: 1.905 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 56.63368511199951
Epoch: 13, Steps: 17 | Train Loss: 1.077 Vali Loss: 2.161 Vali Acc: 0.270 Test Loss: 2.161 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 52.87260603904724
Epoch: 14, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.234 Vali Acc: 0.243 Test Loss: 2.234 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 55.137256145477295
Epoch: 15, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.475 Vali Acc: 0.243 Test Loss: 2.475 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 56.92961502075195
Epoch: 16, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.302 Vali Acc: 0.236 Test Loss: 2.302 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 58.70802140235901
Epoch: 17, Steps: 17 | Train Loss: 0.886 Vali Loss: 3.565 Vali Acc: 0.221 Test Loss: 3.565 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 55.092753648757935
Epoch: 18, Steps: 17 | Train Loss: 0.635 Vali Loss: 2.613 Vali Acc: 0.247 Test Loss: 2.613 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 58.74186444282532
Epoch: 19, Steps: 17 | Train Loss: 0.578 Vali Loss: 2.644 Vali Acc: 0.259 Test Loss: 2.644 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 8710596
model size : 34.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 86.12240767478943
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.494 Vali Acc: 0.278 Test Loss: 1.494 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 83.84073305130005
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.608 Vali Acc: 0.259 Test Loss: 1.608 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 87.54187202453613
Epoch: 3, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.831 Vali Acc: 0.270 Test Loss: 1.831 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 82.95071053504944
Epoch: 4, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.686 Vali Acc: 0.247 Test Loss: 1.686 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 84.33230805397034
Epoch: 5, Steps: 17 | Train Loss: 1.497 Vali Loss: 2.048 Vali Acc: 0.251 Test Loss: 2.048 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 89.09794044494629
Epoch: 6, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.955 Vali Acc: 0.274 Test Loss: 1.955 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 89.55725622177124
Epoch: 7, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.883 Vali Acc: 0.251 Test Loss: 1.883 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 88.40688824653625
Epoch: 8, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.772 Vali Acc: 0.270 Test Loss: 1.772 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 79.93698072433472
Epoch: 9, Steps: 17 | Train Loss: 1.269 Vali Loss: 2.343 Vali Acc: 0.228 Test Loss: 2.343 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 87.59422063827515
Epoch: 10, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.673 Vali Acc: 0.285 Test Loss: 1.673 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285154).  Saving model ...
Epoch: 11 cost time: 85.35494923591614
Epoch: 11, Steps: 17 | Train Loss: 1.012 Vali Loss: 2.112 Vali Acc: 0.255 Test Loss: 2.112 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 86.41129159927368
Epoch: 12, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.496 Vali Acc: 0.232 Test Loss: 2.496 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 84.4001784324646
Epoch: 13, Steps: 17 | Train Loss: 0.948 Vali Loss: 2.163 Vali Acc: 0.278 Test Loss: 2.163 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 88.24269413948059
Epoch: 14, Steps: 17 | Train Loss: 0.799 Vali Loss: 2.330 Vali Acc: 0.289 Test Loss: 2.330 Test Acc: 0.289
Validation loss decreased (-0.285154 --> -0.288950).  Saving model ...
Epoch: 15 cost time: 90.04176640510559
Epoch: 15, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.484 Vali Acc: 0.259 Test Loss: 2.484 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 81.83082008361816
Epoch: 16, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.971 Vali Acc: 0.240 Test Loss: 2.971 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 84.33948230743408
Epoch: 17, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.706 Vali Acc: 0.266 Test Loss: 2.706 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 86.51514983177185
Epoch: 18, Steps: 17 | Train Loss: 0.586 Vali Loss: 2.684 Vali Acc: 0.278 Test Loss: 2.684 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 87.59595036506653
Epoch: 19, Steps: 17 | Train Loss: 0.491 Vali Loss: 2.926 Vali Acc: 0.262 Test Loss: 2.926 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 85.93175005912781
Epoch: 20, Steps: 17 | Train Loss: 0.406 Vali Loss: 3.142 Vali Acc: 0.293 Test Loss: 3.142 Test Acc: 0.293
Validation loss decreased (-0.288950 --> -0.292744).  Saving model ...
Epoch: 21 cost time: 82.11022782325745
Epoch: 21, Steps: 17 | Train Loss: 0.304 Vali Loss: 3.349 Vali Acc: 0.262 Test Loss: 3.349 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 90.16540694236755
Epoch: 22, Steps: 17 | Train Loss: 0.322 Vali Loss: 3.482 Vali Acc: 0.255 Test Loss: 3.482 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 87.07070708274841
Epoch: 23, Steps: 17 | Train Loss: 0.270 Vali Loss: 3.475 Vali Acc: 0.266 Test Loss: 3.475 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 85.84880304336548
Epoch: 24, Steps: 17 | Train Loss: 0.166 Vali Loss: 3.563 Vali Acc: 0.247 Test Loss: 3.563 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 84.34186005592346
Epoch: 25, Steps: 17 | Train Loss: 0.238 Vali Loss: 4.498 Vali Acc: 0.300 Test Loss: 4.498 Test Acc: 0.300
Validation loss decreased (-0.292744 --> -0.300335).  Saving model ...
Epoch: 26 cost time: 78.68028998374939
Epoch: 26, Steps: 17 | Train Loss: 0.135 Vali Loss: 4.341 Vali Acc: 0.300 Test Loss: 4.341 Test Acc: 0.300
Validation loss decreased (-0.300335 --> -0.300337).  Saving model ...
Epoch: 27 cost time: 79.70932579040527
Epoch: 27, Steps: 17 | Train Loss: 0.149 Vali Loss: 5.212 Vali Acc: 0.278 Test Loss: 5.212 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 78.44530916213989
Epoch: 28, Steps: 17 | Train Loss: 0.272 Vali Loss: 5.145 Vali Acc: 0.297 Test Loss: 5.145 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 81.32055473327637
Epoch: 29, Steps: 17 | Train Loss: 0.158 Vali Loss: 5.368 Vali Acc: 0.281 Test Loss: 5.368 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 85.7002022266388
Epoch: 30, Steps: 17 | Train Loss: 0.112 Vali Loss: 5.181 Vali Acc: 0.262 Test Loss: 5.181 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 28569924
model size : 110.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 35.24622440338135
Epoch: 1, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.462 Vali Acc: 0.243 Test Loss: 1.462 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 31.19147801399231
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247132).  Saving model ...
Epoch: 3 cost time: 32.12266135215759
Epoch: 3, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.313 Vali Acc: 0.262 Test Loss: 2.313 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262334).  Saving model ...
Epoch: 4 cost time: 31.432515621185303
Epoch: 4, Steps: 17 | Train Loss: 1.698 Vali Loss: 2.111 Vali Acc: 0.270 Test Loss: 2.111 Test Acc: 0.270
Validation loss decreased (-0.262334 --> -0.269941).  Saving model ...
Epoch: 5 cost time: 32.081820487976074
Epoch: 5, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.990 Vali Acc: 0.255 Test Loss: 1.990 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.22224974632263
Epoch: 6, Steps: 17 | Train Loss: 1.552 Vali Loss: 2.209 Vali Acc: 0.255 Test Loss: 2.209 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.542359352111816
Epoch: 7, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.821 Vali Acc: 0.213 Test Loss: 1.821 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 31.584295511245728
Epoch: 8, Steps: 17 | Train Loss: 1.246 Vali Loss: 2.875 Vali Acc: 0.232 Test Loss: 2.875 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 31.116453886032104
Epoch: 9, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.980 Vali Acc: 0.289 Test Loss: 1.980 Test Acc: 0.289
Validation loss decreased (-0.269941 --> -0.288954).  Saving model ...
Epoch: 10 cost time: 32.79531526565552
Epoch: 10, Steps: 17 | Train Loss: 1.198 Vali Loss: 2.195 Vali Acc: 0.236 Test Loss: 2.195 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 33.87339115142822
Epoch: 11, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.554 Vali Acc: 0.278 Test Loss: 2.554 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 31.497966051101685
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.903 Vali Acc: 0.259 Test Loss: 1.903 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 34.43533778190613
Epoch: 13, Steps: 17 | Train Loss: 1.077 Vali Loss: 2.153 Vali Acc: 0.270 Test Loss: 2.153 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 34.89815425872803
Epoch: 14, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.250 Vali Acc: 0.251 Test Loss: 2.250 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 31.324121952056885
Epoch: 15, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.517 Vali Acc: 0.243 Test Loss: 2.517 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 33.57892632484436
Epoch: 16, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.251 Vali Acc: 0.240 Test Loss: 2.251 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 32.2335000038147
Epoch: 17, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.934 Vali Acc: 0.228 Test Loss: 2.934 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 33.36831068992615
Epoch: 18, Steps: 17 | Train Loss: 0.621 Vali Loss: 2.332 Vali Acc: 0.262 Test Loss: 2.332 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 33.84463858604431
Epoch: 19, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.677 Vali Acc: 0.262 Test Loss: 2.677 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 8710596
model size : 34.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 109.55729794502258
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.812 Vali Acc: 0.232 Test Loss: 1.812 Test Acc: 0.232
Validation loss decreased (inf --> -0.231921).  Saving model ...
Epoch: 2 cost time: 106.64144349098206
Epoch: 2, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.732 Vali Acc: 0.217 Test Loss: 1.732 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 102.7024712562561
Epoch: 3, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.510 Vali Acc: 0.232 Test Loss: 1.510 Test Acc: 0.232
Validation loss decreased (-0.231921 --> -0.231924).  Saving model ...
Epoch: 4 cost time: 104.74745297431946
Epoch: 4, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.655 Vali Acc: 0.281 Test Loss: 1.655 Test Acc: 0.281
Validation loss decreased (-0.231924 --> -0.281352).  Saving model ...
Epoch: 5 cost time: 107.05202555656433
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.714 Vali Acc: 0.270 Test Loss: 1.714 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 103.23176074028015
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.922 Vali Acc: 0.247 Test Loss: 1.922 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 104.76841521263123
Epoch: 7, Steps: 17 | Train Loss: 1.257 Vali Loss: 2.258 Vali Acc: 0.228 Test Loss: 2.258 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 106.79334354400635
Epoch: 8, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.418 Vali Acc: 0.274 Test Loss: 2.418 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 103.97033095359802
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.037 Vali Acc: 0.300 Test Loss: 2.037 Test Acc: 0.300
Validation loss decreased (-0.281352 --> -0.300360).  Saving model ...
Epoch: 10 cost time: 107.83952760696411
Epoch: 10, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.238 Vali Acc: 0.274 Test Loss: 2.238 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 109.87884402275085
Epoch: 11, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.098 Vali Acc: 0.255 Test Loss: 2.098 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 102.60644483566284
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.015 Vali Acc: 0.262 Test Loss: 2.015 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 102.77803945541382
Epoch: 13, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.211 Vali Acc: 0.240 Test Loss: 2.211 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 98.81158781051636
Epoch: 14, Steps: 17 | Train Loss: 1.137 Vali Loss: 2.987 Vali Acc: 0.259 Test Loss: 2.987 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 111.56578373908997
Epoch: 15, Steps: 17 | Train Loss: 1.206 Vali Loss: 2.387 Vali Acc: 0.255 Test Loss: 2.387 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 110.42694187164307
Epoch: 16, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.865 Vali Acc: 0.243 Test Loss: 2.865 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 116.26097798347473
Epoch: 17, Steps: 17 | Train Loss: 0.745 Vali Loss: 2.442 Vali Acc: 0.312 Test Loss: 2.442 Test Acc: 0.312
Validation loss decreased (-0.300360 --> -0.311763).  Saving model ...
Epoch: 18 cost time: 115.59708762168884
Epoch: 18, Steps: 17 | Train Loss: 0.665 Vali Loss: 3.318 Vali Acc: 0.266 Test Loss: 3.318 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 105.76533722877502
Epoch: 19, Steps: 17 | Train Loss: 0.627 Vali Loss: 3.101 Vali Acc: 0.270 Test Loss: 3.101 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 114.43757772445679
Epoch: 20, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.974 Vali Acc: 0.240 Test Loss: 2.974 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 113.92655205726624
Epoch: 21, Steps: 17 | Train Loss: 0.524 Vali Loss: 2.916 Vali Acc: 0.266 Test Loss: 2.916 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 107.99858117103577
Epoch: 22, Steps: 17 | Train Loss: 0.407 Vali Loss: 3.926 Vali Acc: 0.240 Test Loss: 3.926 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 116.29015922546387
Epoch: 23, Steps: 17 | Train Loss: 0.432 Vali Loss: 3.155 Vali Acc: 0.255 Test Loss: 3.155 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 113.50880980491638
Epoch: 24, Steps: 17 | Train Loss: 0.380 Vali Loss: 4.110 Vali Acc: 0.289 Test Loss: 4.110 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 111.09758448600769
Epoch: 25, Steps: 17 | Train Loss: 0.259 Vali Loss: 4.181 Vali Acc: 0.240 Test Loss: 4.181 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 113.35451769828796
Epoch: 26, Steps: 17 | Train Loss: 0.238 Vali Loss: 4.585 Vali Acc: 0.262 Test Loss: 4.585 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 110.81055164337158
Epoch: 27, Steps: 17 | Train Loss: 0.193 Vali Loss: 4.432 Vali Acc: 0.259 Test Loss: 4.432 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 14510148
model size : 56.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 44.563804149627686
Epoch: 1, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.630 Vali Acc: 0.224 Test Loss: 1.630 Test Acc: 0.224
Validation loss decreased (inf --> -0.224318).  Saving model ...
Epoch: 2 cost time: 42.41781735420227
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.904 Vali Acc: 0.224 Test Loss: 1.904 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 42.262938261032104
Epoch: 3, Steps: 17 | Train Loss: 1.761 Vali Loss: 2.262 Vali Acc: 0.247 Test Loss: 2.262 Test Acc: 0.247
Validation loss decreased (-0.224318 --> -0.247126).  Saving model ...
Epoch: 4 cost time: 43.04903841018677
Epoch: 4, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.802 Vali Acc: 0.259 Test Loss: 1.802 Test Acc: 0.259
Validation loss decreased (-0.247126 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 45.58829307556152
Epoch: 5, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.796 Vali Acc: 0.240 Test Loss: 1.796 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 45.62574219703674
Epoch: 6, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.698 Vali Acc: 0.300 Test Loss: 1.698 Test Acc: 0.300
Validation loss decreased (-0.258537 --> -0.300363).  Saving model ...
Epoch: 7 cost time: 45.64746952056885
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 44.6920120716095
Epoch: 8, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.909 Vali Acc: 0.240 Test Loss: 1.909 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 43.82118082046509
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.194 Vali Acc: 0.270 Test Loss: 2.194 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 40.27815270423889
Epoch: 10, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.931 Vali Acc: 0.236 Test Loss: 1.931 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 42.81829261779785
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 2.364 Vali Acc: 0.221 Test Loss: 2.364 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 44.006590604782104
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.092 Vali Acc: 0.270 Test Loss: 2.092 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 44.09309267997742
Epoch: 13, Steps: 17 | Train Loss: 0.989 Vali Loss: 2.663 Vali Acc: 0.274 Test Loss: 2.663 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 43.890384674072266
Epoch: 14, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.430 Vali Acc: 0.278 Test Loss: 2.430 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 44.047523975372314
Epoch: 15, Steps: 17 | Train Loss: 0.871 Vali Loss: 3.110 Vali Acc: 0.251 Test Loss: 3.110 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 40.44048047065735
Epoch: 16, Steps: 17 | Train Loss: 0.839 Vali Loss: 2.309 Vali Acc: 0.285 Test Loss: 2.309 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4580292
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 80.25263929367065
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.812 Vali Acc: 0.232 Test Loss: 1.812 Test Acc: 0.232
Validation loss decreased (inf --> -0.231921).  Saving model ...
Epoch: 2 cost time: 81.13537836074829
Epoch: 2, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.732 Vali Acc: 0.217 Test Loss: 1.732 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 79.74474239349365
Epoch: 3, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.510 Vali Acc: 0.232 Test Loss: 1.510 Test Acc: 0.232
Validation loss decreased (-0.231921 --> -0.231924).  Saving model ...
Epoch: 4 cost time: 80.41187453269958
Epoch: 4, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.655 Vali Acc: 0.281 Test Loss: 1.655 Test Acc: 0.281
Validation loss decreased (-0.231924 --> -0.281352).  Saving model ...
Epoch: 5 cost time: 78.75414228439331
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.714 Vali Acc: 0.270 Test Loss: 1.714 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 80.60327959060669
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.922 Vali Acc: 0.247 Test Loss: 1.922 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 79.32450366020203
Epoch: 7, Steps: 17 | Train Loss: 1.257 Vali Loss: 2.258 Vali Acc: 0.228 Test Loss: 2.258 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 83.28613209724426
Epoch: 8, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.418 Vali Acc: 0.274 Test Loss: 2.418 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 80.03975892066956
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.037 Vali Acc: 0.300 Test Loss: 2.037 Test Acc: 0.300
Validation loss decreased (-0.281352 --> -0.300360).  Saving model ...
Epoch: 10 cost time: 77.81328749656677
Epoch: 10, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.238 Vali Acc: 0.274 Test Loss: 2.238 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 83.41795420646667
Epoch: 11, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.098 Vali Acc: 0.255 Test Loss: 2.098 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 84.2767653465271
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.016 Vali Acc: 0.262 Test Loss: 2.016 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 81.88200974464417
Epoch: 13, Steps: 17 | Train Loss: 1.152 Vali Loss: 2.209 Vali Acc: 0.240 Test Loss: 2.209 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 76.71820068359375
Epoch: 14, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.990 Vali Acc: 0.262 Test Loss: 2.990 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 80.77215027809143
Epoch: 15, Steps: 17 | Train Loss: 1.206 Vali Loss: 2.382 Vali Acc: 0.255 Test Loss: 2.382 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 84.8760085105896
Epoch: 16, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.864 Vali Acc: 0.243 Test Loss: 2.864 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 82.38779187202454
Epoch: 17, Steps: 17 | Train Loss: 0.744 Vali Loss: 2.464 Vali Acc: 0.312 Test Loss: 2.464 Test Acc: 0.312
Validation loss decreased (-0.300360 --> -0.311762).  Saving model ...
Epoch: 18 cost time: 86.48942923545837
Epoch: 18, Steps: 17 | Train Loss: 0.655 Vali Loss: 3.278 Vali Acc: 0.274 Test Loss: 3.278 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 86.46489953994751
Epoch: 19, Steps: 17 | Train Loss: 0.628 Vali Loss: 3.092 Vali Acc: 0.274 Test Loss: 3.092 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 85.29533410072327
Epoch: 20, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.999 Vali Acc: 0.247 Test Loss: 2.999 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 84.08752131462097
Epoch: 21, Steps: 17 | Train Loss: 0.511 Vali Loss: 2.964 Vali Acc: 0.266 Test Loss: 2.964 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 83.97879076004028
Epoch: 22, Steps: 17 | Train Loss: 0.416 Vali Loss: 4.018 Vali Acc: 0.236 Test Loss: 4.018 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 84.2622537612915
Epoch: 23, Steps: 17 | Train Loss: 0.453 Vali Loss: 3.172 Vali Acc: 0.243 Test Loss: 3.172 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 80.02445411682129
Epoch: 24, Steps: 17 | Train Loss: 0.382 Vali Loss: 3.971 Vali Acc: 0.274 Test Loss: 3.971 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 85.64686679840088
Epoch: 25, Steps: 17 | Train Loss: 0.250 Vali Loss: 4.077 Vali Acc: 0.289 Test Loss: 4.077 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 86.1415708065033
Epoch: 26, Steps: 17 | Train Loss: 0.199 Vali Loss: 4.389 Vali Acc: 0.297 Test Loss: 4.389 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 83.63246631622314
Epoch: 27, Steps: 17 | Train Loss: 0.170 Vali Loss: 4.161 Vali Acc: 0.259 Test Loss: 4.161 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 14510148
model size : 56.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 35.016231298446655
Epoch: 1, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.630 Vali Acc: 0.224 Test Loss: 1.630 Test Acc: 0.224
Validation loss decreased (inf --> -0.224318).  Saving model ...
Epoch: 2 cost time: 32.96432089805603
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.904 Vali Acc: 0.224 Test Loss: 1.904 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.26006841659546
Epoch: 3, Steps: 17 | Train Loss: 1.761 Vali Loss: 2.262 Vali Acc: 0.247 Test Loss: 2.262 Test Acc: 0.247
Validation loss decreased (-0.224318 --> -0.247126).  Saving model ...
Epoch: 4 cost time: 33.487865686416626
Epoch: 4, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.802 Vali Acc: 0.259 Test Loss: 1.802 Test Acc: 0.259
Validation loss decreased (-0.247126 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 33.545143604278564
Epoch: 5, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.796 Vali Acc: 0.240 Test Loss: 1.796 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.076157093048096
Epoch: 6, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.698 Vali Acc: 0.300 Test Loss: 1.698 Test Acc: 0.300
Validation loss decreased (-0.258537 --> -0.300363).  Saving model ...
Epoch: 7 cost time: 31.207002878189087
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.15330910682678
Epoch: 8, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.909 Vali Acc: 0.240 Test Loss: 1.909 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 33.11258578300476
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.194 Vali Acc: 0.270 Test Loss: 2.194 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 32.975056648254395
Epoch: 10, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.931 Vali Acc: 0.236 Test Loss: 1.931 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 33.22181034088135
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 2.364 Vali Acc: 0.221 Test Loss: 2.364 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 33.2955060005188
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.091 Vali Acc: 0.270 Test Loss: 2.091 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 33.25083088874817
Epoch: 13, Steps: 17 | Train Loss: 0.989 Vali Loss: 2.667 Vali Acc: 0.274 Test Loss: 2.667 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 33.201178312301636
Epoch: 14, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.454 Vali Acc: 0.281 Test Loss: 2.454 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 32.522746562957764
Epoch: 15, Steps: 17 | Train Loss: 0.884 Vali Loss: 3.060 Vali Acc: 0.251 Test Loss: 3.060 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 32.68785309791565
Epoch: 16, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.272 Vali Acc: 0.278 Test Loss: 2.272 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4580292
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 52.6523962020874
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.812 Vali Acc: 0.232 Test Loss: 1.812 Test Acc: 0.232
Validation loss decreased (inf --> -0.231921).  Saving model ...
Epoch: 2 cost time: 51.085596323013306
Epoch: 2, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.732 Vali Acc: 0.217 Test Loss: 1.732 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 51.04465579986572
Epoch: 3, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.510 Vali Acc: 0.232 Test Loss: 1.510 Test Acc: 0.232
Validation loss decreased (-0.231921 --> -0.231924).  Saving model ...
Epoch: 4 cost time: 50.7775297164917
Epoch: 4, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.655 Vali Acc: 0.281 Test Loss: 1.655 Test Acc: 0.281
Validation loss decreased (-0.231924 --> -0.281352).  Saving model ...
Epoch: 5 cost time: 48.784677505493164
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.714 Vali Acc: 0.270 Test Loss: 1.714 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 51.148723125457764
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.922 Vali Acc: 0.247 Test Loss: 1.922 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 50.93958353996277
Epoch: 7, Steps: 17 | Train Loss: 1.257 Vali Loss: 2.258 Vali Acc: 0.228 Test Loss: 2.258 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 50.3025484085083
Epoch: 8, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.418 Vali Acc: 0.274 Test Loss: 2.418 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 50.2364284992218
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 2.037 Vali Acc: 0.300 Test Loss: 2.037 Test Acc: 0.300
Validation loss decreased (-0.281352 --> -0.300360).  Saving model ...
Epoch: 10 cost time: 47.869569301605225
Epoch: 10, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.238 Vali Acc: 0.274 Test Loss: 2.238 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 50.11469793319702
Epoch: 11, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.098 Vali Acc: 0.255 Test Loss: 2.098 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 50.35939931869507
Epoch: 12, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.015 Vali Acc: 0.255 Test Loss: 2.015 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 50.34084510803223
Epoch: 13, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.212 Vali Acc: 0.240 Test Loss: 2.212 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 51.2050244808197
Epoch: 14, Steps: 17 | Train Loss: 1.137 Vali Loss: 2.981 Vali Acc: 0.259 Test Loss: 2.981 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 49.955599784851074
Epoch: 15, Steps: 17 | Train Loss: 1.206 Vali Loss: 2.401 Vali Acc: 0.255 Test Loss: 2.401 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 49.30308938026428
Epoch: 16, Steps: 17 | Train Loss: 0.872 Vali Loss: 2.860 Vali Acc: 0.247 Test Loss: 2.860 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 51.16499638557434
Epoch: 17, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.410 Vali Acc: 0.312 Test Loss: 2.410 Test Acc: 0.312
Validation loss decreased (-0.300360 --> -0.311763).  Saving model ...
Epoch: 18 cost time: 51.16199469566345
Epoch: 18, Steps: 17 | Train Loss: 0.681 Vali Loss: 3.329 Vali Acc: 0.270 Test Loss: 3.329 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 51.16535210609436
Epoch: 19, Steps: 17 | Train Loss: 0.639 Vali Loss: 3.073 Vali Acc: 0.274 Test Loss: 3.073 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 51.134756565093994
Epoch: 20, Steps: 17 | Train Loss: 0.588 Vali Loss: 2.987 Vali Acc: 0.228 Test Loss: 2.987 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 48.80124258995056
Epoch: 21, Steps: 17 | Train Loss: 0.497 Vali Loss: 3.037 Vali Acc: 0.281 Test Loss: 3.037 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 44.08211159706116
Epoch: 22, Steps: 17 | Train Loss: 0.443 Vali Loss: 4.258 Vali Acc: 0.221 Test Loss: 4.258 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 48.25551676750183
Epoch: 23, Steps: 17 | Train Loss: 0.384 Vali Loss: 3.438 Vali Acc: 0.251 Test Loss: 3.438 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 46.50270485877991
Epoch: 24, Steps: 17 | Train Loss: 0.327 Vali Loss: 4.185 Vali Acc: 0.251 Test Loss: 4.185 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 47.9873993396759
Epoch: 25, Steps: 17 | Train Loss: 0.270 Vali Loss: 4.195 Vali Acc: 0.243 Test Loss: 4.195 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 48.25875449180603
Epoch: 26, Steps: 17 | Train Loss: 0.287 Vali Loss: 4.437 Vali Acc: 0.274 Test Loss: 4.437 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 46.39152479171753
Epoch: 27, Steps: 17 | Train Loss: 0.228 Vali Loss: 4.601 Vali Acc: 0.270 Test Loss: 4.601 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 14510148
model size : 56.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 22.267722845077515
Epoch: 1, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.630 Vali Acc: 0.224 Test Loss: 1.630 Test Acc: 0.224
Validation loss decreased (inf --> -0.224318).  Saving model ...
Epoch: 2 cost time: 19.93941020965576
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.904 Vali Acc: 0.224 Test Loss: 1.904 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.188793659210205
Epoch: 3, Steps: 17 | Train Loss: 1.761 Vali Loss: 2.262 Vali Acc: 0.247 Test Loss: 2.262 Test Acc: 0.247
Validation loss decreased (-0.224318 --> -0.247126).  Saving model ...
Epoch: 4 cost time: 20.67183780670166
Epoch: 4, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.802 Vali Acc: 0.259 Test Loss: 1.802 Test Acc: 0.259
Validation loss decreased (-0.247126 --> -0.258537).  Saving model ...
Epoch: 5 cost time: 20.66567826271057
Epoch: 5, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.796 Vali Acc: 0.240 Test Loss: 1.796 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.627873420715332
Epoch: 6, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.698 Vali Acc: 0.300 Test Loss: 1.698 Test Acc: 0.300
Validation loss decreased (-0.258537 --> -0.300363).  Saving model ...
Epoch: 7 cost time: 20.675294876098633
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.124006032943726
Epoch: 8, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.909 Vali Acc: 0.240 Test Loss: 1.909 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.695069313049316
Epoch: 9, Steps: 17 | Train Loss: 1.334 Vali Loss: 2.194 Vali Acc: 0.270 Test Loss: 2.194 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.716699361801147
Epoch: 10, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.931 Vali Acc: 0.236 Test Loss: 1.931 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.679564476013184
Epoch: 11, Steps: 17 | Train Loss: 1.088 Vali Loss: 2.364 Vali Acc: 0.221 Test Loss: 2.364 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.689770936965942
Epoch: 12, Steps: 17 | Train Loss: 1.103 Vali Loss: 2.091 Vali Acc: 0.270 Test Loss: 2.091 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 19.072924613952637
Epoch: 13, Steps: 17 | Train Loss: 0.990 Vali Loss: 2.666 Vali Acc: 0.274 Test Loss: 2.666 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 20.250665187835693
Epoch: 14, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.448 Vali Acc: 0.281 Test Loss: 2.448 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 20.690189599990845
Epoch: 15, Steps: 17 | Train Loss: 0.882 Vali Loss: 3.070 Vali Acc: 0.251 Test Loss: 3.070 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 20.697120666503906
Epoch: 16, Steps: 17 | Train Loss: 0.830 Vali Loss: 2.279 Vali Acc: 0.281 Test Loss: 2.279 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4580292
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 69.39635181427002
Epoch: 1, Steps: 17 | Train Loss: 1.589 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
Validation loss decreased (inf --> -0.250928).  Saving model ...
Epoch: 2 cost time: 71.24653244018555
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 2.235 Vali Acc: 0.251 Test Loss: 2.235 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 68.58442783355713
Epoch: 3, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.602 Vali Acc: 0.243 Test Loss: 1.602 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 70.536297082901
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.716 Vali Acc: 0.270 Test Loss: 1.716 Test Acc: 0.270
Validation loss decreased (-0.250928 --> -0.269945).  Saving model ...
Epoch: 5 cost time: 71.32259964942932
Epoch: 5, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.957 Vali Acc: 0.247 Test Loss: 1.957 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 69.14214301109314
Epoch: 6, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.814 Vali Acc: 0.300 Test Loss: 1.814 Test Acc: 0.300
Validation loss decreased (-0.269945 --> -0.300362).  Saving model ...
Epoch: 7 cost time: 72.387286901474
Epoch: 7, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.806 Vali Acc: 0.289 Test Loss: 1.806 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 68.38794612884521
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 2.337 Vali Acc: 0.247 Test Loss: 2.337 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 72.7041597366333
Epoch: 9, Steps: 17 | Train Loss: 1.764 Vali Loss: 2.316 Vali Acc: 0.289 Test Loss: 2.316 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 71.3015570640564
Epoch: 10, Steps: 17 | Train Loss: 1.432 Vali Loss: 2.259 Vali Acc: 0.255 Test Loss: 2.259 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 70.53319096565247
Epoch: 11, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.872 Vali Acc: 0.270 Test Loss: 1.872 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 71.49375343322754
Epoch: 12, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.486 Vali Acc: 0.266 Test Loss: 2.486 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 67.24173188209534
Epoch: 13, Steps: 17 | Train Loss: 1.582 Vali Loss: 2.253 Vali Acc: 0.259 Test Loss: 2.253 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 70.63665533065796
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.503 Vali Acc: 0.285 Test Loss: 2.503 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 68.40009665489197
Epoch: 15, Steps: 17 | Train Loss: 1.044 Vali Loss: 2.131 Vali Acc: 0.289 Test Loss: 2.131 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 70.64274263381958
Epoch: 16, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.791 Vali Acc: 0.243 Test Loss: 2.791 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 7480260
model size : 29.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 30.107367515563965
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.946 Vali Acc: 0.251 Test Loss: 1.946 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 28.534114837646484
Epoch: 2, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
Validation loss decreased (-0.250931 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 27.038435220718384
Epoch: 3, Steps: 17 | Train Loss: 1.678 Vali Loss: 2.506 Vali Acc: 0.247 Test Loss: 2.506 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.830413818359375
Epoch: 4, Steps: 17 | Train Loss: 1.738 Vali Loss: 2.239 Vali Acc: 0.228 Test Loss: 2.239 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.543540477752686
Epoch: 5, Steps: 17 | Train Loss: 1.983 Vali Loss: 2.033 Vali Acc: 0.255 Test Loss: 2.033 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 28.558437824249268
Epoch: 6, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.699 Vali Acc: 0.255 Test Loss: 1.699 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.111064910888672
Epoch: 7, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.698 Vali Acc: 0.247 Test Loss: 1.698 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 27.717155933380127
Epoch: 8, Steps: 17 | Train Loss: 1.266 Vali Loss: 2.257 Vali Acc: 0.259 Test Loss: 2.257 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 28.50021481513977
Epoch: 9, Steps: 17 | Train Loss: 1.567 Vali Loss: 2.056 Vali Acc: 0.262 Test Loss: 2.056 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262337).  Saving model ...
Epoch: 10 cost time: 28.647769451141357
Epoch: 10, Steps: 17 | Train Loss: 1.200 Vali Loss: 2.247 Vali Acc: 0.262 Test Loss: 2.247 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 27.09891939163208
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.692 Vali Acc: 0.278 Test Loss: 1.692 Test Acc: 0.278
Validation loss decreased (-0.262337 --> -0.277550).  Saving model ...
Epoch: 12 cost time: 27.87935781478882
Epoch: 12, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.933 Vali Acc: 0.297 Test Loss: 1.933 Test Acc: 0.297
Validation loss decreased (-0.277550 --> -0.296559).  Saving model ...
Epoch: 13 cost time: 27.899372816085815
Epoch: 13, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.306 Vali Acc: 0.285 Test Loss: 2.306 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 28.004698991775513
Epoch: 14, Steps: 17 | Train Loss: 1.177 Vali Loss: 2.001 Vali Acc: 0.278 Test Loss: 2.001 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.364490747451782
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 2.720 Vali Acc: 0.270 Test Loss: 2.720 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 27.356074810028076
Epoch: 16, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.639 Vali Acc: 0.243 Test Loss: 2.639 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 28.00064468383789
Epoch: 17, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.337 Vali Acc: 0.255 Test Loss: 2.337 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 27.593149423599243
Epoch: 18, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.477 Vali Acc: 0.278 Test Loss: 2.477 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 26.14940071105957
Epoch: 19, Steps: 17 | Train Loss: 0.825 Vali Loss: 3.097 Vali Acc: 0.262 Test Loss: 3.097 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 27.49600052833557
Epoch: 20, Steps: 17 | Train Loss: 0.765 Vali Loss: 2.378 Vali Acc: 0.266 Test Loss: 2.378 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 27.940160989761353
Epoch: 21, Steps: 17 | Train Loss: 0.694 Vali Loss: 3.154 Vali Acc: 0.236 Test Loss: 3.154 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 28.108470678329468
Epoch: 22, Steps: 17 | Train Loss: 0.579 Vali Loss: 3.056 Vali Acc: 0.255 Test Loss: 3.056 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2515140
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 50.822956562042236
Epoch: 1, Steps: 17 | Train Loss: 1.589 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
Validation loss decreased (inf --> -0.250928).  Saving model ...
Epoch: 2 cost time: 51.644646406173706
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 2.235 Vali Acc: 0.251 Test Loss: 2.235 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 47.800604820251465
Epoch: 3, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.602 Vali Acc: 0.243 Test Loss: 1.602 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 51.73749613761902
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.716 Vali Acc: 0.270 Test Loss: 1.716 Test Acc: 0.270
Validation loss decreased (-0.250928 --> -0.269945).  Saving model ...
Epoch: 5 cost time: 50.217862367630005
Epoch: 5, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.957 Vali Acc: 0.247 Test Loss: 1.957 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 51.263432264328
Epoch: 6, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.814 Vali Acc: 0.300 Test Loss: 1.814 Test Acc: 0.300
Validation loss decreased (-0.269945 --> -0.300362).  Saving model ...
Epoch: 7 cost time: 52.174099922180176
Epoch: 7, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.806 Vali Acc: 0.289 Test Loss: 1.806 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 49.262062549591064
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 2.338 Vali Acc: 0.247 Test Loss: 2.338 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 50.424497842788696
Epoch: 9, Steps: 17 | Train Loss: 1.765 Vali Loss: 2.313 Vali Acc: 0.289 Test Loss: 2.313 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 46.986517667770386
Epoch: 10, Steps: 17 | Train Loss: 1.432 Vali Loss: 2.268 Vali Acc: 0.259 Test Loss: 2.268 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 50.80938148498535
Epoch: 11, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.881 Vali Acc: 0.270 Test Loss: 1.881 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 49.06012535095215
Epoch: 12, Steps: 17 | Train Loss: 1.088 Vali Loss: 2.498 Vali Acc: 0.266 Test Loss: 2.498 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 50.646761894226074
Epoch: 13, Steps: 17 | Train Loss: 1.592 Vali Loss: 2.235 Vali Acc: 0.259 Test Loss: 2.235 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 50.70926094055176
Epoch: 14, Steps: 17 | Train Loss: 1.163 Vali Loss: 2.516 Vali Acc: 0.289 Test Loss: 2.516 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 48.54227018356323
Epoch: 15, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.094 Vali Acc: 0.278 Test Loss: 2.094 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 51.916343450546265
Epoch: 16, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.751 Vali Acc: 0.247 Test Loss: 2.751 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 7480260
model size : 29.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.157086849212646
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.946 Vali Acc: 0.251 Test Loss: 1.946 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 21.10588264465332
Epoch: 2, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
Validation loss decreased (-0.250931 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 21.408172369003296
Epoch: 3, Steps: 17 | Train Loss: 1.678 Vali Loss: 2.506 Vali Acc: 0.247 Test Loss: 2.506 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.090931177139282
Epoch: 4, Steps: 17 | Train Loss: 1.738 Vali Loss: 2.239 Vali Acc: 0.228 Test Loss: 2.239 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.9372501373291
Epoch: 5, Steps: 17 | Train Loss: 1.983 Vali Loss: 2.033 Vali Acc: 0.255 Test Loss: 2.033 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.5266010761261
Epoch: 6, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.699 Vali Acc: 0.255 Test Loss: 1.699 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.268664836883545
Epoch: 7, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.698 Vali Acc: 0.247 Test Loss: 1.698 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 21.363797187805176
Epoch: 8, Steps: 17 | Train Loss: 1.266 Vali Loss: 2.257 Vali Acc: 0.259 Test Loss: 2.257 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.332359552383423
Epoch: 9, Steps: 17 | Train Loss: 1.567 Vali Loss: 2.056 Vali Acc: 0.262 Test Loss: 2.056 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262337).  Saving model ...
Epoch: 10 cost time: 21.446681261062622
Epoch: 10, Steps: 17 | Train Loss: 1.200 Vali Loss: 2.247 Vali Acc: 0.262 Test Loss: 2.247 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.61376118659973
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.692 Vali Acc: 0.278 Test Loss: 1.692 Test Acc: 0.278
Validation loss decreased (-0.262337 --> -0.277550).  Saving model ...
Epoch: 12 cost time: 19.250200748443604
Epoch: 12, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.933 Vali Acc: 0.297 Test Loss: 1.933 Test Acc: 0.297
Validation loss decreased (-0.277550 --> -0.296559).  Saving model ...
Epoch: 13 cost time: 22.091830730438232
Epoch: 13, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.306 Vali Acc: 0.285 Test Loss: 2.306 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.914223432540894
Epoch: 14, Steps: 17 | Train Loss: 1.177 Vali Loss: 2.001 Vali Acc: 0.278 Test Loss: 2.001 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.723949909210205
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 2.720 Vali Acc: 0.270 Test Loss: 2.720 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.79426407814026
Epoch: 16, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.639 Vali Acc: 0.243 Test Loss: 2.639 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 21.694053888320923
Epoch: 17, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.337 Vali Acc: 0.255 Test Loss: 2.337 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 21.608159065246582
Epoch: 18, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.476 Vali Acc: 0.278 Test Loss: 2.476 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 21.607654809951782
Epoch: 19, Steps: 17 | Train Loss: 0.825 Vali Loss: 3.101 Vali Acc: 0.262 Test Loss: 3.101 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 20.302069664001465
Epoch: 20, Steps: 17 | Train Loss: 0.766 Vali Loss: 2.378 Vali Acc: 0.266 Test Loss: 2.378 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 20.387714624404907
Epoch: 21, Steps: 17 | Train Loss: 0.695 Vali Loss: 3.155 Vali Acc: 0.240 Test Loss: 3.155 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 21.7036554813385
Epoch: 22, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.059 Vali Acc: 0.255 Test Loss: 3.059 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2515140
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 33.306591272354126
Epoch: 1, Steps: 17 | Train Loss: 1.589 Vali Loss: 2.217 Vali Acc: 0.251 Test Loss: 2.217 Test Acc: 0.251
Validation loss decreased (inf --> -0.250928).  Saving model ...
Epoch: 2 cost time: 31.797707080841064
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 2.234 Vali Acc: 0.251 Test Loss: 2.234 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.81266164779663
Epoch: 3, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.602 Vali Acc: 0.243 Test Loss: 1.602 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.672918796539307
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.716 Vali Acc: 0.270 Test Loss: 1.716 Test Acc: 0.270
Validation loss decreased (-0.250928 --> -0.269945).  Saving model ...
Epoch: 5 cost time: 30.38250756263733
Epoch: 5, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.957 Vali Acc: 0.247 Test Loss: 1.957 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.0268919467926
Epoch: 6, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.814 Vali Acc: 0.300 Test Loss: 1.814 Test Acc: 0.300
Validation loss decreased (-0.269945 --> -0.300362).  Saving model ...
Epoch: 7 cost time: 32.39853477478027
Epoch: 7, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.806 Vali Acc: 0.289 Test Loss: 1.806 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.366212606430054
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 2.337 Vali Acc: 0.247 Test Loss: 2.337 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 32.40358018875122
Epoch: 9, Steps: 17 | Train Loss: 1.764 Vali Loss: 2.316 Vali Acc: 0.289 Test Loss: 2.316 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 32.3873393535614
Epoch: 10, Steps: 17 | Train Loss: 1.432 Vali Loss: 2.259 Vali Acc: 0.255 Test Loss: 2.259 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 30.651655197143555
Epoch: 11, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.872 Vali Acc: 0.270 Test Loss: 1.872 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 31.16437816619873
Epoch: 12, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.485 Vali Acc: 0.266 Test Loss: 2.485 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 32.467825174331665
Epoch: 13, Steps: 17 | Train Loss: 1.582 Vali Loss: 2.253 Vali Acc: 0.259 Test Loss: 2.253 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 32.408652782440186
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.503 Vali Acc: 0.285 Test Loss: 2.503 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 32.41485381126404
Epoch: 15, Steps: 17 | Train Loss: 1.044 Vali Loss: 2.132 Vali Acc: 0.289 Test Loss: 2.132 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 32.416664838790894
Epoch: 16, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.793 Vali Acc: 0.240 Test Loss: 2.793 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 7480260
model size : 29.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.460675954818726
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.946 Vali Acc: 0.251 Test Loss: 1.946 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 12.96787405014038
Epoch: 2, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
Validation loss decreased (-0.250931 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 13.062868595123291
Epoch: 3, Steps: 17 | Train Loss: 1.678 Vali Loss: 2.506 Vali Acc: 0.247 Test Loss: 2.506 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.767717838287354
Epoch: 4, Steps: 17 | Train Loss: 1.738 Vali Loss: 2.239 Vali Acc: 0.228 Test Loss: 2.239 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.731319189071655
Epoch: 5, Steps: 17 | Train Loss: 1.983 Vali Loss: 2.032 Vali Acc: 0.255 Test Loss: 2.032 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.743615627288818
Epoch: 6, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.699 Vali Acc: 0.255 Test Loss: 1.699 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.780800342559814
Epoch: 7, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.698 Vali Acc: 0.247 Test Loss: 1.698 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.742645025253296
Epoch: 8, Steps: 17 | Train Loss: 1.266 Vali Loss: 2.257 Vali Acc: 0.259 Test Loss: 2.257 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.79321813583374
Epoch: 9, Steps: 17 | Train Loss: 1.567 Vali Loss: 2.056 Vali Acc: 0.262 Test Loss: 2.056 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262337).  Saving model ...
Epoch: 10 cost time: 13.547030210494995
Epoch: 10, Steps: 17 | Train Loss: 1.200 Vali Loss: 2.247 Vali Acc: 0.262 Test Loss: 2.247 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.78287959098816
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.692 Vali Acc: 0.278 Test Loss: 1.692 Test Acc: 0.278
Validation loss decreased (-0.262337 --> -0.277550).  Saving model ...
Epoch: 12 cost time: 13.832324743270874
Epoch: 12, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.933 Vali Acc: 0.297 Test Loss: 1.933 Test Acc: 0.297
Validation loss decreased (-0.277550 --> -0.296559).  Saving model ...
Epoch: 13 cost time: 13.78533387184143
Epoch: 13, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.307 Vali Acc: 0.285 Test Loss: 2.307 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.931440353393555
Epoch: 14, Steps: 17 | Train Loss: 1.177 Vali Loss: 2.001 Vali Acc: 0.278 Test Loss: 2.001 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.854866981506348
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 2.720 Vali Acc: 0.270 Test Loss: 2.720 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.025439977645874
Epoch: 16, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.639 Vali Acc: 0.243 Test Loss: 2.639 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.797856330871582
Epoch: 17, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.337 Vali Acc: 0.255 Test Loss: 2.337 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.7733314037323
Epoch: 18, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.477 Vali Acc: 0.278 Test Loss: 2.477 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.745323419570923
Epoch: 19, Steps: 17 | Train Loss: 0.825 Vali Loss: 3.097 Vali Acc: 0.262 Test Loss: 3.097 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.657188177108765
Epoch: 20, Steps: 17 | Train Loss: 0.766 Vali Loss: 2.378 Vali Acc: 0.266 Test Loss: 2.378 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.00501275062561
Epoch: 21, Steps: 17 | Train Loss: 0.694 Vali Loss: 3.154 Vali Acc: 0.240 Test Loss: 3.154 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.02115273475647
Epoch: 22, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.057 Vali Acc: 0.255 Test Loss: 3.057 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 2515140
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 74.40154147148132
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.430 Vali Acc: 0.259 Test Loss: 1.430 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 69.29861783981323
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.580 Vali Acc: 0.251 Test Loss: 1.580 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 72.06013369560242
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 71.9951663017273
Epoch: 4, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.502 Vali Acc: 0.266 Test Loss: 1.502 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 70.26478123664856
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.630 Vali Acc: 0.259 Test Loss: 1.630 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 70.89340615272522
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.857 Vali Acc: 0.255 Test Loss: 1.857 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 70.62640929222107
Epoch: 7, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.742 Vali Acc: 0.255 Test Loss: 1.742 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 69.01971793174744
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.748 Vali Acc: 0.259 Test Loss: 1.748 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 70.9253888130188
Epoch: 9, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.766 Vali Acc: 0.270 Test Loss: 1.766 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269944).  Saving model ...
Epoch: 10 cost time: 69.11671924591064
Epoch: 10, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.696 Vali Acc: 0.262 Test Loss: 1.696 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 71.10166668891907
Epoch: 11, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.691 Vali Acc: 0.243 Test Loss: 1.691 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 72.06429243087769
Epoch: 12, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.776 Vali Acc: 0.251 Test Loss: 1.776 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 70.50698947906494
Epoch: 13, Steps: 17 | Train Loss: 1.166 Vali Loss: 2.071 Vali Acc: 0.270 Test Loss: 2.071 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 72.20024132728577
Epoch: 14, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.049 Vali Acc: 0.278 Test Loss: 2.049 Test Acc: 0.278
Validation loss decreased (-0.269944 --> -0.277546).  Saving model ...
Epoch: 15 cost time: 72.30606603622437
Epoch: 15, Steps: 17 | Train Loss: 1.008 Vali Loss: 2.002 Vali Acc: 0.262 Test Loss: 2.002 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 68.83471083641052
Epoch: 16, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.042 Vali Acc: 0.228 Test Loss: 2.042 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 70.75520944595337
Epoch: 17, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.512 Vali Acc: 0.278 Test Loss: 2.512 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 70.83846139907837
Epoch: 18, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.442 Vali Acc: 0.278 Test Loss: 2.442 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 67.48976111412048
Epoch: 19, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.497 Vali Acc: 0.259 Test Loss: 2.497 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 71.15890121459961
Epoch: 20, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.885 Vali Acc: 0.270 Test Loss: 2.885 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 72.01162195205688
Epoch: 21, Steps: 17 | Train Loss: 0.665 Vali Loss: 3.427 Vali Acc: 0.255 Test Loss: 3.427 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 68.15453863143921
Epoch: 22, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.523 Vali Acc: 0.255 Test Loss: 2.523 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 71.96596193313599
Epoch: 23, Steps: 17 | Train Loss: 0.646 Vali Loss: 3.114 Vali Acc: 0.213 Test Loss: 3.114 Test Acc: 0.213
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 71.8002462387085
Epoch: 24, Steps: 17 | Train Loss: 0.490 Vali Loss: 3.080 Vali Acc: 0.262 Test Loss: 3.080 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 7256228
model size : 28.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 32.63792824745178
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.521 Vali Acc: 0.209 Test Loss: 1.521 Test Acc: 0.209
Validation loss decreased (inf --> -0.209110).  Saving model ...
Epoch: 2 cost time: 31.55307126045227
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.738 Vali Acc: 0.266 Test Loss: 1.738 Test Acc: 0.266
Validation loss decreased (-0.209110 --> -0.266142).  Saving model ...
Epoch: 3 cost time: 31.64433741569519
Epoch: 3, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.619 Vali Acc: 0.270 Test Loss: 1.619 Test Acc: 0.270
Validation loss decreased (-0.266142 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 31.012242078781128
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.584 Vali Acc: 0.228 Test Loss: 1.584 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.974801778793335
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.568 Vali Acc: 0.262 Test Loss: 1.568 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.245124101638794
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.755 Vali Acc: 0.262 Test Loss: 1.755 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 29.407288074493408
Epoch: 7, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.037 Vali Acc: 0.236 Test Loss: 2.037 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.946948766708374
Epoch: 8, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 31.115435123443604
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.688 Vali Acc: 0.293 Test Loss: 1.688 Test Acc: 0.293
Validation loss decreased (-0.269946 --> -0.292759).  Saving model ...
Epoch: 10 cost time: 31.458850145339966
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.940 Vali Acc: 0.247 Test Loss: 1.940 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 31.103853464126587
Epoch: 11, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 30.04733920097351
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 2.069 Vali Acc: 0.281 Test Loss: 2.069 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 29.253596782684326
Epoch: 13, Steps: 17 | Train Loss: 1.223 Vali Loss: 2.010 Vali Acc: 0.255 Test Loss: 2.010 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 31.52939248085022
Epoch: 14, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.853 Vali Acc: 0.247 Test Loss: 1.853 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 31.559388160705566
Epoch: 15, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.301 Vali Acc: 0.262 Test Loss: 2.301 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 31.73461151123047
Epoch: 16, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.944 Vali Acc: 0.232 Test Loss: 1.944 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 31.5329327583313
Epoch: 17, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.332 Vali Acc: 0.259 Test Loss: 2.332 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 30.783283233642578
Epoch: 18, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.172 Vali Acc: 0.236 Test Loss: 2.172 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 30.022184371948242
Epoch: 19, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.279 Vali Acc: 0.262 Test Loss: 2.279 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2290916
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 54.282450675964355
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.430 Vali Acc: 0.259 Test Loss: 1.430 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 53.14889049530029
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.580 Vali Acc: 0.251 Test Loss: 1.580 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.38199996948242
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 51.487019300460815
Epoch: 4, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.502 Vali Acc: 0.266 Test Loss: 1.502 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 52.594385623931885
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.630 Vali Acc: 0.259 Test Loss: 1.630 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 52.462385177612305
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.857 Vali Acc: 0.255 Test Loss: 1.857 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 49.67106628417969
Epoch: 7, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.742 Vali Acc: 0.255 Test Loss: 1.742 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 52.793397665023804
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.748 Vali Acc: 0.259 Test Loss: 1.748 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 52.614181995391846
Epoch: 9, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.766 Vali Acc: 0.270 Test Loss: 1.766 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269944).  Saving model ...
Epoch: 10 cost time: 53.131627798080444
Epoch: 10, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.696 Vali Acc: 0.262 Test Loss: 1.696 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 51.24440383911133
Epoch: 11, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.691 Vali Acc: 0.243 Test Loss: 1.691 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 53.74773335456848
Epoch: 12, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.776 Vali Acc: 0.251 Test Loss: 1.776 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 53.654452323913574
Epoch: 13, Steps: 17 | Train Loss: 1.166 Vali Loss: 2.071 Vali Acc: 0.270 Test Loss: 2.071 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 53.88523888587952
Epoch: 14, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.049 Vali Acc: 0.278 Test Loss: 2.049 Test Acc: 0.278
Validation loss decreased (-0.269944 --> -0.277546).  Saving model ...
Epoch: 15 cost time: 52.39941382408142
Epoch: 15, Steps: 17 | Train Loss: 1.008 Vali Loss: 2.002 Vali Acc: 0.262 Test Loss: 2.002 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 54.187098026275635
Epoch: 16, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.043 Vali Acc: 0.228 Test Loss: 2.043 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 54.04941916465759
Epoch: 17, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.512 Vali Acc: 0.278 Test Loss: 2.512 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 50.88071346282959
Epoch: 18, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.440 Vali Acc: 0.278 Test Loss: 2.440 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 53.098960161209106
Epoch: 19, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.499 Vali Acc: 0.259 Test Loss: 2.499 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 52.76386260986328
Epoch: 20, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.876 Vali Acc: 0.270 Test Loss: 2.876 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 53.43294095993042
Epoch: 21, Steps: 17 | Train Loss: 0.664 Vali Loss: 3.442 Vali Acc: 0.255 Test Loss: 3.442 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 50.16865682601929
Epoch: 22, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.547 Vali Acc: 0.240 Test Loss: 2.547 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 52.876410484313965
Epoch: 23, Steps: 17 | Train Loss: 0.652 Vali Loss: 3.082 Vali Acc: 0.209 Test Loss: 3.082 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 54.33915948867798
Epoch: 24, Steps: 17 | Train Loss: 0.490 Vali Loss: 3.111 Vali Acc: 0.266 Test Loss: 3.111 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 7256228
model size : 28.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.636913776397705
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.521 Vali Acc: 0.209 Test Loss: 1.521 Test Acc: 0.209
Validation loss decreased (inf --> -0.209110).  Saving model ...
Epoch: 2 cost time: 22.419600248336792
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.738 Vali Acc: 0.266 Test Loss: 1.738 Test Acc: 0.266
Validation loss decreased (-0.209110 --> -0.266142).  Saving model ...
Epoch: 3 cost time: 23.201218366622925
Epoch: 3, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.619 Vali Acc: 0.270 Test Loss: 1.619 Test Acc: 0.270
Validation loss decreased (-0.266142 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 23.828059673309326
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.584 Vali Acc: 0.228 Test Loss: 1.584 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.01131582260132
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.568 Vali Acc: 0.262 Test Loss: 1.568 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.095030307769775
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.755 Vali Acc: 0.262 Test Loss: 1.755 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.040049076080322
Epoch: 7, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.037 Vali Acc: 0.236 Test Loss: 2.037 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.037440299987793
Epoch: 8, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.570874452590942
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.688 Vali Acc: 0.293 Test Loss: 1.688 Test Acc: 0.293
Validation loss decreased (-0.269946 --> -0.292759).  Saving model ...
Epoch: 10 cost time: 22.567417860031128
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.940 Vali Acc: 0.247 Test Loss: 1.940 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.73905086517334
Epoch: 11, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.12617301940918
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 2.069 Vali Acc: 0.281 Test Loss: 2.069 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.123627185821533
Epoch: 13, Steps: 17 | Train Loss: 1.223 Vali Loss: 2.010 Vali Acc: 0.255 Test Loss: 2.010 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.959704399108887
Epoch: 14, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.853 Vali Acc: 0.247 Test Loss: 1.853 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 23.824297189712524
Epoch: 15, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.301 Vali Acc: 0.262 Test Loss: 2.301 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 23.724089860916138
Epoch: 16, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.944 Vali Acc: 0.232 Test Loss: 1.944 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.79600739479065
Epoch: 17, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.332 Vali Acc: 0.259 Test Loss: 2.332 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 22.322603940963745
Epoch: 18, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.172 Vali Acc: 0.236 Test Loss: 2.172 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 23.844058752059937
Epoch: 19, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.279 Vali Acc: 0.262 Test Loss: 2.279 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2290916
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 33.99979090690613
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.430 Vali Acc: 0.259 Test Loss: 1.430 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 32.55804634094238
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.580 Vali Acc: 0.251 Test Loss: 1.580 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.54292559623718
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.514177799224854
Epoch: 4, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.502 Vali Acc: 0.266 Test Loss: 1.502 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 30.850415468215942
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.630 Vali Acc: 0.259 Test Loss: 1.630 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.435469150543213
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.857 Vali Acc: 0.255 Test Loss: 1.857 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.24081325531006
Epoch: 7, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.742 Vali Acc: 0.255 Test Loss: 1.742 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.997694969177246
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.748 Vali Acc: 0.259 Test Loss: 1.748 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 30.176875352859497
Epoch: 9, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.766 Vali Acc: 0.270 Test Loss: 1.766 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269944).  Saving model ...
Epoch: 10 cost time: 22.018503665924072
Epoch: 10, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.696 Vali Acc: 0.262 Test Loss: 1.696 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.654844284057617
Epoch: 11, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.691 Vali Acc: 0.243 Test Loss: 1.691 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 30.914287090301514
Epoch: 12, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.776 Vali Acc: 0.251 Test Loss: 1.776 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 30.95664620399475
Epoch: 13, Steps: 17 | Train Loss: 1.166 Vali Loss: 2.071 Vali Acc: 0.270 Test Loss: 2.071 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 28.601536989212036
Epoch: 14, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.049 Vali Acc: 0.278 Test Loss: 2.049 Test Acc: 0.278
Validation loss decreased (-0.269944 --> -0.277546).  Saving model ...
Epoch: 15 cost time: 30.943233966827393
Epoch: 15, Steps: 17 | Train Loss: 1.008 Vali Loss: 2.002 Vali Acc: 0.262 Test Loss: 2.002 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.897550344467163
Epoch: 16, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.043 Vali Acc: 0.228 Test Loss: 2.043 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 28.42588758468628
Epoch: 17, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.512 Vali Acc: 0.278 Test Loss: 2.512 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 29.73293924331665
Epoch: 18, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.441 Vali Acc: 0.278 Test Loss: 2.441 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 29.745577335357666
Epoch: 19, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.500 Vali Acc: 0.262 Test Loss: 2.500 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 27.321433067321777
Epoch: 20, Steps: 17 | Train Loss: 0.671 Vali Loss: 2.871 Vali Acc: 0.270 Test Loss: 2.871 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 29.774032592773438
Epoch: 21, Steps: 17 | Train Loss: 0.663 Vali Loss: 3.443 Vali Acc: 0.255 Test Loss: 3.443 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 29.459327459335327
Epoch: 22, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.555 Vali Acc: 0.240 Test Loss: 2.555 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 29.14893364906311
Epoch: 23, Steps: 17 | Train Loss: 0.655 Vali Loss: 3.070 Vali Acc: 0.209 Test Loss: 3.070 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 30.948214054107666
Epoch: 24, Steps: 17 | Train Loss: 0.492 Vali Loss: 3.112 Vali Acc: 0.262 Test Loss: 3.112 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 7256228
model size : 28.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.821562051773071
Epoch: 1, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.521 Vali Acc: 0.209 Test Loss: 1.521 Test Acc: 0.209
Validation loss decreased (inf --> -0.209110).  Saving model ...
Epoch: 2 cost time: 14.468429803848267
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.738 Vali Acc: 0.266 Test Loss: 1.738 Test Acc: 0.266
Validation loss decreased (-0.209110 --> -0.266142).  Saving model ...
Epoch: 3 cost time: 14.432400703430176
Epoch: 3, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.619 Vali Acc: 0.270 Test Loss: 1.619 Test Acc: 0.270
Validation loss decreased (-0.266142 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 14.460494041442871
Epoch: 4, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.584 Vali Acc: 0.228 Test Loss: 1.584 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.447384595870972
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.568 Vali Acc: 0.262 Test Loss: 1.568 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.59274697303772
Epoch: 6, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.755 Vali Acc: 0.262 Test Loss: 1.755 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.380624771118164
Epoch: 7, Steps: 17 | Train Loss: 1.498 Vali Loss: 2.037 Vali Acc: 0.236 Test Loss: 2.037 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.456727504730225
Epoch: 8, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.452043771743774
Epoch: 9, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.688 Vali Acc: 0.293 Test Loss: 1.688 Test Acc: 0.293
Validation loss decreased (-0.269946 --> -0.292759).  Saving model ...
Epoch: 10 cost time: 14.429685115814209
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.940 Vali Acc: 0.247 Test Loss: 1.940 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.809058427810669
Epoch: 11, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.73521637916565
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 2.069 Vali Acc: 0.281 Test Loss: 2.069 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.829749584197998
Epoch: 13, Steps: 17 | Train Loss: 1.223 Vali Loss: 2.010 Vali Acc: 0.255 Test Loss: 2.010 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.873605489730835
Epoch: 14, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.853 Vali Acc: 0.247 Test Loss: 1.853 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.906644344329834
Epoch: 15, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.301 Vali Acc: 0.262 Test Loss: 2.301 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.921091079711914
Epoch: 16, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.944 Vali Acc: 0.232 Test Loss: 1.944 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.89559555053711
Epoch: 17, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.332 Vali Acc: 0.259 Test Loss: 2.332 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 12.556722402572632
Epoch: 18, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.172 Vali Acc: 0.236 Test Loss: 2.172 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 13.72420334815979
Epoch: 19, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.279 Vali Acc: 0.262 Test Loss: 2.279 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 2290916
model size : 9.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 40.91639280319214
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 37.59350800514221
Epoch: 2, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.644 Vali Acc: 0.243 Test Loss: 1.644 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 42.410808086395264
Epoch: 3, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.568 Vali Acc: 0.240 Test Loss: 1.568 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 42.365856885910034
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.481 Vali Acc: 0.297 Test Loss: 1.481 Test Acc: 0.297
Validation loss decreased (-0.254738 --> -0.296563).  Saving model ...
Epoch: 5 cost time: 40.28079295158386
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 42.32288599014282
Epoch: 6, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 41.41474270820618
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.682 Vali Acc: 0.278 Test Loss: 1.682 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 38.19158864021301
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.656 Vali Acc: 0.255 Test Loss: 1.656 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 40.54008173942566
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.785 Vali Acc: 0.236 Test Loss: 1.785 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 40.60687804222107
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.699 Vali Acc: 0.289 Test Loss: 1.699 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 37.84117364883423
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.596 Vali Acc: 0.266 Test Loss: 1.596 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 42.2601273059845
Epoch: 12, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 42.218409061431885
Epoch: 13, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.824 Vali Acc: 0.243 Test Loss: 1.824 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 39.14850902557373
Epoch: 14, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.551 Vali Acc: 0.266 Test Loss: 1.551 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3740708
model size : 14.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.498719692230225
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.608 Vali Acc: 0.274 Test Loss: 1.608 Test Acc: 0.274
Validation loss decreased (inf --> -0.273748).  Saving model ...
Epoch: 2 cost time: 18.942920684814453
Epoch: 2, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.572 Vali Acc: 0.262 Test Loss: 1.572 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.006145477294922
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.738 Vali Acc: 0.289 Test Loss: 1.738 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 18.306797742843628
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.831 Vali Acc: 0.240 Test Loss: 1.831 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.667921781539917
Epoch: 5, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.14284348487854
Epoch: 6, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 18.217177629470825
Epoch: 7, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.671 Vali Acc: 0.262 Test Loss: 1.671 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.52352809906006
Epoch: 8, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.815 Vali Acc: 0.228 Test Loss: 1.815 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 18.537657022476196
Epoch: 9, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.828 Vali Acc: 0.243 Test Loss: 1.828 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.29999327659607
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 2.203 Vali Acc: 0.247 Test Loss: 2.203 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.126139163970947
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.921 Vali Acc: 0.281 Test Loss: 1.921 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 18.62779402732849
Epoch: 12, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.998 Vali Acc: 0.255 Test Loss: 1.998 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 18.59259271621704
Epoch: 13, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.154 Vali Acc: 0.236 Test Loss: 2.154 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1257956
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 33.77068614959717
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 30.37187170982361
Epoch: 2, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.644 Vali Acc: 0.243 Test Loss: 1.644 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.398679494857788
Epoch: 3, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.568 Vali Acc: 0.240 Test Loss: 1.568 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.9793438911438
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.481 Vali Acc: 0.297 Test Loss: 1.481 Test Acc: 0.297
Validation loss decreased (-0.254738 --> -0.296563).  Saving model ...
Epoch: 5 cost time: 32.16095781326294
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.02880835533142
Epoch: 6, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 32.397648096084595
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.682 Vali Acc: 0.278 Test Loss: 1.682 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 31.406646251678467
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.656 Vali Acc: 0.255 Test Loss: 1.656 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 31.403979063034058
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.785 Vali Acc: 0.236 Test Loss: 1.785 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 28.78091549873352
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.699 Vali Acc: 0.289 Test Loss: 1.699 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 31.208409309387207
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.596 Vali Acc: 0.266 Test Loss: 1.596 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 31.571190357208252
Epoch: 12, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 31.359800338745117
Epoch: 13, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.824 Vali Acc: 0.243 Test Loss: 1.824 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 30.321762084960938
Epoch: 14, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.551 Vali Acc: 0.266 Test Loss: 1.551 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3740708
model size : 14.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 16.10515022277832
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.608 Vali Acc: 0.274 Test Loss: 1.608 Test Acc: 0.274
Validation loss decreased (inf --> -0.273748).  Saving model ...
Epoch: 2 cost time: 14.601930141448975
Epoch: 2, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.572 Vali Acc: 0.262 Test Loss: 1.572 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.426620960235596
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.738 Vali Acc: 0.289 Test Loss: 1.738 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 14.550055980682373
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.831 Vali Acc: 0.240 Test Loss: 1.831 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.018097400665283
Epoch: 5, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.431413888931274
Epoch: 6, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.927446365356445
Epoch: 7, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.671 Vali Acc: 0.262 Test Loss: 1.671 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.437506437301636
Epoch: 8, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.815 Vali Acc: 0.228 Test Loss: 1.815 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.639509916305542
Epoch: 9, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.828 Vali Acc: 0.243 Test Loss: 1.828 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.675457954406738
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 2.203 Vali Acc: 0.247 Test Loss: 2.203 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 14.76953411102295
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.921 Vali Acc: 0.281 Test Loss: 1.921 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 14.38357663154602
Epoch: 12, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.998 Vali Acc: 0.255 Test Loss: 1.998 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.404290676116943
Epoch: 13, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.154 Vali Acc: 0.236 Test Loss: 2.154 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1257956
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.453553438186646
Epoch: 1, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 19.705116510391235
Epoch: 2, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.644 Vali Acc: 0.243 Test Loss: 1.644 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.421218872070312
Epoch: 3, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.568 Vali Acc: 0.240 Test Loss: 1.568 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.42742943763733
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.481 Vali Acc: 0.297 Test Loss: 1.481 Test Acc: 0.297
Validation loss decreased (-0.254738 --> -0.296563).  Saving model ...
Epoch: 5 cost time: 19.50395655632019
Epoch: 5, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.727 Vali Acc: 0.278 Test Loss: 1.727 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.18790030479431
Epoch: 6, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.491 Vali Acc: 0.247 Test Loss: 1.491 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.770349740982056
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.682 Vali Acc: 0.278 Test Loss: 1.682 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.45629119873047
Epoch: 8, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.656 Vali Acc: 0.255 Test Loss: 1.656 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.55704355239868
Epoch: 9, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.785 Vali Acc: 0.236 Test Loss: 1.785 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 20.505395650863647
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.699 Vali Acc: 0.289 Test Loss: 1.699 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.72490406036377
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.596 Vali Acc: 0.266 Test Loss: 1.596 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 19.16727590560913
Epoch: 12, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 20.392295598983765
Epoch: 13, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.824 Vali Acc: 0.243 Test Loss: 1.824 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 20.334802627563477
Epoch: 14, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.551 Vali Acc: 0.266 Test Loss: 1.551 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3740708
model size : 14.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.110595941543579
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.608 Vali Acc: 0.274 Test Loss: 1.608 Test Acc: 0.274
Validation loss decreased (inf --> -0.273748).  Saving model ...
Epoch: 2 cost time: 9.638558864593506
Epoch: 2, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.572 Vali Acc: 0.262 Test Loss: 1.572 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.651145458221436
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.738 Vali Acc: 0.289 Test Loss: 1.738 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288956).  Saving model ...
Epoch: 4 cost time: 9.023008584976196
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.831 Vali Acc: 0.240 Test Loss: 1.831 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.974810600280762
Epoch: 5, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.485 Vali Acc: 0.259 Test Loss: 1.485 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.68291425704956
Epoch: 6, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.264193773269653
Epoch: 7, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.671 Vali Acc: 0.262 Test Loss: 1.671 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.282151460647583
Epoch: 8, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.815 Vali Acc: 0.228 Test Loss: 1.815 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.329882383346558
Epoch: 9, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.828 Vali Acc: 0.243 Test Loss: 1.828 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.313612461090088
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 2.203 Vali Acc: 0.247 Test Loss: 2.203 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.323620796203613
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.921 Vali Acc: 0.281 Test Loss: 1.921 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.358084917068481
Epoch: 12, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.998 Vali Acc: 0.255 Test Loss: 1.998 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.341025114059448
Epoch: 13, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.154 Vali Acc: 0.236 Test Loss: 2.154 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1257956
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 26.551047801971436
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.555 Vali Acc: 0.251 Test Loss: 1.555 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 27.173277139663696
Epoch: 2, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.797 Vali Acc: 0.262 Test Loss: 1.797 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262339).  Saving model ...
Epoch: 3 cost time: 27.24432396888733
Epoch: 3, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.796 Vali Acc: 0.255 Test Loss: 1.796 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.990933656692505
Epoch: 4, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.731 Vali Acc: 0.228 Test Loss: 1.731 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.18781566619873
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.655 Vali Acc: 0.247 Test Loss: 1.655 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.634286165237427
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.829 Vali Acc: 0.247 Test Loss: 1.829 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 28.48971676826477
Epoch: 7, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.761 Vali Acc: 0.285 Test Loss: 1.761 Test Acc: 0.285
Validation loss decreased (-0.262339 --> -0.285153).  Saving model ...
Epoch: 8 cost time: 28.465340852737427
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.662 Vali Acc: 0.281 Test Loss: 1.662 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.207457542419434
Epoch: 9, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.641 Vali Acc: 0.255 Test Loss: 1.641 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.00684428215027
Epoch: 10, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.840 Vali Acc: 0.274 Test Loss: 1.840 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 28.343494653701782
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.635 Vali Acc: 0.259 Test Loss: 1.635 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 27.71651339530945
Epoch: 12, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 27.285924673080444
Epoch: 13, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.847 Vali Acc: 0.247 Test Loss: 1.847 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.935924291610718
Epoch: 14, Steps: 17 | Train Loss: 1.341 Vali Loss: 2.261 Vali Acc: 0.251 Test Loss: 2.261 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 27.052560329437256
Epoch: 15, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.156 Vali Acc: 0.232 Test Loss: 2.156 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 27.198096752166748
Epoch: 16, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.175 Vali Acc: 0.266 Test Loss: 2.175 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 27.239389419555664
Epoch: 17, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.007 Vali Acc: 0.262 Test Loss: 2.007 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1982948
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.966192960739136
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 13.32249116897583
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.492 Vali Acc: 0.289 Test Loss: 1.492 Test Acc: 0.289
Validation loss decreased (-0.239530 --> -0.288958).  Saving model ...
Epoch: 3 cost time: 13.333994150161743
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.791 Vali Acc: 0.270 Test Loss: 1.791 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.357595682144165
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.908 Vali Acc: 0.255 Test Loss: 1.908 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.335760831832886
Epoch: 5, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.657 Vali Acc: 0.289 Test Loss: 1.657 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.386268138885498
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.833 Vali Acc: 0.289 Test Loss: 1.833 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.348443031311035
Epoch: 7, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.006 Vali Acc: 0.262 Test Loss: 2.006 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.957441568374634
Epoch: 8, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.789 Vali Acc: 0.289 Test Loss: 1.789 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.298155784606934
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.751 Vali Acc: 0.266 Test Loss: 1.751 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.079204559326172
Epoch: 10, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.659 Vali Acc: 0.281 Test Loss: 1.659 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 13.290558815002441
Epoch: 11, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.811 Vali Acc: 0.278 Test Loss: 1.811 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.329599618911743
Epoch: 12, Steps: 17 | Train Loss: 1.247 Vali Loss: 2.158 Vali Acc: 0.232 Test Loss: 2.158 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 741476
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 22.55280566215515
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.555 Vali Acc: 0.251 Test Loss: 1.555 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 20.767919301986694
Epoch: 2, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.797 Vali Acc: 0.262 Test Loss: 1.797 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262339).  Saving model ...
Epoch: 3 cost time: 18.5671443939209
Epoch: 3, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.796 Vali Acc: 0.255 Test Loss: 1.796 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.12683939933777
Epoch: 4, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.731 Vali Acc: 0.228 Test Loss: 1.731 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.18117094039917
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.655 Vali Acc: 0.247 Test Loss: 1.655 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 20.491976261138916
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.829 Vali Acc: 0.247 Test Loss: 1.829 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.720176219940186
Epoch: 7, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.761 Vali Acc: 0.285 Test Loss: 1.761 Test Acc: 0.285
Validation loss decreased (-0.262339 --> -0.285153).  Saving model ...
Epoch: 8 cost time: 20.490188598632812
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.662 Vali Acc: 0.281 Test Loss: 1.662 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.732558250427246
Epoch: 9, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.641 Vali Acc: 0.255 Test Loss: 1.641 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.239675283432007
Epoch: 10, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.840 Vali Acc: 0.274 Test Loss: 1.840 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.722250938415527
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.635 Vali Acc: 0.259 Test Loss: 1.635 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 21.615295886993408
Epoch: 12, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.21409559249878
Epoch: 13, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.847 Vali Acc: 0.247 Test Loss: 1.847 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.792457103729248
Epoch: 14, Steps: 17 | Train Loss: 1.342 Vali Loss: 2.261 Vali Acc: 0.251 Test Loss: 2.261 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 19.757981300354004
Epoch: 15, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.156 Vali Acc: 0.232 Test Loss: 2.156 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 21.36924934387207
Epoch: 16, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.175 Vali Acc: 0.266 Test Loss: 2.175 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 21.434807777404785
Epoch: 17, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.007 Vali Acc: 0.262 Test Loss: 2.007 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1982948
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.436639308929443
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 10.006670951843262
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.492 Vali Acc: 0.289 Test Loss: 1.492 Test Acc: 0.289
Validation loss decreased (-0.239530 --> -0.288958).  Saving model ...
Epoch: 3 cost time: 9.856345653533936
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.791 Vali Acc: 0.270 Test Loss: 1.791 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.314913749694824
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.908 Vali Acc: 0.255 Test Loss: 1.908 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.512505054473877
Epoch: 5, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.657 Vali Acc: 0.289 Test Loss: 1.657 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.047004222869873
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.833 Vali Acc: 0.289 Test Loss: 1.833 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.054434061050415
Epoch: 7, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.006 Vali Acc: 0.262 Test Loss: 2.006 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.625081777572632
Epoch: 8, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.789 Vali Acc: 0.289 Test Loss: 1.789 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.621595859527588
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.751 Vali Acc: 0.266 Test Loss: 1.751 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.706033945083618
Epoch: 10, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.659 Vali Acc: 0.281 Test Loss: 1.659 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.590338468551636
Epoch: 11, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.811 Vali Acc: 0.278 Test Loss: 1.811 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.622049331665039
Epoch: 12, Steps: 17 | Train Loss: 1.247 Vali Loss: 2.158 Vali Acc: 0.232 Test Loss: 2.158 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 741476
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.903525829315186
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.555 Vali Acc: 0.251 Test Loss: 1.555 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 11.805999040603638
Epoch: 2, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.797 Vali Acc: 0.262 Test Loss: 1.797 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262339).  Saving model ...
Epoch: 3 cost time: 12.895608186721802
Epoch: 3, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.796 Vali Acc: 0.255 Test Loss: 1.796 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.276593208312988
Epoch: 4, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.731 Vali Acc: 0.228 Test Loss: 1.731 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.221955060958862
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.655 Vali Acc: 0.247 Test Loss: 1.655 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.394020557403564
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.829 Vali Acc: 0.247 Test Loss: 1.829 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.29123830795288
Epoch: 7, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.761 Vali Acc: 0.285 Test Loss: 1.761 Test Acc: 0.285
Validation loss decreased (-0.262339 --> -0.285153).  Saving model ...
Epoch: 8 cost time: 13.866188287734985
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.662 Vali Acc: 0.281 Test Loss: 1.662 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.219501972198486
Epoch: 9, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.641 Vali Acc: 0.255 Test Loss: 1.641 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.909672498703003
Epoch: 10, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.840 Vali Acc: 0.274 Test Loss: 1.840 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.60504412651062
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.635 Vali Acc: 0.259 Test Loss: 1.635 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.953963994979858
Epoch: 12, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.02979826927185
Epoch: 13, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.847 Vali Acc: 0.247 Test Loss: 1.847 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.031465291976929
Epoch: 14, Steps: 17 | Train Loss: 1.342 Vali Loss: 2.261 Vali Acc: 0.251 Test Loss: 2.261 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.905807256698608
Epoch: 15, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.156 Vali Acc: 0.232 Test Loss: 2.156 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.955908298492432
Epoch: 16, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.175 Vali Acc: 0.266 Test Loss: 2.175 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.473268985748291
Epoch: 17, Steps: 17 | Train Loss: 1.059 Vali Loss: 2.007 Vali Acc: 0.262 Test Loss: 2.007 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1982948
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.870622634887695
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 6.988430976867676
Epoch: 2, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.492 Vali Acc: 0.289 Test Loss: 1.492 Test Acc: 0.289
Validation loss decreased (-0.239530 --> -0.288958).  Saving model ...
Epoch: 3 cost time: 6.995001792907715
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.791 Vali Acc: 0.270 Test Loss: 1.791 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.977582693099976
Epoch: 4, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.908 Vali Acc: 0.255 Test Loss: 1.908 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.9671196937561035
Epoch: 5, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.657 Vali Acc: 0.289 Test Loss: 1.657 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.985334634780884
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.833 Vali Acc: 0.289 Test Loss: 1.833 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.954160690307617
Epoch: 7, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.006 Vali Acc: 0.262 Test Loss: 2.006 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.001824378967285
Epoch: 8, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.789 Vali Acc: 0.289 Test Loss: 1.789 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.979969024658203
Epoch: 9, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.751 Vali Acc: 0.266 Test Loss: 1.751 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.715015649795532
Epoch: 10, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.659 Vali Acc: 0.281 Test Loss: 1.659 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.756130933761597
Epoch: 11, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.811 Vali Acc: 0.278 Test Loss: 1.811 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.692724943161011
Epoch: 12, Steps: 17 | Train Loss: 1.247 Vali Loss: 2.158 Vali Acc: 0.232 Test Loss: 2.158 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 741476
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 33.55954551696777
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 33.688652992248535
Epoch: 2, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.658 Vali Acc: 0.259 Test Loss: 1.658 Test Acc: 0.259
Validation loss decreased (-0.250934 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 34.13977599143982
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
Validation loss decreased (-0.258539 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 31.346391201019287
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.584 Vali Acc: 0.259 Test Loss: 1.584 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.072692155838013
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.597 Vali Acc: 0.270 Test Loss: 1.597 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.213767290115356
Epoch: 6, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.530 Vali Acc: 0.285 Test Loss: 1.530 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.090165376663208
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.649 Vali Acc: 0.243 Test Loss: 1.649 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 33.42351508140564
Epoch: 8, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.593 Vali Acc: 0.255 Test Loss: 1.593 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 31.878084897994995
Epoch: 9, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 32.905012369155884
Epoch: 10, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.557 Vali Acc: 0.259 Test Loss: 1.557 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 32.10871863365173
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.633 Vali Acc: 0.266 Test Loss: 1.633 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 30.35391592979431
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.841 Vali Acc: 0.285 Test Loss: 1.841 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 31.720266819000244
Epoch: 13, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1870932
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.796238899230957
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 13.96708631515503
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.593 Vali Acc: 0.259 Test Loss: 1.593 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 13.998010873794556
Epoch: 3, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.532438278198242
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.490 Vali Acc: 0.247 Test Loss: 1.490 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.95429539680481
Epoch: 5, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.545 Vali Acc: 0.236 Test Loss: 1.545 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.617547035217285
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.548 Vali Acc: 0.262 Test Loss: 1.548 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 14.74876070022583
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.927 Vali Acc: 0.243 Test Loss: 1.927 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.396928548812866
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.586 Vali Acc: 0.289 Test Loss: 1.586 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 14.793110132217407
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.77209758758545
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.751 Vali Acc: 0.319 Test Loss: 1.751 Test Acc: 0.319
Validation loss decreased (-0.288958 --> -0.319374).  Saving model ...
Epoch: 11 cost time: 14.779813528060913
Epoch: 11, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.600 Vali Acc: 0.289 Test Loss: 1.600 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.447283267974854
Epoch: 12, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.660 Vali Acc: 0.232 Test Loss: 1.660 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.780370473861694
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.894001722335815
Epoch: 14, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.713 Vali Acc: 0.255 Test Loss: 1.713 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.454465627670288
Epoch: 15, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.616 Vali Acc: 0.255 Test Loss: 1.616 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.375697374343872
Epoch: 16, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.705 Vali Acc: 0.228 Test Loss: 1.705 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.682984352111816
Epoch: 17, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.739 Vali Acc: 0.297 Test Loss: 1.739 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.61036491394043
Epoch: 18, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.766 Vali Acc: 0.312 Test Loss: 1.766 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.077840089797974
Epoch: 19, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.915 Vali Acc: 0.278 Test Loss: 1.915 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.922147035598755
Epoch: 20, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.848 Vali Acc: 0.308 Test Loss: 1.848 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 629364
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.182150840759277
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 20.942824125289917
Epoch: 2, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.658 Vali Acc: 0.259 Test Loss: 1.658 Test Acc: 0.259
Validation loss decreased (-0.250934 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 22.65349507331848
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
Validation loss decreased (-0.258539 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 21.222253799438477
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.584 Vali Acc: 0.259 Test Loss: 1.584 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.61563777923584
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.597 Vali Acc: 0.270 Test Loss: 1.597 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.454951524734497
Epoch: 6, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.530 Vali Acc: 0.285 Test Loss: 1.530 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.49215292930603
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.649 Vali Acc: 0.243 Test Loss: 1.649 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.95369267463684
Epoch: 8, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.593 Vali Acc: 0.255 Test Loss: 1.593 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.06734585762024
Epoch: 9, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.062077283859253
Epoch: 10, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.557 Vali Acc: 0.259 Test Loss: 1.557 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.18408751487732
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.633 Vali Acc: 0.266 Test Loss: 1.633 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.127031326293945
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.841 Vali Acc: 0.285 Test Loss: 1.841 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 24.391666650772095
Epoch: 13, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1870932
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.53244400024414
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 10.79292345046997
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.593 Vali Acc: 0.259 Test Loss: 1.593 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 10.682428121566772
Epoch: 3, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.741450071334839
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.490 Vali Acc: 0.247 Test Loss: 1.490 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.639222145080566
Epoch: 5, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.545 Vali Acc: 0.236 Test Loss: 1.545 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.56696891784668
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.548 Vali Acc: 0.262 Test Loss: 1.548 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 10.604078531265259
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.927 Vali Acc: 0.243 Test Loss: 1.927 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.439730167388916
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.586 Vali Acc: 0.289 Test Loss: 1.586 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 10.111283779144287
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.534746646881104
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.751 Vali Acc: 0.319 Test Loss: 1.751 Test Acc: 0.319
Validation loss decreased (-0.288958 --> -0.319374).  Saving model ...
Epoch: 11 cost time: 9.179209232330322
Epoch: 11, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.600 Vali Acc: 0.289 Test Loss: 1.600 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.107280969619751
Epoch: 12, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.660 Vali Acc: 0.232 Test Loss: 1.660 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.149305582046509
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.231822967529297
Epoch: 14, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.713 Vali Acc: 0.255 Test Loss: 1.713 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.332550764083862
Epoch: 15, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.616 Vali Acc: 0.255 Test Loss: 1.616 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.604245901107788
Epoch: 16, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.705 Vali Acc: 0.228 Test Loss: 1.705 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.785760879516602
Epoch: 17, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.739 Vali Acc: 0.297 Test Loss: 1.739 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.672452926635742
Epoch: 18, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.766 Vali Acc: 0.312 Test Loss: 1.766 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 12.64793586730957
Epoch: 19, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.915 Vali Acc: 0.278 Test Loss: 1.915 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.723545551300049
Epoch: 20, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.848 Vali Acc: 0.308 Test Loss: 1.848 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 629364
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.01803755760193
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 17.604994297027588
Epoch: 2, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.658 Vali Acc: 0.259 Test Loss: 1.658 Test Acc: 0.259
Validation loss decreased (-0.250934 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 17.47254991531372
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
Validation loss decreased (-0.258539 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 17.526405811309814
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.584 Vali Acc: 0.259 Test Loss: 1.584 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.53989601135254
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.597 Vali Acc: 0.270 Test Loss: 1.597 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.547647953033447
Epoch: 6, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.530 Vali Acc: 0.285 Test Loss: 1.530 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.126784563064575
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.649 Vali Acc: 0.243 Test Loss: 1.649 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.785223722457886
Epoch: 8, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.593 Vali Acc: 0.255 Test Loss: 1.593 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.126943588256836
Epoch: 9, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.947795391082764
Epoch: 10, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.557 Vali Acc: 0.259 Test Loss: 1.557 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.91994023323059
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.633 Vali Acc: 0.266 Test Loss: 1.633 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.867549419403076
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.841 Vali Acc: 0.285 Test Loss: 1.841 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.9162175655365
Epoch: 13, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 1870932
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.49734091758728
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.549 Vali Acc: 0.247 Test Loss: 1.549 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 8.070269107818604
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.593 Vali Acc: 0.259 Test Loss: 1.593 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 8.039430379867554
Epoch: 3, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.091998815536499
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.490 Vali Acc: 0.247 Test Loss: 1.490 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.115825414657593
Epoch: 5, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.545 Vali Acc: 0.236 Test Loss: 1.545 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.040274858474731
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.548 Vali Acc: 0.262 Test Loss: 1.548 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262342).  Saving model ...
Epoch: 7 cost time: 8.09588623046875
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.927 Vali Acc: 0.243 Test Loss: 1.927 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.06883978843689
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.586 Vali Acc: 0.289 Test Loss: 1.586 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288958).  Saving model ...
Epoch: 9 cost time: 7.428080797195435
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.271833181381226
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.751 Vali Acc: 0.319 Test Loss: 1.751 Test Acc: 0.319
Validation loss decreased (-0.288958 --> -0.319374).  Saving model ...
Epoch: 11 cost time: 8.246018171310425
Epoch: 11, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.600 Vali Acc: 0.289 Test Loss: 1.600 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.307453155517578
Epoch: 12, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.660 Vali Acc: 0.232 Test Loss: 1.660 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.255100965499878
Epoch: 13, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.227156639099121
Epoch: 14, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.713 Vali Acc: 0.255 Test Loss: 1.713 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.288486242294312
Epoch: 15, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.616 Vali Acc: 0.255 Test Loss: 1.616 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.264283895492554
Epoch: 16, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.705 Vali Acc: 0.228 Test Loss: 1.705 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.27532696723938
Epoch: 17, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.739 Vali Acc: 0.297 Test Loss: 1.739 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.921294689178467
Epoch: 18, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.766 Vali Acc: 0.312 Test Loss: 1.766 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.556291341781616
Epoch: 19, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.915 Vali Acc: 0.278 Test Loss: 1.915 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.096720695495605
Epoch: 20, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.848 Vali Acc: 0.308 Test Loss: 1.848 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 629364
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 23.927669763565063
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.403 Vali Acc: 0.266 Test Loss: 1.403 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 22.560709953308105
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.443 Vali Acc: 0.251 Test Loss: 1.443 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.08703303337097
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.614 Vali Acc: 0.251 Test Loss: 1.614 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.130022287368774
Epoch: 4, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.909 Vali Acc: 0.251 Test Loss: 1.909 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 23.29942512512207
Epoch: 5, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.403648614883423
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.468 Vali Acc: 0.316 Test Loss: 1.468 Test Acc: 0.316
Validation loss decreased (-0.266146 --> -0.315575).  Saving model ...
Epoch: 7 cost time: 23.4740207195282
Epoch: 7, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.781 Vali Acc: 0.255 Test Loss: 1.781 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.704612970352173
Epoch: 8, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.577 Vali Acc: 0.236 Test Loss: 1.577 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.617879152297974
Epoch: 9, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.639 Vali Acc: 0.221 Test Loss: 1.639 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.588133811950684
Epoch: 10, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.638708353042603
Epoch: 11, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.549 Vali Acc: 0.266 Test Loss: 1.549 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.911364793777466
Epoch: 12, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.741 Vali Acc: 0.232 Test Loss: 1.741 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 21.485870122909546
Epoch: 13, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.672 Vali Acc: 0.304 Test Loss: 1.672 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.53519296646118
Epoch: 14, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.559 Vali Acc: 0.262 Test Loss: 1.559 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 22.6376953125
Epoch: 15, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.671 Vali Acc: 0.255 Test Loss: 1.671 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.796314477920532
Epoch: 16, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.643 Vali Acc: 0.240 Test Loss: 1.643 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 991764
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.736740112304688
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.444 Vali Acc: 0.251 Test Loss: 1.444 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 11.099750518798828
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.548 Vali Acc: 0.228 Test Loss: 1.548 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.138985395431519
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.727 Vali Acc: 0.243 Test Loss: 1.727 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.139090538024902
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.445 Vali Acc: 0.224 Test Loss: 1.445 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.12171483039856
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.596 Vali Acc: 0.289 Test Loss: 1.596 Test Acc: 0.289
Validation loss decreased (-0.250936 --> -0.288957).  Saving model ...
Epoch: 6 cost time: 11.095486164093018
Epoch: 6, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.617 Vali Acc: 0.285 Test Loss: 1.617 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.122877836227417
Epoch: 7, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.198874711990356
Epoch: 8, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.682 Vali Acc: 0.255 Test Loss: 1.682 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.253276586532593
Epoch: 9, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.485 Vali Acc: 0.270 Test Loss: 1.485 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.997706890106201
Epoch: 10, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.111513376235962
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.685 Vali Acc: 0.228 Test Loss: 1.685 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.044503211975098
Epoch: 12, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.092503786087036
Epoch: 13, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.595 Vali Acc: 0.300 Test Loss: 1.595 Test Acc: 0.300
Validation loss decreased (-0.288957 --> -0.300364).  Saving model ...
Epoch: 14 cost time: 11.166589498519897
Epoch: 14, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.627 Vali Acc: 0.308 Test Loss: 1.627 Test Acc: 0.308
Validation loss decreased (-0.300364 --> -0.307969).  Saving model ...
Epoch: 15 cost time: 11.030337810516357
Epoch: 15, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.744 Vali Acc: 0.240 Test Loss: 1.744 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.637646198272705
Epoch: 16, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.798 Vali Acc: 0.266 Test Loss: 1.798 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.629263877868652
Epoch: 17, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.574465990066528
Epoch: 18, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.958 Vali Acc: 0.270 Test Loss: 1.958 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.45485806465149
Epoch: 19, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.767 Vali Acc: 0.232 Test Loss: 1.767 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.042070865631104
Epoch: 20, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.839 Vali Acc: 0.236 Test Loss: 1.839 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.730147123336792
Epoch: 21, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.965 Vali Acc: 0.259 Test Loss: 1.965 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.773329019546509
Epoch: 22, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.052 Vali Acc: 0.243 Test Loss: 2.052 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.888404846191406
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.175 Vali Acc: 0.247 Test Loss: 2.175 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.67891788482666
Epoch: 24, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.278 Vali Acc: 0.251 Test Loss: 2.278 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 370932
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.26521587371826
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.403 Vali Acc: 0.266 Test Loss: 1.403 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 16.902550220489502
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.443 Vali Acc: 0.251 Test Loss: 1.443 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.7095685005188
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.614 Vali Acc: 0.251 Test Loss: 1.614 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.720826864242554
Epoch: 4, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.909 Vali Acc: 0.251 Test Loss: 1.909 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.930535793304443
Epoch: 5, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.39709782600403
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.468 Vali Acc: 0.316 Test Loss: 1.468 Test Acc: 0.316
Validation loss decreased (-0.266146 --> -0.315575).  Saving model ...
Epoch: 7 cost time: 17.309945344924927
Epoch: 7, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.781 Vali Acc: 0.255 Test Loss: 1.781 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.48991298675537
Epoch: 8, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.577 Vali Acc: 0.236 Test Loss: 1.577 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.418330192565918
Epoch: 9, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.639 Vali Acc: 0.221 Test Loss: 1.639 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.562374114990234
Epoch: 10, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.621719360351562
Epoch: 11, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.549 Vali Acc: 0.266 Test Loss: 1.549 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.642097234725952
Epoch: 12, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.741 Vali Acc: 0.232 Test Loss: 1.741 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.652108907699585
Epoch: 13, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.672 Vali Acc: 0.304 Test Loss: 1.672 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.536659240722656
Epoch: 14, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.559 Vali Acc: 0.262 Test Loss: 1.559 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.759321689605713
Epoch: 15, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.671 Vali Acc: 0.255 Test Loss: 1.671 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.537529945373535
Epoch: 16, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.643 Vali Acc: 0.240 Test Loss: 1.643 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 991764
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.876031637191772
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.444 Vali Acc: 0.251 Test Loss: 1.444 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 8.325398445129395
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.548 Vali Acc: 0.228 Test Loss: 1.548 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.342718601226807
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.727 Vali Acc: 0.243 Test Loss: 1.727 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.248637676239014
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.445 Vali Acc: 0.224 Test Loss: 1.445 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.042837381362915
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.596 Vali Acc: 0.289 Test Loss: 1.596 Test Acc: 0.289
Validation loss decreased (-0.250936 --> -0.288957).  Saving model ...
Epoch: 6 cost time: 8.092412948608398
Epoch: 6, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.616 Vali Acc: 0.285 Test Loss: 1.616 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.116073369979858
Epoch: 7, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.145708322525024
Epoch: 8, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.682 Vali Acc: 0.255 Test Loss: 1.682 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.084290266036987
Epoch: 9, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.485 Vali Acc: 0.270 Test Loss: 1.485 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.169342994689941
Epoch: 10, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.176176309585571
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.685 Vali Acc: 0.228 Test Loss: 1.685 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.141976833343506
Epoch: 12, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.211038589477539
Epoch: 13, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.595 Vali Acc: 0.300 Test Loss: 1.595 Test Acc: 0.300
Validation loss decreased (-0.288957 --> -0.300364).  Saving model ...
Epoch: 14 cost time: 8.19883918762207
Epoch: 14, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.627 Vali Acc: 0.308 Test Loss: 1.627 Test Acc: 0.308
Validation loss decreased (-0.300364 --> -0.307969).  Saving model ...
Epoch: 15 cost time: 8.230136632919312
Epoch: 15, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.744 Vali Acc: 0.240 Test Loss: 1.744 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.214187860488892
Epoch: 16, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.798 Vali Acc: 0.266 Test Loss: 1.798 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.2445547580719
Epoch: 17, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.180123329162598
Epoch: 18, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.958 Vali Acc: 0.270 Test Loss: 1.958 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.918564558029175
Epoch: 19, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.767 Vali Acc: 0.232 Test Loss: 1.767 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.821050643920898
Epoch: 20, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.839 Vali Acc: 0.236 Test Loss: 1.839 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.90466046333313
Epoch: 21, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.965 Vali Acc: 0.259 Test Loss: 1.965 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.581545114517212
Epoch: 22, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.052 Vali Acc: 0.243 Test Loss: 2.052 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.0939621925354
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.175 Vali Acc: 0.247 Test Loss: 2.175 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.222855806350708
Epoch: 24, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.278 Vali Acc: 0.251 Test Loss: 2.278 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 370932
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.055978775024414
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.403 Vali Acc: 0.266 Test Loss: 1.403 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 11.492572546005249
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.443 Vali Acc: 0.251 Test Loss: 1.443 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.619346141815186
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.614 Vali Acc: 0.251 Test Loss: 1.614 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.595111608505249
Epoch: 4, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.909 Vali Acc: 0.251 Test Loss: 1.909 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.58626914024353
Epoch: 5, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.415 Vali Acc: 0.251 Test Loss: 1.415 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.659754514694214
Epoch: 6, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.468 Vali Acc: 0.316 Test Loss: 1.468 Test Acc: 0.316
Validation loss decreased (-0.266146 --> -0.315575).  Saving model ...
Epoch: 7 cost time: 11.612473726272583
Epoch: 7, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.781 Vali Acc: 0.255 Test Loss: 1.781 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.612834453582764
Epoch: 8, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.577 Vali Acc: 0.236 Test Loss: 1.577 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.635203838348389
Epoch: 9, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.639 Vali Acc: 0.221 Test Loss: 1.639 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.660775661468506
Epoch: 10, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.560138940811157
Epoch: 11, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.549 Vali Acc: 0.266 Test Loss: 1.549 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.555863618850708
Epoch: 12, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.741 Vali Acc: 0.232 Test Loss: 1.741 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.551042079925537
Epoch: 13, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.672 Vali Acc: 0.304 Test Loss: 1.672 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.628887176513672
Epoch: 14, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.559 Vali Acc: 0.262 Test Loss: 1.559 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.624412059783936
Epoch: 15, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.671 Vali Acc: 0.255 Test Loss: 1.671 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.675775527954102
Epoch: 16, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.643 Vali Acc: 0.240 Test Loss: 1.643 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 991764
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.196353197097778
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.444 Vali Acc: 0.251 Test Loss: 1.444 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 5.706431865692139
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.548 Vali Acc: 0.228 Test Loss: 1.548 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.516152620315552
Epoch: 3, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.727 Vali Acc: 0.243 Test Loss: 1.727 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.398749351501465
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.445 Vali Acc: 0.224 Test Loss: 1.445 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.367098331451416
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.596 Vali Acc: 0.289 Test Loss: 1.596 Test Acc: 0.289
Validation loss decreased (-0.250936 --> -0.288957).  Saving model ...
Epoch: 6 cost time: 5.346632719039917
Epoch: 6, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.617 Vali Acc: 0.285 Test Loss: 1.617 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.531744956970215
Epoch: 7, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.274349927902222
Epoch: 8, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.682 Vali Acc: 0.255 Test Loss: 1.682 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.480496168136597
Epoch: 9, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.485 Vali Acc: 0.270 Test Loss: 1.485 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.35873556137085
Epoch: 10, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.608 Vali Acc: 0.262 Test Loss: 1.608 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.2086687088012695
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.685 Vali Acc: 0.228 Test Loss: 1.685 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.595797538757324
Epoch: 12, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.726 Vali Acc: 0.247 Test Loss: 1.726 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.502191543579102
Epoch: 13, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.595 Vali Acc: 0.300 Test Loss: 1.595 Test Acc: 0.300
Validation loss decreased (-0.288957 --> -0.300364).  Saving model ...
Epoch: 14 cost time: 5.75622296333313
Epoch: 14, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.627 Vali Acc: 0.308 Test Loss: 1.627 Test Acc: 0.308
Validation loss decreased (-0.300364 --> -0.307969).  Saving model ...
Epoch: 15 cost time: 5.535017490386963
Epoch: 15, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.744 Vali Acc: 0.240 Test Loss: 1.744 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.558596611022949
Epoch: 16, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.798 Vali Acc: 0.266 Test Loss: 1.798 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.481868267059326
Epoch: 17, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.567126274108887
Epoch: 18, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.958 Vali Acc: 0.270 Test Loss: 1.958 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.574185132980347
Epoch: 19, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.767 Vali Acc: 0.232 Test Loss: 1.767 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.55670428276062
Epoch: 20, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.839 Vali Acc: 0.236 Test Loss: 1.839 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.556779384613037
Epoch: 21, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.965 Vali Acc: 0.259 Test Loss: 1.965 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.551701068878174
Epoch: 22, Steps: 17 | Train Loss: 0.963 Vali Loss: 2.052 Vali Acc: 0.243 Test Loss: 2.052 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.650789499282837
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.175 Vali Acc: 0.247 Test Loss: 2.175 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.3591883182525635
Epoch: 24, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.278 Vali Acc: 0.251 Test Loss: 2.278 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 370932
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 19.61373543739319
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.560 Vali Acc: 0.247 Test Loss: 1.560 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 18.41248321533203
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.751 Vali Acc: 0.251 Test Loss: 1.751 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250933).  Saving model ...
Epoch: 3 cost time: 17.891720294952393
Epoch: 3, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.498 Vali Acc: 0.240 Test Loss: 1.498 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.367283582687378
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
Validation loss decreased (-0.250933 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 18.237351655960083
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.487 Vali Acc: 0.251 Test Loss: 1.487 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.37359619140625
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.561 Vali Acc: 0.285 Test Loss: 1.561 Test Acc: 0.285
Validation loss decreased (-0.258540 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 18.475645780563354
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.661 Vali Acc: 0.255 Test Loss: 1.661 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.427422046661377
Epoch: 8, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.41110324859619
Epoch: 9, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.543 Vali Acc: 0.228 Test Loss: 1.543 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.381383419036865
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.752 Vali Acc: 0.281 Test Loss: 1.752 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.811251640319824
Epoch: 11, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.622 Vali Acc: 0.285 Test Loss: 1.622 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.433308124542236
Epoch: 12, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.968 Vali Acc: 0.236 Test Loss: 1.968 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.694002389907837
Epoch: 13, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.710 Vali Acc: 0.247 Test Loss: 1.710 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.792782306671143
Epoch: 14, Steps: 17 | Train Loss: 1.207 Vali Loss: 2.035 Vali Acc: 0.304 Test Loss: 2.035 Test Acc: 0.304
Validation loss decreased (-0.285155 --> -0.304162).  Saving model ...
Epoch: 15 cost time: 18.01605796813965
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.415 Vali Acc: 0.240 Test Loss: 2.415 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.636064052581787
Epoch: 16, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.815 Vali Acc: 0.259 Test Loss: 1.815 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.97123432159424
Epoch: 17, Steps: 17 | Train Loss: 1.267 Vali Loss: 2.115 Vali Acc: 0.251 Test Loss: 2.115 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.86579179763794
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.884 Vali Acc: 0.285 Test Loss: 1.884 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 17.7329843044281
Epoch: 19, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.958 Vali Acc: 0.251 Test Loss: 1.958 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.872069120407104
Epoch: 20, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.889 Vali Acc: 0.274 Test Loss: 1.889 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 18.438825845718384
Epoch: 21, Steps: 17 | Train Loss: 1.033 Vali Loss: 2.122 Vali Acc: 0.247 Test Loss: 2.122 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 18.50882124900818
Epoch: 22, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.247 Vali Acc: 0.243 Test Loss: 2.247 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 18.091267347335815
Epoch: 23, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.314 Vali Acc: 0.251 Test Loss: 2.314 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 17.651355981826782
Epoch: 24, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.612 Vali Acc: 0.247 Test Loss: 2.612 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 552180
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.759109497070312
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 7.569233179092407
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.417 Vali Acc: 0.297 Test Loss: 1.417 Test Acc: 0.297
Validation loss decreased (-0.250936 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 7.963244915008545
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.471 Vali Acc: 0.228 Test Loss: 1.471 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.290057182312012
Epoch: 4, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.622 Vali Acc: 0.259 Test Loss: 1.622 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.15332555770874
Epoch: 5, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.262537717819214
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.2274329662323
Epoch: 7, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.449 Vali Acc: 0.285 Test Loss: 1.449 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.16372299194336
Epoch: 8, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.868 Vali Acc: 0.266 Test Loss: 1.868 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.206808090209961
Epoch: 9, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.630 Vali Acc: 0.251 Test Loss: 1.630 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.366879224777222
Epoch: 10, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.618 Vali Acc: 0.240 Test Loss: 1.618 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.298456907272339
Epoch: 11, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.719 Vali Acc: 0.221 Test Loss: 1.719 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.235496282577515
Epoch: 12, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.645 Vali Acc: 0.297 Test Loss: 1.645 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 241716
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.654515743255615
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.560 Vali Acc: 0.247 Test Loss: 1.560 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 13.570945978164673
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.751 Vali Acc: 0.251 Test Loss: 1.751 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250933).  Saving model ...
Epoch: 3 cost time: 13.54282283782959
Epoch: 3, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.498 Vali Acc: 0.240 Test Loss: 1.498 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.546117067337036
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
Validation loss decreased (-0.250933 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 13.441690921783447
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.487 Vali Acc: 0.251 Test Loss: 1.487 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.51610803604126
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.561 Vali Acc: 0.285 Test Loss: 1.561 Test Acc: 0.285
Validation loss decreased (-0.258540 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 13.475754976272583
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.661 Vali Acc: 0.255 Test Loss: 1.661 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.826451778411865
Epoch: 8, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.233074426651001
Epoch: 9, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.543 Vali Acc: 0.228 Test Loss: 1.543 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.301454544067383
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.752 Vali Acc: 0.281 Test Loss: 1.752 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.20405626296997
Epoch: 11, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.622 Vali Acc: 0.285 Test Loss: 1.622 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.493456363677979
Epoch: 12, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.968 Vali Acc: 0.236 Test Loss: 1.968 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.633475303649902
Epoch: 13, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.710 Vali Acc: 0.247 Test Loss: 1.710 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 14.686676502227783
Epoch: 14, Steps: 17 | Train Loss: 1.207 Vali Loss: 2.035 Vali Acc: 0.304 Test Loss: 2.035 Test Acc: 0.304
Validation loss decreased (-0.285155 --> -0.304162).  Saving model ...
Epoch: 15 cost time: 14.877731323242188
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.415 Vali Acc: 0.240 Test Loss: 2.415 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.685383319854736
Epoch: 16, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.815 Vali Acc: 0.259 Test Loss: 1.815 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.717236995697021
Epoch: 17, Steps: 17 | Train Loss: 1.267 Vali Loss: 2.115 Vali Acc: 0.251 Test Loss: 2.115 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.752984523773193
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.884 Vali Acc: 0.285 Test Loss: 1.884 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.66287350654602
Epoch: 19, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.958 Vali Acc: 0.251 Test Loss: 1.958 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.805593013763428
Epoch: 20, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.889 Vali Acc: 0.274 Test Loss: 1.889 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 14.95043420791626
Epoch: 21, Steps: 17 | Train Loss: 1.033 Vali Loss: 2.122 Vali Acc: 0.247 Test Loss: 2.122 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.787596464157104
Epoch: 22, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.247 Vali Acc: 0.243 Test Loss: 2.247 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 14.90636682510376
Epoch: 23, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.314 Vali Acc: 0.251 Test Loss: 2.314 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 14.888982057571411
Epoch: 24, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.612 Vali Acc: 0.247 Test Loss: 2.612 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 552180
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.656288862228394
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 7.104666233062744
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.417 Vali Acc: 0.297 Test Loss: 1.417 Test Acc: 0.297
Validation loss decreased (-0.250936 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 7.050542831420898
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.471 Vali Acc: 0.228 Test Loss: 1.471 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.071970462799072
Epoch: 4, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.622 Vali Acc: 0.259 Test Loss: 1.622 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.6641645431518555
Epoch: 5, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.37968897819519
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.526152849197388
Epoch: 7, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.449 Vali Acc: 0.285 Test Loss: 1.449 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.448990345001221
Epoch: 8, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.868 Vali Acc: 0.266 Test Loss: 1.868 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.473468542098999
Epoch: 9, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.630 Vali Acc: 0.251 Test Loss: 1.630 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.544479131698608
Epoch: 10, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.618 Vali Acc: 0.240 Test Loss: 1.618 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.403073310852051
Epoch: 11, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.719 Vali Acc: 0.221 Test Loss: 1.719 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.577847719192505
Epoch: 12, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.645 Vali Acc: 0.297 Test Loss: 1.645 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 241716
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.92754077911377
Epoch: 1, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.560 Vali Acc: 0.247 Test Loss: 1.560 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 9.062372922897339
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.751 Vali Acc: 0.251 Test Loss: 1.751 Test Acc: 0.251
Validation loss decreased (-0.247133 --> -0.250933).  Saving model ...
Epoch: 3 cost time: 9.335062026977539
Epoch: 3, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.498 Vali Acc: 0.240 Test Loss: 1.498 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.314374446868896
Epoch: 4, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
Validation loss decreased (-0.250933 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 9.348118782043457
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.487 Vali Acc: 0.251 Test Loss: 1.487 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.441430807113647
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.561 Vali Acc: 0.285 Test Loss: 1.561 Test Acc: 0.285
Validation loss decreased (-0.258540 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 9.458238363265991
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.661 Vali Acc: 0.255 Test Loss: 1.661 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.48675799369812
Epoch: 8, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.524712085723877
Epoch: 9, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.543 Vali Acc: 0.228 Test Loss: 1.543 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.332731246948242
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.752 Vali Acc: 0.281 Test Loss: 1.752 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.835965156555176
Epoch: 11, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.622 Vali Acc: 0.285 Test Loss: 1.622 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.811311960220337
Epoch: 12, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.968 Vali Acc: 0.236 Test Loss: 1.968 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.876999616622925
Epoch: 13, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.710 Vali Acc: 0.247 Test Loss: 1.710 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.84633755683899
Epoch: 14, Steps: 17 | Train Loss: 1.207 Vali Loss: 2.035 Vali Acc: 0.304 Test Loss: 2.035 Test Acc: 0.304
Validation loss decreased (-0.285155 --> -0.304162).  Saving model ...
Epoch: 15 cost time: 9.849558591842651
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.415 Vali Acc: 0.240 Test Loss: 2.415 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.938939094543457
Epoch: 16, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.815 Vali Acc: 0.259 Test Loss: 1.815 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.833807468414307
Epoch: 17, Steps: 17 | Train Loss: 1.267 Vali Loss: 2.115 Vali Acc: 0.251 Test Loss: 2.115 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.860179424285889
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.884 Vali Acc: 0.285 Test Loss: 1.884 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.838331460952759
Epoch: 19, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.958 Vali Acc: 0.251 Test Loss: 1.958 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.854024887084961
Epoch: 20, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.889 Vali Acc: 0.274 Test Loss: 1.889 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.86086916923523
Epoch: 21, Steps: 17 | Train Loss: 1.033 Vali Loss: 2.122 Vali Acc: 0.247 Test Loss: 2.122 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.546375036239624
Epoch: 22, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.247 Vali Acc: 0.243 Test Loss: 2.247 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.364782810211182
Epoch: 23, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.314 Vali Acc: 0.251 Test Loss: 2.314 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.443318843841553
Epoch: 24, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.612 Vali Acc: 0.247 Test Loss: 2.612 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 552180
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.281963586807251
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.817266464233398
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.417 Vali Acc: 0.297 Test Loss: 1.417 Test Acc: 0.297
Validation loss decreased (-0.250936 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 4.695919513702393
Epoch: 3, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.471 Vali Acc: 0.228 Test Loss: 1.471 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.951057195663452
Epoch: 4, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.622 Vali Acc: 0.259 Test Loss: 1.622 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.961480617523193
Epoch: 5, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.953656911849976
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.956748008728027
Epoch: 7, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.449 Vali Acc: 0.285 Test Loss: 1.449 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.049839496612549
Epoch: 8, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.868 Vali Acc: 0.266 Test Loss: 1.868 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.95417332649231
Epoch: 9, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.630 Vali Acc: 0.251 Test Loss: 1.630 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.977870941162109
Epoch: 10, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.618 Vali Acc: 0.240 Test Loss: 1.618 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.658780336380005
Epoch: 11, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.719 Vali Acc: 0.221 Test Loss: 1.719 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.757267951965332
Epoch: 12, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.645 Vali Acc: 0.297 Test Loss: 1.645 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 241716
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 28.822429180145264
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 27.336637258529663
Epoch: 2, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.401 Vali Acc: 0.247 Test Loss: 1.401 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.124473571777344
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 27.020193099975586
Epoch: 4, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.275696516036987
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.495 Vali Acc: 0.251 Test Loss: 1.495 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.016649961471558
Epoch: 6, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.181040287017822
Epoch: 7, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.471 Vali Acc: 0.236 Test Loss: 1.471 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.71722650527954
Epoch: 8, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.49298930168152
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 10 cost time: 27.005719661712646
Epoch: 10, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.541 Vali Acc: 0.259 Test Loss: 1.541 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 27.954445600509644
Epoch: 11, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.527 Vali Acc: 0.221 Test Loss: 1.527 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 27.871784210205078
Epoch: 12, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.539 Vali Acc: 0.270 Test Loss: 1.539 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 13 cost time: 27.93626618385315
Epoch: 13, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.512 Vali Acc: 0.247 Test Loss: 1.512 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 27.838948965072632
Epoch: 14, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.525 Vali Acc: 0.266 Test Loss: 1.525 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 28.072394847869873
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.760 Vali Acc: 0.285 Test Loss: 1.760 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285154).  Saving model ...
Epoch: 16 cost time: 28.146829843521118
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.633 Vali Acc: 0.259 Test Loss: 1.633 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.007590293884277
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.755 Vali Acc: 0.266 Test Loss: 1.755 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 26.942237854003906
Epoch: 18, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 26.979684591293335
Epoch: 19, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.618 Vali Acc: 0.221 Test Loss: 1.618 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.95706868171692
Epoch: 20, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.620 Vali Acc: 0.266 Test Loss: 1.620 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.64722776412964
Epoch: 21, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.685 Vali Acc: 0.240 Test Loss: 1.685 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 25.87876868247986
Epoch: 22, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.698 Vali Acc: 0.255 Test Loss: 1.698 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 26.992274522781372
Epoch: 23, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.720 Vali Acc: 0.262 Test Loss: 1.720 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 27.416159868240356
Epoch: 24, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.788 Vali Acc: 0.251 Test Loss: 1.788 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 27.972747087478638
Epoch: 25, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.654 Vali Acc: 0.285 Test Loss: 1.654 Test Acc: 0.285
Validation loss decreased (-0.285154 --> -0.285155).  Saving model ...
Epoch: 26 cost time: 27.868747234344482
Epoch: 26, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.887 Vali Acc: 0.259 Test Loss: 1.887 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 27.98085331916809
Epoch: 27, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.946 Vali Acc: 0.274 Test Loss: 1.946 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 27.787337064743042
Epoch: 28, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.786 Vali Acc: 0.270 Test Loss: 1.786 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 27.73687767982483
Epoch: 29, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.944 Vali Acc: 0.243 Test Loss: 1.944 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 27.863344430923462
Epoch: 30, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.853 Vali Acc: 0.285 Test Loss: 1.853 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 936044
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.623571395874023
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.398 Vali Acc: 0.278 Test Loss: 1.398 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 13.211209535598755
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.391 Vali Acc: 0.240 Test Loss: 1.391 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.61286187171936
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.53425407409668
Epoch: 4, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.554 Vali Acc: 0.262 Test Loss: 1.554 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.72625207901001
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.414 Vali Acc: 0.289 Test Loss: 1.414 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 12.103858232498169
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.512 Vali Acc: 0.274 Test Loss: 1.512 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.243703365325928
Epoch: 7, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.439 Vali Acc: 0.274 Test Loss: 1.439 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.668045043945312
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.54468059539795
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.608037233352661
Epoch: 10, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.570 Vali Acc: 0.285 Test Loss: 1.570 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.723881959915161
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.538 Vali Acc: 0.255 Test Loss: 1.538 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.312011480331421
Epoch: 12, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.711975574493408
Epoch: 13, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.839 Vali Acc: 0.251 Test Loss: 1.839 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.705694437026978
Epoch: 14, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.886 Vali Acc: 0.274 Test Loss: 1.886 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.605374097824097
Epoch: 15, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.779 Vali Acc: 0.255 Test Loss: 1.779 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 315068
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.05083417892456
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 19.298640489578247
Epoch: 2, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.401 Vali Acc: 0.247 Test Loss: 1.401 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.422414541244507
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 20.545255661010742
Epoch: 4, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.557037353515625
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.495 Vali Acc: 0.251 Test Loss: 1.495 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.52669930458069
Epoch: 6, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.48240900039673
Epoch: 7, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.471 Vali Acc: 0.236 Test Loss: 1.471 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.390581369400024
Epoch: 8, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.454217433929443
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 10 cost time: 19.674364805221558
Epoch: 10, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.541 Vali Acc: 0.259 Test Loss: 1.541 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.633703231811523
Epoch: 11, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.527 Vali Acc: 0.221 Test Loss: 1.527 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.54004669189453
Epoch: 12, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.539 Vali Acc: 0.270 Test Loss: 1.539 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 13 cost time: 20.735015392303467
Epoch: 13, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.512 Vali Acc: 0.247 Test Loss: 1.512 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.919803142547607
Epoch: 14, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.525 Vali Acc: 0.266 Test Loss: 1.525 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 20.085482120513916
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.760 Vali Acc: 0.285 Test Loss: 1.760 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285154).  Saving model ...
Epoch: 16 cost time: 20.027979135513306
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.633 Vali Acc: 0.259 Test Loss: 1.633 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 20.017433643341064
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.755 Vali Acc: 0.266 Test Loss: 1.755 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.127224445343018
Epoch: 18, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.14959955215454
Epoch: 19, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.618 Vali Acc: 0.221 Test Loss: 1.618 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 20.10860514640808
Epoch: 20, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.620 Vali Acc: 0.266 Test Loss: 1.620 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 19.807684898376465
Epoch: 21, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.685 Vali Acc: 0.240 Test Loss: 1.685 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.941431283950806
Epoch: 22, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.698 Vali Acc: 0.255 Test Loss: 1.698 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 19.93044352531433
Epoch: 23, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.720 Vali Acc: 0.262 Test Loss: 1.720 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 18.781379222869873
Epoch: 24, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.788 Vali Acc: 0.251 Test Loss: 1.788 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 19.33013129234314
Epoch: 25, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.654 Vali Acc: 0.285 Test Loss: 1.654 Test Acc: 0.285
Validation loss decreased (-0.285154 --> -0.285155).  Saving model ...
Epoch: 26 cost time: 20.023284196853638
Epoch: 26, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.887 Vali Acc: 0.259 Test Loss: 1.887 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 20.98356318473816
Epoch: 27, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.946 Vali Acc: 0.274 Test Loss: 1.946 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 21.191928148269653
Epoch: 28, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.786 Vali Acc: 0.270 Test Loss: 1.786 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 20.706563472747803
Epoch: 29, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.944 Vali Acc: 0.243 Test Loss: 1.944 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 21.218088388442993
Epoch: 30, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.853 Vali Acc: 0.285 Test Loss: 1.853 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 936044
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.768672466278076
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.398 Vali Acc: 0.278 Test Loss: 1.398 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 9.389559745788574
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.391 Vali Acc: 0.240 Test Loss: 1.391 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.329532146453857
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.393984079360962
Epoch: 4, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.554 Vali Acc: 0.262 Test Loss: 1.554 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.411311149597168
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.414 Vali Acc: 0.289 Test Loss: 1.414 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 9.458849668502808
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.512 Vali Acc: 0.274 Test Loss: 1.512 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.473481893539429
Epoch: 7, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.439 Vali Acc: 0.274 Test Loss: 1.439 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.51996636390686
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.564308881759644
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.569859981536865
Epoch: 10, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.570 Vali Acc: 0.285 Test Loss: 1.570 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.48146677017212
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.538 Vali Acc: 0.255 Test Loss: 1.538 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.182863235473633
Epoch: 12, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.354480028152466
Epoch: 13, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.839 Vali Acc: 0.251 Test Loss: 1.839 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.283735990524292
Epoch: 14, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.886 Vali Acc: 0.274 Test Loss: 1.886 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.276833534240723
Epoch: 15, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.779 Vali Acc: 0.255 Test Loss: 1.779 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 315068
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.760562896728516
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 11.521457195281982
Epoch: 2, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.401 Vali Acc: 0.247 Test Loss: 1.401 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.736599206924438
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 11.730002403259277
Epoch: 4, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.441 Vali Acc: 0.255 Test Loss: 1.441 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.615049123764038
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.495 Vali Acc: 0.251 Test Loss: 1.495 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.119048595428467
Epoch: 6, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.19566297531128
Epoch: 7, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.471 Vali Acc: 0.236 Test Loss: 1.471 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.321902990341187
Epoch: 8, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.479 Vali Acc: 0.243 Test Loss: 1.479 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.39508056640625
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 10 cost time: 12.401248693466187
Epoch: 10, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.541 Vali Acc: 0.259 Test Loss: 1.541 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.819507360458374
Epoch: 11, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.527 Vali Acc: 0.221 Test Loss: 1.527 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.542303800582886
Epoch: 12, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.539 Vali Acc: 0.270 Test Loss: 1.539 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 13 cost time: 12.972418546676636
Epoch: 13, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.512 Vali Acc: 0.247 Test Loss: 1.512 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.969758987426758
Epoch: 14, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.525 Vali Acc: 0.266 Test Loss: 1.525 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.009306192398071
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.760 Vali Acc: 0.285 Test Loss: 1.760 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285154).  Saving model ...
Epoch: 16 cost time: 12.987012386322021
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.633 Vali Acc: 0.259 Test Loss: 1.633 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.089016675949097
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.755 Vali Acc: 0.266 Test Loss: 1.755 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 13.083001375198364
Epoch: 18, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.202574968338013
Epoch: 19, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.618 Vali Acc: 0.221 Test Loss: 1.618 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 13.168292045593262
Epoch: 20, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.620 Vali Acc: 0.266 Test Loss: 1.620 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 13.185262680053711
Epoch: 21, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.685 Vali Acc: 0.240 Test Loss: 1.685 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 13.121124744415283
Epoch: 22, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.698 Vali Acc: 0.255 Test Loss: 1.698 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 13.180091857910156
Epoch: 23, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.720 Vali Acc: 0.262 Test Loss: 1.720 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 12.465781688690186
Epoch: 24, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.788 Vali Acc: 0.251 Test Loss: 1.788 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 12.41230583190918
Epoch: 25, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.654 Vali Acc: 0.285 Test Loss: 1.654 Test Acc: 0.285
Validation loss decreased (-0.285154 --> -0.285155).  Saving model ...
Epoch: 26 cost time: 12.301719903945923
Epoch: 26, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.887 Vali Acc: 0.259 Test Loss: 1.887 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.0677330493927
Epoch: 27, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.946 Vali Acc: 0.274 Test Loss: 1.946 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 12.373028755187988
Epoch: 28, Steps: 17 | Train Loss: 1.007 Vali Loss: 1.786 Vali Acc: 0.270 Test Loss: 1.786 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 12.282803773880005
Epoch: 29, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.944 Vali Acc: 0.243 Test Loss: 1.944 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 12.443327903747559
Epoch: 30, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.853 Vali Acc: 0.285 Test Loss: 1.853 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 936044
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.727290391921997
Epoch: 1, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.398 Vali Acc: 0.278 Test Loss: 1.398 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 6.061625242233276
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.391 Vali Acc: 0.240 Test Loss: 1.391 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.93034291267395
Epoch: 3, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.417 Vali Acc: 0.262 Test Loss: 1.417 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.007739305496216
Epoch: 4, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.554 Vali Acc: 0.262 Test Loss: 1.554 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.927923679351807
Epoch: 5, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.414 Vali Acc: 0.289 Test Loss: 1.414 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 6.001276731491089
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.512 Vali Acc: 0.274 Test Loss: 1.512 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.00693154335022
Epoch: 7, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.439 Vali Acc: 0.274 Test Loss: 1.439 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.782893180847168
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.944154977798462
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.956801652908325
Epoch: 10, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.570 Vali Acc: 0.285 Test Loss: 1.570 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.965773344039917
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.538 Vali Acc: 0.255 Test Loss: 1.538 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.988669395446777
Epoch: 12, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.940686464309692
Epoch: 13, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.839 Vali Acc: 0.251 Test Loss: 1.839 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.016908407211304
Epoch: 14, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.886 Vali Acc: 0.274 Test Loss: 1.886 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.0464372634887695
Epoch: 15, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.779 Vali Acc: 0.255 Test Loss: 1.779 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 315068
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.3621826171875
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 16.49859356880188
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 17.192112684249878
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.460 Vali Acc: 0.251 Test Loss: 1.460 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.18264603614807
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 17.309602975845337
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.495 Vali Acc: 0.247 Test Loss: 1.495 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.432762384414673
Epoch: 6, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.498136520385742
Epoch: 7, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.52689003944397
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.763 Vali Acc: 0.247 Test Loss: 1.763 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.472965478897095
Epoch: 9, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.525 Vali Acc: 0.240 Test Loss: 1.525 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 17.33811926841736
Epoch: 10, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.541 Vali Acc: 0.232 Test Loss: 1.541 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.32682490348816
Epoch: 11, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.616 Vali Acc: 0.259 Test Loss: 1.616 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 17.34669280052185
Epoch: 12, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.476 Vali Acc: 0.285 Test Loss: 1.476 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285156).  Saving model ...
Epoch: 13 cost time: 17.419749975204468
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.519 Vali Acc: 0.243 Test Loss: 1.519 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 17.404795169830322
Epoch: 14, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.442100524902344
Epoch: 15, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.634 Vali Acc: 0.232 Test Loss: 1.634 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.35950779914856
Epoch: 16, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.80960702896118
Epoch: 17, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.766 Vali Acc: 0.240 Test Loss: 1.766 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 16.763548612594604
Epoch: 18, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.928 Vali Acc: 0.281 Test Loss: 1.928 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 16.73506259918213
Epoch: 19, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.812 Vali Acc: 0.240 Test Loss: 1.812 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 16.764439821243286
Epoch: 20, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.821 Vali Acc: 0.243 Test Loss: 1.821 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 16.867132425308228
Epoch: 21, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.824 Vali Acc: 0.247 Test Loss: 1.824 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 16.817076683044434
Epoch: 22, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 496172
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.985682725906372
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 7.9998650550842285
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.421 Vali Acc: 0.281 Test Loss: 1.421 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 7.814548015594482
Epoch: 3, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.547 Vali Acc: 0.236 Test Loss: 1.547 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.213658809661865
Epoch: 4, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.457 Vali Acc: 0.259 Test Loss: 1.457 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.948750257492065
Epoch: 5, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.449 Vali Acc: 0.259 Test Loss: 1.449 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.303380489349365
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.25364351272583
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.656 Vali Acc: 0.247 Test Loss: 1.656 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.697096586227417
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.649 Vali Acc: 0.247 Test Loss: 1.649 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.947803258895874
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.521 Vali Acc: 0.293 Test Loss: 1.521 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292760).  Saving model ...
Epoch: 10 cost time: 8.717294931411743
Epoch: 10, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.509 Vali Acc: 0.274 Test Loss: 1.509 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.6297607421875
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.680 Vali Acc: 0.243 Test Loss: 1.680 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.62949252128601
Epoch: 12, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.674 Vali Acc: 0.266 Test Loss: 1.674 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.69888973236084
Epoch: 13, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.569 Vali Acc: 0.251 Test Loss: 1.569 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.610326290130615
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.672 Vali Acc: 0.266 Test Loss: 1.672 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.65039849281311
Epoch: 15, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.522 Vali Acc: 0.274 Test Loss: 1.522 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.128924608230591
Epoch: 16, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.702 Vali Acc: 0.247 Test Loss: 1.702 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.1340720653533936
Epoch: 17, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.622 Vali Acc: 0.266 Test Loss: 1.622 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.215734720230103
Epoch: 18, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.867 Vali Acc: 0.228 Test Loss: 1.867 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.296352624893188
Epoch: 19, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.715 Vali Acc: 0.232 Test Loss: 1.715 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 185660
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.914642572402954
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 12.993465185165405
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 12.889482259750366
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.460 Vali Acc: 0.251 Test Loss: 1.460 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.031382322311401
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 13.105837345123291
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.495 Vali Acc: 0.247 Test Loss: 1.495 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.023348569869995
Epoch: 6, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.144020318984985
Epoch: 7, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.230605125427246
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.763 Vali Acc: 0.247 Test Loss: 1.763 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.530612230300903
Epoch: 9, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.525 Vali Acc: 0.240 Test Loss: 1.525 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.470648050308228
Epoch: 10, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.541 Vali Acc: 0.232 Test Loss: 1.541 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.588127374649048
Epoch: 11, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.616 Vali Acc: 0.259 Test Loss: 1.616 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.837663650512695
Epoch: 12, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.476 Vali Acc: 0.285 Test Loss: 1.476 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285156).  Saving model ...
Epoch: 13 cost time: 11.792803764343262
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.519 Vali Acc: 0.243 Test Loss: 1.519 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.530321598052979
Epoch: 14, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.528717756271362
Epoch: 15, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.634 Vali Acc: 0.232 Test Loss: 1.634 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.50026249885559
Epoch: 16, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.559911012649536
Epoch: 17, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.766 Vali Acc: 0.240 Test Loss: 1.766 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.607045888900757
Epoch: 18, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.928 Vali Acc: 0.281 Test Loss: 1.928 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.558589935302734
Epoch: 19, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.812 Vali Acc: 0.240 Test Loss: 1.812 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.251120328903198
Epoch: 20, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.821 Vali Acc: 0.243 Test Loss: 1.821 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.33737063407898
Epoch: 21, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.824 Vali Acc: 0.247 Test Loss: 1.824 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.456527709960938
Epoch: 22, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 496172
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.582757949829102
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 6.106963634490967
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.421 Vali Acc: 0.281 Test Loss: 1.421 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 6.118995666503906
Epoch: 3, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.547 Vali Acc: 0.236 Test Loss: 1.547 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.060710668563843
Epoch: 4, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.457 Vali Acc: 0.259 Test Loss: 1.457 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.166677951812744
Epoch: 5, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.449 Vali Acc: 0.259 Test Loss: 1.449 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.207726955413818
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.126840353012085
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.656 Vali Acc: 0.247 Test Loss: 1.656 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.137535095214844
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.649 Vali Acc: 0.247 Test Loss: 1.649 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.297313690185547
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.521 Vali Acc: 0.293 Test Loss: 1.521 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292760).  Saving model ...
Epoch: 10 cost time: 6.213670492172241
Epoch: 10, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.509 Vali Acc: 0.274 Test Loss: 1.509 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.211856365203857
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.680 Vali Acc: 0.243 Test Loss: 1.680 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.1762800216674805
Epoch: 12, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.674 Vali Acc: 0.266 Test Loss: 1.674 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.294062852859497
Epoch: 13, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.569 Vali Acc: 0.251 Test Loss: 1.569 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.2692601680755615
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.672 Vali Acc: 0.266 Test Loss: 1.672 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.717814683914185
Epoch: 15, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.522 Vali Acc: 0.274 Test Loss: 1.522 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.62384557723999
Epoch: 16, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.702 Vali Acc: 0.247 Test Loss: 1.702 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.544002056121826
Epoch: 17, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.622 Vali Acc: 0.266 Test Loss: 1.622 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.490355491638184
Epoch: 18, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.867 Vali Acc: 0.228 Test Loss: 1.867 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.441114664077759
Epoch: 19, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.715 Vali Acc: 0.232 Test Loss: 1.715 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 185660
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.594877243041992
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 7.551792621612549
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
Validation loss decreased (-0.254739 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 8.342368364334106
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.460 Vali Acc: 0.251 Test Loss: 1.460 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.361196994781494
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.454 Vali Acc: 0.266 Test Loss: 1.454 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 8.358738660812378
Epoch: 5, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.495 Vali Acc: 0.247 Test Loss: 1.495 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.379169702529907
Epoch: 6, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.499 Vali Acc: 0.243 Test Loss: 1.499 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.418469667434692
Epoch: 7, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.84072732925415
Epoch: 8, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.763 Vali Acc: 0.247 Test Loss: 1.763 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.926856994628906
Epoch: 9, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.525 Vali Acc: 0.240 Test Loss: 1.525 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.865540742874146
Epoch: 10, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.541 Vali Acc: 0.232 Test Loss: 1.541 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.809234142303467
Epoch: 11, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.616 Vali Acc: 0.259 Test Loss: 1.616 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.88853669166565
Epoch: 12, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.476 Vali Acc: 0.285 Test Loss: 1.476 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285156).  Saving model ...
Epoch: 13 cost time: 8.90174388885498
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.519 Vali Acc: 0.243 Test Loss: 1.519 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.892975807189941
Epoch: 14, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.915762424468994
Epoch: 15, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.634 Vali Acc: 0.232 Test Loss: 1.634 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.945568323135376
Epoch: 16, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.880345344543457
Epoch: 17, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.766 Vali Acc: 0.240 Test Loss: 1.766 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.9761962890625
Epoch: 18, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.928 Vali Acc: 0.281 Test Loss: 1.928 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.960431337356567
Epoch: 19, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.812 Vali Acc: 0.240 Test Loss: 1.812 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.093696594238281
Epoch: 20, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.821 Vali Acc: 0.243 Test Loss: 1.821 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.867189884185791
Epoch: 21, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.824 Vali Acc: 0.247 Test Loss: 1.824 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.746684789657593
Epoch: 22, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.985 Vali Acc: 0.251 Test Loss: 1.985 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 496172
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.026855707168579
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.644509553909302
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.421 Vali Acc: 0.281 Test Loss: 1.421 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 4.39394474029541
Epoch: 3, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.547 Vali Acc: 0.236 Test Loss: 1.547 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.3123486042022705
Epoch: 4, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.457 Vali Acc: 0.259 Test Loss: 1.457 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.363500356674194
Epoch: 5, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.449 Vali Acc: 0.259 Test Loss: 1.449 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.338442325592041
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.471 Vali Acc: 0.255 Test Loss: 1.471 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.1821959018707275
Epoch: 7, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.656 Vali Acc: 0.247 Test Loss: 1.656 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.9940052032470703
Epoch: 8, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.649 Vali Acc: 0.247 Test Loss: 1.649 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.202606916427612
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.521 Vali Acc: 0.293 Test Loss: 1.521 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292760).  Saving model ...
Epoch: 10 cost time: 4.067087650299072
Epoch: 10, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.509 Vali Acc: 0.274 Test Loss: 1.509 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.71895694732666
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.680 Vali Acc: 0.243 Test Loss: 1.680 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.093065977096558
Epoch: 12, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.674 Vali Acc: 0.266 Test Loss: 1.674 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.023277044296265
Epoch: 13, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.569 Vali Acc: 0.251 Test Loss: 1.569 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.059808969497681
Epoch: 14, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.672 Vali Acc: 0.266 Test Loss: 1.672 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.746791124343872
Epoch: 15, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.522 Vali Acc: 0.274 Test Loss: 1.522 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.113609313964844
Epoch: 16, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.702 Vali Acc: 0.247 Test Loss: 1.702 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.918124198913574
Epoch: 17, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.622 Vali Acc: 0.266 Test Loss: 1.622 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.059346437454224
Epoch: 18, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.867 Vali Acc: 0.228 Test Loss: 1.867 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.065666675567627
Epoch: 19, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.715 Vali Acc: 0.232 Test Loss: 1.715 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 185660
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.407009363174438
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 11.523247480392456
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.387 Vali Acc: 0.247 Test Loss: 1.387 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.086252212524414
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.398 Vali Acc: 0.251 Test Loss: 1.398 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.134829759597778
Epoch: 4, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.540 Vali Acc: 0.335 Test Loss: 1.540 Test Acc: 0.335
Validation loss decreased (-0.258541 --> -0.334585).  Saving model ...
Epoch: 5 cost time: 12.199628114700317
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.579 Vali Acc: 0.255 Test Loss: 1.579 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.243086576461792
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.173367261886597
Epoch: 7, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.87681245803833
Epoch: 8, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.509 Vali Acc: 0.281 Test Loss: 1.509 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.784581661224365
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.592 Vali Acc: 0.232 Test Loss: 1.592 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.097918272018433
Epoch: 10, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.503 Vali Acc: 0.255 Test Loss: 1.503 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.252644300460815
Epoch: 11, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.551 Vali Acc: 0.259 Test Loss: 1.551 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.405211448669434
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.751 Vali Acc: 0.262 Test Loss: 1.751 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.474045991897583
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.530 Vali Acc: 0.312 Test Loss: 1.530 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.820985555648804
Epoch: 14, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.566 Vali Acc: 0.285 Test Loss: 1.566 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33460076045627374
model parameter : 276236
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.83339786529541
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.423 Vali Acc: 0.262 Test Loss: 1.423 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 6.261250019073486
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2644922733306885
Epoch: 3, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 6.286159038543701
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.542 Vali Acc: 0.266 Test Loss: 1.542 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.085012912750244
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.575 Vali Acc: 0.236 Test Loss: 1.575 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.712859869003296
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.550 Vali Acc: 0.285 Test Loss: 1.550 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 5.38242506980896
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.684 Vali Acc: 0.247 Test Loss: 1.684 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.586323499679565
Epoch: 8, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.552 Vali Acc: 0.243 Test Loss: 1.552 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.2720582485198975
Epoch: 9, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.510 Vali Acc: 0.247 Test Loss: 1.510 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.1744749546051025
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.718 Vali Acc: 0.262 Test Loss: 1.718 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.541669607162476
Epoch: 11, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.740 Vali Acc: 0.251 Test Loss: 1.740 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.603792190551758
Epoch: 12, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.554 Vali Acc: 0.251 Test Loss: 1.554 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.5779852867126465
Epoch: 13, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.763 Vali Acc: 0.281 Test Loss: 1.763 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.581989049911499
Epoch: 14, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.748 Vali Acc: 0.243 Test Loss: 1.748 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.605698347091675
Epoch: 15, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.756 Vali Acc: 0.259 Test Loss: 1.756 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.65675163269043
Epoch: 16, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.781 Vali Acc: 0.259 Test Loss: 1.781 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 120956
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.031759977340698
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 9.245022058486938
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.387 Vali Acc: 0.247 Test Loss: 1.387 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.55914855003357
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.398 Vali Acc: 0.251 Test Loss: 1.398 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.294982194900513
Epoch: 4, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.540 Vali Acc: 0.335 Test Loss: 1.540 Test Acc: 0.335
Validation loss decreased (-0.258541 --> -0.334585).  Saving model ...
Epoch: 5 cost time: 8.423738479614258
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.579 Vali Acc: 0.255 Test Loss: 1.579 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.290270805358887
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.360901355743408
Epoch: 7, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.3851478099823
Epoch: 8, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.509 Vali Acc: 0.281 Test Loss: 1.509 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.46009612083435
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.592 Vali Acc: 0.232 Test Loss: 1.592 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.090360879898071
Epoch: 10, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.503 Vali Acc: 0.255 Test Loss: 1.503 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.891711950302124
Epoch: 11, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.551 Vali Acc: 0.259 Test Loss: 1.551 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.790047407150269
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.751 Vali Acc: 0.262 Test Loss: 1.751 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.955269575119019
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.530 Vali Acc: 0.312 Test Loss: 1.530 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.908014297485352
Epoch: 14, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.566 Vali Acc: 0.285 Test Loss: 1.566 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33460076045627374
model parameter : 276236
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.732458114624023
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.423 Vali Acc: 0.262 Test Loss: 1.423 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.262782573699951
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4347498416900635
Epoch: 3, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 4.757221698760986
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.542 Vali Acc: 0.266 Test Loss: 1.542 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.79632568359375
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.575 Vali Acc: 0.236 Test Loss: 1.575 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.684366703033447
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.550 Vali Acc: 0.285 Test Loss: 1.550 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 4.800917148590088
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.684 Vali Acc: 0.247 Test Loss: 1.684 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.658058166503906
Epoch: 8, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.552 Vali Acc: 0.243 Test Loss: 1.552 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.756541728973389
Epoch: 9, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.510 Vali Acc: 0.247 Test Loss: 1.510 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.164706707000732
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.718 Vali Acc: 0.262 Test Loss: 1.718 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.1351752281188965
Epoch: 11, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.740 Vali Acc: 0.251 Test Loss: 1.740 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.096112251281738
Epoch: 12, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.554 Vali Acc: 0.251 Test Loss: 1.554 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.164227485656738
Epoch: 13, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.763 Vali Acc: 0.281 Test Loss: 1.763 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.160070896148682
Epoch: 14, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.748 Vali Acc: 0.243 Test Loss: 1.748 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.116310119628906
Epoch: 15, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.756 Vali Acc: 0.259 Test Loss: 1.756 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.15058708190918
Epoch: 16, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.781 Vali Acc: 0.259 Test Loss: 1.781 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 120956
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.245415687561035
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.427 Vali Acc: 0.259 Test Loss: 1.427 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 5.6737048625946045
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.387 Vali Acc: 0.247 Test Loss: 1.387 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.905896902084351
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.398 Vali Acc: 0.251 Test Loss: 1.398 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.561401605606079
Epoch: 4, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.540 Vali Acc: 0.335 Test Loss: 1.540 Test Acc: 0.335
Validation loss decreased (-0.258541 --> -0.334585).  Saving model ...
Epoch: 5 cost time: 6.336686611175537
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.579 Vali Acc: 0.255 Test Loss: 1.579 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.3959856033325195
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.427 Vali Acc: 0.232 Test Loss: 1.427 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.337085485458374
Epoch: 7, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.350575685501099
Epoch: 8, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.509 Vali Acc: 0.281 Test Loss: 1.509 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.3051064014434814
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.592 Vali Acc: 0.232 Test Loss: 1.592 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.330997705459595
Epoch: 10, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.503 Vali Acc: 0.255 Test Loss: 1.503 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.354944705963135
Epoch: 11, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.551 Vali Acc: 0.259 Test Loss: 1.551 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.340078830718994
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.751 Vali Acc: 0.262 Test Loss: 1.751 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.311364650726318
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.530 Vali Acc: 0.312 Test Loss: 1.530 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.230231046676636
Epoch: 14, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.566 Vali Acc: 0.285 Test Loss: 1.566 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33460076045627374
model parameter : 276236
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.103641986846924
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.423 Vali Acc: 0.262 Test Loss: 1.423 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.865872383117676
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.446 Vali Acc: 0.255 Test Loss: 1.446 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9386982917785645
Epoch: 3, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 3.047581434249878
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.542 Vali Acc: 0.266 Test Loss: 1.542 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.883364677429199
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.575 Vali Acc: 0.236 Test Loss: 1.575 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9423468112945557
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.550 Vali Acc: 0.285 Test Loss: 1.550 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 3.139315366744995
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.684 Vali Acc: 0.247 Test Loss: 1.684 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.370105743408203
Epoch: 8, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.552 Vali Acc: 0.243 Test Loss: 1.552 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0805134773254395
Epoch: 9, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.510 Vali Acc: 0.247 Test Loss: 1.510 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3184444904327393
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.718 Vali Acc: 0.262 Test Loss: 1.718 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3464388847351074
Epoch: 11, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.740 Vali Acc: 0.251 Test Loss: 1.740 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.291710615158081
Epoch: 12, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.554 Vali Acc: 0.251 Test Loss: 1.554 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3648178577423096
Epoch: 13, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.763 Vali Acc: 0.281 Test Loss: 1.763 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3319287300109863
Epoch: 14, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.748 Vali Acc: 0.243 Test Loss: 1.748 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.4094650745391846
Epoch: 15, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.756 Vali Acc: 0.259 Test Loss: 1.756 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.303534746170044
Epoch: 16, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.781 Vali Acc: 0.259 Test Loss: 1.781 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 120956
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 194.16571831703186
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 2.700 Vali Acc: 0.255 Test Loss: 2.700 Test Acc: 0.255
Validation loss decreased (inf --> -0.254726).  Saving model ...
Epoch: 2 cost time: 180.5113227367401
Epoch: 2, Steps: 17 | Train Loss: 2.299 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
Validation loss decreased (-0.254726 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 192.62184500694275
Epoch: 3, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.551 Vali Acc: 0.228 Test Loss: 1.551 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 186.89367508888245
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.615 Vali Acc: 0.217 Test Loss: 1.615 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 183.17439579963684
Epoch: 5, Steps: 17 | Train Loss: 1.655 Vali Loss: 2.067 Vali Acc: 0.293 Test Loss: 2.067 Test Acc: 0.293
Validation loss decreased (-0.273747 --> -0.292755).  Saving model ...
Epoch: 6 cost time: 192.47223043441772
Epoch: 6, Steps: 17 | Train Loss: 1.554 Vali Loss: 2.479 Vali Acc: 0.259 Test Loss: 2.479 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 188.86058640480042
Epoch: 7, Steps: 17 | Train Loss: 1.795 Vali Loss: 2.468 Vali Acc: 0.247 Test Loss: 2.468 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 184.58270287513733
Epoch: 8, Steps: 17 | Train Loss: 1.750 Vali Loss: 2.054 Vali Acc: 0.251 Test Loss: 2.054 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 198.15016627311707
Epoch: 9, Steps: 17 | Train Loss: 1.502 Vali Loss: 2.281 Vali Acc: 0.274 Test Loss: 2.281 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 194.05960774421692
Epoch: 10, Steps: 17 | Train Loss: 1.235 Vali Loss: 2.101 Vali Acc: 0.266 Test Loss: 2.101 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 196.3546061515808
Epoch: 11, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.105 Vali Acc: 0.266 Test Loss: 2.105 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 200.3201253414154
Epoch: 12, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.225 Vali Acc: 0.285 Test Loss: 2.225 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 183.35123586654663
Epoch: 13, Steps: 17 | Train Loss: 0.972 Vali Loss: 3.470 Vali Acc: 0.228 Test Loss: 3.470 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 198.70672249794006
Epoch: 14, Steps: 17 | Train Loss: 0.980 Vali Loss: 2.634 Vali Acc: 0.247 Test Loss: 2.634 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 186.282452583313
Epoch: 15, Steps: 17 | Train Loss: 0.759 Vali Loss: 3.172 Vali Acc: 0.247 Test Loss: 3.172 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 38389636
model size : 148.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 76.53986477851868
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.843 Vali Acc: 0.262 Test Loss: 1.843 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 65.3951473236084
Epoch: 2, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.105 Vali Acc: 0.247 Test Loss: 2.105 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 72.3046350479126
Epoch: 3, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.912 Vali Acc: 0.259 Test Loss: 1.912 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 73.94361972808838
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 3.223 Vali Acc: 0.247 Test Loss: 3.223 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 70.15603423118591
Epoch: 5, Steps: 17 | Train Loss: 2.113 Vali Loss: 2.848 Vali Acc: 0.274 Test Loss: 2.848 Test Acc: 0.274
Validation loss decreased (-0.262339 --> -0.273736).  Saving model ...
Epoch: 6 cost time: 69.7186770439148
Epoch: 6, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.240 Vali Acc: 0.243 Test Loss: 2.240 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 71.84286046028137
Epoch: 7, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.708 Vali Acc: 0.232 Test Loss: 2.708 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 69.92088794708252
Epoch: 8, Steps: 17 | Train Loss: 1.710 Vali Loss: 2.559 Vali Acc: 0.285 Test Loss: 2.559 Test Acc: 0.285
Validation loss decreased (-0.273736 --> -0.285146).  Saving model ...
Epoch: 9 cost time: 74.2886643409729
Epoch: 9, Steps: 17 | Train Loss: 1.731 Vali Loss: 2.650 Vali Acc: 0.255 Test Loss: 2.650 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 70.22575306892395
Epoch: 10, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.829 Vali Acc: 0.240 Test Loss: 1.829 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 66.89480566978455
Epoch: 11, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.020 Vali Acc: 0.236 Test Loss: 2.020 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 74.28272128105164
Epoch: 12, Steps: 17 | Train Loss: 0.953 Vali Loss: 2.947 Vali Acc: 0.236 Test Loss: 2.947 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 74.40672016143799
Epoch: 13, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.265 Vali Acc: 0.247 Test Loss: 2.265 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 64.83839440345764
Epoch: 14, Steps: 17 | Train Loss: 1.140 Vali Loss: 2.626 Vali Acc: 0.278 Test Loss: 2.626 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 71.10495162010193
Epoch: 15, Steps: 17 | Train Loss: 1.051 Vali Loss: 3.094 Vali Acc: 0.255 Test Loss: 3.094 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 74.30203533172607
Epoch: 16, Steps: 17 | Train Loss: 0.845 Vali Loss: 3.131 Vali Acc: 0.243 Test Loss: 3.131 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 71.07860255241394
Epoch: 17, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.769 Vali Acc: 0.240 Test Loss: 2.769 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 69.45043134689331
Epoch: 18, Steps: 17 | Train Loss: 0.866 Vali Loss: 3.334 Vali Acc: 0.221 Test Loss: 3.334 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 11911556
model size : 47.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 146.08281898498535
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 2.700 Vali Acc: 0.255 Test Loss: 2.700 Test Acc: 0.255
Validation loss decreased (inf --> -0.254726).  Saving model ...
Epoch: 2 cost time: 142.5145969390869
Epoch: 2, Steps: 17 | Train Loss: 2.299 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
Validation loss decreased (-0.254726 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 138.84955549240112
Epoch: 3, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.551 Vali Acc: 0.228 Test Loss: 1.551 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 144.47185492515564
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.615 Vali Acc: 0.217 Test Loss: 1.615 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 139.58745956420898
Epoch: 5, Steps: 17 | Train Loss: 1.655 Vali Loss: 2.067 Vali Acc: 0.293 Test Loss: 2.067 Test Acc: 0.293
Validation loss decreased (-0.273747 --> -0.292755).  Saving model ...
Epoch: 6 cost time: 141.00921297073364
Epoch: 6, Steps: 17 | Train Loss: 1.554 Vali Loss: 2.474 Vali Acc: 0.262 Test Loss: 2.474 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 142.1027054786682
Epoch: 7, Steps: 17 | Train Loss: 1.794 Vali Loss: 2.468 Vali Acc: 0.247 Test Loss: 2.468 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 144.2661168575287
Epoch: 8, Steps: 17 | Train Loss: 1.751 Vali Loss: 2.047 Vali Acc: 0.255 Test Loss: 2.047 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 136.58407282829285
Epoch: 9, Steps: 17 | Train Loss: 1.505 Vali Loss: 2.281 Vali Acc: 0.274 Test Loss: 2.281 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 139.27012372016907
Epoch: 10, Steps: 17 | Train Loss: 1.239 Vali Loss: 2.009 Vali Acc: 0.270 Test Loss: 2.009 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 127.01735472679138
Epoch: 11, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.137 Vali Acc: 0.262 Test Loss: 2.137 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 138.82665586471558
Epoch: 12, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.760 Vali Acc: 0.278 Test Loss: 2.760 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 129.2790503501892
Epoch: 13, Steps: 17 | Train Loss: 0.867 Vali Loss: 3.240 Vali Acc: 0.236 Test Loss: 3.240 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 138.01976037025452
Epoch: 14, Steps: 17 | Train Loss: 1.232 Vali Loss: 2.555 Vali Acc: 0.262 Test Loss: 2.555 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 131.71095323562622
Epoch: 15, Steps: 17 | Train Loss: 0.673 Vali Loss: 3.381 Vali Acc: 0.232 Test Loss: 3.381 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 38389636
model size : 148.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 50.07788062095642
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.843 Vali Acc: 0.262 Test Loss: 1.843 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 51.96562719345093
Epoch: 2, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.105 Vali Acc: 0.247 Test Loss: 2.105 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 45.758750438690186
Epoch: 3, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.912 Vali Acc: 0.259 Test Loss: 1.912 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 48.87582182884216
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 3.224 Vali Acc: 0.247 Test Loss: 3.224 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 45.79914474487305
Epoch: 5, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.850 Vali Acc: 0.274 Test Loss: 2.850 Test Acc: 0.274
Validation loss decreased (-0.262339 --> -0.273736).  Saving model ...
Epoch: 6 cost time: 46.52725553512573
Epoch: 6, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.238 Vali Acc: 0.243 Test Loss: 2.238 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 50.021034479141235
Epoch: 7, Steps: 17 | Train Loss: 1.613 Vali Loss: 2.709 Vali Acc: 0.232 Test Loss: 2.709 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 51.45884156227112
Epoch: 8, Steps: 17 | Train Loss: 1.711 Vali Loss: 2.639 Vali Acc: 0.281 Test Loss: 2.639 Test Acc: 0.281
Validation loss decreased (-0.273736 --> -0.281342).  Saving model ...
Epoch: 9 cost time: 51.09611439704895
Epoch: 9, Steps: 17 | Train Loss: 1.697 Vali Loss: 2.861 Vali Acc: 0.259 Test Loss: 2.861 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 50.86476707458496
Epoch: 10, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.874 Vali Acc: 0.232 Test Loss: 1.874 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 51.65378999710083
Epoch: 11, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.930 Vali Acc: 0.259 Test Loss: 1.930 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 49.74410629272461
Epoch: 12, Steps: 17 | Train Loss: 1.129 Vali Loss: 2.824 Vali Acc: 0.243 Test Loss: 2.824 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 51.77148914337158
Epoch: 13, Steps: 17 | Train Loss: 1.191 Vali Loss: 2.347 Vali Acc: 0.266 Test Loss: 2.347 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 48.8388352394104
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.409 Vali Acc: 0.259 Test Loss: 2.409 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 52.91986107826233
Epoch: 15, Steps: 17 | Train Loss: 0.922 Vali Loss: 2.798 Vali Acc: 0.255 Test Loss: 2.798 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 49.819415807724
Epoch: 16, Steps: 17 | Train Loss: 0.770 Vali Loss: 3.012 Vali Acc: 0.251 Test Loss: 3.012 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 53.34331488609314
Epoch: 17, Steps: 17 | Train Loss: 0.778 Vali Loss: 3.550 Vali Acc: 0.240 Test Loss: 3.550 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 50.387768030166626
Epoch: 18, Steps: 17 | Train Loss: 0.848 Vali Loss: 3.349 Vali Acc: 0.262 Test Loss: 3.349 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 11911556
model size : 47.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 83.36660981178284
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 2.700 Vali Acc: 0.255 Test Loss: 2.700 Test Acc: 0.255
Validation loss decreased (inf --> -0.254726).  Saving model ...
Epoch: 2 cost time: 81.83181548118591
Epoch: 2, Steps: 17 | Train Loss: 2.299 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
Validation loss decreased (-0.254726 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 83.96358895301819
Epoch: 3, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.551 Vali Acc: 0.228 Test Loss: 1.551 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 84.71264100074768
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.615 Vali Acc: 0.217 Test Loss: 1.615 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 84.31726360321045
Epoch: 5, Steps: 17 | Train Loss: 1.655 Vali Loss: 2.067 Vali Acc: 0.293 Test Loss: 2.067 Test Acc: 0.293
Validation loss decreased (-0.273747 --> -0.292755).  Saving model ...
Epoch: 6 cost time: 84.8663055896759
Epoch: 6, Steps: 17 | Train Loss: 1.554 Vali Loss: 2.470 Vali Acc: 0.266 Test Loss: 2.470 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 84.50575518608093
Epoch: 7, Steps: 17 | Train Loss: 1.793 Vali Loss: 2.469 Vali Acc: 0.247 Test Loss: 2.469 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 83.5642671585083
Epoch: 8, Steps: 17 | Train Loss: 1.753 Vali Loss: 2.039 Vali Acc: 0.259 Test Loss: 2.039 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 82.93350744247437
Epoch: 9, Steps: 17 | Train Loss: 1.509 Vali Loss: 2.278 Vali Acc: 0.266 Test Loss: 2.278 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 81.70001602172852
Epoch: 10, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.935 Vali Acc: 0.262 Test Loss: 1.935 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 83.68624877929688
Epoch: 11, Steps: 17 | Train Loss: 0.989 Vali Loss: 3.143 Vali Acc: 0.262 Test Loss: 3.143 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 84.77360916137695
Epoch: 12, Steps: 17 | Train Loss: 1.328 Vali Loss: 2.886 Vali Acc: 0.274 Test Loss: 2.886 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 80.95372128486633
Epoch: 13, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.751 Vali Acc: 0.281 Test Loss: 2.751 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 84.24736881256104
Epoch: 14, Steps: 17 | Train Loss: 0.998 Vali Loss: 3.063 Vali Acc: 0.247 Test Loss: 3.063 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 89.15788149833679
Epoch: 15, Steps: 17 | Train Loss: 0.621 Vali Loss: 2.789 Vali Acc: 0.255 Test Loss: 2.789 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 38389636
model size : 148.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 36.46923542022705
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.843 Vali Acc: 0.262 Test Loss: 1.843 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 34.79755759239197
Epoch: 2, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.105 Vali Acc: 0.247 Test Loss: 2.105 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 34.72233724594116
Epoch: 3, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.912 Vali Acc: 0.259 Test Loss: 1.912 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.05930256843567
Epoch: 4, Steps: 17 | Train Loss: 1.663 Vali Loss: 3.223 Vali Acc: 0.247 Test Loss: 3.223 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 33.63266921043396
Epoch: 5, Steps: 17 | Train Loss: 2.113 Vali Loss: 2.849 Vali Acc: 0.274 Test Loss: 2.849 Test Acc: 0.274
Validation loss decreased (-0.262339 --> -0.273736).  Saving model ...
Epoch: 6 cost time: 33.55238676071167
Epoch: 6, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.239 Vali Acc: 0.243 Test Loss: 2.239 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 33.53353452682495
Epoch: 7, Steps: 17 | Train Loss: 1.614 Vali Loss: 2.708 Vali Acc: 0.232 Test Loss: 2.708 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 31.002659559249878
Epoch: 8, Steps: 17 | Train Loss: 1.710 Vali Loss: 2.578 Vali Acc: 0.278 Test Loss: 2.578 Test Acc: 0.278
Validation loss decreased (-0.273736 --> -0.277541).  Saving model ...
Epoch: 9 cost time: 33.56068420410156
Epoch: 9, Steps: 17 | Train Loss: 1.718 Vali Loss: 2.676 Vali Acc: 0.266 Test Loss: 2.676 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 33.57315635681152
Epoch: 10, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.867 Vali Acc: 0.228 Test Loss: 1.867 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 33.104684352874756
Epoch: 11, Steps: 17 | Train Loss: 1.348 Vali Loss: 2.206 Vali Acc: 0.270 Test Loss: 2.206 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 32.03038835525513
Epoch: 12, Steps: 17 | Train Loss: 1.080 Vali Loss: 2.464 Vali Acc: 0.255 Test Loss: 2.464 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 33.858824729919434
Epoch: 13, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.531 Vali Acc: 0.236 Test Loss: 2.531 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 33.87429165840149
Epoch: 14, Steps: 17 | Train Loss: 1.082 Vali Loss: 3.107 Vali Acc: 0.259 Test Loss: 3.107 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 33.10260987281799
Epoch: 15, Steps: 17 | Train Loss: 0.929 Vali Loss: 2.542 Vali Acc: 0.247 Test Loss: 2.542 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 32.75890827178955
Epoch: 16, Steps: 17 | Train Loss: 0.724 Vali Loss: 3.049 Vali Acc: 0.217 Test Loss: 3.049 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 35.02231454849243
Epoch: 17, Steps: 17 | Train Loss: 0.854 Vali Loss: 3.211 Vali Acc: 0.247 Test Loss: 3.211 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 35.05366849899292
Epoch: 18, Steps: 17 | Train Loss: 1.100 Vali Loss: 3.302 Vali Acc: 0.243 Test Loss: 3.302 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 11911556
model size : 47.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 115.10804343223572
Epoch: 1, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.490 Vali Acc: 0.224 Test Loss: 1.490 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 112.0923719406128
Epoch: 2, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.724 Vali Acc: 0.278 Test Loss: 1.724 Test Acc: 0.278
Validation loss decreased (-0.224320 --> -0.277549).  Saving model ...
Epoch: 3 cost time: 110.33321380615234
Epoch: 3, Steps: 17 | Train Loss: 1.889 Vali Loss: 2.224 Vali Acc: 0.266 Test Loss: 2.224 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 115.34092402458191
Epoch: 4, Steps: 17 | Train Loss: 1.858 Vali Loss: 2.565 Vali Acc: 0.236 Test Loss: 2.565 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 115.35418391227722
Epoch: 5, Steps: 17 | Train Loss: 2.050 Vali Loss: 2.773 Vali Acc: 0.259 Test Loss: 2.773 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 109.57717204093933
Epoch: 6, Steps: 17 | Train Loss: 1.842 Vali Loss: 2.776 Vali Acc: 0.228 Test Loss: 2.776 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 111.37694382667542
Epoch: 7, Steps: 17 | Train Loss: 1.652 Vali Loss: 2.383 Vali Acc: 0.255 Test Loss: 2.383 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 115.61376547813416
Epoch: 8, Steps: 17 | Train Loss: 1.665 Vali Loss: 2.738 Vali Acc: 0.262 Test Loss: 2.738 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 114.97133255004883
Epoch: 9, Steps: 17 | Train Loss: 1.813 Vali Loss: 2.136 Vali Acc: 0.304 Test Loss: 2.136 Test Acc: 0.304
Validation loss decreased (-0.277549 --> -0.304161).  Saving model ...
Epoch: 10 cost time: 110.32558798789978
Epoch: 10, Steps: 17 | Train Loss: 1.515 Vali Loss: 2.102 Vali Acc: 0.266 Test Loss: 2.102 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 107.9392683506012
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 2.344 Vali Acc: 0.243 Test Loss: 2.344 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 111.35050201416016
Epoch: 12, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.475 Vali Acc: 0.247 Test Loss: 2.475 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 117.6720118522644
Epoch: 13, Steps: 17 | Train Loss: 1.056 Vali Loss: 3.145 Vali Acc: 0.255 Test Loss: 3.145 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 118.13018751144409
Epoch: 14, Steps: 17 | Train Loss: 1.083 Vali Loss: 2.971 Vali Acc: 0.259 Test Loss: 2.971 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 104.93411016464233
Epoch: 15, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.495 Vali Acc: 0.266 Test Loss: 2.495 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 104.17489767074585
Epoch: 16, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.924 Vali Acc: 0.266 Test Loss: 2.924 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 103.59765458106995
Epoch: 17, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.855 Vali Acc: 0.251 Test Loss: 2.855 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 103.34822654724121
Epoch: 18, Steps: 17 | Train Loss: 0.553 Vali Loss: 2.922 Vali Acc: 0.289 Test Loss: 2.922 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 102.60645699501038
Epoch: 19, Steps: 17 | Train Loss: 0.498 Vali Loss: 3.531 Vali Acc: 0.262 Test Loss: 3.531 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 19644804
model size : 77.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 42.723599672317505
Epoch: 1, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.655 Vali Acc: 0.236 Test Loss: 1.655 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 40.816246032714844
Epoch: 2, Steps: 17 | Train Loss: 1.984 Vali Loss: 3.699 Vali Acc: 0.251 Test Loss: 3.699 Test Acc: 0.251
Validation loss decreased (-0.235725 --> -0.250914).  Saving model ...
Epoch: 3 cost time: 42.2016167640686
Epoch: 3, Steps: 17 | Train Loss: 2.999 Vali Loss: 1.945 Vali Acc: 0.236 Test Loss: 1.945 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 42.71962308883667
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 3.468 Vali Acc: 0.262 Test Loss: 3.468 Test Acc: 0.262
Validation loss decreased (-0.250914 --> -0.262323).  Saving model ...
Epoch: 5 cost time: 39.96907138824463
Epoch: 5, Steps: 17 | Train Loss: 2.408 Vali Loss: 3.112 Vali Acc: 0.255 Test Loss: 3.112 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 42.89182758331299
Epoch: 6, Steps: 17 | Train Loss: 1.579 Vali Loss: 2.686 Vali Acc: 0.247 Test Loss: 2.686 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 40.5832884311676
Epoch: 7, Steps: 17 | Train Loss: 1.952 Vali Loss: 1.752 Vali Acc: 0.217 Test Loss: 1.752 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 38.4644341468811
Epoch: 8, Steps: 17 | Train Loss: 1.611 Vali Loss: 3.207 Vali Acc: 0.255 Test Loss: 3.207 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 40.050851583480835
Epoch: 9, Steps: 17 | Train Loss: 2.180 Vali Loss: 3.890 Vali Acc: 0.251 Test Loss: 3.890 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 38.30295920372009
Epoch: 10, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.932 Vali Acc: 0.243 Test Loss: 1.932 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 39.77636432647705
Epoch: 11, Steps: 17 | Train Loss: 1.327 Vali Loss: 3.259 Vali Acc: 0.236 Test Loss: 3.259 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 39.88931632041931
Epoch: 12, Steps: 17 | Train Loss: 1.712 Vali Loss: 2.782 Vali Acc: 0.259 Test Loss: 2.782 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 37.6732063293457
Epoch: 13, Steps: 17 | Train Loss: 1.153 Vali Loss: 2.110 Vali Acc: 0.247 Test Loss: 2.110 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 40.41564440727234
Epoch: 14, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.664 Vali Acc: 0.243 Test Loss: 2.664 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 6405508
model size : 26.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 80.9151611328125
Epoch: 1, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.490 Vali Acc: 0.224 Test Loss: 1.490 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 85.76949548721313
Epoch: 2, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.724 Vali Acc: 0.278 Test Loss: 1.724 Test Acc: 0.278
Validation loss decreased (-0.224320 --> -0.277549).  Saving model ...
Epoch: 3 cost time: 83.11639213562012
Epoch: 3, Steps: 17 | Train Loss: 1.889 Vali Loss: 2.224 Vali Acc: 0.266 Test Loss: 2.224 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 85.8141884803772
Epoch: 4, Steps: 17 | Train Loss: 1.858 Vali Loss: 2.565 Vali Acc: 0.236 Test Loss: 2.565 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 83.7407054901123
Epoch: 5, Steps: 17 | Train Loss: 2.050 Vali Loss: 2.773 Vali Acc: 0.259 Test Loss: 2.773 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 86.03688383102417
Epoch: 6, Steps: 17 | Train Loss: 1.842 Vali Loss: 2.776 Vali Acc: 0.228 Test Loss: 2.776 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 83.23409032821655
Epoch: 7, Steps: 17 | Train Loss: 1.652 Vali Loss: 2.381 Vali Acc: 0.255 Test Loss: 2.381 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 83.84341979026794
Epoch: 8, Steps: 17 | Train Loss: 1.664 Vali Loss: 2.739 Vali Acc: 0.266 Test Loss: 2.739 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 82.5904266834259
Epoch: 9, Steps: 17 | Train Loss: 1.816 Vali Loss: 2.142 Vali Acc: 0.300 Test Loss: 2.142 Test Acc: 0.300
Validation loss decreased (-0.277549 --> -0.300359).  Saving model ...
Epoch: 10 cost time: 82.09285521507263
Epoch: 10, Steps: 17 | Train Loss: 1.515 Vali Loss: 2.097 Vali Acc: 0.266 Test Loss: 2.097 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 85.40038347244263
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 2.342 Vali Acc: 0.243 Test Loss: 2.342 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 81.59489893913269
Epoch: 12, Steps: 17 | Train Loss: 1.142 Vali Loss: 2.462 Vali Acc: 0.255 Test Loss: 2.462 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 86.03507852554321
Epoch: 13, Steps: 17 | Train Loss: 1.068 Vali Loss: 3.232 Vali Acc: 0.259 Test Loss: 3.232 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 81.53087258338928
Epoch: 14, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.559 Vali Acc: 0.251 Test Loss: 2.559 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 83.17685723304749
Epoch: 15, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.999 Vali Acc: 0.247 Test Loss: 2.999 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 84.72871041297913
Epoch: 16, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.805 Vali Acc: 0.251 Test Loss: 2.805 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 85.4640052318573
Epoch: 17, Steps: 17 | Train Loss: 0.693 Vali Loss: 3.230 Vali Acc: 0.243 Test Loss: 3.230 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 85.31543254852295
Epoch: 18, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.870 Vali Acc: 0.289 Test Loss: 2.870 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 82.48949718475342
Epoch: 19, Steps: 17 | Train Loss: 0.619 Vali Loss: 3.960 Vali Acc: 0.251 Test Loss: 3.960 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 19644804
model size : 77.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 34.531758546829224
Epoch: 1, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.655 Vali Acc: 0.236 Test Loss: 1.655 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 32.815250635147095
Epoch: 2, Steps: 17 | Train Loss: 1.984 Vali Loss: 3.699 Vali Acc: 0.251 Test Loss: 3.699 Test Acc: 0.251
Validation loss decreased (-0.235725 --> -0.250914).  Saving model ...
Epoch: 3 cost time: 30.99131989479065
Epoch: 3, Steps: 17 | Train Loss: 2.999 Vali Loss: 1.945 Vali Acc: 0.236 Test Loss: 1.945 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.81928634643555
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 3.467 Vali Acc: 0.262 Test Loss: 3.467 Test Acc: 0.262
Validation loss decreased (-0.250914 --> -0.262323).  Saving model ...
Epoch: 5 cost time: 33.15467810630798
Epoch: 5, Steps: 17 | Train Loss: 2.408 Vali Loss: 3.113 Vali Acc: 0.259 Test Loss: 3.113 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.03301167488098
Epoch: 6, Steps: 17 | Train Loss: 1.580 Vali Loss: 2.701 Vali Acc: 0.247 Test Loss: 2.701 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 32.718162536621094
Epoch: 7, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.773 Vali Acc: 0.217 Test Loss: 1.773 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 31.30714774131775
Epoch: 8, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.801 Vali Acc: 0.247 Test Loss: 1.801 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 31.28633737564087
Epoch: 9, Steps: 17 | Train Loss: 1.421 Vali Loss: 2.486 Vali Acc: 0.243 Test Loss: 2.486 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 31.99089527130127
Epoch: 10, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.047 Vali Acc: 0.285 Test Loss: 2.047 Test Acc: 0.285
Validation loss decreased (-0.262323 --> -0.285151).  Saving model ...
Epoch: 11 cost time: 32.130298376083374
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 3.886 Vali Acc: 0.232 Test Loss: 3.886 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.12196373939514
Epoch: 12, Steps: 17 | Train Loss: 1.595 Vali Loss: 2.440 Vali Acc: 0.262 Test Loss: 2.440 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 31.880339860916138
Epoch: 13, Steps: 17 | Train Loss: 1.499 Vali Loss: 2.392 Vali Acc: 0.247 Test Loss: 2.392 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 30.29966950416565
Epoch: 14, Steps: 17 | Train Loss: 0.960 Vali Loss: 2.911 Vali Acc: 0.251 Test Loss: 2.911 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 33.01196503639221
Epoch: 15, Steps: 17 | Train Loss: 1.002 Vali Loss: 2.430 Vali Acc: 0.289 Test Loss: 2.430 Test Acc: 0.289
Validation loss decreased (-0.285151 --> -0.288949).  Saving model ...
Epoch: 16 cost time: 33.30669045448303
Epoch: 16, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.338 Vali Acc: 0.281 Test Loss: 2.338 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 32.86712718009949
Epoch: 17, Steps: 17 | Train Loss: 0.678 Vali Loss: 2.906 Vali Acc: 0.236 Test Loss: 2.906 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 33.19954466819763
Epoch: 18, Steps: 17 | Train Loss: 0.808 Vali Loss: 2.892 Vali Acc: 0.266 Test Loss: 2.892 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 31.529494047164917
Epoch: 19, Steps: 17 | Train Loss: 0.723 Vali Loss: 3.795 Vali Acc: 0.255 Test Loss: 3.795 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 32.65976405143738
Epoch: 20, Steps: 17 | Train Loss: 0.618 Vali Loss: 3.040 Vali Acc: 0.312 Test Loss: 3.040 Test Acc: 0.312
Validation loss decreased (-0.288949 --> -0.311757).  Saving model ...
Epoch: 21 cost time: 33.31312322616577
Epoch: 21, Steps: 17 | Train Loss: 0.449 Vali Loss: 4.027 Vali Acc: 0.300 Test Loss: 4.027 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 32.81718420982361
Epoch: 22, Steps: 17 | Train Loss: 0.355 Vali Loss: 3.839 Vali Acc: 0.266 Test Loss: 3.839 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 32.88732862472534
Epoch: 23, Steps: 17 | Train Loss: 0.419 Vali Loss: 4.373 Vali Acc: 0.270 Test Loss: 4.373 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 32.26676106452942
Epoch: 24, Steps: 17 | Train Loss: 0.382 Vali Loss: 3.844 Vali Acc: 0.251 Test Loss: 3.844 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 31.160134315490723
Epoch: 25, Steps: 17 | Train Loss: 0.251 Vali Loss: 4.357 Vali Acc: 0.289 Test Loss: 4.357 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 26.94044518470764
Epoch: 26, Steps: 17 | Train Loss: 0.132 Vali Loss: 4.588 Vali Acc: 0.240 Test Loss: 4.588 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 30.71676754951477
Epoch: 27, Steps: 17 | Train Loss: 0.306 Vali Loss: 5.320 Vali Acc: 0.224 Test Loss: 5.320 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 29.95879292488098
Epoch: 28, Steps: 17 | Train Loss: 0.142 Vali Loss: 5.302 Vali Acc: 0.224 Test Loss: 5.302 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 29.060065746307373
Epoch: 29, Steps: 17 | Train Loss: 0.188 Vali Loss: 5.336 Vali Acc: 0.289 Test Loss: 5.336 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 30.39057731628418
Epoch: 30, Steps: 17 | Train Loss: 0.229 Vali Loss: 5.439 Vali Acc: 0.259 Test Loss: 5.439 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 6405508
model size : 26.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 44.819700956344604
Epoch: 1, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.490 Vali Acc: 0.224 Test Loss: 1.490 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 46.528061628341675
Epoch: 2, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.724 Vali Acc: 0.278 Test Loss: 1.724 Test Acc: 0.278
Validation loss decreased (-0.224320 --> -0.277549).  Saving model ...
Epoch: 3 cost time: 44.77349591255188
Epoch: 3, Steps: 17 | Train Loss: 1.889 Vali Loss: 2.224 Vali Acc: 0.266 Test Loss: 2.224 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 46.47921538352966
Epoch: 4, Steps: 17 | Train Loss: 1.858 Vali Loss: 2.565 Vali Acc: 0.236 Test Loss: 2.565 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 46.0739049911499
Epoch: 5, Steps: 17 | Train Loss: 2.050 Vali Loss: 2.773 Vali Acc: 0.259 Test Loss: 2.773 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 45.17123198509216
Epoch: 6, Steps: 17 | Train Loss: 1.842 Vali Loss: 2.778 Vali Acc: 0.228 Test Loss: 2.778 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 46.71816325187683
Epoch: 7, Steps: 17 | Train Loss: 1.652 Vali Loss: 2.394 Vali Acc: 0.255 Test Loss: 2.394 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.28643274307251
Epoch: 8, Steps: 17 | Train Loss: 1.668 Vali Loss: 2.736 Vali Acc: 0.262 Test Loss: 2.736 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 48.60611152648926
Epoch: 9, Steps: 17 | Train Loss: 1.799 Vali Loss: 2.105 Vali Acc: 0.285 Test Loss: 2.105 Test Acc: 0.285
Validation loss decreased (-0.277549 --> -0.285150).  Saving model ...
Epoch: 10 cost time: 45.37585234642029
Epoch: 10, Steps: 17 | Train Loss: 1.517 Vali Loss: 2.121 Vali Acc: 0.262 Test Loss: 2.121 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 49.4785635471344
Epoch: 11, Steps: 17 | Train Loss: 1.348 Vali Loss: 2.303 Vali Acc: 0.255 Test Loss: 2.303 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 44.65933680534363
Epoch: 12, Steps: 17 | Train Loss: 1.158 Vali Loss: 2.436 Vali Acc: 0.251 Test Loss: 2.436 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 47.866538286209106
Epoch: 13, Steps: 17 | Train Loss: 1.045 Vali Loss: 3.048 Vali Acc: 0.259 Test Loss: 3.048 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 46.50618243217468
Epoch: 14, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.758 Vali Acc: 0.247 Test Loss: 2.758 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 46.06463861465454
Epoch: 15, Steps: 17 | Train Loss: 0.904 Vali Loss: 3.223 Vali Acc: 0.262 Test Loss: 3.223 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 46.41139054298401
Epoch: 16, Steps: 17 | Train Loss: 0.987 Vali Loss: 2.608 Vali Acc: 0.255 Test Loss: 2.608 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 44.84116268157959
Epoch: 17, Steps: 17 | Train Loss: 0.688 Vali Loss: 2.618 Vali Acc: 0.236 Test Loss: 2.618 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 46.453835248947144
Epoch: 18, Steps: 17 | Train Loss: 0.621 Vali Loss: 3.332 Vali Acc: 0.240 Test Loss: 3.332 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 43.46215271949768
Epoch: 19, Steps: 17 | Train Loss: 0.756 Vali Loss: 3.602 Vali Acc: 0.270 Test Loss: 3.602 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 19644804
model size : 77.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.885291814804077
Epoch: 1, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.655 Vali Acc: 0.236 Test Loss: 1.655 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 18.630420923233032
Epoch: 2, Steps: 17 | Train Loss: 1.984 Vali Loss: 3.699 Vali Acc: 0.251 Test Loss: 3.699 Test Acc: 0.251
Validation loss decreased (-0.235725 --> -0.250914).  Saving model ...
Epoch: 3 cost time: 18.01312804222107
Epoch: 3, Steps: 17 | Train Loss: 2.999 Vali Loss: 1.945 Vali Acc: 0.236 Test Loss: 1.945 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.308469772338867
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 3.467 Vali Acc: 0.262 Test Loss: 3.467 Test Acc: 0.262
Validation loss decreased (-0.250914 --> -0.262323).  Saving model ...
Epoch: 5 cost time: 19.449356079101562
Epoch: 5, Steps: 17 | Train Loss: 2.408 Vali Loss: 3.112 Vali Acc: 0.255 Test Loss: 3.112 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.008440732955933
Epoch: 6, Steps: 17 | Train Loss: 1.580 Vali Loss: 2.699 Vali Acc: 0.247 Test Loss: 2.699 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.80248737335205
Epoch: 7, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.765 Vali Acc: 0.224 Test Loss: 1.765 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.594921588897705
Epoch: 8, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.863 Vali Acc: 0.232 Test Loss: 1.863 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.035274505615234
Epoch: 9, Steps: 17 | Train Loss: 1.496 Vali Loss: 3.076 Vali Acc: 0.255 Test Loss: 3.076 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.98027205467224
Epoch: 10, Steps: 17 | Train Loss: 1.538 Vali Loss: 2.157 Vali Acc: 0.270 Test Loss: 2.157 Test Acc: 0.270
Validation loss decreased (-0.262323 --> -0.269940).  Saving model ...
Epoch: 11 cost time: 18.99588656425476
Epoch: 11, Steps: 17 | Train Loss: 1.201 Vali Loss: 2.162 Vali Acc: 0.209 Test Loss: 2.162 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.713741302490234
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 3.346 Vali Acc: 0.255 Test Loss: 3.346 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.804826021194458
Epoch: 13, Steps: 17 | Train Loss: 1.271 Vali Loss: 3.009 Vali Acc: 0.243 Test Loss: 3.009 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.871010780334473
Epoch: 14, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.393 Vali Acc: 0.259 Test Loss: 2.393 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.94397783279419
Epoch: 15, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.369 Vali Acc: 0.270 Test Loss: 2.369 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.924630403518677
Epoch: 16, Steps: 17 | Train Loss: 0.763 Vali Loss: 2.699 Vali Acc: 0.224 Test Loss: 2.699 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.683005809783936
Epoch: 17, Steps: 17 | Train Loss: 0.663 Vali Loss: 3.192 Vali Acc: 0.247 Test Loss: 3.192 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.882161378860474
Epoch: 18, Steps: 17 | Train Loss: 0.620 Vali Loss: 5.151 Vali Acc: 0.247 Test Loss: 5.151 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 18.98559069633484
Epoch: 19, Steps: 17 | Train Loss: 0.873 Vali Loss: 3.484 Vali Acc: 0.251 Test Loss: 3.484 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 20.802873134613037
Epoch: 20, Steps: 17 | Train Loss: 0.613 Vali Loss: 3.445 Vali Acc: 0.285 Test Loss: 3.445 Test Acc: 0.285
Validation loss decreased (-0.269940 --> -0.285137).  Saving model ...
Epoch: 21 cost time: 19.333713054656982
Epoch: 21, Steps: 17 | Train Loss: 0.456 Vali Loss: 3.686 Vali Acc: 0.289 Test Loss: 3.686 Test Acc: 0.289
Validation loss decreased (-0.285137 --> -0.288937).  Saving model ...
Epoch: 22 cost time: 20.40009880065918
Epoch: 22, Steps: 17 | Train Loss: 0.406 Vali Loss: 3.905 Vali Acc: 0.255 Test Loss: 3.905 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 18.588263034820557
Epoch: 23, Steps: 17 | Train Loss: 0.450 Vali Loss: 4.557 Vali Acc: 0.270 Test Loss: 4.557 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 20.331406116485596
Epoch: 24, Steps: 17 | Train Loss: 0.374 Vali Loss: 4.827 Vali Acc: 0.247 Test Loss: 4.827 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 20.344335317611694
Epoch: 25, Steps: 17 | Train Loss: 0.215 Vali Loss: 4.436 Vali Acc: 0.262 Test Loss: 4.436 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 20.361651182174683
Epoch: 26, Steps: 17 | Train Loss: 0.184 Vali Loss: 4.785 Vali Acc: 0.262 Test Loss: 4.785 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 18.55434823036194
Epoch: 27, Steps: 17 | Train Loss: 0.434 Vali Loss: 4.514 Vali Acc: 0.217 Test Loss: 4.514 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 15.422755002975464
Epoch: 28, Steps: 17 | Train Loss: 0.221 Vali Loss: 4.900 Vali Acc: 0.259 Test Loss: 4.900 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 18.70776605606079
Epoch: 29, Steps: 17 | Train Loss: 0.186 Vali Loss: 4.796 Vali Acc: 0.251 Test Loss: 4.796 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 18.60406494140625
Epoch: 30, Steps: 17 | Train Loss: 0.125 Vali Loss: 4.677 Vali Acc: 0.255 Test Loss: 4.677 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 6405508
model size : 26.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 120.8418800830841
Epoch: 1, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.675 Vali Acc: 0.251 Test Loss: 1.675 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 115.49141788482666
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 2.180 Vali Acc: 0.243 Test Loss: 2.180 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 118.67502880096436
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.908 Vali Acc: 0.293 Test Loss: 1.908 Test Acc: 0.293
Validation loss decreased (-0.250934 --> -0.292757).  Saving model ...
Epoch: 4 cost time: 123.5008897781372
Epoch: 4, Steps: 17 | Train Loss: 1.550 Vali Loss: 2.042 Vali Acc: 0.259 Test Loss: 2.042 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 125.7570071220398
Epoch: 5, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 123.47622561454773
Epoch: 6, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.492 Vali Acc: 0.278 Test Loss: 1.492 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 126.22627639770508
Epoch: 7, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.605 Vali Acc: 0.270 Test Loss: 1.605 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 124.17085909843445
Epoch: 8, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.934 Vali Acc: 0.251 Test Loss: 1.934 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 125.02562522888184
Epoch: 9, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 127.95448970794678
Epoch: 10, Steps: 17 | Train Loss: 1.435 Vali Loss: 2.232 Vali Acc: 0.259 Test Loss: 2.232 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 126.49653196334839
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.870 Vali Acc: 0.270 Test Loss: 1.870 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 127.69869351387024
Epoch: 12, Steps: 17 | Train Loss: 1.039 Vali Loss: 2.079 Vali Acc: 0.255 Test Loss: 2.079 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 124.48102903366089
Epoch: 13, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.160 Vali Acc: 0.266 Test Loss: 2.160 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 19196356
model size : 74.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 49.51842260360718
Epoch: 1, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.590 Vali Acc: 0.247 Test Loss: 1.590 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 47.32863402366638
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 44.63555335998535
Epoch: 3, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.801 Vali Acc: 0.251 Test Loss: 1.801 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 45.6944305896759
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.965 Vali Acc: 0.247 Test Loss: 1.965 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 46.28429698944092
Epoch: 5, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.889 Vali Acc: 0.247 Test Loss: 1.889 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 43.092485427856445
Epoch: 6, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.866 Vali Acc: 0.236 Test Loss: 1.866 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 46.99041748046875
Epoch: 7, Steps: 17 | Train Loss: 1.685 Vali Loss: 2.086 Vali Acc: 0.251 Test Loss: 2.086 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 47.47499990463257
Epoch: 8, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.951 Vali Acc: 0.266 Test Loss: 1.951 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266140).  Saving model ...
Epoch: 9 cost time: 45.07068109512329
Epoch: 9, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.957 Vali Acc: 0.251 Test Loss: 1.957 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 48.64840865135193
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.729 Vali Acc: 0.251 Test Loss: 1.729 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 48.952170610427856
Epoch: 11, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.180 Vali Acc: 0.232 Test Loss: 2.180 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 45.01508831977844
Epoch: 12, Steps: 17 | Train Loss: 1.325 Vali Loss: 2.031 Vali Acc: 0.251 Test Loss: 2.031 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 44.50049352645874
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.814 Vali Acc: 0.308 Test Loss: 1.814 Test Acc: 0.308
Validation loss decreased (-0.266140 --> -0.307967).  Saving model ...
Epoch: 14 cost time: 41.49759888648987
Epoch: 14, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.987 Vali Acc: 0.259 Test Loss: 1.987 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 42.68072056770325
Epoch: 15, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.332 Vali Acc: 0.259 Test Loss: 2.332 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 43.71571922302246
Epoch: 16, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.220 Vali Acc: 0.247 Test Loss: 2.220 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 39.6372606754303
Epoch: 17, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.511 Vali Acc: 0.247 Test Loss: 2.511 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 43.25471019744873
Epoch: 18, Steps: 17 | Train Loss: 0.688 Vali Loss: 2.604 Vali Acc: 0.259 Test Loss: 2.604 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 43.33935880661011
Epoch: 19, Steps: 17 | Train Loss: 0.669 Vali Loss: 2.664 Vali Acc: 0.240 Test Loss: 2.664 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 41.48285365104675
Epoch: 20, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.556 Vali Acc: 0.240 Test Loss: 2.556 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 43.678258657455444
Epoch: 21, Steps: 17 | Train Loss: 0.473 Vali Loss: 3.250 Vali Acc: 0.278 Test Loss: 3.250 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 42.15789842605591
Epoch: 22, Steps: 17 | Train Loss: 0.499 Vali Loss: 3.696 Vali Acc: 0.259 Test Loss: 3.696 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 40.20385956764221
Epoch: 23, Steps: 17 | Train Loss: 0.554 Vali Loss: 3.058 Vali Acc: 0.228 Test Loss: 3.058 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 5956804
model size : 23.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 80.16640019416809
Epoch: 1, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.675 Vali Acc: 0.251 Test Loss: 1.675 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 79.75924873352051
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 2.180 Vali Acc: 0.243 Test Loss: 2.180 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 81.042964220047
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.908 Vali Acc: 0.293 Test Loss: 1.908 Test Acc: 0.293
Validation loss decreased (-0.250934 --> -0.292757).  Saving model ...
Epoch: 4 cost time: 88.90890192985535
Epoch: 4, Steps: 17 | Train Loss: 1.550 Vali Loss: 2.042 Vali Acc: 0.259 Test Loss: 2.042 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 86.51268315315247
Epoch: 5, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 83.06905889511108
Epoch: 6, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.492 Vali Acc: 0.278 Test Loss: 1.492 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 81.1558289527893
Epoch: 7, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.605 Vali Acc: 0.270 Test Loss: 1.605 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 81.6043152809143
Epoch: 8, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.934 Vali Acc: 0.251 Test Loss: 1.934 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 83.42763781547546
Epoch: 9, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 87.31788682937622
Epoch: 10, Steps: 17 | Train Loss: 1.435 Vali Loss: 2.232 Vali Acc: 0.259 Test Loss: 2.232 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 85.16363787651062
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.870 Vali Acc: 0.270 Test Loss: 1.870 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 85.64733362197876
Epoch: 12, Steps: 17 | Train Loss: 1.039 Vali Loss: 2.079 Vali Acc: 0.255 Test Loss: 2.079 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 86.89999842643738
Epoch: 13, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.159 Vali Acc: 0.266 Test Loss: 2.159 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 19196356
model size : 74.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 36.58307957649231
Epoch: 1, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.590 Vali Acc: 0.247 Test Loss: 1.590 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 34.92406415939331
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 32.845223903656006
Epoch: 3, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.801 Vali Acc: 0.251 Test Loss: 1.801 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.127182960510254
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.965 Vali Acc: 0.247 Test Loss: 1.965 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 31.8923761844635
Epoch: 5, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.889 Vali Acc: 0.247 Test Loss: 1.889 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 33.58246850967407
Epoch: 6, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.866 Vali Acc: 0.236 Test Loss: 1.866 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 33.41850399971008
Epoch: 7, Steps: 17 | Train Loss: 1.685 Vali Loss: 2.086 Vali Acc: 0.251 Test Loss: 2.086 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.227814435958862
Epoch: 8, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.951 Vali Acc: 0.266 Test Loss: 1.951 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266140).  Saving model ...
Epoch: 9 cost time: 33.629841804504395
Epoch: 9, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.958 Vali Acc: 0.247 Test Loss: 1.958 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 32.28431725502014
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.728 Vali Acc: 0.247 Test Loss: 1.728 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 33.71685791015625
Epoch: 11, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.181 Vali Acc: 0.232 Test Loss: 2.181 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 34.93092226982117
Epoch: 12, Steps: 17 | Train Loss: 1.325 Vali Loss: 2.032 Vali Acc: 0.251 Test Loss: 2.032 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 32.618820905685425
Epoch: 13, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.815 Vali Acc: 0.308 Test Loss: 1.815 Test Acc: 0.308
Validation loss decreased (-0.266140 --> -0.307967).  Saving model ...
Epoch: 14 cost time: 34.750675201416016
Epoch: 14, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.985 Vali Acc: 0.259 Test Loss: 1.985 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 33.24888229370117
Epoch: 15, Steps: 17 | Train Loss: 0.896 Vali Loss: 2.336 Vali Acc: 0.259 Test Loss: 2.336 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 34.902835845947266
Epoch: 16, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.226 Vali Acc: 0.243 Test Loss: 2.226 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 33.877448081970215
Epoch: 17, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.504 Vali Acc: 0.251 Test Loss: 2.504 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 30.882427215576172
Epoch: 18, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.602 Vali Acc: 0.262 Test Loss: 2.602 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 33.483118534088135
Epoch: 19, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.646 Vali Acc: 0.221 Test Loss: 2.646 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 32.10129952430725
Epoch: 20, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.768 Vali Acc: 0.236 Test Loss: 2.768 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 33.53631114959717
Epoch: 21, Steps: 17 | Train Loss: 0.474 Vali Loss: 3.377 Vali Acc: 0.274 Test Loss: 3.377 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 34.45532202720642
Epoch: 22, Steps: 17 | Train Loss: 0.502 Vali Loss: 3.267 Vali Acc: 0.255 Test Loss: 3.267 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 32.19738984107971
Epoch: 23, Steps: 17 | Train Loss: 0.381 Vali Loss: 3.359 Vali Acc: 0.228 Test Loss: 3.359 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 5956804
model size : 23.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 57.397016525268555
Epoch: 1, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.675 Vali Acc: 0.251 Test Loss: 1.675 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 56.23803424835205
Epoch: 2, Steps: 17 | Train Loss: 1.465 Vali Loss: 2.180 Vali Acc: 0.243 Test Loss: 2.180 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.681949615478516
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.908 Vali Acc: 0.293 Test Loss: 1.908 Test Acc: 0.293
Validation loss decreased (-0.250934 --> -0.292757).  Saving model ...
Epoch: 4 cost time: 52.4522225856781
Epoch: 4, Steps: 17 | Train Loss: 1.550 Vali Loss: 2.042 Vali Acc: 0.259 Test Loss: 2.042 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.54592537879944
Epoch: 5, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 45.757720947265625
Epoch: 6, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.492 Vali Acc: 0.278 Test Loss: 1.492 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 45.904019355773926
Epoch: 7, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.605 Vali Acc: 0.270 Test Loss: 1.605 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 46.14844536781311
Epoch: 8, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.934 Vali Acc: 0.251 Test Loss: 1.934 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 47.14737105369568
Epoch: 9, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.791 Vali Acc: 0.266 Test Loss: 1.791 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 47.878692865371704
Epoch: 10, Steps: 17 | Train Loss: 1.435 Vali Loss: 2.232 Vali Acc: 0.259 Test Loss: 2.232 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 48.09829068183899
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.870 Vali Acc: 0.270 Test Loss: 1.870 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 46.88758182525635
Epoch: 12, Steps: 17 | Train Loss: 1.039 Vali Loss: 2.079 Vali Acc: 0.255 Test Loss: 2.079 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 47.3150839805603
Epoch: 13, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.159 Vali Acc: 0.266 Test Loss: 2.159 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 19196356
model size : 74.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.909308195114136
Epoch: 1, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.590 Vali Acc: 0.247 Test Loss: 1.590 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 18.40478491783142
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.543 Vali Acc: 0.262 Test Loss: 1.543 Test Acc: 0.262
Validation loss decreased (-0.247132 --> -0.262342).  Saving model ...
Epoch: 3 cost time: 19.97051763534546
Epoch: 3, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.801 Vali Acc: 0.251 Test Loss: 1.801 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.257685661315918
Epoch: 4, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.965 Vali Acc: 0.247 Test Loss: 1.965 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.187501907348633
Epoch: 5, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.889 Vali Acc: 0.247 Test Loss: 1.889 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.141441106796265
Epoch: 6, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.866 Vali Acc: 0.236 Test Loss: 1.866 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.249009609222412
Epoch: 7, Steps: 17 | Train Loss: 1.685 Vali Loss: 2.086 Vali Acc: 0.251 Test Loss: 2.086 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.543447494506836
Epoch: 8, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.951 Vali Acc: 0.266 Test Loss: 1.951 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266140).  Saving model ...
Epoch: 9 cost time: 19.82183265686035
Epoch: 9, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.957 Vali Acc: 0.247 Test Loss: 1.957 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.38680338859558
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.729 Vali Acc: 0.251 Test Loss: 1.729 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.341580629348755
Epoch: 11, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.181 Vali Acc: 0.232 Test Loss: 2.181 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.87986660003662
Epoch: 12, Steps: 17 | Train Loss: 1.325 Vali Loss: 2.031 Vali Acc: 0.251 Test Loss: 2.031 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.16663932800293
Epoch: 13, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.814 Vali Acc: 0.308 Test Loss: 1.814 Test Acc: 0.308
Validation loss decreased (-0.266140 --> -0.307967).  Saving model ...
Epoch: 14 cost time: 19.957775354385376
Epoch: 14, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.987 Vali Acc: 0.259 Test Loss: 1.987 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.47190809249878
Epoch: 15, Steps: 17 | Train Loss: 0.896 Vali Loss: 2.332 Vali Acc: 0.259 Test Loss: 2.332 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 19.4612238407135
Epoch: 16, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.219 Vali Acc: 0.247 Test Loss: 2.219 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 19.217395782470703
Epoch: 17, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.512 Vali Acc: 0.247 Test Loss: 2.512 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.8918673992157
Epoch: 18, Steps: 17 | Train Loss: 0.688 Vali Loss: 2.602 Vali Acc: 0.259 Test Loss: 2.602 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.32540726661682
Epoch: 19, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.682 Vali Acc: 0.247 Test Loss: 2.682 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 18.011440753936768
Epoch: 20, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.540 Vali Acc: 0.255 Test Loss: 2.540 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 19.327142238616943
Epoch: 21, Steps: 17 | Train Loss: 0.469 Vali Loss: 3.178 Vali Acc: 0.266 Test Loss: 3.178 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.694132328033447
Epoch: 22, Steps: 17 | Train Loss: 0.507 Vali Loss: 3.654 Vali Acc: 0.259 Test Loss: 3.654 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 16.109400272369385
Epoch: 23, Steps: 17 | Train Loss: 0.548 Vali Loss: 3.061 Vali Acc: 0.228 Test Loss: 3.061 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 5956804
model size : 23.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 69.0230028629303
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 65.15915179252625
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 2.009 Vali Acc: 0.247 Test Loss: 2.009 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 70.15058779716492
Epoch: 3, Steps: 17 | Train Loss: 1.593 Vali Loss: 2.210 Vali Acc: 0.259 Test Loss: 2.210 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 64.8652651309967
Epoch: 4, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.819 Vali Acc: 0.251 Test Loss: 1.819 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 69.01714587211609
Epoch: 5, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.691 Vali Acc: 0.236 Test Loss: 1.691 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 70.07298302650452
Epoch: 6, Steps: 17 | Train Loss: 1.451 Vali Loss: 2.120 Vali Acc: 0.255 Test Loss: 2.120 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 69.81665325164795
Epoch: 7, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.789 Vali Acc: 0.266 Test Loss: 1.789 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 72.21512913703918
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 2.685 Vali Acc: 0.270 Test Loss: 2.685 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 68.0038206577301
Epoch: 9, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.822 Vali Acc: 0.236 Test Loss: 1.822 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 71.68172240257263
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.696 Vali Acc: 0.278 Test Loss: 1.696 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 11 cost time: 65.32441806793213
Epoch: 11, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.508 Vali Acc: 0.262 Test Loss: 2.508 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 69.57394981384277
Epoch: 12, Steps: 17 | Train Loss: 1.254 Vali Loss: 2.254 Vali Acc: 0.228 Test Loss: 2.254 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 64.87955951690674
Epoch: 13, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.953 Vali Acc: 0.259 Test Loss: 1.953 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 69.07219862937927
Epoch: 14, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.650 Vali Acc: 0.259 Test Loss: 2.650 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 67.5470597743988
Epoch: 15, Steps: 17 | Train Loss: 0.939 Vali Loss: 2.502 Vali Acc: 0.255 Test Loss: 2.502 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 71.48630928993225
Epoch: 16, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.348 Vali Acc: 0.221 Test Loss: 2.348 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 69.20629262924194
Epoch: 17, Steps: 17 | Train Loss: 0.734 Vali Loss: 2.563 Vali Acc: 0.274 Test Loss: 2.563 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 69.26020097732544
Epoch: 18, Steps: 17 | Train Loss: 0.645 Vali Loss: 3.185 Vali Acc: 0.255 Test Loss: 3.185 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 71.68212103843689
Epoch: 19, Steps: 17 | Train Loss: 0.697 Vali Loss: 2.690 Vali Acc: 0.243 Test Loss: 2.690 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 70.34616136550903
Epoch: 20, Steps: 17 | Train Loss: 0.575 Vali Loss: 3.154 Vali Acc: 0.251 Test Loss: 3.154 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 9823172
model size : 38.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 28.347278118133545
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.732 Vali Acc: 0.266 Test Loss: 1.732 Test Acc: 0.266
Validation loss decreased (inf --> -0.266142).  Saving model ...
Epoch: 2 cost time: 26.569446563720703
Epoch: 2, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.998 Vali Acc: 0.259 Test Loss: 1.998 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.648387908935547
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 2.197 Vali Acc: 0.274 Test Loss: 2.197 Test Acc: 0.274
Validation loss decreased (-0.266142 --> -0.273742).  Saving model ...
Epoch: 4 cost time: 24.214119911193848
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.645 Vali Acc: 0.270 Test Loss: 1.645 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.163838863372803
Epoch: 5, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.17721462249756
Epoch: 6, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.744 Vali Acc: 0.236 Test Loss: 1.744 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.18810749053955
Epoch: 7, Steps: 17 | Train Loss: 1.511 Vali Loss: 2.649 Vali Acc: 0.236 Test Loss: 2.649 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 25.290183544158936
Epoch: 8, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.837 Vali Acc: 0.270 Test Loss: 1.837 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.655519008636475
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 2.241 Vali Acc: 0.262 Test Loss: 2.241 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 25.33019781112671
Epoch: 10, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.819 Vali Acc: 0.243 Test Loss: 1.819 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.649445295333862
Epoch: 11, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.827 Vali Acc: 0.255 Test Loss: 1.827 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 22.823923587799072
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.748 Vali Acc: 0.281 Test Loss: 1.748 Test Acc: 0.281
Validation loss decreased (-0.273742 --> -0.281351).  Saving model ...
Epoch: 13 cost time: 24.558040142059326
Epoch: 13, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.295 Vali Acc: 0.259 Test Loss: 2.295 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.48109006881714
Epoch: 14, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.011 Vali Acc: 0.285 Test Loss: 2.011 Test Acc: 0.285
Validation loss decreased (-0.281351 --> -0.285151).  Saving model ...
Epoch: 15 cost time: 24.416038274765015
Epoch: 15, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.391 Vali Acc: 0.232 Test Loss: 2.391 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 24.62390112876892
Epoch: 16, Steps: 17 | Train Loss: 0.995 Vali Loss: 2.606 Vali Acc: 0.262 Test Loss: 2.606 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.859158039093018
Epoch: 17, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.594 Vali Acc: 0.217 Test Loss: 2.594 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 24.82516837120056
Epoch: 18, Steps: 17 | Train Loss: 0.717 Vali Loss: 2.781 Vali Acc: 0.255 Test Loss: 2.781 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.91801643371582
Epoch: 19, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.653 Vali Acc: 0.262 Test Loss: 2.653 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 24.548208475112915
Epoch: 20, Steps: 17 | Train Loss: 0.542 Vali Loss: 2.890 Vali Acc: 0.270 Test Loss: 2.890 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.447346210479736
Epoch: 21, Steps: 17 | Train Loss: 0.671 Vali Loss: 3.300 Vali Acc: 0.262 Test Loss: 3.300 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 24.880993843078613
Epoch: 22, Steps: 17 | Train Loss: 0.445 Vali Loss: 3.324 Vali Acc: 0.232 Test Loss: 3.324 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 25.83382534980774
Epoch: 23, Steps: 17 | Train Loss: 0.380 Vali Loss: 4.877 Vali Acc: 0.224 Test Loss: 4.877 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 23.45742893218994
Epoch: 24, Steps: 17 | Train Loss: 0.881 Vali Loss: 3.692 Vali Acc: 0.228 Test Loss: 3.692 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3203268
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 46.59764814376831
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 46.7428994178772
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 2.009 Vali Acc: 0.247 Test Loss: 2.009 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 45.80873227119446
Epoch: 3, Steps: 17 | Train Loss: 1.593 Vali Loss: 2.210 Vali Acc: 0.259 Test Loss: 2.210 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 42.628286600112915
Epoch: 4, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.819 Vali Acc: 0.251 Test Loss: 1.819 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 44.40099334716797
Epoch: 5, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.691 Vali Acc: 0.236 Test Loss: 1.691 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 45.78276014328003
Epoch: 6, Steps: 17 | Train Loss: 1.451 Vali Loss: 2.120 Vali Acc: 0.255 Test Loss: 2.120 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 44.51236701011658
Epoch: 7, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.789 Vali Acc: 0.266 Test Loss: 1.789 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 44.13264083862305
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 2.685 Vali Acc: 0.270 Test Loss: 2.685 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 47.749212980270386
Epoch: 9, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.821 Vali Acc: 0.236 Test Loss: 1.821 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 46.11627793312073
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.696 Vali Acc: 0.278 Test Loss: 1.696 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 11 cost time: 47.059457302093506
Epoch: 11, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.504 Vali Acc: 0.262 Test Loss: 2.504 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 45.57713580131531
Epoch: 12, Steps: 17 | Train Loss: 1.254 Vali Loss: 2.252 Vali Acc: 0.228 Test Loss: 2.252 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 47.289204597473145
Epoch: 13, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.956 Vali Acc: 0.251 Test Loss: 1.956 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 45.726529359817505
Epoch: 14, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.673 Vali Acc: 0.259 Test Loss: 2.673 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 47.63137602806091
Epoch: 15, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.523 Vali Acc: 0.278 Test Loss: 2.523 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 45.767059087753296
Epoch: 16, Steps: 17 | Train Loss: 0.869 Vali Loss: 2.325 Vali Acc: 0.217 Test Loss: 2.325 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 50.99217867851257
Epoch: 17, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.589 Vali Acc: 0.278 Test Loss: 2.589 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 47.031572341918945
Epoch: 18, Steps: 17 | Train Loss: 0.641 Vali Loss: 3.174 Vali Acc: 0.247 Test Loss: 3.174 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 51.08655309677124
Epoch: 19, Steps: 17 | Train Loss: 0.680 Vali Loss: 2.694 Vali Acc: 0.247 Test Loss: 2.694 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 46.037145137786865
Epoch: 20, Steps: 17 | Train Loss: 0.581 Vali Loss: 3.103 Vali Acc: 0.255 Test Loss: 3.103 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 9823172
model size : 38.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 20.236515760421753
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.732 Vali Acc: 0.266 Test Loss: 1.732 Test Acc: 0.266
Validation loss decreased (inf --> -0.266142).  Saving model ...
Epoch: 2 cost time: 18.199087858200073
Epoch: 2, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.998 Vali Acc: 0.259 Test Loss: 1.998 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.76390051841736
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 2.197 Vali Acc: 0.274 Test Loss: 2.197 Test Acc: 0.274
Validation loss decreased (-0.266142 --> -0.273742).  Saving model ...
Epoch: 4 cost time: 18.995487213134766
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.645 Vali Acc: 0.270 Test Loss: 1.645 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.26232600212097
Epoch: 5, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.21053194999695
Epoch: 6, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.744 Vali Acc: 0.236 Test Loss: 1.744 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.4111590385437
Epoch: 7, Steps: 17 | Train Loss: 1.511 Vali Loss: 2.649 Vali Acc: 0.236 Test Loss: 2.649 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.273723363876343
Epoch: 8, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.837 Vali Acc: 0.270 Test Loss: 1.837 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.02186894416809
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 2.241 Vali Acc: 0.262 Test Loss: 2.241 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.643977403640747
Epoch: 10, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.819 Vali Acc: 0.243 Test Loss: 1.819 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 18.24855327606201
Epoch: 11, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.827 Vali Acc: 0.255 Test Loss: 1.827 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 18.86703896522522
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.748 Vali Acc: 0.281 Test Loss: 1.748 Test Acc: 0.281
Validation loss decreased (-0.273742 --> -0.281351).  Saving model ...
Epoch: 13 cost time: 19.232933521270752
Epoch: 13, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.294 Vali Acc: 0.259 Test Loss: 2.294 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.28990411758423
Epoch: 14, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.013 Vali Acc: 0.293 Test Loss: 2.013 Test Acc: 0.293
Validation loss decreased (-0.281351 --> -0.292756).  Saving model ...
Epoch: 15 cost time: 19.454535007476807
Epoch: 15, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.395 Vali Acc: 0.236 Test Loss: 2.395 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.630077123641968
Epoch: 16, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.608 Vali Acc: 0.270 Test Loss: 2.608 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.216453313827515
Epoch: 17, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.588 Vali Acc: 0.217 Test Loss: 2.588 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.011480808258057
Epoch: 18, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.692 Vali Acc: 0.247 Test Loss: 2.692 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 19.02827024459839
Epoch: 19, Steps: 17 | Train Loss: 0.561 Vali Loss: 2.628 Vali Acc: 0.247 Test Loss: 2.628 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.277311086654663
Epoch: 20, Steps: 17 | Train Loss: 0.548 Vali Loss: 3.010 Vali Acc: 0.259 Test Loss: 3.010 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 18.814953088760376
Epoch: 21, Steps: 17 | Train Loss: 0.684 Vali Loss: 3.156 Vali Acc: 0.243 Test Loss: 3.156 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 19.29593515396118
Epoch: 22, Steps: 17 | Train Loss: 0.437 Vali Loss: 3.284 Vali Acc: 0.221 Test Loss: 3.284 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 19.356701850891113
Epoch: 23, Steps: 17 | Train Loss: 0.334 Vali Loss: 4.159 Vali Acc: 0.247 Test Loss: 4.159 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 18.607059955596924
Epoch: 24, Steps: 17 | Train Loss: 0.570 Vali Loss: 4.357 Vali Acc: 0.243 Test Loss: 4.357 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3203268
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 30.722816705703735
Epoch: 1, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 29.28582215309143
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 2.009 Vali Acc: 0.247 Test Loss: 2.009 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 26.86556100845337
Epoch: 3, Steps: 17 | Train Loss: 1.593 Vali Loss: 2.210 Vali Acc: 0.259 Test Loss: 2.210 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 30.920178174972534
Epoch: 4, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.819 Vali Acc: 0.251 Test Loss: 1.819 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 31.0247540473938
Epoch: 5, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.691 Vali Acc: 0.236 Test Loss: 1.691 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 27.835503578186035
Epoch: 6, Steps: 17 | Train Loss: 1.451 Vali Loss: 2.120 Vali Acc: 0.255 Test Loss: 2.120 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 30.459949254989624
Epoch: 7, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.789 Vali Acc: 0.266 Test Loss: 1.789 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 30.410968542099
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 2.685 Vali Acc: 0.270 Test Loss: 2.685 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 27.12504506111145
Epoch: 9, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.821 Vali Acc: 0.236 Test Loss: 1.821 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 24.068460702896118
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.696 Vali Acc: 0.278 Test Loss: 1.696 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 11 cost time: 26.163230895996094
Epoch: 11, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.508 Vali Acc: 0.262 Test Loss: 2.508 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.62178683280945
Epoch: 12, Steps: 17 | Train Loss: 1.255 Vali Loss: 2.252 Vali Acc: 0.228 Test Loss: 2.252 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.116079807281494
Epoch: 13, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.954 Vali Acc: 0.259 Test Loss: 1.954 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.357056379318237
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.639 Vali Acc: 0.259 Test Loss: 2.639 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 23.773874044418335
Epoch: 15, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.498 Vali Acc: 0.251 Test Loss: 2.498 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 26.428754806518555
Epoch: 16, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.359 Vali Acc: 0.217 Test Loss: 2.359 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 25.077027559280396
Epoch: 17, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.542 Vali Acc: 0.281 Test Loss: 2.542 Test Acc: 0.281
Validation loss decreased (-0.277550 --> -0.281343).  Saving model ...
Epoch: 18 cost time: 27.058793306350708
Epoch: 18, Steps: 17 | Train Loss: 0.660 Vali Loss: 3.226 Vali Acc: 0.247 Test Loss: 3.226 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 27.365299701690674
Epoch: 19, Steps: 17 | Train Loss: 0.712 Vali Loss: 2.638 Vali Acc: 0.243 Test Loss: 2.638 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 25.274287939071655
Epoch: 20, Steps: 17 | Train Loss: 0.566 Vali Loss: 3.143 Vali Acc: 0.251 Test Loss: 3.143 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 27.081069469451904
Epoch: 21, Steps: 17 | Train Loss: 0.500 Vali Loss: 2.868 Vali Acc: 0.266 Test Loss: 2.868 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.644965410232544
Epoch: 22, Steps: 17 | Train Loss: 0.427 Vali Loss: 2.952 Vali Acc: 0.255 Test Loss: 2.952 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 26.468902587890625
Epoch: 23, Steps: 17 | Train Loss: 0.338 Vali Loss: 3.848 Vali Acc: 0.259 Test Loss: 3.848 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 25.52514338493347
Epoch: 24, Steps: 17 | Train Loss: 0.484 Vali Loss: 4.650 Vali Acc: 0.270 Test Loss: 4.650 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 25.691128253936768
Epoch: 25, Steps: 17 | Train Loss: 0.377 Vali Loss: 3.313 Vali Acc: 0.266 Test Loss: 3.313 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 26.545243978500366
Epoch: 26, Steps: 17 | Train Loss: 0.337 Vali Loss: 3.769 Vali Acc: 0.262 Test Loss: 3.769 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 24.14465355873108
Epoch: 27, Steps: 17 | Train Loss: 0.277 Vali Loss: 4.301 Vali Acc: 0.259 Test Loss: 4.301 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 9823172
model size : 38.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.859673976898193
Epoch: 1, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.732 Vali Acc: 0.266 Test Loss: 1.732 Test Acc: 0.266
Validation loss decreased (inf --> -0.266142).  Saving model ...
Epoch: 2 cost time: 10.339885950088501
Epoch: 2, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.998 Vali Acc: 0.259 Test Loss: 1.998 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.514314889907837
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 2.197 Vali Acc: 0.274 Test Loss: 2.197 Test Acc: 0.274
Validation loss decreased (-0.266142 --> -0.273742).  Saving model ...
Epoch: 4 cost time: 11.542793273925781
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.645 Vali Acc: 0.270 Test Loss: 1.645 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.103200674057007
Epoch: 5, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.238419532775879
Epoch: 6, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.744 Vali Acc: 0.236 Test Loss: 1.744 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.827411651611328
Epoch: 7, Steps: 17 | Train Loss: 1.511 Vali Loss: 2.649 Vali Acc: 0.236 Test Loss: 2.649 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.397879838943481
Epoch: 8, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.837 Vali Acc: 0.270 Test Loss: 1.837 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.937408685684204
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 2.241 Vali Acc: 0.262 Test Loss: 2.241 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.159854888916016
Epoch: 10, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.820 Vali Acc: 0.243 Test Loss: 1.820 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.280351400375366
Epoch: 11, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.827 Vali Acc: 0.255 Test Loss: 1.827 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.085759162902832
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.749 Vali Acc: 0.281 Test Loss: 1.749 Test Acc: 0.281
Validation loss decreased (-0.273742 --> -0.281351).  Saving model ...
Epoch: 13 cost time: 10.898757934570312
Epoch: 13, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.298 Vali Acc: 0.259 Test Loss: 2.298 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.210652589797974
Epoch: 14, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.005 Vali Acc: 0.278 Test Loss: 2.005 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.768947839736938
Epoch: 15, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.385 Vali Acc: 0.236 Test Loss: 2.385 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.593465089797974
Epoch: 16, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.575 Vali Acc: 0.262 Test Loss: 2.575 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.57533597946167
Epoch: 17, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.473 Vali Acc: 0.232 Test Loss: 2.473 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.577181100845337
Epoch: 18, Steps: 17 | Train Loss: 0.773 Vali Loss: 3.514 Vali Acc: 0.236 Test Loss: 3.514 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.21833348274231
Epoch: 19, Steps: 17 | Train Loss: 0.842 Vali Loss: 2.394 Vali Acc: 0.259 Test Loss: 2.394 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.216159582138062
Epoch: 20, Steps: 17 | Train Loss: 0.606 Vali Loss: 3.127 Vali Acc: 0.228 Test Loss: 3.127 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.84822702407837
Epoch: 21, Steps: 17 | Train Loss: 0.505 Vali Loss: 2.846 Vali Acc: 0.232 Test Loss: 2.846 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.830484628677368
Epoch: 22, Steps: 17 | Train Loss: 0.472 Vali Loss: 3.187 Vali Acc: 0.281 Test Loss: 3.187 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3203268
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 41.73285722732544
Epoch: 1, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 37.1624538898468
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.945 Vali Acc: 0.251 Test Loss: 1.945 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 40.335580587387085
Epoch: 3, Steps: 17 | Train Loss: 2.041 Vali Loss: 1.939 Vali Acc: 0.240 Test Loss: 1.939 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 40.83935308456421
Epoch: 4, Steps: 17 | Train Loss: 1.607 Vali Loss: 2.401 Vali Acc: 0.247 Test Loss: 2.401 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 37.323153495788574
Epoch: 5, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.862 Vali Acc: 0.247 Test Loss: 1.862 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 41.54663705825806
Epoch: 6, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 41.55043029785156
Epoch: 7, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.688 Vali Acc: 0.262 Test Loss: 1.688 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 8 cost time: 38.379223346710205
Epoch: 8, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.828 Vali Acc: 0.259 Test Loss: 1.828 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 42.030171155929565
Epoch: 9, Steps: 17 | Train Loss: 1.445 Vali Loss: 2.101 Vali Acc: 0.232 Test Loss: 2.101 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 40.524691104888916
Epoch: 10, Steps: 17 | Train Loss: 1.530 Vali Loss: 2.114 Vali Acc: 0.289 Test Loss: 2.114 Test Acc: 0.289
Validation loss decreased (-0.262341 --> -0.288952).  Saving model ...
Epoch: 11 cost time: 38.22355127334595
Epoch: 11, Steps: 17 | Train Loss: 1.226 Vali Loss: 2.021 Vali Acc: 0.262 Test Loss: 2.021 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 41.616652727127075
Epoch: 12, Steps: 17 | Train Loss: 1.195 Vali Loss: 2.072 Vali Acc: 0.255 Test Loss: 2.072 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 40.950655460357666
Epoch: 13, Steps: 17 | Train Loss: 1.066 Vali Loss: 2.059 Vali Acc: 0.240 Test Loss: 2.059 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 39.73141646385193
Epoch: 14, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.163 Vali Acc: 0.270 Test Loss: 2.163 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 42.375211000442505
Epoch: 15, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.222 Vali Acc: 0.278 Test Loss: 2.222 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 36.58054995536804
Epoch: 16, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.274 Vali Acc: 0.262 Test Loss: 2.274 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 37.142451763153076
Epoch: 17, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.906 Vali Acc: 0.259 Test Loss: 2.906 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 37.414262533187866
Epoch: 18, Steps: 17 | Train Loss: 0.842 Vali Loss: 2.635 Vali Acc: 0.266 Test Loss: 2.635 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 37.612061500549316
Epoch: 19, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.036 Vali Acc: 0.281 Test Loss: 3.036 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 36.36953783035278
Epoch: 20, Steps: 17 | Train Loss: 0.542 Vali Loss: 3.053 Vali Acc: 0.297 Test Loss: 3.053 Test Acc: 0.297
Validation loss decreased (-0.288952 --> -0.296547).  Saving model ...
Epoch: 21 cost time: 37.06978249549866
Epoch: 21, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.869 Vali Acc: 0.278 Test Loss: 3.869 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 37.10932207107544
Epoch: 22, Steps: 17 | Train Loss: 0.592 Vali Loss: 3.292 Vali Acc: 0.281 Test Loss: 3.292 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 35.83583664894104
Epoch: 23, Steps: 17 | Train Loss: 0.468 Vali Loss: 3.138 Vali Acc: 0.262 Test Loss: 3.138 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 35.35587286949158
Epoch: 24, Steps: 17 | Train Loss: 0.312 Vali Loss: 3.604 Vali Acc: 0.266 Test Loss: 3.604 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 34.63279867172241
Epoch: 25, Steps: 17 | Train Loss: 0.281 Vali Loss: 5.064 Vali Acc: 0.251 Test Loss: 5.064 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 34.8862738609314
Epoch: 26, Steps: 17 | Train Loss: 0.430 Vali Loss: 4.209 Vali Acc: 0.221 Test Loss: 4.209 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 35.25510787963867
Epoch: 27, Steps: 17 | Train Loss: 0.244 Vali Loss: 4.110 Vali Acc: 0.255 Test Loss: 4.110 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 34.511531352996826
Epoch: 28, Steps: 17 | Train Loss: 0.181 Vali Loss: 4.523 Vali Acc: 0.240 Test Loss: 4.523 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 34.6753625869751
Epoch: 29, Steps: 17 | Train Loss: 0.194 Vali Loss: 4.580 Vali Acc: 0.232 Test Loss: 4.580 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 42.70651125907898
Epoch: 30, Steps: 17 | Train Loss: 0.127 Vali Loss: 5.392 Vali Acc: 0.240 Test Loss: 5.392 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 5136580
model size : 20.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.67796039581299
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.652 Vali Acc: 0.232 Test Loss: 1.652 Test Acc: 0.232
Validation loss decreased (inf --> -0.231923).  Saving model ...
Epoch: 2 cost time: 16.874252796173096
Epoch: 2, Steps: 17 | Train Loss: 1.660 Vali Loss: 2.434 Vali Acc: 0.251 Test Loss: 2.434 Test Acc: 0.251
Validation loss decreased (-0.231923 --> -0.250926).  Saving model ...
Epoch: 3 cost time: 15.803499698638916
Epoch: 3, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.910 Vali Acc: 0.247 Test Loss: 1.910 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.885475635528564
Epoch: 4, Steps: 17 | Train Loss: 1.785 Vali Loss: 2.701 Vali Acc: 0.240 Test Loss: 2.701 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.21637535095215
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 2.943 Vali Acc: 0.243 Test Loss: 2.943 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.827608346939087
Epoch: 6, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.761 Vali Acc: 0.236 Test Loss: 1.761 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.851046562194824
Epoch: 7, Steps: 17 | Train Loss: 1.578 Vali Loss: 2.528 Vali Acc: 0.259 Test Loss: 2.528 Test Acc: 0.259
Validation loss decreased (-0.250926 --> -0.258530).  Saving model ...
Epoch: 8 cost time: 17.802987337112427
Epoch: 8, Steps: 17 | Train Loss: 1.644 Vali Loss: 2.194 Vali Acc: 0.297 Test Loss: 2.194 Test Acc: 0.297
Validation loss decreased (-0.258530 --> -0.296556).  Saving model ...
Epoch: 9 cost time: 16.71382784843445
Epoch: 9, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.991 Vali Acc: 0.308 Test Loss: 1.991 Test Acc: 0.308
Validation loss decreased (-0.296556 --> -0.307965).  Saving model ...
Epoch: 10 cost time: 16.811657667160034
Epoch: 10, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.653 Vali Acc: 0.274 Test Loss: 1.653 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.888891458511353
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.753 Vali Acc: 0.247 Test Loss: 1.753 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.81196665763855
Epoch: 12, Steps: 17 | Train Loss: 1.170 Vali Loss: 2.093 Vali Acc: 0.304 Test Loss: 2.093 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 18.518963098526
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 3.214 Vali Acc: 0.251 Test Loss: 3.214 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 18.303752422332764
Epoch: 14, Steps: 17 | Train Loss: 1.590 Vali Loss: 2.357 Vali Acc: 0.255 Test Loss: 2.357 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.277515172958374
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.189 Vali Acc: 0.243 Test Loss: 2.189 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.126758575439453
Epoch: 16, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.778 Vali Acc: 0.247 Test Loss: 2.778 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 16.505043745040894
Epoch: 17, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.328 Vali Acc: 0.293 Test Loss: 2.328 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 18.227824926376343
Epoch: 18, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.153 Vali Acc: 0.259 Test Loss: 2.153 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 18.519856929779053
Epoch: 19, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.468 Vali Acc: 0.289 Test Loss: 2.468 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 1826500
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 34.39900755882263
Epoch: 1, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 30.651830673217773
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.945 Vali Acc: 0.251 Test Loss: 1.945 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.137145042419434
Epoch: 3, Steps: 17 | Train Loss: 2.041 Vali Loss: 1.939 Vali Acc: 0.240 Test Loss: 1.939 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.325339555740356
Epoch: 4, Steps: 17 | Train Loss: 1.607 Vali Loss: 2.401 Vali Acc: 0.247 Test Loss: 2.401 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 31.584083080291748
Epoch: 5, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.862 Vali Acc: 0.247 Test Loss: 1.862 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 29.360333919525146
Epoch: 6, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 31.179043769836426
Epoch: 7, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.688 Vali Acc: 0.262 Test Loss: 1.688 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 8 cost time: 31.902811288833618
Epoch: 8, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.828 Vali Acc: 0.259 Test Loss: 1.828 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 31.407094478607178
Epoch: 9, Steps: 17 | Train Loss: 1.445 Vali Loss: 2.102 Vali Acc: 0.232 Test Loss: 2.102 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 30.100834369659424
Epoch: 10, Steps: 17 | Train Loss: 1.529 Vali Loss: 2.114 Vali Acc: 0.289 Test Loss: 2.114 Test Acc: 0.289
Validation loss decreased (-0.262341 --> -0.288952).  Saving model ...
Epoch: 11 cost time: 32.66224002838135
Epoch: 11, Steps: 17 | Train Loss: 1.226 Vali Loss: 2.021 Vali Acc: 0.262 Test Loss: 2.021 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.728416442871094
Epoch: 12, Steps: 17 | Train Loss: 1.196 Vali Loss: 2.069 Vali Acc: 0.255 Test Loss: 2.069 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 32.61492967605591
Epoch: 13, Steps: 17 | Train Loss: 1.068 Vali Loss: 2.061 Vali Acc: 0.240 Test Loss: 2.061 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 30.19635558128357
Epoch: 14, Steps: 17 | Train Loss: 0.956 Vali Loss: 2.156 Vali Acc: 0.266 Test Loss: 2.156 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 31.935818672180176
Epoch: 15, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.221 Vali Acc: 0.278 Test Loss: 2.221 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 31.945322036743164
Epoch: 16, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.273 Vali Acc: 0.262 Test Loss: 2.273 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 31.744640111923218
Epoch: 17, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.929 Vali Acc: 0.255 Test Loss: 2.929 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 29.111342668533325
Epoch: 18, Steps: 17 | Train Loss: 0.837 Vali Loss: 2.641 Vali Acc: 0.262 Test Loss: 2.641 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 31.892085075378418
Epoch: 19, Steps: 17 | Train Loss: 0.580 Vali Loss: 3.060 Vali Acc: 0.259 Test Loss: 3.060 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 31.517183542251587
Epoch: 20, Steps: 17 | Train Loss: 0.536 Vali Loss: 3.060 Vali Acc: 0.274 Test Loss: 3.060 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 5136580
model size : 20.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 14.315322875976562
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.652 Vali Acc: 0.232 Test Loss: 1.652 Test Acc: 0.232
Validation loss decreased (inf --> -0.231923).  Saving model ...
Epoch: 2 cost time: 11.982096672058105
Epoch: 2, Steps: 17 | Train Loss: 1.660 Vali Loss: 2.434 Vali Acc: 0.251 Test Loss: 2.434 Test Acc: 0.251
Validation loss decreased (-0.231923 --> -0.250926).  Saving model ...
Epoch: 3 cost time: 12.075206518173218
Epoch: 3, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.910 Vali Acc: 0.247 Test Loss: 1.910 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.01716685295105
Epoch: 4, Steps: 17 | Train Loss: 1.785 Vali Loss: 2.701 Vali Acc: 0.240 Test Loss: 2.701 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.105830669403076
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 2.943 Vali Acc: 0.243 Test Loss: 2.943 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.504246711730957
Epoch: 6, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.761 Vali Acc: 0.236 Test Loss: 1.761 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.465402364730835
Epoch: 7, Steps: 17 | Train Loss: 1.578 Vali Loss: 2.528 Vali Acc: 0.259 Test Loss: 2.528 Test Acc: 0.259
Validation loss decreased (-0.250926 --> -0.258530).  Saving model ...
Epoch: 8 cost time: 13.340515851974487
Epoch: 8, Steps: 17 | Train Loss: 1.644 Vali Loss: 2.194 Vali Acc: 0.297 Test Loss: 2.194 Test Acc: 0.297
Validation loss decreased (-0.258530 --> -0.296556).  Saving model ...
Epoch: 9 cost time: 13.456633567810059
Epoch: 9, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.991 Vali Acc: 0.308 Test Loss: 1.991 Test Acc: 0.308
Validation loss decreased (-0.296556 --> -0.307965).  Saving model ...
Epoch: 10 cost time: 12.935141324996948
Epoch: 10, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.653 Vali Acc: 0.274 Test Loss: 1.653 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 12.225116729736328
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.753 Vali Acc: 0.247 Test Loss: 1.753 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 12.58547306060791
Epoch: 12, Steps: 17 | Train Loss: 1.170 Vali Loss: 2.093 Vali Acc: 0.304 Test Loss: 2.093 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.471909284591675
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 3.214 Vali Acc: 0.251 Test Loss: 3.214 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 13.47639012336731
Epoch: 14, Steps: 17 | Train Loss: 1.590 Vali Loss: 2.357 Vali Acc: 0.255 Test Loss: 2.357 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.472882986068726
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.188 Vali Acc: 0.243 Test Loss: 2.188 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 13.517411470413208
Epoch: 16, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.780 Vali Acc: 0.247 Test Loss: 2.780 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 13.12495732307434
Epoch: 17, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.326 Vali Acc: 0.293 Test Loss: 2.326 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 13.829115152359009
Epoch: 18, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.151 Vali Acc: 0.262 Test Loss: 2.151 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.855579853057861
Epoch: 19, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.464 Vali Acc: 0.289 Test Loss: 2.464 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 1826500
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 21.04224944114685
Epoch: 1, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 17.695520639419556
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.945 Vali Acc: 0.251 Test Loss: 1.945 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.031625509262085
Epoch: 3, Steps: 17 | Train Loss: 2.041 Vali Loss: 1.939 Vali Acc: 0.240 Test Loss: 1.939 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.44068717956543
Epoch: 4, Steps: 17 | Train Loss: 1.607 Vali Loss: 2.401 Vali Acc: 0.247 Test Loss: 2.401 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.45932173728943
Epoch: 5, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.862 Vali Acc: 0.247 Test Loss: 1.862 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.8754141330719
Epoch: 6, Steps: 17 | Train Loss: 1.548 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.158792972564697
Epoch: 7, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.688 Vali Acc: 0.262 Test Loss: 1.688 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 8 cost time: 18.357685089111328
Epoch: 8, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.830 Vali Acc: 0.259 Test Loss: 1.830 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.335110902786255
Epoch: 9, Steps: 17 | Train Loss: 1.441 Vali Loss: 2.088 Vali Acc: 0.236 Test Loss: 2.088 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.318517208099365
Epoch: 10, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.109 Vali Acc: 0.293 Test Loss: 2.109 Test Acc: 0.293
Validation loss decreased (-0.262341 --> -0.292755).  Saving model ...
Epoch: 11 cost time: 18.30535316467285
Epoch: 11, Steps: 17 | Train Loss: 1.224 Vali Loss: 2.020 Vali Acc: 0.262 Test Loss: 2.020 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.86955451965332
Epoch: 12, Steps: 17 | Train Loss: 1.192 Vali Loss: 2.070 Vali Acc: 0.251 Test Loss: 2.070 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.25306749343872
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.054 Vali Acc: 0.236 Test Loss: 2.054 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.002578020095825
Epoch: 14, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.097 Vali Acc: 0.278 Test Loss: 2.097 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.958948373794556
Epoch: 15, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.237 Vali Acc: 0.270 Test Loss: 2.237 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 19.077574491500854
Epoch: 16, Steps: 17 | Train Loss: 0.829 Vali Loss: 2.220 Vali Acc: 0.289 Test Loss: 2.220 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 19.086766719818115
Epoch: 17, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.539 Vali Acc: 0.274 Test Loss: 2.539 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 17.07301640510559
Epoch: 18, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.746 Vali Acc: 0.259 Test Loss: 2.746 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 18.21006417274475
Epoch: 19, Steps: 17 | Train Loss: 0.553 Vali Loss: 3.171 Vali Acc: 0.259 Test Loss: 3.171 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 18.42968487739563
Epoch: 20, Steps: 17 | Train Loss: 0.510 Vali Loss: 3.696 Vali Acc: 0.293 Test Loss: 3.696 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 5136580
model size : 20.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.400463104248047
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.652 Vali Acc: 0.232 Test Loss: 1.652 Test Acc: 0.232
Validation loss decreased (inf --> -0.231923).  Saving model ...
Epoch: 2 cost time: 8.061026573181152
Epoch: 2, Steps: 17 | Train Loss: 1.660 Vali Loss: 2.434 Vali Acc: 0.251 Test Loss: 2.434 Test Acc: 0.251
Validation loss decreased (-0.231923 --> -0.250926).  Saving model ...
Epoch: 3 cost time: 8.1334810256958
Epoch: 3, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.910 Vali Acc: 0.247 Test Loss: 1.910 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.06937575340271
Epoch: 4, Steps: 17 | Train Loss: 1.785 Vali Loss: 2.701 Vali Acc: 0.240 Test Loss: 2.701 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.43102240562439
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 2.943 Vali Acc: 0.243 Test Loss: 2.943 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.3600852489471436
Epoch: 6, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.761 Vali Acc: 0.236 Test Loss: 1.761 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.5559070110321045
Epoch: 7, Steps: 17 | Train Loss: 1.578 Vali Loss: 2.528 Vali Acc: 0.259 Test Loss: 2.528 Test Acc: 0.259
Validation loss decreased (-0.250926 --> -0.258530).  Saving model ...
Epoch: 8 cost time: 8.121562480926514
Epoch: 8, Steps: 17 | Train Loss: 1.644 Vali Loss: 2.194 Vali Acc: 0.297 Test Loss: 2.194 Test Acc: 0.297
Validation loss decreased (-0.258530 --> -0.296556).  Saving model ...
Epoch: 9 cost time: 8.134790658950806
Epoch: 9, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.991 Vali Acc: 0.308 Test Loss: 1.991 Test Acc: 0.308
Validation loss decreased (-0.296556 --> -0.307965).  Saving model ...
Epoch: 10 cost time: 8.13895297050476
Epoch: 10, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.653 Vali Acc: 0.274 Test Loss: 1.653 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.115978956222534
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.753 Vali Acc: 0.247 Test Loss: 1.753 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.113749027252197
Epoch: 12, Steps: 17 | Train Loss: 1.170 Vali Loss: 2.093 Vali Acc: 0.304 Test Loss: 2.093 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.126888275146484
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 3.214 Vali Acc: 0.251 Test Loss: 3.214 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.9972028732299805
Epoch: 14, Steps: 17 | Train Loss: 1.590 Vali Loss: 2.357 Vali Acc: 0.255 Test Loss: 2.357 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.391806364059448
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 2.187 Vali Acc: 0.243 Test Loss: 2.187 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.463072299957275
Epoch: 16, Steps: 17 | Train Loss: 0.950 Vali Loss: 2.779 Vali Acc: 0.247 Test Loss: 2.779 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.799923658370972
Epoch: 17, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.326 Vali Acc: 0.293 Test Loss: 2.326 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.661508083343506
Epoch: 18, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.152 Vali Acc: 0.262 Test Loss: 2.152 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.861002206802368
Epoch: 19, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.462 Vali Acc: 0.289 Test Loss: 2.462 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 1826500
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 43.55034279823303
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 40.60921883583069
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.551 Vali Acc: 0.293 Test Loss: 1.551 Test Acc: 0.293
Validation loss decreased (-0.254738 --> -0.292760).  Saving model ...
Epoch: 3 cost time: 36.87397217750549
Epoch: 3, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.679 Vali Acc: 0.255 Test Loss: 1.679 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 40.1049690246582
Epoch: 4, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 40.23267316818237
Epoch: 5, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.546 Vali Acc: 0.243 Test Loss: 1.546 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 37.32229137420654
Epoch: 6, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 41.5158531665802
Epoch: 7, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.687 Vali Acc: 0.236 Test Loss: 1.687 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 41.57057547569275
Epoch: 8, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 38.403809785842896
Epoch: 9, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.681 Vali Acc: 0.228 Test Loss: 1.681 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 39.735392332077026
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.777 Vali Acc: 0.247 Test Loss: 1.777 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 39.476572036743164
Epoch: 11, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 38.82908034324646
Epoch: 12, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.090 Vali Acc: 0.270 Test Loss: 2.090 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4912356
model size : 19.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.889139413833618
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 17.834675073623657
Epoch: 2, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.462 Vali Acc: 0.281 Test Loss: 1.462 Test Acc: 0.281
Validation loss decreased (-0.250934 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 16.79870319366455
Epoch: 3, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.714090585708618
Epoch: 4, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.590 Vali Acc: 0.266 Test Loss: 1.590 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.194981813430786
Epoch: 5, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.726 Vali Acc: 0.281 Test Loss: 1.726 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.294447660446167
Epoch: 6, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.724836587905884
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.589 Vali Acc: 0.243 Test Loss: 1.589 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.43708562850952
Epoch: 8, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 16.343924522399902
Epoch: 9, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 16.228699445724487
Epoch: 10, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.621 Vali Acc: 0.285 Test Loss: 1.621 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 11 cost time: 17.231289863586426
Epoch: 11, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.805 Vali Acc: 0.240 Test Loss: 1.805 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.315802097320557
Epoch: 12, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.017 Vali Acc: 0.240 Test Loss: 2.017 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.286948442459106
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 17.175901412963867
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.058 Vali Acc: 0.243 Test Loss: 2.058 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.54255723953247
Epoch: 15, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.174 Vali Acc: 0.236 Test Loss: 2.174 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 15.657901048660278
Epoch: 16, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.281 Vali Acc: 0.259 Test Loss: 2.281 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 17.132141590118408
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.270 Vali Acc: 0.266 Test Loss: 2.270 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 17.792787790298462
Epoch: 18, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.902 Vali Acc: 0.232 Test Loss: 1.902 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 17.753368854522705
Epoch: 19, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.202 Vali Acc: 0.236 Test Loss: 2.202 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 17.548827171325684
Epoch: 20, Steps: 17 | Train Loss: 0.794 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1602148
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 29.052642107009888
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 28.72815203666687
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.551 Vali Acc: 0.293 Test Loss: 1.551 Test Acc: 0.293
Validation loss decreased (-0.254738 --> -0.292760).  Saving model ...
Epoch: 3 cost time: 28.643178701400757
Epoch: 3, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.679 Vali Acc: 0.255 Test Loss: 1.679 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 29.02970266342163
Epoch: 4, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.369555950164795
Epoch: 5, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.546 Vali Acc: 0.243 Test Loss: 1.546 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.5980703830719
Epoch: 6, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.590511798858643
Epoch: 7, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.687 Vali Acc: 0.236 Test Loss: 1.687 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 24.637099504470825
Epoch: 8, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 28.271416664123535
Epoch: 9, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.681 Vali Acc: 0.228 Test Loss: 1.681 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 25.818811893463135
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.777 Vali Acc: 0.247 Test Loss: 1.777 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 27.536582231521606
Epoch: 11, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 25.43628215789795
Epoch: 12, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.090 Vali Acc: 0.270 Test Loss: 2.090 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4912356
model size : 19.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.03603219985962
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 11.656285762786865
Epoch: 2, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.462 Vali Acc: 0.281 Test Loss: 1.462 Test Acc: 0.281
Validation loss decreased (-0.250934 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 10.488501787185669
Epoch: 3, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.75127911567688
Epoch: 4, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.590 Vali Acc: 0.266 Test Loss: 1.590 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.787775993347168
Epoch: 5, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.726 Vali Acc: 0.281 Test Loss: 1.726 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.823241233825684
Epoch: 6, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.948946237564087
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.589 Vali Acc: 0.243 Test Loss: 1.589 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.782050132751465
Epoch: 8, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.739197254180908
Epoch: 9, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.342286586761475
Epoch: 10, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.621 Vali Acc: 0.285 Test Loss: 1.621 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 11 cost time: 12.470896244049072
Epoch: 11, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.805 Vali Acc: 0.240 Test Loss: 1.805 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.19898009300232
Epoch: 12, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.017 Vali Acc: 0.240 Test Loss: 2.017 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.134812831878662
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.33689284324646
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.058 Vali Acc: 0.243 Test Loss: 2.058 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.38949728012085
Epoch: 15, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.174 Vali Acc: 0.236 Test Loss: 2.174 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.431070327758789
Epoch: 16, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.281 Vali Acc: 0.259 Test Loss: 2.281 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.846682786941528
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.270 Vali Acc: 0.266 Test Loss: 2.270 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.857765197753906
Epoch: 18, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.902 Vali Acc: 0.232 Test Loss: 1.902 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.97605848312378
Epoch: 19, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.202 Vali Acc: 0.236 Test Loss: 2.202 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.886254787445068
Epoch: 20, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1602148
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 17.959640979766846
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 16.6672682762146
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.551 Vali Acc: 0.293 Test Loss: 1.551 Test Acc: 0.293
Validation loss decreased (-0.254738 --> -0.292760).  Saving model ...
Epoch: 3 cost time: 15.765544176101685
Epoch: 3, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.679 Vali Acc: 0.255 Test Loss: 1.679 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.207157611846924
Epoch: 4, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.539 Vali Acc: 0.259 Test Loss: 1.539 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.745966911315918
Epoch: 5, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.546 Vali Acc: 0.243 Test Loss: 1.546 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.34235954284668
Epoch: 6, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.665 Vali Acc: 0.243 Test Loss: 1.665 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 16.27963662147522
Epoch: 7, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.687 Vali Acc: 0.236 Test Loss: 1.687 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 17.473559379577637
Epoch: 8, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 17.477368593215942
Epoch: 9, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.681 Vali Acc: 0.228 Test Loss: 1.681 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 15.740608930587769
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.777 Vali Acc: 0.247 Test Loss: 1.777 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.958163499832153
Epoch: 11, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.651 Vali Acc: 0.274 Test Loss: 1.651 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.72084331512451
Epoch: 12, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.090 Vali Acc: 0.270 Test Loss: 2.090 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 4912356
model size : 19.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.003112077713013
Epoch: 1, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.702 Vali Acc: 0.251 Test Loss: 1.702 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 7.789197683334351
Epoch: 2, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.462 Vali Acc: 0.281 Test Loss: 1.462 Test Acc: 0.281
Validation loss decreased (-0.250934 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 7.853574275970459
Epoch: 3, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.924054384231567
Epoch: 4, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.590 Vali Acc: 0.266 Test Loss: 1.590 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.945751667022705
Epoch: 5, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.726 Vali Acc: 0.281 Test Loss: 1.726 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.077008485794067
Epoch: 6, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.252145767211914
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.589 Vali Acc: 0.243 Test Loss: 1.589 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.895105361938477
Epoch: 8, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.937102317810059
Epoch: 9, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.866542339324951
Epoch: 10, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.621 Vali Acc: 0.285 Test Loss: 1.621 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285155).  Saving model ...
Epoch: 11 cost time: 7.923768043518066
Epoch: 11, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.805 Vali Acc: 0.240 Test Loss: 1.805 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.240815877914429
Epoch: 12, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.017 Vali Acc: 0.240 Test Loss: 2.017 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.226846694946289
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.774897336959839
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.058 Vali Acc: 0.243 Test Loss: 2.058 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.229763746261597
Epoch: 15, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.174 Vali Acc: 0.236 Test Loss: 2.174 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.18886661529541
Epoch: 16, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.281 Vali Acc: 0.259 Test Loss: 2.281 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.220337152481079
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 2.270 Vali Acc: 0.266 Test Loss: 2.270 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.699223279953003
Epoch: 18, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.902 Vali Acc: 0.232 Test Loss: 1.902 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.8053247928619385
Epoch: 19, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.202 Vali Acc: 0.236 Test Loss: 2.202 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.229901313781738
Epoch: 20, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.052 Vali Acc: 0.259 Test Loss: 2.052 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 1602148
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 24.06610655784607
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.555 Vali Acc: 0.255 Test Loss: 1.555 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 19.632392168045044
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.63787269592285
Epoch: 3, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.988 Vali Acc: 0.312 Test Loss: 1.988 Test Acc: 0.312
Validation loss decreased (-0.254737 --> -0.311767).  Saving model ...
Epoch: 4 cost time: 21.41676163673401
Epoch: 4, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.76668405532837
Epoch: 5, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.691 Vali Acc: 0.304 Test Loss: 1.691 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.648350477218628
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.587 Vali Acc: 0.240 Test Loss: 1.587 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.03181481361389
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.662556886672974
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.970 Vali Acc: 0.221 Test Loss: 1.970 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.11262536048889
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.702 Vali Acc: 0.262 Test Loss: 1.702 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 20.77855658531189
Epoch: 10, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.771 Vali Acc: 0.297 Test Loss: 1.771 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.577735662460327
Epoch: 11, Steps: 17 | Train Loss: 1.294 Vali Loss: 2.309 Vali Acc: 0.259 Test Loss: 2.309 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.80362892150879
Epoch: 12, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.846 Vali Acc: 0.300 Test Loss: 1.846 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 22.026952266693115
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 2.019 Vali Acc: 0.247 Test Loss: 2.019 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 2568676
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.791407585144043
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.535 Vali Acc: 0.266 Test Loss: 1.535 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 8.758724927902222
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.502 Vali Acc: 0.281 Test Loss: 1.502 Test Acc: 0.281
Validation loss decreased (-0.266144 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 9.728342294692993
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.781 Vali Acc: 0.251 Test Loss: 1.781 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.739445447921753
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.748 Vali Acc: 0.240 Test Loss: 1.748 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.769543886184692
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.80080795288086
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.636 Vali Acc: 0.240 Test Loss: 1.636 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.725500583648682
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 2.453 Vali Acc: 0.228 Test Loss: 2.453 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.379729747772217
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.739 Vali Acc: 0.251 Test Loss: 1.739 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.75067687034607
Epoch: 9, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.917 Vali Acc: 0.327 Test Loss: 1.917 Test Acc: 0.327
Validation loss decreased (-0.281354 --> -0.326977).  Saving model ...
Epoch: 10 cost time: 9.745186805725098
Epoch: 10, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.759 Vali Acc: 0.240 Test Loss: 1.759 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.7919442653656
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.813 Vali Acc: 0.247 Test Loss: 1.813 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.920685052871704
Epoch: 12, Steps: 17 | Train Loss: 1.357 Vali Loss: 2.075 Vali Acc: 0.251 Test Loss: 2.075 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.688467025756836
Epoch: 13, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.965 Vali Acc: 0.255 Test Loss: 1.965 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.17837929725647
Epoch: 14, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.821 Vali Acc: 0.247 Test Loss: 1.821 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.23863935470581
Epoch: 15, Steps: 17 | Train Loss: 1.212 Vali Loss: 2.120 Vali Acc: 0.266 Test Loss: 2.120 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.26608681678772
Epoch: 16, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.779 Vali Acc: 0.262 Test Loss: 1.779 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.206008672714233
Epoch: 17, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.889 Vali Acc: 0.270 Test Loss: 1.889 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.260237455368042
Epoch: 18, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.871 Vali Acc: 0.270 Test Loss: 1.871 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.093283891677856
Epoch: 19, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.876 Vali Acc: 0.308 Test Loss: 1.876 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 913508
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 17.51147174835205
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.555 Vali Acc: 0.255 Test Loss: 1.555 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 14.458731412887573
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.902975082397461
Epoch: 3, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.988 Vali Acc: 0.312 Test Loss: 1.988 Test Acc: 0.312
Validation loss decreased (-0.254737 --> -0.311767).  Saving model ...
Epoch: 4 cost time: 16.00629711151123
Epoch: 4, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.34857726097107
Epoch: 5, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.691 Vali Acc: 0.304 Test Loss: 1.691 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.112238883972168
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.587 Vali Acc: 0.240 Test Loss: 1.587 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.122299671173096
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.166338682174683
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.970 Vali Acc: 0.221 Test Loss: 1.970 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.710466623306274
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.702 Vali Acc: 0.262 Test Loss: 1.702 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.054083347320557
Epoch: 10, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.771 Vali Acc: 0.297 Test Loss: 1.771 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.20488142967224
Epoch: 11, Steps: 17 | Train Loss: 1.294 Vali Loss: 2.309 Vali Acc: 0.259 Test Loss: 2.309 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.733855962753296
Epoch: 12, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.846 Vali Acc: 0.300 Test Loss: 1.846 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.168301820755005
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 2.019 Vali Acc: 0.247 Test Loss: 2.019 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 2568676
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.055317163467407
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.535 Vali Acc: 0.266 Test Loss: 1.535 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 7.662815570831299
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.502 Vali Acc: 0.281 Test Loss: 1.502 Test Acc: 0.281
Validation loss decreased (-0.266144 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 6.973130702972412
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.781 Vali Acc: 0.251 Test Loss: 1.781 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.547260522842407
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.748 Vali Acc: 0.240 Test Loss: 1.748 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.243094205856323
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.298532485961914
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.636 Vali Acc: 0.240 Test Loss: 1.636 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.307156085968018
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 2.453 Vali Acc: 0.228 Test Loss: 2.453 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.391186475753784
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.739 Vali Acc: 0.251 Test Loss: 1.739 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.1675615310668945
Epoch: 9, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.917 Vali Acc: 0.327 Test Loss: 1.917 Test Acc: 0.327
Validation loss decreased (-0.281354 --> -0.326977).  Saving model ...
Epoch: 10 cost time: 6.55320143699646
Epoch: 10, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.759 Vali Acc: 0.240 Test Loss: 1.759 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.489202976226807
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.813 Vali Acc: 0.247 Test Loss: 1.813 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.783953428268433
Epoch: 12, Steps: 17 | Train Loss: 1.357 Vali Loss: 2.075 Vali Acc: 0.251 Test Loss: 2.075 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.107018709182739
Epoch: 13, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.965 Vali Acc: 0.255 Test Loss: 1.965 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.93552565574646
Epoch: 14, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.821 Vali Acc: 0.247 Test Loss: 1.821 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.037290573120117
Epoch: 15, Steps: 17 | Train Loss: 1.212 Vali Loss: 2.120 Vali Acc: 0.266 Test Loss: 2.120 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.079649925231934
Epoch: 16, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.779 Vali Acc: 0.262 Test Loss: 1.779 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.059181213378906
Epoch: 17, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.889 Vali Acc: 0.270 Test Loss: 1.889 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.026256084442139
Epoch: 18, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.871 Vali Acc: 0.270 Test Loss: 1.871 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.126342535018921
Epoch: 19, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.876 Vali Acc: 0.308 Test Loss: 1.876 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 913508
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 11.569162607192993
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.555 Vali Acc: 0.255 Test Loss: 1.555 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 11.233818054199219
Epoch: 2, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.478 Vali Acc: 0.251 Test Loss: 1.478 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.766549825668335
Epoch: 3, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.988 Vali Acc: 0.312 Test Loss: 1.988 Test Acc: 0.312
Validation loss decreased (-0.254737 --> -0.311767).  Saving model ...
Epoch: 4 cost time: 11.795446634292603
Epoch: 4, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.781645059585571
Epoch: 5, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.691 Vali Acc: 0.304 Test Loss: 1.691 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.837464570999146
Epoch: 6, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.587 Vali Acc: 0.240 Test Loss: 1.587 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.51632308959961
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.639 Vali Acc: 0.236 Test Loss: 1.639 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.816925287246704
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.970 Vali Acc: 0.221 Test Loss: 1.970 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.800649642944336
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.702 Vali Acc: 0.262 Test Loss: 1.702 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 11.269200086593628
Epoch: 10, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.771 Vali Acc: 0.297 Test Loss: 1.771 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.261968612670898
Epoch: 11, Steps: 17 | Train Loss: 1.294 Vali Loss: 2.309 Vali Acc: 0.259 Test Loss: 2.309 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.248757362365723
Epoch: 12, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.846 Vali Acc: 0.300 Test Loss: 1.846 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.31148386001587
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 2.019 Vali Acc: 0.247 Test Loss: 2.019 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 2568676
model size : 10.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.607513666152954
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.535 Vali Acc: 0.266 Test Loss: 1.535 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 5.4220805168151855
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.502 Vali Acc: 0.281 Test Loss: 1.502 Test Acc: 0.281
Validation loss decreased (-0.266144 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 5.403472900390625
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.781 Vali Acc: 0.251 Test Loss: 1.781 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.481326580047607
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.748 Vali Acc: 0.240 Test Loss: 1.748 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.422870635986328
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.659 Vali Acc: 0.251 Test Loss: 1.659 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.461222171783447
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.636 Vali Acc: 0.240 Test Loss: 1.636 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.430654764175415
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 2.453 Vali Acc: 0.228 Test Loss: 2.453 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.425798654556274
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.739 Vali Acc: 0.251 Test Loss: 1.739 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.033354759216309
Epoch: 9, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.917 Vali Acc: 0.327 Test Loss: 1.917 Test Acc: 0.327
Validation loss decreased (-0.281354 --> -0.326977).  Saving model ...
Epoch: 10 cost time: 4.922112703323364
Epoch: 10, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.758 Vali Acc: 0.240 Test Loss: 1.758 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.984119653701782
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.813 Vali Acc: 0.247 Test Loss: 1.813 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.8180437088012695
Epoch: 12, Steps: 17 | Train Loss: 1.357 Vali Loss: 2.075 Vali Acc: 0.251 Test Loss: 2.075 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.406074047088623
Epoch: 13, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.965 Vali Acc: 0.255 Test Loss: 1.965 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.390509366989136
Epoch: 14, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.821 Vali Acc: 0.247 Test Loss: 1.821 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.416382312774658
Epoch: 15, Steps: 17 | Train Loss: 1.212 Vali Loss: 2.120 Vali Acc: 0.266 Test Loss: 2.120 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.388404130935669
Epoch: 16, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.779 Vali Acc: 0.262 Test Loss: 1.779 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.390300989151001
Epoch: 17, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.889 Vali Acc: 0.270 Test Loss: 1.889 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.4111809730529785
Epoch: 18, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.871 Vali Acc: 0.270 Test Loss: 1.871 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.412381887435913
Epoch: 19, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.877 Vali Acc: 0.308 Test Loss: 1.877 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 913508
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.889924049377441
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 15.069947481155396
Epoch: 2, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.929 Vali Acc: 0.251 Test Loss: 1.929 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.886797666549683
Epoch: 3, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.453 Vali Acc: 0.274 Test Loss: 1.453 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 15.902649402618408
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.605 Vali Acc: 0.281 Test Loss: 1.605 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 5 cost time: 15.996162176132202
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.013699054718018
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.693 Vali Acc: 0.247 Test Loss: 1.693 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.179181098937988
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.937 Vali Acc: 0.232 Test Loss: 1.937 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.328815460205078
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.591 Vali Acc: 0.293 Test Loss: 1.591 Test Acc: 0.293
Validation loss decreased (-0.281353 --> -0.292760).  Saving model ...
Epoch: 9 cost time: 15.302478075027466
Epoch: 9, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.525 Vali Acc: 0.289 Test Loss: 1.525 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.324180126190186
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 2.153 Vali Acc: 0.243 Test Loss: 2.153 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.132988929748535
Epoch: 11, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.794 Vali Acc: 0.247 Test Loss: 1.794 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.417062282562256
Epoch: 12, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.915 Vali Acc: 0.259 Test Loss: 1.915 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.372881889343262
Epoch: 13, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.995 Vali Acc: 0.251 Test Loss: 1.995 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 15.412776947021484
Epoch: 14, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.291 Vali Acc: 0.281 Test Loss: 2.291 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 15.394155740737915
Epoch: 15, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.861 Vali Acc: 0.259 Test Loss: 1.861 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.003164052963257
Epoch: 16, Steps: 17 | Train Loss: 0.970 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.782001256942749
Epoch: 17, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.084 Vali Acc: 0.278 Test Loss: 2.084 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 16.06045150756836
Epoch: 18, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.971 Vali Acc: 0.247 Test Loss: 1.971 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1396836
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.926604986190796
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.501 Vali Acc: 0.240 Test Loss: 1.501 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 7.4933483600616455
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
Validation loss decreased (-0.239529 --> -0.254736).  Saving model ...
Epoch: 3 cost time: 7.208866119384766
Epoch: 3, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.777 Vali Acc: 0.266 Test Loss: 1.777 Test Acc: 0.266
Validation loss decreased (-0.254736 --> -0.266142).  Saving model ...
Epoch: 4 cost time: 6.728406667709351
Epoch: 4, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.777 Vali Acc: 0.255 Test Loss: 1.777 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.830773830413818
Epoch: 5, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.641 Vali Acc: 0.247 Test Loss: 1.641 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.649983882904053
Epoch: 6, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.998 Vali Acc: 0.213 Test Loss: 1.998 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.652661085128784
Epoch: 7, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.876 Vali Acc: 0.251 Test Loss: 1.876 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.69841194152832
Epoch: 8, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.888 Vali Acc: 0.281 Test Loss: 1.888 Test Acc: 0.281
Validation loss decreased (-0.266142 --> -0.281350).  Saving model ...
Epoch: 9 cost time: 7.688731908798218
Epoch: 9, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.691676616668701
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.949 Vali Acc: 0.266 Test Loss: 1.949 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.398243427276611
Epoch: 11, Steps: 17 | Train Loss: 1.369 Vali Loss: 2.238 Vali Acc: 0.255 Test Loss: 2.238 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.4645795822143555
Epoch: 12, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.878 Vali Acc: 0.232 Test Loss: 1.878 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.606856107711792
Epoch: 13, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.840 Vali Acc: 0.270 Test Loss: 1.840 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.454409837722778
Epoch: 14, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.406 Vali Acc: 0.228 Test Loss: 2.406 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.509824752807617
Epoch: 15, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.071485280990601
Epoch: 16, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.089 Vali Acc: 0.255 Test Loss: 2.089 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.201753616333008
Epoch: 17, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.915 Vali Acc: 0.266 Test Loss: 1.915 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.1451005935668945
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 2.503 Vali Acc: 0.228 Test Loss: 2.503 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 569188
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.71817398071289
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 11.55906057357788
Epoch: 2, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.929 Vali Acc: 0.251 Test Loss: 1.929 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.219823122024536
Epoch: 3, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.453 Vali Acc: 0.274 Test Loss: 1.453 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 10.902904510498047
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.605 Vali Acc: 0.281 Test Loss: 1.605 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 5 cost time: 11.495419979095459
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.516602993011475
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.693 Vali Acc: 0.247 Test Loss: 1.693 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.515371799468994
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.937 Vali Acc: 0.232 Test Loss: 1.937 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.48206353187561
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.591 Vali Acc: 0.293 Test Loss: 1.591 Test Acc: 0.293
Validation loss decreased (-0.281353 --> -0.292760).  Saving model ...
Epoch: 9 cost time: 10.651034593582153
Epoch: 9, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.525 Vali Acc: 0.289 Test Loss: 1.525 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.455775022506714
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 2.153 Vali Acc: 0.243 Test Loss: 2.153 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.152965784072876
Epoch: 11, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.794 Vali Acc: 0.247 Test Loss: 1.794 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.96148419380188
Epoch: 12, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.915 Vali Acc: 0.259 Test Loss: 1.915 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.05332350730896
Epoch: 13, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.995 Vali Acc: 0.251 Test Loss: 1.995 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.900848150253296
Epoch: 14, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.291 Vali Acc: 0.281 Test Loss: 2.291 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.541645288467407
Epoch: 15, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.861 Vali Acc: 0.259 Test Loss: 1.861 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.796542644500732
Epoch: 16, Steps: 17 | Train Loss: 0.970 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 11.908581972122192
Epoch: 17, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.084 Vali Acc: 0.278 Test Loss: 2.084 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 11.43990969657898
Epoch: 18, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.971 Vali Acc: 0.247 Test Loss: 1.971 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1396836
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.96423864364624
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.501 Vali Acc: 0.240 Test Loss: 1.501 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 5.587979555130005
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
Validation loss decreased (-0.239529 --> -0.254736).  Saving model ...
Epoch: 3 cost time: 5.579955577850342
Epoch: 3, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.777 Vali Acc: 0.266 Test Loss: 1.777 Test Acc: 0.266
Validation loss decreased (-0.254736 --> -0.266142).  Saving model ...
Epoch: 4 cost time: 5.325359344482422
Epoch: 4, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.777 Vali Acc: 0.255 Test Loss: 1.777 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.20326042175293
Epoch: 5, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.641 Vali Acc: 0.247 Test Loss: 1.641 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.1471030712127686
Epoch: 6, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.998 Vali Acc: 0.213 Test Loss: 1.998 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.047909259796143
Epoch: 7, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.876 Vali Acc: 0.251 Test Loss: 1.876 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.630508899688721
Epoch: 8, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.888 Vali Acc: 0.281 Test Loss: 1.888 Test Acc: 0.281
Validation loss decreased (-0.266142 --> -0.281350).  Saving model ...
Epoch: 9 cost time: 5.676942586898804
Epoch: 9, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.592117786407471
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.949 Vali Acc: 0.266 Test Loss: 1.949 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.616472959518433
Epoch: 11, Steps: 17 | Train Loss: 1.369 Vali Loss: 2.238 Vali Acc: 0.255 Test Loss: 2.238 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.663861989974976
Epoch: 12, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.878 Vali Acc: 0.232 Test Loss: 1.878 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.627217531204224
Epoch: 13, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.840 Vali Acc: 0.270 Test Loss: 1.840 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.645224094390869
Epoch: 14, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.406 Vali Acc: 0.228 Test Loss: 2.406 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.800976514816284
Epoch: 15, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.253274917602539
Epoch: 16, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.089 Vali Acc: 0.255 Test Loss: 2.089 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.254430294036865
Epoch: 17, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.915 Vali Acc: 0.266 Test Loss: 1.915 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.247503042221069
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 2.503 Vali Acc: 0.228 Test Loss: 2.503 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 569188
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.881594896316528
Epoch: 1, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 7.6180315017700195
Epoch: 2, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.929 Vali Acc: 0.251 Test Loss: 1.929 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.814531326293945
Epoch: 3, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.453 Vali Acc: 0.274 Test Loss: 1.453 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 7.964488506317139
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.605 Vali Acc: 0.281 Test Loss: 1.605 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281353).  Saving model ...
Epoch: 5 cost time: 7.985276699066162
Epoch: 5, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.022857666015625
Epoch: 6, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.693 Vali Acc: 0.247 Test Loss: 1.693 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.347662448883057
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.937 Vali Acc: 0.232 Test Loss: 1.937 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.118987083435059
Epoch: 8, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.591 Vali Acc: 0.293 Test Loss: 1.591 Test Acc: 0.293
Validation loss decreased (-0.281353 --> -0.292760).  Saving model ...
Epoch: 9 cost time: 7.974042892456055
Epoch: 9, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.525 Vali Acc: 0.289 Test Loss: 1.525 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.959251165390015
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 2.153 Vali Acc: 0.243 Test Loss: 2.153 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.016443252563477
Epoch: 11, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.794 Vali Acc: 0.247 Test Loss: 1.794 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.983257055282593
Epoch: 12, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.915 Vali Acc: 0.259 Test Loss: 1.915 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.7654030323028564
Epoch: 13, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.995 Vali Acc: 0.251 Test Loss: 1.995 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.637446403503418
Epoch: 14, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.291 Vali Acc: 0.281 Test Loss: 2.291 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.617210388183594
Epoch: 15, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.861 Vali Acc: 0.259 Test Loss: 1.861 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.992705583572388
Epoch: 16, Steps: 17 | Train Loss: 0.970 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.052205562591553
Epoch: 17, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.084 Vali Acc: 0.278 Test Loss: 2.084 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.381046533584595
Epoch: 18, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.971 Vali Acc: 0.247 Test Loss: 1.971 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1396836
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.167535066604614
Epoch: 1, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.501 Vali Acc: 0.240 Test Loss: 1.501 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 3.956242322921753
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
Validation loss decreased (-0.239529 --> -0.254736).  Saving model ...
Epoch: 3 cost time: 4.044005870819092
Epoch: 3, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.777 Vali Acc: 0.266 Test Loss: 1.777 Test Acc: 0.266
Validation loss decreased (-0.254736 --> -0.266142).  Saving model ...
Epoch: 4 cost time: 3.9927783012390137
Epoch: 4, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.777 Vali Acc: 0.255 Test Loss: 1.777 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.959591865539551
Epoch: 5, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.641 Vali Acc: 0.247 Test Loss: 1.641 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9695022106170654
Epoch: 6, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.998 Vali Acc: 0.213 Test Loss: 1.998 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9593312740325928
Epoch: 7, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.876 Vali Acc: 0.251 Test Loss: 1.876 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.95636248588562
Epoch: 8, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.888 Vali Acc: 0.281 Test Loss: 1.888 Test Acc: 0.281
Validation loss decreased (-0.266142 --> -0.281350).  Saving model ...
Epoch: 9 cost time: 3.678007125854492
Epoch: 9, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6263790130615234
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.949 Vali Acc: 0.266 Test Loss: 1.949 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6669232845306396
Epoch: 11, Steps: 17 | Train Loss: 1.369 Vali Loss: 2.238 Vali Acc: 0.255 Test Loss: 2.238 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.63288950920105
Epoch: 12, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.878 Vali Acc: 0.232 Test Loss: 1.878 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.64384126663208
Epoch: 13, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.840 Vali Acc: 0.270 Test Loss: 1.840 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6394882202148438
Epoch: 14, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.406 Vali Acc: 0.228 Test Loss: 2.406 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.692315101623535
Epoch: 15, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.723543643951416
Epoch: 16, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.088 Vali Acc: 0.255 Test Loss: 2.088 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5717289447784424
Epoch: 17, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.915 Vali Acc: 0.266 Test Loss: 1.915 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.577946424484253
Epoch: 18, Steps: 17 | Train Loss: 1.196 Vali Loss: 2.503 Vali Acc: 0.228 Test Loss: 2.503 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 569188
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.672332048416138
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.531 Vali Acc: 0.255 Test Loss: 1.531 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 16.74309015274048
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.428 Vali Acc: 0.228 Test Loss: 1.428 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.94655680656433
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.620 Vali Acc: 0.262 Test Loss: 1.620 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 16.626489400863647
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.674 Vali Acc: 0.255 Test Loss: 1.674 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.11612582206726
Epoch: 5, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.37218928337097
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.435 Vali Acc: 0.266 Test Loss: 1.435 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266145).  Saving model ...
Epoch: 7 cost time: 15.513227462768555
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.677 Vali Acc: 0.209 Test Loss: 1.677 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.288808584213257
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.525 Vali Acc: 0.259 Test Loss: 1.525 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.878843069076538
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.44073224067688
Epoch: 10, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 11 cost time: 17.294410228729248
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.877 Vali Acc: 0.266 Test Loss: 1.877 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.832591772079468
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.295337438583374
Epoch: 13, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.561 Vali Acc: 0.278 Test Loss: 1.561 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277551).  Saving model ...
Epoch: 14 cost time: 17.204822540283203
Epoch: 14, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.576 Vali Acc: 0.236 Test Loss: 1.576 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 15.931243658065796
Epoch: 15, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.640 Vali Acc: 0.270 Test Loss: 1.640 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.98764967918396
Epoch: 16, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.720 Vali Acc: 0.293 Test Loss: 1.720 Test Acc: 0.293
Validation loss decreased (-0.277551 --> -0.292758).  Saving model ...
Epoch: 17 cost time: 16.91015625
Epoch: 17, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.734 Vali Acc: 0.243 Test Loss: 1.734 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.432515859603882
Epoch: 18, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.858 Vali Acc: 0.281 Test Loss: 1.858 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.73343849182129
Epoch: 19, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.387 Vali Acc: 0.278 Test Loss: 2.387 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 15.568394899368286
Epoch: 20, Steps: 17 | Train Loss: 1.058 Vali Loss: 2.078 Vali Acc: 0.259 Test Loss: 2.078 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.136595249176025
Epoch: 21, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.876 Vali Acc: 0.240 Test Loss: 1.876 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.272900342941284
Epoch: 22, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.902 Vali Acc: 0.221 Test Loss: 1.902 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 15.97114610671997
Epoch: 23, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 17.20889449119568
Epoch: 24, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.994 Vali Acc: 0.262 Test Loss: 1.994 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 16.285014390945435
Epoch: 25, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.087 Vali Acc: 0.243 Test Loss: 2.087 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 17.028306007385254
Epoch: 26, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.103 Vali Acc: 0.251 Test Loss: 2.103 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1284724
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.829978704452515
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.456 Vali Acc: 0.270 Test Loss: 1.456 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 7.209208011627197
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.352659702301025
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.706 Vali Acc: 0.255 Test Loss: 1.706 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.397488117218018
Epoch: 4, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.443 Vali Acc: 0.243 Test Loss: 1.443 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.364436149597168
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.90217661857605
Epoch: 6, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.524 Vali Acc: 0.247 Test Loss: 1.524 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.303063869476318
Epoch: 7, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.746 Vali Acc: 0.224 Test Loss: 1.746 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.360592126846313
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.267448425292969
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.499 Vali Acc: 0.274 Test Loss: 1.499 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273749).  Saving model ...
Epoch: 10 cost time: 8.399711847305298
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.666 Vali Acc: 0.274 Test Loss: 1.666 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.02955174446106
Epoch: 11, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.860 Vali Acc: 0.228 Test Loss: 1.860 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.946743726730347
Epoch: 12, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.613 Vali Acc: 0.289 Test Loss: 1.613 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288957).  Saving model ...
Epoch: 13 cost time: 8.02625036239624
Epoch: 13, Steps: 17 | Train Loss: 1.305 Vali Loss: 2.174 Vali Acc: 0.228 Test Loss: 2.174 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.048149585723877
Epoch: 14, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.700 Vali Acc: 0.285 Test Loss: 1.700 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.129656791687012
Epoch: 15, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.605 Vali Acc: 0.262 Test Loss: 1.605 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.889162540435791
Epoch: 16, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.902 Vali Acc: 0.262 Test Loss: 1.902 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.146965980529785
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.696 Vali Acc: 0.247 Test Loss: 1.696 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.075576066970825
Epoch: 18, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.05911135673523
Epoch: 19, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.916 Vali Acc: 0.247 Test Loss: 1.916 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.03604507446289
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 2.408 Vali Acc: 0.274 Test Loss: 2.408 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.054411172866821
Epoch: 21, Steps: 17 | Train Loss: 1.000 Vali Loss: 2.048 Vali Acc: 0.259 Test Loss: 2.048 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.134092092514038
Epoch: 22, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.106 Vali Acc: 0.259 Test Loss: 2.106 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 457012
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.678931951522827
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.531 Vali Acc: 0.255 Test Loss: 1.531 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 12.41180419921875
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.428 Vali Acc: 0.228 Test Loss: 1.428 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.161778450012207
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.620 Vali Acc: 0.262 Test Loss: 1.620 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 12.345591068267822
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.674 Vali Acc: 0.255 Test Loss: 1.674 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.920927047729492
Epoch: 5, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.932202816009521
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.435 Vali Acc: 0.266 Test Loss: 1.435 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266145).  Saving model ...
Epoch: 7 cost time: 12.408851861953735
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.677 Vali Acc: 0.209 Test Loss: 1.677 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.901972532272339
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.525 Vali Acc: 0.259 Test Loss: 1.525 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.884600400924683
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.699049949645996
Epoch: 10, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 11 cost time: 12.357704401016235
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.877 Vali Acc: 0.266 Test Loss: 1.877 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.44449496269226
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.665525436401367
Epoch: 13, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.561 Vali Acc: 0.278 Test Loss: 1.561 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277551).  Saving model ...
Epoch: 14 cost time: 11.790233612060547
Epoch: 14, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.576 Vali Acc: 0.236 Test Loss: 1.576 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.51010274887085
Epoch: 15, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.640 Vali Acc: 0.270 Test Loss: 1.640 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.603756427764893
Epoch: 16, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.720 Vali Acc: 0.293 Test Loss: 1.720 Test Acc: 0.293
Validation loss decreased (-0.277551 --> -0.292758).  Saving model ...
Epoch: 17 cost time: 11.221492290496826
Epoch: 17, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.734 Vali Acc: 0.243 Test Loss: 1.734 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.645197868347168
Epoch: 18, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.858 Vali Acc: 0.281 Test Loss: 1.858 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.24898099899292
Epoch: 19, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.387 Vali Acc: 0.278 Test Loss: 2.387 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 13.367955446243286
Epoch: 20, Steps: 17 | Train Loss: 1.058 Vali Loss: 2.078 Vali Acc: 0.259 Test Loss: 2.078 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 13.254233121871948
Epoch: 21, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.876 Vali Acc: 0.240 Test Loss: 1.876 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 11.850773096084595
Epoch: 22, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.902 Vali Acc: 0.221 Test Loss: 1.902 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 13.856986999511719
Epoch: 23, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 13.910161256790161
Epoch: 24, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.994 Vali Acc: 0.262 Test Loss: 1.994 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 13.594768047332764
Epoch: 25, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.087 Vali Acc: 0.243 Test Loss: 2.087 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.267971992492676
Epoch: 26, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.103 Vali Acc: 0.251 Test Loss: 2.103 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1284724
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.977120637893677
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.456 Vali Acc: 0.270 Test Loss: 1.456 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 6.744213581085205
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.509417533874512
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.706 Vali Acc: 0.255 Test Loss: 1.706 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.6522908210754395
Epoch: 4, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.443 Vali Acc: 0.243 Test Loss: 1.443 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.803211688995361
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.37035870552063
Epoch: 6, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.524 Vali Acc: 0.247 Test Loss: 1.524 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.36981725692749
Epoch: 7, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.746 Vali Acc: 0.224 Test Loss: 1.746 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.382936716079712
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.406335353851318
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.499 Vali Acc: 0.274 Test Loss: 1.499 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273749).  Saving model ...
Epoch: 10 cost time: 6.206251859664917
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.666 Vali Acc: 0.274 Test Loss: 1.666 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.687901258468628
Epoch: 11, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.860 Vali Acc: 0.228 Test Loss: 1.860 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.909895181655884
Epoch: 12, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.613 Vali Acc: 0.289 Test Loss: 1.613 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288957).  Saving model ...
Epoch: 13 cost time: 6.445173501968384
Epoch: 13, Steps: 17 | Train Loss: 1.305 Vali Loss: 2.174 Vali Acc: 0.228 Test Loss: 2.174 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.4420325756073
Epoch: 14, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.700 Vali Acc: 0.285 Test Loss: 1.700 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.461146354675293
Epoch: 15, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.605 Vali Acc: 0.262 Test Loss: 1.605 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.512012004852295
Epoch: 16, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.902 Vali Acc: 0.262 Test Loss: 1.902 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.264108419418335
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.696 Vali Acc: 0.247 Test Loss: 1.696 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.8569176197052
Epoch: 18, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.938319206237793
Epoch: 19, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.916 Vali Acc: 0.247 Test Loss: 1.916 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.505985975265503
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 2.408 Vali Acc: 0.274 Test Loss: 2.408 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.564590930938721
Epoch: 21, Steps: 17 | Train Loss: 1.000 Vali Loss: 2.048 Vali Acc: 0.259 Test Loss: 2.048 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.57658314704895
Epoch: 22, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.106 Vali Acc: 0.259 Test Loss: 2.106 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 457012
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.279973030090332
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.531 Vali Acc: 0.255 Test Loss: 1.531 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 8.454902410507202
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.428 Vali Acc: 0.228 Test Loss: 1.428 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.302474737167358
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.620 Vali Acc: 0.262 Test Loss: 1.620 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 9.27733826637268
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.674 Vali Acc: 0.255 Test Loss: 1.674 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.247987508773804
Epoch: 5, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.281046628952026
Epoch: 6, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.435 Vali Acc: 0.266 Test Loss: 1.435 Test Acc: 0.266
Validation loss decreased (-0.262341 --> -0.266145).  Saving model ...
Epoch: 7 cost time: 8.307536125183105
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.677 Vali Acc: 0.209 Test Loss: 1.677 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.250157833099365
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.525 Vali Acc: 0.259 Test Loss: 1.525 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.240345001220703
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.629 Vali Acc: 0.259 Test Loss: 1.629 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.208048820495605
Epoch: 10, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.533 Vali Acc: 0.274 Test Loss: 1.533 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 11 cost time: 8.873961925506592
Epoch: 11, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.877 Vali Acc: 0.266 Test Loss: 1.877 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.931366443634033
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.660 Vali Acc: 0.240 Test Loss: 1.660 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.839072227478027
Epoch: 13, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.561 Vali Acc: 0.278 Test Loss: 1.561 Test Acc: 0.278
Validation loss decreased (-0.273749 --> -0.277551).  Saving model ...
Epoch: 14 cost time: 8.823999881744385
Epoch: 14, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.576 Vali Acc: 0.236 Test Loss: 1.576 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.843091487884521
Epoch: 15, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.640 Vali Acc: 0.270 Test Loss: 1.640 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.888641834259033
Epoch: 16, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.720 Vali Acc: 0.293 Test Loss: 1.720 Test Acc: 0.293
Validation loss decreased (-0.277551 --> -0.292758).  Saving model ...
Epoch: 17 cost time: 8.019562482833862
Epoch: 17, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.734 Vali Acc: 0.243 Test Loss: 1.734 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.211696147918701
Epoch: 18, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.858 Vali Acc: 0.281 Test Loss: 1.858 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.846281290054321
Epoch: 19, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.387 Vali Acc: 0.278 Test Loss: 2.387 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.928170919418335
Epoch: 20, Steps: 17 | Train Loss: 1.058 Vali Loss: 2.078 Vali Acc: 0.259 Test Loss: 2.078 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.866552591323853
Epoch: 21, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.876 Vali Acc: 0.240 Test Loss: 1.876 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.262120246887207
Epoch: 22, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.902 Vali Acc: 0.221 Test Loss: 1.902 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.041131258010864
Epoch: 23, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.126 Vali Acc: 0.243 Test Loss: 2.126 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.937832593917847
Epoch: 24, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.994 Vali Acc: 0.262 Test Loss: 1.994 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.929992198944092
Epoch: 25, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.087 Vali Acc: 0.243 Test Loss: 2.087 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.931998491287231
Epoch: 26, Steps: 17 | Train Loss: 0.758 Vali Loss: 2.103 Vali Acc: 0.251 Test Loss: 2.103 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 1284724
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.596173048019409
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.456 Vali Acc: 0.270 Test Loss: 1.456 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 4.609651565551758
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.632864236831665
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.706 Vali Acc: 0.255 Test Loss: 1.706 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.551334619522095
Epoch: 4, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.443 Vali Acc: 0.243 Test Loss: 1.443 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.563488483428955
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.588170528411865
Epoch: 6, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.524 Vali Acc: 0.247 Test Loss: 1.524 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.633559703826904
Epoch: 7, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.746 Vali Acc: 0.224 Test Loss: 1.746 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.5892252922058105
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.526 Vali Acc: 0.266 Test Loss: 1.526 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.156071662902832
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.499 Vali Acc: 0.274 Test Loss: 1.499 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273749).  Saving model ...
Epoch: 10 cost time: 4.017750024795532
Epoch: 10, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.666 Vali Acc: 0.274 Test Loss: 1.666 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1395673751831055
Epoch: 11, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.860 Vali Acc: 0.228 Test Loss: 1.860 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.610190391540527
Epoch: 12, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.613 Vali Acc: 0.289 Test Loss: 1.613 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288957).  Saving model ...
Epoch: 13 cost time: 4.605990409851074
Epoch: 13, Steps: 17 | Train Loss: 1.305 Vali Loss: 2.174 Vali Acc: 0.228 Test Loss: 2.174 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.584808111190796
Epoch: 14, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.700 Vali Acc: 0.285 Test Loss: 1.700 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.587613821029663
Epoch: 15, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.605 Vali Acc: 0.262 Test Loss: 1.605 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.417777061462402
Epoch: 16, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.902 Vali Acc: 0.262 Test Loss: 1.902 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.507951259613037
Epoch: 17, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.696 Vali Acc: 0.247 Test Loss: 1.696 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.126559734344482
Epoch: 18, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.709 Vali Acc: 0.266 Test Loss: 1.709 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.989407539367676
Epoch: 19, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.916 Vali Acc: 0.247 Test Loss: 1.916 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.960244655609131
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 2.408 Vali Acc: 0.274 Test Loss: 2.408 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.40286922454834
Epoch: 21, Steps: 17 | Train Loss: 1.000 Vali Loss: 2.048 Vali Acc: 0.259 Test Loss: 2.048 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.404363393783569
Epoch: 22, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.106 Vali Acc: 0.259 Test Loss: 2.106 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 457012
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 13.347379922866821
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.502 Vali Acc: 0.293 Test Loss: 1.502 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 11.13396167755127
Epoch: 2, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.543 Vali Acc: 0.251 Test Loss: 1.543 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.941392183303833
Epoch: 3, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.465 Vali Acc: 0.278 Test Loss: 1.465 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.980612516403198
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.512 Vali Acc: 0.293 Test Loss: 1.512 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.928051948547363
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.874 Vali Acc: 0.240 Test Loss: 1.874 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.44411301612854
Epoch: 6, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.759697198867798
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.440 Vali Acc: 0.304 Test Loss: 1.440 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304168).  Saving model ...
Epoch: 8 cost time: 11.970536231994629
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.675 Vali Acc: 0.228 Test Loss: 1.675 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.015267848968506
Epoch: 9, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.093467235565186
Epoch: 10, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.618 Vali Acc: 0.278 Test Loss: 1.618 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.998368501663208
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.545 Vali Acc: 0.228 Test Loss: 1.545 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.368792057037354
Epoch: 12, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.777 Vali Acc: 0.247 Test Loss: 1.777 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.240929365158081
Epoch: 13, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.617 Vali Acc: 0.285 Test Loss: 1.617 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.467958688735962
Epoch: 14, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.651 Vali Acc: 0.262 Test Loss: 1.651 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.8761727809906
Epoch: 15, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.568 Vali Acc: 0.270 Test Loss: 1.568 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.426407098770142
Epoch: 16, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.914 Vali Acc: 0.232 Test Loss: 1.914 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.974191904067993
Epoch: 17, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.621 Vali Acc: 0.247 Test Loss: 1.621 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 698612
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.5886390209198
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 5.201812982559204
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.8459882736206055
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.447 Vali Acc: 0.270 Test Loss: 1.447 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 5.81650185585022
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.427 Vali Acc: 0.240 Test Loss: 1.427 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.855341196060181
Epoch: 5, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.582 Vali Acc: 0.293 Test Loss: 1.582 Test Acc: 0.293
Validation loss decreased (-0.269948 --> -0.292760).  Saving model ...
Epoch: 6 cost time: 5.8174967765808105
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.444 Vali Acc: 0.278 Test Loss: 1.444 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.795823812484741
Epoch: 7, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.499 Vali Acc: 0.293 Test Loss: 1.499 Test Acc: 0.293
Validation loss decreased (-0.292760 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 5.225655794143677
Epoch: 8, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.480 Vali Acc: 0.251 Test Loss: 1.480 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.21161675453186
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.598 Vali Acc: 0.281 Test Loss: 1.598 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.679951190948486
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.708 Vali Acc: 0.243 Test Loss: 1.708 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.9685468673706055
Epoch: 11, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.724 Vali Acc: 0.285 Test Loss: 1.724 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.75197172164917
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.771 Vali Acc: 0.236 Test Loss: 1.771 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.7671122550964355
Epoch: 13, Steps: 17 | Train Loss: 1.233 Vali Loss: 2.024 Vali Acc: 0.236 Test Loss: 2.024 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.713894605636597
Epoch: 14, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.833 Vali Acc: 0.259 Test Loss: 1.833 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.89124608039856
Epoch: 15, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.757 Vali Acc: 0.262 Test Loss: 1.757 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.212294816970825
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.806 Vali Acc: 0.251 Test Loss: 1.806 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.186319351196289
Epoch: 17, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.834 Vali Acc: 0.251 Test Loss: 1.834 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 284724
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.317075490951538
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.502 Vali Acc: 0.293 Test Loss: 1.502 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 9.401750564575195
Epoch: 2, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.543 Vali Acc: 0.251 Test Loss: 1.543 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.064970016479492
Epoch: 3, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.465 Vali Acc: 0.278 Test Loss: 1.465 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.24510145187378
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.512 Vali Acc: 0.293 Test Loss: 1.512 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.286435604095459
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.874 Vali Acc: 0.240 Test Loss: 1.874 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.976818561553955
Epoch: 6, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.30789589881897
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.440 Vali Acc: 0.304 Test Loss: 1.440 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304168).  Saving model ...
Epoch: 8 cost time: 9.379422903060913
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.675 Vali Acc: 0.228 Test Loss: 1.675 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.182271480560303
Epoch: 9, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.85727310180664
Epoch: 10, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.618 Vali Acc: 0.278 Test Loss: 1.618 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.951278448104858
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.545 Vali Acc: 0.228 Test Loss: 1.545 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.939345121383667
Epoch: 12, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.777 Vali Acc: 0.247 Test Loss: 1.777 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.84116268157959
Epoch: 13, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.617 Vali Acc: 0.285 Test Loss: 1.617 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.038110256195068
Epoch: 14, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.651 Vali Acc: 0.262 Test Loss: 1.651 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.991777420043945
Epoch: 15, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.568 Vali Acc: 0.270 Test Loss: 1.568 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.985994577407837
Epoch: 16, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.914 Vali Acc: 0.232 Test Loss: 1.914 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.06903862953186
Epoch: 17, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.621 Vali Acc: 0.247 Test Loss: 1.621 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 698612
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.2100231647491455
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.600437641143799
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6174709796905518
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.447 Vali Acc: 0.270 Test Loss: 1.447 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 3.9404304027557373
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.427 Vali Acc: 0.240 Test Loss: 1.427 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.942023992538452
Epoch: 5, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.582 Vali Acc: 0.293 Test Loss: 1.582 Test Acc: 0.293
Validation loss decreased (-0.269948 --> -0.292760).  Saving model ...
Epoch: 6 cost time: 3.9036200046539307
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.444 Vali Acc: 0.278 Test Loss: 1.444 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.967317581176758
Epoch: 7, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.499 Vali Acc: 0.293 Test Loss: 1.499 Test Acc: 0.293
Validation loss decreased (-0.292760 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 3.6145331859588623
Epoch: 8, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.480 Vali Acc: 0.251 Test Loss: 1.480 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5346128940582275
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.598 Vali Acc: 0.281 Test Loss: 1.598 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6915180683135986
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.708 Vali Acc: 0.243 Test Loss: 1.708 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.941683530807495
Epoch: 11, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.724 Vali Acc: 0.285 Test Loss: 1.724 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.935944080352783
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.771 Vali Acc: 0.236 Test Loss: 1.771 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9451904296875
Epoch: 13, Steps: 17 | Train Loss: 1.233 Vali Loss: 2.024 Vali Acc: 0.236 Test Loss: 2.024 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8948113918304443
Epoch: 14, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.833 Vali Acc: 0.259 Test Loss: 1.833 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7356019020080566
Epoch: 15, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.757 Vali Acc: 0.262 Test Loss: 1.757 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7611935138702393
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.806 Vali Acc: 0.251 Test Loss: 1.806 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.115912675857544
Epoch: 17, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.834 Vali Acc: 0.251 Test Loss: 1.834 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 284724
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.890813112258911
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.502 Vali Acc: 0.293 Test Loss: 1.502 Test Acc: 0.293
Validation loss decreased (inf --> -0.292761).  Saving model ...
Epoch: 2 cost time: 4.974727630615234
Epoch: 2, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.543 Vali Acc: 0.251 Test Loss: 1.543 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.114790678024292
Epoch: 3, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.465 Vali Acc: 0.278 Test Loss: 1.465 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.55983567237854
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.512 Vali Acc: 0.293 Test Loss: 1.512 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.613747835159302
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.874 Vali Acc: 0.240 Test Loss: 1.874 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.60181736946106
Epoch: 6, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.076543807983398
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.440 Vali Acc: 0.304 Test Loss: 1.440 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304168).  Saving model ...
Epoch: 8 cost time: 5.0748536586761475
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.675 Vali Acc: 0.228 Test Loss: 1.675 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.3752381801605225
Epoch: 9, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.535 Vali Acc: 0.259 Test Loss: 1.535 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.4137046337127686
Epoch: 10, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.618 Vali Acc: 0.278 Test Loss: 1.618 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.422271728515625
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.545 Vali Acc: 0.228 Test Loss: 1.545 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.905896902084351
Epoch: 12, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.777 Vali Acc: 0.247 Test Loss: 1.777 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.966588973999023
Epoch: 13, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.617 Vali Acc: 0.285 Test Loss: 1.617 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.434962511062622
Epoch: 14, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.651 Vali Acc: 0.262 Test Loss: 1.651 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.422515630722046
Epoch: 15, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.568 Vali Acc: 0.270 Test Loss: 1.568 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.437604188919067
Epoch: 16, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.914 Vali Acc: 0.232 Test Loss: 1.914 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.069839239120483
Epoch: 17, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.621 Vali Acc: 0.247 Test Loss: 1.621 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 698612
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.235583543777466
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.8010871410369873
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.446 Vali Acc: 0.232 Test Loss: 1.446 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7896921634674072
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.447 Vali Acc: 0.270 Test Loss: 1.447 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 2.780339479446411
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.427 Vali Acc: 0.240 Test Loss: 1.427 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5704636573791504
Epoch: 5, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.582 Vali Acc: 0.293 Test Loss: 1.582 Test Acc: 0.293
Validation loss decreased (-0.269948 --> -0.292760).  Saving model ...
Epoch: 6 cost time: 2.49436354637146
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.444 Vali Acc: 0.278 Test Loss: 1.444 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5458192825317383
Epoch: 7, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.499 Vali Acc: 0.293 Test Loss: 1.499 Test Acc: 0.293
Validation loss decreased (-0.292760 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 2.8044450283050537
Epoch: 8, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.480 Vali Acc: 0.251 Test Loss: 1.480 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8107194900512695
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.598 Vali Acc: 0.281 Test Loss: 1.598 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.761216402053833
Epoch: 10, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.708 Vali Acc: 0.243 Test Loss: 1.708 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8487603664398193
Epoch: 11, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.724 Vali Acc: 0.285 Test Loss: 1.724 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7998592853546143
Epoch: 12, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.771 Vali Acc: 0.236 Test Loss: 1.771 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7838633060455322
Epoch: 13, Steps: 17 | Train Loss: 1.233 Vali Loss: 2.024 Vali Acc: 0.236 Test Loss: 2.024 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5597004890441895
Epoch: 14, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.833 Vali Acc: 0.259 Test Loss: 1.833 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.570378065109253
Epoch: 15, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.757 Vali Acc: 0.262 Test Loss: 1.757 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5508766174316406
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.806 Vali Acc: 0.251 Test Loss: 1.806 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8306310176849365
Epoch: 17, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.834 Vali Acc: 0.251 Test Loss: 1.834 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 284724
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.224503517150879
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 7.998302459716797
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.834195852279663
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.398 Vali Acc: 0.266 Test Loss: 1.398 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.595650672912598
Epoch: 4, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.785 Vali Acc: 0.251 Test Loss: 1.785 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.209747076034546
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.355140686035156
Epoch: 6, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.693 Vali Acc: 0.243 Test Loss: 1.693 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.861233949661255
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.621 Vali Acc: 0.274 Test Loss: 1.621 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273748).  Saving model ...
Epoch: 8 cost time: 8.349643230438232
Epoch: 8, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.790 Vali Acc: 0.243 Test Loss: 1.790 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.68157958984375
Epoch: 9, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.459170579910278
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.857 Vali Acc: 0.274 Test Loss: 1.857 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.482576608657837
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.810 Vali Acc: 0.224 Test Loss: 1.810 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.257845878601074
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.534 Vali Acc: 0.243 Test Loss: 1.534 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.740777254104614
Epoch: 13, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.693 Vali Acc: 0.285 Test Loss: 1.693 Test Acc: 0.285
Validation loss decreased (-0.273748 --> -0.285154).  Saving model ...
Epoch: 14 cost time: 8.543710470199585
Epoch: 14, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.593 Vali Acc: 0.247 Test Loss: 1.593 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.494752883911133
Epoch: 15, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.652 Vali Acc: 0.274 Test Loss: 1.652 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.737905740737915
Epoch: 16, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.650 Vali Acc: 0.259 Test Loss: 1.650 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.29709768295288
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.644 Vali Acc: 0.262 Test Loss: 1.644 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.52586579322815
Epoch: 18, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.720 Vali Acc: 0.312 Test Loss: 1.720 Test Acc: 0.312
Validation loss decreased (-0.285154 --> -0.311770).  Saving model ...
Epoch: 19 cost time: 8.544477462768555
Epoch: 19, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.803 Vali Acc: 0.266 Test Loss: 1.803 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.749698638916016
Epoch: 20, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.874 Vali Acc: 0.281 Test Loss: 1.874 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.488781690597534
Epoch: 21, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.008 Vali Acc: 0.289 Test Loss: 2.008 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.498403072357178
Epoch: 22, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.788 Vali Acc: 0.251 Test Loss: 1.788 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.61965012550354
Epoch: 23, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.715 Vali Acc: 0.293 Test Loss: 1.715 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.397482872009277
Epoch: 24, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.083 Vali Acc: 0.270 Test Loss: 2.083 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.832870483398438
Epoch: 25, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.125 Vali Acc: 0.262 Test Loss: 2.125 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 8.802101373672485
Epoch: 26, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.900 Vali Acc: 0.297 Test Loss: 1.900 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.865046262741089
Epoch: 27, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.974 Vali Acc: 0.240 Test Loss: 1.974 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 8.817360639572144
Epoch: 28, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.939 Vali Acc: 0.255 Test Loss: 1.939 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 405556
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.256772518157959
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.483 Vali Acc: 0.224 Test Loss: 1.483 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 3.9292097091674805
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
Validation loss decreased (-0.224320 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 4.3661816120147705
Epoch: 3, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.510 Vali Acc: 0.243 Test Loss: 1.510 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.524671316146851
Epoch: 4, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.898 Vali Acc: 0.236 Test Loss: 1.898 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.446044445037842
Epoch: 5, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.517 Vali Acc: 0.278 Test Loss: 1.517 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277551).  Saving model ...
Epoch: 6 cost time: 4.476151943206787
Epoch: 6, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.665 Vali Acc: 0.247 Test Loss: 1.665 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.158461093902588
Epoch: 7, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.706 Vali Acc: 0.232 Test Loss: 1.706 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.10240364074707
Epoch: 8, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.677 Vali Acc: 0.232 Test Loss: 1.677 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.514505624771118
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.572 Vali Acc: 0.266 Test Loss: 1.572 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3059194087982178
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.676 Vali Acc: 0.270 Test Loss: 1.676 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0835683345794678
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.536 Vali Acc: 0.278 Test Loss: 1.536 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0649778842926025
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.661 Vali Acc: 0.285 Test Loss: 1.661 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285154).  Saving model ...
Epoch: 13 cost time: 4.4681079387664795
Epoch: 13, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.616 Vali Acc: 0.247 Test Loss: 1.616 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.419607877731323
Epoch: 14, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.576 Vali Acc: 0.297 Test Loss: 1.576 Test Acc: 0.297
Validation loss decreased (-0.285154 --> -0.296562).  Saving model ...
Epoch: 15 cost time: 4.815633535385132
Epoch: 15, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.531 Vali Acc: 0.285 Test Loss: 1.531 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.809125661849976
Epoch: 16, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.974 Vali Acc: 0.217 Test Loss: 1.974 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.727579116821289
Epoch: 17, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.694 Vali Acc: 0.281 Test Loss: 1.694 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.798401355743408
Epoch: 18, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.891 Vali Acc: 0.255 Test Loss: 1.891 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.6284613609313965
Epoch: 19, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.792 Vali Acc: 0.243 Test Loss: 1.792 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.350297212600708
Epoch: 20, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.634 Vali Acc: 0.278 Test Loss: 1.634 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.395085096359253
Epoch: 21, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.094 Vali Acc: 0.224 Test Loss: 2.094 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.758118391036987
Epoch: 22, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.873 Vali Acc: 0.243 Test Loss: 1.873 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.799144506454468
Epoch: 23, Steps: 17 | Train Loss: 1.199 Vali Loss: 2.140 Vali Acc: 0.255 Test Loss: 2.140 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.802669525146484
Epoch: 24, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.781 Vali Acc: 0.270 Test Loss: 1.781 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 198580
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.199483633041382
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 7.527114152908325
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.525345087051392
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.398 Vali Acc: 0.266 Test Loss: 1.398 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.4507715702056885
Epoch: 4, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.785 Vali Acc: 0.251 Test Loss: 1.785 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.97077202796936
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.052186489105225
Epoch: 6, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.693 Vali Acc: 0.243 Test Loss: 1.693 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.531334161758423
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.621 Vali Acc: 0.274 Test Loss: 1.621 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273748).  Saving model ...
Epoch: 8 cost time: 7.517294645309448
Epoch: 8, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.790 Vali Acc: 0.243 Test Loss: 1.790 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.201009750366211
Epoch: 9, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.455350637435913
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.857 Vali Acc: 0.274 Test Loss: 1.857 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.285387754440308
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.810 Vali Acc: 0.224 Test Loss: 1.810 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.174591302871704
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.534 Vali Acc: 0.243 Test Loss: 1.534 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.11210823059082
Epoch: 13, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.693 Vali Acc: 0.285 Test Loss: 1.693 Test Acc: 0.285
Validation loss decreased (-0.273748 --> -0.285154).  Saving model ...
Epoch: 14 cost time: 6.614569425582886
Epoch: 14, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.593 Vali Acc: 0.247 Test Loss: 1.593 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.4967591762542725
Epoch: 15, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.652 Vali Acc: 0.274 Test Loss: 1.652 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.903817415237427
Epoch: 16, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.650 Vali Acc: 0.259 Test Loss: 1.650 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.106659650802612
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.644 Vali Acc: 0.262 Test Loss: 1.644 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.1898744106292725
Epoch: 18, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.720 Vali Acc: 0.312 Test Loss: 1.720 Test Acc: 0.312
Validation loss decreased (-0.285154 --> -0.311770).  Saving model ...
Epoch: 19 cost time: 6.541349649429321
Epoch: 19, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.803 Vali Acc: 0.266 Test Loss: 1.803 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.202487230300903
Epoch: 20, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.874 Vali Acc: 0.281 Test Loss: 1.874 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.318859815597534
Epoch: 21, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.008 Vali Acc: 0.289 Test Loss: 2.008 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.394908428192139
Epoch: 22, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.788 Vali Acc: 0.251 Test Loss: 1.788 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.578588962554932
Epoch: 23, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.715 Vali Acc: 0.293 Test Loss: 1.715 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.859093189239502
Epoch: 24, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.083 Vali Acc: 0.270 Test Loss: 2.083 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.4909281730651855
Epoch: 25, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.125 Vali Acc: 0.262 Test Loss: 2.125 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.5700364112854
Epoch: 26, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.900 Vali Acc: 0.297 Test Loss: 1.900 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.474713325500488
Epoch: 27, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.974 Vali Acc: 0.240 Test Loss: 1.974 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.950315952301025
Epoch: 28, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.939 Vali Acc: 0.255 Test Loss: 1.939 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 405556
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.0625388622283936
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.483 Vali Acc: 0.224 Test Loss: 1.483 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 3.7807111740112305
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
Validation loss decreased (-0.224320 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 3.804229259490967
Epoch: 3, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.510 Vali Acc: 0.243 Test Loss: 1.510 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5092408657073975
Epoch: 4, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.898 Vali Acc: 0.236 Test Loss: 1.898 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4705650806427
Epoch: 5, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.517 Vali Acc: 0.278 Test Loss: 1.517 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277551).  Saving model ...
Epoch: 6 cost time: 3.5041301250457764
Epoch: 6, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.665 Vali Acc: 0.247 Test Loss: 1.665 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.919736385345459
Epoch: 7, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.706 Vali Acc: 0.232 Test Loss: 1.706 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7699923515319824
Epoch: 8, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.677 Vali Acc: 0.232 Test Loss: 1.677 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.80800461769104
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.572 Vali Acc: 0.266 Test Loss: 1.572 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.8445420265197754
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.676 Vali Acc: 0.270 Test Loss: 1.676 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.758286237716675
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.536 Vali Acc: 0.278 Test Loss: 1.536 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4878175258636475
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.661 Vali Acc: 0.285 Test Loss: 1.661 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285154).  Saving model ...
Epoch: 13 cost time: 3.4766721725463867
Epoch: 13, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.616 Vali Acc: 0.247 Test Loss: 1.616 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4016778469085693
Epoch: 14, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.576 Vali Acc: 0.297 Test Loss: 1.576 Test Acc: 0.297
Validation loss decreased (-0.285154 --> -0.296562).  Saving model ...
Epoch: 15 cost time: 3.4509494304656982
Epoch: 15, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.531 Vali Acc: 0.285 Test Loss: 1.531 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1064109802246094
Epoch: 16, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.974 Vali Acc: 0.217 Test Loss: 1.974 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.726658582687378
Epoch: 17, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.694 Vali Acc: 0.281 Test Loss: 1.694 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.310118198394775
Epoch: 18, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.891 Vali Acc: 0.255 Test Loss: 1.891 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.35901665687561
Epoch: 19, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.792 Vali Acc: 0.243 Test Loss: 1.792 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.238487482070923
Epoch: 20, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.634 Vali Acc: 0.278 Test Loss: 1.634 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.29306173324585
Epoch: 21, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.094 Vali Acc: 0.224 Test Loss: 2.094 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.259000062942505
Epoch: 22, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.873 Vali Acc: 0.243 Test Loss: 1.873 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.291409492492676
Epoch: 23, Steps: 17 | Train Loss: 1.199 Vali Loss: 2.140 Vali Acc: 0.255 Test Loss: 2.140 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.260552644729614
Epoch: 24, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.781 Vali Acc: 0.270 Test Loss: 1.781 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 198580
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.617103338241577
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 4.976623773574829
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.122009992599487
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.398 Vali Acc: 0.266 Test Loss: 1.398 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.093696355819702
Epoch: 4, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.785 Vali Acc: 0.251 Test Loss: 1.785 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.359348773956299
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.4279820919036865
Epoch: 6, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.693 Vali Acc: 0.243 Test Loss: 1.693 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.607757806777954
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.621 Vali Acc: 0.274 Test Loss: 1.621 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273748).  Saving model ...
Epoch: 8 cost time: 5.629699945449829
Epoch: 8, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.790 Vali Acc: 0.243 Test Loss: 1.790 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.671497821807861
Epoch: 9, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.520 Vali Acc: 0.266 Test Loss: 1.520 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.605872869491577
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.857 Vali Acc: 0.274 Test Loss: 1.857 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.597147226333618
Epoch: 11, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.810 Vali Acc: 0.224 Test Loss: 1.810 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.626661539077759
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.534 Vali Acc: 0.243 Test Loss: 1.534 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.990593433380127
Epoch: 13, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.693 Vali Acc: 0.285 Test Loss: 1.693 Test Acc: 0.285
Validation loss decreased (-0.273748 --> -0.285154).  Saving model ...
Epoch: 14 cost time: 4.963806629180908
Epoch: 14, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.593 Vali Acc: 0.247 Test Loss: 1.593 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.073458433151245
Epoch: 15, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.652 Vali Acc: 0.274 Test Loss: 1.652 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.011673927307129
Epoch: 16, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.650 Vali Acc: 0.259 Test Loss: 1.650 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.7188804149627686
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.644 Vali Acc: 0.262 Test Loss: 1.644 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.691959857940674
Epoch: 18, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.720 Vali Acc: 0.312 Test Loss: 1.720 Test Acc: 0.312
Validation loss decreased (-0.285154 --> -0.311770).  Saving model ...
Epoch: 19 cost time: 5.699060916900635
Epoch: 19, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.803 Vali Acc: 0.266 Test Loss: 1.803 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.7285284996032715
Epoch: 20, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.874 Vali Acc: 0.281 Test Loss: 1.874 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.646989583969116
Epoch: 21, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.008 Vali Acc: 0.289 Test Loss: 2.008 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.688058853149414
Epoch: 22, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.788 Vali Acc: 0.251 Test Loss: 1.788 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.67485499382019
Epoch: 23, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.715 Vali Acc: 0.293 Test Loss: 1.715 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.657375812530518
Epoch: 24, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.083 Vali Acc: 0.270 Test Loss: 2.083 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.185787200927734
Epoch: 25, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.125 Vali Acc: 0.262 Test Loss: 2.125 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.199060440063477
Epoch: 26, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.900 Vali Acc: 0.297 Test Loss: 1.900 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.204444885253906
Epoch: 27, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.974 Vali Acc: 0.240 Test Loss: 1.974 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.101531267166138
Epoch: 28, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.939 Vali Acc: 0.255 Test Loss: 1.939 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 405556
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.244474172592163
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.483 Vali Acc: 0.224 Test Loss: 1.483 Test Acc: 0.224
Validation loss decreased (inf --> -0.224320).  Saving model ...
Epoch: 2 cost time: 3.099156141281128
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
Validation loss decreased (-0.224320 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 3.0920557975769043
Epoch: 3, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.510 Vali Acc: 0.243 Test Loss: 1.510 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.074629783630371
Epoch: 4, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.898 Vali Acc: 0.236 Test Loss: 1.898 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0735816955566406
Epoch: 5, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.517 Vali Acc: 0.278 Test Loss: 1.517 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277551).  Saving model ...
Epoch: 6 cost time: 3.048093318939209
Epoch: 6, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.665 Vali Acc: 0.247 Test Loss: 1.665 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0588202476501465
Epoch: 7, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.706 Vali Acc: 0.232 Test Loss: 1.706 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.060849905014038
Epoch: 8, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.677 Vali Acc: 0.232 Test Loss: 1.677 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0272018909454346
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.572 Vali Acc: 0.266 Test Loss: 1.572 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.062133312225342
Epoch: 10, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.676 Vali Acc: 0.270 Test Loss: 1.676 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1806161403656006
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.536 Vali Acc: 0.278 Test Loss: 1.536 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.708688259124756
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.661 Vali Acc: 0.285 Test Loss: 1.661 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285154).  Saving model ...
Epoch: 13 cost time: 2.7762110233306885
Epoch: 13, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.616 Vali Acc: 0.247 Test Loss: 1.616 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.779850721359253
Epoch: 14, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.576 Vali Acc: 0.297 Test Loss: 1.576 Test Acc: 0.297
Validation loss decreased (-0.285154 --> -0.296562).  Saving model ...
Epoch: 15 cost time: 2.8389570713043213
Epoch: 15, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.531 Vali Acc: 0.285 Test Loss: 1.531 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8000729084014893
Epoch: 16, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.974 Vali Acc: 0.217 Test Loss: 1.974 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.717682123184204
Epoch: 17, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.694 Vali Acc: 0.281 Test Loss: 1.694 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9096505641937256
Epoch: 18, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.891 Vali Acc: 0.255 Test Loss: 1.891 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9570910930633545
Epoch: 19, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.792 Vali Acc: 0.243 Test Loss: 1.792 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.943237781524658
Epoch: 20, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.634 Vali Acc: 0.278 Test Loss: 1.634 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.9324049949645996
Epoch: 21, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.094 Vali Acc: 0.224 Test Loss: 2.094 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9674296379089355
Epoch: 22, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.873 Vali Acc: 0.243 Test Loss: 1.873 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.011258602142334
Epoch: 23, Steps: 17 | Train Loss: 1.199 Vali Loss: 2.140 Vali Acc: 0.255 Test Loss: 2.140 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.994608163833618
Epoch: 24, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.781 Vali Acc: 0.270 Test Loss: 1.781 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 198580
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 17.325233221054077
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 14.665326833724976
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.485449314117432
Epoch: 3, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.980723857879639
Epoch: 4, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 16.006927013397217
Epoch: 5, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.481 Vali Acc: 0.251 Test Loss: 1.481 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.046515464782715
Epoch: 6, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.506 Vali Acc: 0.266 Test Loss: 1.506 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.803979873657227
Epoch: 7, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.495 Vali Acc: 0.274 Test Loss: 1.495 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 8 cost time: 14.938017845153809
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.475 Vali Acc: 0.247 Test Loss: 1.475 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.42452311515808
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.470 Vali Acc: 0.255 Test Loss: 1.470 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.406644344329834
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 16.408342361450195
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.553 Vali Acc: 0.274 Test Loss: 1.553 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 16.506378412246704
Epoch: 12, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 15.033418893814087
Epoch: 13, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.620 Vali Acc: 0.289 Test Loss: 1.620 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288957).  Saving model ...
Epoch: 14 cost time: 15.39098596572876
Epoch: 14, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.33159637451172
Epoch: 15, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.625 Vali Acc: 0.304 Test Loss: 1.625 Test Acc: 0.304
Validation loss decreased (-0.288957 --> -0.304166).  Saving model ...
Epoch: 16 cost time: 16.476557731628418
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.658 Vali Acc: 0.251 Test Loss: 1.658 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.463066339492798
Epoch: 17, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.733 Vali Acc: 0.266 Test Loss: 1.733 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.915507793426514
Epoch: 18, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.844 Vali Acc: 0.278 Test Loss: 1.844 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 14.329695224761963
Epoch: 19, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.943 Vali Acc: 0.266 Test Loss: 1.943 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.91160249710083
Epoch: 20, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.712 Vali Acc: 0.243 Test Loss: 1.712 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.948190927505493
Epoch: 21, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.884 Vali Acc: 0.251 Test Loss: 1.884 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.922622203826904
Epoch: 22, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.996 Vali Acc: 0.300 Test Loss: 1.996 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.088433504104614
Epoch: 23, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.926 Vali Acc: 0.228 Test Loss: 1.926 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 14.679988861083984
Epoch: 24, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.791 Vali Acc: 0.251 Test Loss: 1.791 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 15.153120040893555
Epoch: 25, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.892 Vali Acc: 0.266 Test Loss: 1.892 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 642748
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.965413093566895
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.431 Vali Acc: 0.217 Test Loss: 1.431 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 7.573091745376587
Epoch: 2, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.473 Vali Acc: 0.243 Test Loss: 1.473 Test Acc: 0.243
Validation loss decreased (-0.216716 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 7.595072269439697
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.483 Vali Acc: 0.240 Test Loss: 1.483 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.783733367919922
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.545 Vali Acc: 0.262 Test Loss: 1.545 Test Acc: 0.262
Validation loss decreased (-0.243331 --> -0.262342).  Saving model ...
Epoch: 5 cost time: 7.810969591140747
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.395 Vali Acc: 0.289 Test Loss: 1.395 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 7.135226488113403
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.464 Vali Acc: 0.270 Test Loss: 1.464 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.179760217666626
Epoch: 7, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.456 Vali Acc: 0.289 Test Loss: 1.456 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.330188274383545
Epoch: 8, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.826048851013184
Epoch: 9, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.486 Vali Acc: 0.266 Test Loss: 1.486 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.8356194496154785
Epoch: 10, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.7412426471710205
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.626 Vali Acc: 0.297 Test Loss: 1.626 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296562).  Saving model ...
Epoch: 12 cost time: 7.811871290206909
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.768 Vali Acc: 0.278 Test Loss: 1.768 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.811958312988281
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.810302019119263
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.620 Vali Acc: 0.247 Test Loss: 1.620 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.7898290157318115
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.709 Vali Acc: 0.297 Test Loss: 1.709 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.126946926116943
Epoch: 16, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.692 Vali Acc: 0.247 Test Loss: 1.692 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.276723623275757
Epoch: 17, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.711 Vali Acc: 0.285 Test Loss: 1.711 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.33158564567566
Epoch: 18, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.770 Vali Acc: 0.262 Test Loss: 1.770 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.149676322937012
Epoch: 19, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.814 Vali Acc: 0.285 Test Loss: 1.814 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.053030729293823
Epoch: 20, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.899 Vali Acc: 0.247 Test Loss: 1.899 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.095576047897339
Epoch: 21, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.091 Vali Acc: 0.281 Test Loss: 2.091 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 228764
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 18.38468623161316
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 16.75159239768982
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.536356449127197
Epoch: 3, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.431054830551147
Epoch: 4, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 16.214752197265625
Epoch: 5, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.481 Vali Acc: 0.251 Test Loss: 1.481 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.348137140274048
Epoch: 6, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.506 Vali Acc: 0.266 Test Loss: 1.506 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.218068599700928
Epoch: 7, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.495 Vali Acc: 0.274 Test Loss: 1.495 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 8 cost time: 16.270907163619995
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.475 Vali Acc: 0.247 Test Loss: 1.475 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.34322738647461
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.470 Vali Acc: 0.255 Test Loss: 1.470 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 16.481011390686035
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.229968786239624
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.553 Vali Acc: 0.274 Test Loss: 1.553 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.31539249420166
Epoch: 12, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 16.218757152557373
Epoch: 13, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.620 Vali Acc: 0.289 Test Loss: 1.620 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288957).  Saving model ...
Epoch: 14 cost time: 16.140778064727783
Epoch: 14, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.312339544296265
Epoch: 15, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.625 Vali Acc: 0.304 Test Loss: 1.625 Test Acc: 0.304
Validation loss decreased (-0.288957 --> -0.304166).  Saving model ...
Epoch: 16 cost time: 16.82685136795044
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.658 Vali Acc: 0.251 Test Loss: 1.658 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.598660707473755
Epoch: 17, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.733 Vali Acc: 0.266 Test Loss: 1.733 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.88977575302124
Epoch: 18, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.844 Vali Acc: 0.278 Test Loss: 1.844 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.469148397445679
Epoch: 19, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.943 Vali Acc: 0.266 Test Loss: 1.943 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.672472953796387
Epoch: 20, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.712 Vali Acc: 0.243 Test Loss: 1.712 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.855818271636963
Epoch: 21, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.884 Vali Acc: 0.251 Test Loss: 1.884 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.778433084487915
Epoch: 22, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.996 Vali Acc: 0.300 Test Loss: 1.996 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.877814292907715
Epoch: 23, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.926 Vali Acc: 0.228 Test Loss: 1.926 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.849837064743042
Epoch: 24, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.791 Vali Acc: 0.251 Test Loss: 1.791 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.663355827331543
Epoch: 25, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.892 Vali Acc: 0.266 Test Loss: 1.892 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 642748
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.10476803779602
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.431 Vali Acc: 0.217 Test Loss: 1.431 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 7.843021869659424
Epoch: 2, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.473 Vali Acc: 0.243 Test Loss: 1.473 Test Acc: 0.243
Validation loss decreased (-0.216716 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 8.038575649261475
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.483 Vali Acc: 0.240 Test Loss: 1.483 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.9635841846466064
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.545 Vali Acc: 0.262 Test Loss: 1.545 Test Acc: 0.262
Validation loss decreased (-0.243331 --> -0.262342).  Saving model ...
Epoch: 5 cost time: 8.031004428863525
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.395 Vali Acc: 0.289 Test Loss: 1.395 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 8.193742036819458
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.464 Vali Acc: 0.270 Test Loss: 1.464 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.013059854507446
Epoch: 7, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.456 Vali Acc: 0.289 Test Loss: 1.456 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.06650972366333
Epoch: 8, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.071126222610474
Epoch: 9, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.486 Vali Acc: 0.266 Test Loss: 1.486 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.914797067642212
Epoch: 10, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.001866817474365
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.626 Vali Acc: 0.297 Test Loss: 1.626 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296562).  Saving model ...
Epoch: 12 cost time: 7.698241710662842
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.768 Vali Acc: 0.278 Test Loss: 1.768 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.435714244842529
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.34115743637085
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.620 Vali Acc: 0.247 Test Loss: 1.620 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.703636646270752
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.709 Vali Acc: 0.297 Test Loss: 1.709 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.180516719818115
Epoch: 16, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.692 Vali Acc: 0.247 Test Loss: 1.692 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.074210166931152
Epoch: 17, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.711 Vali Acc: 0.285 Test Loss: 1.711 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.96942663192749
Epoch: 18, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.770 Vali Acc: 0.262 Test Loss: 1.770 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.057386875152588
Epoch: 19, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.814 Vali Acc: 0.285 Test Loss: 1.814 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.056663990020752
Epoch: 20, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.899 Vali Acc: 0.247 Test Loss: 1.899 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.07025408744812
Epoch: 21, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.091 Vali Acc: 0.281 Test Loss: 2.091 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 228764
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.271440982818604
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 10.734167337417603
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.440 Vali Acc: 0.255 Test Loss: 1.440 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.243813753128052
Epoch: 3, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.160445928573608
Epoch: 4, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 10.045863389968872
Epoch: 5, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.481 Vali Acc: 0.251 Test Loss: 1.481 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.672700643539429
Epoch: 6, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.506 Vali Acc: 0.266 Test Loss: 1.506 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.756174087524414
Epoch: 7, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.495 Vali Acc: 0.274 Test Loss: 1.495 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273749).  Saving model ...
Epoch: 8 cost time: 10.779873847961426
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.475 Vali Acc: 0.247 Test Loss: 1.475 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.881351232528687
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.470 Vali Acc: 0.255 Test Loss: 1.470 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.044504165649414
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.086586952209473
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.553 Vali Acc: 0.274 Test Loss: 1.553 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.007408380508423
Epoch: 12, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.636 Vali Acc: 0.247 Test Loss: 1.636 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.028138637542725
Epoch: 13, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.620 Vali Acc: 0.289 Test Loss: 1.620 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288957).  Saving model ...
Epoch: 14 cost time: 10.374286651611328
Epoch: 14, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.273571014404297
Epoch: 15, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.625 Vali Acc: 0.304 Test Loss: 1.625 Test Acc: 0.304
Validation loss decreased (-0.288957 --> -0.304166).  Saving model ...
Epoch: 16 cost time: 10.412957906723022
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.658 Vali Acc: 0.251 Test Loss: 1.658 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.177904605865479
Epoch: 17, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.733 Vali Acc: 0.266 Test Loss: 1.733 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.103688716888428
Epoch: 18, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.844 Vali Acc: 0.278 Test Loss: 1.844 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.306563138961792
Epoch: 19, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.943 Vali Acc: 0.266 Test Loss: 1.943 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.322606325149536
Epoch: 20, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.712 Vali Acc: 0.243 Test Loss: 1.712 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.383477449417114
Epoch: 21, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.884 Vali Acc: 0.251 Test Loss: 1.884 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.368894338607788
Epoch: 22, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.996 Vali Acc: 0.300 Test Loss: 1.996 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.518135786056519
Epoch: 23, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.926 Vali Acc: 0.228 Test Loss: 1.926 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.681664228439331
Epoch: 24, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.791 Vali Acc: 0.251 Test Loss: 1.791 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.685922861099243
Epoch: 25, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.892 Vali Acc: 0.266 Test Loss: 1.892 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 642748
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.758759260177612
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.431 Vali Acc: 0.217 Test Loss: 1.431 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 5.274993658065796
Epoch: 2, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.473 Vali Acc: 0.243 Test Loss: 1.473 Test Acc: 0.243
Validation loss decreased (-0.216716 --> -0.243331).  Saving model ...
Epoch: 3 cost time: 5.292386770248413
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.483 Vali Acc: 0.240 Test Loss: 1.483 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.21959662437439
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.545 Vali Acc: 0.262 Test Loss: 1.545 Test Acc: 0.262
Validation loss decreased (-0.243331 --> -0.262342).  Saving model ...
Epoch: 5 cost time: 5.2923595905303955
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.395 Vali Acc: 0.289 Test Loss: 1.395 Test Acc: 0.289
Validation loss decreased (-0.262342 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 5.16665244102478
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.464 Vali Acc: 0.270 Test Loss: 1.464 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.418246269226074
Epoch: 7, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.456 Vali Acc: 0.289 Test Loss: 1.456 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.934380292892456
Epoch: 8, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.885425806045532
Epoch: 9, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.486 Vali Acc: 0.266 Test Loss: 1.486 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.950161933898926
Epoch: 10, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.970630884170532
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.626 Vali Acc: 0.297 Test Loss: 1.626 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296562).  Saving model ...
Epoch: 12 cost time: 5.207437515258789
Epoch: 12, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.768 Vali Acc: 0.278 Test Loss: 1.768 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.139850616455078
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.778 Vali Acc: 0.259 Test Loss: 1.778 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.972350358963013
Epoch: 14, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.620 Vali Acc: 0.247 Test Loss: 1.620 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.023807764053345
Epoch: 15, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.709 Vali Acc: 0.297 Test Loss: 1.709 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.016119718551636
Epoch: 16, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.692 Vali Acc: 0.247 Test Loss: 1.692 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.054384231567383
Epoch: 17, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.711 Vali Acc: 0.285 Test Loss: 1.711 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.000511884689331
Epoch: 18, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.770 Vali Acc: 0.262 Test Loss: 1.770 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.122730731964111
Epoch: 19, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.814 Vali Acc: 0.285 Test Loss: 1.814 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.635546445846558
Epoch: 20, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.899 Vali Acc: 0.247 Test Loss: 1.899 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.32000732421875
Epoch: 21, Steps: 17 | Train Loss: 0.927 Vali Loss: 2.091 Vali Acc: 0.281 Test Loss: 2.091 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 228764
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 15.385146856307983
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.402 Vali Acc: 0.217 Test Loss: 1.402 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 13.444977283477783
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
Validation loss decreased (-0.216716 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 13.642887115478516
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.406 Vali Acc: 0.274 Test Loss: 1.406 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 13.12372612953186
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.476 Vali Acc: 0.270 Test Loss: 1.476 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.833712577819824
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.553 Vali Acc: 0.255 Test Loss: 1.553 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.964942455291748
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.480 Vali Acc: 0.262 Test Loss: 1.480 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.809441804885864
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.561 Vali Acc: 0.259 Test Loss: 1.561 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.968283414840698
Epoch: 8, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.453 Vali Acc: 0.293 Test Loss: 1.453 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292761).  Saving model ...
Epoch: 9 cost time: 13.687852621078491
Epoch: 9, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.568 Vali Acc: 0.281 Test Loss: 1.568 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.101030349731445
Epoch: 10, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.560 Vali Acc: 0.255 Test Loss: 1.560 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.085315227508545
Epoch: 11, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.493 Vali Acc: 0.289 Test Loss: 1.493 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.141401767730713
Epoch: 12, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.581 Vali Acc: 0.270 Test Loss: 1.581 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.180695295333862
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.108367919921875
Epoch: 14, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.601 Vali Acc: 0.266 Test Loss: 1.601 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.268318891525269
Epoch: 15, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.588 Vali Acc: 0.262 Test Loss: 1.588 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.013791561126709
Epoch: 16, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.995 Vali Acc: 0.221 Test Loss: 1.995 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 14.308459758758545
Epoch: 17, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.659 Vali Acc: 0.278 Test Loss: 1.659 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.256725549697876
Epoch: 18, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.676 Vali Acc: 0.243 Test Loss: 1.676 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 349500
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.218671798706055
Epoch: 1, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 6.5417397022247314
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.509 Vali Acc: 0.255 Test Loss: 1.509 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 6.58202862739563
Epoch: 3, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 6.9746057987213135
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.443 Vali Acc: 0.255 Test Loss: 1.443 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.947721481323242
Epoch: 5, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.479 Vali Acc: 0.285 Test Loss: 1.479 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 6.960922479629517
Epoch: 6, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.462 Vali Acc: 0.236 Test Loss: 1.462 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.913755416870117
Epoch: 7, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.026021718978882
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.816 Vali Acc: 0.251 Test Loss: 1.816 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.973579406738281
Epoch: 9, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.743867874145508
Epoch: 10, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.669 Vali Acc: 0.232 Test Loss: 1.669 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.530569791793823
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.4168055057525635
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.517 Vali Acc: 0.228 Test Loss: 1.517 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.737597227096558
Epoch: 13, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.7902586460113525
Epoch: 14, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.624 Vali Acc: 0.240 Test Loss: 1.624 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.860943078994751
Epoch: 15, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.542 Vali Acc: 0.281 Test Loss: 1.542 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 142492
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.101867198944092
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.402 Vali Acc: 0.217 Test Loss: 1.402 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 10.56580400466919
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
Validation loss decreased (-0.216716 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 9.716910362243652
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.406 Vali Acc: 0.274 Test Loss: 1.406 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 9.756804943084717
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.476 Vali Acc: 0.270 Test Loss: 1.476 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.47694730758667
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.553 Vali Acc: 0.255 Test Loss: 1.553 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.60327434539795
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.480 Vali Acc: 0.262 Test Loss: 1.480 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.32127833366394
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.561 Vali Acc: 0.259 Test Loss: 1.561 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.469332218170166
Epoch: 8, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.453 Vali Acc: 0.293 Test Loss: 1.453 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292761).  Saving model ...
Epoch: 9 cost time: 10.04464602470398
Epoch: 9, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.568 Vali Acc: 0.281 Test Loss: 1.568 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.580506801605225
Epoch: 10, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.560 Vali Acc: 0.255 Test Loss: 1.560 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.224817752838135
Epoch: 11, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.493 Vali Acc: 0.289 Test Loss: 1.493 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.313762903213501
Epoch: 12, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.581 Vali Acc: 0.270 Test Loss: 1.581 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.029467582702637
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.378334760665894
Epoch: 14, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.601 Vali Acc: 0.266 Test Loss: 1.601 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.72353219985962
Epoch: 15, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.588 Vali Acc: 0.262 Test Loss: 1.588 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.205656290054321
Epoch: 16, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.995 Vali Acc: 0.221 Test Loss: 1.995 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.551285743713379
Epoch: 17, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.659 Vali Acc: 0.278 Test Loss: 1.659 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.444544792175293
Epoch: 18, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.676 Vali Acc: 0.243 Test Loss: 1.676 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 349500
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.7315452098846436
Epoch: 1, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 5.204816102981567
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.509 Vali Acc: 0.255 Test Loss: 1.509 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 5.131497859954834
Epoch: 3, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 5.1135313510894775
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.443 Vali Acc: 0.255 Test Loss: 1.443 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.9299702644348145
Epoch: 5, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.479 Vali Acc: 0.285 Test Loss: 1.479 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 4.842259645462036
Epoch: 6, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.462 Vali Acc: 0.236 Test Loss: 1.462 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.838169097900391
Epoch: 7, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.837765216827393
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.816 Vali Acc: 0.251 Test Loss: 1.816 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.171027421951294
Epoch: 9, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.169563293457031
Epoch: 10, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.669 Vali Acc: 0.232 Test Loss: 1.669 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.152902841567993
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.170665740966797
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.517 Vali Acc: 0.228 Test Loss: 1.517 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.1931047439575195
Epoch: 13, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.169652700424194
Epoch: 14, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.624 Vali Acc: 0.240 Test Loss: 1.624 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.18398380279541
Epoch: 15, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.542 Vali Acc: 0.281 Test Loss: 1.542 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 142492
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.199389219284058
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.402 Vali Acc: 0.217 Test Loss: 1.402 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 6.634909152984619
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.429 Vali Acc: 0.259 Test Loss: 1.429 Test Acc: 0.259
Validation loss decreased (-0.216716 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 6.7476136684417725
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.406 Vali Acc: 0.274 Test Loss: 1.406 Test Acc: 0.274
Validation loss decreased (-0.258541 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 7.215434789657593
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.476 Vali Acc: 0.270 Test Loss: 1.476 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.150024890899658
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.553 Vali Acc: 0.255 Test Loss: 1.553 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.148835182189941
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.480 Vali Acc: 0.262 Test Loss: 1.480 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.211149215698242
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.561 Vali Acc: 0.259 Test Loss: 1.561 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.040616989135742
Epoch: 8, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.453 Vali Acc: 0.293 Test Loss: 1.453 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292761).  Saving model ...
Epoch: 9 cost time: 7.208373308181763
Epoch: 9, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.568 Vali Acc: 0.281 Test Loss: 1.568 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.753547668457031
Epoch: 10, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.560 Vali Acc: 0.255 Test Loss: 1.560 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.514508485794067
Epoch: 11, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.493 Vali Acc: 0.289 Test Loss: 1.493 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.553782939910889
Epoch: 12, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.581 Vali Acc: 0.270 Test Loss: 1.581 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.002716541290283
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.637 Vali Acc: 0.255 Test Loss: 1.637 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.848237991333008
Epoch: 14, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.601 Vali Acc: 0.266 Test Loss: 1.601 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.057808876037598
Epoch: 15, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.588 Vali Acc: 0.262 Test Loss: 1.588 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.973030090332031
Epoch: 16, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.995 Vali Acc: 0.221 Test Loss: 1.995 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.048262119293213
Epoch: 17, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.659 Vali Acc: 0.278 Test Loss: 1.659 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.158893346786499
Epoch: 18, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.676 Vali Acc: 0.243 Test Loss: 1.676 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 349500
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.155661344528198
Epoch: 1, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 3.5697638988494873
Epoch: 2, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.509 Vali Acc: 0.255 Test Loss: 1.509 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 3.580315589904785
Epoch: 3, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 3.787058115005493
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.443 Vali Acc: 0.255 Test Loss: 1.443 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.827702283859253
Epoch: 5, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.479 Vali Acc: 0.285 Test Loss: 1.479 Test Acc: 0.285
Validation loss decreased (-0.266145 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 3.8218472003936768
Epoch: 6, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.462 Vali Acc: 0.236 Test Loss: 1.462 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.785351037979126
Epoch: 7, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.600 Vali Acc: 0.274 Test Loss: 1.600 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.903383255004883
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.816 Vali Acc: 0.251 Test Loss: 1.816 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8091721534729004
Epoch: 9, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6723122596740723
Epoch: 10, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.669 Vali Acc: 0.232 Test Loss: 1.669 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.072326898574829
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.946305751800537
Epoch: 12, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.517 Vali Acc: 0.228 Test Loss: 1.517 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.9014179706573486
Epoch: 13, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.569 Vali Acc: 0.270 Test Loss: 1.569 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.6829187870025635
Epoch: 14, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.624 Vali Acc: 0.240 Test Loss: 1.624 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.6662404537200928
Epoch: 15, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.542 Vali Acc: 0.281 Test Loss: 1.542 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 142492
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 12.193777561187744
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 10.370021104812622
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.424 Vali Acc: 0.266 Test Loss: 1.424 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 10.080239057540894
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.458 Vali Acc: 0.232 Test Loss: 1.458 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.638208866119385
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.434 Vali Acc: 0.274 Test Loss: 1.434 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 10.384570598602295
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.88647723197937
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.628 Vali Acc: 0.255 Test Loss: 1.628 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.185980796813965
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.598 Vali Acc: 0.247 Test Loss: 1.598 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.381958484649658
Epoch: 8, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.658 Vali Acc: 0.259 Test Loss: 1.658 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.468366622924805
Epoch: 9, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.497 Vali Acc: 0.285 Test Loss: 1.497 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 10.728811264038086
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.636 Vali Acc: 0.293 Test Loss: 1.636 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292759).  Saving model ...
Epoch: 11 cost time: 10.838496208190918
Epoch: 11, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.634 Vali Acc: 0.236 Test Loss: 1.634 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.824704885482788
Epoch: 12, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.566 Vali Acc: 0.262 Test Loss: 1.566 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.803069829940796
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.43466830253601
Epoch: 14, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.385642766952515
Epoch: 15, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.575 Vali Acc: 0.259 Test Loss: 1.575 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.517795324325562
Epoch: 16, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.558 Vali Acc: 0.228 Test Loss: 1.558 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.66127872467041
Epoch: 17, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.43652629852295
Epoch: 18, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.707 Vali Acc: 0.289 Test Loss: 1.707 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.899829149246216
Epoch: 19, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.679 Vali Acc: 0.293 Test Loss: 1.679 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.954439401626587
Epoch: 20, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.511 Vali Acc: 0.304 Test Loss: 1.511 Test Acc: 0.304
Validation loss decreased (-0.292759 --> -0.304167).  Saving model ...
Epoch: 21 cost time: 10.574356079101562
Epoch: 21, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.768 Vali Acc: 0.228 Test Loss: 1.768 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.678872108459473
Epoch: 22, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.705 Vali Acc: 0.255 Test Loss: 1.705 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.551403522491455
Epoch: 23, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.608 Vali Acc: 0.300 Test Loss: 1.608 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.668894052505493
Epoch: 24, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.612 Vali Acc: 0.285 Test Loss: 1.612 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.569646835327148
Epoch: 25, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.705 Vali Acc: 0.274 Test Loss: 1.705 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.629106521606445
Epoch: 26, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.242456912994385
Epoch: 27, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.846 Vali Acc: 0.251 Test Loss: 1.846 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.472499370574951
Epoch: 28, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.805 Vali Acc: 0.266 Test Loss: 1.805 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.356300830841064
Epoch: 29, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.386970281600952
Epoch: 30, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.842 Vali Acc: 0.274 Test Loss: 1.842 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 202876
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.875407695770264
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 5.234536647796631
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.422 Vali Acc: 0.266 Test Loss: 1.422 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.15184211730957
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.57595157623291
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.572094440460205
Epoch: 5, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.508 Vali Acc: 0.232 Test Loss: 1.508 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.571526765823364
Epoch: 6, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.536 Vali Acc: 0.228 Test Loss: 1.536 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.521718502044678
Epoch: 7, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.518444776535034
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.608275651931763
Epoch: 9, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.811 Vali Acc: 0.240 Test Loss: 1.811 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.560725927352905
Epoch: 10, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.534 Vali Acc: 0.224 Test Loss: 1.534 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.287657022476196
Epoch: 11, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.784 Vali Acc: 0.289 Test Loss: 1.784 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288956).  Saving model ...
Epoch: 12 cost time: 5.20103907585144
Epoch: 12, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.542 Vali Acc: 0.293 Test Loss: 1.542 Test Acc: 0.293
Validation loss decreased (-0.288956 --> -0.292760).  Saving model ...
Epoch: 13 cost time: 5.207996368408203
Epoch: 13, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.539 Vali Acc: 0.247 Test Loss: 1.539 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5909812450408936
Epoch: 14, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.868 Vali Acc: 0.240 Test Loss: 1.868 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.559060573577881
Epoch: 15, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.514 Vali Acc: 0.236 Test Loss: 1.514 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.578844785690308
Epoch: 16, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.690609931945801
Epoch: 17, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.733359336853027
Epoch: 18, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.528 Vali Acc: 0.251 Test Loss: 1.528 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.6346116065979
Epoch: 19, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.739 Vali Acc: 0.266 Test Loss: 1.739 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.760867595672607
Epoch: 20, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.795 Vali Acc: 0.255 Test Loss: 1.795 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.48723578453064
Epoch: 21, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.711 Vali Acc: 0.259 Test Loss: 1.711 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.356776237487793
Epoch: 22, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.641 Vali Acc: 0.243 Test Loss: 1.641 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 99356
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.090729236602783
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 8.288052797317505
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.424 Vali Acc: 0.266 Test Loss: 1.424 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 8.429115295410156
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.458 Vali Acc: 0.232 Test Loss: 1.458 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.355147123336792
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.434 Vali Acc: 0.274 Test Loss: 1.434 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 8.436184883117676
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.286205530166626
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.628 Vali Acc: 0.255 Test Loss: 1.628 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.9538843631744385
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.598 Vali Acc: 0.247 Test Loss: 1.598 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.873570442199707
Epoch: 8, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.658 Vali Acc: 0.259 Test Loss: 1.658 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.003769159317017
Epoch: 9, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.497 Vali Acc: 0.285 Test Loss: 1.497 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 7.4919397830963135
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.636 Vali Acc: 0.293 Test Loss: 1.636 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292759).  Saving model ...
Epoch: 11 cost time: 8.630621194839478
Epoch: 11, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.634 Vali Acc: 0.236 Test Loss: 1.634 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.933979034423828
Epoch: 12, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.566 Vali Acc: 0.262 Test Loss: 1.566 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.824020624160767
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.96651577949524
Epoch: 14, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.80364727973938
Epoch: 15, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.575 Vali Acc: 0.259 Test Loss: 1.575 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.792554378509521
Epoch: 16, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.558 Vali Acc: 0.228 Test Loss: 1.558 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.793690204620361
Epoch: 17, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.517920017242432
Epoch: 18, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.707 Vali Acc: 0.289 Test Loss: 1.707 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.349587202072144
Epoch: 19, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.679 Vali Acc: 0.293 Test Loss: 1.679 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.30508804321289
Epoch: 20, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.511 Vali Acc: 0.304 Test Loss: 1.511 Test Acc: 0.304
Validation loss decreased (-0.292759 --> -0.304167).  Saving model ...
Epoch: 21 cost time: 8.804009437561035
Epoch: 21, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.768 Vali Acc: 0.228 Test Loss: 1.768 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.532444477081299
Epoch: 22, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.705 Vali Acc: 0.255 Test Loss: 1.705 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.438771486282349
Epoch: 23, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.608 Vali Acc: 0.300 Test Loss: 1.608 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.86821985244751
Epoch: 24, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.612 Vali Acc: 0.285 Test Loss: 1.612 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.59323239326477
Epoch: 25, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.705 Vali Acc: 0.274 Test Loss: 1.705 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.798019409179688
Epoch: 26, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.7540602684021
Epoch: 27, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.846 Vali Acc: 0.251 Test Loss: 1.846 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.49905276298523
Epoch: 28, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.805 Vali Acc: 0.266 Test Loss: 1.805 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.15687084197998
Epoch: 29, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.265395164489746
Epoch: 30, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.842 Vali Acc: 0.274 Test Loss: 1.842 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 202876
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.342576265335083
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 4.655869245529175
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.422 Vali Acc: 0.266 Test Loss: 1.422 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.575835227966309
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.532142877578735
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.651276588439941
Epoch: 5, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.508 Vali Acc: 0.232 Test Loss: 1.508 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.560105800628662
Epoch: 6, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.536 Vali Acc: 0.228 Test Loss: 1.536 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.528562068939209
Epoch: 7, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.573266506195068
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.548185586929321
Epoch: 9, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.811 Vali Acc: 0.240 Test Loss: 1.811 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.543986558914185
Epoch: 10, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.534 Vali Acc: 0.224 Test Loss: 1.534 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.2259602546691895
Epoch: 11, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.784 Vali Acc: 0.289 Test Loss: 1.784 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288956).  Saving model ...
Epoch: 12 cost time: 4.253637075424194
Epoch: 12, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.542 Vali Acc: 0.293 Test Loss: 1.542 Test Acc: 0.293
Validation loss decreased (-0.288956 --> -0.292760).  Saving model ...
Epoch: 13 cost time: 4.2833147048950195
Epoch: 13, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.539 Vali Acc: 0.247 Test Loss: 1.539 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.155655860900879
Epoch: 14, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.868 Vali Acc: 0.240 Test Loss: 1.868 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.24425745010376
Epoch: 15, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.514 Vali Acc: 0.236 Test Loss: 1.514 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.575476169586182
Epoch: 16, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.664412498474121
Epoch: 17, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.678698778152466
Epoch: 18, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.528 Vali Acc: 0.251 Test Loss: 1.528 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.679225444793701
Epoch: 19, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.739 Vali Acc: 0.266 Test Loss: 1.739 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.661273956298828
Epoch: 20, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.795 Vali Acc: 0.255 Test Loss: 1.795 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.6702845096588135
Epoch: 21, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.711 Vali Acc: 0.259 Test Loss: 1.711 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.699658155441284
Epoch: 22, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.641 Vali Acc: 0.243 Test Loss: 1.641 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 99356
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.5026750564575195
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.429 Vali Acc: 0.251 Test Loss: 1.429 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 6.017720460891724
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.424 Vali Acc: 0.266 Test Loss: 1.424 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 5.551100492477417
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.458 Vali Acc: 0.232 Test Loss: 1.458 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.664241075515747
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.434 Vali Acc: 0.274 Test Loss: 1.434 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 5.678899526596069
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.520 Vali Acc: 0.255 Test Loss: 1.520 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.6814563274383545
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.628 Vali Acc: 0.255 Test Loss: 1.628 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.040977478027344
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.598 Vali Acc: 0.247 Test Loss: 1.598 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.062126398086548
Epoch: 8, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.658 Vali Acc: 0.259 Test Loss: 1.658 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.986400842666626
Epoch: 9, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.497 Vali Acc: 0.285 Test Loss: 1.497 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 6.0749804973602295
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.636 Vali Acc: 0.293 Test Loss: 1.636 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292759).  Saving model ...
Epoch: 11 cost time: 6.085472345352173
Epoch: 11, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.634 Vali Acc: 0.236 Test Loss: 1.634 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.052208423614502
Epoch: 12, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.566 Vali Acc: 0.262 Test Loss: 1.566 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.067107439041138
Epoch: 13, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.1311070919036865
Epoch: 14, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.111175775527954
Epoch: 15, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.575 Vali Acc: 0.259 Test Loss: 1.575 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.0439229011535645
Epoch: 16, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.558 Vali Acc: 0.228 Test Loss: 1.558 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.767234563827515
Epoch: 17, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.755167245864868
Epoch: 18, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.707 Vali Acc: 0.289 Test Loss: 1.707 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.775293827056885
Epoch: 19, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.679 Vali Acc: 0.293 Test Loss: 1.679 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.748346567153931
Epoch: 20, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.511 Vali Acc: 0.304 Test Loss: 1.511 Test Acc: 0.304
Validation loss decreased (-0.292759 --> -0.304167).  Saving model ...
Epoch: 21 cost time: 6.11203408241272
Epoch: 21, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.768 Vali Acc: 0.228 Test Loss: 1.768 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.141658544540405
Epoch: 22, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.705 Vali Acc: 0.255 Test Loss: 1.705 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.135854244232178
Epoch: 23, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.608 Vali Acc: 0.300 Test Loss: 1.608 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.178225517272949
Epoch: 24, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.612 Vali Acc: 0.285 Test Loss: 1.612 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.08945631980896
Epoch: 25, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.705 Vali Acc: 0.274 Test Loss: 1.705 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.259191989898682
Epoch: 26, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.828 Vali Acc: 0.262 Test Loss: 1.828 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.15177321434021
Epoch: 27, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.846 Vali Acc: 0.251 Test Loss: 1.846 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.060277700424194
Epoch: 28, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.805 Vali Acc: 0.266 Test Loss: 1.805 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.083856105804443
Epoch: 29, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.1598851680755615
Epoch: 30, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.842 Vali Acc: 0.274 Test Loss: 1.842 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 202876
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.739633560180664
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 3.2348575592041016
Epoch: 2, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.422 Vali Acc: 0.266 Test Loss: 1.422 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.133023738861084
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3485569953918457
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.407 Vali Acc: 0.236 Test Loss: 1.407 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.358508348464966
Epoch: 5, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.508 Vali Acc: 0.232 Test Loss: 1.508 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.214836597442627
Epoch: 6, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.536 Vali Acc: 0.228 Test Loss: 1.536 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3765575885772705
Epoch: 7, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.345311403274536
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.3119406700134277
Epoch: 9, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.811 Vali Acc: 0.240 Test Loss: 1.811 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.2760682106018066
Epoch: 10, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.534 Vali Acc: 0.224 Test Loss: 1.534 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.252185344696045
Epoch: 11, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.784 Vali Acc: 0.289 Test Loss: 1.784 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288956).  Saving model ...
Epoch: 12 cost time: 3.3782167434692383
Epoch: 12, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.542 Vali Acc: 0.293 Test Loss: 1.542 Test Acc: 0.293
Validation loss decreased (-0.288956 --> -0.292760).  Saving model ...
Epoch: 13 cost time: 3.3281424045562744
Epoch: 13, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.539 Vali Acc: 0.247 Test Loss: 1.539 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.343330144882202
Epoch: 14, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.868 Vali Acc: 0.240 Test Loss: 1.868 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2550618648529053
Epoch: 15, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.514 Vali Acc: 0.236 Test Loss: 1.514 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3720428943634033
Epoch: 16, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.631 Vali Acc: 0.243 Test Loss: 1.631 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3178317546844482
Epoch: 17, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.572 Vali Acc: 0.274 Test Loss: 1.572 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.400914430618286
Epoch: 18, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.528 Vali Acc: 0.251 Test Loss: 1.528 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.01731014251709
Epoch: 19, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.739 Vali Acc: 0.266 Test Loss: 1.739 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1380486488342285
Epoch: 20, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.795 Vali Acc: 0.255 Test Loss: 1.795 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0852394104003906
Epoch: 21, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.711 Vali Acc: 0.259 Test Loss: 1.711 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1062591075897217
Epoch: 22, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.641 Vali Acc: 0.243 Test Loss: 1.641 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_TimesNet_UEA_ftM_sl1751_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 99356
model size : 0.55MB
