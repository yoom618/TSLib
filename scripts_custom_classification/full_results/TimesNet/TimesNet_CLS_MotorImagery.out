Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 781.692197561264
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.921 Vali Acc: 0.500 Test Loss: 1.921 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 736.3184006214142
Epoch: 2, Steps: 18 | Train Loss: 1.671 Vali Loss: 1.938 Vali Acc: 0.610 Test Loss: 1.938 Test Acc: 0.610
Validation loss decreased (-0.499981 --> -0.609981).  Saving model ...
Epoch: 3 cost time: 693.6342897415161
Epoch: 3, Steps: 18 | Train Loss: 1.080 Vali Loss: 2.720 Vali Acc: 0.460 Test Loss: 2.720 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 662.1805164813995
Epoch: 4, Steps: 18 | Train Loss: 1.057 Vali Loss: 2.052 Vali Acc: 0.480 Test Loss: 2.052 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 668.6840283870697
Epoch: 5, Steps: 18 | Train Loss: 1.089 Vali Loss: 5.359 Vali Acc: 0.490 Test Loss: 5.359 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 687.5597558021545
Epoch: 6, Steps: 18 | Train Loss: 1.261 Vali Loss: 3.488 Vali Acc: 0.550 Test Loss: 3.488 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 570.7899947166443
Epoch: 7, Steps: 18 | Train Loss: 1.509 Vali Loss: 2.734 Vali Acc: 0.530 Test Loss: 2.734 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 561.2137513160706
Epoch: 8, Steps: 18 | Train Loss: 2.163 Vali Loss: 6.579 Vali Acc: 0.470 Test Loss: 6.579 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 540.4585824012756
Epoch: 9, Steps: 18 | Train Loss: 1.969 Vali Loss: 9.196 Vali Acc: 0.540 Test Loss: 9.196 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 496.867169380188
Epoch: 10, Steps: 18 | Train Loss: 2.154 Vali Loss: 14.848 Vali Acc: 0.500 Test Loss: 14.848 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 494.1261019706726
Epoch: 11, Steps: 18 | Train Loss: 2.486 Vali Loss: 6.843 Vali Acc: 0.500 Test Loss: 6.843 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 505.89515829086304
Epoch: 12, Steps: 18 | Train Loss: 1.216 Vali Loss: 6.976 Vali Acc: 0.490 Test Loss: 6.976 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 75775746
model size : 291.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 193.07646107673645
Epoch: 1, Steps: 18 | Train Loss: 1.092 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 191.6975541114807
Epoch: 2, Steps: 18 | Train Loss: 0.992 Vali Loss: 1.814 Vali Acc: 0.500 Test Loss: 1.814 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 188.87875080108643
Epoch: 3, Steps: 18 | Train Loss: 1.207 Vali Loss: 2.203 Vali Acc: 0.510 Test Loss: 2.203 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509978).  Saving model ...
Epoch: 4 cost time: 188.1649785041809
Epoch: 4, Steps: 18 | Train Loss: 0.754 Vali Loss: 2.241 Vali Acc: 0.510 Test Loss: 2.241 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 195.1956295967102
Epoch: 5, Steps: 18 | Train Loss: 1.296 Vali Loss: 2.651 Vali Acc: 0.490 Test Loss: 2.651 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 175.49178743362427
Epoch: 6, Steps: 18 | Train Loss: 0.988 Vali Loss: 2.809 Vali Acc: 0.550 Test Loss: 2.809 Test Acc: 0.550
Validation loss decreased (-0.509978 --> -0.549972).  Saving model ...
Epoch: 7 cost time: 172.63218760490417
Epoch: 7, Steps: 18 | Train Loss: 1.209 Vali Loss: 6.424 Vali Acc: 0.510 Test Loss: 6.424 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 173.6735029220581
Epoch: 8, Steps: 18 | Train Loss: 2.098 Vali Loss: 5.068 Vali Acc: 0.600 Test Loss: 5.068 Test Acc: 0.600
Validation loss decreased (-0.549972 --> -0.599949).  Saving model ...
Epoch: 9 cost time: 183.07695317268372
Epoch: 9, Steps: 18 | Train Loss: 1.024 Vali Loss: 8.986 Vali Acc: 0.450 Test Loss: 8.986 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 187.11719799041748
Epoch: 10, Steps: 18 | Train Loss: 2.366 Vali Loss: 5.342 Vali Acc: 0.500 Test Loss: 5.342 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 202.13925862312317
Epoch: 11, Steps: 18 | Train Loss: 2.213 Vali Loss: 5.724 Vali Acc: 0.470 Test Loss: 5.724 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 198.26761150360107
Epoch: 12, Steps: 18 | Train Loss: 2.424 Vali Loss: 10.807 Vali Acc: 0.510 Test Loss: 10.807 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 191.4978437423706
Epoch: 13, Steps: 18 | Train Loss: 3.272 Vali Loss: 13.008 Vali Acc: 0.540 Test Loss: 13.008 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 198.19662809371948
Epoch: 14, Steps: 18 | Train Loss: 1.181 Vali Loss: 6.882 Vali Acc: 0.570 Test Loss: 6.882 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 187.693519115448
Epoch: 15, Steps: 18 | Train Loss: 1.052 Vali Loss: 6.478 Vali Acc: 0.510 Test Loss: 6.478 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 177.45306062698364
Epoch: 16, Steps: 18 | Train Loss: 0.772 Vali Loss: 5.437 Vali Acc: 0.610 Test Loss: 5.437 Test Acc: 0.610
Validation loss decreased (-0.599949 --> -0.609946).  Saving model ...
Epoch: 17 cost time: 174.20087504386902
Epoch: 17, Steps: 18 | Train Loss: 1.079 Vali Loss: 7.020 Vali Acc: 0.580 Test Loss: 7.020 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 181.91281008720398
Epoch: 18, Steps: 18 | Train Loss: 1.234 Vali Loss: 9.056 Vali Acc: 0.580 Test Loss: 9.056 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 182.20119643211365
Epoch: 19, Steps: 18 | Train Loss: 0.969 Vali Loss: 17.766 Vali Acc: 0.510 Test Loss: 17.766 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 172.44895243644714
Epoch: 20, Steps: 18 | Train Loss: 1.219 Vali Loss: 11.236 Vali Acc: 0.520 Test Loss: 11.236 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 175.20675349235535
Epoch: 21, Steps: 18 | Train Loss: 0.756 Vali Loss: 15.919 Vali Acc: 0.510 Test Loss: 15.919 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 183.18264436721802
Epoch: 22, Steps: 18 | Train Loss: 1.726 Vali Loss: 23.941 Vali Acc: 0.490 Test Loss: 23.941 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 189.46520566940308
Epoch: 23, Steps: 18 | Train Loss: 1.992 Vali Loss: 12.847 Vali Acc: 0.480 Test Loss: 12.847 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 183.96509981155396
Epoch: 24, Steps: 18 | Train Loss: 3.708 Vali Loss: 31.778 Vali Acc: 0.520 Test Loss: 31.778 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 188.57682371139526
Epoch: 25, Steps: 18 | Train Loss: 4.079 Vali Loss: 15.513 Vali Acc: 0.420 Test Loss: 15.513 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 198.0532374382019
Epoch: 26, Steps: 18 | Train Loss: 2.006 Vali Loss: 13.896 Vali Acc: 0.540 Test Loss: 13.896 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 22819586
model size : 89.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 392.13709902763367
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.921 Vali Acc: 0.500 Test Loss: 1.921 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 404.5909492969513
Epoch: 2, Steps: 18 | Train Loss: 1.671 Vali Loss: 1.938 Vali Acc: 0.610 Test Loss: 1.938 Test Acc: 0.610
Validation loss decreased (-0.499981 --> -0.609981).  Saving model ...
Epoch: 3 cost time: 359.9035840034485
Epoch: 3, Steps: 18 | Train Loss: 1.079 Vali Loss: 2.716 Vali Acc: 0.460 Test Loss: 2.716 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 350.0592601299286
Epoch: 4, Steps: 18 | Train Loss: 1.043 Vali Loss: 1.958 Vali Acc: 0.470 Test Loss: 1.958 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 346.4204366207123
Epoch: 5, Steps: 18 | Train Loss: 0.958 Vali Loss: 3.373 Vali Acc: 0.510 Test Loss: 3.373 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 356.95410418510437
Epoch: 6, Steps: 18 | Train Loss: 1.232 Vali Loss: 6.267 Vali Acc: 0.540 Test Loss: 6.267 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 363.6531226634979
Epoch: 7, Steps: 18 | Train Loss: 2.390 Vali Loss: 6.703 Vali Acc: 0.480 Test Loss: 6.703 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 367.55146312713623
Epoch: 8, Steps: 18 | Train Loss: 3.403 Vali Loss: 4.050 Vali Acc: 0.580 Test Loss: 4.050 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 358.90740060806274
Epoch: 9, Steps: 18 | Train Loss: 1.282 Vali Loss: 5.913 Vali Acc: 0.530 Test Loss: 5.913 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 338.57745242118835
Epoch: 10, Steps: 18 | Train Loss: 1.206 Vali Loss: 5.622 Vali Acc: 0.500 Test Loss: 5.622 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 338.1584539413452
Epoch: 11, Steps: 18 | Train Loss: 1.787 Vali Loss: 12.507 Vali Acc: 0.480 Test Loss: 12.507 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 395.27965116500854
Epoch: 12, Steps: 18 | Train Loss: 1.602 Vali Loss: 10.015 Vali Acc: 0.450 Test Loss: 10.015 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 75775746
model size : 291.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 150.22528886795044
Epoch: 1, Steps: 18 | Train Loss: 1.092 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 159.70552277565002
Epoch: 2, Steps: 18 | Train Loss: 0.992 Vali Loss: 1.814 Vali Acc: 0.500 Test Loss: 1.814 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 157.52626180648804
Epoch: 3, Steps: 18 | Train Loss: 1.207 Vali Loss: 2.202 Vali Acc: 0.510 Test Loss: 2.202 Test Acc: 0.510
Validation loss decreased (-0.499982 --> -0.509978).  Saving model ...
Epoch: 4 cost time: 147.01626563072205
Epoch: 4, Steps: 18 | Train Loss: 0.751 Vali Loss: 2.198 Vali Acc: 0.510 Test Loss: 2.198 Test Acc: 0.510
Validation loss decreased (-0.509978 --> -0.509978).  Saving model ...
Epoch: 5 cost time: 150.88823080062866
Epoch: 5, Steps: 18 | Train Loss: 1.312 Vali Loss: 2.432 Vali Acc: 0.480 Test Loss: 2.432 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 149.09662199020386
Epoch: 6, Steps: 18 | Train Loss: 1.464 Vali Loss: 2.101 Vali Acc: 0.520 Test Loss: 2.101 Test Acc: 0.520
Validation loss decreased (-0.509978 --> -0.519979).  Saving model ...
Epoch: 7 cost time: 142.8878481388092
Epoch: 7, Steps: 18 | Train Loss: 0.835 Vali Loss: 11.620 Vali Acc: 0.490 Test Loss: 11.620 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 136.4571681022644
Epoch: 8, Steps: 18 | Train Loss: 1.310 Vali Loss: 12.384 Vali Acc: 0.520 Test Loss: 12.384 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 134.0296061038971
Epoch: 9, Steps: 18 | Train Loss: 2.068 Vali Loss: 5.056 Vali Acc: 0.540 Test Loss: 5.056 Test Acc: 0.540
Validation loss decreased (-0.519979 --> -0.539949).  Saving model ...
Epoch: 10 cost time: 138.29552912712097
Epoch: 10, Steps: 18 | Train Loss: 1.682 Vali Loss: 9.662 Vali Acc: 0.500 Test Loss: 9.662 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 141.04592156410217
Epoch: 11, Steps: 18 | Train Loss: 0.797 Vali Loss: 5.410 Vali Acc: 0.560 Test Loss: 5.410 Test Acc: 0.560
Validation loss decreased (-0.539949 --> -0.559946).  Saving model ...
Epoch: 12 cost time: 136.34795308113098
Epoch: 12, Steps: 18 | Train Loss: 1.379 Vali Loss: 8.013 Vali Acc: 0.570 Test Loss: 8.013 Test Acc: 0.570
Validation loss decreased (-0.559946 --> -0.569920).  Saving model ...
Epoch: 13 cost time: 133.31664514541626
Epoch: 13, Steps: 18 | Train Loss: 1.844 Vali Loss: 7.214 Vali Acc: 0.480 Test Loss: 7.214 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 143.43808603286743
Epoch: 14, Steps: 18 | Train Loss: 2.024 Vali Loss: 20.933 Vali Acc: 0.500 Test Loss: 20.933 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 146.44277954101562
Epoch: 15, Steps: 18 | Train Loss: 1.104 Vali Loss: 16.660 Vali Acc: 0.520 Test Loss: 16.660 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 146.01197862625122
Epoch: 16, Steps: 18 | Train Loss: 1.543 Vali Loss: 15.418 Vali Acc: 0.500 Test Loss: 15.418 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 157.22316980361938
Epoch: 17, Steps: 18 | Train Loss: 0.938 Vali Loss: 12.952 Vali Acc: 0.560 Test Loss: 12.952 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 153.79207634925842
Epoch: 18, Steps: 18 | Train Loss: 1.752 Vali Loss: 20.434 Vali Acc: 0.500 Test Loss: 20.434 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 160.46108889579773
Epoch: 19, Steps: 18 | Train Loss: 1.370 Vali Loss: 35.245 Vali Acc: 0.500 Test Loss: 35.245 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 153.78400707244873
Epoch: 20, Steps: 18 | Train Loss: 3.721 Vali Loss: 10.878 Vali Acc: 0.510 Test Loss: 10.878 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 163.54966855049133
Epoch: 21, Steps: 18 | Train Loss: 0.748 Vali Loss: 14.246 Vali Acc: 0.470 Test Loss: 14.246 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 157.45976209640503
Epoch: 22, Steps: 18 | Train Loss: 1.738 Vali Loss: 12.875 Vali Acc: 0.470 Test Loss: 12.875 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 22819586
model size : 89.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 256.35440158843994
Epoch: 1, Steps: 18 | Train Loss: 0.894 Vali Loss: 1.913 Vali Acc: 0.500 Test Loss: 1.913 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 242.77746319770813
Epoch: 2, Steps: 18 | Train Loss: 1.659 Vali Loss: 1.986 Vali Acc: 0.610 Test Loss: 1.986 Test Acc: 0.610
Validation loss decreased (-0.499981 --> -0.609980).  Saving model ...
Epoch: 3 cost time: 238.23337149620056
Epoch: 3, Steps: 18 | Train Loss: 1.068 Vali Loss: 3.139 Vali Acc: 0.470 Test Loss: 3.139 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 238.96618509292603
Epoch: 4, Steps: 18 | Train Loss: 1.227 Vali Loss: 4.610 Vali Acc: 0.490 Test Loss: 4.610 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 245.19447898864746
Epoch: 5, Steps: 18 | Train Loss: 1.116 Vali Loss: 6.779 Vali Acc: 0.530 Test Loss: 6.779 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 241.5233232975006
Epoch: 6, Steps: 18 | Train Loss: 1.536 Vali Loss: 5.840 Vali Acc: 0.470 Test Loss: 5.840 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 235.34824228286743
Epoch: 7, Steps: 18 | Train Loss: 0.623 Vali Loss: 3.900 Vali Acc: 0.510 Test Loss: 3.900 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 248.6567943096161
Epoch: 8, Steps: 18 | Train Loss: 1.081 Vali Loss: 4.000 Vali Acc: 0.550 Test Loss: 4.000 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 253.11318802833557
Epoch: 9, Steps: 18 | Train Loss: 1.355 Vali Loss: 6.109 Vali Acc: 0.540 Test Loss: 6.109 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 247.0019781589508
Epoch: 10, Steps: 18 | Train Loss: 0.598 Vali Loss: 4.337 Vali Acc: 0.580 Test Loss: 4.337 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 252.20007419586182
Epoch: 11, Steps: 18 | Train Loss: 1.008 Vali Loss: 9.126 Vali Acc: 0.500 Test Loss: 9.126 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 256.6470036506653
Epoch: 12, Steps: 18 | Train Loss: 1.408 Vali Loss: 10.105 Vali Acc: 0.460 Test Loss: 10.105 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 75775746
model size : 291.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 100.74080657958984
Epoch: 1, Steps: 18 | Train Loss: 1.090 Vali Loss: 1.285 Vali Acc: 0.460 Test Loss: 1.285 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 98.77408146858215
Epoch: 2, Steps: 18 | Train Loss: 0.986 Vali Loss: 1.821 Vali Acc: 0.500 Test Loss: 1.821 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499982).  Saving model ...
Epoch: 3 cost time: 94.42342782020569
Epoch: 3, Steps: 18 | Train Loss: 1.110 Vali Loss: 2.128 Vali Acc: 0.520 Test Loss: 2.128 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519979).  Saving model ...
Epoch: 4 cost time: 91.09712815284729
Epoch: 4, Steps: 18 | Train Loss: 1.243 Vali Loss: 4.999 Vali Acc: 0.460 Test Loss: 4.999 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 94.49908256530762
Epoch: 5, Steps: 18 | Train Loss: 1.044 Vali Loss: 2.747 Vali Acc: 0.530 Test Loss: 2.747 Test Acc: 0.530
Validation loss decreased (-0.519979 --> -0.529973).  Saving model ...
Epoch: 6 cost time: 88.25369429588318
Epoch: 6, Steps: 18 | Train Loss: 1.355 Vali Loss: 3.457 Vali Acc: 0.560 Test Loss: 3.457 Test Acc: 0.560
Validation loss decreased (-0.529973 --> -0.559965).  Saving model ...
Epoch: 7 cost time: 85.16208982467651
Epoch: 7, Steps: 18 | Train Loss: 1.051 Vali Loss: 4.835 Vali Acc: 0.510 Test Loss: 4.835 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 87.76483511924744
Epoch: 8, Steps: 18 | Train Loss: 1.311 Vali Loss: 8.153 Vali Acc: 0.520 Test Loss: 8.153 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 83.90341925621033
Epoch: 9, Steps: 18 | Train Loss: 2.197 Vali Loss: 4.273 Vali Acc: 0.520 Test Loss: 4.273 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 81.42715978622437
Epoch: 10, Steps: 18 | Train Loss: 6.352 Vali Loss: 19.180 Vali Acc: 0.500 Test Loss: 19.180 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 81.98436522483826
Epoch: 11, Steps: 18 | Train Loss: 2.685 Vali Loss: 7.690 Vali Acc: 0.520 Test Loss: 7.690 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 84.74987936019897
Epoch: 12, Steps: 18 | Train Loss: 1.741 Vali Loss: 6.588 Vali Acc: 0.560 Test Loss: 6.588 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 78.10463881492615
Epoch: 13, Steps: 18 | Train Loss: 1.582 Vali Loss: 5.539 Vali Acc: 0.540 Test Loss: 5.539 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 85.23512411117554
Epoch: 14, Steps: 18 | Train Loss: 1.242 Vali Loss: 12.429 Vali Acc: 0.510 Test Loss: 12.429 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 78.20587825775146
Epoch: 15, Steps: 18 | Train Loss: 0.791 Vali Loss: 17.506 Vali Acc: 0.460 Test Loss: 17.506 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 92.2256600856781
Epoch: 16, Steps: 18 | Train Loss: 1.381 Vali Loss: 15.832 Vali Acc: 0.510 Test Loss: 15.832 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 22819586
model size : 89.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 277.2852396965027
Epoch: 1, Steps: 18 | Train Loss: 0.937 Vali Loss: 0.971 Vali Acc: 0.450 Test Loss: 0.971 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 275.5351083278656
Epoch: 2, Steps: 18 | Train Loss: 0.925 Vali Loss: 2.167 Vali Acc: 0.490 Test Loss: 2.167 Test Acc: 0.490
Validation loss decreased (-0.449990 --> -0.489978).  Saving model ...
Epoch: 3 cost time: 277.1183819770813
Epoch: 3, Steps: 18 | Train Loss: 1.457 Vali Loss: 1.245 Vali Acc: 0.560 Test Loss: 1.245 Test Acc: 0.560
Validation loss decreased (-0.489978 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 274.7555296421051
Epoch: 4, Steps: 18 | Train Loss: 0.714 Vali Loss: 1.871 Vali Acc: 0.550 Test Loss: 1.871 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 277.1961262226105
Epoch: 5, Steps: 18 | Train Loss: 1.041 Vali Loss: 3.980 Vali Acc: 0.460 Test Loss: 3.980 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 247.19737243652344
Epoch: 6, Steps: 18 | Train Loss: 1.275 Vali Loss: 2.514 Vali Acc: 0.500 Test Loss: 2.514 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 249.2483468055725
Epoch: 7, Steps: 18 | Train Loss: 0.680 Vali Loss: 4.909 Vali Acc: 0.500 Test Loss: 4.909 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 248.29157853126526
Epoch: 8, Steps: 18 | Train Loss: 1.022 Vali Loss: 6.036 Vali Acc: 0.500 Test Loss: 6.036 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 247.257178068161
Epoch: 9, Steps: 18 | Train Loss: 1.353 Vali Loss: 6.054 Vali Acc: 0.490 Test Loss: 6.054 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 252.11469435691833
Epoch: 10, Steps: 18 | Train Loss: 1.079 Vali Loss: 4.238 Vali Acc: 0.580 Test Loss: 4.238 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579958).  Saving model ...
Epoch: 11 cost time: 271.491890668869
Epoch: 11, Steps: 18 | Train Loss: 1.027 Vali Loss: 5.631 Vali Acc: 0.480 Test Loss: 5.631 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 270.0515923500061
Epoch: 12, Steps: 18 | Train Loss: 1.080 Vali Loss: 10.029 Vali Acc: 0.540 Test Loss: 10.029 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 270.7789387702942
Epoch: 13, Steps: 18 | Train Loss: 2.251 Vali Loss: 7.000 Vali Acc: 0.600 Test Loss: 7.000 Test Acc: 0.600
Validation loss decreased (-0.579958 --> -0.599930).  Saving model ...
Epoch: 14 cost time: 269.3411011695862
Epoch: 14, Steps: 18 | Train Loss: 0.808 Vali Loss: 10.282 Vali Acc: 0.480 Test Loss: 10.282 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 265.3396100997925
Epoch: 15, Steps: 18 | Train Loss: 0.545 Vali Loss: 9.548 Vali Acc: 0.520 Test Loss: 9.548 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 246.75372004508972
Epoch: 16, Steps: 18 | Train Loss: 1.622 Vali Loss: 14.148 Vali Acc: 0.550 Test Loss: 14.148 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 242.97650861740112
Epoch: 17, Steps: 18 | Train Loss: 1.425 Vali Loss: 11.718 Vali Acc: 0.510 Test Loss: 11.718 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 245.583247423172
Epoch: 18, Steps: 18 | Train Loss: 0.998 Vali Loss: 15.086 Vali Acc: 0.550 Test Loss: 15.086 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 246.82640743255615
Epoch: 19, Steps: 18 | Train Loss: 1.205 Vali Loss: 9.674 Vali Acc: 0.480 Test Loss: 9.674 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 258.0074164867401
Epoch: 20, Steps: 18 | Train Loss: 1.051 Vali Loss: 9.725 Vali Acc: 0.490 Test Loss: 9.725 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 254.68068265914917
Epoch: 21, Steps: 18 | Train Loss: 0.930 Vali Loss: 22.051 Vali Acc: 0.550 Test Loss: 22.051 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 252.40598344802856
Epoch: 22, Steps: 18 | Train Loss: 1.176 Vali Loss: 17.887 Vali Acc: 0.540 Test Loss: 17.887 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 247.463130235672
Epoch: 23, Steps: 18 | Train Loss: 1.405 Vali Loss: 15.463 Vali Acc: 0.470 Test Loss: 15.463 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 38286082
model size : 148.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 97.88157677650452
Epoch: 1, Steps: 18 | Train Loss: 1.190 Vali Loss: 1.088 Vali Acc: 0.460 Test Loss: 1.088 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 98.3163788318634
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.961 Vali Acc: 0.440 Test Loss: 1.961 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 85.6270203590393
Epoch: 3, Steps: 18 | Train Loss: 1.205 Vali Loss: 2.123 Vali Acc: 0.580 Test Loss: 2.123 Test Acc: 0.580
Validation loss decreased (-0.459989 --> -0.579979).  Saving model ...
Epoch: 4 cost time: 93.68530917167664
Epoch: 4, Steps: 18 | Train Loss: 0.896 Vali Loss: 2.549 Vali Acc: 0.470 Test Loss: 2.549 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 90.48765730857849
Epoch: 5, Steps: 18 | Train Loss: 0.983 Vali Loss: 1.659 Vali Acc: 0.620 Test Loss: 1.659 Test Acc: 0.620
Validation loss decreased (-0.579979 --> -0.619983).  Saving model ...
Epoch: 6 cost time: 90.19109749794006
Epoch: 6, Steps: 18 | Train Loss: 1.407 Vali Loss: 5.679 Vali Acc: 0.510 Test Loss: 5.679 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 94.28749394416809
Epoch: 7, Steps: 18 | Train Loss: 1.131 Vali Loss: 4.074 Vali Acc: 0.460 Test Loss: 4.074 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 91.44806814193726
Epoch: 8, Steps: 18 | Train Loss: 1.841 Vali Loss: 3.174 Vali Acc: 0.500 Test Loss: 3.174 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 105.16407132148743
Epoch: 9, Steps: 18 | Train Loss: 1.850 Vali Loss: 3.775 Vali Acc: 0.510 Test Loss: 3.775 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 101.45533871650696
Epoch: 10, Steps: 18 | Train Loss: 1.349 Vali Loss: 5.895 Vali Acc: 0.510 Test Loss: 5.895 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 101.94897723197937
Epoch: 11, Steps: 18 | Train Loss: 0.899 Vali Loss: 5.933 Vali Acc: 0.480 Test Loss: 5.933 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 104.40948033332825
Epoch: 12, Steps: 18 | Train Loss: 1.500 Vali Loss: 13.984 Vali Acc: 0.450 Test Loss: 13.984 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 98.00440239906311
Epoch: 13, Steps: 18 | Train Loss: 2.958 Vali Loss: 7.111 Vali Acc: 0.500 Test Loss: 7.111 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 105.50807309150696
Epoch: 14, Steps: 18 | Train Loss: 2.286 Vali Loss: 12.351 Vali Acc: 0.520 Test Loss: 12.351 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 102.73779964447021
Epoch: 15, Steps: 18 | Train Loss: 1.053 Vali Loss: 7.132 Vali Acc: 0.560 Test Loss: 7.132 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 11807490
model size : 47.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 202.3968768119812
Epoch: 1, Steps: 18 | Train Loss: 0.937 Vali Loss: 0.972 Vali Acc: 0.450 Test Loss: 0.972 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 202.20515513420105
Epoch: 2, Steps: 18 | Train Loss: 0.926 Vali Loss: 2.168 Vali Acc: 0.490 Test Loss: 2.168 Test Acc: 0.490
Validation loss decreased (-0.449990 --> -0.489978).  Saving model ...
Epoch: 3 cost time: 197.68234825134277
Epoch: 3, Steps: 18 | Train Loss: 1.458 Vali Loss: 1.224 Vali Acc: 0.560 Test Loss: 1.224 Test Acc: 0.560
Validation loss decreased (-0.489978 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 183.2616093158722
Epoch: 4, Steps: 18 | Train Loss: 0.666 Vali Loss: 1.578 Vali Acc: 0.540 Test Loss: 1.578 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 185.80958104133606
Epoch: 5, Steps: 18 | Train Loss: 1.102 Vali Loss: 3.023 Vali Acc: 0.500 Test Loss: 3.023 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 183.18621277809143
Epoch: 6, Steps: 18 | Train Loss: 0.990 Vali Loss: 3.010 Vali Acc: 0.480 Test Loss: 3.010 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 182.03246068954468
Epoch: 7, Steps: 18 | Train Loss: 1.100 Vali Loss: 4.583 Vali Acc: 0.550 Test Loss: 4.583 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 182.47023701667786
Epoch: 8, Steps: 18 | Train Loss: 1.287 Vali Loss: 5.212 Vali Acc: 0.520 Test Loss: 5.212 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 180.91599559783936
Epoch: 9, Steps: 18 | Train Loss: 2.505 Vali Loss: 4.987 Vali Acc: 0.550 Test Loss: 4.987 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 183.6026530265808
Epoch: 10, Steps: 18 | Train Loss: 1.582 Vali Loss: 4.970 Vali Acc: 0.610 Test Loss: 4.970 Test Acc: 0.610
Validation loss decreased (-0.559988 --> -0.609950).  Saving model ...
Epoch: 11 cost time: 183.2079095840454
Epoch: 11, Steps: 18 | Train Loss: 3.063 Vali Loss: 7.913 Vali Acc: 0.530 Test Loss: 7.913 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 184.28720259666443
Epoch: 12, Steps: 18 | Train Loss: 1.235 Vali Loss: 10.560 Vali Acc: 0.530 Test Loss: 10.560 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 195.5526933670044
Epoch: 13, Steps: 18 | Train Loss: 1.175 Vali Loss: 5.404 Vali Acc: 0.490 Test Loss: 5.404 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 195.00569248199463
Epoch: 14, Steps: 18 | Train Loss: 2.465 Vali Loss: 11.706 Vali Acc: 0.480 Test Loss: 11.706 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 196.13878464698792
Epoch: 15, Steps: 18 | Train Loss: 1.369 Vali Loss: 13.635 Vali Acc: 0.450 Test Loss: 13.635 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 186.35104131698608
Epoch: 16, Steps: 18 | Train Loss: 1.018 Vali Loss: 8.834 Vali Acc: 0.460 Test Loss: 8.834 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 198.99701237678528
Epoch: 17, Steps: 18 | Train Loss: 1.262 Vali Loss: 6.852 Vali Acc: 0.520 Test Loss: 6.852 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 204.25076580047607
Epoch: 18, Steps: 18 | Train Loss: 0.535 Vali Loss: 13.894 Vali Acc: 0.550 Test Loss: 13.894 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 200.11882066726685
Epoch: 19, Steps: 18 | Train Loss: 0.506 Vali Loss: 9.536 Vali Acc: 0.530 Test Loss: 9.536 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 201.89568853378296
Epoch: 20, Steps: 18 | Train Loss: 0.538 Vali Loss: 14.853 Vali Acc: 0.480 Test Loss: 14.853 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 38286082
model size : 148.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 80.50756597518921
Epoch: 1, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.091 Vali Acc: 0.450 Test Loss: 1.091 Test Acc: 0.450
Validation loss decreased (inf --> -0.449989).  Saving model ...
Epoch: 2 cost time: 77.44612979888916
Epoch: 2, Steps: 18 | Train Loss: 0.722 Vali Loss: 1.773 Vali Acc: 0.440 Test Loss: 1.773 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 73.71272826194763
Epoch: 3, Steps: 18 | Train Loss: 1.458 Vali Loss: 2.440 Vali Acc: 0.570 Test Loss: 2.440 Test Acc: 0.570
Validation loss decreased (-0.449989 --> -0.569976).  Saving model ...
Epoch: 4 cost time: 73.1147301197052
Epoch: 4, Steps: 18 | Train Loss: 1.699 Vali Loss: 2.159 Vali Acc: 0.570 Test Loss: 2.159 Test Acc: 0.570
Validation loss decreased (-0.569976 --> -0.569978).  Saving model ...
Epoch: 5 cost time: 75.96021676063538
Epoch: 5, Steps: 18 | Train Loss: 1.388 Vali Loss: 3.062 Vali Acc: 0.630 Test Loss: 3.062 Test Acc: 0.630
Validation loss decreased (-0.569978 --> -0.629969).  Saving model ...
Epoch: 6 cost time: 77.42707538604736
Epoch: 6, Steps: 18 | Train Loss: 2.831 Vali Loss: 4.406 Vali Acc: 0.490 Test Loss: 4.406 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 72.98007822036743
Epoch: 7, Steps: 18 | Train Loss: 1.476 Vali Loss: 7.971 Vali Acc: 0.480 Test Loss: 7.971 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 73.78239417076111
Epoch: 8, Steps: 18 | Train Loss: 1.903 Vali Loss: 3.767 Vali Acc: 0.490 Test Loss: 3.767 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 75.48570322990417
Epoch: 9, Steps: 18 | Train Loss: 1.408 Vali Loss: 3.628 Vali Acc: 0.520 Test Loss: 3.628 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 77.06544709205627
Epoch: 10, Steps: 18 | Train Loss: 1.262 Vali Loss: 4.423 Vali Acc: 0.530 Test Loss: 4.423 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 73.20391035079956
Epoch: 11, Steps: 18 | Train Loss: 1.642 Vali Loss: 7.228 Vali Acc: 0.490 Test Loss: 7.228 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 73.65262913703918
Epoch: 12, Steps: 18 | Train Loss: 0.469 Vali Loss: 6.045 Vali Acc: 0.460 Test Loss: 6.045 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 74.07701563835144
Epoch: 13, Steps: 18 | Train Loss: 0.560 Vali Loss: 6.319 Vali Acc: 0.460 Test Loss: 6.319 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 79.93419170379639
Epoch: 14, Steps: 18 | Train Loss: 1.826 Vali Loss: 10.745 Vali Acc: 0.470 Test Loss: 10.745 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 77.67827010154724
Epoch: 15, Steps: 18 | Train Loss: 1.419 Vali Loss: 12.357 Vali Acc: 0.470 Test Loss: 12.357 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 11807490
model size : 47.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 122.2311441898346
Epoch: 1, Steps: 18 | Train Loss: 0.940 Vali Loss: 0.998 Vali Acc: 0.430 Test Loss: 0.998 Test Acc: 0.430
Validation loss decreased (inf --> -0.429990).  Saving model ...
Epoch: 2 cost time: 127.29512405395508
Epoch: 2, Steps: 18 | Train Loss: 0.921 Vali Loss: 2.333 Vali Acc: 0.460 Test Loss: 2.333 Test Acc: 0.460
Validation loss decreased (-0.429990 --> -0.459977).  Saving model ...
Epoch: 3 cost time: 120.06120705604553
Epoch: 3, Steps: 18 | Train Loss: 0.874 Vali Loss: 3.058 Vali Acc: 0.510 Test Loss: 3.058 Test Acc: 0.510
Validation loss decreased (-0.459977 --> -0.509969).  Saving model ...
Epoch: 4 cost time: 115.30841851234436
Epoch: 4, Steps: 18 | Train Loss: 0.935 Vali Loss: 2.630 Vali Acc: 0.600 Test Loss: 2.630 Test Acc: 0.600
Validation loss decreased (-0.509969 --> -0.599974).  Saving model ...
Epoch: 5 cost time: 117.18893790245056
Epoch: 5, Steps: 18 | Train Loss: 1.488 Vali Loss: 2.559 Vali Acc: 0.520 Test Loss: 2.559 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 113.16408562660217
Epoch: 6, Steps: 18 | Train Loss: 0.915 Vali Loss: 2.181 Vali Acc: 0.580 Test Loss: 2.181 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 118.93382811546326
Epoch: 7, Steps: 18 | Train Loss: 0.917 Vali Loss: 8.481 Vali Acc: 0.480 Test Loss: 8.481 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 115.27602648735046
Epoch: 8, Steps: 18 | Train Loss: 1.868 Vali Loss: 7.601 Vali Acc: 0.530 Test Loss: 7.601 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 114.06972646713257
Epoch: 9, Steps: 18 | Train Loss: 1.684 Vali Loss: 13.446 Vali Acc: 0.480 Test Loss: 13.446 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 119.54547548294067
Epoch: 10, Steps: 18 | Train Loss: 1.691 Vali Loss: 5.534 Vali Acc: 0.450 Test Loss: 5.534 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 124.33391761779785
Epoch: 11, Steps: 18 | Train Loss: 0.860 Vali Loss: 5.045 Vali Acc: 0.460 Test Loss: 5.045 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 135.38427925109863
Epoch: 12, Steps: 18 | Train Loss: 1.791 Vali Loss: 10.154 Vali Acc: 0.500 Test Loss: 10.154 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 133.34404301643372
Epoch: 13, Steps: 18 | Train Loss: 0.719 Vali Loss: 18.376 Vali Acc: 0.490 Test Loss: 18.376 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 131.99992442131042
Epoch: 14, Steps: 18 | Train Loss: 0.547 Vali Loss: 13.705 Vali Acc: 0.450 Test Loss: 13.705 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 38286082
model size : 148.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 57.08166718482971
Epoch: 1, Steps: 18 | Train Loss: 1.189 Vali Loss: 1.094 Vali Acc: 0.460 Test Loss: 1.094 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 58.71728229522705
Epoch: 2, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.888 Vali Acc: 0.440 Test Loss: 1.888 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 53.48863697052002
Epoch: 3, Steps: 18 | Train Loss: 1.269 Vali Loss: 1.945 Vali Acc: 0.570 Test Loss: 1.945 Test Acc: 0.570
Validation loss decreased (-0.459989 --> -0.569981).  Saving model ...
Epoch: 4 cost time: 52.40173959732056
Epoch: 4, Steps: 18 | Train Loss: 0.821 Vali Loss: 1.455 Vali Acc: 0.510 Test Loss: 1.455 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 55.16456079483032
Epoch: 5, Steps: 18 | Train Loss: 0.829 Vali Loss: 3.469 Vali Acc: 0.560 Test Loss: 3.469 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 53.31101155281067
Epoch: 6, Steps: 18 | Train Loss: 1.015 Vali Loss: 3.856 Vali Acc: 0.600 Test Loss: 3.856 Test Acc: 0.600
Validation loss decreased (-0.569981 --> -0.599961).  Saving model ...
Epoch: 7 cost time: 54.09369778633118
Epoch: 7, Steps: 18 | Train Loss: 2.652 Vali Loss: 9.388 Vali Acc: 0.480 Test Loss: 9.388 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 57.94394016265869
Epoch: 8, Steps: 18 | Train Loss: 1.622 Vali Loss: 4.643 Vali Acc: 0.520 Test Loss: 4.643 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 56.41792440414429
Epoch: 9, Steps: 18 | Train Loss: 0.795 Vali Loss: 3.664 Vali Acc: 0.570 Test Loss: 3.664 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 52.65355467796326
Epoch: 10, Steps: 18 | Train Loss: 0.565 Vali Loss: 6.758 Vali Acc: 0.470 Test Loss: 6.758 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 54.85224008560181
Epoch: 11, Steps: 18 | Train Loss: 0.862 Vali Loss: 6.860 Vali Acc: 0.540 Test Loss: 6.860 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 55.89366626739502
Epoch: 12, Steps: 18 | Train Loss: 1.565 Vali Loss: 6.406 Vali Acc: 0.530 Test Loss: 6.406 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 53.060819149017334
Epoch: 13, Steps: 18 | Train Loss: 0.744 Vali Loss: 14.284 Vali Acc: 0.540 Test Loss: 14.284 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 56.55373024940491
Epoch: 14, Steps: 18 | Train Loss: 0.597 Vali Loss: 16.200 Vali Acc: 0.460 Test Loss: 16.200 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 58.68010401725769
Epoch: 15, Steps: 18 | Train Loss: 0.539 Vali Loss: 7.773 Vali Acc: 0.510 Test Loss: 7.773 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 57.302207708358765
Epoch: 16, Steps: 18 | Train Loss: 0.631 Vali Loss: 10.651 Vali Acc: 0.560 Test Loss: 10.651 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 11807490
model size : 47.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 296.10560941696167
Epoch: 1, Steps: 18 | Train Loss: 0.839 Vali Loss: 0.776 Vali Acc: 0.630 Test Loss: 0.776 Test Acc: 0.630
Validation loss decreased (inf --> -0.629992).  Saving model ...
Epoch: 2 cost time: 294.2724802494049
Epoch: 2, Steps: 18 | Train Loss: 0.951 Vali Loss: 0.797 Vali Acc: 0.640 Test Loss: 0.797 Test Acc: 0.640
Validation loss decreased (-0.629992 --> -0.639992).  Saving model ...
Epoch: 3 cost time: 293.70488476753235
Epoch: 3, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.376 Vali Acc: 0.540 Test Loss: 1.376 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 274.03399085998535
Epoch: 4, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.079 Vali Acc: 0.590 Test Loss: 1.079 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 268.17685770988464
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 266.65218329429626
Epoch: 6, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.500 Vali Acc: 0.490 Test Loss: 1.500 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 264.86926889419556
Epoch: 7, Steps: 18 | Train Loss: 0.347 Vali Loss: 2.448 Vali Acc: 0.530 Test Loss: 2.448 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 266.1614692211151
Epoch: 8, Steps: 18 | Train Loss: 0.743 Vali Loss: 3.729 Vali Acc: 0.480 Test Loss: 3.729 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 277.4936158657074
Epoch: 9, Steps: 18 | Train Loss: 0.869 Vali Loss: 4.783 Vali Acc: 0.490 Test Loss: 4.783 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 289.2888550758362
Epoch: 10, Steps: 18 | Train Loss: 0.811 Vali Loss: 3.234 Vali Acc: 0.530 Test Loss: 3.234 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 288.5954041481018
Epoch: 11, Steps: 18 | Train Loss: 0.446 Vali Loss: 5.680 Vali Acc: 0.510 Test Loss: 5.680 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 292.36525988578796
Epoch: 12, Steps: 18 | Train Loss: 0.276 Vali Loss: 3.651 Vali Acc: 0.450 Test Loss: 3.651 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 37890946
model size : 145.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 110.44629263877869
Epoch: 1, Steps: 18 | Train Loss: 1.022 Vali Loss: 0.734 Vali Acc: 0.520 Test Loss: 0.734 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 109.57453060150146
Epoch: 2, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.982 Vali Acc: 0.530 Test Loss: 0.982 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529990).  Saving model ...
Epoch: 3 cost time: 114.17462372779846
Epoch: 3, Steps: 18 | Train Loss: 0.525 Vali Loss: 1.123 Vali Acc: 0.520 Test Loss: 1.123 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 109.62418222427368
Epoch: 4, Steps: 18 | Train Loss: 0.726 Vali Loss: 2.714 Vali Acc: 0.510 Test Loss: 2.714 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 117.40908312797546
Epoch: 5, Steps: 18 | Train Loss: 0.505 Vali Loss: 2.776 Vali Acc: 0.480 Test Loss: 2.776 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 110.77482390403748
Epoch: 6, Steps: 18 | Train Loss: 0.503 Vali Loss: 2.587 Vali Acc: 0.520 Test Loss: 2.587 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 108.4241554737091
Epoch: 7, Steps: 18 | Train Loss: 1.028 Vali Loss: 2.000 Vali Acc: 0.490 Test Loss: 2.000 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 99.89611506462097
Epoch: 8, Steps: 18 | Train Loss: 0.648 Vali Loss: 2.170 Vali Acc: 0.450 Test Loss: 2.170 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 104.17501521110535
Epoch: 9, Steps: 18 | Train Loss: 0.401 Vali Loss: 3.804 Vali Acc: 0.520 Test Loss: 3.804 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 101.3610258102417
Epoch: 10, Steps: 18 | Train Loss: 0.506 Vali Loss: 5.855 Vali Acc: 0.480 Test Loss: 5.855 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 100.19716262817383
Epoch: 11, Steps: 18 | Train Loss: 0.646 Vali Loss: 4.723 Vali Acc: 0.530 Test Loss: 4.723 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 101.42576289176941
Epoch: 12, Steps: 18 | Train Loss: 0.760 Vali Loss: 2.989 Vali Acc: 0.460 Test Loss: 2.989 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 11411842
model size : 44.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 205.74963903427124
Epoch: 1, Steps: 18 | Train Loss: 0.839 Vali Loss: 0.776 Vali Acc: 0.630 Test Loss: 0.776 Test Acc: 0.630
Validation loss decreased (inf --> -0.629992).  Saving model ...
Epoch: 2 cost time: 205.61811017990112
Epoch: 2, Steps: 18 | Train Loss: 0.951 Vali Loss: 0.797 Vali Acc: 0.640 Test Loss: 0.797 Test Acc: 0.640
Validation loss decreased (-0.629992 --> -0.639992).  Saving model ...
Epoch: 3 cost time: 205.94799137115479
Epoch: 3, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.377 Vali Acc: 0.540 Test Loss: 1.377 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 201.2227807044983
Epoch: 4, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.081 Vali Acc: 0.590 Test Loss: 1.081 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 205.2545702457428
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.436 Vali Acc: 0.500 Test Loss: 1.436 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 207.73656153678894
Epoch: 6, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.619 Vali Acc: 0.510 Test Loss: 1.619 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 210.0260615348816
Epoch: 7, Steps: 18 | Train Loss: 0.635 Vali Loss: 1.720 Vali Acc: 0.520 Test Loss: 1.720 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 210.15133476257324
Epoch: 8, Steps: 18 | Train Loss: 0.422 Vali Loss: 3.428 Vali Acc: 0.500 Test Loss: 3.428 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 212.4611039161682
Epoch: 9, Steps: 18 | Train Loss: 0.241 Vali Loss: 2.488 Vali Acc: 0.520 Test Loss: 2.488 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 203.2363040447235
Epoch: 10, Steps: 18 | Train Loss: 0.510 Vali Loss: 4.773 Vali Acc: 0.510 Test Loss: 4.773 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 189.03323554992676
Epoch: 11, Steps: 18 | Train Loss: 0.451 Vali Loss: 5.209 Vali Acc: 0.560 Test Loss: 5.209 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 187.8560483455658
Epoch: 12, Steps: 18 | Train Loss: 0.495 Vali Loss: 4.497 Vali Acc: 0.450 Test Loss: 4.497 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 37890946
model size : 145.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 85.48722457885742
Epoch: 1, Steps: 18 | Train Loss: 1.022 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 82.94534254074097
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 81.67620658874512
Epoch: 3, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.149 Vali Acc: 0.510 Test Loss: 1.149 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 85.99020671844482
Epoch: 4, Steps: 18 | Train Loss: 0.739 Vali Loss: 2.213 Vali Acc: 0.520 Test Loss: 2.213 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 82.26095032691956
Epoch: 5, Steps: 18 | Train Loss: 0.455 Vali Loss: 2.923 Vali Acc: 0.460 Test Loss: 2.923 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 84.43625593185425
Epoch: 6, Steps: 18 | Train Loss: 0.947 Vali Loss: 3.624 Vali Acc: 0.490 Test Loss: 3.624 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 82.76982593536377
Epoch: 7, Steps: 18 | Train Loss: 0.630 Vali Loss: 2.072 Vali Acc: 0.480 Test Loss: 2.072 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 81.81642317771912
Epoch: 8, Steps: 18 | Train Loss: 0.508 Vali Loss: 1.967 Vali Acc: 0.500 Test Loss: 1.967 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 86.42918038368225
Epoch: 9, Steps: 18 | Train Loss: 0.553 Vali Loss: 2.639 Vali Acc: 0.480 Test Loss: 2.639 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 81.97939729690552
Epoch: 10, Steps: 18 | Train Loss: 0.502 Vali Loss: 3.900 Vali Acc: 0.440 Test Loss: 3.900 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 83.90602970123291
Epoch: 11, Steps: 18 | Train Loss: 0.721 Vali Loss: 3.541 Vali Acc: 0.490 Test Loss: 3.541 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 11411842
model size : 44.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 130.859872341156
Epoch: 1, Steps: 18 | Train Loss: 0.839 Vali Loss: 0.778 Vali Acc: 0.620 Test Loss: 0.778 Test Acc: 0.620
Validation loss decreased (inf --> -0.619992).  Saving model ...
Epoch: 2 cost time: 123.1542899608612
Epoch: 2, Steps: 18 | Train Loss: 0.954 Vali Loss: 0.796 Vali Acc: 0.650 Test Loss: 0.796 Test Acc: 0.650
Validation loss decreased (-0.619992 --> -0.649992).  Saving model ...
Epoch: 3 cost time: 121.51672005653381
Epoch: 3, Steps: 18 | Train Loss: 0.726 Vali Loss: 2.089 Vali Acc: 0.510 Test Loss: 2.089 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 117.80419778823853
Epoch: 4, Steps: 18 | Train Loss: 0.540 Vali Loss: 1.394 Vali Acc: 0.530 Test Loss: 1.394 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 124.58342862129211
Epoch: 5, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.858 Vali Acc: 0.470 Test Loss: 1.858 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 120.55208587646484
Epoch: 6, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.876 Vali Acc: 0.490 Test Loss: 1.876 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 119.5475025177002
Epoch: 7, Steps: 18 | Train Loss: 0.554 Vali Loss: 2.842 Vali Acc: 0.510 Test Loss: 2.842 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 123.37063646316528
Epoch: 8, Steps: 18 | Train Loss: 0.600 Vali Loss: 4.977 Vali Acc: 0.550 Test Loss: 4.977 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 118.29666876792908
Epoch: 9, Steps: 18 | Train Loss: 0.451 Vali Loss: 2.969 Vali Acc: 0.530 Test Loss: 2.969 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 123.32202291488647
Epoch: 10, Steps: 18 | Train Loss: 0.747 Vali Loss: 2.111 Vali Acc: 0.600 Test Loss: 2.111 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 126.6408703327179
Epoch: 11, Steps: 18 | Train Loss: 0.372 Vali Loss: 3.401 Vali Acc: 0.580 Test Loss: 3.401 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 125.31980895996094
Epoch: 12, Steps: 18 | Train Loss: 0.305 Vali Loss: 3.515 Vali Acc: 0.460 Test Loss: 3.515 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 37890946
model size : 145.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 54.619064807891846
Epoch: 1, Steps: 18 | Train Loss: 1.022 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 46.37560820579529
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.912 Vali Acc: 0.510 Test Loss: 0.912 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.568035364151
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 50.35525465011597
Epoch: 4, Steps: 18 | Train Loss: 0.603 Vali Loss: 1.263 Vali Acc: 0.490 Test Loss: 1.263 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 54.0878746509552
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 2.754 Vali Acc: 0.500 Test Loss: 2.754 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 50.62843084335327
Epoch: 6, Steps: 18 | Train Loss: 0.815 Vali Loss: 5.983 Vali Acc: 0.510 Test Loss: 5.983 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 49.803701877593994
Epoch: 7, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.683 Vali Acc: 0.500 Test Loss: 1.683 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 50.04794406890869
Epoch: 8, Steps: 18 | Train Loss: 0.561 Vali Loss: 4.881 Vali Acc: 0.510 Test Loss: 4.881 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 52.11230969429016
Epoch: 9, Steps: 18 | Train Loss: 0.960 Vali Loss: 5.297 Vali Acc: 0.510 Test Loss: 5.297 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 48.190959215164185
Epoch: 10, Steps: 18 | Train Loss: 0.888 Vali Loss: 2.391 Vali Acc: 0.550 Test Loss: 2.391 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549976).  Saving model ...
Epoch: 11 cost time: 47.98009419441223
Epoch: 11, Steps: 18 | Train Loss: 0.561 Vali Loss: 2.253 Vali Acc: 0.590 Test Loss: 2.253 Test Acc: 0.590
Validation loss decreased (-0.549976 --> -0.589977).  Saving model ...
Epoch: 12 cost time: 50.55610203742981
Epoch: 12, Steps: 18 | Train Loss: 0.931 Vali Loss: 10.461 Vali Acc: 0.500 Test Loss: 10.461 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 52.12925148010254
Epoch: 13, Steps: 18 | Train Loss: 1.308 Vali Loss: 5.588 Vali Acc: 0.480 Test Loss: 5.588 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 48.7316780090332
Epoch: 14, Steps: 18 | Train Loss: 0.650 Vali Loss: 3.271 Vali Acc: 0.550 Test Loss: 3.271 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 48.28014135360718
Epoch: 15, Steps: 18 | Train Loss: 0.557 Vali Loss: 8.431 Vali Acc: 0.540 Test Loss: 8.431 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 50.343061447143555
Epoch: 16, Steps: 18 | Train Loss: 1.020 Vali Loss: 4.961 Vali Acc: 0.530 Test Loss: 4.961 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 50.17487406730652
Epoch: 17, Steps: 18 | Train Loss: 0.400 Vali Loss: 8.403 Vali Acc: 0.500 Test Loss: 8.403 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 48.693212270736694
Epoch: 18, Steps: 18 | Train Loss: 0.310 Vali Loss: 4.413 Vali Acc: 0.590 Test Loss: 4.413 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 48.70007395744324
Epoch: 19, Steps: 18 | Train Loss: 0.343 Vali Loss: 4.951 Vali Acc: 0.480 Test Loss: 4.951 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 51.895901679992676
Epoch: 20, Steps: 18 | Train Loss: 0.600 Vali Loss: 8.702 Vali Acc: 0.580 Test Loss: 8.702 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 50.537973403930664
Epoch: 21, Steps: 18 | Train Loss: 0.543 Vali Loss: 4.206 Vali Acc: 0.480 Test Loss: 4.206 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 11411842
model size : 44.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 141.11237788200378
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 1.477 Vali Acc: 0.460 Test Loss: 1.477 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 132.50410509109497
Epoch: 2, Steps: 18 | Train Loss: 1.152 Vali Loss: 0.925 Vali Acc: 0.540 Test Loss: 0.925 Test Acc: 0.540
Validation loss decreased (-0.459985 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 132.93080615997314
Epoch: 3, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.924 Vali Acc: 0.570 Test Loss: 0.924 Test Acc: 0.570
Validation loss decreased (-0.539991 --> -0.569991).  Saving model ...
Epoch: 4 cost time: 137.29061651229858
Epoch: 4, Steps: 18 | Train Loss: 0.663 Vali Loss: 3.721 Vali Acc: 0.510 Test Loss: 3.721 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 132.39964056015015
Epoch: 5, Steps: 18 | Train Loss: 0.832 Vali Loss: 4.737 Vali Acc: 0.500 Test Loss: 4.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 132.3779101371765
Epoch: 6, Steps: 18 | Train Loss: 0.902 Vali Loss: 1.732 Vali Acc: 0.500 Test Loss: 1.732 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 135.09346961975098
Epoch: 7, Steps: 18 | Train Loss: 0.423 Vali Loss: 4.073 Vali Acc: 0.500 Test Loss: 4.073 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 136.2232837677002
Epoch: 8, Steps: 18 | Train Loss: 0.582 Vali Loss: 4.764 Vali Acc: 0.530 Test Loss: 4.764 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 129.6435627937317
Epoch: 9, Steps: 18 | Train Loss: 0.462 Vali Loss: 2.263 Vali Acc: 0.550 Test Loss: 2.263 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 134.66715359687805
Epoch: 10, Steps: 18 | Train Loss: 0.932 Vali Loss: 3.133 Vali Acc: 0.540 Test Loss: 3.133 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 142.37722420692444
Epoch: 11, Steps: 18 | Train Loss: 0.943 Vali Loss: 4.737 Vali Acc: 0.490 Test Loss: 4.737 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 136.77989959716797
Epoch: 12, Steps: 18 | Train Loss: 0.322 Vali Loss: 4.525 Vali Acc: 0.500 Test Loss: 4.525 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 151.23837089538574
Epoch: 13, Steps: 18 | Train Loss: 0.500 Vali Loss: 4.911 Vali Acc: 0.520 Test Loss: 4.911 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 19144578
model size : 74.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 72.84035396575928
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 1.230 Vali Acc: 0.530 Test Loss: 1.230 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 68.38660883903503
Epoch: 2, Steps: 18 | Train Loss: 0.947 Vali Loss: 1.112 Vali Acc: 0.540 Test Loss: 1.112 Test Acc: 0.540
Validation loss decreased (-0.529988 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 67.5006217956543
Epoch: 3, Steps: 18 | Train Loss: 0.674 Vali Loss: 1.179 Vali Acc: 0.530 Test Loss: 1.179 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 71.65276002883911
Epoch: 4, Steps: 18 | Train Loss: 0.444 Vali Loss: 2.583 Vali Acc: 0.520 Test Loss: 2.583 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 71.35396432876587
Epoch: 5, Steps: 18 | Train Loss: 0.568 Vali Loss: 1.580 Vali Acc: 0.590 Test Loss: 1.580 Test Acc: 0.590
Validation loss decreased (-0.539989 --> -0.589984).  Saving model ...
Epoch: 6 cost time: 65.85218977928162
Epoch: 6, Steps: 18 | Train Loss: 0.737 Vali Loss: 2.315 Vali Acc: 0.540 Test Loss: 2.315 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 63.67271423339844
Epoch: 7, Steps: 18 | Train Loss: 0.474 Vali Loss: 2.380 Vali Acc: 0.510 Test Loss: 2.380 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 67.17272853851318
Epoch: 8, Steps: 18 | Train Loss: 0.501 Vali Loss: 3.317 Vali Acc: 0.520 Test Loss: 3.317 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 68.78943276405334
Epoch: 9, Steps: 18 | Train Loss: 0.734 Vali Loss: 3.793 Vali Acc: 0.530 Test Loss: 3.793 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 68.21054983139038
Epoch: 10, Steps: 18 | Train Loss: 0.368 Vali Loss: 4.824 Vali Acc: 0.520 Test Loss: 4.824 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 64.48882579803467
Epoch: 11, Steps: 18 | Train Loss: 0.241 Vali Loss: 3.003 Vali Acc: 0.510 Test Loss: 3.003 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 64.37781548500061
Epoch: 12, Steps: 18 | Train Loss: 0.431 Vali Loss: 5.688 Vali Acc: 0.510 Test Loss: 5.688 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 68.84425497055054
Epoch: 13, Steps: 18 | Train Loss: 0.597 Vali Loss: 7.887 Vali Acc: 0.490 Test Loss: 7.887 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 68.43040752410889
Epoch: 14, Steps: 18 | Train Loss: 0.878 Vali Loss: 3.977 Vali Acc: 0.530 Test Loss: 3.977 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 65.72550630569458
Epoch: 15, Steps: 18 | Train Loss: 0.418 Vali Loss: 4.675 Vali Acc: 0.510 Test Loss: 4.675 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5904770
model size : 23.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 126.70320081710815
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 1.472 Vali Acc: 0.460 Test Loss: 1.472 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 132.09264206886292
Epoch: 2, Steps: 18 | Train Loss: 1.152 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
Validation loss decreased (-0.459985 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 124.77132534980774
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.940 Vali Acc: 0.580 Test Loss: 0.940 Test Acc: 0.580
Validation loss decreased (-0.539991 --> -0.579991).  Saving model ...
Epoch: 4 cost time: 132.19825720787048
Epoch: 4, Steps: 18 | Train Loss: 0.814 Vali Loss: 3.235 Vali Acc: 0.510 Test Loss: 3.235 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 130.2750759124756
Epoch: 5, Steps: 18 | Train Loss: 0.714 Vali Loss: 3.466 Vali Acc: 0.490 Test Loss: 3.466 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 137.0664098262787
Epoch: 6, Steps: 18 | Train Loss: 0.585 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 141.60055708885193
Epoch: 7, Steps: 18 | Train Loss: 0.351 Vali Loss: 4.365 Vali Acc: 0.500 Test Loss: 4.365 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 133.17462015151978
Epoch: 8, Steps: 18 | Train Loss: 0.427 Vali Loss: 2.897 Vali Acc: 0.570 Test Loss: 2.897 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 141.5281903743744
Epoch: 9, Steps: 18 | Train Loss: 0.766 Vali Loss: 3.156 Vali Acc: 0.460 Test Loss: 3.156 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 138.42790460586548
Epoch: 10, Steps: 18 | Train Loss: 0.668 Vali Loss: 2.319 Vali Acc: 0.520 Test Loss: 2.319 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 139.9068410396576
Epoch: 11, Steps: 18 | Train Loss: 0.337 Vali Loss: 4.905 Vali Acc: 0.530 Test Loss: 4.905 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 143.2308099269867
Epoch: 12, Steps: 18 | Train Loss: 0.446 Vali Loss: 5.320 Vali Acc: 0.510 Test Loss: 5.320 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 136.47604417800903
Epoch: 13, Steps: 18 | Train Loss: 0.592 Vali Loss: 4.305 Vali Acc: 0.510 Test Loss: 4.305 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 19144578
model size : 74.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 57.66924571990967
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 1.227 Vali Acc: 0.530 Test Loss: 1.227 Test Acc: 0.530
Validation loss decreased (inf --> -0.529988).  Saving model ...
Epoch: 2 cost time: 56.39279055595398
Epoch: 2, Steps: 18 | Train Loss: 0.947 Vali Loss: 1.116 Vali Acc: 0.530 Test Loss: 1.116 Test Acc: 0.530
Validation loss decreased (-0.529988 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 55.57189965248108
Epoch: 3, Steps: 18 | Train Loss: 0.675 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
Validation loss decreased (-0.529989 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 55.54956841468811
Epoch: 4, Steps: 18 | Train Loss: 0.442 Vali Loss: 2.319 Vali Acc: 0.520 Test Loss: 2.319 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 53.99045372009277
Epoch: 5, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.967 Vali Acc: 0.560 Test Loss: 1.967 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559980).  Saving model ...
Epoch: 6 cost time: 56.1938054561615
Epoch: 6, Steps: 18 | Train Loss: 0.657 Vali Loss: 2.236 Vali Acc: 0.510 Test Loss: 2.236 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 56.35099959373474
Epoch: 7, Steps: 18 | Train Loss: 0.683 Vali Loss: 2.613 Vali Acc: 0.450 Test Loss: 2.613 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 53.704505443573
Epoch: 8, Steps: 18 | Train Loss: 0.413 Vali Loss: 4.048 Vali Acc: 0.550 Test Loss: 4.048 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 50.66590738296509
Epoch: 9, Steps: 18 | Train Loss: 0.843 Vali Loss: 9.152 Vali Acc: 0.500 Test Loss: 9.152 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 49.25777554512024
Epoch: 10, Steps: 18 | Train Loss: 0.851 Vali Loss: 7.470 Vali Acc: 0.500 Test Loss: 7.470 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 50.32513880729675
Epoch: 11, Steps: 18 | Train Loss: 1.068 Vali Loss: 3.649 Vali Acc: 0.440 Test Loss: 3.649 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 52.95281457901001
Epoch: 12, Steps: 18 | Train Loss: 0.355 Vali Loss: 7.305 Vali Acc: 0.510 Test Loss: 7.305 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 52.9633891582489
Epoch: 13, Steps: 18 | Train Loss: 0.397 Vali Loss: 8.254 Vali Acc: 0.480 Test Loss: 8.254 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 53.58442497253418
Epoch: 14, Steps: 18 | Train Loss: 0.467 Vali Loss: 3.675 Vali Acc: 0.480 Test Loss: 3.675 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 50.983182430267334
Epoch: 15, Steps: 18 | Train Loss: 0.339 Vali Loss: 4.747 Vali Acc: 0.500 Test Loss: 4.747 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5904770
model size : 23.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 78.80046844482422
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 1.478 Vali Acc: 0.460 Test Loss: 1.478 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 82.38323378562927
Epoch: 2, Steps: 18 | Train Loss: 1.155 Vali Loss: 0.918 Vali Acc: 0.530 Test Loss: 0.918 Test Acc: 0.530
Validation loss decreased (-0.459985 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 82.68080639839172
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.959 Vali Acc: 0.540 Test Loss: 0.959 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539990).  Saving model ...
Epoch: 4 cost time: 76.85422921180725
Epoch: 4, Steps: 18 | Train Loss: 0.812 Vali Loss: 2.674 Vali Acc: 0.490 Test Loss: 2.674 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 78.19675970077515
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 2.398 Vali Acc: 0.460 Test Loss: 2.398 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 81.9790666103363
Epoch: 6, Steps: 18 | Train Loss: 0.689 Vali Loss: 2.048 Vali Acc: 0.500 Test Loss: 2.048 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 82.41456055641174
Epoch: 7, Steps: 18 | Train Loss: 0.579 Vali Loss: 2.676 Vali Acc: 0.500 Test Loss: 2.676 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 77.35012173652649
Epoch: 8, Steps: 18 | Train Loss: 0.673 Vali Loss: 2.680 Vali Acc: 0.500 Test Loss: 2.680 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 78.57334518432617
Epoch: 9, Steps: 18 | Train Loss: 0.551 Vali Loss: 3.036 Vali Acc: 0.510 Test Loss: 3.036 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 81.81484937667847
Epoch: 10, Steps: 18 | Train Loss: 0.388 Vali Loss: 2.277 Vali Acc: 0.520 Test Loss: 2.277 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 81.3445496559143
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 3.153 Vali Acc: 0.530 Test Loss: 3.153 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 77.6163547039032
Epoch: 12, Steps: 18 | Train Loss: 0.718 Vali Loss: 3.696 Vali Acc: 0.490 Test Loss: 3.696 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 78.49358797073364
Epoch: 13, Steps: 18 | Train Loss: 0.805 Vali Loss: 3.068 Vali Acc: 0.480 Test Loss: 3.068 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 19144578
model size : 74.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 35.78333067893982
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 1.219 Vali Acc: 0.520 Test Loss: 1.219 Test Acc: 0.520
Validation loss decreased (inf --> -0.519988).  Saving model ...
Epoch: 2 cost time: 34.55752348899841
Epoch: 2, Steps: 18 | Train Loss: 0.944 Vali Loss: 1.164 Vali Acc: 0.530 Test Loss: 1.164 Test Acc: 0.530
Validation loss decreased (-0.519988 --> -0.529988).  Saving model ...
Epoch: 3 cost time: 32.65301442146301
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.218 Vali Acc: 0.560 Test Loss: 1.218 Test Acc: 0.560
Validation loss decreased (-0.529988 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 33.28176927566528
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 2.375 Vali Acc: 0.470 Test Loss: 2.375 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.523960828781128
Epoch: 5, Steps: 18 | Train Loss: 0.635 Vali Loss: 1.657 Vali Acc: 0.520 Test Loss: 1.657 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 33.359902143478394
Epoch: 6, Steps: 18 | Train Loss: 0.573 Vali Loss: 2.871 Vali Acc: 0.500 Test Loss: 2.871 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.905830144882202
Epoch: 7, Steps: 18 | Train Loss: 0.741 Vali Loss: 2.920 Vali Acc: 0.540 Test Loss: 2.920 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 33.6290545463562
Epoch: 8, Steps: 18 | Train Loss: 0.641 Vali Loss: 4.109 Vali Acc: 0.480 Test Loss: 4.109 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 18.9552059173584
Epoch: 9, Steps: 18 | Train Loss: 0.506 Vali Loss: 6.049 Vali Acc: 0.510 Test Loss: 6.049 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 33.969913482666016
Epoch: 10, Steps: 18 | Train Loss: 0.756 Vali Loss: 5.864 Vali Acc: 0.500 Test Loss: 5.864 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 32.89468264579773
Epoch: 11, Steps: 18 | Train Loss: 0.865 Vali Loss: 5.942 Vali Acc: 0.490 Test Loss: 5.942 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 33.30679512023926
Epoch: 12, Steps: 18 | Train Loss: 0.967 Vali Loss: 5.709 Vali Acc: 0.490 Test Loss: 5.709 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 31.634218454360962
Epoch: 13, Steps: 18 | Train Loss: 0.575 Vali Loss: 3.227 Vali Acc: 0.530 Test Loss: 3.227 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5904770
model size : 23.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 107.9090964794159
Epoch: 1, Steps: 18 | Train Loss: 1.047 Vali Loss: 0.978 Vali Acc: 0.530 Test Loss: 0.978 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 102.14533376693726
Epoch: 2, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.967 Vali Acc: 0.510 Test Loss: 0.967 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 106.79545974731445
Epoch: 3, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.838 Vali Acc: 0.550 Test Loss: 1.838 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549982).  Saving model ...
Epoch: 4 cost time: 101.92929530143738
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 1.704 Vali Acc: 0.440 Test Loss: 1.704 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 108.08721685409546
Epoch: 5, Steps: 18 | Train Loss: 0.673 Vali Loss: 2.303 Vali Acc: 0.460 Test Loss: 2.303 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 102.63308715820312
Epoch: 6, Steps: 18 | Train Loss: 1.496 Vali Loss: 3.821 Vali Acc: 0.500 Test Loss: 3.821 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 110.41442656517029
Epoch: 7, Steps: 18 | Train Loss: 0.791 Vali Loss: 2.568 Vali Acc: 0.570 Test Loss: 2.568 Test Acc: 0.570
Validation loss decreased (-0.549982 --> -0.569974).  Saving model ...
Epoch: 8 cost time: 102.09181308746338
Epoch: 8, Steps: 18 | Train Loss: 0.791 Vali Loss: 3.303 Vali Acc: 0.480 Test Loss: 3.303 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 108.06429266929626
Epoch: 9, Steps: 18 | Train Loss: 0.303 Vali Loss: 4.663 Vali Acc: 0.510 Test Loss: 4.663 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 100.5322916507721
Epoch: 10, Steps: 18 | Train Loss: 0.898 Vali Loss: 4.622 Vali Acc: 0.480 Test Loss: 4.622 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 105.2996199131012
Epoch: 11, Steps: 18 | Train Loss: 0.852 Vali Loss: 3.271 Vali Acc: 0.520 Test Loss: 3.271 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 95.82701754570007
Epoch: 12, Steps: 18 | Train Loss: 0.675 Vali Loss: 3.157 Vali Acc: 0.500 Test Loss: 3.157 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 104.60508966445923
Epoch: 13, Steps: 18 | Train Loss: 0.269 Vali Loss: 4.766 Vali Acc: 0.520 Test Loss: 4.766 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 94.80308771133423
Epoch: 14, Steps: 18 | Train Loss: 0.549 Vali Loss: 5.178 Vali Acc: 0.560 Test Loss: 5.178 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 111.94107604026794
Epoch: 15, Steps: 18 | Train Loss: 0.317 Vali Loss: 6.163 Vali Acc: 0.510 Test Loss: 6.163 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 100.92299890518188
Epoch: 16, Steps: 18 | Train Loss: 0.223 Vali Loss: 4.096 Vali Acc: 0.470 Test Loss: 4.096 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 110.2073438167572
Epoch: 17, Steps: 18 | Train Loss: 0.189 Vali Loss: 5.164 Vali Acc: 0.470 Test Loss: 5.164 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9771394
model size : 38.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 40.37652540206909
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 1.594 Vali Acc: 0.510 Test Loss: 1.594 Test Acc: 0.510
Validation loss decreased (inf --> -0.509984).  Saving model ...
Epoch: 2 cost time: 43.2811963558197
Epoch: 2, Steps: 18 | Train Loss: 1.071 Vali Loss: 0.822 Vali Acc: 0.640 Test Loss: 0.822 Test Acc: 0.640
Validation loss decreased (-0.509984 --> -0.639992).  Saving model ...
Epoch: 3 cost time: 44.681947231292725
Epoch: 3, Steps: 18 | Train Loss: 0.756 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.406139850616455
Epoch: 4, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.312 Vali Acc: 0.510 Test Loss: 1.312 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 39.39751172065735
Epoch: 5, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 40.124515533447266
Epoch: 6, Steps: 18 | Train Loss: 0.572 Vali Loss: 1.780 Vali Acc: 0.550 Test Loss: 1.780 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 44.729347944259644
Epoch: 7, Steps: 18 | Train Loss: 0.716 Vali Loss: 3.229 Vali Acc: 0.470 Test Loss: 3.229 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 44.79091215133667
Epoch: 8, Steps: 18 | Train Loss: 0.699 Vali Loss: 1.944 Vali Acc: 0.520 Test Loss: 1.944 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 43.76226878166199
Epoch: 9, Steps: 18 | Train Loss: 0.476 Vali Loss: 3.299 Vali Acc: 0.560 Test Loss: 3.299 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 41.39076375961304
Epoch: 10, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.904 Vali Acc: 0.540 Test Loss: 3.904 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 42.412450313568115
Epoch: 11, Steps: 18 | Train Loss: 0.568 Vali Loss: 3.146 Vali Acc: 0.490 Test Loss: 3.146 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 44.76366376876831
Epoch: 12, Steps: 18 | Train Loss: 0.717 Vali Loss: 5.040 Vali Acc: 0.600 Test Loss: 5.040 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 3151234
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 79.48887753486633
Epoch: 1, Steps: 18 | Train Loss: 1.047 Vali Loss: 0.978 Vali Acc: 0.530 Test Loss: 0.978 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 80.47644662857056
Epoch: 2, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 85.5114905834198
Epoch: 3, Steps: 18 | Train Loss: 0.786 Vali Loss: 1.835 Vali Acc: 0.550 Test Loss: 1.835 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549982).  Saving model ...
Epoch: 4 cost time: 77.71164178848267
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 1.702 Vali Acc: 0.420 Test Loss: 1.702 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 87.74647116661072
Epoch: 5, Steps: 18 | Train Loss: 0.634 Vali Loss: 2.580 Vali Acc: 0.450 Test Loss: 2.580 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 83.18280816078186
Epoch: 6, Steps: 18 | Train Loss: 1.199 Vali Loss: 1.907 Vali Acc: 0.510 Test Loss: 1.907 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 81.01454544067383
Epoch: 7, Steps: 18 | Train Loss: 0.416 Vali Loss: 3.521 Vali Acc: 0.490 Test Loss: 3.521 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 84.54192471504211
Epoch: 8, Steps: 18 | Train Loss: 0.673 Vali Loss: 5.864 Vali Acc: 0.500 Test Loss: 5.864 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 83.05962228775024
Epoch: 9, Steps: 18 | Train Loss: 0.752 Vali Loss: 5.518 Vali Acc: 0.520 Test Loss: 5.518 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 79.72737193107605
Epoch: 10, Steps: 18 | Train Loss: 0.335 Vali Loss: 3.796 Vali Acc: 0.520 Test Loss: 3.796 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 87.61780190467834
Epoch: 11, Steps: 18 | Train Loss: 0.393 Vali Loss: 3.772 Vali Acc: 0.580 Test Loss: 3.772 Test Acc: 0.580
Validation loss decreased (-0.549982 --> -0.579962).  Saving model ...
Epoch: 12 cost time: 80.51412916183472
Epoch: 12, Steps: 18 | Train Loss: 0.350 Vali Loss: 4.435 Vali Acc: 0.480 Test Loss: 4.435 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 86.93250346183777
Epoch: 13, Steps: 18 | Train Loss: 0.583 Vali Loss: 3.303 Vali Acc: 0.470 Test Loss: 3.303 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 83.38994860649109
Epoch: 14, Steps: 18 | Train Loss: 0.334 Vali Loss: 6.757 Vali Acc: 0.530 Test Loss: 6.757 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 77.44796895980835
Epoch: 15, Steps: 18 | Train Loss: 0.381 Vali Loss: 3.325 Vali Acc: 0.550 Test Loss: 3.325 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 83.53252458572388
Epoch: 16, Steps: 18 | Train Loss: 0.333 Vali Loss: 5.189 Vali Acc: 0.520 Test Loss: 5.189 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 77.46932029724121
Epoch: 17, Steps: 18 | Train Loss: 0.955 Vali Loss: 3.600 Vali Acc: 0.510 Test Loss: 3.600 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 83.6777172088623
Epoch: 18, Steps: 18 | Train Loss: 0.254 Vali Loss: 4.160 Vali Acc: 0.560 Test Loss: 4.160 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 82.45914506912231
Epoch: 19, Steps: 18 | Train Loss: 0.401 Vali Loss: 4.751 Vali Acc: 0.540 Test Loss: 4.751 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 77.44106864929199
Epoch: 20, Steps: 18 | Train Loss: 0.270 Vali Loss: 8.362 Vali Acc: 0.480 Test Loss: 8.362 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 83.63960814476013
Epoch: 21, Steps: 18 | Train Loss: 0.205 Vali Loss: 5.268 Vali Acc: 0.500 Test Loss: 5.268 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9771394
model size : 38.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.555622100830078
Epoch: 1, Steps: 18 | Train Loss: 0.855 Vali Loss: 1.591 Vali Acc: 0.510 Test Loss: 1.591 Test Acc: 0.510
Validation loss decreased (inf --> -0.509984).  Saving model ...
Epoch: 2 cost time: 31.503182888031006
Epoch: 2, Steps: 18 | Train Loss: 1.074 Vali Loss: 0.818 Vali Acc: 0.630 Test Loss: 0.818 Test Acc: 0.630
Validation loss decreased (-0.509984 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 34.205466985702515
Epoch: 3, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.121 Vali Acc: 0.570 Test Loss: 1.121 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.83142614364624
Epoch: 4, Steps: 18 | Train Loss: 0.957 Vali Loss: 1.599 Vali Acc: 0.510 Test Loss: 1.599 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.75769352912903
Epoch: 5, Steps: 18 | Train Loss: 1.051 Vali Loss: 3.250 Vali Acc: 0.500 Test Loss: 3.250 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 31.277992963790894
Epoch: 6, Steps: 18 | Train Loss: 1.190 Vali Loss: 1.772 Vali Acc: 0.530 Test Loss: 1.772 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 30.87107515335083
Epoch: 7, Steps: 18 | Train Loss: 0.333 Vali Loss: 3.153 Vali Acc: 0.470 Test Loss: 3.153 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.65835404396057
Epoch: 8, Steps: 18 | Train Loss: 0.412 Vali Loss: 2.866 Vali Acc: 0.560 Test Loss: 2.866 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 34.1775541305542
Epoch: 9, Steps: 18 | Train Loss: 0.457 Vali Loss: 2.731 Vali Acc: 0.550 Test Loss: 2.731 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 34.81688714027405
Epoch: 10, Steps: 18 | Train Loss: 0.475 Vali Loss: 2.474 Vali Acc: 0.570 Test Loss: 2.474 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 33.87522339820862
Epoch: 11, Steps: 18 | Train Loss: 0.202 Vali Loss: 3.125 Vali Acc: 0.530 Test Loss: 3.125 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 31.086699724197388
Epoch: 12, Steps: 18 | Train Loss: 0.467 Vali Loss: 6.525 Vali Acc: 0.520 Test Loss: 6.525 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3151234
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 51.402220726013184
Epoch: 1, Steps: 18 | Train Loss: 1.047 Vali Loss: 0.979 Vali Acc: 0.530 Test Loss: 0.979 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 50.63066911697388
Epoch: 2, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.953 Vali Acc: 0.500 Test Loss: 0.953 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 54.67379546165466
Epoch: 3, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.842 Vali Acc: 0.570 Test Loss: 1.842 Test Acc: 0.570
Validation loss decreased (-0.529990 --> -0.569982).  Saving model ...
Epoch: 4 cost time: 68.12938284873962
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 1.378 Vali Acc: 0.480 Test Loss: 1.378 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 73.12986707687378
Epoch: 5, Steps: 18 | Train Loss: 0.673 Vali Loss: 2.598 Vali Acc: 0.480 Test Loss: 2.598 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 73.67836380004883
Epoch: 6, Steps: 18 | Train Loss: 1.453 Vali Loss: 2.795 Vali Acc: 0.510 Test Loss: 2.795 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 71.87283682823181
Epoch: 7, Steps: 18 | Train Loss: 0.569 Vali Loss: 2.119 Vali Acc: 0.530 Test Loss: 2.119 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 67.63198757171631
Epoch: 8, Steps: 18 | Train Loss: 1.134 Vali Loss: 2.015 Vali Acc: 0.560 Test Loss: 2.015 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 70.06722569465637
Epoch: 9, Steps: 18 | Train Loss: 0.698 Vali Loss: 2.058 Vali Acc: 0.500 Test Loss: 2.058 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 72.85125541687012
Epoch: 10, Steps: 18 | Train Loss: 0.540 Vali Loss: 4.219 Vali Acc: 0.530 Test Loss: 4.219 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 70.36943769454956
Epoch: 11, Steps: 18 | Train Loss: 0.509 Vali Loss: 4.712 Vali Acc: 0.520 Test Loss: 4.712 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 67.65375351905823
Epoch: 12, Steps: 18 | Train Loss: 0.367 Vali Loss: 2.702 Vali Acc: 0.520 Test Loss: 2.702 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 71.57405877113342
Epoch: 13, Steps: 18 | Train Loss: 0.684 Vali Loss: 7.273 Vali Acc: 0.500 Test Loss: 7.273 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 9771394
model size : 38.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.243874311447144
Epoch: 1, Steps: 18 | Train Loss: 0.857 Vali Loss: 1.589 Vali Acc: 0.510 Test Loss: 1.589 Test Acc: 0.510
Validation loss decreased (inf --> -0.509984).  Saving model ...
Epoch: 2 cost time: 29.628855228424072
Epoch: 2, Steps: 18 | Train Loss: 1.076 Vali Loss: 0.813 Vali Acc: 0.630 Test Loss: 0.813 Test Acc: 0.630
Validation loss decreased (-0.509984 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 29.327852725982666
Epoch: 3, Steps: 18 | Train Loss: 0.769 Vali Loss: 1.115 Vali Acc: 0.580 Test Loss: 1.115 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 29.409586906433105
Epoch: 4, Steps: 18 | Train Loss: 0.986 Vali Loss: 1.560 Vali Acc: 0.520 Test Loss: 1.560 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 29.18293285369873
Epoch: 5, Steps: 18 | Train Loss: 1.018 Vali Loss: 3.652 Vali Acc: 0.500 Test Loss: 3.652 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.421441078186035
Epoch: 6, Steps: 18 | Train Loss: 1.158 Vali Loss: 1.589 Vali Acc: 0.510 Test Loss: 1.589 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 30.52937412261963
Epoch: 7, Steps: 18 | Train Loss: 0.935 Vali Loss: 2.554 Vali Acc: 0.480 Test Loss: 2.554 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 31.209447860717773
Epoch: 8, Steps: 18 | Train Loss: 0.586 Vali Loss: 6.066 Vali Acc: 0.510 Test Loss: 6.066 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 31.273123264312744
Epoch: 9, Steps: 18 | Train Loss: 0.710 Vali Loss: 1.752 Vali Acc: 0.580 Test Loss: 1.752 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 31.27457547187805
Epoch: 10, Steps: 18 | Train Loss: 0.602 Vali Loss: 6.796 Vali Acc: 0.520 Test Loss: 6.796 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 31.460236310958862
Epoch: 11, Steps: 18 | Train Loss: 0.646 Vali Loss: 3.332 Vali Acc: 0.470 Test Loss: 3.332 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 30.1043381690979
Epoch: 12, Steps: 18 | Train Loss: 0.366 Vali Loss: 4.349 Vali Acc: 0.550 Test Loss: 4.349 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 3151234
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 142.3953583240509
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.056 Vali Acc: 0.490 Test Loss: 1.056 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 151.5398666858673
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 1.072 Vali Acc: 0.490 Test Loss: 1.072 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 145.48128533363342
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.780 Vali Acc: 0.580 Test Loss: 0.780 Test Acc: 0.580
Validation loss decreased (-0.489989 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 146.46846866607666
Epoch: 4, Steps: 18 | Train Loss: 0.490 Vali Loss: 1.406 Vali Acc: 0.510 Test Loss: 1.406 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 145.83881425857544
Epoch: 5, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.963 Vali Acc: 0.560 Test Loss: 0.963 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 144.90506958961487
Epoch: 6, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.525 Vali Acc: 0.570 Test Loss: 1.525 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 147.49817562103271
Epoch: 7, Steps: 18 | Train Loss: 0.398 Vali Loss: 3.500 Vali Acc: 0.490 Test Loss: 3.500 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 144.04576516151428
Epoch: 8, Steps: 18 | Train Loss: 0.270 Vali Loss: 2.869 Vali Acc: 0.520 Test Loss: 2.869 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 145.00110054016113
Epoch: 9, Steps: 18 | Train Loss: 0.465 Vali Loss: 2.957 Vali Acc: 0.500 Test Loss: 2.957 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 149.27904605865479
Epoch: 10, Steps: 18 | Train Loss: 0.528 Vali Loss: 4.039 Vali Acc: 0.480 Test Loss: 4.039 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 144.7537989616394
Epoch: 11, Steps: 18 | Train Loss: 0.284 Vali Loss: 2.575 Vali Acc: 0.520 Test Loss: 2.575 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 141.69300746917725
Epoch: 12, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.697 Vali Acc: 0.510 Test Loss: 1.697 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 148.9635636806488
Epoch: 13, Steps: 18 | Train Loss: 0.102 Vali Loss: 3.293 Vali Acc: 0.550 Test Loss: 3.293 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9573826
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 63.270599126815796
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.821 Vali Acc: 0.520 Test Loss: 0.821 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 65.49492478370667
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.487 Vali Acc: 0.480 Test Loss: 1.487 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 62.05818772315979
Epoch: 3, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 59.851877212524414
Epoch: 4, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.997 Vali Acc: 0.490 Test Loss: 0.997 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 65.66284418106079
Epoch: 5, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.336 Vali Acc: 0.540 Test Loss: 1.336 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 65.87152576446533
Epoch: 6, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.473 Vali Acc: 0.470 Test Loss: 1.473 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 61.55001878738403
Epoch: 7, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.806 Vali Acc: 0.530 Test Loss: 1.806 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 63.237218379974365
Epoch: 8, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.505 Vali Acc: 0.480 Test Loss: 1.505 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 64.28418469429016
Epoch: 9, Steps: 18 | Train Loss: 0.267 Vali Loss: 2.369 Vali Acc: 0.470 Test Loss: 2.369 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 61.60173034667969
Epoch: 10, Steps: 18 | Train Loss: 0.661 Vali Loss: 3.238 Vali Acc: 0.530 Test Loss: 3.238 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 62.06355118751526
Epoch: 11, Steps: 18 | Train Loss: 0.295 Vali Loss: 2.095 Vali Acc: 0.560 Test Loss: 2.095 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 66.5913290977478
Epoch: 12, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.172 Vali Acc: 0.530 Test Loss: 2.172 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 67.15854978561401
Epoch: 13, Steps: 18 | Train Loss: 0.048 Vali Loss: 3.754 Vali Acc: 0.510 Test Loss: 3.754 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2953410
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 115.65547919273376
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.056 Vali Acc: 0.490 Test Loss: 1.056 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 112.64037346839905
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 1.064 Vali Acc: 0.490 Test Loss: 1.064 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 113.41803693771362
Epoch: 3, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.775 Vali Acc: 0.580 Test Loss: 0.775 Test Acc: 0.580
Validation loss decreased (-0.489989 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 114.48291659355164
Epoch: 4, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.645 Vali Acc: 0.510 Test Loss: 1.645 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 111.4217529296875
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.062 Vali Acc: 0.560 Test Loss: 1.062 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 115.56027221679688
Epoch: 6, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.410 Vali Acc: 0.550 Test Loss: 1.410 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 117.37498331069946
Epoch: 7, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.685 Vali Acc: 0.460 Test Loss: 1.685 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 115.11724877357483
Epoch: 8, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.989 Vali Acc: 0.550 Test Loss: 1.989 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 104.32732462882996
Epoch: 9, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.489 Vali Acc: 0.450 Test Loss: 1.489 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 116.61509084701538
Epoch: 10, Steps: 18 | Train Loss: 0.216 Vali Loss: 2.400 Vali Acc: 0.480 Test Loss: 2.400 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 110.99791765213013
Epoch: 11, Steps: 18 | Train Loss: 0.278 Vali Loss: 2.125 Vali Acc: 0.520 Test Loss: 2.125 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 114.68609070777893
Epoch: 12, Steps: 18 | Train Loss: 0.265 Vali Loss: 2.565 Vali Acc: 0.510 Test Loss: 2.565 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 112.45345640182495
Epoch: 13, Steps: 18 | Train Loss: 0.303 Vali Loss: 2.281 Vali Acc: 0.540 Test Loss: 2.281 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9573826
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 53.97955274581909
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 49.091657876968384
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 1.497 Vali Acc: 0.470 Test Loss: 1.497 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.16551756858826
Epoch: 3, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.838 Vali Acc: 0.570 Test Loss: 0.838 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 51.80350875854492
Epoch: 4, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.973 Vali Acc: 0.470 Test Loss: 0.973 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 49.011433601379395
Epoch: 5, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.307 Vali Acc: 0.510 Test Loss: 1.307 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 47.086177825927734
Epoch: 6, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.248 Vali Acc: 0.550 Test Loss: 1.248 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 47.99069809913635
Epoch: 7, Steps: 18 | Train Loss: 0.671 Vali Loss: 1.495 Vali Acc: 0.530 Test Loss: 1.495 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 51.0144317150116
Epoch: 8, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.831 Vali Acc: 0.470 Test Loss: 1.831 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 51.58184003829956
Epoch: 9, Steps: 18 | Train Loss: 0.162 Vali Loss: 2.061 Vali Acc: 0.450 Test Loss: 2.061 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 49.646217584609985
Epoch: 10, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.472 Vali Acc: 0.540 Test Loss: 1.472 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 48.89089035987854
Epoch: 11, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.504 Vali Acc: 0.510 Test Loss: 1.504 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 51.481202125549316
Epoch: 12, Steps: 18 | Train Loss: 0.276 Vali Loss: 2.756 Vali Acc: 0.490 Test Loss: 2.756 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 50.556190729141235
Epoch: 13, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.410 Vali Acc: 0.480 Test Loss: 2.410 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2953410
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 70.93844223022461
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.053 Vali Acc: 0.490 Test Loss: 1.053 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 72.74680829048157
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 1.082 Vali Acc: 0.490 Test Loss: 1.082 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 73.91315340995789
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.819 Vali Acc: 0.550 Test Loss: 0.819 Test Acc: 0.550
Validation loss decreased (-0.489989 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 69.18117952346802
Epoch: 4, Steps: 18 | Train Loss: 0.487 Vali Loss: 1.449 Vali Acc: 0.520 Test Loss: 1.449 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 69.65224575996399
Epoch: 5, Steps: 18 | Train Loss: 0.378 Vali Loss: 1.094 Vali Acc: 0.590 Test Loss: 1.094 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589989).  Saving model ...
Epoch: 6 cost time: 73.21682906150818
Epoch: 6, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.489 Vali Acc: 0.550 Test Loss: 1.489 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 70.08939337730408
Epoch: 7, Steps: 18 | Train Loss: 0.387 Vali Loss: 2.374 Vali Acc: 0.510 Test Loss: 2.374 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 73.08413791656494
Epoch: 8, Steps: 18 | Train Loss: 0.382 Vali Loss: 2.227 Vali Acc: 0.530 Test Loss: 2.227 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 75.51954007148743
Epoch: 9, Steps: 18 | Train Loss: 0.390 Vali Loss: 4.294 Vali Acc: 0.500 Test Loss: 4.294 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 70.64453220367432
Epoch: 10, Steps: 18 | Train Loss: 0.563 Vali Loss: 2.961 Vali Acc: 0.500 Test Loss: 2.961 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 68.57645845413208
Epoch: 11, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.663 Vali Acc: 0.520 Test Loss: 1.663 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 73.53111600875854
Epoch: 12, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.897 Vali Acc: 0.520 Test Loss: 1.897 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 69.48964953422546
Epoch: 13, Steps: 18 | Train Loss: 0.140 Vali Loss: 3.287 Vali Acc: 0.540 Test Loss: 3.287 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 70.52287292480469
Epoch: 14, Steps: 18 | Train Loss: 0.051 Vali Loss: 2.445 Vali Acc: 0.560 Test Loss: 2.445 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 73.39374423027039
Epoch: 15, Steps: 18 | Train Loss: 0.104 Vali Loss: 2.276 Vali Acc: 0.530 Test Loss: 2.276 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9573826
model size : 37.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.723384618759155
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.815 Vali Acc: 0.520 Test Loss: 0.815 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 30.182350397109985
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 1.486 Vali Acc: 0.470 Test Loss: 1.486 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.27613091468811
Epoch: 3, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.834 Vali Acc: 0.570 Test Loss: 0.834 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 33.979124784469604
Epoch: 4, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.953 Vali Acc: 0.470 Test Loss: 0.953 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.017279863357544
Epoch: 5, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 34.26701259613037
Epoch: 6, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.247 Vali Acc: 0.530 Test Loss: 1.247 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.979427099227905
Epoch: 7, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.639 Vali Acc: 0.520 Test Loss: 1.639 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 32.10775136947632
Epoch: 8, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.177 Vali Acc: 0.470 Test Loss: 1.177 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 32.45784378051758
Epoch: 9, Steps: 18 | Train Loss: 0.385 Vali Loss: 2.729 Vali Acc: 0.530 Test Loss: 2.729 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 34.48263335227966
Epoch: 10, Steps: 18 | Train Loss: 0.595 Vali Loss: 2.646 Vali Acc: 0.540 Test Loss: 2.646 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 34.441290855407715
Epoch: 11, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.710 Vali Acc: 0.540 Test Loss: 1.710 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 34.41829538345337
Epoch: 12, Steps: 18 | Train Loss: 0.258 Vali Loss: 2.569 Vali Acc: 0.580 Test Loss: 2.569 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579974).  Saving model ...
Epoch: 13 cost time: 31.740655422210693
Epoch: 13, Steps: 18 | Train Loss: 0.353 Vali Loss: 2.583 Vali Acc: 0.500 Test Loss: 2.583 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 29.696876525878906
Epoch: 14, Steps: 18 | Train Loss: 0.512 Vali Loss: 5.772 Vali Acc: 0.520 Test Loss: 5.772 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 31.456925868988037
Epoch: 15, Steps: 18 | Train Loss: 0.518 Vali Loss: 3.134 Vali Acc: 0.590 Test Loss: 3.134 Test Acc: 0.590
Validation loss decreased (-0.579974 --> -0.589969).  Saving model ...
Epoch: 16 cost time: 33.6313841342926
Epoch: 16, Steps: 18 | Train Loss: 0.300 Vali Loss: 4.788 Vali Acc: 0.540 Test Loss: 4.788 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 34.13562989234924
Epoch: 17, Steps: 18 | Train Loss: 0.739 Vali Loss: 3.651 Vali Acc: 0.560 Test Loss: 3.651 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 33.88083744049072
Epoch: 18, Steps: 18 | Train Loss: 0.282 Vali Loss: 2.752 Vali Acc: 0.480 Test Loss: 2.752 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 34.24719047546387
Epoch: 19, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.715 Vali Acc: 0.500 Test Loss: 2.715 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 31.86636519432068
Epoch: 20, Steps: 18 | Train Loss: 0.170 Vali Loss: 5.690 Vali Acc: 0.520 Test Loss: 5.690 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 31.721644401550293
Epoch: 21, Steps: 18 | Train Loss: 0.503 Vali Loss: 3.354 Vali Acc: 0.500 Test Loss: 3.354 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 32.52494764328003
Epoch: 22, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.826 Vali Acc: 0.500 Test Loss: 2.826 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 34.59797191619873
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 4.445 Vali Acc: 0.460 Test Loss: 4.445 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 33.7487211227417
Epoch: 24, Steps: 18 | Train Loss: 0.062 Vali Loss: 5.925 Vali Acc: 0.470 Test Loss: 5.925 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 32.738282680511475
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 6.584 Vali Acc: 0.490 Test Loss: 6.584 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2953410
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 78.83437633514404
Epoch: 1, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.897 Vali Acc: 0.440 Test Loss: 0.897 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 89.61463499069214
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.791 Vali Acc: 0.600 Test Loss: 0.791 Test Acc: 0.600
Validation loss decreased (-0.439991 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 81.16962790489197
Epoch: 3, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 86.95712280273438
Epoch: 4, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.677 Vali Acc: 0.510 Test Loss: 1.677 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 86.96453595161438
Epoch: 5, Steps: 18 | Train Loss: 0.847 Vali Loss: 3.102 Vali Acc: 0.490 Test Loss: 3.102 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 82.38887310028076
Epoch: 6, Steps: 18 | Train Loss: 0.856 Vali Loss: 1.465 Vali Acc: 0.510 Test Loss: 1.465 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 91.08779978752136
Epoch: 7, Steps: 18 | Train Loss: 0.588 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 82.08519744873047
Epoch: 8, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.790 Vali Acc: 0.420 Test Loss: 1.790 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 82.8757176399231
Epoch: 9, Steps: 18 | Train Loss: 0.371 Vali Loss: 2.194 Vali Acc: 0.520 Test Loss: 2.194 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 91.9469382762909
Epoch: 10, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.540 Vali Acc: 0.550 Test Loss: 1.540 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 96.22790169715881
Epoch: 11, Steps: 18 | Train Loss: 0.166 Vali Loss: 2.875 Vali Acc: 0.500 Test Loss: 2.875 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 89.23299312591553
Epoch: 12, Steps: 18 | Train Loss: 0.406 Vali Loss: 4.912 Vali Acc: 0.480 Test Loss: 4.912 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4886466
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 39.31824231147766
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.744 Vali Acc: 0.610 Test Loss: 0.744 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 40.51237964630127
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 41.395376443862915
Epoch: 3, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.865 Vali Acc: 0.600 Test Loss: 0.865 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 41.571941614151
Epoch: 4, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.530 Vali Acc: 0.450 Test Loss: 1.530 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 39.6714768409729
Epoch: 5, Steps: 18 | Train Loss: 0.596 Vali Loss: 1.343 Vali Acc: 0.510 Test Loss: 1.343 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 41.16933226585388
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.455 Vali Acc: 0.560 Test Loss: 1.455 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 41.08057498931885
Epoch: 7, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.495 Vali Acc: 0.500 Test Loss: 1.495 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 40.706711769104004
Epoch: 8, Steps: 18 | Train Loss: 0.328 Vali Loss: 2.121 Vali Acc: 0.480 Test Loss: 2.121 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 37.95705437660217
Epoch: 9, Steps: 18 | Train Loss: 0.573 Vali Loss: 2.403 Vali Acc: 0.560 Test Loss: 2.403 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 39.75664305686951
Epoch: 10, Steps: 18 | Train Loss: 0.388 Vali Loss: 3.322 Vali Acc: 0.540 Test Loss: 3.322 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 41.26109719276428
Epoch: 11, Steps: 18 | Train Loss: 0.506 Vali Loss: 2.175 Vali Acc: 0.510 Test Loss: 2.175 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1576130
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 69.64134860038757
Epoch: 1, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.897 Vali Acc: 0.440 Test Loss: 0.897 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 71.33171772956848
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.793 Vali Acc: 0.600 Test Loss: 0.793 Test Acc: 0.600
Validation loss decreased (-0.439991 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 68.01840615272522
Epoch: 3, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 67.15700578689575
Epoch: 4, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.670 Vali Acc: 0.510 Test Loss: 1.670 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 69.17006158828735
Epoch: 5, Steps: 18 | Train Loss: 0.853 Vali Loss: 3.144 Vali Acc: 0.490 Test Loss: 3.144 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 66.42993116378784
Epoch: 6, Steps: 18 | Train Loss: 0.904 Vali Loss: 1.349 Vali Acc: 0.510 Test Loss: 1.349 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 72.06332969665527
Epoch: 7, Steps: 18 | Train Loss: 0.510 Vali Loss: 1.614 Vali Acc: 0.540 Test Loss: 1.614 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 69.09943890571594
Epoch: 8, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.556 Vali Acc: 0.490 Test Loss: 1.556 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 69.7553927898407
Epoch: 9, Steps: 18 | Train Loss: 0.293 Vali Loss: 4.105 Vali Acc: 0.500 Test Loss: 4.105 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 69.65861892700195
Epoch: 10, Steps: 18 | Train Loss: 0.313 Vali Loss: 2.311 Vali Acc: 0.520 Test Loss: 2.311 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 68.95004558563232
Epoch: 11, Steps: 18 | Train Loss: 0.176 Vali Loss: 3.341 Vali Acc: 0.520 Test Loss: 3.341 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 71.78718376159668
Epoch: 12, Steps: 18 | Train Loss: 0.134 Vali Loss: 4.758 Vali Acc: 0.510 Test Loss: 4.758 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4886466
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.77337074279785
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 0.743 Vali Acc: 0.600 Test Loss: 0.743 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 31.00492000579834
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.864750385284424
Epoch: 3, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.876 Vali Acc: 0.600 Test Loss: 0.876 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 30.83499264717102
Epoch: 4, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.439 Vali Acc: 0.450 Test Loss: 1.439 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 29.5565664768219
Epoch: 5, Steps: 18 | Train Loss: 0.589 Vali Loss: 1.292 Vali Acc: 0.550 Test Loss: 1.292 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 28.797687530517578
Epoch: 6, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.339 Vali Acc: 0.570 Test Loss: 1.339 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 31.046077489852905
Epoch: 7, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 32.0311164855957
Epoch: 8, Steps: 18 | Train Loss: 0.403 Vali Loss: 1.315 Vali Acc: 0.580 Test Loss: 1.315 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 32.33937120437622
Epoch: 9, Steps: 18 | Train Loss: 0.260 Vali Loss: 3.784 Vali Acc: 0.480 Test Loss: 3.784 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 31.55826735496521
Epoch: 10, Steps: 18 | Train Loss: 0.327 Vali Loss: 3.057 Vali Acc: 0.490 Test Loss: 3.057 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 29.90669322013855
Epoch: 11, Steps: 18 | Train Loss: 0.239 Vali Loss: 3.441 Vali Acc: 0.470 Test Loss: 3.441 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1576130
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 46.554821491241455
Epoch: 1, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.898 Vali Acc: 0.440 Test Loss: 0.898 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 41.882063150405884
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.790 Vali Acc: 0.600 Test Loss: 0.790 Test Acc: 0.600
Validation loss decreased (-0.439991 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 43.51017117500305
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.46178650856018
Epoch: 4, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.652 Vali Acc: 0.510 Test Loss: 1.652 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 45.81805062294006
Epoch: 5, Steps: 18 | Train Loss: 0.855 Vali Loss: 2.980 Vali Acc: 0.500 Test Loss: 2.980 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 42.20018649101257
Epoch: 6, Steps: 18 | Train Loss: 0.902 Vali Loss: 1.625 Vali Acc: 0.510 Test Loss: 1.625 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 45.33429026603699
Epoch: 7, Steps: 18 | Train Loss: 0.603 Vali Loss: 1.400 Vali Acc: 0.500 Test Loss: 1.400 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.339380502700806
Epoch: 8, Steps: 18 | Train Loss: 0.359 Vali Loss: 1.656 Vali Acc: 0.450 Test Loss: 1.656 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 44.97499656677246
Epoch: 9, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.443 Vali Acc: 0.480 Test Loss: 1.443 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 40.955820083618164
Epoch: 10, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.693 Vali Acc: 0.600 Test Loss: 1.693 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 43.77016639709473
Epoch: 11, Steps: 18 | Train Loss: 0.202 Vali Loss: 2.600 Vali Acc: 0.500 Test Loss: 2.600 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 43.87304091453552
Epoch: 12, Steps: 18 | Train Loss: 0.296 Vali Loss: 3.699 Vali Acc: 0.520 Test Loss: 3.699 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4886466
model size : 19.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.252713203430176
Epoch: 1, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.741 Vali Acc: 0.600 Test Loss: 0.741 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 21.223796367645264
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.836 Vali Acc: 0.500 Test Loss: 0.836 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.311787605285645
Epoch: 3, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.865 Vali Acc: 0.610 Test Loss: 0.865 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609991).  Saving model ...
Epoch: 4 cost time: 21.405993700027466
Epoch: 4, Steps: 18 | Train Loss: 0.500 Vali Loss: 1.250 Vali Acc: 0.480 Test Loss: 1.250 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.292927980422974
Epoch: 5, Steps: 18 | Train Loss: 0.621 Vali Loss: 1.658 Vali Acc: 0.520 Test Loss: 1.658 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.435229778289795
Epoch: 6, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.686660051345825
Epoch: 7, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.700 Vali Acc: 0.460 Test Loss: 1.700 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.6520938873291
Epoch: 8, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 20.984906911849976
Epoch: 9, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.367 Vali Acc: 0.460 Test Loss: 1.367 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 20.722266912460327
Epoch: 10, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.247 Vali Acc: 0.570 Test Loss: 1.247 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 20.73236083984375
Epoch: 11, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.577 Vali Acc: 0.540 Test Loss: 1.577 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 20.663456201553345
Epoch: 12, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.535 Vali Acc: 0.570 Test Loss: 1.535 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.544376850128174
Epoch: 13, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.878 Vali Acc: 0.580 Test Loss: 1.878 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1576130
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 59.30023121833801
Epoch: 1, Steps: 18 | Train Loss: 0.805 Vali Loss: 0.844 Vali Acc: 0.530 Test Loss: 0.844 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 57.6857852935791
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 1.153 Vali Acc: 0.460 Test Loss: 1.153 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 53.43527054786682
Epoch: 3, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.927 Vali Acc: 0.500 Test Loss: 0.927 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 58.25608038902283
Epoch: 4, Steps: 18 | Train Loss: 0.517 Vali Loss: 1.040 Vali Acc: 0.610 Test Loss: 1.040 Test Acc: 0.610
Validation loss decreased (-0.529992 --> -0.609990).  Saving model ...
Epoch: 5 cost time: 57.17581582069397
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.799 Vali Acc: 0.590 Test Loss: 0.799 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 53.21538281440735
Epoch: 6, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.248 Vali Acc: 0.510 Test Loss: 1.248 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 57.34620475769043
Epoch: 7, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.108 Vali Acc: 0.490 Test Loss: 2.108 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 59.665242195129395
Epoch: 8, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 57.966429710388184
Epoch: 9, Steps: 18 | Train Loss: 0.374 Vali Loss: 1.145 Vali Acc: 0.520 Test Loss: 1.145 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 60.26159715652466
Epoch: 10, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.665 Vali Acc: 0.570 Test Loss: 1.665 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 57.84945869445801
Epoch: 11, Steps: 18 | Train Loss: 0.474 Vali Loss: 1.526 Vali Acc: 0.540 Test Loss: 1.526 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 56.93949031829834
Epoch: 12, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.726 Vali Acc: 0.560 Test Loss: 1.726 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 58.93304681777954
Epoch: 13, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.692 Vali Acc: 0.510 Test Loss: 1.692 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 56.32612872123718
Epoch: 14, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.976 Vali Acc: 0.510 Test Loss: 1.976 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2542786
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.78163504600525
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 28.102031230926514
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 1.275 Vali Acc: 0.490 Test Loss: 1.275 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.80732798576355
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.744 Vali Acc: 0.540 Test Loss: 0.744 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 24.84314465522766
Epoch: 4, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.987 Vali Acc: 0.490 Test Loss: 0.987 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.682842254638672
Epoch: 5, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.665 Vali Acc: 0.450 Test Loss: 1.665 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.680893898010254
Epoch: 6, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.63633418083191
Epoch: 7, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.625 Vali Acc: 0.530 Test Loss: 1.625 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.953726530075073
Epoch: 8, Steps: 18 | Train Loss: 0.366 Vali Loss: 3.890 Vali Acc: 0.480 Test Loss: 3.890 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 28.001935958862305
Epoch: 9, Steps: 18 | Train Loss: 0.310 Vali Loss: 2.528 Vali Acc: 0.530 Test Loss: 2.528 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 28.272773265838623
Epoch: 10, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.366 Vali Acc: 0.500 Test Loss: 1.366 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 28.96702790260315
Epoch: 11, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.030 Vali Acc: 0.520 Test Loss: 2.030 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.988370180130005
Epoch: 12, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.578 Vali Acc: 0.600 Test Loss: 1.578 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599984).  Saving model ...
Epoch: 13 cost time: 28.978688955307007
Epoch: 13, Steps: 18 | Train Loss: 0.161 Vali Loss: 3.323 Vali Acc: 0.490 Test Loss: 3.323 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 27.571754217147827
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 4.430 Vali Acc: 0.500 Test Loss: 4.430 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 27.413854598999023
Epoch: 15, Steps: 18 | Train Loss: 0.125 Vali Loss: 2.033 Vali Acc: 0.480 Test Loss: 2.033 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 28.276910305023193
Epoch: 16, Steps: 18 | Train Loss: 0.147 Vali Loss: 2.067 Vali Acc: 0.500 Test Loss: 2.067 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 28.6837158203125
Epoch: 17, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.685 Vali Acc: 0.540 Test Loss: 2.685 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 27.740827798843384
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.752 Vali Acc: 0.570 Test Loss: 1.752 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 27.800382614135742
Epoch: 19, Steps: 18 | Train Loss: 0.055 Vali Loss: 3.108 Vali Acc: 0.560 Test Loss: 3.108 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 27.883057117462158
Epoch: 20, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.210 Vali Acc: 0.550 Test Loss: 2.210 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 27.803871393203735
Epoch: 21, Steps: 18 | Train Loss: 0.101 Vali Loss: 3.538 Vali Acc: 0.560 Test Loss: 3.538 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 27.633079528808594
Epoch: 22, Steps: 18 | Train Loss: 0.175 Vali Loss: 5.411 Vali Acc: 0.510 Test Loss: 5.411 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 887490
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 48.333181381225586
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 45.74248647689819
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 1.154 Vali Acc: 0.460 Test Loss: 1.154 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 47.894822120666504
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 47.94162368774414
Epoch: 4, Steps: 18 | Train Loss: 0.527 Vali Loss: 1.076 Vali Acc: 0.620 Test Loss: 1.076 Test Acc: 0.620
Validation loss decreased (-0.529992 --> -0.619989).  Saving model ...
Epoch: 5 cost time: 47.2786819934845
Epoch: 5, Steps: 18 | Train Loss: 0.445 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 46.343281745910645
Epoch: 6, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 46.50804400444031
Epoch: 7, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 44.64513158798218
Epoch: 8, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.979 Vali Acc: 0.600 Test Loss: 1.979 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 32.771766901016235
Epoch: 9, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.617 Vali Acc: 0.600 Test Loss: 1.617 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 32.89064145088196
Epoch: 10, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.341 Vali Acc: 0.490 Test Loss: 1.341 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 48.247440814971924
Epoch: 11, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.585 Vali Acc: 0.490 Test Loss: 1.585 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 48.181278228759766
Epoch: 12, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.976 Vali Acc: 0.520 Test Loss: 2.976 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 48.44540023803711
Epoch: 13, Steps: 18 | Train Loss: 0.180 Vali Loss: 4.219 Vali Acc: 0.500 Test Loss: 4.219 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 46.76942014694214
Epoch: 14, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.881 Vali Acc: 0.530 Test Loss: 1.881 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2542786
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.790775775909424
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.918 Vali Acc: 0.530 Test Loss: 0.918 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 20.79712200164795
Epoch: 2, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.216 Vali Acc: 0.490 Test Loss: 1.216 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.793365955352783
Epoch: 3, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 15.814041137695312
Epoch: 4, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.069 Vali Acc: 0.510 Test Loss: 1.069 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.953774452209473
Epoch: 5, Steps: 18 | Train Loss: 0.359 Vali Loss: 1.327 Vali Acc: 0.460 Test Loss: 1.327 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.422502517700195
Epoch: 6, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.172 Vali Acc: 0.480 Test Loss: 1.172 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.385108709335327
Epoch: 7, Steps: 18 | Train Loss: 0.252 Vali Loss: 2.091 Vali Acc: 0.500 Test Loss: 2.091 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.42310380935669
Epoch: 8, Steps: 18 | Train Loss: 0.433 Vali Loss: 2.788 Vali Acc: 0.480 Test Loss: 2.788 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.56074070930481
Epoch: 9, Steps: 18 | Train Loss: 0.280 Vali Loss: 2.907 Vali Acc: 0.520 Test Loss: 2.907 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.58808946609497
Epoch: 10, Steps: 18 | Train Loss: 0.389 Vali Loss: 2.007 Vali Acc: 0.560 Test Loss: 2.007 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559980).  Saving model ...
Epoch: 11 cost time: 22.597618341445923
Epoch: 11, Steps: 18 | Train Loss: 0.249 Vali Loss: 2.427 Vali Acc: 0.520 Test Loss: 2.427 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.543944835662842
Epoch: 12, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.447 Vali Acc: 0.500 Test Loss: 2.447 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.733684301376343
Epoch: 13, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.771 Vali Acc: 0.530 Test Loss: 1.771 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 21.94361400604248
Epoch: 14, Steps: 18 | Train Loss: 0.140 Vali Loss: 2.130 Vali Acc: 0.490 Test Loss: 2.130 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.14425492286682
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.979 Vali Acc: 0.530 Test Loss: 1.979 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 21.210639238357544
Epoch: 16, Steps: 18 | Train Loss: 0.109 Vali Loss: 3.888 Vali Acc: 0.490 Test Loss: 3.888 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.845613956451416
Epoch: 17, Steps: 18 | Train Loss: 0.123 Vali Loss: 5.377 Vali Acc: 0.520 Test Loss: 5.377 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 21.259950399398804
Epoch: 18, Steps: 18 | Train Loss: 0.193 Vali Loss: 4.270 Vali Acc: 0.510 Test Loss: 4.270 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 22.256285429000854
Epoch: 19, Steps: 18 | Train Loss: 0.070 Vali Loss: 4.003 Vali Acc: 0.480 Test Loss: 4.003 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 22.27605390548706
Epoch: 20, Steps: 18 | Train Loss: 0.151 Vali Loss: 3.378 Vali Acc: 0.510 Test Loss: 3.378 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 887490
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.9448299407959
Epoch: 1, Steps: 18 | Train Loss: 0.805 Vali Loss: 0.847 Vali Acc: 0.550 Test Loss: 0.847 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 31.999335765838623
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.175 Vali Acc: 0.480 Test Loss: 1.175 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 32.4532253742218
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.880 Vali Acc: 0.530 Test Loss: 0.880 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 32.88858342170715
Epoch: 4, Steps: 18 | Train Loss: 0.546 Vali Loss: 1.094 Vali Acc: 0.630 Test Loss: 1.094 Test Acc: 0.630
Validation loss decreased (-0.549992 --> -0.629989).  Saving model ...
Epoch: 5 cost time: 32.092774391174316
Epoch: 5, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.775 Vali Acc: 0.540 Test Loss: 0.775 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.708837509155273
Epoch: 6, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.360769033432007
Epoch: 7, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.102 Vali Acc: 0.540 Test Loss: 1.102 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 31.053593635559082
Epoch: 8, Steps: 18 | Train Loss: 0.214 Vali Loss: 1.339 Vali Acc: 0.540 Test Loss: 1.339 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 30.678008317947388
Epoch: 9, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.662 Vali Acc: 0.530 Test Loss: 1.662 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 30.891539335250854
Epoch: 10, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.045 Vali Acc: 0.550 Test Loss: 2.045 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 30.828688621520996
Epoch: 11, Steps: 18 | Train Loss: 0.183 Vali Loss: 2.564 Vali Acc: 0.540 Test Loss: 2.564 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 34.161163091659546
Epoch: 12, Steps: 18 | Train Loss: 0.176 Vali Loss: 2.436 Vali Acc: 0.520 Test Loss: 2.436 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 34.16415095329285
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.753 Vali Acc: 0.540 Test Loss: 1.753 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 42.592724323272705
Epoch: 14, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.588 Vali Acc: 0.530 Test Loss: 1.588 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2542786
model size : 10.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.966864109039307
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.913 Vali Acc: 0.530 Test Loss: 0.913 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 20.014082193374634
Epoch: 2, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.216 Vali Acc: 0.490 Test Loss: 1.216 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.864032983779907
Epoch: 3, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 20.0611629486084
Epoch: 4, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.988 Vali Acc: 0.510 Test Loss: 0.988 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.077003479003906
Epoch: 5, Steps: 18 | Train Loss: 0.359 Vali Loss: 1.306 Vali Acc: 0.470 Test Loss: 1.306 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.942404985427856
Epoch: 6, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.190723180770874
Epoch: 7, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.782 Vali Acc: 0.510 Test Loss: 1.782 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.27740168571472
Epoch: 8, Steps: 18 | Train Loss: 0.514 Vali Loss: 1.722 Vali Acc: 0.500 Test Loss: 1.722 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 20.20158076286316
Epoch: 9, Steps: 18 | Train Loss: 0.247 Vali Loss: 2.429 Vali Acc: 0.510 Test Loss: 2.429 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 20.1146821975708
Epoch: 10, Steps: 18 | Train Loss: 0.546 Vali Loss: 1.619 Vali Acc: 0.500 Test Loss: 1.619 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 19.838109016418457
Epoch: 11, Steps: 18 | Train Loss: 0.175 Vali Loss: 2.115 Vali Acc: 0.540 Test Loss: 2.115 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.24390149116516
Epoch: 12, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.104 Vali Acc: 0.520 Test Loss: 2.104 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 18.982356548309326
Epoch: 13, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.920 Vali Acc: 0.520 Test Loss: 1.920 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 887490
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 76.91138768196106
Epoch: 1, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.835 Vali Acc: 0.470 Test Loss: 0.835 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 102.29888939857483
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.719 Vali Acc: 0.590 Test Loss: 0.719 Test Acc: 0.590
Validation loss decreased (-0.469992 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 99.88864517211914
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.941 Vali Acc: 0.520 Test Loss: 0.941 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 97.85450315475464
Epoch: 4, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 92.76954388618469
Epoch: 5, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 101.03249859809875
Epoch: 6, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.193 Vali Acc: 0.540 Test Loss: 1.193 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 97.87715411186218
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 99.85988402366638
Epoch: 8, Steps: 18 | Train Loss: 0.388 Vali Loss: 1.493 Vali Acc: 0.510 Test Loss: 1.493 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 100.25799322128296
Epoch: 9, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.904 Vali Acc: 0.550 Test Loss: 0.904 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 97.81180453300476
Epoch: 10, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.292 Vali Acc: 0.530 Test Loss: 1.292 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 98.61804413795471
Epoch: 11, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.585 Vali Acc: 0.490 Test Loss: 1.585 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 103.3204665184021
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.198 Vali Acc: 0.540 Test Loss: 2.198 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2444002
model size : 9.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 45.885963916778564
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.812 Vali Acc: 0.420 Test Loss: 0.812 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 41.496731758117676
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 1.075 Vali Acc: 0.440 Test Loss: 1.075 Test Acc: 0.440
Validation loss decreased (-0.419992 --> -0.439989).  Saving model ...
Epoch: 3 cost time: 42.86728525161743
Epoch: 3, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.759 Vali Acc: 0.560 Test Loss: 0.759 Test Acc: 0.560
Validation loss decreased (-0.439989 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 43.40666151046753
Epoch: 4, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 43.40407180786133
Epoch: 5, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.822 Vali Acc: 0.550 Test Loss: 0.822 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 45.082924365997314
Epoch: 6, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 44.9161114692688
Epoch: 7, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 45.23135757446289
Epoch: 8, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 44.821192502975464
Epoch: 9, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.542 Vali Acc: 0.490 Test Loss: 1.542 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 42.34067463874817
Epoch: 10, Steps: 18 | Train Loss: 0.235 Vali Loss: 2.086 Vali Acc: 0.500 Test Loss: 2.086 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 42.06527662277222
Epoch: 11, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 43.276445150375366
Epoch: 12, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.184 Vali Acc: 0.570 Test Loss: 1.184 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569988).  Saving model ...
Epoch: 13 cost time: 45.16285252571106
Epoch: 13, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.557 Vali Acc: 0.570 Test Loss: 1.557 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 45.18800640106201
Epoch: 14, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.185 Vali Acc: 0.510 Test Loss: 1.185 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 45.4743332862854
Epoch: 15, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.556 Vali Acc: 0.490 Test Loss: 1.556 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 45.86941838264465
Epoch: 16, Steps: 18 | Train Loss: 0.044 Vali Loss: 2.103 Vali Acc: 0.510 Test Loss: 2.103 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 45.10299825668335
Epoch: 17, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.553 Vali Acc: 0.540 Test Loss: 1.553 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 43.89035224914551
Epoch: 18, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.611 Vali Acc: 0.530 Test Loss: 1.611 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 43.85168409347534
Epoch: 19, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.998 Vali Acc: 0.490 Test Loss: 1.998 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 43.020976543426514
Epoch: 20, Steps: 18 | Train Loss: 0.125 Vali Loss: 2.408 Vali Acc: 0.550 Test Loss: 2.408 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 46.061211824417114
Epoch: 21, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.884 Vali Acc: 0.590 Test Loss: 1.884 Test Acc: 0.590
Validation loss decreased (-0.569988 --> -0.589981).  Saving model ...
Epoch: 22 cost time: 45.905370473861694
Epoch: 22, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.874 Vali Acc: 0.530 Test Loss: 1.874 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 46.003355741500854
Epoch: 23, Steps: 18 | Train Loss: 0.070 Vali Loss: 3.335 Vali Acc: 0.510 Test Loss: 3.335 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 45.4627423286438
Epoch: 24, Steps: 18 | Train Loss: 0.067 Vali Loss: 2.091 Vali Acc: 0.490 Test Loss: 2.091 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 43.60776710510254
Epoch: 25, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.982 Vali Acc: 0.440 Test Loss: 1.982 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 43.295870780944824
Epoch: 26, Steps: 18 | Train Loss: 0.078 Vali Loss: 2.639 Vali Acc: 0.510 Test Loss: 2.639 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 42.873085737228394
Epoch: 27, Steps: 18 | Train Loss: 0.130 Vali Loss: 2.965 Vali Acc: 0.450 Test Loss: 2.965 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 41.174320459365845
Epoch: 28, Steps: 18 | Train Loss: 0.075 Vali Loss: 2.174 Vali Acc: 0.540 Test Loss: 2.174 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 42.97428059577942
Epoch: 29, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.377 Vali Acc: 0.500 Test Loss: 2.377 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 44.58948063850403
Epoch: 30, Steps: 18 | Train Loss: 0.026 Vali Loss: 3.074 Vali Acc: 0.460 Test Loss: 3.074 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 788578
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 82.5476245880127
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.834 Vali Acc: 0.470 Test Loss: 0.834 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 76.18389248847961
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (-0.469992 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 73.01068043708801
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.947 Vali Acc: 0.520 Test Loss: 0.947 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 76.21482253074646
Epoch: 4, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 76.89408946037292
Epoch: 5, Steps: 18 | Train Loss: 0.436 Vali Loss: 1.232 Vali Acc: 0.520 Test Loss: 1.232 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 77.37832283973694
Epoch: 6, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 75.16995644569397
Epoch: 7, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 76.45980215072632
Epoch: 8, Steps: 18 | Train Loss: 0.361 Vali Loss: 2.267 Vali Acc: 0.490 Test Loss: 2.267 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 76.88178944587708
Epoch: 9, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.953 Vali Acc: 0.490 Test Loss: 0.953 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 74.3160707950592
Epoch: 10, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.073 Vali Acc: 0.500 Test Loss: 1.073 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 73.18762826919556
Epoch: 11, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.646 Vali Acc: 0.490 Test Loss: 1.646 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 73.50626516342163
Epoch: 12, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.527 Vali Acc: 0.560 Test Loss: 1.527 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2444002
model size : 9.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 38.33575749397278
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.812 Vali Acc: 0.420 Test Loss: 0.812 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 36.063875675201416
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 1.076 Vali Acc: 0.440 Test Loss: 1.076 Test Acc: 0.440
Validation loss decreased (-0.419992 --> -0.439989).  Saving model ...
Epoch: 3 cost time: 34.80880641937256
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.759 Vali Acc: 0.560 Test Loss: 0.759 Test Acc: 0.560
Validation loss decreased (-0.439989 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 33.69134521484375
Epoch: 4, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.882166385650635
Epoch: 5, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 34.82236337661743
Epoch: 6, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.033 Vali Acc: 0.500 Test Loss: 1.033 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 34.7161705493927
Epoch: 7, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.372 Vali Acc: 0.520 Test Loss: 1.372 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 35.35999584197998
Epoch: 8, Steps: 18 | Train Loss: 0.269 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 36.4358766078949
Epoch: 9, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.325 Vali Acc: 0.420 Test Loss: 1.325 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 36.4692063331604
Epoch: 10, Steps: 18 | Train Loss: 0.290 Vali Loss: 2.273 Vali Acc: 0.490 Test Loss: 2.273 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 36.48834729194641
Epoch: 11, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.473 Vali Acc: 0.460 Test Loss: 1.473 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 36.844377756118774
Epoch: 12, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.231 Vali Acc: 0.570 Test Loss: 1.231 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569988).  Saving model ...
Epoch: 13 cost time: 36.13091683387756
Epoch: 13, Steps: 18 | Train Loss: 0.176 Vali Loss: 1.879 Vali Acc: 0.540 Test Loss: 1.879 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 33.46292304992676
Epoch: 14, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.681 Vali Acc: 0.520 Test Loss: 1.681 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 33.57506203651428
Epoch: 15, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.614 Vali Acc: 0.500 Test Loss: 1.614 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 35.32327461242676
Epoch: 16, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.330 Vali Acc: 0.580 Test Loss: 1.330 Test Acc: 0.580
Validation loss decreased (-0.569988 --> -0.579987).  Saving model ...
Epoch: 17 cost time: 34.47943472862244
Epoch: 17, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.489 Vali Acc: 0.560 Test Loss: 1.489 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 35.94253087043762
Epoch: 18, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.444 Vali Acc: 0.570 Test Loss: 1.444 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 36.05744171142578
Epoch: 19, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.912 Vali Acc: 0.500 Test Loss: 1.912 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 35.768858909606934
Epoch: 20, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.122 Vali Acc: 0.500 Test Loss: 2.122 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 35.774683713912964
Epoch: 21, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.729 Vali Acc: 0.520 Test Loss: 1.729 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 35.97962951660156
Epoch: 22, Steps: 18 | Train Loss: 0.012 Vali Loss: 1.974 Vali Acc: 0.580 Test Loss: 1.974 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 34.67073345184326
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 2.068 Vali Acc: 0.490 Test Loss: 2.068 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 33.37232303619385
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 2.081 Vali Acc: 0.510 Test Loss: 2.081 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 32.581432819366455
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 2.077 Vali Acc: 0.490 Test Loss: 2.077 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 32.98526978492737
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 2.057 Vali Acc: 0.480 Test Loss: 2.057 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 788578
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 51.44136834144592
Epoch: 1, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.834 Vali Acc: 0.470 Test Loss: 0.834 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 50.17379379272461
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.722 Vali Acc: 0.570 Test Loss: 0.722 Test Acc: 0.570
Validation loss decreased (-0.469992 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 50.28667402267456
Epoch: 3, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.950 Vali Acc: 0.520 Test Loss: 0.950 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 49.026705503463745
Epoch: 4, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 47.27272629737854
Epoch: 5, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 45.155346632003784
Epoch: 6, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 44.103224754333496
Epoch: 7, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.195 Vali Acc: 0.540 Test Loss: 1.195 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 45.26695442199707
Epoch: 8, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.659 Vali Acc: 0.490 Test Loss: 1.659 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 43.33157682418823
Epoch: 9, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.914 Vali Acc: 0.520 Test Loss: 0.914 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 48.771040201187134
Epoch: 10, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 46.13792061805725
Epoch: 11, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.975 Vali Acc: 0.510 Test Loss: 1.975 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 46.95560097694397
Epoch: 12, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.269 Vali Acc: 0.530 Test Loss: 1.269 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2444002
model size : 9.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.181830883026123
Epoch: 1, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.813 Vali Acc: 0.410 Test Loss: 0.813 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 21.868622303009033
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.065 Vali Acc: 0.440 Test Loss: 1.065 Test Acc: 0.440
Validation loss decreased (-0.409992 --> -0.439989).  Saving model ...
Epoch: 3 cost time: 19.43365240097046
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
Validation loss decreased (-0.439989 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 20.172248363494873
Epoch: 4, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.898 Vali Acc: 0.510 Test Loss: 0.898 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.827539205551147
Epoch: 5, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.725284814834595
Epoch: 6, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.991 Vali Acc: 0.490 Test Loss: 0.991 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.107651710510254
Epoch: 7, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.999065160751343
Epoch: 8, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.88439631462097
Epoch: 9, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.495 Vali Acc: 0.450 Test Loss: 1.495 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.687781810760498
Epoch: 10, Steps: 18 | Train Loss: 0.311 Vali Loss: 2.423 Vali Acc: 0.480 Test Loss: 2.423 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.35511875152588
Epoch: 11, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.657 Vali Acc: 0.480 Test Loss: 1.657 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.187535047531128
Epoch: 12, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579989).  Saving model ...
Epoch: 13 cost time: 23.63913607597351
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.755 Vali Acc: 0.530 Test Loss: 1.755 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.10172438621521
Epoch: 14, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.520 Vali Acc: 0.550 Test Loss: 1.520 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.47813129425049
Epoch: 15, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.971 Vali Acc: 0.520 Test Loss: 1.971 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 20.647191762924194
Epoch: 16, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.513 Vali Acc: 0.540 Test Loss: 1.513 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 20.597461223602295
Epoch: 17, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.590080738067627
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.548 Vali Acc: 0.510 Test Loss: 1.548 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.085604667663574
Epoch: 19, Steps: 18 | Train Loss: 0.015 Vali Loss: 1.742 Vali Acc: 0.470 Test Loss: 1.742 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 21.89978265762329
Epoch: 20, Steps: 18 | Train Loss: 0.075 Vali Loss: 3.134 Vali Acc: 0.540 Test Loss: 3.134 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.315492868423462
Epoch: 21, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.349 Vali Acc: 0.450 Test Loss: 2.349 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 23.09263277053833
Epoch: 22, Steps: 18 | Train Loss: 0.015 Vali Loss: 2.380 Vali Acc: 0.450 Test Loss: 2.380 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 788578
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 65.74823307991028
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 62.89272880554199
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.881 Vali Acc: 0.550 Test Loss: 0.881 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 59.35331058502197
Epoch: 3, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.944 Vali Acc: 0.510 Test Loss: 0.944 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 61.64920139312744
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 61.28977918624878
Epoch: 5, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 63.85417127609253
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.820 Vali Acc: 0.600 Test Loss: 0.820 Test Acc: 0.600
Validation loss decreased (-0.549991 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 59.18810200691223
Epoch: 7, Steps: 18 | Train Loss: 0.463 Vali Loss: 1.538 Vali Acc: 0.540 Test Loss: 1.538 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 58.520217180252075
Epoch: 8, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.006 Vali Acc: 0.510 Test Loss: 1.006 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 60.69251203536987
Epoch: 9, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.110 Vali Acc: 0.530 Test Loss: 1.110 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 60.901750802993774
Epoch: 10, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 64.41673612594604
Epoch: 11, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.025 Vali Acc: 0.530 Test Loss: 1.025 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 64.1870744228363
Epoch: 12, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.661 Vali Acc: 0.530 Test Loss: 1.661 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 59.62952661514282
Epoch: 13, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 61.6102397441864
Epoch: 14, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.882 Vali Acc: 0.440 Test Loss: 1.882 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 60.64934515953064
Epoch: 15, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.973 Vali Acc: 0.560 Test Loss: 1.973 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 63.77899694442749
Epoch: 16, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.335 Vali Acc: 0.510 Test Loss: 2.335 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1271778
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.689999103546143
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.684 Vali Acc: 0.630 Test Loss: 0.684 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 25.811254739761353
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.89855647087097
Epoch: 3, Steps: 18 | Train Loss: 0.737 Vali Loss: 1.025 Vali Acc: 0.490 Test Loss: 1.025 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.332593202590942
Epoch: 4, Steps: 18 | Train Loss: 0.668 Vali Loss: 1.106 Vali Acc: 0.540 Test Loss: 1.106 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 27.637816667556763
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.734 Vali Acc: 0.570 Test Loss: 0.734 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 27.149102687835693
Epoch: 6, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 27.065590143203735
Epoch: 7, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 29.261816024780273
Epoch: 8, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.031 Vali Acc: 0.580 Test Loss: 1.031 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 29.253414392471313
Epoch: 9, Steps: 18 | Train Loss: 0.219 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 28.81835913658142
Epoch: 10, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.625 Vali Acc: 0.530 Test Loss: 1.625 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 29.151390075683594
Epoch: 11, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.536 Vali Acc: 0.540 Test Loss: 1.536 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 444002
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 45.194411516189575
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 47.98801064491272
Epoch: 2, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.880 Vali Acc: 0.560 Test Loss: 0.880 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559991).  Saving model ...
Epoch: 3 cost time: 41.52406668663025
Epoch: 3, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.950 Vali Acc: 0.510 Test Loss: 0.950 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 48.25934457778931
Epoch: 4, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.890 Vali Acc: 0.510 Test Loss: 0.890 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 51.14030385017395
Epoch: 5, Steps: 18 | Train Loss: 0.441 Vali Loss: 0.730 Vali Acc: 0.490 Test Loss: 0.730 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 50.89101481437683
Epoch: 6, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.825 Vali Acc: 0.590 Test Loss: 0.825 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 47.39178776741028
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.505 Vali Acc: 0.550 Test Loss: 1.505 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 48.74578309059143
Epoch: 8, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.070 Vali Acc: 0.490 Test Loss: 1.070 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 47.60070061683655
Epoch: 9, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 42.35061049461365
Epoch: 10, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.090 Vali Acc: 0.590 Test Loss: 1.090 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 46.25508666038513
Epoch: 11, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 50.3194899559021
Epoch: 12, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.256 Vali Acc: 0.470 Test Loss: 1.256 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 47.55900025367737
Epoch: 13, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 49.626500606536865
Epoch: 14, Steps: 18 | Train Loss: 0.063 Vali Loss: 1.781 Vali Acc: 0.480 Test Loss: 1.781 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 48.05295944213867
Epoch: 15, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.716 Vali Acc: 0.490 Test Loss: 2.716 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 46.12488555908203
Epoch: 16, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.497 Vali Acc: 0.510 Test Loss: 1.497 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1271778
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.25844955444336
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.684 Vali Acc: 0.630 Test Loss: 0.684 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 24.020749807357788
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.815783262252808
Epoch: 3, Steps: 18 | Train Loss: 0.738 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.315746068954468
Epoch: 4, Steps: 18 | Train Loss: 0.669 Vali Loss: 1.118 Vali Acc: 0.540 Test Loss: 1.118 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.461491584777832
Epoch: 5, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.734 Vali Acc: 0.560 Test Loss: 0.734 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.72566533088684
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 24.007365942001343
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 23.793646335601807
Epoch: 8, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.982 Vali Acc: 0.570 Test Loss: 0.982 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 22.58354902267456
Epoch: 9, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.924 Vali Acc: 0.560 Test Loss: 0.924 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 23.067521572113037
Epoch: 10, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.609 Vali Acc: 0.540 Test Loss: 1.609 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 22.162103414535522
Epoch: 11, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.360 Vali Acc: 0.550 Test Loss: 1.360 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 444002
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.00799894332886
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 31.833815097808838
Epoch: 2, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559991).  Saving model ...
Epoch: 3 cost time: 32.04135513305664
Epoch: 3, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.526264667510986
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.907 Vali Acc: 0.490 Test Loss: 0.907 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 29.566373348236084
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.733 Vali Acc: 0.470 Test Loss: 0.733 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 31.663790225982666
Epoch: 6, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.842 Vali Acc: 0.580 Test Loss: 0.842 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 32.06927728652954
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.726 Vali Acc: 0.540 Test Loss: 1.726 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.225606441497803
Epoch: 8, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.053 Vali Acc: 0.520 Test Loss: 1.053 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 28.85178852081299
Epoch: 9, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.730148792266846
Epoch: 10, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.094 Vali Acc: 0.540 Test Loss: 1.094 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 30.00458526611328
Epoch: 11, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 30.98042058944702
Epoch: 12, Steps: 18 | Train Loss: 0.211 Vali Loss: 2.050 Vali Acc: 0.490 Test Loss: 2.050 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 31.468796968460083
Epoch: 13, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 29.507972478866577
Epoch: 14, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.480 Vali Acc: 0.530 Test Loss: 1.480 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 28.69611096382141
Epoch: 15, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.478 Vali Acc: 0.510 Test Loss: 1.478 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 31.809747219085693
Epoch: 16, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.717 Vali Acc: 0.530 Test Loss: 2.717 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1271778
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.391345024108887
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.686 Vali Acc: 0.640 Test Loss: 0.686 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 15.440796136856079
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.298644781112671
Epoch: 3, Steps: 18 | Train Loss: 0.739 Vali Loss: 1.034 Vali Acc: 0.490 Test Loss: 1.034 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 14.12621784210205
Epoch: 4, Steps: 18 | Train Loss: 0.673 Vali Loss: 1.108 Vali Acc: 0.540 Test Loss: 1.108 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.803894758224487
Epoch: 5, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.448836088180542
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.808 Vali Acc: 0.570 Test Loss: 0.808 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.25113821029663
Epoch: 7, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.822 Vali Acc: 0.540 Test Loss: 0.822 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.199734687805176
Epoch: 8, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.893 Vali Acc: 0.570 Test Loss: 0.893 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.029735326766968
Epoch: 9, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.895 Vali Acc: 0.540 Test Loss: 0.895 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.064539909362793
Epoch: 10, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.792 Vali Acc: 0.530 Test Loss: 1.792 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 16.215474843978882
Epoch: 11, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.050 Vali Acc: 0.550 Test Loss: 1.050 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 444002
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 49.93212389945984
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.907 Vali Acc: 0.480 Test Loss: 0.907 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 48.991710901260376
Epoch: 2, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.132 Vali Acc: 0.490 Test Loss: 1.132 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 49.36929798126221
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.715 Vali Acc: 0.590 Test Loss: 0.715 Test Acc: 0.590
Validation loss decreased (-0.489989 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 46.65235781669617
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.22117233276367
Epoch: 5, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 47.80867576599121
Epoch: 6, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.889 Vali Acc: 0.570 Test Loss: 0.889 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 49.40157723426819
Epoch: 7, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 45.72396111488342
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 48.73272514343262
Epoch: 9, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.899 Vali Acc: 0.560 Test Loss: 0.899 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 47.20928192138672
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.324 Vali Acc: 0.470 Test Loss: 1.324 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 44.113436698913574
Epoch: 11, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.454 Vali Acc: 0.460 Test Loss: 1.454 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 46.37503123283386
Epoch: 12, Steps: 18 | Train Loss: 0.219 Vali Loss: 0.975 Vali Acc: 0.500 Test Loss: 0.975 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 46.649221658706665
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.113 Vali Acc: 0.510 Test Loss: 1.113 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 685666
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.445016860961914
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 21.18750309944153
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.784 Vali Acc: 0.600 Test Loss: 0.784 Test Acc: 0.600
Validation loss decreased (-0.499993 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 19.163424491882324
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.648 Vali Acc: 0.620 Test Loss: 0.648 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619994).  Saving model ...
Epoch: 4 cost time: 23.590952157974243
Epoch: 4, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.706846714019775
Epoch: 5, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.868 Vali Acc: 0.540 Test Loss: 0.868 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.766789436340332
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.071686029434204
Epoch: 7, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.828 Vali Acc: 0.520 Test Loss: 0.828 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.653306484222412
Epoch: 8, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.837 Vali Acc: 0.570 Test Loss: 0.837 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.749021291732788
Epoch: 9, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.389 Vali Acc: 0.530 Test Loss: 1.389 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.27342414855957
Epoch: 10, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.025 Vali Acc: 0.510 Test Loss: 1.025 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.413472652435303
Epoch: 11, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.922 Vali Acc: 0.560 Test Loss: 0.922 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.65154218673706
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.637 Vali Acc: 0.500 Test Loss: 1.637 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.658968210220337
Epoch: 13, Steps: 18 | Train Loss: 0.082 Vali Loss: 1.139 Vali Acc: 0.590 Test Loss: 1.139 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 271714
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 41.54925751686096
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.907 Vali Acc: 0.480 Test Loss: 0.907 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 38.925052881240845
Epoch: 2, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.135 Vali Acc: 0.490 Test Loss: 1.135 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 37.37579536437988
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.714 Vali Acc: 0.590 Test Loss: 0.714 Test Acc: 0.590
Validation loss decreased (-0.489989 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 35.2046434879303
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.43124580383301
Epoch: 5, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.82780122756958
Epoch: 6, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.875 Vali Acc: 0.570 Test Loss: 0.875 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 39.14177060127258
Epoch: 7, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.840 Vali Acc: 0.490 Test Loss: 0.840 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 39.318257570266724
Epoch: 8, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.967 Vali Acc: 0.510 Test Loss: 0.967 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 39.19950842857361
Epoch: 9, Steps: 18 | Train Loss: 0.285 Vali Loss: 0.907 Vali Acc: 0.570 Test Loss: 0.907 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 36.181885957717896
Epoch: 10, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.449 Vali Acc: 0.430 Test Loss: 1.449 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 34.95605230331421
Epoch: 11, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.605 Vali Acc: 0.450 Test Loss: 1.605 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 36.89247012138367
Epoch: 12, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.115 Vali Acc: 0.520 Test Loss: 1.115 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 36.96386122703552
Epoch: 13, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.439 Vali Acc: 0.520 Test Loss: 1.439 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 685666
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.219950199127197
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 18.815444707870483
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.786 Vali Acc: 0.590 Test Loss: 0.786 Test Acc: 0.590
Validation loss decreased (-0.499993 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 18.095504760742188
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.661 Vali Acc: 0.580 Test Loss: 0.661 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.6924831867218
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.947686910629272
Epoch: 5, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 18.856572151184082
Epoch: 6, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.119 Vali Acc: 0.530 Test Loss: 1.119 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.65062141418457
Epoch: 7, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.702 Vali Acc: 0.610 Test Loss: 0.702 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609993).  Saving model ...
Epoch: 8 cost time: 17.667152881622314
Epoch: 8, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.801 Vali Acc: 0.600 Test Loss: 0.801 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.799543380737305
Epoch: 9, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.579 Vali Acc: 0.520 Test Loss: 1.579 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.554335594177246
Epoch: 10, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.689 Vali Acc: 0.540 Test Loss: 1.689 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.710418462753296
Epoch: 11, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.919 Vali Acc: 0.630 Test Loss: 0.919 Test Acc: 0.630
Validation loss decreased (-0.609993 --> -0.629991).  Saving model ...
Epoch: 12 cost time: 17.703113794326782
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.435 Vali Acc: 0.520 Test Loss: 1.435 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.275181531906128
Epoch: 13, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.101 Vali Acc: 0.580 Test Loss: 1.101 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.391786813735962
Epoch: 14, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.992 Vali Acc: 0.580 Test Loss: 1.992 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.80950140953064
Epoch: 15, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.990 Vali Acc: 0.530 Test Loss: 1.990 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 15.604393482208252
Epoch: 16, Steps: 18 | Train Loss: 0.139 Vali Loss: 3.556 Vali Acc: 0.510 Test Loss: 3.556 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 18.284260272979736
Epoch: 17, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.510 Vali Acc: 0.580 Test Loss: 1.510 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.393442392349243
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.588 Vali Acc: 0.580 Test Loss: 1.588 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 18.584731340408325
Epoch: 19, Steps: 18 | Train Loss: 0.036 Vali Loss: 2.841 Vali Acc: 0.590 Test Loss: 2.841 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.648901224136353
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.467 Vali Acc: 0.570 Test Loss: 2.467 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 17.41380262374878
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.908 Vali Acc: 0.560 Test Loss: 1.908 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 271714
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.2646746635437
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.909 Vali Acc: 0.480 Test Loss: 0.909 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 24.210189819335938
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.141 Vali Acc: 0.490 Test Loss: 1.141 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 22.54826068878174
Epoch: 3, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.717 Vali Acc: 0.590 Test Loss: 0.717 Test Acc: 0.590
Validation loss decreased (-0.489989 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 24.119039058685303
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.529228448867798
Epoch: 5, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.758 Vali Acc: 0.610 Test Loss: 0.758 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 26.00859808921814
Epoch: 6, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.910 Vali Acc: 0.590 Test Loss: 0.910 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.09844446182251
Epoch: 7, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.199482679367065
Epoch: 8, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.018 Vali Acc: 0.510 Test Loss: 1.018 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.515543460845947
Epoch: 9, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.896 Vali Acc: 0.560 Test Loss: 0.896 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.626364707946777
Epoch: 10, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.234 Vali Acc: 0.510 Test Loss: 1.234 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.081185579299927
Epoch: 11, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.381 Vali Acc: 0.510 Test Loss: 1.381 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 23.39287042617798
Epoch: 12, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.082 Vali Acc: 0.550 Test Loss: 1.082 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.9120934009552
Epoch: 13, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 26.56542134284973
Epoch: 14, Steps: 18 | Train Loss: 0.082 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 26.3792941570282
Epoch: 15, Steps: 18 | Train Loss: 0.071 Vali Loss: 2.057 Vali Acc: 0.480 Test Loss: 2.057 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 685666
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.56751275062561
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 12.937760353088379
Epoch: 2, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.792 Vali Acc: 0.580 Test Loss: 0.792 Test Acc: 0.580
Validation loss decreased (-0.499993 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 13.594395875930786
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.666 Vali Acc: 0.580 Test Loss: 0.666 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 13.466646194458008
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.54739499092102
Epoch: 5, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.963812112808228
Epoch: 6, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.134 Vali Acc: 0.530 Test Loss: 1.134 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.118393659591675
Epoch: 7, Steps: 18 | Train Loss: 0.332 Vali Loss: 0.692 Vali Acc: 0.650 Test Loss: 0.692 Test Acc: 0.650
Validation loss decreased (-0.579993 --> -0.649993).  Saving model ...
Epoch: 8 cost time: 11.398219108581543
Epoch: 8, Steps: 18 | Train Loss: 0.305 Vali Loss: 0.841 Vali Acc: 0.600 Test Loss: 0.841 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.855142831802368
Epoch: 9, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.664 Vali Acc: 0.510 Test Loss: 1.664 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.850778579711914
Epoch: 10, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.865 Vali Acc: 0.540 Test Loss: 1.865 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.68784236907959
Epoch: 11, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.488 Vali Acc: 0.540 Test Loss: 1.488 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.660084009170532
Epoch: 12, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.437 Vali Acc: 0.560 Test Loss: 1.437 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.863248586654663
Epoch: 13, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.085 Vali Acc: 0.590 Test Loss: 1.085 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.045437812805176
Epoch: 14, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.262 Vali Acc: 0.540 Test Loss: 1.262 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.365368366241455
Epoch: 15, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.164 Vali Acc: 0.610 Test Loss: 2.164 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.26984715461731
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.597 Vali Acc: 0.540 Test Loss: 1.597 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.52905797958374
Epoch: 17, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.268 Vali Acc: 0.550 Test Loss: 2.268 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 271714
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 70.44631242752075
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 68.31471991539001
Epoch: 2, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.700 Vali Acc: 0.610 Test Loss: 0.700 Test Acc: 0.610
Validation loss decreased (-0.469993 --> -0.609993).  Saving model ...
Epoch: 3 cost time: 64.72702121734619
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 71.87221074104309
Epoch: 4, Steps: 18 | Train Loss: 0.528 Vali Loss: 0.716 Vali Acc: 0.510 Test Loss: 0.716 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 70.88599419593811
Epoch: 5, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 70.63563561439514
Epoch: 6, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.974 Vali Acc: 0.520 Test Loss: 0.974 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 68.76234459877014
Epoch: 7, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 67.44012188911438
Epoch: 8, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 74.16987323760986
Epoch: 9, Steps: 18 | Train Loss: 0.331 Vali Loss: 0.933 Vali Acc: 0.570 Test Loss: 0.933 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 72.50201368331909
Epoch: 10, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.984 Vali Acc: 0.490 Test Loss: 0.984 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 67.9305636882782
Epoch: 11, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.673 Vali Acc: 0.460 Test Loss: 1.673 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 68.05221676826477
Epoch: 12, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.241 Vali Acc: 0.470 Test Loss: 1.241 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1222770
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 34.74649119377136
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.732 Vali Acc: 0.440 Test Loss: 0.732 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 32.483264446258545
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
Validation loss decreased (-0.439993 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 32.352948904037476
Epoch: 3, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.743579387664795
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 1.008 Vali Acc: 0.470 Test Loss: 1.008 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.71514391899109
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.319912672042847
Epoch: 6, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.810 Vali Acc: 0.610 Test Loss: 0.810 Test Acc: 0.610
Validation loss decreased (-0.529991 --> -0.609992).  Saving model ...
Epoch: 7 cost time: 29.81419825553894
Epoch: 7, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.756 Vali Acc: 0.590 Test Loss: 0.756 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.669625759124756
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.958 Vali Acc: 0.490 Test Loss: 0.958 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 32.04845452308655
Epoch: 9, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.889 Vali Acc: 0.510 Test Loss: 0.889 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.548796892166138
Epoch: 10, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.147 Vali Acc: 0.480 Test Loss: 1.147 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 31.736600399017334
Epoch: 11, Steps: 18 | Train Loss: 0.214 Vali Loss: 1.298 Vali Acc: 0.480 Test Loss: 1.298 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 29.588520288467407
Epoch: 12, Steps: 18 | Train Loss: 0.192 Vali Loss: 0.954 Vali Acc: 0.510 Test Loss: 0.954 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 28.352647066116333
Epoch: 13, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 30.258002281188965
Epoch: 14, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.006 Vali Acc: 0.510 Test Loss: 1.006 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 29.855268239974976
Epoch: 15, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.455 Vali Acc: 0.470 Test Loss: 1.455 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 29.96255373954773
Epoch: 16, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.326 Vali Acc: 0.490 Test Loss: 1.326 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 394802
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 61.38104248046875
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 54.79352641105652
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.702 Vali Acc: 0.620 Test Loss: 0.702 Test Acc: 0.620
Validation loss decreased (-0.479993 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 57.20641469955444
Epoch: 3, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.709 Vali Acc: 0.510 Test Loss: 0.709 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 55.33677387237549
Epoch: 4, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 54.96775794029236
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 54.2328736782074
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.943 Vali Acc: 0.530 Test Loss: 0.943 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 56.202237129211426
Epoch: 7, Steps: 18 | Train Loss: 0.368 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 57.20060062408447
Epoch: 8, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 52.63083744049072
Epoch: 9, Steps: 18 | Train Loss: 0.293 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 50.21680974960327
Epoch: 10, Steps: 18 | Train Loss: 0.297 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 52.009528160095215
Epoch: 11, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.185 Vali Acc: 0.460 Test Loss: 1.185 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 56.81651735305786
Epoch: 12, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.990 Vali Acc: 0.460 Test Loss: 0.990 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1222770
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.010387897491455
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.735 Vali Acc: 0.440 Test Loss: 0.735 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 26.769860982894897
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
Validation loss decreased (-0.439993 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 24.066150903701782
Epoch: 3, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.792 Vali Acc: 0.480 Test Loss: 0.792 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.312431812286377
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 1.027 Vali Acc: 0.470 Test Loss: 1.027 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.960659980773926
Epoch: 5, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.911 Vali Acc: 0.510 Test Loss: 0.911 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509991).  Saving model ...
Epoch: 6 cost time: 23.670507669448853
Epoch: 6, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.830 Vali Acc: 0.600 Test Loss: 0.830 Test Acc: 0.600
Validation loss decreased (-0.509991 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 22.93935775756836
Epoch: 7, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.78368639945984
Epoch: 8, Steps: 18 | Train Loss: 0.358 Vali Loss: 0.964 Vali Acc: 0.440 Test Loss: 0.964 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.02025580406189
Epoch: 9, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.909 Vali Acc: 0.490 Test Loss: 0.909 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.13615846633911
Epoch: 10, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.955 Vali Acc: 0.490 Test Loss: 0.955 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 24.561969757080078
Epoch: 11, Steps: 18 | Train Loss: 0.176 Vali Loss: 1.333 Vali Acc: 0.480 Test Loss: 1.333 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.059823513031006
Epoch: 12, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.080 Vali Acc: 0.510 Test Loss: 1.080 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.614619970321655
Epoch: 13, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.816599130630493
Epoch: 14, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.959 Vali Acc: 0.540 Test Loss: 0.959 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 22.556777000427246
Epoch: 15, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.412 Vali Acc: 0.510 Test Loss: 1.412 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.579072952270508
Epoch: 16, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.365 Vali Acc: 0.490 Test Loss: 1.365 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 394802
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.564547538757324
Epoch: 1, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 36.19008231163025
Epoch: 2, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.703 Vali Acc: 0.620 Test Loss: 0.703 Test Acc: 0.620
Validation loss decreased (-0.479993 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 36.129334926605225
Epoch: 3, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.710 Vali Acc: 0.510 Test Loss: 0.710 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.66252088546753
Epoch: 4, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.29286575317383
Epoch: 5, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 35.27757716178894
Epoch: 6, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.973 Vali Acc: 0.520 Test Loss: 0.973 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 34.261964559555054
Epoch: 7, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 34.28112196922302
Epoch: 8, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 34.0404691696167
Epoch: 9, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 34.32693028450012
Epoch: 10, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 31.09693169593811
Epoch: 11, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.447 Vali Acc: 0.460 Test Loss: 1.447 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 36.608827114105225
Epoch: 12, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.182 Vali Acc: 0.480 Test Loss: 1.182 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1222770
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.425142288208008
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.733 Vali Acc: 0.430 Test Loss: 0.733 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 18.16770887374878
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.867 Vali Acc: 0.520 Test Loss: 0.867 Test Acc: 0.520
Validation loss decreased (-0.429993 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 18.23149561882019
Epoch: 3, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.155333042144775
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 1.025 Vali Acc: 0.470 Test Loss: 1.025 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.215919256210327
Epoch: 5, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.945894241333008
Epoch: 6, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.777 Vali Acc: 0.630 Test Loss: 0.777 Test Acc: 0.630
Validation loss decreased (-0.519991 --> -0.629992).  Saving model ...
Epoch: 7 cost time: 16.08498740196228
Epoch: 7, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.734 Vali Acc: 0.600 Test Loss: 0.734 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.808811902999878
Epoch: 8, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.83796763420105
Epoch: 9, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.034566164016724
Epoch: 10, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.008 Vali Acc: 0.510 Test Loss: 1.008 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 17.060917139053345
Epoch: 11, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.095909118652344
Epoch: 12, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.820 Vali Acc: 0.570 Test Loss: 0.820 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 17.999900102615356
Epoch: 13, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.906 Vali Acc: 0.540 Test Loss: 0.906 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.273559093475342
Epoch: 14, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.913 Vali Acc: 0.520 Test Loss: 0.913 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.053255319595337
Epoch: 15, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 18.270352125167847
Epoch: 16, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.243 Vali Acc: 0.520 Test Loss: 1.243 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 394802
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 47.94577598571777
Epoch: 1, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 41.75809097290039
Epoch: 2, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.706 Vali Acc: 0.540 Test Loss: 0.706 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 43.42540979385376
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.666 Vali Acc: 0.630 Test Loss: 0.666 Test Acc: 0.630
Validation loss decreased (-0.539993 --> -0.629993).  Saving model ...
Epoch: 4 cost time: 43.191774129867554
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.695 Vali Acc: 0.600 Test Loss: 0.695 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 45.889281034469604
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.659 Vali Acc: 0.650 Test Loss: 0.659 Test Acc: 0.650
Validation loss decreased (-0.629993 --> -0.649993).  Saving model ...
Epoch: 6 cost time: 45.135863304138184
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.555410623550415
Epoch: 7, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 43.51528263092041
Epoch: 8, Steps: 18 | Train Loss: 0.316 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 43.091598987579346
Epoch: 9, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.815 Vali Acc: 0.530 Test Loss: 0.815 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 35.272052526474
Epoch: 10, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.909 Vali Acc: 0.520 Test Loss: 0.909 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 42.76005148887634
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.200 Vali Acc: 0.530 Test Loss: 1.200 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 43.162769079208374
Epoch: 12, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.984 Vali Acc: 0.590 Test Loss: 0.984 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 45.70926284790039
Epoch: 13, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.366 Vali Acc: 0.510 Test Loss: 1.366 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 46.9639835357666
Epoch: 14, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.170 Vali Acc: 0.480 Test Loss: 1.170 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 44.97546696662903
Epoch: 15, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.205 Vali Acc: 0.600 Test Loss: 1.205 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 636274
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.893725633621216
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.792 Vali Acc: 0.470 Test Loss: 0.792 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 19.577266931533813
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 18.89982509613037
Epoch: 3, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.96240782737732
Epoch: 4, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 21.718457221984863
Epoch: 5, Steps: 18 | Train Loss: 0.536 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.743934392929077
Epoch: 6, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.682 Vali Acc: 0.580 Test Loss: 0.682 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 21.436334371566772
Epoch: 7, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.076 Vali Acc: 0.540 Test Loss: 1.076 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.599966764450073
Epoch: 8, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.878 Vali Acc: 0.490 Test Loss: 0.878 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.748726844787598
Epoch: 9, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.974 Vali Acc: 0.580 Test Loss: 0.974 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.84441351890564
Epoch: 10, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.921 Vali Acc: 0.500 Test Loss: 0.921 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.202536582946777
Epoch: 11, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.135 Vali Acc: 0.530 Test Loss: 1.135 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 19.90210199356079
Epoch: 12, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.055 Vali Acc: 0.510 Test Loss: 1.055 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 18.012871503829956
Epoch: 13, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.154 Vali Acc: 0.560 Test Loss: 1.154 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.40182662010193
Epoch: 14, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 19.146114349365234
Epoch: 15, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.121 Vali Acc: 0.570 Test Loss: 1.121 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 20.066126823425293
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.657 Vali Acc: 0.540 Test Loss: 1.657 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 222258
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 39.19070792198181
Epoch: 1, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 36.956193923950195
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 37.062090158462524
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.665 Vali Acc: 0.650 Test Loss: 0.665 Test Acc: 0.650
Validation loss decreased (-0.559993 --> -0.649993).  Saving model ...
Epoch: 4 cost time: 35.122790813446045
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.679 Vali Acc: 0.620 Test Loss: 0.679 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 31.051113843917847
Epoch: 5, Steps: 18 | Train Loss: 0.520 Vali Loss: 0.653 Vali Acc: 0.630 Test Loss: 0.653 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 34.33122205734253
Epoch: 6, Steps: 18 | Train Loss: 0.431 Vali Loss: 0.741 Vali Acc: 0.570 Test Loss: 0.741 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 33.77782964706421
Epoch: 7, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.725 Vali Acc: 0.520 Test Loss: 0.725 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 32.68478727340698
Epoch: 8, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.783 Vali Acc: 0.610 Test Loss: 0.783 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 35.88152289390564
Epoch: 9, Steps: 18 | Train Loss: 0.307 Vali Loss: 0.807 Vali Acc: 0.560 Test Loss: 0.807 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 37.765953540802
Epoch: 10, Steps: 18 | Train Loss: 0.296 Vali Loss: 0.803 Vali Acc: 0.570 Test Loss: 0.803 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 34.84063482284546
Epoch: 11, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.288 Vali Acc: 0.530 Test Loss: 1.288 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 35.64420700073242
Epoch: 12, Steps: 18 | Train Loss: 0.300 Vali Loss: 0.824 Vali Acc: 0.600 Test Loss: 0.824 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 36.095147371292114
Epoch: 13, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.567 Vali Acc: 0.530 Test Loss: 1.567 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 636274
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.147071838378906
Epoch: 1, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.796 Vali Acc: 0.480 Test Loss: 0.796 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 16.49870014190674
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.758 Vali Acc: 0.520 Test Loss: 0.758 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 16.30992817878723
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.48528218269348
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.163943767547607
Epoch: 5, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.907 Vali Acc: 0.500 Test Loss: 0.907 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.944276809692383
Epoch: 6, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.704 Vali Acc: 0.580 Test Loss: 0.704 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 16.236459970474243
Epoch: 7, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.394507884979248
Epoch: 8, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.867 Vali Acc: 0.520 Test Loss: 0.867 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.221355199813843
Epoch: 9, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.819 Vali Acc: 0.590 Test Loss: 0.819 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 13.768835067749023
Epoch: 10, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.043229818344116
Epoch: 11, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.044 Vali Acc: 0.560 Test Loss: 1.044 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.428213119506836
Epoch: 12, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.259 Vali Acc: 0.560 Test Loss: 1.259 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.399487495422363
Epoch: 13, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.226 Vali Acc: 0.570 Test Loss: 1.226 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.153118371963501
Epoch: 14, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.133 Vali Acc: 0.510 Test Loss: 1.133 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 14.394898653030396
Epoch: 15, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.199 Vali Acc: 0.600 Test Loss: 1.199 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 13.382803678512573
Epoch: 16, Steps: 18 | Train Loss: 0.115 Vali Loss: 1.136 Vali Acc: 0.540 Test Loss: 1.136 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.83071494102478
Epoch: 17, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.518 Vali Acc: 0.530 Test Loss: 1.518 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.937193870544434
Epoch: 18, Steps: 18 | Train Loss: 0.138 Vali Loss: 1.406 Vali Acc: 0.520 Test Loss: 1.406 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.169636487960815
Epoch: 19, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.447 Vali Acc: 0.590 Test Loss: 1.447 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.718764543533325
Epoch: 20, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.697 Vali Acc: 0.530 Test Loss: 1.697 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 14.187642097473145
Epoch: 21, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.689 Vali Acc: 0.520 Test Loss: 1.689 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.653881788253784
Epoch: 22, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.842 Vali Acc: 0.500 Test Loss: 1.842 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.46300983428955
Epoch: 23, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.444 Vali Acc: 0.520 Test Loss: 1.444 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.290672779083252
Epoch: 24, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.832 Vali Acc: 0.490 Test Loss: 1.832 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.27378273010254
Epoch: 25, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.710 Vali Acc: 0.540 Test Loss: 1.710 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 222258
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.108821868896484
Epoch: 1, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 23.254328727722168
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 20.741713523864746
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.666 Vali Acc: 0.640 Test Loss: 0.666 Test Acc: 0.640
Validation loss decreased (-0.549993 --> -0.639993).  Saving model ...
Epoch: 4 cost time: 20.80007815361023
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.677 Vali Acc: 0.620 Test Loss: 0.677 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.221251726150513
Epoch: 5, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.653 Vali Acc: 0.630 Test Loss: 0.653 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.3928701877594
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.4903085231781
Epoch: 7, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.59914207458496
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.856367111206055
Epoch: 9, Steps: 18 | Train Loss: 0.303 Vali Loss: 0.754 Vali Acc: 0.590 Test Loss: 0.754 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 23.021824598312378
Epoch: 10, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.746 Vali Acc: 0.610 Test Loss: 0.746 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 18.04035997390747
Epoch: 11, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.076 Vali Acc: 0.560 Test Loss: 1.076 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 23.977925539016724
Epoch: 12, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.831 Vali Acc: 0.600 Test Loss: 0.831 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 23.09797430038452
Epoch: 13, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.028 Vali Acc: 0.520 Test Loss: 1.028 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 636274
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.355894804000854
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 11.349102020263672
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
Validation loss decreased (-0.469992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 11.131099224090576
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.246585607528687
Epoch: 4, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.352817296981812
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.881 Vali Acc: 0.510 Test Loss: 0.881 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.710744380950928
Epoch: 6, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.706 Vali Acc: 0.580 Test Loss: 0.706 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 10.34299921989441
Epoch: 7, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.112 Vali Acc: 0.530 Test Loss: 1.112 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.25302791595459
Epoch: 8, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.261471033096313
Epoch: 9, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.527331829071045
Epoch: 10, Steps: 18 | Train Loss: 0.305 Vali Loss: 0.975 Vali Acc: 0.490 Test Loss: 0.975 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.281215190887451
Epoch: 11, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.287367582321167
Epoch: 12, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.175 Vali Acc: 0.520 Test Loss: 1.175 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.291656255722046
Epoch: 13, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.125 Vali Acc: 0.540 Test Loss: 1.125 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.15623950958252
Epoch: 14, Steps: 18 | Train Loss: 0.205 Vali Loss: 0.912 Vali Acc: 0.620 Test Loss: 0.912 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619991).  Saving model ...
Epoch: 15 cost time: 12.01602578163147
Epoch: 15, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.227 Vali Acc: 0.580 Test Loss: 1.227 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 12.447837114334106
Epoch: 16, Steps: 18 | Train Loss: 0.117 Vali Loss: 2.174 Vali Acc: 0.480 Test Loss: 2.174 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 12.12315034866333
Epoch: 17, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.838 Vali Acc: 0.470 Test Loss: 1.838 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.044569253921509
Epoch: 18, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.849 Vali Acc: 0.480 Test Loss: 1.849 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.972691059112549
Epoch: 19, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.529 Vali Acc: 0.570 Test Loss: 1.529 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.675853729248047
Epoch: 20, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.512 Vali Acc: 0.560 Test Loss: 1.512 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.299628496170044
Epoch: 21, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.398 Vali Acc: 0.540 Test Loss: 1.398 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.032641172409058
Epoch: 22, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.599 Vali Acc: 0.520 Test Loss: 1.599 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.926273107528687
Epoch: 23, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.458 Vali Acc: 0.560 Test Loss: 1.458 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.809507369995117
Epoch: 24, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.672 Vali Acc: 0.530 Test Loss: 1.672 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 222258
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.89360237121582
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.835 Vali Acc: 0.450 Test Loss: 0.835 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 30.66600775718689
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 35.25181722640991
Epoch: 3, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 34.05589461326599
Epoch: 4, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 33.389174938201904
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 34.053409814834595
Epoch: 6, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.765939950942993
Epoch: 7, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.101279735565186
Epoch: 8, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.911 Vali Acc: 0.470 Test Loss: 0.911 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 32.80218505859375
Epoch: 9, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 32.742748975753784
Epoch: 10, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.224 Vali Acc: 0.520 Test Loss: 1.224 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 32.68616461753845
Epoch: 11, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.707 Vali Acc: 0.520 Test Loss: 1.707 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 33.95673894882202
Epoch: 12, Steps: 18 | Train Loss: 0.214 Vali Loss: 1.237 Vali Acc: 0.490 Test Loss: 1.237 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 35.53313875198364
Epoch: 13, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.422 Vali Acc: 0.530 Test Loss: 1.422 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 32.45821237564087
Epoch: 14, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.585 Vali Acc: 0.500 Test Loss: 1.585 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 343026
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.132555961608887
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.709 Vali Acc: 0.470 Test Loss: 0.709 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 14.77048397064209
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.676 Vali Acc: 0.590 Test Loss: 0.676 Test Acc: 0.590
Validation loss decreased (-0.469993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 12.811733961105347
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.285510778427124
Epoch: 4, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.676027059555054
Epoch: 5, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.671 Vali Acc: 0.570 Test Loss: 0.671 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.976491928100586
Epoch: 6, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.889 Vali Acc: 0.510 Test Loss: 0.889 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 14.857218265533447
Epoch: 7, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.796 Vali Acc: 0.490 Test Loss: 0.796 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.544620275497437
Epoch: 8, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 14.958147048950195
Epoch: 9, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 14.589334487915039
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 16.28099799156189
Epoch: 11, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.397 Vali Acc: 0.460 Test Loss: 1.397 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 16.145047426223755
Epoch: 12, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.038 Vali Acc: 0.510 Test Loss: 1.038 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 135986
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.491650819778442
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.837 Vali Acc: 0.450 Test Loss: 0.837 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 23.51630401611328
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 24.68599534034729
Epoch: 3, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.801417112350464
Epoch: 4, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 23.811619997024536
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.806 Vali Acc: 0.480 Test Loss: 0.806 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.523159742355347
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.771 Vali Acc: 0.520 Test Loss: 0.771 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.081994771957397
Epoch: 7, Steps: 18 | Train Loss: 0.388 Vali Loss: 1.045 Vali Acc: 0.510 Test Loss: 1.045 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.17076277732849
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 0.863 Vali Acc: 0.490 Test Loss: 0.863 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 24.104017972946167
Epoch: 9, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.120 Vali Acc: 0.530 Test Loss: 1.120 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 24.636995315551758
Epoch: 10, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.968 Vali Acc: 0.540 Test Loss: 0.968 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 26.32328510284424
Epoch: 11, Steps: 18 | Train Loss: 0.269 Vali Loss: 2.078 Vali Acc: 0.520 Test Loss: 2.078 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 26.688793659210205
Epoch: 12, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.368 Vali Acc: 0.440 Test Loss: 1.368 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 26.054923057556152
Epoch: 13, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.544 Vali Acc: 0.520 Test Loss: 1.544 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 25.809125423431396
Epoch: 14, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.359 Vali Acc: 0.510 Test Loss: 1.359 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 343026
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.36003565788269
Epoch: 1, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.710 Vali Acc: 0.470 Test Loss: 0.710 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 12.242580652236938
Epoch: 2, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.677 Vali Acc: 0.590 Test Loss: 0.677 Test Acc: 0.590
Validation loss decreased (-0.469993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 12.362595796585083
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.745 Vali Acc: 0.540 Test Loss: 0.745 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.671526193618774
Epoch: 4, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.4802725315094
Epoch: 5, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.686 Vali Acc: 0.560 Test Loss: 0.686 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.266250371932983
Epoch: 6, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.885 Vali Acc: 0.520 Test Loss: 0.885 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.99896788597107
Epoch: 7, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.290220022201538
Epoch: 8, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.219157218933105
Epoch: 9, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.835 Vali Acc: 0.470 Test Loss: 0.835 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.25321078300476
Epoch: 10, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.893 Vali Acc: 0.470 Test Loss: 0.893 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.59854769706726
Epoch: 11, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.29023551940918
Epoch: 12, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.055 Vali Acc: 0.540 Test Loss: 1.055 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 135986
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.631757497787476
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.837 Vali Acc: 0.450 Test Loss: 0.837 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 20.44221544265747
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.744 Vali Acc: 0.510 Test Loss: 0.744 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 19.892107009887695
Epoch: 3, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.40347409248352
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.837 Vali Acc: 0.540 Test Loss: 0.837 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 20.505420446395874
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.796 Vali Acc: 0.460 Test Loss: 0.796 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.97014880180359
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.773 Vali Acc: 0.520 Test Loss: 0.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.325616359710693
Epoch: 7, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.043 Vali Acc: 0.510 Test Loss: 1.043 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.706361532211304
Epoch: 8, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.879 Vali Acc: 0.460 Test Loss: 0.879 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.5942063331604
Epoch: 9, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.108 Vali Acc: 0.540 Test Loss: 1.108 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.82532238960266
Epoch: 10, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.42333436012268
Epoch: 11, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.827 Vali Acc: 0.510 Test Loss: 1.827 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.87595510482788
Epoch: 12, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.188 Vali Acc: 0.520 Test Loss: 1.188 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 18.331051111221313
Epoch: 13, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.379 Vali Acc: 0.560 Test Loss: 1.379 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559986).  Saving model ...
Epoch: 14 cost time: 20.255366802215576
Epoch: 14, Steps: 18 | Train Loss: 0.150 Vali Loss: 2.279 Vali Acc: 0.510 Test Loss: 2.279 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.52565860748291
Epoch: 15, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.278 Vali Acc: 0.510 Test Loss: 1.278 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.584496021270752
Epoch: 16, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.330 Vali Acc: 0.560 Test Loss: 1.330 Test Acc: 0.560
Validation loss decreased (-0.559986 --> -0.559987).  Saving model ...
Epoch: 17 cost time: 20.506091117858887
Epoch: 17, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 20.563509225845337
Epoch: 18, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.874 Vali Acc: 0.570 Test Loss: 1.874 Test Acc: 0.570
Validation loss decreased (-0.559987 --> -0.569981).  Saving model ...
Epoch: 19 cost time: 19.696919202804565
Epoch: 19, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.394 Vali Acc: 0.510 Test Loss: 1.394 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 20.371837615966797
Epoch: 20, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.395 Vali Acc: 0.440 Test Loss: 1.395 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 19.973142623901367
Epoch: 21, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.007 Vali Acc: 0.560 Test Loss: 2.007 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 20.014089107513428
Epoch: 22, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 19.76231598854065
Epoch: 23, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.638 Vali Acc: 0.520 Test Loss: 1.638 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 19.145622730255127
Epoch: 24, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.737 Vali Acc: 0.490 Test Loss: 1.737 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 18.75616979598999
Epoch: 25, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.093 Vali Acc: 0.540 Test Loss: 2.093 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 19.137818813323975
Epoch: 26, Steps: 18 | Train Loss: 0.010 Vali Loss: 1.923 Vali Acc: 0.510 Test Loss: 1.923 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 19.05801248550415
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 1.668 Vali Acc: 0.450 Test Loss: 1.668 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 20.159093856811523
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 1.889 Vali Acc: 0.490 Test Loss: 1.889 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 343026
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.3275306224823
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.709 Vali Acc: 0.460 Test Loss: 0.709 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 9.781766176223755
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.678 Vali Acc: 0.560 Test Loss: 0.678 Test Acc: 0.560
Validation loss decreased (-0.459993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 9.871963500976562
Epoch: 3, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.753 Vali Acc: 0.530 Test Loss: 0.753 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.885337114334106
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.886 Vali Acc: 0.510 Test Loss: 0.886 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.95033597946167
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.671 Vali Acc: 0.580 Test Loss: 0.671 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 6 cost time: 9.937737464904785
Epoch: 6, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.899 Vali Acc: 0.500 Test Loss: 0.899 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.772746801376343
Epoch: 7, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.915229082107544
Epoch: 8, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.948107719421387
Epoch: 9, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.012343168258667
Epoch: 10, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.870 Vali Acc: 0.490 Test Loss: 0.870 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.584440231323242
Epoch: 11, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.108 Vali Acc: 0.480 Test Loss: 1.108 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.097815036773682
Epoch: 12, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.874 Vali Acc: 0.540 Test Loss: 0.874 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.948179721832275
Epoch: 13, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.045 Vali Acc: 0.520 Test Loss: 1.045 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.839909076690674
Epoch: 14, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.978 Vali Acc: 0.580 Test Loss: 0.978 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.006835222244263
Epoch: 15, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.098 Vali Acc: 0.560 Test Loss: 1.098 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 135986
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 661.7957558631897
Epoch: 1, Steps: 18 | Train Loss: 1.010 Vali Loss: 1.546 Vali Acc: 0.460 Test Loss: 1.546 Test Acc: 0.460
Validation loss decreased (inf --> -0.459985).  Saving model ...
Epoch: 2 cost time: 568.1401407718658
Epoch: 2, Steps: 18 | Train Loss: 1.188 Vali Loss: 1.392 Vali Acc: 0.610 Test Loss: 1.392 Test Acc: 0.610
Validation loss decreased (-0.459985 --> -0.609986).  Saving model ...
Epoch: 3 cost time: 457.43388533592224
Epoch: 3, Steps: 18 | Train Loss: 0.998 Vali Loss: 2.169 Vali Acc: 0.580 Test Loss: 2.169 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 459.7590193748474
Epoch: 4, Steps: 18 | Train Loss: 1.376 Vali Loss: 4.377 Vali Acc: 0.510 Test Loss: 4.377 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 461.89421224594116
Epoch: 5, Steps: 18 | Train Loss: 1.553 Vali Loss: 12.876 Vali Acc: 0.510 Test Loss: 12.876 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 454.0174090862274
Epoch: 6, Steps: 18 | Train Loss: 2.660 Vali Loss: 6.195 Vali Acc: 0.530 Test Loss: 6.195 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 464.0137073993683
Epoch: 7, Steps: 18 | Train Loss: 1.145 Vali Loss: 3.383 Vali Acc: 0.590 Test Loss: 3.383 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 430.33650040626526
Epoch: 8, Steps: 18 | Train Loss: 2.193 Vali Loss: 7.667 Vali Acc: 0.520 Test Loss: 7.667 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 411.8872580528259
Epoch: 9, Steps: 18 | Train Loss: 1.873 Vali Loss: 5.858 Vali Acc: 0.480 Test Loss: 5.858 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 424.7285623550415
Epoch: 10, Steps: 18 | Train Loss: 1.223 Vali Loss: 11.204 Vali Acc: 0.520 Test Loss: 11.204 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 416.2170820236206
Epoch: 11, Steps: 18 | Train Loss: 2.109 Vali Loss: 10.404 Vali Acc: 0.530 Test Loss: 10.404 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 408.88566970825195
Epoch: 12, Steps: 18 | Train Loss: 1.653 Vali Loss: 5.472 Vali Acc: 0.570 Test Loss: 5.472 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 57030146
model size : 220.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 160.0995228290558
Epoch: 1, Steps: 18 | Train Loss: 1.032 Vali Loss: 1.616 Vali Acc: 0.450 Test Loss: 1.616 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 160.482342004776
Epoch: 2, Steps: 18 | Train Loss: 1.635 Vali Loss: 2.530 Vali Acc: 0.580 Test Loss: 2.530 Test Acc: 0.580
Validation loss decreased (-0.449984 --> -0.579975).  Saving model ...
Epoch: 3 cost time: 152.8745527267456
Epoch: 3, Steps: 18 | Train Loss: 1.235 Vali Loss: 2.023 Vali Acc: 0.510 Test Loss: 2.023 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 151.79004096984863
Epoch: 4, Steps: 18 | Train Loss: 0.861 Vali Loss: 2.238 Vali Acc: 0.610 Test Loss: 2.238 Test Acc: 0.610
Validation loss decreased (-0.579975 --> -0.609978).  Saving model ...
Epoch: 5 cost time: 157.95644807815552
Epoch: 5, Steps: 18 | Train Loss: 1.668 Vali Loss: 6.462 Vali Acc: 0.500 Test Loss: 6.462 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 156.15178275108337
Epoch: 6, Steps: 18 | Train Loss: 1.340 Vali Loss: 3.870 Vali Acc: 0.490 Test Loss: 3.870 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 152.17484521865845
Epoch: 7, Steps: 18 | Train Loss: 1.082 Vali Loss: 5.962 Vali Acc: 0.560 Test Loss: 5.962 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 150.07091641426086
Epoch: 8, Steps: 18 | Train Loss: 1.324 Vali Loss: 4.256 Vali Acc: 0.580 Test Loss: 4.256 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 146.25561475753784
Epoch: 9, Steps: 18 | Train Loss: 1.370 Vali Loss: 3.492 Vali Acc: 0.490 Test Loss: 3.492 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 146.06053709983826
Epoch: 10, Steps: 18 | Train Loss: 1.283 Vali Loss: 4.965 Vali Acc: 0.500 Test Loss: 4.965 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 145.00082659721375
Epoch: 11, Steps: 18 | Train Loss: 1.201 Vali Loss: 8.316 Vali Acc: 0.510 Test Loss: 8.316 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 145.19162726402283
Epoch: 12, Steps: 18 | Train Loss: 1.039 Vali Loss: 5.152 Vali Acc: 0.540 Test Loss: 5.152 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 145.5567548274994
Epoch: 13, Steps: 18 | Train Loss: 0.493 Vali Loss: 13.640 Vali Acc: 0.450 Test Loss: 13.640 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 151.0928213596344
Epoch: 14, Steps: 18 | Train Loss: 1.181 Vali Loss: 14.016 Vali Acc: 0.490 Test Loss: 14.016 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 17313026
model size : 68.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 320.7647008895874
Epoch: 1, Steps: 18 | Train Loss: 1.011 Vali Loss: 1.558 Vali Acc: 0.460 Test Loss: 1.558 Test Acc: 0.460
Validation loss decreased (inf --> -0.459984).  Saving model ...
Epoch: 2 cost time: 322.81728768348694
Epoch: 2, Steps: 18 | Train Loss: 1.190 Vali Loss: 1.415 Vali Acc: 0.610 Test Loss: 1.415 Test Acc: 0.610
Validation loss decreased (-0.459984 --> -0.609986).  Saving model ...
Epoch: 3 cost time: 321.91552472114563
Epoch: 3, Steps: 18 | Train Loss: 0.988 Vali Loss: 2.093 Vali Acc: 0.570 Test Loss: 2.093 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 323.5104420185089
Epoch: 4, Steps: 18 | Train Loss: 1.539 Vali Loss: 5.382 Vali Acc: 0.500 Test Loss: 5.382 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 329.0636773109436
Epoch: 5, Steps: 18 | Train Loss: 2.001 Vali Loss: 6.570 Vali Acc: 0.490 Test Loss: 6.570 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 323.67971682548523
Epoch: 6, Steps: 18 | Train Loss: 2.081 Vali Loss: 5.816 Vali Acc: 0.520 Test Loss: 5.816 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 331.17969036102295
Epoch: 7, Steps: 18 | Train Loss: 1.062 Vali Loss: 2.557 Vali Acc: 0.590 Test Loss: 2.557 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 299.7819540500641
Epoch: 8, Steps: 18 | Train Loss: 0.505 Vali Loss: 9.775 Vali Acc: 0.530 Test Loss: 9.775 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 286.3521430492401
Epoch: 9, Steps: 18 | Train Loss: 0.659 Vali Loss: 5.459 Vali Acc: 0.550 Test Loss: 5.459 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 286.6221377849579
Epoch: 10, Steps: 18 | Train Loss: 0.930 Vali Loss: 7.059 Vali Acc: 0.440 Test Loss: 7.059 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 287.9367456436157
Epoch: 11, Steps: 18 | Train Loss: 1.139 Vali Loss: 7.728 Vali Acc: 0.500 Test Loss: 7.728 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 283.75559520721436
Epoch: 12, Steps: 18 | Train Loss: 0.653 Vali Loss: 6.661 Vali Acc: 0.470 Test Loss: 6.661 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 57030146
model size : 220.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 108.94528293609619
Epoch: 1, Steps: 18 | Train Loss: 1.033 Vali Loss: 1.604 Vali Acc: 0.450 Test Loss: 1.604 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 108.72975039482117
Epoch: 2, Steps: 18 | Train Loss: 1.662 Vali Loss: 2.559 Vali Acc: 0.560 Test Loss: 2.559 Test Acc: 0.560
Validation loss decreased (-0.449984 --> -0.559974).  Saving model ...
Epoch: 3 cost time: 109.60330247879028
Epoch: 3, Steps: 18 | Train Loss: 1.515 Vali Loss: 1.401 Vali Acc: 0.580 Test Loss: 1.401 Test Acc: 0.580
Validation loss decreased (-0.559974 --> -0.579986).  Saving model ...
Epoch: 4 cost time: 107.2320945262909
Epoch: 4, Steps: 18 | Train Loss: 1.015 Vali Loss: 5.365 Vali Acc: 0.550 Test Loss: 5.365 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 102.51296186447144
Epoch: 5, Steps: 18 | Train Loss: 2.337 Vali Loss: 11.825 Vali Acc: 0.510 Test Loss: 11.825 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 119.13471579551697
Epoch: 6, Steps: 18 | Train Loss: 2.386 Vali Loss: 4.467 Vali Acc: 0.510 Test Loss: 4.467 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 115.87082147598267
Epoch: 7, Steps: 18 | Train Loss: 1.017 Vali Loss: 3.701 Vali Acc: 0.540 Test Loss: 3.701 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 109.48072814941406
Epoch: 8, Steps: 18 | Train Loss: 1.015 Vali Loss: 4.919 Vali Acc: 0.540 Test Loss: 4.919 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 117.86811828613281
Epoch: 9, Steps: 18 | Train Loss: 1.296 Vali Loss: 5.858 Vali Acc: 0.530 Test Loss: 5.858 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 116.27755951881409
Epoch: 10, Steps: 18 | Train Loss: 0.762 Vali Loss: 3.590 Vali Acc: 0.520 Test Loss: 3.590 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 116.34094214439392
Epoch: 11, Steps: 18 | Train Loss: 1.030 Vali Loss: 10.347 Vali Acc: 0.520 Test Loss: 10.347 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 113.32751965522766
Epoch: 12, Steps: 18 | Train Loss: 1.261 Vali Loss: 4.565 Vali Acc: 0.490 Test Loss: 4.565 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 117.49551558494568
Epoch: 13, Steps: 18 | Train Loss: 0.698 Vali Loss: 6.887 Vali Acc: 0.520 Test Loss: 6.887 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 17313026
model size : 68.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 191.70640873908997
Epoch: 1, Steps: 18 | Train Loss: 1.012 Vali Loss: 1.560 Vali Acc: 0.460 Test Loss: 1.560 Test Acc: 0.460
Validation loss decreased (inf --> -0.459984).  Saving model ...
Epoch: 2 cost time: 165.68315958976746
Epoch: 2, Steps: 18 | Train Loss: 1.184 Vali Loss: 1.349 Vali Acc: 0.600 Test Loss: 1.349 Test Acc: 0.600
Validation loss decreased (-0.459984 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 169.96196722984314
Epoch: 3, Steps: 18 | Train Loss: 1.017 Vali Loss: 2.598 Vali Acc: 0.540 Test Loss: 2.598 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 167.93848657608032
Epoch: 4, Steps: 18 | Train Loss: 1.358 Vali Loss: 3.146 Vali Acc: 0.520 Test Loss: 3.146 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 175.88738346099854
Epoch: 5, Steps: 18 | Train Loss: 1.498 Vali Loss: 10.413 Vali Acc: 0.500 Test Loss: 10.413 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 157.32973265647888
Epoch: 6, Steps: 18 | Train Loss: 2.053 Vali Loss: 3.899 Vali Acc: 0.560 Test Loss: 3.899 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 140.55928468704224
Epoch: 7, Steps: 18 | Train Loss: 2.302 Vali Loss: 3.762 Vali Acc: 0.550 Test Loss: 3.762 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 162.13429355621338
Epoch: 8, Steps: 18 | Train Loss: 0.771 Vali Loss: 8.813 Vali Acc: 0.480 Test Loss: 8.813 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 161.0421757698059
Epoch: 9, Steps: 18 | Train Loss: 1.464 Vali Loss: 7.610 Vali Acc: 0.490 Test Loss: 7.610 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 158.2042396068573
Epoch: 10, Steps: 18 | Train Loss: 0.677 Vali Loss: 4.385 Vali Acc: 0.530 Test Loss: 4.385 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 192.67170071601868
Epoch: 11, Steps: 18 | Train Loss: 0.697 Vali Loss: 8.876 Vali Acc: 0.480 Test Loss: 8.876 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 193.40655755996704
Epoch: 12, Steps: 18 | Train Loss: 3.765 Vali Loss: 9.251 Vali Acc: 0.530 Test Loss: 9.251 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 57030146
model size : 220.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 76.70187187194824
Epoch: 1, Steps: 18 | Train Loss: 1.033 Vali Loss: 1.601 Vali Acc: 0.450 Test Loss: 1.601 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 81.21391010284424
Epoch: 2, Steps: 18 | Train Loss: 1.660 Vali Loss: 2.557 Vali Acc: 0.560 Test Loss: 2.557 Test Acc: 0.560
Validation loss decreased (-0.449984 --> -0.559974).  Saving model ...
Epoch: 3 cost time: 81.20439028739929
Epoch: 3, Steps: 18 | Train Loss: 1.539 Vali Loss: 1.633 Vali Acc: 0.550 Test Loss: 1.633 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 69.72373795509338
Epoch: 4, Steps: 18 | Train Loss: 1.690 Vali Loss: 3.339 Vali Acc: 0.570 Test Loss: 3.339 Test Acc: 0.570
Validation loss decreased (-0.559974 --> -0.569967).  Saving model ...
Epoch: 5 cost time: 77.3975236415863
Epoch: 5, Steps: 18 | Train Loss: 1.093 Vali Loss: 4.267 Vali Acc: 0.490 Test Loss: 4.267 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 79.54499316215515
Epoch: 6, Steps: 18 | Train Loss: 1.857 Vali Loss: 2.801 Vali Acc: 0.550 Test Loss: 2.801 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 73.28056716918945
Epoch: 7, Steps: 18 | Train Loss: 1.532 Vali Loss: 2.961 Vali Acc: 0.580 Test Loss: 2.961 Test Acc: 0.580
Validation loss decreased (-0.569967 --> -0.579970).  Saving model ...
Epoch: 8 cost time: 81.05493521690369
Epoch: 8, Steps: 18 | Train Loss: 1.861 Vali Loss: 6.982 Vali Acc: 0.510 Test Loss: 6.982 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 81.12317681312561
Epoch: 9, Steps: 18 | Train Loss: 1.990 Vali Loss: 10.199 Vali Acc: 0.510 Test Loss: 10.199 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 74.29989695549011
Epoch: 10, Steps: 18 | Train Loss: 0.813 Vali Loss: 8.252 Vali Acc: 0.500 Test Loss: 8.252 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 79.20748615264893
Epoch: 11, Steps: 18 | Train Loss: 1.509 Vali Loss: 5.142 Vali Acc: 0.540 Test Loss: 5.142 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 79.35075211524963
Epoch: 12, Steps: 18 | Train Loss: 0.522 Vali Loss: 6.109 Vali Acc: 0.560 Test Loss: 6.109 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 74.97452521324158
Epoch: 13, Steps: 18 | Train Loss: 1.146 Vali Loss: 5.129 Vali Acc: 0.550 Test Loss: 5.129 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 80.3314859867096
Epoch: 14, Steps: 18 | Train Loss: 1.074 Vali Loss: 6.962 Vali Acc: 0.490 Test Loss: 6.962 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 81.04892563819885
Epoch: 15, Steps: 18 | Train Loss: 0.866 Vali Loss: 9.601 Vali Acc: 0.480 Test Loss: 9.601 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 76.74505996704102
Epoch: 16, Steps: 18 | Train Loss: 1.062 Vali Loss: 6.485 Vali Acc: 0.460 Test Loss: 6.485 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 79.86354374885559
Epoch: 17, Steps: 18 | Train Loss: 2.377 Vali Loss: 27.875 Vali Acc: 0.500 Test Loss: 27.875 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 17313026
model size : 68.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 226.06174683570862
Epoch: 1, Steps: 18 | Train Loss: 0.906 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 231.57879900932312
Epoch: 2, Steps: 18 | Train Loss: 0.944 Vali Loss: 1.694 Vali Acc: 0.590 Test Loss: 1.694 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589983).  Saving model ...
Epoch: 3 cost time: 228.9552309513092
Epoch: 3, Steps: 18 | Train Loss: 1.108 Vali Loss: 5.128 Vali Acc: 0.510 Test Loss: 5.128 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 235.43158221244812
Epoch: 4, Steps: 18 | Train Loss: 1.992 Vali Loss: 9.018 Vali Acc: 0.500 Test Loss: 9.018 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 233.83143377304077
Epoch: 5, Steps: 18 | Train Loss: 3.643 Vali Loss: 6.596 Vali Acc: 0.400 Test Loss: 6.596 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 234.24583101272583
Epoch: 6, Steps: 18 | Train Loss: 2.401 Vali Loss: 3.657 Vali Acc: 0.570 Test Loss: 3.657 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 239.27977418899536
Epoch: 7, Steps: 18 | Train Loss: 1.298 Vali Loss: 7.076 Vali Acc: 0.440 Test Loss: 7.076 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 234.8595733642578
Epoch: 8, Steps: 18 | Train Loss: 1.200 Vali Loss: 5.013 Vali Acc: 0.530 Test Loss: 5.013 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 209.4846601486206
Epoch: 9, Steps: 18 | Train Loss: 0.832 Vali Loss: 8.003 Vali Acc: 0.570 Test Loss: 8.003 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 208.89768290519714
Epoch: 10, Steps: 18 | Train Loss: 2.174 Vali Loss: 6.198 Vali Acc: 0.570 Test Loss: 6.198 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 211.3954095840454
Epoch: 11, Steps: 18 | Train Loss: 1.135 Vali Loss: 3.813 Vali Acc: 0.530 Test Loss: 3.813 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 218.76294565200806
Epoch: 12, Steps: 18 | Train Loss: 0.558 Vali Loss: 4.626 Vali Acc: 0.550 Test Loss: 4.626 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28912898
model size : 112.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 72.91394710540771
Epoch: 1, Steps: 18 | Train Loss: 1.061 Vali Loss: 1.949 Vali Acc: 0.470 Test Loss: 1.949 Test Acc: 0.470
Validation loss decreased (inf --> -0.469981).  Saving model ...
Epoch: 2 cost time: 69.3329586982727
Epoch: 2, Steps: 18 | Train Loss: 1.075 Vali Loss: 2.343 Vali Acc: 0.510 Test Loss: 2.343 Test Acc: 0.510
Validation loss decreased (-0.469981 --> -0.509977).  Saving model ...
Epoch: 3 cost time: 81.91185235977173
Epoch: 3, Steps: 18 | Train Loss: 0.806 Vali Loss: 3.163 Vali Acc: 0.550 Test Loss: 3.163 Test Acc: 0.550
Validation loss decreased (-0.509977 --> -0.549968).  Saving model ...
Epoch: 4 cost time: 87.30163955688477
Epoch: 4, Steps: 18 | Train Loss: 1.476 Vali Loss: 5.065 Vali Acc: 0.440 Test Loss: 5.065 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 87.3152756690979
Epoch: 5, Steps: 18 | Train Loss: 1.038 Vali Loss: 2.779 Vali Acc: 0.590 Test Loss: 2.779 Test Acc: 0.590
Validation loss decreased (-0.549968 --> -0.589972).  Saving model ...
Epoch: 6 cost time: 83.31057953834534
Epoch: 6, Steps: 18 | Train Loss: 0.928 Vali Loss: 2.954 Vali Acc: 0.550 Test Loss: 2.954 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 81.64403295516968
Epoch: 7, Steps: 18 | Train Loss: 0.996 Vali Loss: 2.603 Vali Acc: 0.480 Test Loss: 2.603 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 80.02294206619263
Epoch: 8, Steps: 18 | Train Loss: 0.956 Vali Loss: 5.668 Vali Acc: 0.520 Test Loss: 5.668 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 82.13888120651245
Epoch: 9, Steps: 18 | Train Loss: 0.706 Vali Loss: 7.783 Vali Acc: 0.450 Test Loss: 7.783 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 87.11031007766724
Epoch: 10, Steps: 18 | Train Loss: 0.917 Vali Loss: 7.393 Vali Acc: 0.530 Test Loss: 7.393 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 88.15574169158936
Epoch: 11, Steps: 18 | Train Loss: 0.754 Vali Loss: 10.842 Vali Acc: 0.510 Test Loss: 10.842 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 82.45434284210205
Epoch: 12, Steps: 18 | Train Loss: 0.908 Vali Loss: 6.070 Vali Acc: 0.460 Test Loss: 6.070 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 81.91582345962524
Epoch: 13, Steps: 18 | Train Loss: 1.130 Vali Loss: 12.470 Vali Acc: 0.520 Test Loss: 12.470 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 83.84420418739319
Epoch: 14, Steps: 18 | Train Loss: 0.511 Vali Loss: 10.947 Vali Acc: 0.530 Test Loss: 10.947 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 85.5260124206543
Epoch: 15, Steps: 18 | Train Loss: 1.317 Vali Loss: 8.518 Vali Acc: 0.490 Test Loss: 8.518 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9053954
model size : 37.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 166.89554357528687
Epoch: 1, Steps: 18 | Train Loss: 0.906 Vali Loss: 0.848 Vali Acc: 0.520 Test Loss: 0.848 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 164.34962439537048
Epoch: 2, Steps: 18 | Train Loss: 0.944 Vali Loss: 1.694 Vali Acc: 0.590 Test Loss: 1.694 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589983).  Saving model ...
Epoch: 3 cost time: 163.68907022476196
Epoch: 3, Steps: 18 | Train Loss: 1.108 Vali Loss: 5.134 Vali Acc: 0.510 Test Loss: 5.134 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 168.41240334510803
Epoch: 4, Steps: 18 | Train Loss: 1.989 Vali Loss: 8.978 Vali Acc: 0.500 Test Loss: 8.978 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 155.25210285186768
Epoch: 5, Steps: 18 | Train Loss: 3.571 Vali Loss: 6.722 Vali Acc: 0.400 Test Loss: 6.722 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 179.05098032951355
Epoch: 6, Steps: 18 | Train Loss: 2.395 Vali Loss: 3.829 Vali Acc: 0.590 Test Loss: 3.829 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 175.69669222831726
Epoch: 7, Steps: 18 | Train Loss: 1.313 Vali Loss: 14.080 Vali Acc: 0.490 Test Loss: 14.080 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 172.14633989334106
Epoch: 8, Steps: 18 | Train Loss: 2.170 Vali Loss: 3.878 Vali Acc: 0.570 Test Loss: 3.878 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 177.029367685318
Epoch: 9, Steps: 18 | Train Loss: 1.100 Vali Loss: 4.915 Vali Acc: 0.590 Test Loss: 4.915 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 175.84058046340942
Epoch: 10, Steps: 18 | Train Loss: 0.938 Vali Loss: 6.153 Vali Acc: 0.550 Test Loss: 6.153 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 174.6623513698578
Epoch: 11, Steps: 18 | Train Loss: 0.693 Vali Loss: 7.564 Vali Acc: 0.510 Test Loss: 7.564 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 179.92939162254333
Epoch: 12, Steps: 18 | Train Loss: 0.855 Vali Loss: 9.492 Vali Acc: 0.530 Test Loss: 9.492 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28912898
model size : 112.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 75.50668573379517
Epoch: 1, Steps: 18 | Train Loss: 1.060 Vali Loss: 1.960 Vali Acc: 0.470 Test Loss: 1.960 Test Acc: 0.470
Validation loss decreased (inf --> -0.469980).  Saving model ...
Epoch: 2 cost time: 73.52857637405396
Epoch: 2, Steps: 18 | Train Loss: 1.075 Vali Loss: 2.352 Vali Acc: 0.510 Test Loss: 2.352 Test Acc: 0.510
Validation loss decreased (-0.469980 --> -0.509976).  Saving model ...
Epoch: 3 cost time: 69.89864468574524
Epoch: 3, Steps: 18 | Train Loss: 0.813 Vali Loss: 3.346 Vali Acc: 0.550 Test Loss: 3.346 Test Acc: 0.550
Validation loss decreased (-0.509976 --> -0.549967).  Saving model ...
Epoch: 4 cost time: 75.65933060646057
Epoch: 4, Steps: 18 | Train Loss: 1.392 Vali Loss: 3.570 Vali Acc: 0.450 Test Loss: 3.570 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 66.65308928489685
Epoch: 5, Steps: 18 | Train Loss: 0.979 Vali Loss: 2.195 Vali Acc: 0.480 Test Loss: 2.195 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 71.04329824447632
Epoch: 6, Steps: 18 | Train Loss: 0.784 Vali Loss: 6.243 Vali Acc: 0.550 Test Loss: 6.243 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 69.58197855949402
Epoch: 7, Steps: 18 | Train Loss: 2.383 Vali Loss: 3.448 Vali Acc: 0.570 Test Loss: 3.448 Test Acc: 0.570
Validation loss decreased (-0.549967 --> -0.569966).  Saving model ...
Epoch: 8 cost time: 89.5220799446106
Epoch: 8, Steps: 18 | Train Loss: 1.814 Vali Loss: 3.686 Vali Acc: 0.560 Test Loss: 3.686 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 90.68468046188354
Epoch: 9, Steps: 18 | Train Loss: 0.916 Vali Loss: 8.294 Vali Acc: 0.480 Test Loss: 8.294 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 87.20155310630798
Epoch: 10, Steps: 18 | Train Loss: 1.541 Vali Loss: 5.223 Vali Acc: 0.490 Test Loss: 5.223 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 88.99559998512268
Epoch: 11, Steps: 18 | Train Loss: 1.146 Vali Loss: 6.125 Vali Acc: 0.520 Test Loss: 6.125 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 82.30124878883362
Epoch: 12, Steps: 18 | Train Loss: 0.887 Vali Loss: 6.362 Vali Acc: 0.550 Test Loss: 6.362 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 87.62586879730225
Epoch: 13, Steps: 18 | Train Loss: 4.006 Vali Loss: 23.709 Vali Acc: 0.510 Test Loss: 23.709 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 89.3063063621521
Epoch: 14, Steps: 18 | Train Loss: 3.039 Vali Loss: 8.761 Vali Acc: 0.550 Test Loss: 8.761 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 87.28012323379517
Epoch: 15, Steps: 18 | Train Loss: 3.267 Vali Loss: 20.945 Vali Acc: 0.530 Test Loss: 20.945 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 90.44021439552307
Epoch: 16, Steps: 18 | Train Loss: 3.069 Vali Loss: 10.653 Vali Acc: 0.550 Test Loss: 10.653 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 81.20900559425354
Epoch: 17, Steps: 18 | Train Loss: 0.772 Vali Loss: 6.934 Vali Acc: 0.590 Test Loss: 6.934 Test Acc: 0.590
Validation loss decreased (-0.569966 --> -0.589931).  Saving model ...
Epoch: 18 cost time: 30.079911708831787
Epoch: 18, Steps: 18 | Train Loss: 2.047 Vali Loss: 11.266 Vali Acc: 0.550 Test Loss: 11.266 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 35.0907666683197
Epoch: 19, Steps: 18 | Train Loss: 1.352 Vali Loss: 16.070 Vali Acc: 0.490 Test Loss: 16.070 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 35.07876920700073
Epoch: 20, Steps: 18 | Train Loss: 1.436 Vali Loss: 34.753 Vali Acc: 0.510 Test Loss: 34.753 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 34.789894819259644
Epoch: 21, Steps: 18 | Train Loss: 0.722 Vali Loss: 17.023 Vali Acc: 0.470 Test Loss: 17.023 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 33.494213342666626
Epoch: 22, Steps: 18 | Train Loss: 0.205 Vali Loss: 14.346 Vali Acc: 0.530 Test Loss: 14.346 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 33.42621445655823
Epoch: 23, Steps: 18 | Train Loss: 0.703 Vali Loss: 13.862 Vali Acc: 0.490 Test Loss: 13.862 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 33.78970003128052
Epoch: 24, Steps: 18 | Train Loss: 0.381 Vali Loss: 23.298 Vali Acc: 0.520 Test Loss: 23.298 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 28.119390964508057
Epoch: 25, Steps: 18 | Train Loss: 0.564 Vali Loss: 27.949 Vali Acc: 0.510 Test Loss: 27.949 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 32.9096794128418
Epoch: 26, Steps: 18 | Train Loss: 1.102 Vali Loss: 18.798 Vali Acc: 0.550 Test Loss: 18.798 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 34.78220057487488
Epoch: 27, Steps: 18 | Train Loss: 0.190 Vali Loss: 16.361 Vali Acc: 0.470 Test Loss: 16.361 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9053954
model size : 37.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 44.84656596183777
Epoch: 1, Steps: 18 | Train Loss: 0.906 Vali Loss: 0.849 Vali Acc: 0.510 Test Loss: 0.849 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 53.55126595497131
Epoch: 2, Steps: 18 | Train Loss: 0.937 Vali Loss: 1.653 Vali Acc: 0.600 Test Loss: 1.653 Test Acc: 0.600
Validation loss decreased (-0.509992 --> -0.599983).  Saving model ...
Epoch: 3 cost time: 137.31813192367554
Epoch: 3, Steps: 18 | Train Loss: 0.835 Vali Loss: 1.159 Vali Acc: 0.490 Test Loss: 1.159 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 125.86390733718872
Epoch: 4, Steps: 18 | Train Loss: 1.031 Vali Loss: 1.887 Vali Acc: 0.470 Test Loss: 1.887 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 128.24905467033386
Epoch: 5, Steps: 18 | Train Loss: 0.888 Vali Loss: 2.281 Vali Acc: 0.520 Test Loss: 2.281 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 118.61212515830994
Epoch: 6, Steps: 18 | Train Loss: 1.078 Vali Loss: 5.359 Vali Acc: 0.500 Test Loss: 5.359 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 122.80621814727783
Epoch: 7, Steps: 18 | Train Loss: 1.356 Vali Loss: 6.110 Vali Acc: 0.470 Test Loss: 6.110 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 124.05893874168396
Epoch: 8, Steps: 18 | Train Loss: 0.795 Vali Loss: 6.707 Vali Acc: 0.520 Test Loss: 6.707 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 128.95221734046936
Epoch: 9, Steps: 18 | Train Loss: 1.464 Vali Loss: 5.325 Vali Acc: 0.530 Test Loss: 5.325 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 135.32452774047852
Epoch: 10, Steps: 18 | Train Loss: 0.550 Vali Loss: 4.819 Vali Acc: 0.560 Test Loss: 4.819 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 132.57421374320984
Epoch: 11, Steps: 18 | Train Loss: 1.053 Vali Loss: 7.594 Vali Acc: 0.510 Test Loss: 7.594 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 133.53137469291687
Epoch: 12, Steps: 18 | Train Loss: 3.209 Vali Loss: 8.084 Vali Acc: 0.600 Test Loss: 8.084 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 28912898
model size : 112.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 54.25823163986206
Epoch: 1, Steps: 18 | Train Loss: 1.054 Vali Loss: 2.019 Vali Acc: 0.460 Test Loss: 2.019 Test Acc: 0.460
Validation loss decreased (inf --> -0.459980).  Saving model ...
Epoch: 2 cost time: 48.96314454078674
Epoch: 2, Steps: 18 | Train Loss: 1.082 Vali Loss: 2.401 Vali Acc: 0.510 Test Loss: 2.401 Test Acc: 0.510
Validation loss decreased (-0.459980 --> -0.509976).  Saving model ...
Epoch: 3 cost time: 45.88084840774536
Epoch: 3, Steps: 18 | Train Loss: 0.845 Vali Loss: 2.058 Vali Acc: 0.580 Test Loss: 2.058 Test Acc: 0.580
Validation loss decreased (-0.509976 --> -0.579979).  Saving model ...
Epoch: 4 cost time: 50.914713621139526
Epoch: 4, Steps: 18 | Train Loss: 1.265 Vali Loss: 4.292 Vali Acc: 0.470 Test Loss: 4.292 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 52.36108922958374
Epoch: 5, Steps: 18 | Train Loss: 1.857 Vali Loss: 3.671 Vali Acc: 0.480 Test Loss: 3.671 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 48.93049216270447
Epoch: 6, Steps: 18 | Train Loss: 1.669 Vali Loss: 2.447 Vali Acc: 0.480 Test Loss: 2.447 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 53.44327116012573
Epoch: 7, Steps: 18 | Train Loss: 1.594 Vali Loss: 3.930 Vali Acc: 0.510 Test Loss: 3.930 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 57.266329765319824
Epoch: 8, Steps: 18 | Train Loss: 1.629 Vali Loss: 4.930 Vali Acc: 0.540 Test Loss: 4.930 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 57.29568552970886
Epoch: 9, Steps: 18 | Train Loss: 1.576 Vali Loss: 15.320 Vali Acc: 0.500 Test Loss: 15.320 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 52.60106301307678
Epoch: 10, Steps: 18 | Train Loss: 1.354 Vali Loss: 7.983 Vali Acc: 0.490 Test Loss: 7.983 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 58.02125549316406
Epoch: 11, Steps: 18 | Train Loss: 0.819 Vali Loss: 12.524 Vali Acc: 0.490 Test Loss: 12.524 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 57.17365050315857
Epoch: 12, Steps: 18 | Train Loss: 1.437 Vali Loss: 5.476 Vali Acc: 0.490 Test Loss: 5.476 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 56.116623401641846
Epoch: 13, Steps: 18 | Train Loss: 1.425 Vali Loss: 8.997 Vali Acc: 0.500 Test Loss: 8.997 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 9053954
model size : 37.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 313.1552016735077
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 1.075 Vali Acc: 0.460 Test Loss: 1.075 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 310.45051407814026
Epoch: 2, Steps: 18 | Train Loss: 0.911 Vali Loss: 2.553 Vali Acc: 0.500 Test Loss: 2.553 Test Acc: 0.500
Validation loss decreased (-0.459989 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 298.2891323566437
Epoch: 3, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.923 Vali Acc: 0.590 Test Loss: 0.923 Test Acc: 0.590
Validation loss decreased (-0.499974 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 291.47345089912415
Epoch: 4, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.025 Vali Acc: 0.530 Test Loss: 1.025 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 264.02328753471375
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.773 Vali Acc: 0.480 Test Loss: 1.773 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 303.122549533844
Epoch: 6, Steps: 18 | Train Loss: 1.178 Vali Loss: 2.082 Vali Acc: 0.530 Test Loss: 2.082 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 285.3421268463135
Epoch: 7, Steps: 18 | Train Loss: 1.303 Vali Loss: 1.704 Vali Acc: 0.550 Test Loss: 1.704 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 260.8972547054291
Epoch: 8, Steps: 18 | Train Loss: 1.317 Vali Loss: 6.725 Vali Acc: 0.490 Test Loss: 6.725 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 292.84635639190674
Epoch: 9, Steps: 18 | Train Loss: 0.704 Vali Loss: 2.322 Vali Acc: 0.540 Test Loss: 2.322 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 297.5261781215668
Epoch: 10, Steps: 18 | Train Loss: 0.372 Vali Loss: 4.879 Vali Acc: 0.550 Test Loss: 4.879 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 271.38759112358093
Epoch: 11, Steps: 18 | Train Loss: 0.461 Vali Loss: 3.625 Vali Acc: 0.510 Test Loss: 3.625 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 277.61705493927
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 4.363 Vali Acc: 0.500 Test Loss: 4.363 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 305.7662649154663
Epoch: 13, Steps: 18 | Train Loss: 0.806 Vali Loss: 3.621 Vali Acc: 0.500 Test Loss: 3.621 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28517378
model size : 110.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 98.71879529953003
Epoch: 1, Steps: 18 | Train Loss: 0.930 Vali Loss: 0.828 Vali Acc: 0.490 Test Loss: 0.828 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 113.70131707191467
Epoch: 2, Steps: 18 | Train Loss: 1.124 Vali Loss: 1.801 Vali Acc: 0.460 Test Loss: 1.801 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 117.13039040565491
Epoch: 3, Steps: 18 | Train Loss: 0.780 Vali Loss: 1.156 Vali Acc: 0.490 Test Loss: 1.156 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 120.29348921775818
Epoch: 4, Steps: 18 | Train Loss: 0.680 Vali Loss: 1.187 Vali Acc: 0.490 Test Loss: 1.187 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 120.64364218711853
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 2.372 Vali Acc: 0.540 Test Loss: 2.372 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539976).  Saving model ...
Epoch: 6 cost time: 120.07286882400513
Epoch: 6, Steps: 18 | Train Loss: 0.495 Vali Loss: 2.639 Vali Acc: 0.510 Test Loss: 2.639 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 120.65058732032776
Epoch: 7, Steps: 18 | Train Loss: 0.718 Vali Loss: 2.524 Vali Acc: 0.450 Test Loss: 2.524 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 116.30331683158875
Epoch: 8, Steps: 18 | Train Loss: 0.555 Vali Loss: 3.330 Vali Acc: 0.520 Test Loss: 3.330 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 111.0671079158783
Epoch: 9, Steps: 18 | Train Loss: 0.665 Vali Loss: 3.133 Vali Acc: 0.580 Test Loss: 3.133 Test Acc: 0.580
Validation loss decreased (-0.539976 --> -0.579969).  Saving model ...
Epoch: 10 cost time: 112.18258714675903
Epoch: 10, Steps: 18 | Train Loss: 1.005 Vali Loss: 4.342 Vali Acc: 0.550 Test Loss: 4.342 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 112.46670532226562
Epoch: 11, Steps: 18 | Train Loss: 0.484 Vali Loss: 3.262 Vali Acc: 0.490 Test Loss: 3.262 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 121.61469268798828
Epoch: 12, Steps: 18 | Train Loss: 0.665 Vali Loss: 5.202 Vali Acc: 0.540 Test Loss: 5.202 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 123.12763404846191
Epoch: 13, Steps: 18 | Train Loss: 0.863 Vali Loss: 5.464 Vali Acc: 0.540 Test Loss: 5.464 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 122.27950882911682
Epoch: 14, Steps: 18 | Train Loss: 0.560 Vali Loss: 7.593 Vali Acc: 0.500 Test Loss: 7.593 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 118.20823264122009
Epoch: 15, Steps: 18 | Train Loss: 0.550 Vali Loss: 5.405 Vali Acc: 0.550 Test Loss: 5.405 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 114.13078594207764
Epoch: 16, Steps: 18 | Train Loss: 0.223 Vali Loss: 4.123 Vali Acc: 0.450 Test Loss: 4.123 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 107.61607265472412
Epoch: 17, Steps: 18 | Train Loss: 0.257 Vali Loss: 5.119 Vali Acc: 0.520 Test Loss: 5.119 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 111.92005681991577
Epoch: 18, Steps: 18 | Train Loss: 0.427 Vali Loss: 14.240 Vali Acc: 0.500 Test Loss: 14.240 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 110.25385069847107
Epoch: 19, Steps: 18 | Train Loss: 0.462 Vali Loss: 6.810 Vali Acc: 0.510 Test Loss: 6.810 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8658050
model size : 34.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 241.44989347457886
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 1.075 Vali Acc: 0.460 Test Loss: 1.075 Test Acc: 0.460
Validation loss decreased (inf --> -0.459989).  Saving model ...
Epoch: 2 cost time: 227.8009283542633
Epoch: 2, Steps: 18 | Train Loss: 0.911 Vali Loss: 2.553 Vali Acc: 0.500 Test Loss: 2.553 Test Acc: 0.500
Validation loss decreased (-0.459989 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 200.3452262878418
Epoch: 3, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.923 Vali Acc: 0.590 Test Loss: 0.923 Test Acc: 0.590
Validation loss decreased (-0.499974 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 205.32324957847595
Epoch: 4, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.025 Vali Acc: 0.530 Test Loss: 1.025 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 222.48800206184387
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.774 Vali Acc: 0.480 Test Loss: 1.774 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 231.53219556808472
Epoch: 6, Steps: 18 | Train Loss: 1.179 Vali Loss: 2.084 Vali Acc: 0.540 Test Loss: 2.084 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 235.98210287094116
Epoch: 7, Steps: 18 | Train Loss: 1.337 Vali Loss: 1.681 Vali Acc: 0.550 Test Loss: 1.681 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 226.79586815834045
Epoch: 8, Steps: 18 | Train Loss: 1.051 Vali Loss: 2.384 Vali Acc: 0.450 Test Loss: 2.384 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 242.30022549629211
Epoch: 9, Steps: 18 | Train Loss: 0.443 Vali Loss: 2.233 Vali Acc: 0.480 Test Loss: 2.233 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 239.08021450042725
Epoch: 10, Steps: 18 | Train Loss: 0.367 Vali Loss: 3.096 Vali Acc: 0.460 Test Loss: 3.096 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 218.7909836769104
Epoch: 11, Steps: 18 | Train Loss: 0.499 Vali Loss: 5.791 Vali Acc: 0.500 Test Loss: 5.791 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 224.4103810787201
Epoch: 12, Steps: 18 | Train Loss: 0.236 Vali Loss: 4.133 Vali Acc: 0.490 Test Loss: 4.133 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 237.86610627174377
Epoch: 13, Steps: 18 | Train Loss: 0.211 Vali Loss: 6.313 Vali Acc: 0.480 Test Loss: 6.313 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28517378
model size : 110.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 80.3079662322998
Epoch: 1, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 93.6075508594513
Epoch: 2, Steps: 18 | Train Loss: 1.128 Vali Loss: 1.807 Vali Acc: 0.460 Test Loss: 1.807 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 91.11498284339905
Epoch: 3, Steps: 18 | Train Loss: 0.911 Vali Loss: 1.174 Vali Acc: 0.540 Test Loss: 1.174 Test Acc: 0.540
Validation loss decreased (-0.479992 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 98.66296434402466
Epoch: 4, Steps: 18 | Train Loss: 0.738 Vali Loss: 1.607 Vali Acc: 0.500 Test Loss: 1.607 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 89.81375646591187
Epoch: 5, Steps: 18 | Train Loss: 0.425 Vali Loss: 2.630 Vali Acc: 0.490 Test Loss: 2.630 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 88.8069519996643
Epoch: 6, Steps: 18 | Train Loss: 0.736 Vali Loss: 3.015 Vali Acc: 0.490 Test Loss: 3.015 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 81.26783871650696
Epoch: 7, Steps: 18 | Train Loss: 1.042 Vali Loss: 2.511 Vali Acc: 0.510 Test Loss: 2.511 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 88.11563110351562
Epoch: 8, Steps: 18 | Train Loss: 0.359 Vali Loss: 1.739 Vali Acc: 0.520 Test Loss: 1.739 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 95.31387639045715
Epoch: 9, Steps: 18 | Train Loss: 0.724 Vali Loss: 3.170 Vali Acc: 0.560 Test Loss: 3.170 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559968).  Saving model ...
Epoch: 10 cost time: 95.49718451499939
Epoch: 10, Steps: 18 | Train Loss: 0.718 Vali Loss: 4.812 Vali Acc: 0.500 Test Loss: 4.812 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 95.983806848526
Epoch: 11, Steps: 18 | Train Loss: 0.935 Vali Loss: 4.535 Vali Acc: 0.550 Test Loss: 4.535 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 82.8076319694519
Epoch: 12, Steps: 18 | Train Loss: 0.450 Vali Loss: 2.700 Vali Acc: 0.580 Test Loss: 2.700 Test Acc: 0.580
Validation loss decreased (-0.559968 --> -0.579973).  Saving model ...
Epoch: 13 cost time: 84.57056903839111
Epoch: 13, Steps: 18 | Train Loss: 0.379 Vali Loss: 3.760 Vali Acc: 0.510 Test Loss: 3.760 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 81.89982032775879
Epoch: 14, Steps: 18 | Train Loss: 0.155 Vali Loss: 5.093 Vali Acc: 0.510 Test Loss: 5.093 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 97.45539236068726
Epoch: 15, Steps: 18 | Train Loss: 0.752 Vali Loss: 4.615 Vali Acc: 0.440 Test Loss: 4.615 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 92.15005111694336
Epoch: 16, Steps: 18 | Train Loss: 0.383 Vali Loss: 4.471 Vali Acc: 0.510 Test Loss: 4.471 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 97.8285481929779
Epoch: 17, Steps: 18 | Train Loss: 0.848 Vali Loss: 5.066 Vali Acc: 0.550 Test Loss: 5.066 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 79.67942333221436
Epoch: 18, Steps: 18 | Train Loss: 0.216 Vali Loss: 5.726 Vali Acc: 0.550 Test Loss: 5.726 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 86.55435037612915
Epoch: 19, Steps: 18 | Train Loss: 0.150 Vali Loss: 6.873 Vali Acc: 0.440 Test Loss: 6.873 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 81.0636715888977
Epoch: 20, Steps: 18 | Train Loss: 1.379 Vali Loss: 5.847 Vali Acc: 0.490 Test Loss: 5.847 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 97.41499733924866
Epoch: 21, Steps: 18 | Train Loss: 0.621 Vali Loss: 6.889 Vali Acc: 0.530 Test Loss: 6.889 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 95.07268214225769
Epoch: 22, Steps: 18 | Train Loss: 0.347 Vali Loss: 4.406 Vali Acc: 0.520 Test Loss: 4.406 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8658050
model size : 34.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 129.79972887039185
Epoch: 1, Steps: 18 | Train Loss: 0.799 Vali Loss: 1.065 Vali Acc: 0.470 Test Loss: 1.065 Test Acc: 0.470
Validation loss decreased (inf --> -0.469989).  Saving model ...
Epoch: 2 cost time: 126.46682572364807
Epoch: 2, Steps: 18 | Train Loss: 0.902 Vali Loss: 2.529 Vali Acc: 0.500 Test Loss: 2.529 Test Acc: 0.500
Validation loss decreased (-0.469989 --> -0.499975).  Saving model ...
Epoch: 3 cost time: 142.69833064079285
Epoch: 3, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.834 Vali Acc: 0.590 Test Loss: 0.834 Test Acc: 0.590
Validation loss decreased (-0.499975 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 149.63094091415405
Epoch: 4, Steps: 18 | Train Loss: 0.650 Vali Loss: 3.045 Vali Acc: 0.520 Test Loss: 3.045 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 136.15507626533508
Epoch: 5, Steps: 18 | Train Loss: 1.039 Vali Loss: 1.473 Vali Acc: 0.560 Test Loss: 1.473 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 118.71412324905396
Epoch: 6, Steps: 18 | Train Loss: 0.650 Vali Loss: 4.495 Vali Acc: 0.460 Test Loss: 4.495 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 134.65161442756653
Epoch: 7, Steps: 18 | Train Loss: 0.621 Vali Loss: 3.079 Vali Acc: 0.430 Test Loss: 3.079 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 146.1124391555786
Epoch: 8, Steps: 18 | Train Loss: 0.850 Vali Loss: 2.418 Vali Acc: 0.490 Test Loss: 2.418 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 137.96388459205627
Epoch: 9, Steps: 18 | Train Loss: 0.662 Vali Loss: 5.911 Vali Acc: 0.490 Test Loss: 5.911 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 106.32980370521545
Epoch: 10, Steps: 18 | Train Loss: 0.411 Vali Loss: 2.579 Vali Acc: 0.520 Test Loss: 2.579 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 120.9536304473877
Epoch: 11, Steps: 18 | Train Loss: 0.389 Vali Loss: 3.805 Vali Acc: 0.480 Test Loss: 3.805 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 135.1078658103943
Epoch: 12, Steps: 18 | Train Loss: 0.564 Vali Loss: 2.788 Vali Acc: 0.530 Test Loss: 2.788 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 124.74848055839539
Epoch: 13, Steps: 18 | Train Loss: 0.652 Vali Loss: 3.147 Vali Acc: 0.500 Test Loss: 3.147 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 28517378
model size : 110.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 46.0918242931366
Epoch: 1, Steps: 18 | Train Loss: 0.930 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 46.462913274765015
Epoch: 2, Steps: 18 | Train Loss: 1.131 Vali Loss: 1.831 Vali Acc: 0.440 Test Loss: 1.831 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.93056297302246
Epoch: 3, Steps: 18 | Train Loss: 0.769 Vali Loss: 1.429 Vali Acc: 0.470 Test Loss: 1.429 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 52.85599184036255
Epoch: 4, Steps: 18 | Train Loss: 0.670 Vali Loss: 1.402 Vali Acc: 0.570 Test Loss: 1.402 Test Acc: 0.570
Validation loss decreased (-0.489992 --> -0.569986).  Saving model ...
Epoch: 5 cost time: 56.15441346168518
Epoch: 5, Steps: 18 | Train Loss: 0.624 Vali Loss: 2.751 Vali Acc: 0.560 Test Loss: 2.751 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 57.195385456085205
Epoch: 6, Steps: 18 | Train Loss: 0.482 Vali Loss: 3.551 Vali Acc: 0.520 Test Loss: 3.551 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 51.86547636985779
Epoch: 7, Steps: 18 | Train Loss: 1.032 Vali Loss: 1.736 Vali Acc: 0.460 Test Loss: 1.736 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 54.1804256439209
Epoch: 8, Steps: 18 | Train Loss: 0.355 Vali Loss: 3.319 Vali Acc: 0.450 Test Loss: 3.319 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 47.456218957901
Epoch: 9, Steps: 18 | Train Loss: 0.515 Vali Loss: 4.356 Vali Acc: 0.520 Test Loss: 4.356 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 44.980045557022095
Epoch: 10, Steps: 18 | Train Loss: 0.633 Vali Loss: 1.735 Vali Acc: 0.560 Test Loss: 1.735 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 49.190171003341675
Epoch: 11, Steps: 18 | Train Loss: 0.500 Vali Loss: 4.813 Vali Acc: 0.460 Test Loss: 4.813 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 42.5249719619751
Epoch: 12, Steps: 18 | Train Loss: 0.339 Vali Loss: 3.565 Vali Acc: 0.570 Test Loss: 3.565 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 55.877718925476074
Epoch: 13, Steps: 18 | Train Loss: 0.457 Vali Loss: 4.838 Vali Acc: 0.500 Test Loss: 4.838 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 51.36523938179016
Epoch: 14, Steps: 18 | Train Loss: 0.408 Vali Loss: 7.281 Vali Acc: 0.510 Test Loss: 7.281 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 8658050
model size : 34.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 152.01714396476746
Epoch: 1, Steps: 18 | Train Loss: 0.875 Vali Loss: 0.946 Vali Acc: 0.640 Test Loss: 0.946 Test Acc: 0.640
Validation loss decreased (inf --> -0.639991).  Saving model ...
Epoch: 2 cost time: 137.92163825035095
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 1.952 Vali Acc: 0.500 Test Loss: 1.952 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 145.04432034492493
Epoch: 3, Steps: 18 | Train Loss: 0.554 Vali Loss: 1.460 Vali Acc: 0.480 Test Loss: 1.460 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 159.39631843566895
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 3.018 Vali Acc: 0.490 Test Loss: 3.018 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 143.4237766265869
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.849 Vali Acc: 0.500 Test Loss: 1.849 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 133.11069750785828
Epoch: 6, Steps: 18 | Train Loss: 0.469 Vali Loss: 2.740 Vali Acc: 0.470 Test Loss: 2.740 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 158.61991119384766
Epoch: 7, Steps: 18 | Train Loss: 0.456 Vali Loss: 2.253 Vali Acc: 0.550 Test Loss: 2.253 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 155.58498907089233
Epoch: 8, Steps: 18 | Train Loss: 0.562 Vali Loss: 2.169 Vali Acc: 0.490 Test Loss: 2.169 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 139.33441829681396
Epoch: 9, Steps: 18 | Train Loss: 0.277 Vali Loss: 2.278 Vali Acc: 0.530 Test Loss: 2.278 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 145.1993064880371
Epoch: 10, Steps: 18 | Train Loss: 0.547 Vali Loss: 3.056 Vali Acc: 0.510 Test Loss: 3.056 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 174.2876935005188
Epoch: 11, Steps: 18 | Train Loss: 0.470 Vali Loss: 4.830 Vali Acc: 0.480 Test Loss: 4.830 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 14457602
model size : 56.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 60.638527631759644
Epoch: 1, Steps: 18 | Train Loss: 0.871 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
Validation loss decreased (inf --> -0.539989).  Saving model ...
Epoch: 2 cost time: 60.79558086395264
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 1.490 Vali Acc: 0.490 Test Loss: 1.490 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 58.94927978515625
Epoch: 3, Steps: 18 | Train Loss: 0.706 Vali Loss: 1.317 Vali Acc: 0.580 Test Loss: 1.317 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579987).  Saving model ...
Epoch: 4 cost time: 63.70065116882324
Epoch: 4, Steps: 18 | Train Loss: 0.520 Vali Loss: 2.391 Vali Acc: 0.530 Test Loss: 2.391 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 68.6357913017273
Epoch: 5, Steps: 18 | Train Loss: 0.998 Vali Loss: 2.390 Vali Acc: 0.540 Test Loss: 2.390 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 69.54973888397217
Epoch: 6, Steps: 18 | Train Loss: 0.982 Vali Loss: 1.761 Vali Acc: 0.540 Test Loss: 1.761 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 69.31367659568787
Epoch: 7, Steps: 18 | Train Loss: 0.754 Vali Loss: 3.254 Vali Acc: 0.540 Test Loss: 3.254 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 70.43618249893188
Epoch: 8, Steps: 18 | Train Loss: 0.953 Vali Loss: 5.342 Vali Acc: 0.500 Test Loss: 5.342 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 63.87273406982422
Epoch: 9, Steps: 18 | Train Loss: 1.448 Vali Loss: 2.788 Vali Acc: 0.540 Test Loss: 2.788 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 60.527491331100464
Epoch: 10, Steps: 18 | Train Loss: 0.503 Vali Loss: 3.589 Vali Acc: 0.480 Test Loss: 3.589 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 64.16994547843933
Epoch: 11, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.625 Vali Acc: 0.510 Test Loss: 2.625 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 55.31462073326111
Epoch: 12, Steps: 18 | Train Loss: 0.610 Vali Loss: 3.835 Vali Acc: 0.520 Test Loss: 3.835 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 68.91551113128662
Epoch: 13, Steps: 18 | Train Loss: 0.920 Vali Loss: 3.649 Vali Acc: 0.460 Test Loss: 3.649 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 4527746
model size : 18.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 139.66808438301086
Epoch: 1, Steps: 18 | Train Loss: 0.875 Vali Loss: 0.946 Vali Acc: 0.640 Test Loss: 0.946 Test Acc: 0.640
Validation loss decreased (inf --> -0.639991).  Saving model ...
Epoch: 2 cost time: 138.6688039302826
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 1.952 Vali Acc: 0.500 Test Loss: 1.952 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 124.21308183670044
Epoch: 3, Steps: 18 | Train Loss: 0.554 Vali Loss: 1.460 Vali Acc: 0.480 Test Loss: 1.460 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 119.62859296798706
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 3.018 Vali Acc: 0.490 Test Loss: 3.018 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 131.84489583969116
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.849 Vali Acc: 0.500 Test Loss: 1.849 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 137.86067867279053
Epoch: 6, Steps: 18 | Train Loss: 0.470 Vali Loss: 2.736 Vali Acc: 0.480 Test Loss: 2.736 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 128.00070810317993
Epoch: 7, Steps: 18 | Train Loss: 0.408 Vali Loss: 2.558 Vali Acc: 0.530 Test Loss: 2.558 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 117.23364996910095
Epoch: 8, Steps: 18 | Train Loss: 0.500 Vali Loss: 3.275 Vali Acc: 0.500 Test Loss: 3.275 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 125.44735598564148
Epoch: 9, Steps: 18 | Train Loss: 0.223 Vali Loss: 2.796 Vali Acc: 0.520 Test Loss: 2.796 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 135.99147653579712
Epoch: 10, Steps: 18 | Train Loss: 0.588 Vali Loss: 8.234 Vali Acc: 0.500 Test Loss: 8.234 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 130.68294167518616
Epoch: 11, Steps: 18 | Train Loss: 1.037 Vali Loss: 4.550 Vali Acc: 0.510 Test Loss: 4.550 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 14457602
model size : 56.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 51.12410116195679
Epoch: 1, Steps: 18 | Train Loss: 0.871 Vali Loss: 1.115 Vali Acc: 0.530 Test Loss: 1.115 Test Acc: 0.530
Validation loss decreased (inf --> -0.529989).  Saving model ...
Epoch: 2 cost time: 41.877021074295044
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.549 Vali Acc: 0.490 Test Loss: 1.549 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 37.507187366485596
Epoch: 3, Steps: 18 | Train Loss: 0.740 Vali Loss: 1.537 Vali Acc: 0.570 Test Loss: 1.537 Test Acc: 0.570
Validation loss decreased (-0.529989 --> -0.569985).  Saving model ...
Epoch: 4 cost time: 50.125091791152954
Epoch: 4, Steps: 18 | Train Loss: 0.857 Vali Loss: 2.039 Vali Acc: 0.600 Test Loss: 2.039 Test Acc: 0.600
Validation loss decreased (-0.569985 --> -0.599980).  Saving model ...
Epoch: 5 cost time: 52.74390435218811
Epoch: 5, Steps: 18 | Train Loss: 0.944 Vali Loss: 1.612 Vali Acc: 0.580 Test Loss: 1.612 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 50.41030287742615
Epoch: 6, Steps: 18 | Train Loss: 0.643 Vali Loss: 2.186 Vali Acc: 0.520 Test Loss: 2.186 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 48.25771355628967
Epoch: 7, Steps: 18 | Train Loss: 0.532 Vali Loss: 1.539 Vali Acc: 0.580 Test Loss: 1.539 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 50.564881324768066
Epoch: 8, Steps: 18 | Train Loss: 0.629 Vali Loss: 1.908 Vali Acc: 0.500 Test Loss: 1.908 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 41.32084918022156
Epoch: 9, Steps: 18 | Train Loss: 0.377 Vali Loss: 3.159 Vali Acc: 0.530 Test Loss: 3.159 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 38.91852402687073
Epoch: 10, Steps: 18 | Train Loss: 0.584 Vali Loss: 3.792 Vali Acc: 0.550 Test Loss: 3.792 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 43.050427198410034
Epoch: 11, Steps: 18 | Train Loss: 0.385 Vali Loss: 3.431 Vali Acc: 0.510 Test Loss: 3.431 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 38.740140438079834
Epoch: 12, Steps: 18 | Train Loss: 0.322 Vali Loss: 4.006 Vali Acc: 0.500 Test Loss: 4.006 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 39.657490253448486
Epoch: 13, Steps: 18 | Train Loss: 0.458 Vali Loss: 3.544 Vali Acc: 0.530 Test Loss: 3.544 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 49.6387894153595
Epoch: 14, Steps: 18 | Train Loss: 0.470 Vali Loss: 4.038 Vali Acc: 0.490 Test Loss: 4.038 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4527746
model size : 18.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 76.60423278808594
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.947 Vali Acc: 0.640 Test Loss: 0.947 Test Acc: 0.640
Validation loss decreased (inf --> -0.639991).  Saving model ...
Epoch: 2 cost time: 73.15066123008728
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 64.42638731002808
Epoch: 3, Steps: 18 | Train Loss: 0.563 Vali Loss: 1.721 Vali Acc: 0.510 Test Loss: 1.721 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 61.99531149864197
Epoch: 4, Steps: 18 | Train Loss: 0.721 Vali Loss: 4.695 Vali Acc: 0.510 Test Loss: 4.695 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 59.680925369262695
Epoch: 5, Steps: 18 | Train Loss: 0.827 Vali Loss: 1.858 Vali Acc: 0.540 Test Loss: 1.858 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 65.1436562538147
Epoch: 6, Steps: 18 | Train Loss: 0.845 Vali Loss: 2.471 Vali Acc: 0.550 Test Loss: 2.471 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 71.92588090896606
Epoch: 7, Steps: 18 | Train Loss: 0.805 Vali Loss: 2.366 Vali Acc: 0.570 Test Loss: 2.366 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 71.7243287563324
Epoch: 8, Steps: 18 | Train Loss: 0.806 Vali Loss: 3.456 Vali Acc: 0.650 Test Loss: 3.456 Test Acc: 0.650
Validation loss decreased (-0.639991 --> -0.649965).  Saving model ...
Epoch: 9 cost time: 69.91850352287292
Epoch: 9, Steps: 18 | Train Loss: 0.483 Vali Loss: 2.471 Vali Acc: 0.500 Test Loss: 2.471 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 56.922369718551636
Epoch: 10, Steps: 18 | Train Loss: 0.399 Vali Loss: 3.569 Vali Acc: 0.530 Test Loss: 3.569 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 58.60874700546265
Epoch: 11, Steps: 18 | Train Loss: 0.502 Vali Loss: 2.769 Vali Acc: 0.520 Test Loss: 2.769 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 57.745020389556885
Epoch: 12, Steps: 18 | Train Loss: 0.399 Vali Loss: 2.996 Vali Acc: 0.550 Test Loss: 2.996 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 60.90138506889343
Epoch: 13, Steps: 18 | Train Loss: 0.750 Vali Loss: 6.348 Vali Acc: 0.500 Test Loss: 6.348 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 73.33697772026062
Epoch: 14, Steps: 18 | Train Loss: 0.504 Vali Loss: 3.762 Vali Acc: 0.580 Test Loss: 3.762 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 73.57205820083618
Epoch: 15, Steps: 18 | Train Loss: 0.453 Vali Loss: 3.740 Vali Acc: 0.530 Test Loss: 3.740 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 66.98323345184326
Epoch: 16, Steps: 18 | Train Loss: 0.216 Vali Loss: 10.693 Vali Acc: 0.520 Test Loss: 10.693 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 71.24299192428589
Epoch: 17, Steps: 18 | Train Loss: 0.368 Vali Loss: 4.434 Vali Acc: 0.560 Test Loss: 4.434 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 63.29244637489319
Epoch: 18, Steps: 18 | Train Loss: 0.345 Vali Loss: 4.868 Vali Acc: 0.490 Test Loss: 4.868 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 14457602
model size : 56.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.389058351516724
Epoch: 1, Steps: 18 | Train Loss: 0.870 Vali Loss: 1.117 Vali Acc: 0.530 Test Loss: 1.117 Test Acc: 0.530
Validation loss decreased (inf --> -0.529989).  Saving model ...
Epoch: 2 cost time: 33.78554153442383
Epoch: 2, Steps: 18 | Train Loss: 0.720 Vali Loss: 1.544 Vali Acc: 0.490 Test Loss: 1.544 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.142948150634766
Epoch: 3, Steps: 18 | Train Loss: 0.747 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
Validation loss decreased (-0.529989 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 34.44482374191284
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 2.813 Vali Acc: 0.520 Test Loss: 2.813 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.680564641952515
Epoch: 5, Steps: 18 | Train Loss: 0.826 Vali Loss: 1.332 Vali Acc: 0.540 Test Loss: 1.332 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 31.146623611450195
Epoch: 6, Steps: 18 | Train Loss: 0.398 Vali Loss: 1.757 Vali Acc: 0.440 Test Loss: 1.757 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 33.84787344932556
Epoch: 7, Steps: 18 | Train Loss: 0.425 Vali Loss: 3.031 Vali Acc: 0.600 Test Loss: 3.031 Test Acc: 0.600
Validation loss decreased (-0.549985 --> -0.599970).  Saving model ...
Epoch: 8 cost time: 27.00966715812683
Epoch: 8, Steps: 18 | Train Loss: 0.404 Vali Loss: 3.676 Vali Acc: 0.520 Test Loss: 3.676 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.201492309570312
Epoch: 9, Steps: 18 | Train Loss: 1.156 Vali Loss: 4.202 Vali Acc: 0.460 Test Loss: 4.202 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 28.542322874069214
Epoch: 10, Steps: 18 | Train Loss: 0.426 Vali Loss: 2.848 Vali Acc: 0.480 Test Loss: 2.848 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.44792604446411
Epoch: 11, Steps: 18 | Train Loss: 0.942 Vali Loss: 5.169 Vali Acc: 0.520 Test Loss: 5.169 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 27.027518272399902
Epoch: 12, Steps: 18 | Train Loss: 0.612 Vali Loss: 4.361 Vali Acc: 0.520 Test Loss: 4.361 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 25.271994829177856
Epoch: 13, Steps: 18 | Train Loss: 0.993 Vali Loss: 4.273 Vali Acc: 0.500 Test Loss: 4.273 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 25.340394735336304
Epoch: 14, Steps: 18 | Train Loss: 0.708 Vali Loss: 4.376 Vali Acc: 0.550 Test Loss: 4.376 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 27.30228543281555
Epoch: 15, Steps: 18 | Train Loss: 0.413 Vali Loss: 5.791 Vali Acc: 0.410 Test Loss: 5.791 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 24.55766749382019
Epoch: 16, Steps: 18 | Train Loss: 0.426 Vali Loss: 4.932 Vali Acc: 0.410 Test Loss: 4.932 Test Acc: 0.410
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 34.315969944000244
Epoch: 17, Steps: 18 | Train Loss: 0.232 Vali Loss: 5.505 Vali Acc: 0.530 Test Loss: 5.505 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 4527746
model size : 18.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 105.80858135223389
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 1.046 Vali Acc: 0.450 Test Loss: 1.046 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 87.5012891292572
Epoch: 2, Steps: 18 | Train Loss: 0.847 Vali Loss: 1.089 Vali Acc: 0.490 Test Loss: 1.089 Test Acc: 0.490
Validation loss decreased (-0.449990 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 82.5615656375885
Epoch: 3, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
Validation loss decreased (-0.489989 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 86.45976495742798
Epoch: 4, Steps: 18 | Train Loss: 0.468 Vali Loss: 0.939 Vali Acc: 0.570 Test Loss: 0.939 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 106.2409782409668
Epoch: 5, Steps: 18 | Train Loss: 0.624 Vali Loss: 1.166 Vali Acc: 0.570 Test Loss: 1.166 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 105.19807887077332
Epoch: 6, Steps: 18 | Train Loss: 0.556 Vali Loss: 1.784 Vali Acc: 0.550 Test Loss: 1.784 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 93.45566654205322
Epoch: 7, Steps: 18 | Train Loss: 0.479 Vali Loss: 4.035 Vali Acc: 0.520 Test Loss: 4.035 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 76.93521475791931
Epoch: 8, Steps: 18 | Train Loss: 0.606 Vali Loss: 1.991 Vali Acc: 0.520 Test Loss: 1.991 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 77.40766334533691
Epoch: 9, Steps: 18 | Train Loss: 0.538 Vali Loss: 5.591 Vali Acc: 0.520 Test Loss: 5.591 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 81.38663673400879
Epoch: 10, Steps: 18 | Train Loss: 0.617 Vali Loss: 2.656 Vali Acc: 0.550 Test Loss: 2.656 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 97.00845289230347
Epoch: 11, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.076 Vali Acc: 0.630 Test Loss: 2.076 Test Acc: 0.630
Validation loss decreased (-0.569991 --> -0.629979).  Saving model ...
Epoch: 12 cost time: 91.55592465400696
Epoch: 12, Steps: 18 | Train Loss: 0.444 Vali Loss: 4.000 Vali Acc: 0.530 Test Loss: 4.000 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 86.20979952812195
Epoch: 13, Steps: 18 | Train Loss: 0.682 Vali Loss: 2.718 Vali Acc: 0.550 Test Loss: 2.718 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 79.6439836025238
Epoch: 14, Steps: 18 | Train Loss: 0.447 Vali Loss: 3.773 Vali Acc: 0.580 Test Loss: 3.773 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 77.20926713943481
Epoch: 15, Steps: 18 | Train Loss: 0.351 Vali Loss: 4.001 Vali Acc: 0.560 Test Loss: 4.001 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 86.57832860946655
Epoch: 16, Steps: 18 | Train Loss: 0.628 Vali Loss: 5.066 Vali Acc: 0.540 Test Loss: 5.066 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 91.78036832809448
Epoch: 17, Steps: 18 | Train Loss: 0.339 Vali Loss: 4.223 Vali Acc: 0.490 Test Loss: 4.223 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 93.85780882835388
Epoch: 18, Steps: 18 | Train Loss: 0.085 Vali Loss: 3.778 Vali Acc: 0.590 Test Loss: 3.778 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 80.9311945438385
Epoch: 19, Steps: 18 | Train Loss: 0.450 Vali Loss: 5.928 Vali Acc: 0.600 Test Loss: 5.928 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 79.46116924285889
Epoch: 20, Steps: 18 | Train Loss: 1.221 Vali Loss: 10.002 Vali Acc: 0.530 Test Loss: 10.002 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 71.09155559539795
Epoch: 21, Steps: 18 | Train Loss: 1.255 Vali Loss: 5.199 Vali Acc: 0.550 Test Loss: 5.199 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 7427714
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 41.55502986907959
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 0.775 Vali Acc: 0.680 Test Loss: 0.775 Test Acc: 0.680
Validation loss decreased (inf --> -0.679992).  Saving model ...
Epoch: 2 cost time: 43.63216972351074
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 1.528 Vali Acc: 0.470 Test Loss: 1.528 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 44.196738958358765
Epoch: 3, Steps: 18 | Train Loss: 0.881 Vali Loss: 1.634 Vali Acc: 0.600 Test Loss: 1.634 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 42.40826630592346
Epoch: 4, Steps: 18 | Train Loss: 0.987 Vali Loss: 1.264 Vali Acc: 0.640 Test Loss: 1.264 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 46.401050090789795
Epoch: 5, Steps: 18 | Train Loss: 0.490 Vali Loss: 1.624 Vali Acc: 0.470 Test Loss: 1.624 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 35.29223847389221
Epoch: 6, Steps: 18 | Train Loss: 0.716 Vali Loss: 1.839 Vali Acc: 0.540 Test Loss: 1.839 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 39.047370195388794
Epoch: 7, Steps: 18 | Train Loss: 0.548 Vali Loss: 2.303 Vali Acc: 0.570 Test Loss: 2.303 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 39.87089705467224
Epoch: 8, Steps: 18 | Train Loss: 0.726 Vali Loss: 4.547 Vali Acc: 0.520 Test Loss: 4.547 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 33.61752104759216
Epoch: 9, Steps: 18 | Train Loss: 0.751 Vali Loss: 4.038 Vali Acc: 0.560 Test Loss: 4.038 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 39.23413705825806
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 2.479 Vali Acc: 0.520 Test Loss: 2.479 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 35.98819851875305
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.883 Vali Acc: 0.540 Test Loss: 2.883 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.68
model parameter : 2462594
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 85.05609607696533
Epoch: 1, Steps: 18 | Train Loss: 0.823 Vali Loss: 1.046 Vali Acc: 0.450 Test Loss: 1.046 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 83.73072504997253
Epoch: 2, Steps: 18 | Train Loss: 0.848 Vali Loss: 1.096 Vali Acc: 0.490 Test Loss: 1.096 Test Acc: 0.490
Validation loss decreased (-0.449990 --> -0.489989).  Saving model ...
Epoch: 3 cost time: 79.23544263839722
Epoch: 3, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.910 Vali Acc: 0.550 Test Loss: 0.910 Test Acc: 0.550
Validation loss decreased (-0.489989 --> -0.549991).  Saving model ...
Epoch: 4 cost time: 70.82954430580139
Epoch: 4, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.954 Vali Acc: 0.550 Test Loss: 0.954 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 68.13795781135559
Epoch: 5, Steps: 18 | Train Loss: 0.618 Vali Loss: 1.275 Vali Acc: 0.540 Test Loss: 1.275 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 64.49970436096191
Epoch: 6, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.571 Vali Acc: 0.510 Test Loss: 1.571 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 74.40269565582275
Epoch: 7, Steps: 18 | Train Loss: 0.500 Vali Loss: 4.578 Vali Acc: 0.450 Test Loss: 4.578 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 72.79687976837158
Epoch: 8, Steps: 18 | Train Loss: 0.853 Vali Loss: 3.091 Vali Acc: 0.510 Test Loss: 3.091 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 82.26524257659912
Epoch: 9, Steps: 18 | Train Loss: 0.581 Vali Loss: 2.082 Vali Acc: 0.490 Test Loss: 2.082 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 79.29579496383667
Epoch: 10, Steps: 18 | Train Loss: 1.132 Vali Loss: 2.278 Vali Acc: 0.540 Test Loss: 2.278 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 67.88566637039185
Epoch: 11, Steps: 18 | Train Loss: 0.693 Vali Loss: 2.304 Vali Acc: 0.620 Test Loss: 2.304 Test Acc: 0.620
Validation loss decreased (-0.549991 --> -0.619977).  Saving model ...
Epoch: 12 cost time: 66.84662103652954
Epoch: 12, Steps: 18 | Train Loss: 0.476 Vali Loss: 2.252 Vali Acc: 0.610 Test Loss: 2.252 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 59.393184423446655
Epoch: 13, Steps: 18 | Train Loss: 1.364 Vali Loss: 2.931 Vali Acc: 0.510 Test Loss: 2.931 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 76.03547143936157
Epoch: 14, Steps: 18 | Train Loss: 0.302 Vali Loss: 7.388 Vali Acc: 0.430 Test Loss: 7.388 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 76.7198269367218
Epoch: 15, Steps: 18 | Train Loss: 0.286 Vali Loss: 8.099 Vali Acc: 0.520 Test Loss: 8.099 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 81.98145771026611
Epoch: 16, Steps: 18 | Train Loss: 0.833 Vali Loss: 7.003 Vali Acc: 0.490 Test Loss: 7.003 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 82.33415722846985
Epoch: 17, Steps: 18 | Train Loss: 1.034 Vali Loss: 4.696 Vali Acc: 0.520 Test Loss: 4.696 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 65.78009796142578
Epoch: 18, Steps: 18 | Train Loss: 0.893 Vali Loss: 4.744 Vali Acc: 0.550 Test Loss: 4.744 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 55.91849088668823
Epoch: 19, Steps: 18 | Train Loss: 0.459 Vali Loss: 4.347 Vali Acc: 0.590 Test Loss: 4.347 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 57.280794620513916
Epoch: 20, Steps: 18 | Train Loss: 0.392 Vali Loss: 4.877 Vali Acc: 0.560 Test Loss: 4.877 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 54.91935324668884
Epoch: 21, Steps: 18 | Train Loss: 0.710 Vali Loss: 4.161 Vali Acc: 0.570 Test Loss: 4.161 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 7427714
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.723856687545776
Epoch: 1, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.769 Vali Acc: 0.680 Test Loss: 0.769 Test Acc: 0.680
Validation loss decreased (inf --> -0.679992).  Saving model ...
Epoch: 2 cost time: 31.142615795135498
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.495 Vali Acc: 0.470 Test Loss: 1.495 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.822938442230225
Epoch: 3, Steps: 18 | Train Loss: 0.865 Vali Loss: 1.367 Vali Acc: 0.600 Test Loss: 1.367 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.459489822387695
Epoch: 4, Steps: 18 | Train Loss: 0.766 Vali Loss: 1.103 Vali Acc: 0.570 Test Loss: 1.103 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 28.441356897354126
Epoch: 5, Steps: 18 | Train Loss: 0.860 Vali Loss: 2.007 Vali Acc: 0.440 Test Loss: 2.007 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 31.883711576461792
Epoch: 6, Steps: 18 | Train Loss: 1.017 Vali Loss: 4.671 Vali Acc: 0.500 Test Loss: 4.671 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 25.566271543502808
Epoch: 7, Steps: 18 | Train Loss: 0.745 Vali Loss: 2.190 Vali Acc: 0.550 Test Loss: 2.190 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 24.66593861579895
Epoch: 8, Steps: 18 | Train Loss: 0.658 Vali Loss: 2.240 Vali Acc: 0.520 Test Loss: 2.240 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 24.652990579605103
Epoch: 9, Steps: 18 | Train Loss: 0.478 Vali Loss: 3.250 Vali Acc: 0.530 Test Loss: 3.250 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 20.14130139350891
Epoch: 10, Steps: 18 | Train Loss: 0.299 Vali Loss: 2.672 Vali Acc: 0.560 Test Loss: 2.672 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.707855463027954
Epoch: 11, Steps: 18 | Train Loss: 0.692 Vali Loss: 2.897 Vali Acc: 0.560 Test Loss: 2.897 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.68
model parameter : 2462594
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 48.39668250083923
Epoch: 1, Steps: 18 | Train Loss: 0.823 Vali Loss: 1.049 Vali Acc: 0.450 Test Loss: 1.049 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 42.690956830978394
Epoch: 2, Steps: 18 | Train Loss: 0.847 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
Validation loss decreased (-0.449990 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 44.35572791099548
Epoch: 3, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.909 Vali Acc: 0.560 Test Loss: 0.909 Test Acc: 0.560
Validation loss decreased (-0.499989 --> -0.559991).  Saving model ...
Epoch: 4 cost time: 45.68385696411133
Epoch: 4, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.927 Vali Acc: 0.570 Test Loss: 0.927 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 34.269479513168335
Epoch: 5, Steps: 18 | Train Loss: 0.635 Vali Loss: 1.176 Vali Acc: 0.560 Test Loss: 1.176 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 37.14288282394409
Epoch: 6, Steps: 18 | Train Loss: 0.601 Vali Loss: 3.438 Vali Acc: 0.530 Test Loss: 3.438 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.309434175491333
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.698 Vali Acc: 0.470 Test Loss: 1.698 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 35.934093713760376
Epoch: 8, Steps: 18 | Train Loss: 0.515 Vali Loss: 2.685 Vali Acc: 0.510 Test Loss: 2.685 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 40.10397529602051
Epoch: 9, Steps: 18 | Train Loss: 0.584 Vali Loss: 3.366 Vali Acc: 0.620 Test Loss: 3.366 Test Acc: 0.620
Validation loss decreased (-0.569991 --> -0.619966).  Saving model ...
Epoch: 10 cost time: 45.22692537307739
Epoch: 10, Steps: 18 | Train Loss: 0.505 Vali Loss: 2.703 Vali Acc: 0.560 Test Loss: 2.703 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 42.43138575553894
Epoch: 11, Steps: 18 | Train Loss: 0.440 Vali Loss: 2.304 Vali Acc: 0.540 Test Loss: 2.304 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 44.80075979232788
Epoch: 12, Steps: 18 | Train Loss: 0.604 Vali Loss: 5.702 Vali Acc: 0.520 Test Loss: 5.702 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 35.22559642791748
Epoch: 13, Steps: 18 | Train Loss: 0.848 Vali Loss: 7.362 Vali Acc: 0.530 Test Loss: 7.362 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 35.62873816490173
Epoch: 14, Steps: 18 | Train Loss: 1.196 Vali Loss: 4.505 Vali Acc: 0.510 Test Loss: 4.505 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 36.29159235954285
Epoch: 15, Steps: 18 | Train Loss: 0.238 Vali Loss: 4.459 Vali Acc: 0.510 Test Loss: 4.459 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 34.4557101726532
Epoch: 16, Steps: 18 | Train Loss: 0.562 Vali Loss: 4.661 Vali Acc: 0.490 Test Loss: 4.661 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 44.47095775604248
Epoch: 17, Steps: 18 | Train Loss: 0.352 Vali Loss: 5.983 Vali Acc: 0.520 Test Loss: 5.983 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 40.28214454650879
Epoch: 18, Steps: 18 | Train Loss: 0.280 Vali Loss: 3.899 Vali Acc: 0.570 Test Loss: 3.899 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 44.49748492240906
Epoch: 19, Steps: 18 | Train Loss: 0.214 Vali Loss: 9.367 Vali Acc: 0.500 Test Loss: 9.367 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 7427714
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 17.851282835006714
Epoch: 1, Steps: 18 | Train Loss: 0.837 Vali Loss: 0.770 Vali Acc: 0.680 Test Loss: 0.770 Test Acc: 0.680
Validation loss decreased (inf --> -0.679992).  Saving model ...
Epoch: 2 cost time: 15.160382509231567
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 1.511 Vali Acc: 0.470 Test Loss: 1.511 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.934754371643066
Epoch: 3, Steps: 18 | Train Loss: 0.873 Vali Loss: 1.432 Vali Acc: 0.600 Test Loss: 1.432 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.535691261291504
Epoch: 4, Steps: 18 | Train Loss: 0.806 Vali Loss: 1.211 Vali Acc: 0.530 Test Loss: 1.211 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.82632327079773
Epoch: 5, Steps: 18 | Train Loss: 1.036 Vali Loss: 2.713 Vali Acc: 0.410 Test Loss: 2.713 Test Acc: 0.410
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.662618160247803
Epoch: 6, Steps: 18 | Train Loss: 0.491 Vali Loss: 2.621 Vali Acc: 0.530 Test Loss: 2.621 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.230434894561768
Epoch: 7, Steps: 18 | Train Loss: 1.003 Vali Loss: 2.160 Vali Acc: 0.500 Test Loss: 2.160 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.702255249023438
Epoch: 8, Steps: 18 | Train Loss: 0.536 Vali Loss: 1.770 Vali Acc: 0.580 Test Loss: 1.770 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.828752279281616
Epoch: 9, Steps: 18 | Train Loss: 0.458 Vali Loss: 2.120 Vali Acc: 0.470 Test Loss: 2.120 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 19.11672019958496
Epoch: 10, Steps: 18 | Train Loss: 0.191 Vali Loss: 2.977 Vali Acc: 0.530 Test Loss: 2.977 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 19.810383081436157
Epoch: 11, Steps: 18 | Train Loss: 0.282 Vali Loss: 2.643 Vali Acc: 0.440 Test Loss: 2.643 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.68
model parameter : 2462594
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 85.18670344352722
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 1.447 Vali Acc: 0.470 Test Loss: 1.447 Test Acc: 0.470
Validation loss decreased (inf --> -0.469986).  Saving model ...
Epoch: 2 cost time: 70.15698146820068
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 1.285 Vali Acc: 0.460 Test Loss: 1.285 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 67.96781420707703
Epoch: 3, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.469986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 96.96498703956604
Epoch: 4, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.956 Vali Acc: 0.560 Test Loss: 0.956 Test Acc: 0.560
Validation loss decreased (-0.499988 --> -0.559990).  Saving model ...
Epoch: 5 cost time: 96.77375054359436
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.960 Vali Acc: 0.540 Test Loss: 0.960 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 80.39383053779602
Epoch: 6, Steps: 18 | Train Loss: 0.405 Vali Loss: 1.042 Vali Acc: 0.510 Test Loss: 1.042 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 81.63829731941223
Epoch: 7, Steps: 18 | Train Loss: 0.347 Vali Loss: 3.217 Vali Acc: 0.500 Test Loss: 3.217 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 87.68571710586548
Epoch: 8, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.906 Vali Acc: 0.500 Test Loss: 1.906 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 100.36596512794495
Epoch: 9, Steps: 18 | Train Loss: 0.517 Vali Loss: 3.169 Vali Acc: 0.490 Test Loss: 3.169 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 102.05037569999695
Epoch: 10, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.490 Vali Acc: 0.510 Test Loss: 1.490 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 86.61821603775024
Epoch: 11, Steps: 18 | Train Loss: 0.311 Vali Loss: 2.106 Vali Acc: 0.540 Test Loss: 2.106 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 86.207115650177
Epoch: 12, Steps: 18 | Train Loss: 0.238 Vali Loss: 2.302 Vali Acc: 0.550 Test Loss: 2.302 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 100.85648226737976
Epoch: 13, Steps: 18 | Train Loss: 0.190 Vali Loss: 2.594 Vali Acc: 0.500 Test Loss: 2.594 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 102.17989158630371
Epoch: 14, Steps: 18 | Train Loss: 0.116 Vali Loss: 1.778 Vali Acc: 0.540 Test Loss: 1.778 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 7229954
model size : 28.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 38.419755935668945
Epoch: 1, Steps: 18 | Train Loss: 0.795 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 38.066683292388916
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.968 Vali Acc: 0.510 Test Loss: 0.968 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.553876876831055
Epoch: 3, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.830 Vali Acc: 0.440 Test Loss: 0.830 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 39.437209606170654
Epoch: 4, Steps: 18 | Train Loss: 0.589 Vali Loss: 1.118 Vali Acc: 0.540 Test Loss: 1.118 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539989).  Saving model ...
Epoch: 5 cost time: 43.71490406990051
Epoch: 5, Steps: 18 | Train Loss: 0.438 Vali Loss: 0.943 Vali Acc: 0.500 Test Loss: 0.943 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 46.08333468437195
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 3.659 Vali Acc: 0.480 Test Loss: 3.659 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 42.90699529647827
Epoch: 7, Steps: 18 | Train Loss: 0.509 Vali Loss: 2.112 Vali Acc: 0.520 Test Loss: 2.112 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 47.079421043395996
Epoch: 8, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.520 Vali Acc: 0.540 Test Loss: 1.520 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 35.09067749977112
Epoch: 9, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.469 Vali Acc: 0.590 Test Loss: 1.469 Test Acc: 0.590
Validation loss decreased (-0.539989 --> -0.589985).  Saving model ...
Epoch: 10 cost time: 40.84470725059509
Epoch: 10, Steps: 18 | Train Loss: 0.422 Vali Loss: 2.385 Vali Acc: 0.530 Test Loss: 2.385 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 34.60707211494446
Epoch: 11, Steps: 18 | Train Loss: 0.319 Vali Loss: 2.119 Vali Acc: 0.500 Test Loss: 2.119 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 41.41546320915222
Epoch: 12, Steps: 18 | Train Loss: 0.449 Vali Loss: 4.285 Vali Acc: 0.500 Test Loss: 4.285 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 37.05475306510925
Epoch: 13, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.199 Vali Acc: 0.500 Test Loss: 2.199 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 36.88263249397278
Epoch: 14, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.926 Vali Acc: 0.480 Test Loss: 2.926 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 38.668540477752686
Epoch: 15, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.984 Vali Acc: 0.560 Test Loss: 1.984 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 41.69483923912048
Epoch: 16, Steps: 18 | Train Loss: 0.161 Vali Loss: 2.085 Vali Acc: 0.500 Test Loss: 2.085 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 39.385295391082764
Epoch: 17, Steps: 18 | Train Loss: 0.179 Vali Loss: 4.651 Vali Acc: 0.470 Test Loss: 4.651 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 29.573925495147705
Epoch: 18, Steps: 18 | Train Loss: 0.270 Vali Loss: 4.443 Vali Acc: 0.520 Test Loss: 4.443 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 33.14819049835205
Epoch: 19, Steps: 18 | Train Loss: 0.216 Vali Loss: 3.466 Vali Acc: 0.470 Test Loss: 3.466 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2264642
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 56.70891714096069
Epoch: 1, Steps: 18 | Train Loss: 0.793 Vali Loss: 1.446 Vali Acc: 0.470 Test Loss: 1.446 Test Acc: 0.470
Validation loss decreased (inf --> -0.469986).  Saving model ...
Epoch: 2 cost time: 69.63665580749512
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.286 Vali Acc: 0.460 Test Loss: 1.286 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 69.28489112854004
Epoch: 3, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.180 Vali Acc: 0.490 Test Loss: 1.180 Test Acc: 0.490
Validation loss decreased (-0.469986 --> -0.489988).  Saving model ...
Epoch: 4 cost time: 65.67232322692871
Epoch: 4, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.023 Vali Acc: 0.530 Test Loss: 1.023 Test Acc: 0.530
Validation loss decreased (-0.489988 --> -0.529990).  Saving model ...
Epoch: 5 cost time: 55.78197622299194
Epoch: 5, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 54.09553122520447
Epoch: 6, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.303 Vali Acc: 0.520 Test Loss: 1.303 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 56.065988063812256
Epoch: 7, Steps: 18 | Train Loss: 0.293 Vali Loss: 3.460 Vali Acc: 0.510 Test Loss: 3.460 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 70.61991119384766
Epoch: 8, Steps: 18 | Train Loss: 0.379 Vali Loss: 2.055 Vali Acc: 0.540 Test Loss: 2.055 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539979).  Saving model ...
Epoch: 9 cost time: 71.16759181022644
Epoch: 9, Steps: 18 | Train Loss: 0.474 Vali Loss: 2.472 Vali Acc: 0.560 Test Loss: 2.472 Test Acc: 0.560
Validation loss decreased (-0.539979 --> -0.559975).  Saving model ...
Epoch: 10 cost time: 60.073063373565674
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.858 Vali Acc: 0.530 Test Loss: 1.858 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 54.071993589401245
Epoch: 11, Steps: 18 | Train Loss: 0.201 Vali Loss: 2.035 Vali Acc: 0.490 Test Loss: 2.035 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 50.42914414405823
Epoch: 12, Steps: 18 | Train Loss: 0.192 Vali Loss: 2.289 Vali Acc: 0.520 Test Loss: 2.289 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 49.399309396743774
Epoch: 13, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.299 Vali Acc: 0.610 Test Loss: 2.299 Test Acc: 0.610
Validation loss decreased (-0.559975 --> -0.609977).  Saving model ...
Epoch: 14 cost time: 65.28849482536316
Epoch: 14, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.924 Vali Acc: 0.560 Test Loss: 1.924 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 69.73560237884521
Epoch: 15, Steps: 18 | Train Loss: 0.489 Vali Loss: 2.009 Vali Acc: 0.560 Test Loss: 2.009 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 63.56994295120239
Epoch: 16, Steps: 18 | Train Loss: 0.337 Vali Loss: 2.675 Vali Acc: 0.560 Test Loss: 2.675 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 50.97423577308655
Epoch: 17, Steps: 18 | Train Loss: 0.153 Vali Loss: 3.710 Vali Acc: 0.560 Test Loss: 3.710 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 54.60574436187744
Epoch: 18, Steps: 18 | Train Loss: 0.106 Vali Loss: 3.206 Vali Acc: 0.530 Test Loss: 3.206 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 64.6977927684784
Epoch: 19, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.892 Vali Acc: 0.550 Test Loss: 2.892 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 73.74466872215271
Epoch: 20, Steps: 18 | Train Loss: 0.230 Vali Loss: 8.653 Vali Acc: 0.490 Test Loss: 8.653 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 75.50835919380188
Epoch: 21, Steps: 18 | Train Loss: 0.196 Vali Loss: 4.161 Vali Acc: 0.600 Test Loss: 4.161 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 65.04612970352173
Epoch: 22, Steps: 18 | Train Loss: 0.084 Vali Loss: 3.729 Vali Acc: 0.510 Test Loss: 3.729 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 61.95975875854492
Epoch: 23, Steps: 18 | Train Loss: 0.067 Vali Loss: 6.104 Vali Acc: 0.560 Test Loss: 6.104 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 7229954
model size : 28.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.471402406692505
Epoch: 1, Steps: 18 | Train Loss: 0.795 Vali Loss: 0.852 Vali Acc: 0.510 Test Loss: 0.852 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 35.077250480651855
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.969 Vali Acc: 0.490 Test Loss: 0.969 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.36980700492859
Epoch: 3, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.824 Vali Acc: 0.450 Test Loss: 0.824 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 35.17433953285217
Epoch: 4, Steps: 18 | Train Loss: 0.585 Vali Loss: 1.127 Vali Acc: 0.550 Test Loss: 1.127 Test Acc: 0.550
Validation loss decreased (-0.509991 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 32.15376543998718
Epoch: 5, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.085 Vali Acc: 0.520 Test Loss: 1.085 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 34.598531007766724
Epoch: 6, Steps: 18 | Train Loss: 0.481 Vali Loss: 3.802 Vali Acc: 0.470 Test Loss: 3.802 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 29.440638065338135
Epoch: 7, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.469 Vali Acc: 0.480 Test Loss: 1.469 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 27.422510862350464
Epoch: 8, Steps: 18 | Train Loss: 0.368 Vali Loss: 1.526 Vali Acc: 0.430 Test Loss: 1.526 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 30.547095775604248
Epoch: 9, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.626 Vali Acc: 0.510 Test Loss: 1.626 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 26.52917742729187
Epoch: 10, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.276 Vali Acc: 0.540 Test Loss: 2.276 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 30.41459846496582
Epoch: 11, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.244 Vali Acc: 0.510 Test Loss: 2.244 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 26.722896099090576
Epoch: 12, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.977 Vali Acc: 0.480 Test Loss: 1.977 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 31.573874711990356
Epoch: 13, Steps: 18 | Train Loss: 0.112 Vali Loss: 2.469 Vali Acc: 0.460 Test Loss: 2.469 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 30.372748851776123
Epoch: 14, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.143 Vali Acc: 0.460 Test Loss: 2.143 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 2264642
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 44.77920627593994
Epoch: 1, Steps: 18 | Train Loss: 0.792 Vali Loss: 1.453 Vali Acc: 0.470 Test Loss: 1.453 Test Acc: 0.470
Validation loss decreased (inf --> -0.469985).  Saving model ...
Epoch: 2 cost time: 34.52860069274902
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.299 Vali Acc: 0.460 Test Loss: 1.299 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 37.174015045166016
Epoch: 3, Steps: 18 | Train Loss: 0.555 Vali Loss: 1.091 Vali Acc: 0.470 Test Loss: 1.091 Test Acc: 0.470
Validation loss decreased (-0.469985 --> -0.469989).  Saving model ...
Epoch: 4 cost time: 37.725157022476196
Epoch: 4, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.003 Vali Acc: 0.530 Test Loss: 1.003 Test Acc: 0.530
Validation loss decreased (-0.469989 --> -0.529990).  Saving model ...
Epoch: 5 cost time: 38.24990963935852
Epoch: 5, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.906 Vali Acc: 0.540 Test Loss: 0.906 Test Acc: 0.540
Validation loss decreased (-0.529990 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 42.055081605911255
Epoch: 6, Steps: 18 | Train Loss: 0.497 Vali Loss: 1.396 Vali Acc: 0.510 Test Loss: 1.396 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.669160842895508
Epoch: 7, Steps: 18 | Train Loss: 0.317 Vali Loss: 1.627 Vali Acc: 0.510 Test Loss: 1.627 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 34.73306059837341
Epoch: 8, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.386 Vali Acc: 0.470 Test Loss: 1.386 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 43.61988377571106
Epoch: 9, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.372 Vali Acc: 0.530 Test Loss: 1.372 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 43.337846517562866
Epoch: 10, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.380 Vali Acc: 0.540 Test Loss: 1.380 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 52.96498465538025
Epoch: 11, Steps: 18 | Train Loss: 0.235 Vali Loss: 3.258 Vali Acc: 0.500 Test Loss: 3.258 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 44.906917333602905
Epoch: 12, Steps: 18 | Train Loss: 0.173 Vali Loss: 3.417 Vali Acc: 0.480 Test Loss: 3.417 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 48.188530683517456
Epoch: 13, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.268 Vali Acc: 0.450 Test Loss: 2.268 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 42.59437823295593
Epoch: 14, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.889 Vali Acc: 0.510 Test Loss: 1.889 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 45.168636322021484
Epoch: 15, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.879 Vali Acc: 0.550 Test Loss: 2.879 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549971).  Saving model ...
Epoch: 16 cost time: 46.93698501586914
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 2.702 Vali Acc: 0.580 Test Loss: 2.702 Test Acc: 0.580
Validation loss decreased (-0.549971 --> -0.579973).  Saving model ...
Epoch: 17 cost time: 51.76815724372864
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.102 Vali Acc: 0.520 Test Loss: 2.102 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 51.85676693916321
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 2.035 Vali Acc: 0.560 Test Loss: 2.035 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 51.37528610229492
Epoch: 19, Steps: 18 | Train Loss: 0.029 Vali Loss: 3.184 Vali Acc: 0.510 Test Loss: 3.184 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 45.59649109840393
Epoch: 20, Steps: 18 | Train Loss: 0.029 Vali Loss: 3.432 Vali Acc: 0.560 Test Loss: 3.432 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 40.5557644367218
Epoch: 21, Steps: 18 | Train Loss: 0.187 Vali Loss: 4.354 Vali Acc: 0.530 Test Loss: 4.354 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 46.45818734169006
Epoch: 22, Steps: 18 | Train Loss: 0.340 Vali Loss: 5.048 Vali Acc: 0.520 Test Loss: 5.048 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 40.485262393951416
Epoch: 23, Steps: 18 | Train Loss: 0.070 Vali Loss: 3.991 Vali Acc: 0.540 Test Loss: 3.991 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 54.17563724517822
Epoch: 24, Steps: 18 | Train Loss: 0.024 Vali Loss: 6.869 Vali Acc: 0.520 Test Loss: 6.869 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 49.78026628494263
Epoch: 25, Steps: 18 | Train Loss: 0.239 Vali Loss: 4.033 Vali Acc: 0.500 Test Loss: 4.033 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 53.141024351119995
Epoch: 26, Steps: 18 | Train Loss: 0.167 Vali Loss: 3.548 Vali Acc: 0.550 Test Loss: 3.548 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 7229954
model size : 28.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.555005311965942
Epoch: 1, Steps: 18 | Train Loss: 0.796 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 21.805165767669678
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.967 Vali Acc: 0.490 Test Loss: 0.967 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.888446807861328
Epoch: 3, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.816 Vali Acc: 0.430 Test Loss: 0.816 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.34904384613037
Epoch: 4, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.078 Vali Acc: 0.530 Test Loss: 1.078 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529989).  Saving model ...
Epoch: 5 cost time: 18.988913536071777
Epoch: 5, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.991 Vali Acc: 0.520 Test Loss: 0.991 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.74987030029297
Epoch: 6, Steps: 18 | Train Loss: 0.495 Vali Loss: 3.552 Vali Acc: 0.480 Test Loss: 3.552 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.14688801765442
Epoch: 7, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.146 Vali Acc: 0.510 Test Loss: 1.146 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 21.98836064338684
Epoch: 8, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.830 Vali Acc: 0.490 Test Loss: 1.830 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 22.931644439697266
Epoch: 9, Steps: 18 | Train Loss: 0.360 Vali Loss: 2.995 Vali Acc: 0.510 Test Loss: 2.995 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.727923154830933
Epoch: 10, Steps: 18 | Train Loss: 0.594 Vali Loss: 2.603 Vali Acc: 0.510 Test Loss: 2.603 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 25.742297649383545
Epoch: 11, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.373 Vali Acc: 0.560 Test Loss: 2.373 Test Acc: 0.560
Validation loss decreased (-0.529989 --> -0.559976).  Saving model ...
Epoch: 12 cost time: 25.301894426345825
Epoch: 12, Steps: 18 | Train Loss: 0.150 Vali Loss: 2.006 Vali Acc: 0.500 Test Loss: 2.006 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.03767728805542
Epoch: 13, Steps: 18 | Train Loss: 0.188 Vali Loss: 2.156 Vali Acc: 0.540 Test Loss: 2.156 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 23.726515769958496
Epoch: 14, Steps: 18 | Train Loss: 0.110 Vali Loss: 2.583 Vali Acc: 0.500 Test Loss: 2.583 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 25.500224828720093
Epoch: 15, Steps: 18 | Train Loss: 0.087 Vali Loss: 2.828 Vali Acc: 0.500 Test Loss: 2.828 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 23.700337648391724
Epoch: 16, Steps: 18 | Train Loss: 0.256 Vali Loss: 2.421 Vali Acc: 0.480 Test Loss: 2.421 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.93223214149475
Epoch: 17, Steps: 18 | Train Loss: 0.169 Vali Loss: 3.309 Vali Acc: 0.510 Test Loss: 3.309 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.712746381759644
Epoch: 18, Steps: 18 | Train Loss: 0.453 Vali Loss: 2.689 Vali Acc: 0.520 Test Loss: 2.689 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 21.273627519607544
Epoch: 19, Steps: 18 | Train Loss: 0.117 Vali Loss: 2.850 Vali Acc: 0.500 Test Loss: 2.850 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 21.215596914291382
Epoch: 20, Steps: 18 | Train Loss: 0.207 Vali Loss: 4.694 Vali Acc: 0.500 Test Loss: 4.694 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 21.43689513206482
Epoch: 21, Steps: 18 | Train Loss: 0.354 Vali Loss: 3.694 Vali Acc: 0.480 Test Loss: 3.694 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 2264642
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 62.544947385787964
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.818 Vali Acc: 0.450 Test Loss: 0.818 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 58.78740739822388
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509991).  Saving model ...
Epoch: 3 cost time: 64.50425171852112
Epoch: 3, Steps: 18 | Train Loss: 0.779 Vali Loss: 1.163 Vali Acc: 0.540 Test Loss: 1.163 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 57.747464656829834
Epoch: 4, Steps: 18 | Train Loss: 0.716 Vali Loss: 1.366 Vali Acc: 0.550 Test Loss: 1.366 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 55.7789626121521
Epoch: 5, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.257 Vali Acc: 0.540 Test Loss: 1.257 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 49.86904454231262
Epoch: 6, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.520 Vali Acc: 0.560 Test Loss: 1.520 Test Acc: 0.560
Validation loss decreased (-0.549986 --> -0.559985).  Saving model ...
Epoch: 7 cost time: 55.49264049530029
Epoch: 7, Steps: 18 | Train Loss: 0.782 Vali Loss: 1.502 Vali Acc: 0.560 Test Loss: 1.502 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 8 cost time: 62.924423933029175
Epoch: 8, Steps: 18 | Train Loss: 0.582 Vali Loss: 3.712 Vali Acc: 0.500 Test Loss: 3.712 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 64.51489424705505
Epoch: 9, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.579 Vali Acc: 0.490 Test Loss: 1.579 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 63.967602014541626
Epoch: 10, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.674 Vali Acc: 0.460 Test Loss: 1.674 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 57.6953911781311
Epoch: 11, Steps: 18 | Train Loss: 0.695 Vali Loss: 1.599 Vali Acc: 0.530 Test Loss: 1.599 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 54.34201955795288
Epoch: 12, Steps: 18 | Train Loss: 0.241 Vali Loss: 2.093 Vali Acc: 0.500 Test Loss: 2.093 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 51.99847388267517
Epoch: 13, Steps: 18 | Train Loss: 0.251 Vali Loss: 2.765 Vali Acc: 0.510 Test Loss: 2.765 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 54.88657855987549
Epoch: 14, Steps: 18 | Train Loss: 0.124 Vali Loss: 3.152 Vali Acc: 0.520 Test Loss: 3.152 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 61.06657934188843
Epoch: 15, Steps: 18 | Train Loss: 0.167 Vali Loss: 3.899 Vali Acc: 0.520 Test Loss: 3.899 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 65.08409214019775
Epoch: 16, Steps: 18 | Train Loss: 0.134 Vali Loss: 4.092 Vali Acc: 0.510 Test Loss: 4.092 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 60.80689573287964
Epoch: 17, Steps: 18 | Train Loss: 0.040 Vali Loss: 3.133 Vali Acc: 0.530 Test Loss: 3.133 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3714434
model size : 14.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 27.49143671989441
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.713 Vali Acc: 0.590 Test Loss: 0.713 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 21.256428241729736
Epoch: 2, Steps: 18 | Train Loss: 0.705 Vali Loss: 1.100 Vali Acc: 0.520 Test Loss: 1.100 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.72981572151184
Epoch: 3, Steps: 18 | Train Loss: 0.876 Vali Loss: 1.704 Vali Acc: 0.530 Test Loss: 1.704 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.11766481399536
Epoch: 4, Steps: 18 | Train Loss: 0.848 Vali Loss: 0.763 Vali Acc: 0.600 Test Loss: 0.763 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 5 cost time: 23.919363737106323
Epoch: 5, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.349438190460205
Epoch: 6, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.952 Vali Acc: 0.540 Test Loss: 0.952 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 28.905558109283447
Epoch: 7, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.158 Vali Acc: 0.530 Test Loss: 1.158 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 29.05882167816162
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 2.119 Vali Acc: 0.480 Test Loss: 2.119 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.077818155288696
Epoch: 9, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.346 Vali Acc: 0.490 Test Loss: 1.346 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 27.921157121658325
Epoch: 10, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.597 Vali Acc: 0.530 Test Loss: 1.597 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 29.889391660690308
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.250 Vali Acc: 0.500 Test Loss: 2.250 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 29.999732971191406
Epoch: 12, Steps: 18 | Train Loss: 0.170 Vali Loss: 2.364 Vali Acc: 0.540 Test Loss: 2.364 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 24.96764850616455
Epoch: 13, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.949 Vali Acc: 0.550 Test Loss: 1.949 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 25.45599102973938
Epoch: 14, Steps: 18 | Train Loss: 0.476 Vali Loss: 4.302 Vali Acc: 0.520 Test Loss: 4.302 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1231682
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 40.14245128631592
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.818 Vali Acc: 0.450 Test Loss: 0.818 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 41.98089027404785
Epoch: 2, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 44.371580362319946
Epoch: 3, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539988).  Saving model ...
Epoch: 4 cost time: 46.14143443107605
Epoch: 4, Steps: 18 | Train Loss: 0.712 Vali Loss: 1.311 Vali Acc: 0.530 Test Loss: 1.311 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 49.86194086074829
Epoch: 5, Steps: 18 | Train Loss: 0.468 Vali Loss: 1.367 Vali Acc: 0.530 Test Loss: 1.367 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 45.974462270736694
Epoch: 6, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.484 Vali Acc: 0.530 Test Loss: 1.484 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 51.082050800323486
Epoch: 7, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.751 Vali Acc: 0.500 Test Loss: 1.751 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 43.302000761032104
Epoch: 8, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.429 Vali Acc: 0.510 Test Loss: 1.429 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 36.783352851867676
Epoch: 9, Steps: 18 | Train Loss: 0.296 Vali Loss: 3.529 Vali Acc: 0.510 Test Loss: 3.529 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 40.29997968673706
Epoch: 10, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 36.609201431274414
Epoch: 11, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.695 Vali Acc: 0.560 Test Loss: 1.695 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559983).  Saving model ...
Epoch: 12 cost time: 43.133596897125244
Epoch: 12, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.759 Vali Acc: 0.510 Test Loss: 1.759 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 45.414052963256836
Epoch: 13, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.488 Vali Acc: 0.510 Test Loss: 2.488 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 46.784159421920776
Epoch: 14, Steps: 18 | Train Loss: 0.132 Vali Loss: 2.176 Vali Acc: 0.520 Test Loss: 2.176 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 43.9553120136261
Epoch: 15, Steps: 18 | Train Loss: 0.184 Vali Loss: 5.096 Vali Acc: 0.490 Test Loss: 5.096 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 39.12783193588257
Epoch: 16, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.567 Vali Acc: 0.500 Test Loss: 2.567 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 40.83353018760681
Epoch: 17, Steps: 18 | Train Loss: 0.118 Vali Loss: 5.485 Vali Acc: 0.510 Test Loss: 5.485 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 39.90198755264282
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 6.610 Vali Acc: 0.490 Test Loss: 6.610 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 36.06719636917114
Epoch: 19, Steps: 18 | Train Loss: 0.155 Vali Loss: 2.729 Vali Acc: 0.470 Test Loss: 2.729 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 40.842501163482666
Epoch: 20, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.709 Vali Acc: 0.560 Test Loss: 2.709 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 46.289586305618286
Epoch: 21, Steps: 18 | Train Loss: 0.128 Vali Loss: 4.684 Vali Acc: 0.500 Test Loss: 4.684 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3714434
model size : 14.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.359313011169434
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.713 Vali Acc: 0.590 Test Loss: 0.713 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 22.04644775390625
Epoch: 2, Steps: 18 | Train Loss: 0.705 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.600155353546143
Epoch: 3, Steps: 18 | Train Loss: 0.877 Vali Loss: 1.711 Vali Acc: 0.530 Test Loss: 1.711 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.47500252723694
Epoch: 4, Steps: 18 | Train Loss: 0.860 Vali Loss: 0.764 Vali Acc: 0.590 Test Loss: 0.764 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.23453998565674
Epoch: 5, Steps: 18 | Train Loss: 0.784 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.840293884277344
Epoch: 6, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.626 Vali Acc: 0.510 Test Loss: 1.626 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.615496397018433
Epoch: 7, Steps: 18 | Train Loss: 0.401 Vali Loss: 2.053 Vali Acc: 0.520 Test Loss: 2.053 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 19.41323685646057
Epoch: 8, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.387 Vali Acc: 0.520 Test Loss: 1.387 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.5862557888031
Epoch: 9, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.204 Vali Acc: 0.510 Test Loss: 1.204 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 19.546546459197998
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 2.711 Vali Acc: 0.480 Test Loss: 2.711 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 21.487293004989624
Epoch: 11, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.415 Vali Acc: 0.490 Test Loss: 1.415 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1231682
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.9647536277771
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.816 Vali Acc: 0.450 Test Loss: 0.816 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 29.660155057907104
Epoch: 2, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 30.413956880569458
Epoch: 3, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.201 Vali Acc: 0.520 Test Loss: 1.201 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519988).  Saving model ...
Epoch: 4 cost time: 30.01524043083191
Epoch: 4, Steps: 18 | Train Loss: 0.716 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.519988 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 25.98861336708069
Epoch: 5, Steps: 18 | Train Loss: 0.463 Vali Loss: 1.402 Vali Acc: 0.530 Test Loss: 1.402 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.569242000579834
Epoch: 6, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.489 Vali Acc: 0.510 Test Loss: 1.489 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.923142194747925
Epoch: 7, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.932 Vali Acc: 0.490 Test Loss: 1.932 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.12903141975403
Epoch: 8, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.340 Vali Acc: 0.470 Test Loss: 1.340 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 25.226351261138916
Epoch: 9, Steps: 18 | Train Loss: 0.205 Vali Loss: 2.263 Vali Acc: 0.560 Test Loss: 2.263 Test Acc: 0.560
Validation loss decreased (-0.549987 --> -0.559977).  Saving model ...
Epoch: 10 cost time: 25.21099305152893
Epoch: 10, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.334 Vali Acc: 0.490 Test Loss: 1.334 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.561832189559937
Epoch: 11, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.497 Vali Acc: 0.510 Test Loss: 1.497 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 28.590155601501465
Epoch: 12, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.547 Vali Acc: 0.550 Test Loss: 1.547 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 32.147367000579834
Epoch: 13, Steps: 18 | Train Loss: 0.116 Vali Loss: 3.134 Vali Acc: 0.470 Test Loss: 3.134 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 30.422743320465088
Epoch: 14, Steps: 18 | Train Loss: 0.156 Vali Loss: 2.399 Vali Acc: 0.460 Test Loss: 2.399 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 32.471728801727295
Epoch: 15, Steps: 18 | Train Loss: 0.066 Vali Loss: 4.118 Vali Acc: 0.550 Test Loss: 4.118 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 28.933691024780273
Epoch: 16, Steps: 18 | Train Loss: 0.256 Vali Loss: 5.820 Vali Acc: 0.500 Test Loss: 5.820 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 28.269161462783813
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.683 Vali Acc: 0.510 Test Loss: 2.683 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 24.98481845855713
Epoch: 18, Steps: 18 | Train Loss: 0.145 Vali Loss: 4.934 Vali Acc: 0.510 Test Loss: 4.934 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 27.151760578155518
Epoch: 19, Steps: 18 | Train Loss: 0.529 Vali Loss: 6.712 Vali Acc: 0.430 Test Loss: 6.712 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 3714434
model size : 14.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.878643989562988
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.712 Vali Acc: 0.580 Test Loss: 0.712 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 11.541240215301514
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.100 Vali Acc: 0.520 Test Loss: 1.100 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.652101039886475
Epoch: 3, Steps: 18 | Train Loss: 0.880 Vali Loss: 1.723 Vali Acc: 0.530 Test Loss: 1.723 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.09561562538147
Epoch: 4, Steps: 18 | Train Loss: 0.904 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.920619487762451
Epoch: 5, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.475438833236694
Epoch: 6, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 14.224358081817627
Epoch: 7, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.058 Vali Acc: 0.560 Test Loss: 1.058 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.03122591972351
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.049 Vali Acc: 0.560 Test Loss: 1.049 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.30138087272644
Epoch: 9, Steps: 18 | Train Loss: 0.168 Vali Loss: 2.017 Vali Acc: 0.490 Test Loss: 2.017 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.797989130020142
Epoch: 10, Steps: 18 | Train Loss: 0.219 Vali Loss: 2.579 Vali Acc: 0.500 Test Loss: 2.579 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.340684175491333
Epoch: 11, Steps: 18 | Train Loss: 0.247 Vali Loss: 4.952 Vali Acc: 0.500 Test Loss: 4.952 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1231682
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 30.836039066314697
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 33.90956997871399
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 1.241 Vali Acc: 0.450 Test Loss: 1.241 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.1043746471405
Epoch: 3, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.984 Vali Acc: 0.470 Test Loss: 0.984 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 35.00373697280884
Epoch: 4, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.164 Vali Acc: 0.470 Test Loss: 1.164 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 42.76843619346619
Epoch: 5, Steps: 18 | Train Loss: 0.506 Vali Loss: 1.071 Vali Acc: 0.450 Test Loss: 1.071 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 39.93787598609924
Epoch: 6, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.059 Vali Acc: 0.530 Test Loss: 1.059 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529989).  Saving model ...
Epoch: 7 cost time: 43.83687448501587
Epoch: 7, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.977 Vali Acc: 0.440 Test Loss: 1.977 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.93538236618042
Epoch: 8, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.994 Vali Acc: 0.520 Test Loss: 1.994 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 44.13451671600342
Epoch: 9, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.426 Vali Acc: 0.500 Test Loss: 2.426 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 31.787187099456787
Epoch: 10, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.021 Vali Acc: 0.490 Test Loss: 2.021 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 38.41455626487732
Epoch: 11, Steps: 18 | Train Loss: 0.178 Vali Loss: 2.126 Vali Acc: 0.520 Test Loss: 2.126 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 33.45694303512573
Epoch: 12, Steps: 18 | Train Loss: 0.464 Vali Loss: 3.073 Vali Acc: 0.490 Test Loss: 3.073 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 38.32932090759277
Epoch: 13, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.839 Vali Acc: 0.530 Test Loss: 1.839 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 36.67746162414551
Epoch: 14, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.446 Vali Acc: 0.470 Test Loss: 2.446 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 44.03776693344116
Epoch: 15, Steps: 18 | Train Loss: 0.115 Vali Loss: 3.382 Vali Acc: 0.530 Test Loss: 3.382 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 41.599581241607666
Epoch: 16, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.178 Vali Acc: 0.510 Test Loss: 2.178 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 1956674
model size : 8.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.05009174346924
Epoch: 1, Steps: 18 | Train Loss: 0.878 Vali Loss: 0.832 Vali Acc: 0.600 Test Loss: 0.832 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 19.237746953964233
Epoch: 2, Steps: 18 | Train Loss: 0.730 Vali Loss: 1.291 Vali Acc: 0.540 Test Loss: 1.291 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.225687503814697
Epoch: 3, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.783533334732056
Epoch: 4, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.073020696640015
Epoch: 5, Steps: 18 | Train Loss: 0.540 Vali Loss: 1.418 Vali Acc: 0.540 Test Loss: 1.418 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.289151668548584
Epoch: 6, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.432 Vali Acc: 0.570 Test Loss: 1.432 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.185107707977295
Epoch: 7, Steps: 18 | Train Loss: 0.458 Vali Loss: 1.158 Vali Acc: 0.530 Test Loss: 1.158 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.874387741088867
Epoch: 8, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.279 Vali Acc: 0.530 Test Loss: 1.279 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.883038759231567
Epoch: 9, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.350 Vali Acc: 0.590 Test Loss: 1.350 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 14.19757628440857
Epoch: 10, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.367 Vali Acc: 0.590 Test Loss: 1.367 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.709588050842285
Epoch: 11, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.981 Vali Acc: 0.540 Test Loss: 1.981 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 715202
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.03963041305542
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 31.79805850982666
Epoch: 2, Steps: 18 | Train Loss: 0.645 Vali Loss: 1.244 Vali Acc: 0.450 Test Loss: 1.244 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.77856731414795
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.997 Vali Acc: 0.460 Test Loss: 0.997 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 30.24646496772766
Epoch: 4, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.234 Vali Acc: 0.480 Test Loss: 1.234 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 33.984264612197876
Epoch: 5, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.094 Vali Acc: 0.460 Test Loss: 1.094 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 34.39008164405823
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.889 Vali Acc: 0.560 Test Loss: 0.889 Test Acc: 0.560
Validation loss decreased (-0.479993 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 25.541038274765015
Epoch: 7, Steps: 18 | Train Loss: 0.409 Vali Loss: 2.658 Vali Acc: 0.490 Test Loss: 2.658 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.236600399017334
Epoch: 8, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.031 Vali Acc: 0.500 Test Loss: 2.031 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 28.36595630645752
Epoch: 9, Steps: 18 | Train Loss: 0.217 Vali Loss: 2.371 Vali Acc: 0.460 Test Loss: 2.371 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.935924530029297
Epoch: 10, Steps: 18 | Train Loss: 0.203 Vali Loss: 2.656 Vali Acc: 0.490 Test Loss: 2.656 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.71936559677124
Epoch: 11, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.832 Vali Acc: 0.520 Test Loss: 1.832 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.79197669029236
Epoch: 12, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.160 Vali Acc: 0.440 Test Loss: 2.160 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 32.50415086746216
Epoch: 13, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.969 Vali Acc: 0.510 Test Loss: 2.969 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 32.13714838027954
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 4.168 Vali Acc: 0.510 Test Loss: 4.168 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 18.267869234085083
Epoch: 15, Steps: 18 | Train Loss: 0.359 Vali Loss: 2.914 Vali Acc: 0.440 Test Loss: 2.914 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.446457624435425
Epoch: 16, Steps: 18 | Train Loss: 0.148 Vali Loss: 3.651 Vali Acc: 0.520 Test Loss: 3.651 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1956674
model size : 8.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.90786075592041
Epoch: 1, Steps: 18 | Train Loss: 0.878 Vali Loss: 0.833 Vali Acc: 0.600 Test Loss: 0.833 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 17.26921820640564
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 1.297 Vali Acc: 0.540 Test Loss: 1.297 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.58181142807007
Epoch: 3, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.542202472686768
Epoch: 4, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.773 Vali Acc: 0.600 Test Loss: 0.773 Test Acc: 0.600
Validation loss decreased (-0.599992 --> -0.599992).  Saving model ...
Epoch: 5 cost time: 15.466420650482178
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 1.343 Vali Acc: 0.540 Test Loss: 1.343 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.590078830718994
Epoch: 6, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.104 Vali Acc: 0.560 Test Loss: 1.104 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.62684655189514
Epoch: 7, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.238 Vali Acc: 0.550 Test Loss: 1.238 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.733249187469482
Epoch: 8, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.190 Vali Acc: 0.560 Test Loss: 1.190 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.573649406433105
Epoch: 9, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.789 Vali Acc: 0.540 Test Loss: 1.789 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.53767442703247
Epoch: 10, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.439 Vali Acc: 0.510 Test Loss: 1.439 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 16.725399494171143
Epoch: 11, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.476 Vali Acc: 0.510 Test Loss: 1.476 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 17.74553608894348
Epoch: 12, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.630 Vali Acc: 0.550 Test Loss: 1.630 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 17.59536075592041
Epoch: 13, Steps: 18 | Train Loss: 0.319 Vali Loss: 4.455 Vali Acc: 0.480 Test Loss: 4.455 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 17.704110145568848
Epoch: 14, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 715202
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 25.745224952697754
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 23.257081031799316
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 1.234 Vali Acc: 0.450 Test Loss: 1.234 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.281503200531006
Epoch: 3, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.944 Vali Acc: 0.470 Test Loss: 0.944 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.651077032089233
Epoch: 4, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.199 Vali Acc: 0.480 Test Loss: 1.199 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.306865453720093
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.060 Vali Acc: 0.450 Test Loss: 1.060 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 22.49114418029785
Epoch: 6, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.091 Vali Acc: 0.510 Test Loss: 1.091 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509989).  Saving model ...
Epoch: 7 cost time: 19.38296365737915
Epoch: 7, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.917 Vali Acc: 0.520 Test Loss: 1.917 Test Acc: 0.520
Validation loss decreased (-0.509989 --> -0.519981).  Saving model ...
Epoch: 8 cost time: 21.40232539176941
Epoch: 8, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.272 Vali Acc: 0.490 Test Loss: 2.272 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.198699712753296
Epoch: 9, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.908 Vali Acc: 0.500 Test Loss: 1.908 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.362795114517212
Epoch: 10, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 19.395927667617798
Epoch: 11, Steps: 18 | Train Loss: 0.156 Vali Loss: 2.899 Vali Acc: 0.490 Test Loss: 2.899 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.058105945587158
Epoch: 12, Steps: 18 | Train Loss: 0.289 Vali Loss: 4.346 Vali Acc: 0.470 Test Loss: 4.346 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.127610445022583
Epoch: 13, Steps: 18 | Train Loss: 0.396 Vali Loss: 2.035 Vali Acc: 0.530 Test Loss: 2.035 Test Acc: 0.530
Validation loss decreased (-0.519981 --> -0.529980).  Saving model ...
Epoch: 14 cost time: 19.954244375228882
Epoch: 14, Steps: 18 | Train Loss: 0.138 Vali Loss: 4.134 Vali Acc: 0.520 Test Loss: 4.134 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.547876119613647
Epoch: 15, Steps: 18 | Train Loss: 0.248 Vali Loss: 4.868 Vali Acc: 0.490 Test Loss: 4.868 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.826945543289185
Epoch: 16, Steps: 18 | Train Loss: 0.113 Vali Loss: 2.782 Vali Acc: 0.520 Test Loss: 2.782 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 21.90066695213318
Epoch: 17, Steps: 18 | Train Loss: 0.090 Vali Loss: 2.495 Vali Acc: 0.480 Test Loss: 2.495 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.587040901184082
Epoch: 18, Steps: 18 | Train Loss: 0.113 Vali Loss: 2.828 Vali Acc: 0.490 Test Loss: 2.828 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 20.57210397720337
Epoch: 19, Steps: 18 | Train Loss: 0.046 Vali Loss: 3.117 Vali Acc: 0.510 Test Loss: 3.117 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 20.92500329017639
Epoch: 20, Steps: 18 | Train Loss: 0.020 Vali Loss: 2.676 Vali Acc: 0.470 Test Loss: 2.676 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 23.241902112960815
Epoch: 21, Steps: 18 | Train Loss: 0.040 Vali Loss: 3.958 Vali Acc: 0.540 Test Loss: 3.958 Test Acc: 0.540
Validation loss decreased (-0.529980 --> -0.539960).  Saving model ...
Epoch: 22 cost time: 20.96304154396057
Epoch: 22, Steps: 18 | Train Loss: 0.064 Vali Loss: 3.876 Vali Acc: 0.500 Test Loss: 3.876 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.60099482536316
Epoch: 23, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.887 Vali Acc: 0.540 Test Loss: 2.887 Test Acc: 0.540
Validation loss decreased (-0.539960 --> -0.539971).  Saving model ...
Epoch: 24 cost time: 23.628180503845215
Epoch: 24, Steps: 18 | Train Loss: 0.022 Vali Loss: 3.092 Vali Acc: 0.510 Test Loss: 3.092 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 22.569109201431274
Epoch: 25, Steps: 18 | Train Loss: 0.067 Vali Loss: 3.744 Vali Acc: 0.480 Test Loss: 3.744 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 21.43386149406433
Epoch: 26, Steps: 18 | Train Loss: 0.031 Vali Loss: 4.239 Vali Acc: 0.510 Test Loss: 4.239 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 23.351187467575073
Epoch: 27, Steps: 18 | Train Loss: 0.020 Vali Loss: 3.956 Vali Acc: 0.510 Test Loss: 3.956 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 23.416531324386597
Epoch: 28, Steps: 18 | Train Loss: 0.054 Vali Loss: 3.691 Vali Acc: 0.530 Test Loss: 3.691 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 21.783331155776978
Epoch: 29, Steps: 18 | Train Loss: 0.054 Vali Loss: 3.220 Vali Acc: 0.510 Test Loss: 3.220 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 22.697105407714844
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 3.330 Vali Acc: 0.470 Test Loss: 3.330 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1956674
model size : 8.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.57702922821045
Epoch: 1, Steps: 18 | Train Loss: 0.878 Vali Loss: 0.832 Vali Acc: 0.600 Test Loss: 0.832 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 10.698454141616821
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 1.298 Vali Acc: 0.540 Test Loss: 1.298 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.342681169509888
Epoch: 3, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.97054386138916
Epoch: 4, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.770 Vali Acc: 0.610 Test Loss: 0.770 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609992).  Saving model ...
Epoch: 5 cost time: 11.980918169021606
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.232105731964111
Epoch: 6, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.950 Vali Acc: 0.580 Test Loss: 0.950 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.048202991485596
Epoch: 7, Steps: 18 | Train Loss: 0.736 Vali Loss: 1.750 Vali Acc: 0.570 Test Loss: 1.750 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.900146007537842
Epoch: 8, Steps: 18 | Train Loss: 0.387 Vali Loss: 1.116 Vali Acc: 0.420 Test Loss: 1.116 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.974414348602295
Epoch: 9, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.314 Vali Acc: 0.460 Test Loss: 1.314 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.360522031784058
Epoch: 10, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.266 Vali Acc: 0.540 Test Loss: 1.266 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.115914821624756
Epoch: 11, Steps: 18 | Train Loss: 0.267 Vali Loss: 2.057 Vali Acc: 0.480 Test Loss: 2.057 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.807655096054077
Epoch: 12, Steps: 18 | Train Loss: 0.321 Vali Loss: 2.917 Vali Acc: 0.540 Test Loss: 2.917 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.469904899597168
Epoch: 13, Steps: 18 | Train Loss: 0.386 Vali Loss: 2.685 Vali Acc: 0.510 Test Loss: 2.685 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.087260007858276
Epoch: 14, Steps: 18 | Train Loss: 0.087 Vali Loss: 2.076 Vali Acc: 0.530 Test Loss: 2.076 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 715202
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 43.77815794944763
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.772 Vali Acc: 0.430 Test Loss: 0.772 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 42.763506174087524
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.834 Vali Acc: 0.470 Test Loss: 0.834 Test Acc: 0.470
Validation loss decreased (-0.429992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 45.59501385688782
Epoch: 3, Steps: 18 | Train Loss: 0.667 Vali Loss: 1.069 Vali Acc: 0.530 Test Loss: 1.069 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529989).  Saving model ...
Epoch: 4 cost time: 43.28792381286621
Epoch: 4, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.694 Vali Acc: 0.590 Test Loss: 0.694 Test Acc: 0.590
Validation loss decreased (-0.529989 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 41.93390941619873
Epoch: 5, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 45.612770557403564
Epoch: 6, Steps: 18 | Train Loss: 0.553 Vali Loss: 1.145 Vali Acc: 0.540 Test Loss: 1.145 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 49.79691505432129
Epoch: 7, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.186 Vali Acc: 0.510 Test Loss: 1.186 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 50.07384657859802
Epoch: 8, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.167 Vali Acc: 0.540 Test Loss: 1.167 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 47.81629180908203
Epoch: 9, Steps: 18 | Train Loss: 0.308 Vali Loss: 1.714 Vali Acc: 0.530 Test Loss: 1.714 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 47.93286991119385
Epoch: 10, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 48.398412466049194
Epoch: 11, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.182 Vali Acc: 0.560 Test Loss: 1.182 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 49.64738440513611
Epoch: 12, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.521 Vali Acc: 0.450 Test Loss: 2.521 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 49.99021816253662
Epoch: 13, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.816 Vali Acc: 0.480 Test Loss: 1.816 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 48.74333214759827
Epoch: 14, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.489 Vali Acc: 0.570 Test Loss: 1.489 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 43.447124004364014
Epoch: 15, Steps: 18 | Train Loss: 0.094 Vali Loss: 1.502 Vali Acc: 0.530 Test Loss: 1.502 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 44.2677800655365
Epoch: 16, Steps: 18 | Train Loss: 0.064 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 45.459628105163574
Epoch: 17, Steps: 18 | Train Loss: 0.181 Vali Loss: 3.756 Vali Acc: 0.510 Test Loss: 3.756 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 43.23424434661865
Epoch: 18, Steps: 18 | Train Loss: 0.322 Vali Loss: 2.208 Vali Acc: 0.510 Test Loss: 2.208 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 40.03248977661133
Epoch: 19, Steps: 18 | Train Loss: 0.064 Vali Loss: 3.319 Vali Acc: 0.480 Test Loss: 3.319 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 41.47276759147644
Epoch: 20, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.537 Vali Acc: 0.510 Test Loss: 2.537 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1857794
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.84704041481018
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.721 Vali Acc: 0.590 Test Loss: 0.721 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 20.320571899414062
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.806 Vali Acc: 0.440 Test Loss: 0.806 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.950426816940308
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.900 Vali Acc: 0.510 Test Loss: 0.900 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.168733596801758
Epoch: 4, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.894 Vali Acc: 0.580 Test Loss: 0.894 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 22.558347940444946
Epoch: 5, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 21.25477409362793
Epoch: 6, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.768 Vali Acc: 0.590 Test Loss: 0.768 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 22.91262674331665
Epoch: 7, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.005 Vali Acc: 0.480 Test Loss: 1.005 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 20.747881650924683
Epoch: 8, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.604 Vali Acc: 0.520 Test Loss: 1.604 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 23.46853470802307
Epoch: 9, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.380 Vali Acc: 0.540 Test Loss: 1.380 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 22.685086965560913
Epoch: 10, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.503 Vali Acc: 0.470 Test Loss: 1.503 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 22.569818019866943
Epoch: 11, Steps: 18 | Train Loss: 0.176 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 616226
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 41.14373469352722
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.772 Vali Acc: 0.430 Test Loss: 0.772 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 37.330976247787476
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.837 Vali Acc: 0.470 Test Loss: 0.837 Test Acc: 0.470
Validation loss decreased (-0.429992 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 40.58044981956482
Epoch: 3, Steps: 18 | Train Loss: 0.667 Vali Loss: 1.067 Vali Acc: 0.520 Test Loss: 1.067 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519989).  Saving model ...
Epoch: 4 cost time: 36.951313734054565
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.692 Vali Acc: 0.590 Test Loss: 0.692 Test Acc: 0.590
Validation loss decreased (-0.519989 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 34.59470772743225
Epoch: 5, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 37.450485944747925
Epoch: 6, Steps: 18 | Train Loss: 0.567 Vali Loss: 1.103 Vali Acc: 0.560 Test Loss: 1.103 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 35.099855184555054
Epoch: 7, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.159 Vali Acc: 0.540 Test Loss: 1.159 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 33.77036905288696
Epoch: 8, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 36.66796851158142
Epoch: 9, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.510 Vali Acc: 0.560 Test Loss: 1.510 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 34.43684506416321
Epoch: 10, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.252 Vali Acc: 0.570 Test Loss: 1.252 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 34.1950409412384
Epoch: 11, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.172 Vali Acc: 0.560 Test Loss: 1.172 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 29.3547146320343
Epoch: 12, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.186 Vali Acc: 0.560 Test Loss: 1.186 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 36.24893569946289
Epoch: 13, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.191 Vali Acc: 0.540 Test Loss: 1.191 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 38.73042058944702
Epoch: 14, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.211 Vali Acc: 0.540 Test Loss: 1.211 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1857794
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.32599663734436
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 18.06890559196472
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.804 Vali Acc: 0.440 Test Loss: 0.804 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.8425235748291
Epoch: 3, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.894 Vali Acc: 0.520 Test Loss: 0.894 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 20.170177698135376
Epoch: 4, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.899 Vali Acc: 0.580 Test Loss: 0.899 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.043049573898315
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.121 Vali Acc: 0.540 Test Loss: 1.121 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.230294942855835
Epoch: 6, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 20.44127917289734
Epoch: 7, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.978 Vali Acc: 0.480 Test Loss: 0.978 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.28095507621765
Epoch: 8, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 20.839788675308228
Epoch: 9, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.817 Vali Acc: 0.530 Test Loss: 1.817 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 20.429404973983765
Epoch: 10, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.214 Vali Acc: 0.510 Test Loss: 1.214 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 19.268040657043457
Epoch: 11, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 616226
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 28.824525833129883
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.772 Vali Acc: 0.430 Test Loss: 0.772 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 24.9702250957489
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.835 Vali Acc: 0.460 Test Loss: 0.835 Test Acc: 0.460
Validation loss decreased (-0.429992 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 23.780179738998413
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 1.058 Vali Acc: 0.520 Test Loss: 1.058 Test Acc: 0.520
Validation loss decreased (-0.459992 --> -0.519989).  Saving model ...
Epoch: 4 cost time: 25.768106698989868
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.718 Vali Acc: 0.590 Test Loss: 0.718 Test Acc: 0.590
Validation loss decreased (-0.519989 --> -0.589993).  Saving model ...
Epoch: 5 cost time: 22.35711359977722
Epoch: 5, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.492140769958496
Epoch: 6, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.855584383010864
Epoch: 7, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.993181943893433
Epoch: 8, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.088 Vali Acc: 0.540 Test Loss: 1.088 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.149874210357666
Epoch: 9, Steps: 18 | Train Loss: 0.384 Vali Loss: 2.798 Vali Acc: 0.500 Test Loss: 2.798 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 23.99660348892212
Epoch: 10, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.017 Vali Acc: 0.550 Test Loss: 1.017 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 24.529081344604492
Epoch: 11, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.940 Vali Acc: 0.520 Test Loss: 0.940 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 22.192502737045288
Epoch: 12, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.337 Vali Acc: 0.560 Test Loss: 1.337 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 24.915659189224243
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.275 Vali Acc: 0.510 Test Loss: 1.275 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 21.58869433403015
Epoch: 14, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.481 Vali Acc: 0.530 Test Loss: 1.481 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1857794
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.417698860168457
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.720 Vali Acc: 0.590 Test Loss: 0.720 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 12.840821027755737
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.803 Vali Acc: 0.440 Test Loss: 0.803 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.364875078201294
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.893 Vali Acc: 0.520 Test Loss: 0.893 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.37212610244751
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.890 Vali Acc: 0.570 Test Loss: 0.890 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.120351552963257
Epoch: 5, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.504533529281616
Epoch: 6, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.760 Vali Acc: 0.580 Test Loss: 0.760 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.646666765213013
Epoch: 7, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.019 Vali Acc: 0.480 Test Loss: 1.019 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.783073902130127
Epoch: 8, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.703 Vali Acc: 0.530 Test Loss: 1.703 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.192920207977295
Epoch: 9, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.680 Vali Acc: 0.480 Test Loss: 1.680 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.938406944274902
Epoch: 10, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.336 Vali Acc: 0.550 Test Loss: 1.336 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.792404413223267
Epoch: 11, Steps: 18 | Train Loss: 0.225 Vali Loss: 2.180 Vali Acc: 0.510 Test Loss: 2.180 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 616226
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.77516579627991
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 30.77071976661682
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 34.43122982978821
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.809 Vali Acc: 0.670 Test Loss: 0.809 Test Acc: 0.670
Validation loss decreased (-0.509993 --> -0.669992).  Saving model ...
Epoch: 4 cost time: 31.526371240615845
Epoch: 4, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.54606485366821
Epoch: 5, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.980 Vali Acc: 0.490 Test Loss: 0.980 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.912332773208618
Epoch: 6, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.367607593536377
Epoch: 7, Steps: 18 | Train Loss: 0.339 Vali Loss: 0.871 Vali Acc: 0.510 Test Loss: 0.871 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 28.836503744125366
Epoch: 8, Steps: 18 | Train Loss: 0.201 Vali Loss: 0.970 Vali Acc: 0.550 Test Loss: 0.970 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 29.401207208633423
Epoch: 9, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 29.497093200683594
Epoch: 10, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.383 Vali Acc: 0.510 Test Loss: 1.383 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 28.452356338500977
Epoch: 11, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.86959218978882
Epoch: 12, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.339 Vali Acc: 0.540 Test Loss: 1.339 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.581971406936646
Epoch: 13, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.102 Vali Acc: 0.520 Test Loss: 1.102 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 978626
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.937769174575806
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.693 Vali Acc: 0.580 Test Loss: 0.693 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 12.306157112121582
Epoch: 2, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.806 Vali Acc: 0.450 Test Loss: 0.806 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.578482389450073
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.783 Vali Acc: 0.510 Test Loss: 0.783 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.994113206863403
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 14.690987348556519
Epoch: 5, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.740 Vali Acc: 0.490 Test Loss: 0.740 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.921375751495361
Epoch: 6, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.971860647201538
Epoch: 7, Steps: 18 | Train Loss: 0.421 Vali Loss: 1.858 Vali Acc: 0.550 Test Loss: 1.858 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.854821920394897
Epoch: 8, Steps: 18 | Train Loss: 0.412 Vali Loss: 2.091 Vali Acc: 0.520 Test Loss: 2.091 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.096715450286865
Epoch: 9, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.135 Vali Acc: 0.590 Test Loss: 1.135 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589989).  Saving model ...
Epoch: 10 cost time: 15.217093467712402
Epoch: 10, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.143 Vali Acc: 0.490 Test Loss: 1.143 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.035143852233887
Epoch: 11, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.552 Vali Acc: 0.480 Test Loss: 1.552 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.087250471115112
Epoch: 12, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.305 Vali Acc: 0.490 Test Loss: 1.305 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 14.244565725326538
Epoch: 13, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.320 Vali Acc: 0.510 Test Loss: 1.320 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.119271278381348
Epoch: 14, Steps: 18 | Train Loss: 0.098 Vali Loss: 2.011 Vali Acc: 0.460 Test Loss: 2.011 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 16.322929620742798
Epoch: 15, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.460028886795044
Epoch: 16, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.380 Vali Acc: 0.470 Test Loss: 1.380 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 14.466744661331177
Epoch: 17, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.051 Vali Acc: 0.480 Test Loss: 2.051 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.350297927856445
Epoch: 18, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.686 Vali Acc: 0.470 Test Loss: 1.686 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 16.30839729309082
Epoch: 19, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.752 Vali Acc: 0.490 Test Loss: 1.752 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 357794
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 24.181440353393555
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 24.72476053237915
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.736 Vali Acc: 0.510 Test Loss: 0.736 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.105909824371338
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.809 Vali Acc: 0.670 Test Loss: 0.809 Test Acc: 0.670
Validation loss decreased (-0.509993 --> -0.669992).  Saving model ...
Epoch: 4 cost time: 24.79590654373169
Epoch: 4, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.03323006629944
Epoch: 5, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.980 Vali Acc: 0.490 Test Loss: 0.980 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.861436367034912
Epoch: 6, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.305155277252197
Epoch: 7, Steps: 18 | Train Loss: 0.338 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.576521158218384
Epoch: 8, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.663856506347656
Epoch: 9, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.166 Vali Acc: 0.510 Test Loss: 1.166 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 20.181294679641724
Epoch: 10, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.270 Vali Acc: 0.510 Test Loss: 1.270 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.295480251312256
Epoch: 11, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.203 Vali Acc: 0.610 Test Loss: 1.203 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.201778650283813
Epoch: 12, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.144 Vali Acc: 0.550 Test Loss: 1.144 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 22.361314058303833
Epoch: 13, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.168 Vali Acc: 0.530 Test Loss: 1.168 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 978626
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.708631753921509
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.693 Vali Acc: 0.580 Test Loss: 0.693 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 9.857971429824829
Epoch: 2, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.806 Vali Acc: 0.450 Test Loss: 0.806 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.629205465316772
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.777 Vali Acc: 0.510 Test Loss: 0.777 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.883938074111938
Epoch: 4, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.2438485622406
Epoch: 5, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.587475776672363
Epoch: 6, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.325559616088867
Epoch: 7, Steps: 18 | Train Loss: 0.417 Vali Loss: 1.932 Vali Acc: 0.550 Test Loss: 1.932 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.940941095352173
Epoch: 8, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.948 Vali Acc: 0.550 Test Loss: 1.948 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.890127182006836
Epoch: 9, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.127 Vali Acc: 0.580 Test Loss: 1.127 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.06913948059082
Epoch: 10, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.202 Vali Acc: 0.490 Test Loss: 1.202 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 12.40990138053894
Epoch: 11, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.438 Vali Acc: 0.500 Test Loss: 1.438 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 357794
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.394752264022827
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 17.15323281288147
Epoch: 2, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.736 Vali Acc: 0.520 Test Loss: 0.736 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 16.847898244857788
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.809 Vali Acc: 0.680 Test Loss: 0.809 Test Acc: 0.680
Validation loss decreased (-0.519993 --> -0.679992).  Saving model ...
Epoch: 4 cost time: 16.44887661933899
Epoch: 4, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.793 Vali Acc: 0.490 Test Loss: 0.793 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.45297360420227
Epoch: 5, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.003 Vali Acc: 0.490 Test Loss: 1.003 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.16114115715027
Epoch: 6, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.363 Vali Acc: 0.480 Test Loss: 1.363 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.483607053756714
Epoch: 7, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.24789023399353
Epoch: 8, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.266894578933716
Epoch: 9, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.291 Vali Acc: 0.550 Test Loss: 1.291 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 17.457926988601685
Epoch: 10, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.181 Vali Acc: 0.530 Test Loss: 1.181 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 16.419111251831055
Epoch: 11, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.658584594726562
Epoch: 12, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.419 Vali Acc: 0.490 Test Loss: 1.419 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.0645854473114
Epoch: 13, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.427 Vali Acc: 0.560 Test Loss: 1.427 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.68
model parameter : 978626
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.416966915130615
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.695 Vali Acc: 0.570 Test Loss: 0.695 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 7.29923939704895
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.811 Vali Acc: 0.450 Test Loss: 0.811 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.212892293930054
Epoch: 3, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.779 Vali Acc: 0.520 Test Loss: 0.779 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.676574230194092
Epoch: 4, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.812 Vali Acc: 0.530 Test Loss: 0.812 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.1740028858184814
Epoch: 5, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.761744737625122
Epoch: 6, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.574870347976685
Epoch: 7, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.250 Vali Acc: 0.610 Test Loss: 1.250 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609987).  Saving model ...
Epoch: 8 cost time: 6.439285516738892
Epoch: 8, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.049 Vali Acc: 0.570 Test Loss: 1.049 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.654210805892944
Epoch: 9, Steps: 18 | Train Loss: 0.319 Vali Loss: 0.934 Vali Acc: 0.540 Test Loss: 0.934 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.324869155883789
Epoch: 10, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.281 Vali Acc: 0.480 Test Loss: 1.281 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.958200454711914
Epoch: 11, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.889 Vali Acc: 0.500 Test Loss: 1.889 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.627830266952515
Epoch: 12, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.193 Vali Acc: 0.480 Test Loss: 1.193 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.380385398864746
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.577497959136963
Epoch: 14, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.600 Vali Acc: 0.490 Test Loss: 1.600 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.145127534866333
Epoch: 15, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.229355335235596
Epoch: 16, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.809 Vali Acc: 0.490 Test Loss: 1.809 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.624372243881226
Epoch: 17, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.110 Vali Acc: 0.480 Test Loss: 2.110 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 357794
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.557278156280518
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 20.331190824508667
Epoch: 2, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.881 Vali Acc: 0.460 Test Loss: 0.881 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.42250657081604
Epoch: 3, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 19.961724519729614
Epoch: 4, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.919 Vali Acc: 0.580 Test Loss: 0.919 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 20.936667442321777
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.833 Vali Acc: 0.520 Test Loss: 0.833 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.9433753490448
Epoch: 6, Steps: 18 | Train Loss: 0.314 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.13548731803894
Epoch: 7, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.230 Vali Acc: 0.520 Test Loss: 1.230 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.526602745056152
Epoch: 8, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.252 Vali Acc: 0.510 Test Loss: 1.252 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 21.59966230392456
Epoch: 9, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.998 Vali Acc: 0.560 Test Loss: 0.998 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 23.607452154159546
Epoch: 10, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 22.51927423477173
Epoch: 11, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.278 Vali Acc: 0.550 Test Loss: 1.278 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 23.65800189971924
Epoch: 12, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.748 Vali Acc: 0.480 Test Loss: 1.748 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 22.568005561828613
Epoch: 13, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.393 Vali Acc: 0.520 Test Loss: 2.393 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 23.414857625961304
Epoch: 14, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.422 Vali Acc: 0.570 Test Loss: 1.422 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 539042
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.287614107131958
Epoch: 1, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 13.48707914352417
Epoch: 2, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.730 Vali Acc: 0.510 Test Loss: 0.730 Test Acc: 0.510
Validation loss decreased (-0.479991 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 13.565852165222168
Epoch: 3, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 12.904357194900513
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.103399753570557
Epoch: 5, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.041 Vali Acc: 0.530 Test Loss: 1.041 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529990).  Saving model ...
Epoch: 6 cost time: 12.327303409576416
Epoch: 6, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.083 Vali Acc: 0.510 Test Loss: 1.083 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.703587532043457
Epoch: 7, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.311 Vali Acc: 0.560 Test Loss: 1.311 Test Acc: 0.560
Validation loss decreased (-0.529990 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 12.66344690322876
Epoch: 8, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.214 Vali Acc: 0.510 Test Loss: 1.214 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.5682852268219
Epoch: 9, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.652 Vali Acc: 0.470 Test Loss: 1.652 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.103394746780396
Epoch: 10, Steps: 18 | Train Loss: 0.203 Vali Loss: 2.059 Vali Acc: 0.500 Test Loss: 2.059 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.23407506942749
Epoch: 11, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.398 Vali Acc: 0.470 Test Loss: 1.398 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.768326997756958
Epoch: 12, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.587 Vali Acc: 0.530 Test Loss: 1.587 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.47341012954712
Epoch: 13, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.883 Vali Acc: 0.520 Test Loss: 1.883 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.746067523956299
Epoch: 14, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.652 Vali Acc: 0.470 Test Loss: 1.652 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.47908067703247
Epoch: 15, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.556 Vali Acc: 0.510 Test Loss: 1.556 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.771844863891602
Epoch: 16, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.761 Vali Acc: 0.510 Test Loss: 1.761 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.082002878189087
Epoch: 17, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.101 Vali Acc: 0.540 Test Loss: 2.101 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 228578
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.128095865249634
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 19.489309072494507
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.883 Vali Acc: 0.460 Test Loss: 0.883 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.834325551986694
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 19.48687171936035
Epoch: 4, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.914 Vali Acc: 0.580 Test Loss: 0.914 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 17.135484218597412
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.71955108642578
Epoch: 6, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.432047128677368
Epoch: 7, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.270 Vali Acc: 0.510 Test Loss: 1.270 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.46159029006958
Epoch: 8, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.169 Vali Acc: 0.530 Test Loss: 1.169 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.408411979675293
Epoch: 9, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.002 Vali Acc: 0.580 Test Loss: 1.002 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 21.75399875640869
Epoch: 10, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.870261430740356
Epoch: 11, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.752 Vali Acc: 0.480 Test Loss: 1.752 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 20.301199197769165
Epoch: 12, Steps: 18 | Train Loss: 0.094 Vali Loss: 1.592 Vali Acc: 0.510 Test Loss: 1.592 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 20.836199045181274
Epoch: 13, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.727 Vali Acc: 0.520 Test Loss: 2.727 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 21.934147596359253
Epoch: 14, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.623 Vali Acc: 0.550 Test Loss: 1.623 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 539042
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.029278039932251
Epoch: 1, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.860 Vali Acc: 0.480 Test Loss: 0.860 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 10.305100440979004
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 10.966999530792236
Epoch: 3, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 11.133967638015747
Epoch: 4, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.749 Vali Acc: 0.520 Test Loss: 0.749 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 5 cost time: 11.053682327270508
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.049 Vali Acc: 0.540 Test Loss: 1.049 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539990).  Saving model ...
Epoch: 6 cost time: 11.108158826828003
Epoch: 6, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.063 Vali Acc: 0.510 Test Loss: 1.063 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.294606447219849
Epoch: 7, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.297 Vali Acc: 0.560 Test Loss: 1.297 Test Acc: 0.560
Validation loss decreased (-0.539990 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 9.864689826965332
Epoch: 8, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.085 Vali Acc: 0.480 Test Loss: 1.085 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.096863031387329
Epoch: 9, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.238 Vali Acc: 0.530 Test Loss: 1.238 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.168834924697876
Epoch: 10, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.508 Vali Acc: 0.500 Test Loss: 1.508 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.256961345672607
Epoch: 11, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.297 Vali Acc: 0.510 Test Loss: 1.297 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.29117751121521
Epoch: 12, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.738 Vali Acc: 0.510 Test Loss: 1.738 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.34613585472107
Epoch: 13, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.624 Vali Acc: 0.520 Test Loss: 1.624 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.187498807907104
Epoch: 14, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.902 Vali Acc: 0.510 Test Loss: 1.902 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.490143537521362
Epoch: 15, Steps: 18 | Train Loss: 0.068 Vali Loss: 2.026 Vali Acc: 0.550 Test Loss: 2.026 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.196544408798218
Epoch: 16, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.988 Vali Acc: 0.540 Test Loss: 1.988 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.578227996826172
Epoch: 17, Steps: 18 | Train Loss: 0.073 Vali Loss: 2.527 Vali Acc: 0.540 Test Loss: 2.527 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 228578
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.182647705078125
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 14.727768421173096
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.884 Vali Acc: 0.460 Test Loss: 0.884 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.605933666229248
Epoch: 3, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 14.243184089660645
Epoch: 4, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.903 Vali Acc: 0.580 Test Loss: 0.903 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579991).  Saving model ...
Epoch: 5 cost time: 13.02966570854187
Epoch: 5, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.204838037490845
Epoch: 6, Steps: 18 | Train Loss: 0.324 Vali Loss: 0.839 Vali Acc: 0.490 Test Loss: 0.839 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.997344493865967
Epoch: 7, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.277 Vali Acc: 0.510 Test Loss: 1.277 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.092821598052979
Epoch: 8, Steps: 18 | Train Loss: 0.234 Vali Loss: 1.227 Vali Acc: 0.530 Test Loss: 1.227 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.865259408950806
Epoch: 9, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.018 Vali Acc: 0.560 Test Loss: 1.018 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.872509956359863
Epoch: 10, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.237 Vali Acc: 0.460 Test Loss: 1.237 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.435290336608887
Epoch: 11, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.419705390930176
Epoch: 12, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.170210123062134
Epoch: 13, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.383 Vali Acc: 0.470 Test Loss: 2.383 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.833301782608032
Epoch: 14, Steps: 18 | Train Loss: 0.078 Vali Loss: 2.650 Vali Acc: 0.490 Test Loss: 2.650 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 539042
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.840776205062866
Epoch: 1, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 7.600706338882446
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 7.41788911819458
Epoch: 3, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.469367980957031
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.763 Vali Acc: 0.540 Test Loss: 0.763 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 7.596330404281616
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.049 Vali Acc: 0.510 Test Loss: 1.049 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.804551124572754
Epoch: 6, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.103 Vali Acc: 0.490 Test Loss: 1.103 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.696382284164429
Epoch: 7, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.307 Vali Acc: 0.550 Test Loss: 1.307 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 6.715027570724487
Epoch: 8, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.154 Vali Acc: 0.490 Test Loss: 1.154 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.422383546829224
Epoch: 9, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.496768474578857
Epoch: 10, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.466 Vali Acc: 0.480 Test Loss: 1.466 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.6114137172698975
Epoch: 11, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.647958755493164
Epoch: 12, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.500 Vali Acc: 0.530 Test Loss: 1.500 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.724674701690674
Epoch: 13, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.988 Vali Acc: 0.530 Test Loss: 1.988 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.429256200790405
Epoch: 14, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.393 Vali Acc: 0.550 Test Loss: 1.393 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.038876295089722
Epoch: 15, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.527 Vali Acc: 0.490 Test Loss: 1.527 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.965110778808594
Epoch: 16, Steps: 18 | Train Loss: 0.033 Vali Loss: 2.457 Vali Acc: 0.520 Test Loss: 2.457 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.406482934951782
Epoch: 17, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.603 Vali Acc: 0.520 Test Loss: 2.603 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 228578
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 41.28577017784119
Epoch: 1, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 38.63769268989563
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.867 Vali Acc: 0.490 Test Loss: 0.867 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 40.612696409225464
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
Validation loss decreased (-0.489991 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 36.70788288116455
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 0.755 Vali Acc: 0.540 Test Loss: 0.755 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.39423394203186
Epoch: 5, Steps: 18 | Train Loss: 0.478 Vali Loss: 1.155 Vali Acc: 0.490 Test Loss: 1.155 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.52240490913391
Epoch: 6, Steps: 18 | Train Loss: 0.484 Vali Loss: 0.875 Vali Acc: 0.550 Test Loss: 0.875 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 33.4507200717926
Epoch: 7, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.968 Vali Acc: 0.510 Test Loss: 0.968 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.265984058380127
Epoch: 8, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.102 Vali Acc: 0.510 Test Loss: 1.102 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 33.86852526664734
Epoch: 9, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.006 Vali Acc: 0.620 Test Loss: 1.006 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619990).  Saving model ...
Epoch: 10 cost time: 31.503061056137085
Epoch: 10, Steps: 18 | Train Loss: 0.269 Vali Loss: 0.965 Vali Acc: 0.540 Test Loss: 0.965 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 32.90456557273865
Epoch: 11, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.541 Vali Acc: 0.510 Test Loss: 1.541 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 33.56006455421448
Epoch: 12, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.132 Vali Acc: 0.490 Test Loss: 1.132 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 30.676433801651
Epoch: 13, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.562 Vali Acc: 0.490 Test Loss: 1.562 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 33.98219442367554
Epoch: 14, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.054 Vali Acc: 0.490 Test Loss: 1.054 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 31.532105684280396
Epoch: 15, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.548 Vali Acc: 0.530 Test Loss: 1.548 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 32.45882320404053
Epoch: 16, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.321 Vali Acc: 0.490 Test Loss: 1.321 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 36.59485363960266
Epoch: 17, Steps: 18 | Train Loss: 0.060 Vali Loss: 1.807 Vali Acc: 0.440 Test Loss: 1.807 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 33.90494704246521
Epoch: 18, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.075 Vali Acc: 0.490 Test Loss: 2.075 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 37.19893765449524
Epoch: 19, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.318 Vali Acc: 0.540 Test Loss: 1.318 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 929474
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 20.105478763580322
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.727 Vali Acc: 0.480 Test Loss: 0.727 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 16.23416566848755
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.775 Vali Acc: 0.480 Test Loss: 0.775 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.99468421936035
Epoch: 3, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 18.065056324005127
Epoch: 4, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 16.378661155700684
Epoch: 5, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 6 cost time: 18.052688360214233
Epoch: 6, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.928436756134033
Epoch: 7, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.333529710769653
Epoch: 8, Steps: 18 | Train Loss: 0.363 Vali Loss: 1.075 Vali Acc: 0.470 Test Loss: 1.075 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.76420021057129
Epoch: 9, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.116 Vali Acc: 0.510 Test Loss: 1.116 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.76037311553955
Epoch: 10, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.863 Vali Acc: 0.490 Test Loss: 0.863 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 16.673574447631836
Epoch: 11, Steps: 18 | Train Loss: 0.246 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.34854292869568
Epoch: 12, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.036 Vali Acc: 0.490 Test Loss: 1.036 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.963671445846558
Epoch: 13, Steps: 18 | Train Loss: 0.190 Vali Loss: 2.185 Vali Acc: 0.470 Test Loss: 2.185 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 15.88526463508606
Epoch: 14, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.983 Vali Acc: 0.480 Test Loss: 1.983 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 15.292083978652954
Epoch: 15, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.257 Vali Acc: 0.530 Test Loss: 1.257 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529987).  Saving model ...
Epoch: 16 cost time: 16.313321113586426
Epoch: 16, Steps: 18 | Train Loss: 0.078 Vali Loss: 2.528 Vali Acc: 0.490 Test Loss: 2.528 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.36002278327942
Epoch: 17, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.945 Vali Acc: 0.520 Test Loss: 1.945 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 14.801239728927612
Epoch: 18, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.082 Vali Acc: 0.510 Test Loss: 2.082 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.382527112960815
Epoch: 19, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.506 Vali Acc: 0.510 Test Loss: 1.506 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.084022045135498
Epoch: 20, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.438 Vali Acc: 0.530 Test Loss: 1.438 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 14.008192300796509
Epoch: 21, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.822 Vali Acc: 0.520 Test Loss: 1.822 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.02944827079773
Epoch: 22, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.755 Vali Acc: 0.500 Test Loss: 1.755 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 15.071822881698608
Epoch: 23, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.408 Vali Acc: 0.520 Test Loss: 2.408 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 15.316729307174683
Epoch: 24, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.899 Vali Acc: 0.530 Test Loss: 1.899 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 14.23468017578125
Epoch: 25, Steps: 18 | Train Loss: 0.019 Vali Loss: 2.050 Vali Acc: 0.490 Test Loss: 2.050 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 308498
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.872026681900024
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 25.753204345703125
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.873 Vali Acc: 0.490 Test Loss: 0.873 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 27.270692825317383
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (-0.489991 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 27.478813886642456
Epoch: 4, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.708807468414307
Epoch: 5, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.129 Vali Acc: 0.490 Test Loss: 1.129 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.46778154373169
Epoch: 6, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.842 Vali Acc: 0.540 Test Loss: 0.842 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.0926194190979
Epoch: 7, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.971 Vali Acc: 0.470 Test Loss: 0.971 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.088139295578003
Epoch: 8, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.477 Vali Acc: 0.490 Test Loss: 1.477 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 29.078292846679688
Epoch: 9, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.855 Vali Acc: 0.510 Test Loss: 0.855 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 27.698570251464844
Epoch: 10, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.047 Vali Acc: 0.520 Test Loss: 1.047 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 29.28035068511963
Epoch: 11, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 27.347926139831543
Epoch: 12, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.120 Vali Acc: 0.530 Test Loss: 1.120 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 29.58148431777954
Epoch: 13, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.812 Vali Acc: 0.480 Test Loss: 1.812 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 929474
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.533487558364868
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.723 Vali Acc: 0.460 Test Loss: 0.723 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 11.734846591949463
Epoch: 2, Steps: 18 | Train Loss: 0.700 Vali Loss: 0.778 Vali Acc: 0.480 Test Loss: 0.778 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 13.091432332992554
Epoch: 3, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 12.721697568893433
Epoch: 4, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.821 Vali Acc: 0.510 Test Loss: 0.821 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 11.930997133255005
Epoch: 5, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.954 Vali Acc: 0.510 Test Loss: 0.954 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.315782308578491
Epoch: 6, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
Validation loss decreased (-0.509992 --> -0.509992).  Saving model ...
Epoch: 7 cost time: 10.544645071029663
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519989).  Saving model ...
Epoch: 8 cost time: 13.26315712928772
Epoch: 8, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.22807264328003
Epoch: 9, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.972 Vali Acc: 0.520 Test Loss: 0.972 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519990).  Saving model ...
Epoch: 10 cost time: 14.256606101989746
Epoch: 10, Steps: 18 | Train Loss: 0.305 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
Validation loss decreased (-0.519990 --> -0.519991).  Saving model ...
Epoch: 11 cost time: 13.586485385894775
Epoch: 11, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.292 Vali Acc: 0.530 Test Loss: 1.292 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529987).  Saving model ...
Epoch: 12 cost time: 14.892846584320068
Epoch: 12, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.542 Vali Acc: 0.520 Test Loss: 1.542 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.34276294708252
Epoch: 13, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.419 Vali Acc: 0.520 Test Loss: 1.419 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.255060911178589
Epoch: 14, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.900503635406494
Epoch: 15, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.087 Vali Acc: 0.520 Test Loss: 1.087 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.452982187271118
Epoch: 16, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.684 Vali Acc: 0.540 Test Loss: 1.684 Test Acc: 0.540
Validation loss decreased (-0.529987 --> -0.539983).  Saving model ...
Epoch: 17 cost time: 15.074309349060059
Epoch: 17, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.359 Vali Acc: 0.520 Test Loss: 1.359 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 14.711145162582397
Epoch: 18, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.826 Vali Acc: 0.530 Test Loss: 1.826 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 13.73997187614441
Epoch: 19, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.524 Vali Acc: 0.540 Test Loss: 1.524 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539985).  Saving model ...
Epoch: 20 cost time: 13.819394588470459
Epoch: 20, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.998 Vali Acc: 0.490 Test Loss: 1.998 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 15.261819839477539
Epoch: 21, Steps: 18 | Train Loss: 0.056 Vali Loss: 2.054 Vali Acc: 0.500 Test Loss: 2.054 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.068709135055542
Epoch: 22, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.529 Vali Acc: 0.530 Test Loss: 1.529 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 15.029834270477295
Epoch: 23, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.833 Vali Acc: 0.520 Test Loss: 1.833 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 14.342376708984375
Epoch: 24, Steps: 18 | Train Loss: 0.018 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 16.044596433639526
Epoch: 25, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.545 Vali Acc: 0.530 Test Loss: 1.545 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 15.810241222381592
Epoch: 26, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.953 Vali Acc: 0.510 Test Loss: 1.953 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 15.2584707736969
Epoch: 27, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.766 Vali Acc: 0.530 Test Loss: 1.766 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 14.469775915145874
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 2.485 Vali Acc: 0.510 Test Loss: 2.485 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 15.603779077529907
Epoch: 29, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.359 Vali Acc: 0.530 Test Loss: 2.359 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 308498
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.187525749206543
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.733 Vali Acc: 0.480 Test Loss: 0.733 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 16.020684719085693
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.873 Vali Acc: 0.490 Test Loss: 0.873 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 19.091651916503906
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
Validation loss decreased (-0.489991 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 19.24448323249817
Epoch: 4, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.920211791992188
Epoch: 5, Steps: 18 | Train Loss: 0.481 Vali Loss: 1.161 Vali Acc: 0.490 Test Loss: 1.161 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.258479595184326
Epoch: 6, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.884 Vali Acc: 0.510 Test Loss: 0.884 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 19.474382638931274
Epoch: 7, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.027 Vali Acc: 0.490 Test Loss: 1.027 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.340997457504272
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.263 Vali Acc: 0.490 Test Loss: 1.263 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.88097047805786
Epoch: 9, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.148 Vali Acc: 0.540 Test Loss: 1.148 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.255288362503052
Epoch: 10, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.936 Vali Acc: 0.520 Test Loss: 0.936 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 20.554335832595825
Epoch: 11, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.335 Vali Acc: 0.530 Test Loss: 1.335 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.321088075637817
Epoch: 12, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.107 Vali Acc: 0.430 Test Loss: 1.107 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.194422483444214
Epoch: 13, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.915 Vali Acc: 0.480 Test Loss: 1.915 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 929474
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.548145294189453
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.728 Vali Acc: 0.460 Test Loss: 0.728 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.00749135017395
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.783 Vali Acc: 0.480 Test Loss: 0.783 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479992).  Saving model ...
Epoch: 3 cost time: 7.178213119506836
Epoch: 3, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.826 Vali Acc: 0.490 Test Loss: 0.826 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 7.287164688110352
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 6.473795413970947
Epoch: 5, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.965 Vali Acc: 0.520 Test Loss: 0.965 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519990).  Saving model ...
Epoch: 6 cost time: 6.129348516464233
Epoch: 6, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.852 Vali Acc: 0.490 Test Loss: 0.852 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.458078384399414
Epoch: 7, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.995 Vali Acc: 0.520 Test Loss: 0.995 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.546229839324951
Epoch: 8, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.908 Vali Acc: 0.500 Test Loss: 0.908 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.307003736495972
Epoch: 9, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.083 Vali Acc: 0.550 Test Loss: 1.083 Test Acc: 0.550
Validation loss decreased (-0.519990 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 6.002840280532837
Epoch: 10, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.532893657684326
Epoch: 11, Steps: 18 | Train Loss: 0.295 Vali Loss: 1.046 Vali Acc: 0.530 Test Loss: 1.046 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.490578889846802
Epoch: 12, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.366 Vali Acc: 0.480 Test Loss: 1.366 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.554428100585938
Epoch: 13, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.898 Vali Acc: 0.490 Test Loss: 1.898 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.1861732006073
Epoch: 14, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.527 Vali Acc: 0.480 Test Loss: 1.527 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.50179386138916
Epoch: 15, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.760562181472778
Epoch: 16, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.692 Vali Acc: 0.510 Test Loss: 1.692 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.706517219543457
Epoch: 17, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.638 Vali Acc: 0.510 Test Loss: 1.638 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.609540939331055
Epoch: 18, Steps: 18 | Train Loss: 0.128 Vali Loss: 2.130 Vali Acc: 0.520 Test Loss: 2.130 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.652765989303589
Epoch: 19, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.342 Vali Acc: 0.550 Test Loss: 1.342 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 308498
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.903301000595093
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.907 Vali Acc: 0.470 Test Loss: 0.907 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 19.403045892715454
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
Validation loss decreased (-0.469991 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 17.849623441696167
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.287450075149536
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.905 Vali Acc: 0.480 Test Loss: 0.905 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.761955499649048
Epoch: 5, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.34739327430725
Epoch: 6, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.955 Vali Acc: 0.490 Test Loss: 0.955 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 21.674328565597534
Epoch: 7, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.849 Vali Acc: 0.510 Test Loss: 0.849 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 23.44450068473816
Epoch: 8, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.358 Vali Acc: 0.530 Test Loss: 1.358 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529986).  Saving model ...
Epoch: 9 cost time: 21.763859510421753
Epoch: 9, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.064 Vali Acc: 0.520 Test Loss: 1.064 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.385218858718872
Epoch: 10, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.169 Vali Acc: 0.530 Test Loss: 1.169 Test Acc: 0.530
Validation loss decreased (-0.529986 --> -0.529988).  Saving model ...
Epoch: 11 cost time: 21.709306001663208
Epoch: 11, Steps: 18 | Train Loss: 0.192 Vali Loss: 0.832 Vali Acc: 0.590 Test Loss: 0.832 Test Acc: 0.590
Validation loss decreased (-0.529988 --> -0.589992).  Saving model ...
Epoch: 12 cost time: 21.74447751045227
Epoch: 12, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.747 Vali Acc: 0.480 Test Loss: 1.747 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.80463433265686
Epoch: 13, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.618 Vali Acc: 0.440 Test Loss: 1.618 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.38469624519348
Epoch: 14, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.392 Vali Acc: 0.540 Test Loss: 1.392 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.99664616584778
Epoch: 15, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.516 Vali Acc: 0.530 Test Loss: 1.516 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 18.83401608467102
Epoch: 16, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.574901342391968
Epoch: 17, Steps: 18 | Train Loss: 0.115 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 18.569233655929565
Epoch: 18, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.578 Vali Acc: 0.530 Test Loss: 1.578 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 17.64970564842224
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 1.628 Vali Acc: 0.520 Test Loss: 1.628 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.985395669937134
Epoch: 20, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.641 Vali Acc: 0.520 Test Loss: 1.641 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 21.432528495788574
Epoch: 21, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.657 Vali Acc: 0.550 Test Loss: 1.657 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 489602
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.008198738098145
Epoch: 1, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.758 Vali Acc: 0.430 Test Loss: 0.758 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 10.230273962020874
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.717 Vali Acc: 0.560 Test Loss: 0.717 Test Acc: 0.560
Validation loss decreased (-0.429992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 9.5609290599823
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.758 Vali Acc: 0.570 Test Loss: 0.758 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 9.25314736366272
Epoch: 4, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.667254209518433
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 0.885 Vali Acc: 0.510 Test Loss: 0.885 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.189626693725586
Epoch: 6, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.952 Vali Acc: 0.460 Test Loss: 0.952 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.267161130905151
Epoch: 7, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.377551078796387
Epoch: 8, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.317 Vali Acc: 0.480 Test Loss: 1.317 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.172516107559204
Epoch: 9, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.216 Vali Acc: 0.480 Test Loss: 1.216 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.018388032913208
Epoch: 10, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.170 Vali Acc: 0.490 Test Loss: 1.170 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.450326442718506
Epoch: 11, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.017 Vali Acc: 0.490 Test Loss: 2.017 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.396912813186646
Epoch: 12, Steps: 18 | Train Loss: 0.341 Vali Loss: 2.436 Vali Acc: 0.480 Test Loss: 2.436 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.245491743087769
Epoch: 13, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.111 Vali Acc: 0.470 Test Loss: 1.111 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 179090
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.171680688858032
Epoch: 1, Steps: 18 | Train Loss: 0.757 Vali Loss: 0.899 Vali Acc: 0.470 Test Loss: 0.899 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 17.49408769607544
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
Validation loss decreased (-0.469991 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 18.79402184486389
Epoch: 3, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.810 Vali Acc: 0.500 Test Loss: 0.810 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.84180974960327
Epoch: 4, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.840 Vali Acc: 0.450 Test Loss: 0.840 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.417381286621094
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.842 Vali Acc: 0.500 Test Loss: 0.842 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.774971961975098
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.893 Vali Acc: 0.500 Test Loss: 0.893 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.60270071029663
Epoch: 7, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 16.109066247940063
Epoch: 8, Steps: 18 | Train Loss: 0.327 Vali Loss: 1.156 Vali Acc: 0.530 Test Loss: 1.156 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529988).  Saving model ...
Epoch: 9 cost time: 17.046406984329224
Epoch: 9, Steps: 18 | Train Loss: 0.331 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.324970960617065
Epoch: 10, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.952 Vali Acc: 0.570 Test Loss: 0.952 Test Acc: 0.570
Validation loss decreased (-0.529988 --> -0.569990).  Saving model ...
Epoch: 11 cost time: 15.272003889083862
Epoch: 11, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.959 Vali Acc: 0.600 Test Loss: 0.959 Test Acc: 0.600
Validation loss decreased (-0.569990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 16.57737708091736
Epoch: 12, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.163 Vali Acc: 0.530 Test Loss: 1.163 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.824352025985718
Epoch: 13, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.182 Vali Acc: 0.550 Test Loss: 1.182 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.139450073242188
Epoch: 14, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.893136024475098
Epoch: 15, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.313 Vali Acc: 0.520 Test Loss: 1.313 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.63994550704956
Epoch: 16, Steps: 18 | Train Loss: 0.052 Vali Loss: 1.465 Vali Acc: 0.540 Test Loss: 1.465 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.556613445281982
Epoch: 17, Steps: 18 | Train Loss: 0.056 Vali Loss: 1.385 Vali Acc: 0.510 Test Loss: 1.385 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.705919981002808
Epoch: 18, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.350 Vali Acc: 0.470 Test Loss: 1.350 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 19.11018466949463
Epoch: 19, Steps: 18 | Train Loss: 0.036 Vali Loss: 1.132 Vali Acc: 0.570 Test Loss: 1.132 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 18.12952756881714
Epoch: 20, Steps: 18 | Train Loss: 0.037 Vali Loss: 2.018 Vali Acc: 0.540 Test Loss: 2.018 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 18.70877695083618
Epoch: 21, Steps: 18 | Train Loss: 0.068 Vali Loss: 1.227 Vali Acc: 0.520 Test Loss: 1.227 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 489602
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.873797178268433
Epoch: 1, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.755 Vali Acc: 0.440 Test Loss: 0.755 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 8.816694021224976
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
Validation loss decreased (-0.439992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 9.68592357635498
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 9.721014261245728
Epoch: 4, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.527734518051147
Epoch: 5, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.732642650604248
Epoch: 6, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.988 Vali Acc: 0.500 Test Loss: 0.988 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.348357200622559
Epoch: 7, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.028 Vali Acc: 0.540 Test Loss: 1.028 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.601814985275269
Epoch: 8, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.181 Vali Acc: 0.490 Test Loss: 1.181 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.458507776260376
Epoch: 9, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.317 Vali Acc: 0.510 Test Loss: 1.317 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.602814674377441
Epoch: 10, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.228 Vali Acc: 0.480 Test Loss: 1.228 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.59624195098877
Epoch: 11, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.586 Vali Acc: 0.540 Test Loss: 1.586 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.673641443252563
Epoch: 12, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.531 Vali Acc: 0.520 Test Loss: 1.531 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.065373182296753
Epoch: 13, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.553 Vali Acc: 0.530 Test Loss: 1.553 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 179090
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.793081521987915
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.895 Vali Acc: 0.470 Test Loss: 0.895 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 10.921128273010254
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
Validation loss decreased (-0.469991 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 11.468364953994751
Epoch: 3, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.345544576644897
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.840 Vali Acc: 0.450 Test Loss: 0.840 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.985072374343872
Epoch: 5, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.168719291687012
Epoch: 6, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.90446424484253
Epoch: 7, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 13.380465030670166
Epoch: 8, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.272 Vali Acc: 0.520 Test Loss: 1.272 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.99593210220337
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.756 Vali Acc: 0.540 Test Loss: 0.756 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 14.027090787887573
Epoch: 10, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.015 Vali Acc: 0.540 Test Loss: 1.015 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.527854442596436
Epoch: 11, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 12.570749759674072
Epoch: 12, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.945 Vali Acc: 0.490 Test Loss: 1.945 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.859229803085327
Epoch: 13, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.520 Vali Acc: 0.490 Test Loss: 1.520 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.861106157302856
Epoch: 14, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.297 Vali Acc: 0.520 Test Loss: 1.297 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.747279644012451
Epoch: 15, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.150 Vali Acc: 0.510 Test Loss: 1.150 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.135748386383057
Epoch: 16, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.383 Vali Acc: 0.490 Test Loss: 1.383 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.972968578338623
Epoch: 17, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.373 Vali Acc: 0.530 Test Loss: 1.373 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.382992506027222
Epoch: 18, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.143 Vali Acc: 0.490 Test Loss: 1.143 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.978354692459106
Epoch: 19, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.233 Vali Acc: 0.530 Test Loss: 1.233 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.634155988693237
Epoch: 20, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.475 Vali Acc: 0.540 Test Loss: 1.475 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.486995697021484
Epoch: 21, Steps: 18 | Train Loss: 0.017 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 489602
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.609787225723267
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.756 Vali Acc: 0.440 Test Loss: 0.756 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 4.53727650642395
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
Validation loss decreased (-0.439992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 4.364529609680176
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 4.109570026397705
Epoch: 4, Steps: 18 | Train Loss: 0.550 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.690253734588623
Epoch: 5, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.218118667602539
Epoch: 6, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.043 Vali Acc: 0.480 Test Loss: 1.043 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.945941925048828
Epoch: 7, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.524551630020142
Epoch: 8, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.079 Vali Acc: 0.490 Test Loss: 1.079 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9898998737335205
Epoch: 9, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.051 Vali Acc: 0.510 Test Loss: 1.051 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.783343553543091
Epoch: 10, Steps: 18 | Train Loss: 0.246 Vali Loss: 1.213 Vali Acc: 0.510 Test Loss: 1.213 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.923628330230713
Epoch: 11, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.592 Vali Acc: 0.510 Test Loss: 1.592 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.179811954498291
Epoch: 12, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.890 Vali Acc: 0.480 Test Loss: 1.890 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.787639141082764
Epoch: 13, Steps: 18 | Train Loss: 0.176 Vali Loss: 1.151 Vali Acc: 0.490 Test Loss: 1.151 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 179090
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.52615451812744
Epoch: 1, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.764 Vali Acc: 0.460 Test Loss: 0.764 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 16.794461011886597
Epoch: 2, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.459992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 15.977025747299194
Epoch: 3, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.172817707061768
Epoch: 4, Steps: 18 | Train Loss: 0.540 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.083776473999023
Epoch: 5, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.027251482009888
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.722 Vali Acc: 0.560 Test Loss: 0.722 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 7 cost time: 15.991446018218994
Epoch: 7, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 8 cost time: 13.793125629425049
Epoch: 8, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.934 Vali Acc: 0.490 Test Loss: 0.934 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.109785318374634
Epoch: 9, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.797 Vali Acc: 0.560 Test Loss: 0.797 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.405569076538086
Epoch: 10, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.448448419570923
Epoch: 11, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.151 Vali Acc: 0.490 Test Loss: 1.151 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.595831155776978
Epoch: 12, Steps: 18 | Train Loss: 0.134 Vali Loss: 1.061 Vali Acc: 0.540 Test Loss: 1.061 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.274235963821411
Epoch: 13, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.019 Vali Acc: 0.580 Test Loss: 1.019 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.224058389663696
Epoch: 14, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.092 Vali Acc: 0.480 Test Loss: 1.092 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.077485799789429
Epoch: 15, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.945 Vali Acc: 0.590 Test Loss: 0.945 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589991).  Saving model ...
Epoch: 16 cost time: 12.901622295379639
Epoch: 16, Steps: 18 | Train Loss: 0.049 Vali Loss: 1.087 Vali Acc: 0.520 Test Loss: 1.087 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 14.187515497207642
Epoch: 17, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.064 Vali Acc: 0.510 Test Loss: 2.064 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 12.383496284484863
Epoch: 18, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.377 Vali Acc: 0.520 Test Loss: 1.377 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.8028724193573
Epoch: 19, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.320 Vali Acc: 0.470 Test Loss: 1.320 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.764899253845215
Epoch: 20, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.349 Vali Acc: 0.480 Test Loss: 1.349 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.596585273742676
Epoch: 21, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.736 Vali Acc: 0.440 Test Loss: 1.736 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.23530626296997
Epoch: 22, Steps: 18 | Train Loss: 0.024 Vali Loss: 1.429 Vali Acc: 0.490 Test Loss: 1.429 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.751600742340088
Epoch: 23, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.355 Vali Acc: 0.530 Test Loss: 1.355 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.811968326568604
Epoch: 24, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.511 Vali Acc: 0.480 Test Loss: 1.511 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.23946475982666
Epoch: 25, Steps: 18 | Train Loss: 0.021 Vali Loss: 1.682 Vali Acc: 0.460 Test Loss: 1.682 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 269666
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.875210762023926
Epoch: 1, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 8.299824476242065
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.734 Vali Acc: 0.440 Test Loss: 0.734 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.754522800445557
Epoch: 3, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.863 Vali Acc: 0.470 Test Loss: 0.863 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.180166244506836
Epoch: 4, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.831 Vali Acc: 0.460 Test Loss: 0.831 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.913978576660156
Epoch: 5, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 7.064945936203003
Epoch: 6, Steps: 18 | Train Loss: 0.495 Vali Loss: 0.860 Vali Acc: 0.470 Test Loss: 0.860 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.4780566692352295
Epoch: 7, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.141225576400757
Epoch: 8, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.612 Vali Acc: 0.510 Test Loss: 1.612 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.426862955093384
Epoch: 9, Steps: 18 | Train Loss: 0.338 Vali Loss: 0.968 Vali Acc: 0.440 Test Loss: 0.968 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.580237627029419
Epoch: 10, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.958 Vali Acc: 0.440 Test Loss: 0.958 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.196558475494385
Epoch: 11, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.297 Vali Acc: 0.530 Test Loss: 1.297 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.476400136947632
Epoch: 12, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.443844318389893
Epoch: 13, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.203 Vali Acc: 0.490 Test Loss: 1.203 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.852832317352295
Epoch: 14, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.326 Vali Acc: 0.480 Test Loss: 1.326 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.094298601150513
Epoch: 15, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.635 Vali Acc: 0.470 Test Loss: 1.635 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 114386
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.202223777770996
Epoch: 1, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.761 Vali Acc: 0.460 Test Loss: 0.761 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 15.187662124633789
Epoch: 2, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.459992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 14.687731504440308
Epoch: 3, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.693 Vali Acc: 0.560 Test Loss: 0.693 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 13.62752079963684
Epoch: 4, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.746 Vali Acc: 0.580 Test Loss: 0.746 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 15.264126539230347
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.737 Vali Acc: 0.560 Test Loss: 0.737 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.25178074836731
Epoch: 6, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.707 Vali Acc: 0.580 Test Loss: 0.707 Test Acc: 0.580
Validation loss decreased (-0.579993 --> -0.579993).  Saving model ...
Epoch: 7 cost time: 15.358303785324097
Epoch: 7, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.476259708404541
Epoch: 8, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.812 Vali Acc: 0.480 Test Loss: 0.812 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.853798866271973
Epoch: 9, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.802 Vali Acc: 0.590 Test Loss: 0.802 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 14.97697114944458
Epoch: 10, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.309664487838745
Epoch: 11, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.995 Vali Acc: 0.480 Test Loss: 0.995 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 14.872521877288818
Epoch: 12, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.970 Vali Acc: 0.520 Test Loss: 0.970 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 13.804919719696045
Epoch: 13, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.957 Vali Acc: 0.540 Test Loss: 0.957 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.288574695587158
Epoch: 14, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.011 Vali Acc: 0.500 Test Loss: 1.011 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 13.1855788230896
Epoch: 15, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 12.916325569152832
Epoch: 16, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.72881817817688
Epoch: 17, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.491 Vali Acc: 0.510 Test Loss: 1.491 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.1454176902771
Epoch: 18, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.997 Vali Acc: 0.530 Test Loss: 0.997 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.790539741516113
Epoch: 19, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.177 Vali Acc: 0.510 Test Loss: 1.177 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 269666
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.7330522537231445
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.233766794204712
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.726 Vali Acc: 0.440 Test Loss: 0.726 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.487979173660278
Epoch: 3, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.855 Vali Acc: 0.470 Test Loss: 0.855 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.282926082611084
Epoch: 4, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.133795261383057
Epoch: 5, Steps: 18 | Train Loss: 0.503 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 6.226260185241699
Epoch: 6, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.808 Vali Acc: 0.520 Test Loss: 0.808 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.76872992515564
Epoch: 7, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.934 Vali Acc: 0.550 Test Loss: 0.934 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 5.281047821044922
Epoch: 8, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.639 Vali Acc: 0.500 Test Loss: 1.639 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.679168939590454
Epoch: 9, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.951 Vali Acc: 0.460 Test Loss: 0.951 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.157534599304199
Epoch: 10, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.996 Vali Acc: 0.510 Test Loss: 0.996 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.455023765563965
Epoch: 11, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.830 Vali Acc: 0.520 Test Loss: 1.830 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.116895437240601
Epoch: 12, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.148 Vali Acc: 0.480 Test Loss: 1.148 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.115229606628418
Epoch: 13, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.401 Vali Acc: 0.490 Test Loss: 1.401 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.374053716659546
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.500 Vali Acc: 0.450 Test Loss: 1.500 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.4876227378845215
Epoch: 15, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.733 Vali Acc: 0.490 Test Loss: 1.733 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.616974592208862
Epoch: 16, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.900 Vali Acc: 0.440 Test Loss: 1.900 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.938255786895752
Epoch: 17, Steps: 18 | Train Loss: 0.067 Vali Loss: 2.005 Vali Acc: 0.480 Test Loss: 2.005 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 114386
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.628558874130249
Epoch: 1, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 9.5661301612854
Epoch: 2, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
Validation loss decreased (-0.469992 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 9.670531749725342
Epoch: 3, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 10.926620244979858
Epoch: 4, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.790016889572144
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.728 Vali Acc: 0.560 Test Loss: 0.728 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.775783777236938
Epoch: 6, Steps: 18 | Train Loss: 0.451 Vali Loss: 0.705 Vali Acc: 0.560 Test Loss: 0.705 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.266765594482422
Epoch: 7, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.689 Vali Acc: 0.570 Test Loss: 0.689 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 8 cost time: 6.629757404327393
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.395938873291016
Epoch: 9, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.805 Vali Acc: 0.600 Test Loss: 0.805 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 10 cost time: 9.193072319030762
Epoch: 10, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.820 Vali Acc: 0.550 Test Loss: 0.820 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.20568299293518
Epoch: 11, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.005 Vali Acc: 0.490 Test Loss: 1.005 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.121224164962769
Epoch: 12, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.948 Vali Acc: 0.530 Test Loss: 0.948 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.098722219467163
Epoch: 13, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.940 Vali Acc: 0.580 Test Loss: 0.940 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.067797422409058
Epoch: 14, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.903 Vali Acc: 0.550 Test Loss: 0.903 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.548816204071045
Epoch: 15, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.949 Vali Acc: 0.540 Test Loss: 0.949 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.499833583831787
Epoch: 16, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.793882131576538
Epoch: 17, Steps: 18 | Train Loss: 0.067 Vali Loss: 1.639 Vali Acc: 0.510 Test Loss: 1.639 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.98737382888794
Epoch: 18, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.121 Vali Acc: 0.510 Test Loss: 1.121 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.984102249145508
Epoch: 19, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.271 Vali Acc: 0.570 Test Loss: 1.271 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 269666
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.899423360824585
Epoch: 1, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 4.6232240200042725
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.725 Vali Acc: 0.430 Test Loss: 0.725 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.035923480987549
Epoch: 3, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.846 Vali Acc: 0.470 Test Loss: 0.846 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.796874523162842
Epoch: 4, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.858 Vali Acc: 0.460 Test Loss: 0.858 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.846453428268433
Epoch: 5, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 6 cost time: 5.553254842758179
Epoch: 6, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.812 Vali Acc: 0.500 Test Loss: 0.812 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.411273717880249
Epoch: 7, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.963 Vali Acc: 0.500 Test Loss: 0.963 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.382668733596802
Epoch: 8, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.444958209991455
Epoch: 9, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.116 Vali Acc: 0.510 Test Loss: 1.116 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.3145623207092285
Epoch: 10, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.851 Vali Acc: 0.530 Test Loss: 0.851 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 11 cost time: 5.33996057510376
Epoch: 11, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.341 Vali Acc: 0.530 Test Loss: 1.341 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.964285850524902
Epoch: 12, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.003 Vali Acc: 0.550 Test Loss: 1.003 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 4.951516628265381
Epoch: 13, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.360 Vali Acc: 0.490 Test Loss: 1.360 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.02335524559021
Epoch: 14, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.542 Vali Acc: 0.480 Test Loss: 1.542 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.375750303268433
Epoch: 15, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.558147430419922
Epoch: 16, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.862 Vali Acc: 0.470 Test Loss: 1.862 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.51967191696167
Epoch: 17, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.202 Vali Acc: 0.460 Test Loss: 2.202 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.552237272262573
Epoch: 18, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.489 Vali Acc: 0.470 Test Loss: 2.489 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.582180500030518
Epoch: 19, Steps: 18 | Train Loss: 0.081 Vali Loss: 2.818 Vali Acc: 0.470 Test Loss: 2.818 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.629974126815796
Epoch: 20, Steps: 18 | Train Loss: 0.072 Vali Loss: 2.158 Vali Acc: 0.450 Test Loss: 2.158 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.2388014793396
Epoch: 21, Steps: 18 | Train Loss: 0.028 Vali Loss: 1.701 Vali Acc: 0.520 Test Loss: 1.701 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.078827142715454
Epoch: 22, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.555 Vali Acc: 0.540 Test Loss: 1.555 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 114386
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 226.6640968322754
Epoch: 1, Steps: 18 | Train Loss: 1.115 Vali Loss: 1.103 Vali Acc: 0.510 Test Loss: 1.103 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 267.8083713054657
Epoch: 2, Steps: 18 | Train Loss: 1.163 Vali Loss: 1.082 Vali Acc: 0.520 Test Loss: 1.082 Test Acc: 0.520
Validation loss decreased (-0.509989 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 229.45070457458496
Epoch: 3, Steps: 18 | Train Loss: 1.322 Vali Loss: 4.799 Vali Acc: 0.490 Test Loss: 4.799 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 259.24186992645264
Epoch: 4, Steps: 18 | Train Loss: 1.476 Vali Loss: 3.602 Vali Acc: 0.550 Test Loss: 3.602 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549964).  Saving model ...
Epoch: 5 cost time: 249.317724943161
Epoch: 5, Steps: 18 | Train Loss: 1.539 Vali Loss: 6.141 Vali Acc: 0.420 Test Loss: 6.141 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 249.99878549575806
Epoch: 6, Steps: 18 | Train Loss: 1.704 Vali Loss: 8.822 Vali Acc: 0.490 Test Loss: 8.822 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 276.8033103942871
Epoch: 7, Steps: 18 | Train Loss: 1.916 Vali Loss: 8.755 Vali Acc: 0.510 Test Loss: 8.755 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 220.77048254013062
Epoch: 8, Steps: 18 | Train Loss: 0.993 Vali Loss: 3.678 Vali Acc: 0.530 Test Loss: 3.678 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 180.28252506256104
Epoch: 9, Steps: 18 | Train Loss: 1.323 Vali Loss: 8.461 Vali Acc: 0.520 Test Loss: 8.461 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 178.03351020812988
Epoch: 10, Steps: 18 | Train Loss: 0.532 Vali Loss: 3.607 Vali Acc: 0.530 Test Loss: 3.607 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 256.41463327407837
Epoch: 11, Steps: 18 | Train Loss: 0.740 Vali Loss: 16.125 Vali Acc: 0.490 Test Loss: 16.125 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 244.0991702079773
Epoch: 12, Steps: 18 | Train Loss: 1.119 Vali Loss: 14.102 Vali Acc: 0.520 Test Loss: 14.102 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 238.21902441978455
Epoch: 13, Steps: 18 | Train Loss: 1.901 Vali Loss: 8.737 Vali Acc: 0.500 Test Loss: 8.737 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 256.9732189178467
Epoch: 14, Steps: 18 | Train Loss: 0.702 Vali Loss: 7.282 Vali Acc: 0.530 Test Loss: 7.282 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 38284546
model size : 148.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 88.36392974853516
Epoch: 1, Steps: 18 | Train Loss: 1.369 Vali Loss: 1.170 Vali Acc: 0.610 Test Loss: 1.170 Test Acc: 0.610
Validation loss decreased (inf --> -0.609988).  Saving model ...
Epoch: 2 cost time: 91.64501738548279
Epoch: 2, Steps: 18 | Train Loss: 1.432 Vali Loss: 1.920 Vali Acc: 0.490 Test Loss: 1.920 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 102.77238774299622
Epoch: 3, Steps: 18 | Train Loss: 1.784 Vali Loss: 5.390 Vali Acc: 0.480 Test Loss: 5.390 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 102.67538070678711
Epoch: 4, Steps: 18 | Train Loss: 2.412 Vali Loss: 7.590 Vali Acc: 0.450 Test Loss: 7.590 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 88.3522298336029
Epoch: 5, Steps: 18 | Train Loss: 1.633 Vali Loss: 2.214 Vali Acc: 0.530 Test Loss: 2.214 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 84.65529441833496
Epoch: 6, Steps: 18 | Train Loss: 2.742 Vali Loss: 2.733 Vali Acc: 0.550 Test Loss: 2.733 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 97.33974123001099
Epoch: 7, Steps: 18 | Train Loss: 1.221 Vali Loss: 2.363 Vali Acc: 0.580 Test Loss: 2.363 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 99.45402550697327
Epoch: 8, Steps: 18 | Train Loss: 2.597 Vali Loss: 4.524 Vali Acc: 0.550 Test Loss: 4.524 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 93.14598608016968
Epoch: 9, Steps: 18 | Train Loss: 2.057 Vali Loss: 10.020 Vali Acc: 0.470 Test Loss: 10.020 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 81.80981516838074
Epoch: 10, Steps: 18 | Train Loss: 1.830 Vali Loss: 4.509 Vali Acc: 0.500 Test Loss: 4.509 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 86.24314045906067
Epoch: 11, Steps: 18 | Train Loss: 1.181 Vali Loss: 12.292 Vali Acc: 0.530 Test Loss: 12.292 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 11806466
model size : 47.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 185.5462610721588
Epoch: 1, Steps: 18 | Train Loss: 1.114 Vali Loss: 1.094 Vali Acc: 0.510 Test Loss: 1.094 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 164.14726305007935
Epoch: 2, Steps: 18 | Train Loss: 1.179 Vali Loss: 1.183 Vali Acc: 0.540 Test Loss: 1.183 Test Acc: 0.540
Validation loss decreased (-0.509989 --> -0.539988).  Saving model ...
Epoch: 3 cost time: 188.360032081604
Epoch: 3, Steps: 18 | Train Loss: 1.305 Vali Loss: 5.077 Vali Acc: 0.500 Test Loss: 5.077 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 165.43591594696045
Epoch: 4, Steps: 18 | Train Loss: 1.502 Vali Loss: 3.647 Vali Acc: 0.510 Test Loss: 3.647 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 193.5480556488037
Epoch: 5, Steps: 18 | Train Loss: 0.944 Vali Loss: 7.765 Vali Acc: 0.470 Test Loss: 7.765 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 167.47442030906677
Epoch: 6, Steps: 18 | Train Loss: 2.048 Vali Loss: 11.103 Vali Acc: 0.490 Test Loss: 11.103 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 211.5624988079071
Epoch: 7, Steps: 18 | Train Loss: 1.455 Vali Loss: 4.316 Vali Acc: 0.510 Test Loss: 4.316 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 207.73588752746582
Epoch: 8, Steps: 18 | Train Loss: 1.335 Vali Loss: 7.036 Vali Acc: 0.530 Test Loss: 7.036 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 199.23669123649597
Epoch: 9, Steps: 18 | Train Loss: 1.291 Vali Loss: 6.954 Vali Acc: 0.540 Test Loss: 6.954 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 227.7996277809143
Epoch: 10, Steps: 18 | Train Loss: 0.909 Vali Loss: 7.855 Vali Acc: 0.530 Test Loss: 7.855 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 198.16471552848816
Epoch: 11, Steps: 18 | Train Loss: 2.394 Vali Loss: 6.159 Vali Acc: 0.520 Test Loss: 6.159 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 225.85133957862854
Epoch: 12, Steps: 18 | Train Loss: 0.781 Vali Loss: 5.115 Vali Acc: 0.550 Test Loss: 5.115 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549949).  Saving model ...
Epoch: 13 cost time: 175.34266424179077
Epoch: 13, Steps: 18 | Train Loss: 0.706 Vali Loss: 6.112 Vali Acc: 0.530 Test Loss: 6.112 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 200.32609391212463
Epoch: 14, Steps: 18 | Train Loss: 1.217 Vali Loss: 4.960 Vali Acc: 0.550 Test Loss: 4.960 Test Acc: 0.550
Validation loss decreased (-0.549949 --> -0.549950).  Saving model ...
Epoch: 15 cost time: 182.2672781944275
Epoch: 15, Steps: 18 | Train Loss: 1.459 Vali Loss: 8.963 Vali Acc: 0.510 Test Loss: 8.963 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 190.916925907135
Epoch: 16, Steps: 18 | Train Loss: 3.893 Vali Loss: 19.819 Vali Acc: 0.510 Test Loss: 19.819 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 193.9789161682129
Epoch: 17, Steps: 18 | Train Loss: 1.086 Vali Loss: 9.127 Vali Acc: 0.520 Test Loss: 9.127 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 176.1014313697815
Epoch: 18, Steps: 18 | Train Loss: 1.158 Vali Loss: 12.887 Vali Acc: 0.520 Test Loss: 12.887 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 216.92156791687012
Epoch: 19, Steps: 18 | Train Loss: 2.512 Vali Loss: 10.754 Vali Acc: 0.510 Test Loss: 10.754 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 188.7360577583313
Epoch: 20, Steps: 18 | Train Loss: 1.769 Vali Loss: 23.645 Vali Acc: 0.500 Test Loss: 23.645 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 219.68597960472107
Epoch: 21, Steps: 18 | Train Loss: 0.879 Vali Loss: 20.393 Vali Acc: 0.530 Test Loss: 20.393 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 198.77773332595825
Epoch: 22, Steps: 18 | Train Loss: 0.839 Vali Loss: 16.991 Vali Acc: 0.530 Test Loss: 16.991 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 206.13950204849243
Epoch: 23, Steps: 18 | Train Loss: 0.322 Vali Loss: 14.543 Vali Acc: 0.540 Test Loss: 14.543 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 207.87235927581787
Epoch: 24, Steps: 18 | Train Loss: 0.879 Vali Loss: 15.003 Vali Acc: 0.540 Test Loss: 15.003 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 38284546
model size : 148.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 76.19195699691772
Epoch: 1, Steps: 18 | Train Loss: 1.347 Vali Loss: 1.191 Vali Acc: 0.590 Test Loss: 1.191 Test Acc: 0.590
Validation loss decreased (inf --> -0.589988).  Saving model ...
Epoch: 2 cost time: 71.65531396865845
Epoch: 2, Steps: 18 | Train Loss: 1.498 Vali Loss: 1.669 Vali Acc: 0.470 Test Loss: 1.669 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.50487232208252
Epoch: 3, Steps: 18 | Train Loss: 0.713 Vali Loss: 2.836 Vali Acc: 0.420 Test Loss: 2.836 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 69.91431283950806
Epoch: 4, Steps: 18 | Train Loss: 0.668 Vali Loss: 4.650 Vali Acc: 0.460 Test Loss: 4.650 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 73.06665778160095
Epoch: 5, Steps: 18 | Train Loss: 1.069 Vali Loss: 4.023 Vali Acc: 0.560 Test Loss: 4.023 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 63.19234299659729
Epoch: 6, Steps: 18 | Train Loss: 1.758 Vali Loss: 3.832 Vali Acc: 0.530 Test Loss: 3.832 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 61.10501050949097
Epoch: 7, Steps: 18 | Train Loss: 0.870 Vali Loss: 2.940 Vali Acc: 0.470 Test Loss: 2.940 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 65.84998154640198
Epoch: 8, Steps: 18 | Train Loss: 0.690 Vali Loss: 3.244 Vali Acc: 0.510 Test Loss: 3.244 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 75.12047457695007
Epoch: 9, Steps: 18 | Train Loss: 1.664 Vali Loss: 8.393 Vali Acc: 0.500 Test Loss: 8.393 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 74.24034094810486
Epoch: 10, Steps: 18 | Train Loss: 0.903 Vali Loss: 9.779 Vali Acc: 0.460 Test Loss: 9.779 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 60.19423866271973
Epoch: 11, Steps: 18 | Train Loss: 1.217 Vali Loss: 4.593 Vali Acc: 0.510 Test Loss: 4.593 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 11806466
model size : 47.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 123.04833316802979
Epoch: 1, Steps: 18 | Train Loss: 1.112 Vali Loss: 1.080 Vali Acc: 0.510 Test Loss: 1.080 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 105.49485540390015
Epoch: 2, Steps: 18 | Train Loss: 1.112 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.509989 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 103.5453097820282
Epoch: 3, Steps: 18 | Train Loss: 1.137 Vali Loss: 2.861 Vali Acc: 0.490 Test Loss: 2.861 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 122.46044039726257
Epoch: 4, Steps: 18 | Train Loss: 0.877 Vali Loss: 3.851 Vali Acc: 0.520 Test Loss: 3.851 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 103.2279851436615
Epoch: 5, Steps: 18 | Train Loss: 0.726 Vali Loss: 2.772 Vali Acc: 0.550 Test Loss: 2.772 Test Acc: 0.550
Validation loss decreased (-0.519989 --> -0.549972).  Saving model ...
Epoch: 6 cost time: 113.56213450431824
Epoch: 6, Steps: 18 | Train Loss: 1.446 Vali Loss: 7.311 Vali Acc: 0.460 Test Loss: 7.311 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 126.70755171775818
Epoch: 7, Steps: 18 | Train Loss: 1.418 Vali Loss: 3.733 Vali Acc: 0.530 Test Loss: 3.733 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 104.57193112373352
Epoch: 8, Steps: 18 | Train Loss: 1.263 Vali Loss: 3.894 Vali Acc: 0.500 Test Loss: 3.894 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 118.58698177337646
Epoch: 9, Steps: 18 | Train Loss: 1.040 Vali Loss: 5.010 Vali Acc: 0.450 Test Loss: 5.010 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 117.2779278755188
Epoch: 10, Steps: 18 | Train Loss: 0.499 Vali Loss: 4.477 Vali Acc: 0.510 Test Loss: 4.477 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 102.83326411247253
Epoch: 11, Steps: 18 | Train Loss: 0.682 Vali Loss: 4.877 Vali Acc: 0.530 Test Loss: 4.877 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 126.33695888519287
Epoch: 12, Steps: 18 | Train Loss: 1.920 Vali Loss: 6.437 Vali Acc: 0.530 Test Loss: 6.437 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 110.94355249404907
Epoch: 13, Steps: 18 | Train Loss: 1.145 Vali Loss: 5.857 Vali Acc: 0.540 Test Loss: 5.857 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 99.72484278678894
Epoch: 14, Steps: 18 | Train Loss: 1.698 Vali Loss: 7.672 Vali Acc: 0.470 Test Loss: 7.672 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 117.21742177009583
Epoch: 15, Steps: 18 | Train Loss: 0.822 Vali Loss: 8.432 Vali Acc: 0.520 Test Loss: 8.432 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 38284546
model size : 148.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 38.958627700805664
Epoch: 1, Steps: 18 | Train Loss: 1.329 Vali Loss: 1.240 Vali Acc: 0.600 Test Loss: 1.240 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 37.88868474960327
Epoch: 2, Steps: 18 | Train Loss: 1.643 Vali Loss: 2.149 Vali Acc: 0.540 Test Loss: 2.149 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 46.16203737258911
Epoch: 3, Steps: 18 | Train Loss: 0.816 Vali Loss: 2.877 Vali Acc: 0.520 Test Loss: 2.877 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 45.75538682937622
Epoch: 4, Steps: 18 | Train Loss: 0.906 Vali Loss: 1.883 Vali Acc: 0.530 Test Loss: 1.883 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 45.10560631752014
Epoch: 5, Steps: 18 | Train Loss: 1.220 Vali Loss: 2.098 Vali Acc: 0.540 Test Loss: 2.098 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 38.1082649230957
Epoch: 6, Steps: 18 | Train Loss: 1.186 Vali Loss: 4.104 Vali Acc: 0.590 Test Loss: 4.104 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 36.454472064971924
Epoch: 7, Steps: 18 | Train Loss: 0.862 Vali Loss: 3.330 Vali Acc: 0.500 Test Loss: 3.330 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 35.79436469078064
Epoch: 8, Steps: 18 | Train Loss: 1.152 Vali Loss: 6.363 Vali Acc: 0.530 Test Loss: 6.363 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 37.14670419692993
Epoch: 9, Steps: 18 | Train Loss: 1.716 Vali Loss: 3.474 Vali Acc: 0.530 Test Loss: 3.474 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 49.0693473815918
Epoch: 10, Steps: 18 | Train Loss: 1.190 Vali Loss: 3.698 Vali Acc: 0.480 Test Loss: 3.698 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 51.53630709648132
Epoch: 11, Steps: 18 | Train Loss: 0.714 Vali Loss: 5.022 Vali Acc: 0.460 Test Loss: 5.022 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 11806466
model size : 47.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 126.10105061531067
Epoch: 1, Steps: 18 | Train Loss: 0.952 Vali Loss: 1.008 Vali Acc: 0.550 Test Loss: 1.008 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 146.34010457992554
Epoch: 2, Steps: 18 | Train Loss: 0.994 Vali Loss: 3.211 Vali Acc: 0.490 Test Loss: 3.211 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 128.04480075836182
Epoch: 3, Steps: 18 | Train Loss: 2.252 Vali Loss: 4.466 Vali Acc: 0.460 Test Loss: 4.466 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 131.75745105743408
Epoch: 4, Steps: 18 | Train Loss: 3.155 Vali Loss: 2.789 Vali Acc: 0.500 Test Loss: 2.789 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 140.6673185825348
Epoch: 5, Steps: 18 | Train Loss: 1.539 Vali Loss: 6.645 Vali Acc: 0.470 Test Loss: 6.645 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 124.1818106174469
Epoch: 6, Steps: 18 | Train Loss: 0.863 Vali Loss: 3.508 Vali Acc: 0.540 Test Loss: 3.508 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 144.79587411880493
Epoch: 7, Steps: 18 | Train Loss: 1.577 Vali Loss: 3.680 Vali Acc: 0.540 Test Loss: 3.680 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 120.21127033233643
Epoch: 8, Steps: 18 | Train Loss: 1.063 Vali Loss: 6.078 Vali Acc: 0.470 Test Loss: 6.078 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 145.91189289093018
Epoch: 9, Steps: 18 | Train Loss: 0.862 Vali Loss: 3.451 Vali Acc: 0.560 Test Loss: 3.451 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559965).  Saving model ...
Epoch: 10 cost time: 130.2213351726532
Epoch: 10, Steps: 18 | Train Loss: 1.245 Vali Loss: 13.652 Vali Acc: 0.530 Test Loss: 13.652 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 131.1343173980713
Epoch: 11, Steps: 18 | Train Loss: 1.095 Vali Loss: 7.901 Vali Acc: 0.470 Test Loss: 7.901 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 138.15505027770996
Epoch: 12, Steps: 18 | Train Loss: 0.767 Vali Loss: 6.949 Vali Acc: 0.510 Test Loss: 6.949 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 109.03911066055298
Epoch: 13, Steps: 18 | Train Loss: 2.108 Vali Loss: 5.415 Vali Acc: 0.560 Test Loss: 5.415 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 107.49422144889832
Epoch: 14, Steps: 18 | Train Loss: 0.595 Vali Loss: 5.738 Vali Acc: 0.550 Test Loss: 5.738 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 133.3424310684204
Epoch: 15, Steps: 18 | Train Loss: 1.564 Vali Loss: 11.071 Vali Acc: 0.500 Test Loss: 11.071 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 114.11062121391296
Epoch: 16, Steps: 18 | Train Loss: 1.353 Vali Loss: 5.203 Vali Acc: 0.530 Test Loss: 5.203 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 137.45280051231384
Epoch: 17, Steps: 18 | Train Loss: 0.555 Vali Loss: 9.929 Vali Acc: 0.520 Test Loss: 9.929 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 122.69198727607727
Epoch: 18, Steps: 18 | Train Loss: 0.441 Vali Loss: 22.595 Vali Acc: 0.440 Test Loss: 22.595 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 120.14755749702454
Epoch: 19, Steps: 18 | Train Loss: 0.707 Vali Loss: 11.714 Vali Acc: 0.480 Test Loss: 11.714 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 19539714
model size : 77.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 57.14707970619202
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.488 Vali Acc: 0.490 Test Loss: 1.488 Test Acc: 0.490
Validation loss decreased (inf --> -0.489985).  Saving model ...
Epoch: 2 cost time: 48.31900882720947
Epoch: 2, Steps: 18 | Train Loss: 0.762 Vali Loss: 1.513 Vali Acc: 0.620 Test Loss: 1.513 Test Acc: 0.620
Validation loss decreased (-0.489985 --> -0.619985).  Saving model ...
Epoch: 3 cost time: 48.315696477890015
Epoch: 3, Steps: 18 | Train Loss: 1.532 Vali Loss: 3.390 Vali Acc: 0.520 Test Loss: 3.390 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 52.699005126953125
Epoch: 4, Steps: 18 | Train Loss: 1.311 Vali Loss: 1.879 Vali Acc: 0.520 Test Loss: 1.879 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 58.643637895584106
Epoch: 5, Steps: 18 | Train Loss: 0.758 Vali Loss: 2.036 Vali Acc: 0.540 Test Loss: 2.036 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 57.27259969711304
Epoch: 6, Steps: 18 | Train Loss: 1.223 Vali Loss: 4.974 Vali Acc: 0.530 Test Loss: 4.974 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 53.402798891067505
Epoch: 7, Steps: 18 | Train Loss: 1.298 Vali Loss: 5.469 Vali Acc: 0.540 Test Loss: 5.469 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 47.69212341308594
Epoch: 8, Steps: 18 | Train Loss: 0.764 Vali Loss: 3.745 Vali Acc: 0.530 Test Loss: 3.745 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 46.16707897186279
Epoch: 9, Steps: 18 | Train Loss: 1.390 Vali Loss: 3.848 Vali Acc: 0.510 Test Loss: 3.848 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 48.76864171028137
Epoch: 10, Steps: 18 | Train Loss: 2.200 Vali Loss: 17.728 Vali Acc: 0.500 Test Loss: 17.728 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 55.575339794158936
Epoch: 11, Steps: 18 | Train Loss: 2.530 Vali Loss: 8.612 Vali Acc: 0.530 Test Loss: 8.612 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 56.84440493583679
Epoch: 12, Steps: 18 | Train Loss: 0.654 Vali Loss: 4.826 Vali Acc: 0.480 Test Loss: 4.826 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6300418
model size : 26.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 99.00395727157593
Epoch: 1, Steps: 18 | Train Loss: 0.953 Vali Loss: 1.007 Vali Acc: 0.550 Test Loss: 1.007 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 113.29418635368347
Epoch: 2, Steps: 18 | Train Loss: 0.993 Vali Loss: 3.218 Vali Acc: 0.490 Test Loss: 3.218 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 106.1302878856659
Epoch: 3, Steps: 18 | Train Loss: 2.263 Vali Loss: 4.395 Vali Acc: 0.460 Test Loss: 4.395 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 89.89544486999512
Epoch: 4, Steps: 18 | Train Loss: 3.087 Vali Loss: 3.066 Vali Acc: 0.490 Test Loss: 3.066 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 107.74850606918335
Epoch: 5, Steps: 18 | Train Loss: 1.536 Vali Loss: 5.954 Vali Acc: 0.490 Test Loss: 5.954 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 110.97296380996704
Epoch: 6, Steps: 18 | Train Loss: 1.031 Vali Loss: 3.987 Vali Acc: 0.530 Test Loss: 3.987 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 87.88342213630676
Epoch: 7, Steps: 18 | Train Loss: 1.622 Vali Loss: 5.394 Vali Acc: 0.490 Test Loss: 5.394 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 98.32285952568054
Epoch: 8, Steps: 18 | Train Loss: 1.631 Vali Loss: 6.205 Vali Acc: 0.470 Test Loss: 6.205 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 104.93073725700378
Epoch: 9, Steps: 18 | Train Loss: 0.625 Vali Loss: 5.119 Vali Acc: 0.510 Test Loss: 5.119 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 85.05692338943481
Epoch: 10, Steps: 18 | Train Loss: 1.304 Vali Loss: 9.537 Vali Acc: 0.470 Test Loss: 9.537 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 92.44334053993225
Epoch: 11, Steps: 18 | Train Loss: 0.784 Vali Loss: 5.327 Vali Acc: 0.510 Test Loss: 5.327 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 19539714
model size : 77.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 36.93055510520935
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 1.501 Vali Acc: 0.490 Test Loss: 1.501 Test Acc: 0.490
Validation loss decreased (inf --> -0.489985).  Saving model ...
Epoch: 2 cost time: 33.71858882904053
Epoch: 2, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.525 Vali Acc: 0.620 Test Loss: 1.525 Test Acc: 0.620
Validation loss decreased (-0.489985 --> -0.619985).  Saving model ...
Epoch: 3 cost time: 32.346983432769775
Epoch: 3, Steps: 18 | Train Loss: 1.597 Vali Loss: 3.778 Vali Acc: 0.470 Test Loss: 3.778 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 39.30183720588684
Epoch: 4, Steps: 18 | Train Loss: 1.728 Vali Loss: 1.789 Vali Acc: 0.480 Test Loss: 1.789 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 40.88159894943237
Epoch: 5, Steps: 18 | Train Loss: 0.626 Vali Loss: 2.435 Vali Acc: 0.500 Test Loss: 2.435 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 41.606852293014526
Epoch: 6, Steps: 18 | Train Loss: 0.729 Vali Loss: 6.350 Vali Acc: 0.490 Test Loss: 6.350 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 40.62336754798889
Epoch: 7, Steps: 18 | Train Loss: 1.351 Vali Loss: 4.921 Vali Acc: 0.480 Test Loss: 4.921 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 34.65138578414917
Epoch: 8, Steps: 18 | Train Loss: 0.941 Vali Loss: 6.154 Vali Acc: 0.520 Test Loss: 6.154 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 34.30676627159119
Epoch: 9, Steps: 18 | Train Loss: 0.746 Vali Loss: 9.485 Vali Acc: 0.500 Test Loss: 9.485 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 34.739744424819946
Epoch: 10, Steps: 18 | Train Loss: 1.347 Vali Loss: 5.176 Vali Acc: 0.610 Test Loss: 5.176 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 37.27646827697754
Epoch: 11, Steps: 18 | Train Loss: 1.262 Vali Loss: 5.055 Vali Acc: 0.530 Test Loss: 5.055 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 42.47236919403076
Epoch: 12, Steps: 18 | Train Loss: 1.157 Vali Loss: 8.616 Vali Acc: 0.460 Test Loss: 8.616 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6300418
model size : 26.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 67.26050639152527
Epoch: 1, Steps: 18 | Train Loss: 0.953 Vali Loss: 1.003 Vali Acc: 0.550 Test Loss: 1.003 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 53.231046199798584
Epoch: 2, Steps: 18 | Train Loss: 0.994 Vali Loss: 3.229 Vali Acc: 0.490 Test Loss: 3.229 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.72647309303284
Epoch: 3, Steps: 18 | Train Loss: 2.276 Vali Loss: 4.473 Vali Acc: 0.460 Test Loss: 4.473 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 61.498372316360474
Epoch: 4, Steps: 18 | Train Loss: 3.040 Vali Loss: 2.547 Vali Acc: 0.490 Test Loss: 2.547 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 67.60486268997192
Epoch: 5, Steps: 18 | Train Loss: 0.892 Vali Loss: 5.422 Vali Acc: 0.470 Test Loss: 5.422 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 63.67432928085327
Epoch: 6, Steps: 18 | Train Loss: 0.816 Vali Loss: 4.944 Vali Acc: 0.480 Test Loss: 4.944 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 59.14146852493286
Epoch: 7, Steps: 18 | Train Loss: 1.536 Vali Loss: 3.055 Vali Acc: 0.530 Test Loss: 3.055 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 58.05322766304016
Epoch: 8, Steps: 18 | Train Loss: 1.202 Vali Loss: 5.717 Vali Acc: 0.490 Test Loss: 5.717 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 68.64159560203552
Epoch: 9, Steps: 18 | Train Loss: 0.778 Vali Loss: 5.810 Vali Acc: 0.490 Test Loss: 5.810 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 68.35580134391785
Epoch: 10, Steps: 18 | Train Loss: 1.442 Vali Loss: 7.763 Vali Acc: 0.550 Test Loss: 7.763 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 63.03956604003906
Epoch: 11, Steps: 18 | Train Loss: 1.507 Vali Loss: 4.134 Vali Acc: 0.560 Test Loss: 4.134 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559959).  Saving model ...
Epoch: 12 cost time: 54.535011768341064
Epoch: 12, Steps: 18 | Train Loss: 1.174 Vali Loss: 7.385 Vali Acc: 0.520 Test Loss: 7.385 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 55.16980743408203
Epoch: 13, Steps: 18 | Train Loss: 1.938 Vali Loss: 13.371 Vali Acc: 0.560 Test Loss: 13.371 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 67.78908610343933
Epoch: 14, Steps: 18 | Train Loss: 1.435 Vali Loss: 6.907 Vali Acc: 0.540 Test Loss: 6.907 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 68.60241436958313
Epoch: 15, Steps: 18 | Train Loss: 2.826 Vali Loss: 13.803 Vali Acc: 0.520 Test Loss: 13.803 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 64.55747747421265
Epoch: 16, Steps: 18 | Train Loss: 1.334 Vali Loss: 20.965 Vali Acc: 0.490 Test Loss: 20.965 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 57.77435898780823
Epoch: 17, Steps: 18 | Train Loss: 1.820 Vali Loss: 13.674 Vali Acc: 0.480 Test Loss: 13.674 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 55.85906672477722
Epoch: 18, Steps: 18 | Train Loss: 1.149 Vali Loss: 7.572 Vali Acc: 0.500 Test Loss: 7.572 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 67.03410148620605
Epoch: 19, Steps: 18 | Train Loss: 0.635 Vali Loss: 7.377 Vali Acc: 0.520 Test Loss: 7.377 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 67.30657958984375
Epoch: 20, Steps: 18 | Train Loss: 0.493 Vali Loss: 10.658 Vali Acc: 0.510 Test Loss: 10.658 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 55.23850893974304
Epoch: 21, Steps: 18 | Train Loss: 0.388 Vali Loss: 10.802 Vali Acc: 0.510 Test Loss: 10.802 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 19539714
model size : 77.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.811641931533813
Epoch: 1, Steps: 18 | Train Loss: 0.826 Vali Loss: 1.497 Vali Acc: 0.490 Test Loss: 1.497 Test Acc: 0.490
Validation loss decreased (inf --> -0.489985).  Saving model ...
Epoch: 2 cost time: 22.476062774658203
Epoch: 2, Steps: 18 | Train Loss: 0.767 Vali Loss: 1.521 Vali Acc: 0.620 Test Loss: 1.521 Test Acc: 0.620
Validation loss decreased (-0.489985 --> -0.619985).  Saving model ...
Epoch: 3 cost time: 25.258004903793335
Epoch: 3, Steps: 18 | Train Loss: 1.634 Vali Loss: 3.663 Vali Acc: 0.480 Test Loss: 3.663 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.982692003250122
Epoch: 4, Steps: 18 | Train Loss: 1.644 Vali Loss: 2.897 Vali Acc: 0.560 Test Loss: 2.897 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.168662309646606
Epoch: 5, Steps: 18 | Train Loss: 0.796 Vali Loss: 4.867 Vali Acc: 0.450 Test Loss: 4.867 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.155765771865845
Epoch: 6, Steps: 18 | Train Loss: 1.968 Vali Loss: 7.297 Vali Acc: 0.540 Test Loss: 7.297 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.498801469802856
Epoch: 7, Steps: 18 | Train Loss: 1.420 Vali Loss: 4.257 Vali Acc: 0.530 Test Loss: 4.257 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 24.733795881271362
Epoch: 8, Steps: 18 | Train Loss: 1.392 Vali Loss: 3.515 Vali Acc: 0.560 Test Loss: 3.515 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.971238374710083
Epoch: 9, Steps: 18 | Train Loss: 1.009 Vali Loss: 3.831 Vali Acc: 0.550 Test Loss: 3.831 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 20.688527822494507
Epoch: 10, Steps: 18 | Train Loss: 1.010 Vali Loss: 7.559 Vali Acc: 0.500 Test Loss: 7.559 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 21.51399326324463
Epoch: 11, Steps: 18 | Train Loss: 0.990 Vali Loss: 12.647 Vali Acc: 0.530 Test Loss: 12.647 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 22.215830087661743
Epoch: 12, Steps: 18 | Train Loss: 2.479 Vali Loss: 3.841 Vali Acc: 0.550 Test Loss: 3.841 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 6300418
model size : 26.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 161.74491453170776
Epoch: 1, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.840 Vali Acc: 0.610 Test Loss: 0.840 Test Acc: 0.610
Validation loss decreased (inf --> -0.609992).  Saving model ...
Epoch: 2 cost time: 143.71696853637695
Epoch: 2, Steps: 18 | Train Loss: 0.912 Vali Loss: 1.510 Vali Acc: 0.510 Test Loss: 1.510 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 154.222154378891
Epoch: 3, Steps: 18 | Train Loss: 1.397 Vali Loss: 2.222 Vali Acc: 0.500 Test Loss: 2.222 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 166.89034724235535
Epoch: 4, Steps: 18 | Train Loss: 1.132 Vali Loss: 2.841 Vali Acc: 0.500 Test Loss: 2.841 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 175.43143033981323
Epoch: 5, Steps: 18 | Train Loss: 0.802 Vali Loss: 1.416 Vali Acc: 0.620 Test Loss: 1.416 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619986).  Saving model ...
Epoch: 6 cost time: 169.6749804019928
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 1.956 Vali Acc: 0.580 Test Loss: 1.956 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 162.5869152545929
Epoch: 7, Steps: 18 | Train Loss: 0.493 Vali Loss: 2.004 Vali Acc: 0.500 Test Loss: 2.004 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 158.43301844596863
Epoch: 8, Steps: 18 | Train Loss: 0.622 Vali Loss: 7.968 Vali Acc: 0.480 Test Loss: 7.968 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 166.30126476287842
Epoch: 9, Steps: 18 | Train Loss: 1.260 Vali Loss: 6.603 Vali Acc: 0.520 Test Loss: 6.603 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 158.9837486743927
Epoch: 10, Steps: 18 | Train Loss: 1.531 Vali Loss: 5.130 Vali Acc: 0.540 Test Loss: 5.130 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 152.83682894706726
Epoch: 11, Steps: 18 | Train Loss: 0.619 Vali Loss: 2.035 Vali Acc: 0.580 Test Loss: 2.035 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 157.07706356048584
Epoch: 12, Steps: 18 | Train Loss: 0.664 Vali Loss: 4.293 Vali Acc: 0.540 Test Loss: 4.293 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 163.75674676895142
Epoch: 13, Steps: 18 | Train Loss: 0.459 Vali Loss: 6.349 Vali Acc: 0.520 Test Loss: 6.349 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 161.95008659362793
Epoch: 14, Steps: 18 | Train Loss: 0.332 Vali Loss: 4.395 Vali Acc: 0.480 Test Loss: 4.395 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 149.3681285381317
Epoch: 15, Steps: 18 | Train Loss: 0.585 Vali Loss: 8.443 Vali Acc: 0.500 Test Loss: 8.443 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 19143810
model size : 74.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 62.337509632110596
Epoch: 1, Steps: 18 | Train Loss: 1.094 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 64.90682077407837
Epoch: 2, Steps: 18 | Train Loss: 0.882 Vali Loss: 1.033 Vali Acc: 0.440 Test Loss: 1.033 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 66.75655102729797
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 1.290 Vali Acc: 0.530 Test Loss: 1.290 Test Acc: 0.530
Validation loss decreased (-0.499989 --> -0.529987).  Saving model ...
Epoch: 4 cost time: 67.61636328697205
Epoch: 4, Steps: 18 | Train Loss: 0.868 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 67.75458669662476
Epoch: 5, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.852 Vali Acc: 0.480 Test Loss: 1.852 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 67.61573314666748
Epoch: 6, Steps: 18 | Train Loss: 0.635 Vali Loss: 3.103 Vali Acc: 0.510 Test Loss: 3.103 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 68.08809685707092
Epoch: 7, Steps: 18 | Train Loss: 0.979 Vali Loss: 2.510 Vali Acc: 0.510 Test Loss: 2.510 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 61.194589376449585
Epoch: 8, Steps: 18 | Train Loss: 1.014 Vali Loss: 2.766 Vali Acc: 0.580 Test Loss: 2.766 Test Acc: 0.580
Validation loss decreased (-0.529987 --> -0.579972).  Saving model ...
Epoch: 9 cost time: 61.13201427459717
Epoch: 9, Steps: 18 | Train Loss: 0.430 Vali Loss: 2.180 Vali Acc: 0.540 Test Loss: 2.180 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 60.38909149169922
Epoch: 10, Steps: 18 | Train Loss: 0.471 Vali Loss: 2.694 Vali Acc: 0.560 Test Loss: 2.694 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 62.20047903060913
Epoch: 11, Steps: 18 | Train Loss: 0.626 Vali Loss: 3.001 Vali Acc: 0.480 Test Loss: 3.001 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 62.6504385471344
Epoch: 12, Steps: 18 | Train Loss: 1.002 Vali Loss: 6.121 Vali Acc: 0.520 Test Loss: 6.121 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 66.40601086616516
Epoch: 13, Steps: 18 | Train Loss: 0.793 Vali Loss: 5.073 Vali Acc: 0.570 Test Loss: 5.073 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 67.46833992004395
Epoch: 14, Steps: 18 | Train Loss: 1.463 Vali Loss: 3.274 Vali Acc: 0.500 Test Loss: 3.274 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 68.13986396789551
Epoch: 15, Steps: 18 | Train Loss: 1.064 Vali Loss: 6.713 Vali Acc: 0.520 Test Loss: 6.713 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 68.27823853492737
Epoch: 16, Steps: 18 | Train Loss: 0.921 Vali Loss: 5.509 Vali Acc: 0.490 Test Loss: 5.509 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 68.10706067085266
Epoch: 17, Steps: 18 | Train Loss: 0.133 Vali Loss: 6.097 Vali Acc: 0.510 Test Loss: 6.097 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 67.81385397911072
Epoch: 18, Steps: 18 | Train Loss: 0.185 Vali Loss: 4.618 Vali Acc: 0.550 Test Loss: 4.618 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5904258
model size : 23.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 128.87453818321228
Epoch: 1, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.840 Vali Acc: 0.610 Test Loss: 0.840 Test Acc: 0.610
Validation loss decreased (inf --> -0.609992).  Saving model ...
Epoch: 2 cost time: 118.91279649734497
Epoch: 2, Steps: 18 | Train Loss: 0.911 Vali Loss: 1.506 Vali Acc: 0.510 Test Loss: 1.506 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 119.83432936668396
Epoch: 3, Steps: 18 | Train Loss: 1.384 Vali Loss: 2.395 Vali Acc: 0.500 Test Loss: 2.395 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 126.8627872467041
Epoch: 4, Steps: 18 | Train Loss: 1.098 Vali Loss: 2.950 Vali Acc: 0.510 Test Loss: 2.950 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 128.14139699935913
Epoch: 5, Steps: 18 | Train Loss: 0.817 Vali Loss: 1.803 Vali Acc: 0.630 Test Loss: 1.803 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629982).  Saving model ...
Epoch: 6 cost time: 120.64422130584717
Epoch: 6, Steps: 18 | Train Loss: 0.685 Vali Loss: 3.582 Vali Acc: 0.570 Test Loss: 3.582 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 115.11783051490784
Epoch: 7, Steps: 18 | Train Loss: 0.727 Vali Loss: 2.320 Vali Acc: 0.500 Test Loss: 2.320 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 113.73359036445618
Epoch: 8, Steps: 18 | Train Loss: 0.428 Vali Loss: 2.263 Vali Acc: 0.400 Test Loss: 2.263 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 128.25871562957764
Epoch: 9, Steps: 18 | Train Loss: 0.281 Vali Loss: 4.331 Vali Acc: 0.510 Test Loss: 4.331 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 129.33224868774414
Epoch: 10, Steps: 18 | Train Loss: 0.766 Vali Loss: 3.772 Vali Acc: 0.530 Test Loss: 3.772 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 130.55101799964905
Epoch: 11, Steps: 18 | Train Loss: 0.549 Vali Loss: 2.913 Vali Acc: 0.500 Test Loss: 2.913 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 123.56572937965393
Epoch: 12, Steps: 18 | Train Loss: 0.805 Vali Loss: 4.765 Vali Acc: 0.550 Test Loss: 4.765 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 122.03680753707886
Epoch: 13, Steps: 18 | Train Loss: 0.617 Vali Loss: 4.119 Vali Acc: 0.520 Test Loss: 4.119 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 116.14880013465881
Epoch: 14, Steps: 18 | Train Loss: 0.355 Vali Loss: 3.114 Vali Acc: 0.520 Test Loss: 3.114 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 126.30751156806946
Epoch: 15, Steps: 18 | Train Loss: 0.251 Vali Loss: 6.586 Vali Acc: 0.560 Test Loss: 6.586 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 19143810
model size : 74.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 52.29528498649597
Epoch: 1, Steps: 18 | Train Loss: 1.094 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 50.11177134513855
Epoch: 2, Steps: 18 | Train Loss: 0.882 Vali Loss: 1.033 Vali Acc: 0.440 Test Loss: 1.033 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.39122223854065
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 1.290 Vali Acc: 0.530 Test Loss: 1.290 Test Acc: 0.530
Validation loss decreased (-0.499989 --> -0.529987).  Saving model ...
Epoch: 4 cost time: 47.072776556015015
Epoch: 4, Steps: 18 | Train Loss: 0.868 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 45.48248744010925
Epoch: 5, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.877 Vali Acc: 0.480 Test Loss: 1.877 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 45.82647728919983
Epoch: 6, Steps: 18 | Train Loss: 0.573 Vali Loss: 2.960 Vali Acc: 0.540 Test Loss: 2.960 Test Acc: 0.540
Validation loss decreased (-0.529987 --> -0.539970).  Saving model ...
Epoch: 7 cost time: 44.52086901664734
Epoch: 7, Steps: 18 | Train Loss: 0.872 Vali Loss: 2.451 Vali Acc: 0.540 Test Loss: 2.451 Test Acc: 0.540
Validation loss decreased (-0.539970 --> -0.539975).  Saving model ...
Epoch: 8 cost time: 44.81959772109985
Epoch: 8, Steps: 18 | Train Loss: 0.759 Vali Loss: 1.954 Vali Acc: 0.530 Test Loss: 1.954 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 45.221198320388794
Epoch: 9, Steps: 18 | Train Loss: 0.334 Vali Loss: 4.208 Vali Acc: 0.510 Test Loss: 4.208 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 44.51154589653015
Epoch: 10, Steps: 18 | Train Loss: 0.521 Vali Loss: 2.826 Vali Acc: 0.530 Test Loss: 2.826 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 49.0234694480896
Epoch: 11, Steps: 18 | Train Loss: 0.295 Vali Loss: 2.434 Vali Acc: 0.510 Test Loss: 2.434 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 49.026625871658325
Epoch: 12, Steps: 18 | Train Loss: 0.358 Vali Loss: 2.907 Vali Acc: 0.560 Test Loss: 2.907 Test Acc: 0.560
Validation loss decreased (-0.539975 --> -0.559971).  Saving model ...
Epoch: 13 cost time: 49.3114333152771
Epoch: 13, Steps: 18 | Train Loss: 0.452 Vali Loss: 8.058 Vali Acc: 0.520 Test Loss: 8.058 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 50.22827339172363
Epoch: 14, Steps: 18 | Train Loss: 0.363 Vali Loss: 6.805 Vali Acc: 0.520 Test Loss: 6.805 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 53.329665184020996
Epoch: 15, Steps: 18 | Train Loss: 0.958 Vali Loss: 4.769 Vali Acc: 0.490 Test Loss: 4.769 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 55.124427795410156
Epoch: 16, Steps: 18 | Train Loss: 0.444 Vali Loss: 3.472 Vali Acc: 0.490 Test Loss: 3.472 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 56.17390751838684
Epoch: 17, Steps: 18 | Train Loss: 0.219 Vali Loss: 3.806 Vali Acc: 0.530 Test Loss: 3.806 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 55.56379842758179
Epoch: 18, Steps: 18 | Train Loss: 0.103 Vali Loss: 11.987 Vali Acc: 0.470 Test Loss: 11.987 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 51.637160539627075
Epoch: 19, Steps: 18 | Train Loss: 0.335 Vali Loss: 8.538 Vali Acc: 0.450 Test Loss: 8.538 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 49.15545392036438
Epoch: 20, Steps: 18 | Train Loss: 0.279 Vali Loss: 9.817 Vali Acc: 0.460 Test Loss: 9.817 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 48.6607711315155
Epoch: 21, Steps: 18 | Train Loss: 0.860 Vali Loss: 6.749 Vali Acc: 0.530 Test Loss: 6.749 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 52.48394155502319
Epoch: 22, Steps: 18 | Train Loss: 0.119 Vali Loss: 4.271 Vali Acc: 0.570 Test Loss: 4.271 Test Acc: 0.570
Validation loss decreased (-0.559971 --> -0.569957).  Saving model ...
Epoch: 23 cost time: 50.426865339279175
Epoch: 23, Steps: 18 | Train Loss: 0.117 Vali Loss: 8.588 Vali Acc: 0.490 Test Loss: 8.588 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 48.41051173210144
Epoch: 24, Steps: 18 | Train Loss: 0.653 Vali Loss: 8.890 Vali Acc: 0.560 Test Loss: 8.890 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 54.29590559005737
Epoch: 25, Steps: 18 | Train Loss: 0.333 Vali Loss: 6.490 Vali Acc: 0.550 Test Loss: 6.490 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 56.741619348526
Epoch: 26, Steps: 18 | Train Loss: 0.470 Vali Loss: 6.799 Vali Acc: 0.560 Test Loss: 6.799 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 56.38896989822388
Epoch: 27, Steps: 18 | Train Loss: 0.333 Vali Loss: 8.214 Vali Acc: 0.500 Test Loss: 8.214 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 54.68141174316406
Epoch: 28, Steps: 18 | Train Loss: 0.648 Vali Loss: 6.917 Vali Acc: 0.520 Test Loss: 6.917 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 55.24905562400818
Epoch: 29, Steps: 18 | Train Loss: 0.172 Vali Loss: 7.140 Vali Acc: 0.520 Test Loss: 7.140 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 56.30526900291443
Epoch: 30, Steps: 18 | Train Loss: 0.595 Vali Loss: 9.493 Vali Acc: 0.500 Test Loss: 9.493 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5904258
model size : 23.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 84.5218756198883
Epoch: 1, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.839 Vali Acc: 0.610 Test Loss: 0.839 Test Acc: 0.610
Validation loss decreased (inf --> -0.609992).  Saving model ...
Epoch: 2 cost time: 78.43364953994751
Epoch: 2, Steps: 18 | Train Loss: 0.913 Vali Loss: 1.506 Vali Acc: 0.510 Test Loss: 1.506 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 80.78248047828674
Epoch: 3, Steps: 18 | Train Loss: 1.397 Vali Loss: 2.190 Vali Acc: 0.500 Test Loss: 2.190 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 82.30600428581238
Epoch: 4, Steps: 18 | Train Loss: 1.129 Vali Loss: 2.744 Vali Acc: 0.500 Test Loss: 2.744 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 82.71666693687439
Epoch: 5, Steps: 18 | Train Loss: 0.828 Vali Loss: 1.549 Vali Acc: 0.610 Test Loss: 1.549 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 89.41563534736633
Epoch: 6, Steps: 18 | Train Loss: 0.708 Vali Loss: 1.783 Vali Acc: 0.600 Test Loss: 1.783 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 89.63432335853577
Epoch: 7, Steps: 18 | Train Loss: 0.640 Vali Loss: 1.855 Vali Acc: 0.540 Test Loss: 1.855 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 83.66176295280457
Epoch: 8, Steps: 18 | Train Loss: 0.628 Vali Loss: 3.566 Vali Acc: 0.550 Test Loss: 3.566 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 84.58679127693176
Epoch: 9, Steps: 18 | Train Loss: 0.305 Vali Loss: 4.804 Vali Acc: 0.460 Test Loss: 4.804 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 82.08042550086975
Epoch: 10, Steps: 18 | Train Loss: 0.441 Vali Loss: 4.318 Vali Acc: 0.470 Test Loss: 4.318 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 75.59325361251831
Epoch: 11, Steps: 18 | Train Loss: 0.574 Vali Loss: 4.877 Vali Acc: 0.490 Test Loss: 4.877 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 19143810
model size : 74.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 33.48092555999756
Epoch: 1, Steps: 18 | Train Loss: 1.093 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 31.72192883491516
Epoch: 2, Steps: 18 | Train Loss: 0.883 Vali Loss: 1.020 Vali Acc: 0.440 Test Loss: 1.020 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.80138087272644
Epoch: 3, Steps: 18 | Train Loss: 0.607 Vali Loss: 1.172 Vali Acc: 0.560 Test Loss: 1.172 Test Acc: 0.560
Validation loss decreased (-0.499989 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 31.584776878356934
Epoch: 4, Steps: 18 | Train Loss: 0.862 Vali Loss: 1.384 Vali Acc: 0.520 Test Loss: 1.384 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.71040368080139
Epoch: 5, Steps: 18 | Train Loss: 0.773 Vali Loss: 2.683 Vali Acc: 0.470 Test Loss: 2.683 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 32.673473596572876
Epoch: 6, Steps: 18 | Train Loss: 0.763 Vali Loss: 1.518 Vali Acc: 0.520 Test Loss: 1.518 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 34.03145623207092
Epoch: 7, Steps: 18 | Train Loss: 0.675 Vali Loss: 3.034 Vali Acc: 0.510 Test Loss: 3.034 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 32.790708780288696
Epoch: 8, Steps: 18 | Train Loss: 0.798 Vali Loss: 1.858 Vali Acc: 0.530 Test Loss: 1.858 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 33.56144380569458
Epoch: 9, Steps: 18 | Train Loss: 0.391 Vali Loss: 2.263 Vali Acc: 0.570 Test Loss: 2.263 Test Acc: 0.570
Validation loss decreased (-0.559988 --> -0.569977).  Saving model ...
Epoch: 10 cost time: 34.68908381462097
Epoch: 10, Steps: 18 | Train Loss: 0.319 Vali Loss: 4.855 Vali Acc: 0.480 Test Loss: 4.855 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 33.03636884689331
Epoch: 11, Steps: 18 | Train Loss: 0.237 Vali Loss: 3.356 Vali Acc: 0.470 Test Loss: 3.356 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 33.853726625442505
Epoch: 12, Steps: 18 | Train Loss: 0.685 Vali Loss: 3.754 Vali Acc: 0.500 Test Loss: 3.754 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 35.133461475372314
Epoch: 13, Steps: 18 | Train Loss: 0.408 Vali Loss: 4.434 Vali Acc: 0.460 Test Loss: 4.434 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 33.55147576332092
Epoch: 14, Steps: 18 | Train Loss: 0.261 Vali Loss: 5.786 Vali Acc: 0.500 Test Loss: 5.786 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 34.44771933555603
Epoch: 15, Steps: 18 | Train Loss: 0.788 Vali Loss: 8.430 Vali Acc: 0.520 Test Loss: 8.430 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 33.15618276596069
Epoch: 16, Steps: 18 | Train Loss: 0.607 Vali Loss: 3.284 Vali Acc: 0.640 Test Loss: 3.284 Test Acc: 0.640
Validation loss decreased (-0.569977 --> -0.639967).  Saving model ...
Epoch: 17 cost time: 30.48069977760315
Epoch: 17, Steps: 18 | Train Loss: 0.790 Vali Loss: 8.843 Vali Acc: 0.530 Test Loss: 8.843 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 32.05252695083618
Epoch: 18, Steps: 18 | Train Loss: 0.475 Vali Loss: 7.270 Vali Acc: 0.560 Test Loss: 7.270 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 31.663869380950928
Epoch: 19, Steps: 18 | Train Loss: 0.714 Vali Loss: 6.097 Vali Acc: 0.530 Test Loss: 6.097 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 29.795750617980957
Epoch: 20, Steps: 18 | Train Loss: 0.729 Vali Loss: 4.928 Vali Acc: 0.550 Test Loss: 4.928 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 32.35715293884277
Epoch: 21, Steps: 18 | Train Loss: 0.175 Vali Loss: 14.663 Vali Acc: 0.490 Test Loss: 14.663 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 30.30844283103943
Epoch: 22, Steps: 18 | Train Loss: 0.309 Vali Loss: 8.035 Vali Acc: 0.490 Test Loss: 8.035 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 29.245129823684692
Epoch: 23, Steps: 18 | Train Loss: 0.340 Vali Loss: 5.864 Vali Acc: 0.510 Test Loss: 5.864 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 31.42933416366577
Epoch: 24, Steps: 18 | Train Loss: 0.265 Vali Loss: 7.493 Vali Acc: 0.560 Test Loss: 7.493 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 29.284937381744385
Epoch: 25, Steps: 18 | Train Loss: 0.085 Vali Loss: 5.499 Vali Acc: 0.490 Test Loss: 5.499 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 33.648409605026245
Epoch: 26, Steps: 18 | Train Loss: 0.097 Vali Loss: 8.921 Vali Acc: 0.530 Test Loss: 8.921 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5904258
model size : 23.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 94.91788005828857
Epoch: 1, Steps: 18 | Train Loss: 0.848 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 94.67900156974792
Epoch: 2, Steps: 18 | Train Loss: 0.889 Vali Loss: 1.647 Vali Acc: 0.500 Test Loss: 1.647 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 95.61242055892944
Epoch: 3, Steps: 18 | Train Loss: 1.252 Vali Loss: 1.862 Vali Acc: 0.460 Test Loss: 1.862 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 89.27508807182312
Epoch: 4, Steps: 18 | Train Loss: 0.708 Vali Loss: 1.696 Vali Acc: 0.540 Test Loss: 1.696 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 95.45817041397095
Epoch: 5, Steps: 18 | Train Loss: 0.782 Vali Loss: 2.929 Vali Acc: 0.540 Test Loss: 2.929 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 95.44583058357239
Epoch: 6, Steps: 18 | Train Loss: 0.884 Vali Loss: 2.050 Vali Acc: 0.520 Test Loss: 2.050 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 95.08114838600159
Epoch: 7, Steps: 18 | Train Loss: 0.877 Vali Loss: 3.812 Vali Acc: 0.550 Test Loss: 3.812 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 99.46214771270752
Epoch: 8, Steps: 18 | Train Loss: 0.533 Vali Loss: 2.269 Vali Acc: 0.510 Test Loss: 2.269 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 100.5366358757019
Epoch: 9, Steps: 18 | Train Loss: 0.569 Vali Loss: 2.983 Vali Acc: 0.470 Test Loss: 2.983 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 103.98973202705383
Epoch: 10, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.972 Vali Acc: 0.520 Test Loss: 1.972 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 105.62242007255554
Epoch: 11, Steps: 18 | Train Loss: 0.833 Vali Loss: 3.090 Vali Acc: 0.500 Test Loss: 3.090 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9770626
model size : 38.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 39.62133741378784
Epoch: 1, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 38.13843297958374
Epoch: 2, Steps: 18 | Train Loss: 0.850 Vali Loss: 1.136 Vali Acc: 0.530 Test Loss: 1.136 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529989).  Saving model ...
Epoch: 3 cost time: 36.22888422012329
Epoch: 3, Steps: 18 | Train Loss: 0.595 Vali Loss: 1.079 Vali Acc: 0.550 Test Loss: 1.079 Test Acc: 0.550
Validation loss decreased (-0.529989 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 35.45204710960388
Epoch: 4, Steps: 18 | Train Loss: 0.452 Vali Loss: 1.445 Vali Acc: 0.550 Test Loss: 1.445 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 38.25520133972168
Epoch: 5, Steps: 18 | Train Loss: 0.613 Vali Loss: 2.413 Vali Acc: 0.520 Test Loss: 2.413 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 36.6560583114624
Epoch: 6, Steps: 18 | Train Loss: 0.796 Vali Loss: 1.733 Vali Acc: 0.590 Test Loss: 1.733 Test Acc: 0.590
Validation loss decreased (-0.549989 --> -0.589983).  Saving model ...
Epoch: 7 cost time: 35.301308155059814
Epoch: 7, Steps: 18 | Train Loss: 1.226 Vali Loss: 1.963 Vali Acc: 0.520 Test Loss: 1.963 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.81167650222778
Epoch: 8, Steps: 18 | Train Loss: 0.694 Vali Loss: 4.444 Vali Acc: 0.500 Test Loss: 4.444 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 40.51533079147339
Epoch: 9, Steps: 18 | Train Loss: 1.108 Vali Loss: 3.239 Vali Acc: 0.540 Test Loss: 3.239 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 39.23771691322327
Epoch: 10, Steps: 18 | Train Loss: 0.746 Vali Loss: 3.434 Vali Acc: 0.510 Test Loss: 3.434 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 40.70642375946045
Epoch: 11, Steps: 18 | Train Loss: 0.472 Vali Loss: 4.867 Vali Acc: 0.460 Test Loss: 4.867 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 42.26059937477112
Epoch: 12, Steps: 18 | Train Loss: 0.219 Vali Loss: 3.230 Vali Acc: 0.470 Test Loss: 3.230 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 40.96456503868103
Epoch: 13, Steps: 18 | Train Loss: 0.253 Vali Loss: 3.448 Vali Acc: 0.560 Test Loss: 3.448 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 40.24491095542908
Epoch: 14, Steps: 18 | Train Loss: 0.223 Vali Loss: 3.510 Vali Acc: 0.540 Test Loss: 3.510 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 42.51230549812317
Epoch: 15, Steps: 18 | Train Loss: 1.283 Vali Loss: 3.855 Vali Acc: 0.490 Test Loss: 3.855 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 42.17961287498474
Epoch: 16, Steps: 18 | Train Loss: 1.121 Vali Loss: 3.968 Vali Acc: 0.520 Test Loss: 3.968 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 3150722
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 73.5146803855896
Epoch: 1, Steps: 18 | Train Loss: 0.848 Vali Loss: 0.858 Vali Acc: 0.560 Test Loss: 0.858 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 65.64810490608215
Epoch: 2, Steps: 18 | Train Loss: 0.893 Vali Loss: 1.691 Vali Acc: 0.510 Test Loss: 1.691 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 64.33299541473389
Epoch: 3, Steps: 18 | Train Loss: 1.177 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 65.36919498443604
Epoch: 4, Steps: 18 | Train Loss: 0.647 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 65.134845495224
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.855 Vali Acc: 0.550 Test Loss: 1.855 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 71.65920162200928
Epoch: 6, Steps: 18 | Train Loss: 0.801 Vali Loss: 2.829 Vali Acc: 0.470 Test Loss: 2.829 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 72.43053936958313
Epoch: 7, Steps: 18 | Train Loss: 0.912 Vali Loss: 4.635 Vali Acc: 0.520 Test Loss: 4.635 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 72.52472305297852
Epoch: 8, Steps: 18 | Train Loss: 1.312 Vali Loss: 4.374 Vali Acc: 0.520 Test Loss: 4.374 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 72.83749032020569
Epoch: 9, Steps: 18 | Train Loss: 0.746 Vali Loss: 5.232 Vali Acc: 0.500 Test Loss: 5.232 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 74.24375629425049
Epoch: 10, Steps: 18 | Train Loss: 0.296 Vali Loss: 2.186 Vali Acc: 0.530 Test Loss: 2.186 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 69.34158039093018
Epoch: 11, Steps: 18 | Train Loss: 0.397 Vali Loss: 2.834 Vali Acc: 0.490 Test Loss: 2.834 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9770626
model size : 38.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.737695455551147
Epoch: 1, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.908 Vali Acc: 0.510 Test Loss: 0.908 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 28.520241022109985
Epoch: 2, Steps: 18 | Train Loss: 0.851 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 26.93382692337036
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.043 Vali Acc: 0.560 Test Loss: 1.043 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559990).  Saving model ...
Epoch: 4 cost time: 28.218882083892822
Epoch: 4, Steps: 18 | Train Loss: 0.445 Vali Loss: 1.239 Vali Acc: 0.540 Test Loss: 1.239 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.268852472305298
Epoch: 5, Steps: 18 | Train Loss: 0.413 Vali Loss: 3.279 Vali Acc: 0.520 Test Loss: 3.279 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.41018795967102
Epoch: 6, Steps: 18 | Train Loss: 0.542 Vali Loss: 2.403 Vali Acc: 0.560 Test Loss: 2.403 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.528703451156616
Epoch: 7, Steps: 18 | Train Loss: 0.911 Vali Loss: 3.277 Vali Acc: 0.500 Test Loss: 3.277 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.617269039154053
Epoch: 8, Steps: 18 | Train Loss: 0.705 Vali Loss: 3.088 Vali Acc: 0.490 Test Loss: 3.088 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 28.939869165420532
Epoch: 9, Steps: 18 | Train Loss: 0.373 Vali Loss: 2.509 Vali Acc: 0.570 Test Loss: 2.509 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569975).  Saving model ...
Epoch: 10 cost time: 29.086338996887207
Epoch: 10, Steps: 18 | Train Loss: 0.523 Vali Loss: 3.894 Vali Acc: 0.500 Test Loss: 3.894 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 28.187062978744507
Epoch: 11, Steps: 18 | Train Loss: 1.166 Vali Loss: 3.105 Vali Acc: 0.440 Test Loss: 3.105 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 29.110823392868042
Epoch: 12, Steps: 18 | Train Loss: 0.283 Vali Loss: 2.615 Vali Acc: 0.550 Test Loss: 2.615 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.704551696777344
Epoch: 13, Steps: 18 | Train Loss: 0.956 Vali Loss: 10.288 Vali Acc: 0.490 Test Loss: 10.288 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.53609323501587
Epoch: 14, Steps: 18 | Train Loss: 0.465 Vali Loss: 6.595 Vali Acc: 0.480 Test Loss: 6.595 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 29.131289958953857
Epoch: 15, Steps: 18 | Train Loss: 0.196 Vali Loss: 5.369 Vali Acc: 0.530 Test Loss: 5.369 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 28.394975185394287
Epoch: 16, Steps: 18 | Train Loss: 0.215 Vali Loss: 4.121 Vali Acc: 0.470 Test Loss: 4.121 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 27.82312512397766
Epoch: 17, Steps: 18 | Train Loss: 0.375 Vali Loss: 4.321 Vali Acc: 0.540 Test Loss: 4.321 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 29.291635990142822
Epoch: 18, Steps: 18 | Train Loss: 0.114 Vali Loss: 6.741 Vali Acc: 0.480 Test Loss: 6.741 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 28.71616005897522
Epoch: 19, Steps: 18 | Train Loss: 0.347 Vali Loss: 7.842 Vali Acc: 0.490 Test Loss: 7.842 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3150722
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 38.0527777671814
Epoch: 1, Steps: 18 | Train Loss: 0.847 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
Validation loss decreased (inf --> -0.559991).  Saving model ...
Epoch: 2 cost time: 34.538498640060425
Epoch: 2, Steps: 18 | Train Loss: 0.891 Vali Loss: 1.657 Vali Acc: 0.500 Test Loss: 1.657 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.91579794883728
Epoch: 3, Steps: 18 | Train Loss: 1.238 Vali Loss: 1.656 Vali Acc: 0.490 Test Loss: 1.656 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 37.78803253173828
Epoch: 4, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.328 Vali Acc: 0.550 Test Loss: 1.328 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 42.95204138755798
Epoch: 5, Steps: 18 | Train Loss: 0.799 Vali Loss: 3.990 Vali Acc: 0.530 Test Loss: 3.990 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 43.71564841270447
Epoch: 6, Steps: 18 | Train Loss: 0.888 Vali Loss: 2.644 Vali Acc: 0.540 Test Loss: 2.644 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 44.47966432571411
Epoch: 7, Steps: 18 | Train Loss: 0.903 Vali Loss: 2.267 Vali Acc: 0.530 Test Loss: 2.267 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 45.54022717475891
Epoch: 8, Steps: 18 | Train Loss: 0.580 Vali Loss: 3.775 Vali Acc: 0.530 Test Loss: 3.775 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 39.502689599990845
Epoch: 9, Steps: 18 | Train Loss: 0.401 Vali Loss: 3.302 Vali Acc: 0.480 Test Loss: 3.302 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 39.43801522254944
Epoch: 10, Steps: 18 | Train Loss: 0.752 Vali Loss: 2.527 Vali Acc: 0.500 Test Loss: 2.527 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 39.72274613380432
Epoch: 11, Steps: 18 | Train Loss: 0.268 Vali Loss: 4.243 Vali Acc: 0.490 Test Loss: 4.243 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9770626
model size : 38.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.571425199508667
Epoch: 1, Steps: 18 | Train Loss: 0.872 Vali Loss: 0.909 Vali Acc: 0.510 Test Loss: 0.909 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 18.2001531124115
Epoch: 2, Steps: 18 | Train Loss: 0.852 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519989).  Saving model ...
Epoch: 3 cost time: 20.116555213928223
Epoch: 3, Steps: 18 | Train Loss: 0.598 Vali Loss: 1.067 Vali Acc: 0.560 Test Loss: 1.067 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 4 cost time: 18.260270833969116
Epoch: 4, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.340 Vali Acc: 0.570 Test Loss: 1.340 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569987).  Saving model ...
Epoch: 5 cost time: 19.85297656059265
Epoch: 5, Steps: 18 | Train Loss: 0.429 Vali Loss: 3.086 Vali Acc: 0.510 Test Loss: 3.086 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.510839223861694
Epoch: 6, Steps: 18 | Train Loss: 0.712 Vali Loss: 2.216 Vali Acc: 0.570 Test Loss: 2.216 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.170116424560547
Epoch: 7, Steps: 18 | Train Loss: 0.815 Vali Loss: 2.035 Vali Acc: 0.530 Test Loss: 2.035 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.71226453781128
Epoch: 8, Steps: 18 | Train Loss: 0.392 Vali Loss: 4.612 Vali Acc: 0.520 Test Loss: 4.612 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.355066776275635
Epoch: 9, Steps: 18 | Train Loss: 0.769 Vali Loss: 3.996 Vali Acc: 0.550 Test Loss: 3.996 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 17.463696479797363
Epoch: 10, Steps: 18 | Train Loss: 0.913 Vali Loss: 4.014 Vali Acc: 0.510 Test Loss: 4.014 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.796844482421875
Epoch: 11, Steps: 18 | Train Loss: 0.472 Vali Loss: 3.348 Vali Acc: 0.540 Test Loss: 3.348 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.619891166687012
Epoch: 12, Steps: 18 | Train Loss: 0.565 Vali Loss: 3.116 Vali Acc: 0.520 Test Loss: 3.116 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 17.92134666442871
Epoch: 13, Steps: 18 | Train Loss: 0.377 Vali Loss: 5.153 Vali Acc: 0.490 Test Loss: 5.153 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.575654029846191
Epoch: 14, Steps: 18 | Train Loss: 0.655 Vali Loss: 3.049 Vali Acc: 0.450 Test Loss: 3.049 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3150722
model size : 13.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 52.34043526649475
Epoch: 1, Steps: 18 | Train Loss: 1.021 Vali Loss: 0.929 Vali Acc: 0.470 Test Loss: 0.929 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 57.10238480567932
Epoch: 2, Steps: 18 | Train Loss: 1.116 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
Validation loss decreased (-0.469991 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 57.60331606864929
Epoch: 3, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
Validation loss decreased (-0.499985 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 57.797027826309204
Epoch: 4, Steps: 18 | Train Loss: 0.589 Vali Loss: 1.084 Vali Acc: 0.540 Test Loss: 1.084 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 51.81543588638306
Epoch: 5, Steps: 18 | Train Loss: 0.774 Vali Loss: 1.193 Vali Acc: 0.520 Test Loss: 1.193 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 48.8850576877594
Epoch: 6, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.822 Vali Acc: 0.520 Test Loss: 1.822 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 49.07112240791321
Epoch: 7, Steps: 18 | Train Loss: 0.888 Vali Loss: 2.588 Vali Acc: 0.460 Test Loss: 2.588 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 51.13001227378845
Epoch: 8, Steps: 18 | Train Loss: 0.613 Vali Loss: 2.023 Vali Acc: 0.530 Test Loss: 2.023 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 59.25453209877014
Epoch: 9, Steps: 18 | Train Loss: 0.459 Vali Loss: 3.383 Vali Acc: 0.560 Test Loss: 3.383 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 58.972882986068726
Epoch: 10, Steps: 18 | Train Loss: 0.859 Vali Loss: 2.279 Vali Acc: 0.540 Test Loss: 2.279 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 59.53349995613098
Epoch: 11, Steps: 18 | Train Loss: 0.397 Vali Loss: 6.085 Vali Acc: 0.530 Test Loss: 6.085 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 52.82768249511719
Epoch: 12, Steps: 18 | Train Loss: 0.905 Vali Loss: 2.893 Vali Acc: 0.480 Test Loss: 2.893 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 45.20350432395935
Epoch: 13, Steps: 18 | Train Loss: 0.693 Vali Loss: 2.774 Vali Acc: 0.520 Test Loss: 2.774 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5084034
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.693573236465454
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
Validation loss decreased (inf --> -0.559989).  Saving model ...
Epoch: 2 cost time: 23.77058720588684
Epoch: 2, Steps: 18 | Train Loss: 0.924 Vali Loss: 1.334 Vali Acc: 0.500 Test Loss: 1.334 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.334354639053345
Epoch: 3, Steps: 18 | Train Loss: 0.588 Vali Loss: 1.245 Vali Acc: 0.470 Test Loss: 1.245 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.70834970474243
Epoch: 4, Steps: 18 | Train Loss: 0.605 Vali Loss: 2.099 Vali Acc: 0.470 Test Loss: 2.099 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 24.837230920791626
Epoch: 5, Steps: 18 | Train Loss: 0.875 Vali Loss: 2.807 Vali Acc: 0.560 Test Loss: 2.807 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 26.138683319091797
Epoch: 6, Steps: 18 | Train Loss: 1.622 Vali Loss: 2.057 Vali Acc: 0.490 Test Loss: 2.057 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 24.510583877563477
Epoch: 7, Steps: 18 | Train Loss: 1.042 Vali Loss: 2.930 Vali Acc: 0.530 Test Loss: 2.930 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 26.189510107040405
Epoch: 8, Steps: 18 | Train Loss: 0.648 Vali Loss: 1.887 Vali Acc: 0.540 Test Loss: 1.887 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 23.26128363609314
Epoch: 9, Steps: 18 | Train Loss: 0.668 Vali Loss: 2.118 Vali Acc: 0.520 Test Loss: 2.118 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 23.107360363006592
Epoch: 10, Steps: 18 | Train Loss: 0.609 Vali Loss: 4.485 Vali Acc: 0.490 Test Loss: 4.485 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 22.060669898986816
Epoch: 11, Steps: 18 | Train Loss: 0.519 Vali Loss: 3.887 Vali Acc: 0.510 Test Loss: 3.887 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1773954
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 41.40974807739258
Epoch: 1, Steps: 18 | Train Loss: 1.021 Vali Loss: 0.930 Vali Acc: 0.470 Test Loss: 0.930 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 40.23468232154846
Epoch: 2, Steps: 18 | Train Loss: 1.113 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
Validation loss decreased (-0.469991 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 48.04809784889221
Epoch: 3, Steps: 18 | Train Loss: 0.744 Vali Loss: 1.279 Vali Acc: 0.590 Test Loss: 1.279 Test Acc: 0.590
Validation loss decreased (-0.499985 --> -0.589987).  Saving model ...
Epoch: 4 cost time: 46.15754461288452
Epoch: 4, Steps: 18 | Train Loss: 0.597 Vali Loss: 1.120 Vali Acc: 0.540 Test Loss: 1.120 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 46.624558210372925
Epoch: 5, Steps: 18 | Train Loss: 0.731 Vali Loss: 1.269 Vali Acc: 0.470 Test Loss: 1.269 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 48.865978956222534
Epoch: 6, Steps: 18 | Train Loss: 0.455 Vali Loss: 2.473 Vali Acc: 0.510 Test Loss: 2.473 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 45.535038232803345
Epoch: 7, Steps: 18 | Train Loss: 0.959 Vali Loss: 1.744 Vali Acc: 0.500 Test Loss: 1.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 40.789061546325684
Epoch: 8, Steps: 18 | Train Loss: 0.600 Vali Loss: 5.612 Vali Acc: 0.500 Test Loss: 5.612 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 40.154948711395264
Epoch: 9, Steps: 18 | Train Loss: 1.193 Vali Loss: 2.990 Vali Acc: 0.540 Test Loss: 2.990 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 41.94545531272888
Epoch: 10, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.343 Vali Acc: 0.540 Test Loss: 2.343 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 42.008084535598755
Epoch: 11, Steps: 18 | Train Loss: 0.333 Vali Loss: 3.389 Vali Acc: 0.510 Test Loss: 3.389 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 46.474156856536865
Epoch: 12, Steps: 18 | Train Loss: 0.148 Vali Loss: 6.674 Vali Acc: 0.470 Test Loss: 6.674 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 47.887524366378784
Epoch: 13, Steps: 18 | Train Loss: 0.523 Vali Loss: 3.432 Vali Acc: 0.550 Test Loss: 3.432 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 5084034
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 22.038815021514893
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
Validation loss decreased (inf --> -0.559989).  Saving model ...
Epoch: 2 cost time: 20.281636476516724
Epoch: 2, Steps: 18 | Train Loss: 0.925 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.120465517044067
Epoch: 3, Steps: 18 | Train Loss: 0.588 Vali Loss: 1.271 Vali Acc: 0.480 Test Loss: 1.271 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.86366558074951
Epoch: 4, Steps: 18 | Train Loss: 0.643 Vali Loss: 3.260 Vali Acc: 0.490 Test Loss: 3.260 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.936110496520996
Epoch: 5, Steps: 18 | Train Loss: 0.742 Vali Loss: 2.019 Vali Acc: 0.530 Test Loss: 2.019 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.8697190284729
Epoch: 6, Steps: 18 | Train Loss: 0.679 Vali Loss: 4.106 Vali Acc: 0.500 Test Loss: 4.106 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.849332809448242
Epoch: 7, Steps: 18 | Train Loss: 0.544 Vali Loss: 1.658 Vali Acc: 0.520 Test Loss: 1.658 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.077425718307495
Epoch: 8, Steps: 18 | Train Loss: 0.680 Vali Loss: 4.437 Vali Acc: 0.480 Test Loss: 4.437 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 18.10147190093994
Epoch: 9, Steps: 18 | Train Loss: 0.720 Vali Loss: 5.063 Vali Acc: 0.500 Test Loss: 5.063 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.704842567443848
Epoch: 10, Steps: 18 | Train Loss: 1.435 Vali Loss: 4.450 Vali Acc: 0.470 Test Loss: 4.450 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 18.80564594268799
Epoch: 11, Steps: 18 | Train Loss: 0.803 Vali Loss: 3.402 Vali Acc: 0.510 Test Loss: 3.402 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1773954
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.59226894378662
Epoch: 1, Steps: 18 | Train Loss: 1.021 Vali Loss: 0.933 Vali Acc: 0.470 Test Loss: 0.933 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 30.184855222702026
Epoch: 2, Steps: 18 | Train Loss: 1.115 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
Validation loss decreased (-0.469991 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 31.16612482070923
Epoch: 3, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.310 Vali Acc: 0.600 Test Loss: 1.310 Test Acc: 0.600
Validation loss decreased (-0.499985 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 30.40107297897339
Epoch: 4, Steps: 18 | Train Loss: 0.602 Vali Loss: 1.056 Vali Acc: 0.510 Test Loss: 1.056 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.993433952331543
Epoch: 5, Steps: 18 | Train Loss: 0.823 Vali Loss: 1.302 Vali Acc: 0.490 Test Loss: 1.302 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.618598699569702
Epoch: 6, Steps: 18 | Train Loss: 0.426 Vali Loss: 2.552 Vali Acc: 0.550 Test Loss: 2.552 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.612937211990356
Epoch: 7, Steps: 18 | Train Loss: 0.488 Vali Loss: 2.865 Vali Acc: 0.470 Test Loss: 2.865 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.422808170318604
Epoch: 8, Steps: 18 | Train Loss: 0.565 Vali Loss: 5.181 Vali Acc: 0.510 Test Loss: 5.181 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.946636199951172
Epoch: 9, Steps: 18 | Train Loss: 0.462 Vali Loss: 1.869 Vali Acc: 0.570 Test Loss: 1.869 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.81083083152771
Epoch: 10, Steps: 18 | Train Loss: 0.754 Vali Loss: 2.864 Vali Acc: 0.510 Test Loss: 2.864 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 24.360903024673462
Epoch: 11, Steps: 18 | Train Loss: 0.274 Vali Loss: 2.983 Vali Acc: 0.570 Test Loss: 2.983 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 28.371819972991943
Epoch: 12, Steps: 18 | Train Loss: 0.372 Vali Loss: 3.913 Vali Acc: 0.510 Test Loss: 3.913 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 27.401391744613647
Epoch: 13, Steps: 18 | Train Loss: 0.271 Vali Loss: 3.995 Vali Acc: 0.500 Test Loss: 3.995 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5084034
model size : 20.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.938827991485596
Epoch: 1, Steps: 18 | Train Loss: 0.804 Vali Loss: 1.138 Vali Acc: 0.560 Test Loss: 1.138 Test Acc: 0.560
Validation loss decreased (inf --> -0.559989).  Saving model ...
Epoch: 2 cost time: 13.315374374389648
Epoch: 2, Steps: 18 | Train Loss: 0.925 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.261247158050537
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 1.237 Vali Acc: 0.510 Test Loss: 1.237 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.902456283569336
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 2.570 Vali Acc: 0.480 Test Loss: 2.570 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.140767335891724
Epoch: 5, Steps: 18 | Train Loss: 0.694 Vali Loss: 1.719 Vali Acc: 0.550 Test Loss: 1.719 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 13.41470456123352
Epoch: 6, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.370 Vali Acc: 0.460 Test Loss: 2.370 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.616231679916382
Epoch: 7, Steps: 18 | Train Loss: 0.626 Vali Loss: 3.443 Vali Acc: 0.550 Test Loss: 3.443 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.390305042266846
Epoch: 8, Steps: 18 | Train Loss: 0.783 Vali Loss: 3.731 Vali Acc: 0.470 Test Loss: 3.731 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 10.750622272491455
Epoch: 9, Steps: 18 | Train Loss: 0.711 Vali Loss: 4.173 Vali Acc: 0.520 Test Loss: 4.173 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 12.024293184280396
Epoch: 10, Steps: 18 | Train Loss: 0.603 Vali Loss: 2.782 Vali Acc: 0.540 Test Loss: 2.782 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.846492052078247
Epoch: 11, Steps: 18 | Train Loss: 0.762 Vali Loss: 3.804 Vali Acc: 0.500 Test Loss: 3.804 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 1773954
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 50.92310333251953
Epoch: 1, Steps: 18 | Train Loss: 0.805 Vali Loss: 1.161 Vali Acc: 0.480 Test Loss: 1.161 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 54.13099956512451
Epoch: 2, Steps: 18 | Train Loss: 0.773 Vali Loss: 1.062 Vali Acc: 0.460 Test Loss: 1.062 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 58.88865423202515
Epoch: 3, Steps: 18 | Train Loss: 0.597 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
Validation loss decreased (-0.479988 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 60.01408100128174
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.989 Vali Acc: 0.540 Test Loss: 0.989 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 5 cost time: 60.12019729614258
Epoch: 5, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 51.21587133407593
Epoch: 6, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.885 Vali Acc: 0.570 Test Loss: 0.885 Test Acc: 0.570
Validation loss decreased (-0.539990 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 49.85440492630005
Epoch: 7, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.528 Vali Acc: 0.490 Test Loss: 1.528 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 49.42331385612488
Epoch: 8, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.194 Vali Acc: 0.570 Test Loss: 1.194 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 57.51532196998596
Epoch: 9, Steps: 18 | Train Loss: 0.203 Vali Loss: 2.321 Vali Acc: 0.470 Test Loss: 2.321 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 58.8535680770874
Epoch: 10, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.774 Vali Acc: 0.530 Test Loss: 1.774 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 59.44887161254883
Epoch: 11, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.305 Vali Acc: 0.540 Test Loss: 1.305 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 56.85323119163513
Epoch: 12, Steps: 18 | Train Loss: 0.199 Vali Loss: 2.244 Vali Acc: 0.520 Test Loss: 2.244 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 50.83238983154297
Epoch: 13, Steps: 18 | Train Loss: 0.477 Vali Loss: 5.311 Vali Acc: 0.510 Test Loss: 5.311 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 49.29125094413757
Epoch: 14, Steps: 18 | Train Loss: 0.474 Vali Loss: 2.614 Vali Acc: 0.530 Test Loss: 2.614 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 49.99281191825867
Epoch: 15, Steps: 18 | Train Loss: 0.193 Vali Loss: 2.859 Vali Acc: 0.540 Test Loss: 2.859 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 60.06053304672241
Epoch: 16, Steps: 18 | Train Loss: 0.310 Vali Loss: 2.213 Vali Acc: 0.610 Test Loss: 2.213 Test Acc: 0.610
Validation loss decreased (-0.569991 --> -0.609978).  Saving model ...
Epoch: 17 cost time: 60.9311957359314
Epoch: 17, Steps: 18 | Train Loss: 0.392 Vali Loss: 3.230 Vali Acc: 0.510 Test Loss: 3.230 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 60.94823908805847
Epoch: 18, Steps: 18 | Train Loss: 0.311 Vali Loss: 4.764 Vali Acc: 0.550 Test Loss: 4.764 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 54.51000261306763
Epoch: 19, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.910 Vali Acc: 0.560 Test Loss: 2.910 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 49.40517210960388
Epoch: 20, Steps: 18 | Train Loss: 0.067 Vali Loss: 2.596 Vali Acc: 0.480 Test Loss: 2.596 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 48.6846809387207
Epoch: 21, Steps: 18 | Train Loss: 0.144 Vali Loss: 7.106 Vali Acc: 0.490 Test Loss: 7.106 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 48.796186208724976
Epoch: 22, Steps: 18 | Train Loss: 0.114 Vali Loss: 4.592 Vali Acc: 0.490 Test Loss: 4.592 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 57.96011137962341
Epoch: 23, Steps: 18 | Train Loss: 0.031 Vali Loss: 5.227 Vali Acc: 0.520 Test Loss: 5.227 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 59.142802238464355
Epoch: 24, Steps: 18 | Train Loss: 0.027 Vali Loss: 3.986 Vali Acc: 0.530 Test Loss: 3.986 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 59.34785056114197
Epoch: 25, Steps: 18 | Train Loss: 0.086 Vali Loss: 5.113 Vali Acc: 0.480 Test Loss: 5.113 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 53.36794090270996
Epoch: 26, Steps: 18 | Train Loss: 0.162 Vali Loss: 6.074 Vali Acc: 0.520 Test Loss: 6.074 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 4886082
model size : 19.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 23.06764054298401
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.761 Vali Acc: 0.600 Test Loss: 0.761 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 20.97781467437744
Epoch: 2, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.127 Vali Acc: 0.460 Test Loss: 1.127 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 23.14537525177002
Epoch: 3, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.726 Vali Acc: 0.490 Test Loss: 1.726 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 22.56030249595642
Epoch: 4, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 27.25290012359619
Epoch: 5, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.139 Vali Acc: 0.460 Test Loss: 1.139 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 26.015572786331177
Epoch: 6, Steps: 18 | Train Loss: 0.540 Vali Loss: 2.755 Vali Acc: 0.500 Test Loss: 2.755 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 27.356963634490967
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.226 Vali Acc: 0.600 Test Loss: 1.226 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 26.537689208984375
Epoch: 8, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.472 Vali Acc: 0.530 Test Loss: 2.472 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 27.19587206840515
Epoch: 9, Steps: 18 | Train Loss: 0.301 Vali Loss: 2.131 Vali Acc: 0.560 Test Loss: 2.131 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 26.881960153579712
Epoch: 10, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.854 Vali Acc: 0.570 Test Loss: 1.854 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 26.700499773025513
Epoch: 11, Steps: 18 | Train Loss: 0.629 Vali Loss: 3.574 Vali Acc: 0.470 Test Loss: 3.574 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1575874
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 41.04877161979675
Epoch: 1, Steps: 18 | Train Loss: 0.805 Vali Loss: 1.159 Vali Acc: 0.480 Test Loss: 1.159 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 39.35354137420654
Epoch: 2, Steps: 18 | Train Loss: 0.774 Vali Loss: 1.069 Vali Acc: 0.460 Test Loss: 1.069 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 39.995410680770874
Epoch: 3, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 43.232157707214355
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.918 Vali Acc: 0.560 Test Loss: 0.918 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559991).  Saving model ...
Epoch: 5 cost time: 40.24578261375427
Epoch: 5, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.229 Vali Acc: 0.510 Test Loss: 1.229 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 39.99896812438965
Epoch: 6, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.921 Vali Acc: 0.590 Test Loss: 0.921 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589991).  Saving model ...
Epoch: 7 cost time: 45.71727538108826
Epoch: 7, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.732 Vali Acc: 0.480 Test Loss: 1.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 46.16655397415161
Epoch: 8, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.192 Vali Acc: 0.560 Test Loss: 1.192 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 47.60552191734314
Epoch: 9, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.379 Vali Acc: 0.470 Test Loss: 1.379 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 47.347816944122314
Epoch: 10, Steps: 18 | Train Loss: 0.342 Vali Loss: 3.007 Vali Acc: 0.500 Test Loss: 3.007 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 42.65832996368408
Epoch: 11, Steps: 18 | Train Loss: 0.122 Vali Loss: 2.818 Vali Acc: 0.530 Test Loss: 2.818 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 40.03962731361389
Epoch: 12, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.699 Vali Acc: 0.540 Test Loss: 1.699 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 37.64472198486328
Epoch: 13, Steps: 18 | Train Loss: 0.141 Vali Loss: 3.886 Vali Acc: 0.450 Test Loss: 3.886 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 37.230905055999756
Epoch: 14, Steps: 18 | Train Loss: 0.177 Vali Loss: 4.690 Vali Acc: 0.500 Test Loss: 4.690 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 44.21835970878601
Epoch: 15, Steps: 18 | Train Loss: 0.148 Vali Loss: 2.822 Vali Acc: 0.510 Test Loss: 2.822 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 45.404587507247925
Epoch: 16, Steps: 18 | Train Loss: 0.425 Vali Loss: 3.809 Vali Acc: 0.460 Test Loss: 3.809 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 4886082
model size : 19.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.59280037879944
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.761 Vali Acc: 0.600 Test Loss: 0.761 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 21.42473292350769
Epoch: 2, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.128 Vali Acc: 0.460 Test Loss: 1.128 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.796624183654785
Epoch: 3, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.729 Vali Acc: 0.490 Test Loss: 1.729 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.285046339035034
Epoch: 4, Steps: 18 | Train Loss: 0.547 Vali Loss: 1.083 Vali Acc: 0.490 Test Loss: 1.083 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.174360513687134
Epoch: 5, Steps: 18 | Train Loss: 0.429 Vali Loss: 1.329 Vali Acc: 0.450 Test Loss: 1.329 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.381425380706787
Epoch: 6, Steps: 18 | Train Loss: 0.495 Vali Loss: 2.322 Vali Acc: 0.500 Test Loss: 2.322 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.881956815719604
Epoch: 7, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.068 Vali Acc: 0.580 Test Loss: 1.068 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.915393590927124
Epoch: 8, Steps: 18 | Train Loss: 0.228 Vali Loss: 2.736 Vali Acc: 0.530 Test Loss: 2.736 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.911147832870483
Epoch: 9, Steps: 18 | Train Loss: 0.255 Vali Loss: 2.847 Vali Acc: 0.500 Test Loss: 2.847 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.37587571144104
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 2.337 Vali Acc: 0.520 Test Loss: 2.337 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 17.65708613395691
Epoch: 11, Steps: 18 | Train Loss: 0.371 Vali Loss: 4.239 Vali Acc: 0.460 Test Loss: 4.239 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1575874
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 31.096036195755005
Epoch: 1, Steps: 18 | Train Loss: 0.805 Vali Loss: 1.159 Vali Acc: 0.480 Test Loss: 1.159 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 27.26737093925476
Epoch: 2, Steps: 18 | Train Loss: 0.774 Vali Loss: 1.059 Vali Acc: 0.460 Test Loss: 1.059 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.419034957885742
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
Validation loss decreased (-0.479988 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 28.590794563293457
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.936 Vali Acc: 0.560 Test Loss: 0.936 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559991).  Saving model ...
Epoch: 5 cost time: 28.31627321243286
Epoch: 5, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.142 Vali Acc: 0.510 Test Loss: 1.142 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.537830352783203
Epoch: 6, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.027 Vali Acc: 0.570 Test Loss: 1.027 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569990).  Saving model ...
Epoch: 7 cost time: 24.305792570114136
Epoch: 7, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.377 Vali Acc: 0.540 Test Loss: 1.377 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.636977195739746
Epoch: 8, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.381 Vali Acc: 0.560 Test Loss: 1.381 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.726784467697144
Epoch: 9, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.372 Vali Acc: 0.490 Test Loss: 1.372 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.35606575012207
Epoch: 10, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 24.280444860458374
Epoch: 11, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.392 Vali Acc: 0.570 Test Loss: 1.392 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.488949298858643
Epoch: 12, Steps: 18 | Train Loss: 0.376 Vali Loss: 3.784 Vali Acc: 0.490 Test Loss: 3.784 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 27.22581648826599
Epoch: 13, Steps: 18 | Train Loss: 0.560 Vali Loss: 5.735 Vali Acc: 0.450 Test Loss: 5.735 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 26.312824010849
Epoch: 14, Steps: 18 | Train Loss: 0.285 Vali Loss: 4.572 Vali Acc: 0.500 Test Loss: 4.572 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 26.7453396320343
Epoch: 15, Steps: 18 | Train Loss: 0.066 Vali Loss: 2.720 Vali Acc: 0.470 Test Loss: 2.720 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 27.650413274765015
Epoch: 16, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.098 Vali Acc: 0.560 Test Loss: 2.098 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 4886082
model size : 19.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.436882495880127
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.761 Vali Acc: 0.600 Test Loss: 0.761 Test Acc: 0.600
Validation loss decreased (inf --> -0.599992).  Saving model ...
Epoch: 2 cost time: 13.033303022384644
Epoch: 2, Steps: 18 | Train Loss: 0.783 Vali Loss: 1.149 Vali Acc: 0.460 Test Loss: 1.149 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.640782356262207
Epoch: 3, Steps: 18 | Train Loss: 0.815 Vali Loss: 1.779 Vali Acc: 0.500 Test Loss: 1.779 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.805476665496826
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 1.991 Vali Acc: 0.510 Test Loss: 1.991 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.224695444107056
Epoch: 5, Steps: 18 | Train Loss: 0.705 Vali Loss: 1.525 Vali Acc: 0.520 Test Loss: 1.525 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.715454578399658
Epoch: 6, Steps: 18 | Train Loss: 0.745 Vali Loss: 2.130 Vali Acc: 0.510 Test Loss: 2.130 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.15578293800354
Epoch: 7, Steps: 18 | Train Loss: 1.170 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.81520938873291
Epoch: 8, Steps: 18 | Train Loss: 0.478 Vali Loss: 2.642 Vali Acc: 0.490 Test Loss: 2.642 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.26694655418396
Epoch: 9, Steps: 18 | Train Loss: 0.332 Vali Loss: 3.296 Vali Acc: 0.510 Test Loss: 3.296 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.218615531921387
Epoch: 10, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.195 Vali Acc: 0.510 Test Loss: 1.195 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 11.487948179244995
Epoch: 11, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.920 Vali Acc: 0.460 Test Loss: 1.920 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1575874
model size : 6.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 32.94471096992493
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 33.9749071598053
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
Validation loss decreased (-0.399990 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 33.534462213516235
Epoch: 3, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.132 Vali Acc: 0.540 Test Loss: 1.132 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539989).  Saving model ...
Epoch: 4 cost time: 32.82564377784729
Epoch: 4, Steps: 18 | Train Loss: 0.600 Vali Loss: 1.050 Vali Acc: 0.560 Test Loss: 1.050 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559990).  Saving model ...
Epoch: 5 cost time: 33.22398114204407
Epoch: 5, Steps: 18 | Train Loss: 0.603 Vali Loss: 1.961 Vali Acc: 0.500 Test Loss: 1.961 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.955286264419556
Epoch: 6, Steps: 18 | Train Loss: 0.588 Vali Loss: 1.162 Vali Acc: 0.510 Test Loss: 1.162 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 29.75346565246582
Epoch: 7, Steps: 18 | Train Loss: 0.272 Vali Loss: 1.066 Vali Acc: 0.580 Test Loss: 1.066 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579989).  Saving model ...
Epoch: 8 cost time: 28.07693910598755
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.164 Vali Acc: 0.530 Test Loss: 1.164 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.042970180511475
Epoch: 9, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.129 Vali Acc: 0.510 Test Loss: 1.129 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 28.694267749786377
Epoch: 10, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.589 Vali Acc: 0.480 Test Loss: 1.589 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 28.5443434715271
Epoch: 11, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.703 Vali Acc: 0.570 Test Loss: 1.703 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 28.81592059135437
Epoch: 12, Steps: 18 | Train Loss: 0.169 Vali Loss: 3.270 Vali Acc: 0.460 Test Loss: 3.270 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 33.88610553741455
Epoch: 13, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.622 Vali Acc: 0.490 Test Loss: 2.622 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 35.002476930618286
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 1.792 Vali Acc: 0.560 Test Loss: 1.792 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 33.95145630836487
Epoch: 15, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 35.13091421127319
Epoch: 16, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 34.6709930896759
Epoch: 17, Steps: 18 | Train Loss: 0.042 Vali Loss: 2.540 Vali Acc: 0.510 Test Loss: 2.540 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2542402
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.05364727973938
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.784 Vali Acc: 0.570 Test Loss: 0.784 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 13.03653073310852
Epoch: 2, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.833 Vali Acc: 0.510 Test Loss: 0.833 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.933049201965332
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.956 Vali Acc: 0.490 Test Loss: 0.956 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.707752704620361
Epoch: 4, Steps: 18 | Train Loss: 0.497 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 13.402489423751831
Epoch: 5, Steps: 18 | Train Loss: 0.395 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.132153034210205
Epoch: 6, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.822 Vali Acc: 0.530 Test Loss: 0.822 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.90340781211853
Epoch: 7, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.072 Vali Acc: 0.550 Test Loss: 1.072 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 14.239315509796143
Epoch: 8, Steps: 18 | Train Loss: 0.300 Vali Loss: 1.288 Vali Acc: 0.590 Test Loss: 1.288 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589987).  Saving model ...
Epoch: 9 cost time: 12.512747049331665
Epoch: 9, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.959 Vali Acc: 0.460 Test Loss: 1.959 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.91587519645691
Epoch: 10, Steps: 18 | Train Loss: 0.651 Vali Loss: 2.465 Vali Acc: 0.520 Test Loss: 2.465 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.941073656082153
Epoch: 11, Steps: 18 | Train Loss: 0.396 Vali Loss: 2.437 Vali Acc: 0.530 Test Loss: 2.437 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.06684398651123
Epoch: 12, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.489 Vali Acc: 0.580 Test Loss: 1.489 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 15.615021228790283
Epoch: 13, Steps: 18 | Train Loss: 0.104 Vali Loss: 3.629 Vali Acc: 0.500 Test Loss: 3.629 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 15.945623874664307
Epoch: 14, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.425 Vali Acc: 0.470 Test Loss: 2.425 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 15.899007558822632
Epoch: 15, Steps: 18 | Train Loss: 0.212 Vali Loss: 2.074 Vali Acc: 0.570 Test Loss: 2.074 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 15.72350001335144
Epoch: 16, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.559 Vali Acc: 0.540 Test Loss: 2.559 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 16.12489414215088
Epoch: 17, Steps: 18 | Train Loss: 0.212 Vali Loss: 4.130 Vali Acc: 0.500 Test Loss: 4.130 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 15.42273998260498
Epoch: 18, Steps: 18 | Train Loss: 0.248 Vali Loss: 2.979 Vali Acc: 0.500 Test Loss: 2.979 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 887234
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 26.494786739349365
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 22.85205841064453
Epoch: 2, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
Validation loss decreased (-0.399990 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 22.037986516952515
Epoch: 3, Steps: 18 | Train Loss: 0.550 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539989).  Saving model ...
Epoch: 4 cost time: 23.602689027786255
Epoch: 4, Steps: 18 | Train Loss: 0.608 Vali Loss: 1.067 Vali Acc: 0.580 Test Loss: 1.067 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579989).  Saving model ...
Epoch: 5 cost time: 21.302083253860474
Epoch: 5, Steps: 18 | Train Loss: 0.622 Vali Loss: 1.845 Vali Acc: 0.510 Test Loss: 1.845 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.740058183670044
Epoch: 6, Steps: 18 | Train Loss: 0.685 Vali Loss: 1.705 Vali Acc: 0.470 Test Loss: 1.705 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.50119709968567
Epoch: 7, Steps: 18 | Train Loss: 0.717 Vali Loss: 2.101 Vali Acc: 0.510 Test Loss: 2.101 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.90233588218689
Epoch: 8, Steps: 18 | Train Loss: 0.434 Vali Loss: 1.509 Vali Acc: 0.550 Test Loss: 1.509 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 25.209465742111206
Epoch: 9, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.239 Vali Acc: 0.540 Test Loss: 1.239 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.825737237930298
Epoch: 10, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.861 Vali Acc: 0.590 Test Loss: 1.861 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589981).  Saving model ...
Epoch: 11 cost time: 26.238248825073242
Epoch: 11, Steps: 18 | Train Loss: 0.383 Vali Loss: 3.663 Vali Acc: 0.500 Test Loss: 3.663 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.776877641677856
Epoch: 12, Steps: 18 | Train Loss: 0.509 Vali Loss: 2.530 Vali Acc: 0.490 Test Loss: 2.530 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.862661600112915
Epoch: 13, Steps: 18 | Train Loss: 0.181 Vali Loss: 2.112 Vali Acc: 0.480 Test Loss: 2.112 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.576884746551514
Epoch: 14, Steps: 18 | Train Loss: 0.297 Vali Loss: 2.157 Vali Acc: 0.510 Test Loss: 2.157 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 23.14737844467163
Epoch: 15, Steps: 18 | Train Loss: 0.296 Vali Loss: 2.599 Vali Acc: 0.530 Test Loss: 2.599 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 22.063328504562378
Epoch: 16, Steps: 18 | Train Loss: 0.079 Vali Loss: 2.891 Vali Acc: 0.480 Test Loss: 2.891 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 22.417501211166382
Epoch: 17, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.164 Vali Acc: 0.510 Test Loss: 2.164 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 22.43563961982727
Epoch: 18, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.121 Vali Acc: 0.510 Test Loss: 2.121 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 21.769720315933228
Epoch: 19, Steps: 18 | Train Loss: 0.141 Vali Loss: 2.628 Vali Acc: 0.430 Test Loss: 2.628 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 21.187387704849243
Epoch: 20, Steps: 18 | Train Loss: 0.073 Vali Loss: 3.412 Vali Acc: 0.420 Test Loss: 3.412 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2542402
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.818214416503906
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.784 Vali Acc: 0.570 Test Loss: 0.784 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 11.627779722213745
Epoch: 2, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.833 Vali Acc: 0.510 Test Loss: 0.833 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.83372449874878
Epoch: 3, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.019105434417725
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.051 Vali Acc: 0.470 Test Loss: 1.051 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.396706104278564
Epoch: 5, Steps: 18 | Train Loss: 0.397 Vali Loss: 2.001 Vali Acc: 0.500 Test Loss: 2.001 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.00270390510559
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.881 Vali Acc: 0.570 Test Loss: 0.881 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.617955446243286
Epoch: 7, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.541 Vali Acc: 0.630 Test Loss: 1.541 Test Acc: 0.630
Validation loss decreased (-0.569992 --> -0.629985).  Saving model ...
Epoch: 8 cost time: 11.88189435005188
Epoch: 8, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.285 Vali Acc: 0.530 Test Loss: 1.285 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.000977277755737
Epoch: 9, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.130 Vali Acc: 0.570 Test Loss: 1.130 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.700636148452759
Epoch: 10, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.675 Vali Acc: 0.530 Test Loss: 1.675 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.302813053131104
Epoch: 11, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.389 Vali Acc: 0.570 Test Loss: 1.389 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.447935581207275
Epoch: 12, Steps: 18 | Train Loss: 0.135 Vali Loss: 2.323 Vali Acc: 0.560 Test Loss: 2.323 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.119958400726318
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 3.192 Vali Acc: 0.520 Test Loss: 3.192 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.94041919708252
Epoch: 14, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.934 Vali Acc: 0.530 Test Loss: 1.934 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.474404335021973
Epoch: 15, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.997685432434082
Epoch: 16, Steps: 18 | Train Loss: 0.104 Vali Loss: 2.371 Vali Acc: 0.470 Test Loss: 2.371 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.599056720733643
Epoch: 17, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.516 Vali Acc: 0.530 Test Loss: 2.516 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 887234
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 16.352591514587402
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 14.220927000045776
Epoch: 2, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.740 Vali Acc: 0.460 Test Loss: 0.740 Test Acc: 0.460
Validation loss decreased (-0.399990 --> -0.459993).  Saving model ...
Epoch: 3 cost time: 12.783268451690674
Epoch: 3, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.122 Vali Acc: 0.540 Test Loss: 1.122 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539989).  Saving model ...
Epoch: 4 cost time: 17.125916481018066
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 1.099 Vali Acc: 0.550 Test Loss: 1.099 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 17.670834064483643
Epoch: 5, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.780 Vali Acc: 0.510 Test Loss: 1.780 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.737255573272705
Epoch: 6, Steps: 18 | Train Loss: 0.697 Vali Loss: 1.788 Vali Acc: 0.470 Test Loss: 1.788 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.7499942779541
Epoch: 7, Steps: 18 | Train Loss: 0.703 Vali Loss: 1.802 Vali Acc: 0.510 Test Loss: 1.802 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.87117075920105
Epoch: 8, Steps: 18 | Train Loss: 0.357 Vali Loss: 1.225 Vali Acc: 0.510 Test Loss: 1.225 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.74520993232727
Epoch: 9, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 18.02233123779297
Epoch: 10, Steps: 18 | Train Loss: 0.234 Vali Loss: 1.375 Vali Acc: 0.480 Test Loss: 1.375 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.975557804107666
Epoch: 11, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.998 Vali Acc: 0.590 Test Loss: 1.998 Test Acc: 0.590
Validation loss decreased (-0.549989 --> -0.589980).  Saving model ...
Epoch: 12 cost time: 16.612645149230957
Epoch: 12, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.542 Vali Acc: 0.520 Test Loss: 1.542 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.048330307006836
Epoch: 13, Steps: 18 | Train Loss: 0.075 Vali Loss: 1.741 Vali Acc: 0.530 Test Loss: 1.741 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.720454692840576
Epoch: 14, Steps: 18 | Train Loss: 0.102 Vali Loss: 2.356 Vali Acc: 0.580 Test Loss: 2.356 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.631633520126343
Epoch: 15, Steps: 18 | Train Loss: 0.210 Vali Loss: 2.537 Vali Acc: 0.510 Test Loss: 2.537 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.18430209159851
Epoch: 16, Steps: 18 | Train Loss: 0.182 Vali Loss: 2.003 Vali Acc: 0.550 Test Loss: 2.003 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 15.650186777114868
Epoch: 17, Steps: 18 | Train Loss: 0.099 Vali Loss: 2.193 Vali Acc: 0.510 Test Loss: 2.193 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.901653051376343
Epoch: 18, Steps: 18 | Train Loss: 0.250 Vali Loss: 2.351 Vali Acc: 0.540 Test Loss: 2.351 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 16.110241651535034
Epoch: 19, Steps: 18 | Train Loss: 0.211 Vali Loss: 2.851 Vali Acc: 0.500 Test Loss: 2.851 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.142153024673462
Epoch: 20, Steps: 18 | Train Loss: 0.111 Vali Loss: 2.470 Vali Acc: 0.500 Test Loss: 2.470 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.692115306854248
Epoch: 21, Steps: 18 | Train Loss: 0.105 Vali Loss: 3.188 Vali Acc: 0.490 Test Loss: 3.188 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2542402
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.298421144485474
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 8.88202452659607
Epoch: 2, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.840 Vali Acc: 0.500 Test Loss: 0.840 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.951461791992188
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.933 Vali Acc: 0.490 Test Loss: 0.933 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.75305438041687
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 1.124 Vali Acc: 0.470 Test Loss: 1.124 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.528103828430176
Epoch: 5, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.823 Vali Acc: 0.530 Test Loss: 1.823 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.212141275405884
Epoch: 6, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.944 Vali Acc: 0.590 Test Loss: 0.944 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589991).  Saving model ...
Epoch: 7 cost time: 8.833800554275513
Epoch: 7, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.017 Vali Acc: 0.570 Test Loss: 1.017 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.807585716247559
Epoch: 8, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.555 Vali Acc: 0.540 Test Loss: 1.555 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.808998107910156
Epoch: 9, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.681 Vali Acc: 0.480 Test Loss: 1.681 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.437300205230713
Epoch: 10, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.461 Vali Acc: 0.530 Test Loss: 1.461 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.183059930801392
Epoch: 11, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.637 Vali Acc: 0.530 Test Loss: 1.637 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.404358863830566
Epoch: 12, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.623 Vali Acc: 0.560 Test Loss: 1.623 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.859047651290894
Epoch: 13, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.983 Vali Acc: 0.570 Test Loss: 1.983 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.662738561630249
Epoch: 14, Steps: 18 | Train Loss: 0.080 Vali Loss: 3.030 Vali Acc: 0.500 Test Loss: 3.030 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.527971744537354
Epoch: 15, Steps: 18 | Train Loss: 0.426 Vali Loss: 1.863 Vali Acc: 0.570 Test Loss: 1.863 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.004505395889282
Epoch: 16, Steps: 18 | Train Loss: 0.101 Vali Loss: 2.801 Vali Acc: 0.510 Test Loss: 2.801 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 887234
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.12024450302124
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.811 Vali Acc: 0.570 Test Loss: 0.811 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 20.471787691116333
Epoch: 2, Steps: 18 | Train Loss: 0.807 Vali Loss: 0.859 Vali Acc: 0.590 Test Loss: 0.859 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589991).  Saving model ...
Epoch: 3 cost time: 21.013580799102783
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.161745309829712
Epoch: 4, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.099 Vali Acc: 0.490 Test Loss: 1.099 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.20271635055542
Epoch: 5, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.601 Vali Acc: 0.490 Test Loss: 1.601 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.49027156829834
Epoch: 6, Steps: 18 | Train Loss: 0.426 Vali Loss: 2.034 Vali Acc: 0.520 Test Loss: 2.034 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.95762586593628
Epoch: 7, Steps: 18 | Train Loss: 0.565 Vali Loss: 2.231 Vali Acc: 0.500 Test Loss: 2.231 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.360619068145752
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 2.159 Vali Acc: 0.480 Test Loss: 2.159 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 24.10478162765503
Epoch: 9, Steps: 18 | Train Loss: 0.306 Vali Loss: 3.376 Vali Acc: 0.480 Test Loss: 3.376 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 22.97189450263977
Epoch: 10, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.374 Vali Acc: 0.540 Test Loss: 1.374 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 21.481988430023193
Epoch: 11, Steps: 18 | Train Loss: 0.235 Vali Loss: 2.191 Vali Acc: 0.470 Test Loss: 2.191 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 22.520100355148315
Epoch: 12, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.877 Vali Acc: 0.580 Test Loss: 1.877 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1370562
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.936930656433105
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 1.128 Vali Acc: 0.450 Test Loss: 1.128 Test Acc: 0.450
Validation loss decreased (inf --> -0.449989).  Saving model ...
Epoch: 2 cost time: 10.842330694198608
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.140 Vali Acc: 0.460 Test Loss: 1.140 Test Acc: 0.460
Validation loss decreased (-0.449989 --> -0.459989).  Saving model ...
Epoch: 3 cost time: 8.316585302352905
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.918 Vali Acc: 0.590 Test Loss: 0.918 Test Acc: 0.590
Validation loss decreased (-0.459989 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 9.614256620407104
Epoch: 4, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.206 Vali Acc: 0.590 Test Loss: 1.206 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.454450130462646
Epoch: 5, Steps: 18 | Train Loss: 0.478 Vali Loss: 1.408 Vali Acc: 0.500 Test Loss: 1.408 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.317517042160034
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.919 Vali Acc: 0.560 Test Loss: 0.919 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.044391870498657
Epoch: 7, Steps: 18 | Train Loss: 0.588 Vali Loss: 2.305 Vali Acc: 0.510 Test Loss: 2.305 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.479413747787476
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.066 Vali Acc: 0.500 Test Loss: 1.066 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.494059324264526
Epoch: 9, Steps: 18 | Train Loss: 0.163 Vali Loss: 2.238 Vali Acc: 0.450 Test Loss: 2.238 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.8632173538208
Epoch: 10, Steps: 18 | Train Loss: 0.340 Vali Loss: 2.680 Vali Acc: 0.450 Test Loss: 2.680 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.097525358200073
Epoch: 11, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.491 Vali Acc: 0.550 Test Loss: 1.491 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.512555122375488
Epoch: 12, Steps: 18 | Train Loss: 0.191 Vali Loss: 2.663 Vali Acc: 0.490 Test Loss: 2.663 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.644860982894897
Epoch: 13, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.663 Vali Acc: 0.530 Test Loss: 1.663 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 542914
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 19.437530994415283
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.811 Vali Acc: 0.580 Test Loss: 0.811 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 17.1377112865448
Epoch: 2, Steps: 18 | Train Loss: 0.807 Vali Loss: 0.855 Vali Acc: 0.580 Test Loss: 0.855 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.80273175239563
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.056230783462524
Epoch: 4, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.122 Vali Acc: 0.490 Test Loss: 1.122 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.016323804855347
Epoch: 5, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.539 Vali Acc: 0.490 Test Loss: 1.539 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.840929985046387
Epoch: 6, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.456 Vali Acc: 0.510 Test Loss: 1.456 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.63323998451233
Epoch: 7, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.581 Vali Acc: 0.510 Test Loss: 1.581 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.533453702926636
Epoch: 8, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.481 Vali Acc: 0.500 Test Loss: 1.481 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.88783359527588
Epoch: 9, Steps: 18 | Train Loss: 0.279 Vali Loss: 2.180 Vali Acc: 0.500 Test Loss: 2.180 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 15.609159708023071
Epoch: 10, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.542 Vali Acc: 0.450 Test Loss: 1.542 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.414743185043335
Epoch: 11, Steps: 18 | Train Loss: 0.233 Vali Loss: 3.099 Vali Acc: 0.520 Test Loss: 3.099 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1370562
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.487144708633423
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 1.120 Vali Acc: 0.450 Test Loss: 1.120 Test Acc: 0.450
Validation loss decreased (inf --> -0.449989).  Saving model ...
Epoch: 2 cost time: 7.6971821784973145
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.147 Vali Acc: 0.460 Test Loss: 1.147 Test Acc: 0.460
Validation loss decreased (-0.449989 --> -0.459989).  Saving model ...
Epoch: 3 cost time: 7.654963970184326
Epoch: 3, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.924 Vali Acc: 0.590 Test Loss: 0.924 Test Acc: 0.590
Validation loss decreased (-0.459989 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 7.938498020172119
Epoch: 4, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.217 Vali Acc: 0.590 Test Loss: 1.217 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.393657922744751
Epoch: 5, Steps: 18 | Train Loss: 0.467 Vali Loss: 1.418 Vali Acc: 0.490 Test Loss: 1.418 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.585227012634277
Epoch: 6, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.994 Vali Acc: 0.530 Test Loss: 0.994 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.911863088607788
Epoch: 7, Steps: 18 | Train Loss: 0.575 Vali Loss: 1.176 Vali Acc: 0.570 Test Loss: 1.176 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.987089395523071
Epoch: 8, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.984 Vali Acc: 0.500 Test Loss: 1.984 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.292786598205566
Epoch: 9, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.423 Vali Acc: 0.480 Test Loss: 2.423 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.66823148727417
Epoch: 10, Steps: 18 | Train Loss: 0.335 Vali Loss: 2.656 Vali Acc: 0.460 Test Loss: 2.656 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.133475065231323
Epoch: 11, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.860 Vali Acc: 0.480 Test Loss: 2.860 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.363395929336548
Epoch: 12, Steps: 18 | Train Loss: 0.185 Vali Loss: 3.407 Vali Acc: 0.540 Test Loss: 3.407 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.778156995773315
Epoch: 13, Steps: 18 | Train Loss: 0.445 Vali Loss: 1.655 Vali Acc: 0.520 Test Loss: 1.655 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 542914
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.685132265090942
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.811 Vali Acc: 0.580 Test Loss: 0.811 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 11.56812071800232
Epoch: 2, Steps: 18 | Train Loss: 0.807 Vali Loss: 0.855 Vali Acc: 0.580 Test Loss: 0.855 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.964683294296265
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.092965126037598
Epoch: 4, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.379199266433716
Epoch: 5, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.551 Vali Acc: 0.490 Test Loss: 1.551 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.125828504562378
Epoch: 6, Steps: 18 | Train Loss: 0.388 Vali Loss: 1.462 Vali Acc: 0.530 Test Loss: 1.462 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.118052959442139
Epoch: 7, Steps: 18 | Train Loss: 0.312 Vali Loss: 1.029 Vali Acc: 0.520 Test Loss: 1.029 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 10.259606122970581
Epoch: 8, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.771 Vali Acc: 0.480 Test Loss: 1.771 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.720616102218628
Epoch: 9, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.766 Vali Acc: 0.460 Test Loss: 1.766 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 10.46672797203064
Epoch: 10, Steps: 18 | Train Loss: 0.504 Vali Loss: 1.949 Vali Acc: 0.530 Test Loss: 1.949 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 10.292682886123657
Epoch: 11, Steps: 18 | Train Loss: 0.857 Vali Loss: 2.698 Vali Acc: 0.510 Test Loss: 2.698 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1370562
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.191449165344238
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 1.117 Vali Acc: 0.450 Test Loss: 1.117 Test Acc: 0.450
Validation loss decreased (inf --> -0.449989).  Saving model ...
Epoch: 2 cost time: 5.240853309631348
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.152 Vali Acc: 0.450 Test Loss: 1.152 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.928901433944702
Epoch: 3, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.913 Vali Acc: 0.600 Test Loss: 0.913 Test Acc: 0.600
Validation loss decreased (-0.449989 --> -0.599991).  Saving model ...
Epoch: 4 cost time: 4.956873893737793
Epoch: 4, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.514725208282471
Epoch: 5, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.388 Vali Acc: 0.510 Test Loss: 1.388 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.0471954345703125
Epoch: 6, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.936 Vali Acc: 0.600 Test Loss: 0.936 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.423101902008057
Epoch: 7, Steps: 18 | Train Loss: 0.612 Vali Loss: 2.194 Vali Acc: 0.520 Test Loss: 2.194 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.01310920715332
Epoch: 8, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.099 Vali Acc: 0.540 Test Loss: 1.099 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.082904815673828
Epoch: 9, Steps: 18 | Train Loss: 0.215 Vali Loss: 2.243 Vali Acc: 0.510 Test Loss: 2.243 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.150162935256958
Epoch: 10, Steps: 18 | Train Loss: 0.206 Vali Loss: 3.141 Vali Acc: 0.440 Test Loss: 3.141 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.072308301925659
Epoch: 11, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.438 Vali Acc: 0.530 Test Loss: 1.438 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.997813701629639
Epoch: 12, Steps: 18 | Train Loss: 0.283 Vali Loss: 2.311 Vali Acc: 0.470 Test Loss: 2.311 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.1776721477508545
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.580 Vali Acc: 0.480 Test Loss: 2.580 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 542914
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 29.461480855941772
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.995 Vali Acc: 0.540 Test Loss: 0.995 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 26.660050868988037
Epoch: 2, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.846 Vali Acc: 0.480 Test Loss: 0.846 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.040117025375366
Epoch: 3, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.903 Vali Acc: 0.450 Test Loss: 0.903 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 25.92579698562622
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 1.077 Vali Acc: 0.470 Test Loss: 1.077 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 27.238159894943237
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 23.850587844848633
Epoch: 6, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.743 Vali Acc: 0.480 Test Loss: 0.743 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 25.351914167404175
Epoch: 7, Steps: 18 | Train Loss: 0.352 Vali Loss: 1.419 Vali Acc: 0.460 Test Loss: 1.419 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 24.85016107559204
Epoch: 8, Steps: 18 | Train Loss: 0.311 Vali Loss: 1.241 Vali Acc: 0.460 Test Loss: 1.241 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 23.011800289154053
Epoch: 9, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 24.483462810516357
Epoch: 10, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.060 Vali Acc: 0.520 Test Loss: 1.060 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 23.032042741775513
Epoch: 11, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.282 Vali Acc: 0.490 Test Loss: 1.282 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1271586
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.228123903274536
Epoch: 1, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.817 Vali Acc: 0.490 Test Loss: 0.817 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 13.19120740890503
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 12.864842653274536
Epoch: 3, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.993483781814575
Epoch: 4, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.382457494735718
Epoch: 5, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.863476514816284
Epoch: 6, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.677 Vali Acc: 0.520 Test Loss: 1.677 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.88042950630188
Epoch: 7, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.433 Vali Acc: 0.540 Test Loss: 1.433 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.337167978286743
Epoch: 8, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.027 Vali Acc: 0.490 Test Loss: 1.027 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.265023231506348
Epoch: 9, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.965471506118774
Epoch: 10, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.884 Vali Acc: 0.500 Test Loss: 1.884 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.69807767868042
Epoch: 11, Steps: 18 | Train Loss: 0.198 Vali Loss: 1.736 Vali Acc: 0.550 Test Loss: 1.736 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.068449974060059
Epoch: 12, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.400 Vali Acc: 0.530 Test Loss: 1.400 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 443874
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.527281045913696
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.995 Vali Acc: 0.540 Test Loss: 0.995 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 19.788371562957764
Epoch: 2, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.845 Vali Acc: 0.480 Test Loss: 0.845 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.23975896835327
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.912 Vali Acc: 0.440 Test Loss: 0.912 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.95383858680725
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 1.082 Vali Acc: 0.470 Test Loss: 1.082 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.427833557128906
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.791 Vali Acc: 0.440 Test Loss: 0.791 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.526000261306763
Epoch: 6, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 21.887102127075195
Epoch: 7, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.406 Vali Acc: 0.470 Test Loss: 1.406 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 22.017406463623047
Epoch: 8, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.227 Vali Acc: 0.490 Test Loss: 1.227 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 22.01306653022766
Epoch: 9, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.897 Vali Acc: 0.480 Test Loss: 0.897 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 22.008389234542847
Epoch: 10, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.055 Vali Acc: 0.520 Test Loss: 1.055 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 22.012868642807007
Epoch: 11, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 1271586
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.019700050354004
Epoch: 1, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 10.065783977508545
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 9.651651620864868
Epoch: 3, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.855 Vali Acc: 0.520 Test Loss: 0.855 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.539878129959106
Epoch: 4, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.537916660308838
Epoch: 5, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.903490781784058
Epoch: 6, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.694 Vali Acc: 0.520 Test Loss: 1.694 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.842250347137451
Epoch: 7, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.332 Vali Acc: 0.540 Test Loss: 1.332 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.302054643630981
Epoch: 8, Steps: 18 | Train Loss: 0.368 Vali Loss: 0.986 Vali Acc: 0.460 Test Loss: 0.986 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.38016676902771
Epoch: 9, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.999 Vali Acc: 0.560 Test Loss: 0.999 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559990).  Saving model ...
Epoch: 10 cost time: 8.137359857559204
Epoch: 10, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.889 Vali Acc: 0.470 Test Loss: 1.889 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.98314619064331
Epoch: 11, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.353 Vali Acc: 0.560 Test Loss: 1.353 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.635843515396118
Epoch: 12, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.626 Vali Acc: 0.530 Test Loss: 1.626 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.964807748794556
Epoch: 13, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.884 Vali Acc: 0.570 Test Loss: 1.884 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569981).  Saving model ...
Epoch: 14 cost time: 8.946025133132935
Epoch: 14, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.654 Vali Acc: 0.520 Test Loss: 1.654 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.586392879486084
Epoch: 15, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.653 Vali Acc: 0.520 Test Loss: 2.653 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.631314277648926
Epoch: 16, Steps: 18 | Train Loss: 0.052 Vali Loss: 4.162 Vali Acc: 0.510 Test Loss: 4.162 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.384684562683105
Epoch: 17, Steps: 18 | Train Loss: 0.079 Vali Loss: 3.333 Vali Acc: 0.520 Test Loss: 3.333 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.328198671340942
Epoch: 18, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.041 Vali Acc: 0.500 Test Loss: 2.041 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.991375207901001
Epoch: 19, Steps: 18 | Train Loss: 0.038 Vali Loss: 2.418 Vali Acc: 0.560 Test Loss: 2.418 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.598450899124146
Epoch: 20, Steps: 18 | Train Loss: 0.037 Vali Loss: 3.349 Vali Acc: 0.560 Test Loss: 3.349 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.032091856002808
Epoch: 21, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.707 Vali Acc: 0.510 Test Loss: 2.707 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.719789266586304
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 3.546 Vali Acc: 0.560 Test Loss: 3.546 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.73458194732666
Epoch: 23, Steps: 18 | Train Loss: 0.026 Vali Loss: 2.952 Vali Acc: 0.580 Test Loss: 2.952 Test Acc: 0.580
Validation loss decreased (-0.569981 --> -0.579970).  Saving model ...
Epoch: 24 cost time: 10.622671365737915
Epoch: 24, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.989 Vali Acc: 0.550 Test Loss: 2.989 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.143068313598633
Epoch: 25, Steps: 18 | Train Loss: 0.028 Vali Loss: 2.276 Vali Acc: 0.550 Test Loss: 2.276 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.83125352859497
Epoch: 26, Steps: 18 | Train Loss: 0.060 Vali Loss: 2.339 Vali Acc: 0.550 Test Loss: 2.339 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 10.89657187461853
Epoch: 27, Steps: 18 | Train Loss: 0.056 Vali Loss: 4.598 Vali Acc: 0.520 Test Loss: 4.598 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 10.151833295822144
Epoch: 28, Steps: 18 | Train Loss: 0.063 Vali Loss: 3.086 Vali Acc: 0.450 Test Loss: 3.086 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.664163589477539
Epoch: 29, Steps: 18 | Train Loss: 0.018 Vali Loss: 4.146 Vali Acc: 0.480 Test Loss: 4.146 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 10.974790334701538
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 2.273 Vali Acc: 0.510 Test Loss: 2.273 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 443874
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.523966789245605
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.996 Vali Acc: 0.540 Test Loss: 0.996 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 12.465051651000977
Epoch: 2, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.844 Vali Acc: 0.480 Test Loss: 0.844 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.354623556137085
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.907 Vali Acc: 0.450 Test Loss: 0.907 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.08493971824646
Epoch: 4, Steps: 18 | Train Loss: 0.591 Vali Loss: 1.082 Vali Acc: 0.470 Test Loss: 1.082 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.689250707626343
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.788 Vali Acc: 0.470 Test Loss: 0.788 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.70741319656372
Epoch: 6, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.141358852386475
Epoch: 7, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.376 Vali Acc: 0.460 Test Loss: 1.376 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.908110618591309
Epoch: 8, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 13.082088708877563
Epoch: 9, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.898 Vali Acc: 0.490 Test Loss: 0.898 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.0657057762146
Epoch: 10, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 13.266875267028809
Epoch: 11, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.147 Vali Acc: 0.490 Test Loss: 1.147 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.13978624343872
Epoch: 12, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.591 Vali Acc: 0.520 Test Loss: 1.591 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.654294729232788
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.77098798751831
Epoch: 14, Steps: 18 | Train Loss: 0.089 Vali Loss: 2.151 Vali Acc: 0.510 Test Loss: 2.151 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.8964269161224365
Epoch: 15, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.250 Vali Acc: 0.510 Test Loss: 1.250 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.522695779800415
Epoch: 16, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.354578733444214
Epoch: 17, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.590 Vali Acc: 0.460 Test Loss: 1.590 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.78377103805542
Epoch: 18, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.776 Vali Acc: 0.480 Test Loss: 1.776 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.280790328979492
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.581 Vali Acc: 0.470 Test Loss: 1.581 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.867945909500122
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 1.543 Vali Acc: 0.520 Test Loss: 1.543 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1271586
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.453600645065308
Epoch: 1, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 6.648535490036011
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.766 Vali Acc: 0.550 Test Loss: 0.766 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 6.188662767410278
Epoch: 3, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.982646226882935
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.408242225646973
Epoch: 5, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.744 Vali Acc: 0.480 Test Loss: 0.744 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.5296618938446045
Epoch: 6, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.736 Vali Acc: 0.520 Test Loss: 1.736 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.207849025726318
Epoch: 7, Steps: 18 | Train Loss: 0.446 Vali Loss: 1.414 Vali Acc: 0.540 Test Loss: 1.414 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.922203302383423
Epoch: 8, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.976 Vali Acc: 0.490 Test Loss: 0.976 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.407744646072388
Epoch: 9, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.215 Vali Acc: 0.520 Test Loss: 1.215 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.37725043296814
Epoch: 10, Steps: 18 | Train Loss: 0.207 Vali Loss: 2.044 Vali Acc: 0.470 Test Loss: 2.044 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.751113176345825
Epoch: 11, Steps: 18 | Train Loss: 0.231 Vali Loss: 2.693 Vali Acc: 0.510 Test Loss: 2.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.953288316726685
Epoch: 12, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.586 Vali Acc: 0.520 Test Loss: 1.586 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 443874
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 18.87663435935974
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.736 Vali Acc: 0.580 Test Loss: 0.736 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 16.812996864318848
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.748 Vali Acc: 0.490 Test Loss: 0.748 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.1771183013916
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.579328060150146
Epoch: 4, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.933 Vali Acc: 0.500 Test Loss: 0.933 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.325371503829956
Epoch: 5, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 16.41023850440979
Epoch: 6, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.847 Vali Acc: 0.480 Test Loss: 0.847 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.49043583869934
Epoch: 7, Steps: 18 | Train Loss: 0.338 Vali Loss: 0.821 Vali Acc: 0.470 Test Loss: 0.821 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.216103792190552
Epoch: 8, Steps: 18 | Train Loss: 0.263 Vali Loss: 0.986 Vali Acc: 0.550 Test Loss: 0.986 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 14.350322723388672
Epoch: 9, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.027 Vali Acc: 0.480 Test Loss: 1.027 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.71548056602478
Epoch: 10, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.213496685028076
Epoch: 11, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.340 Vali Acc: 0.520 Test Loss: 1.340 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 685474
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.149285078048706
Epoch: 1, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.728 Vali Acc: 0.450 Test Loss: 0.728 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 8.24464464187622
Epoch: 2, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.746 Vali Acc: 0.590 Test Loss: 0.746 Test Acc: 0.590
Validation loss decreased (-0.449993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 7.962181091308594
Epoch: 3, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.804 Vali Acc: 0.600 Test Loss: 0.804 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 8.23388957977295
Epoch: 4, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.442169666290283
Epoch: 5, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.873 Vali Acc: 0.570 Test Loss: 0.873 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.18978238105774
Epoch: 6, Steps: 18 | Train Loss: 0.338 Vali Loss: 0.996 Vali Acc: 0.540 Test Loss: 0.996 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.010401725769043
Epoch: 7, Steps: 18 | Train Loss: 0.261 Vali Loss: 1.157 Vali Acc: 0.490 Test Loss: 1.157 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.48131275177002
Epoch: 8, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.079 Vali Acc: 0.550 Test Loss: 1.079 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.587680578231812
Epoch: 9, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.206678867340088
Epoch: 10, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.086 Vali Acc: 0.540 Test Loss: 1.086 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.380019187927246
Epoch: 11, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.962 Vali Acc: 0.500 Test Loss: 1.962 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.639732599258423
Epoch: 12, Steps: 18 | Train Loss: 0.246 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.547523021697998
Epoch: 13, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.752 Vali Acc: 0.520 Test Loss: 1.752 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 271586
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.115495443344116
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.736 Vali Acc: 0.580 Test Loss: 0.736 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 11.653392791748047
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.558080196380615
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.228071689605713
Epoch: 4, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.919 Vali Acc: 0.530 Test Loss: 0.919 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.618361711502075
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.831 Vali Acc: 0.520 Test Loss: 0.831 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.789085865020752
Epoch: 6, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.849 Vali Acc: 0.470 Test Loss: 0.849 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 12.845746278762817
Epoch: 7, Steps: 18 | Train Loss: 0.342 Vali Loss: 0.819 Vali Acc: 0.490 Test Loss: 0.819 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.482243537902832
Epoch: 8, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.947377443313599
Epoch: 9, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.019 Vali Acc: 0.520 Test Loss: 1.019 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.39985990524292
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.493 Vali Acc: 0.440 Test Loss: 1.493 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 13.477795839309692
Epoch: 11, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.115 Vali Acc: 0.580 Test Loss: 1.115 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 685474
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.313849687576294
Epoch: 1, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.554941654205322
Epoch: 2, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.743 Vali Acc: 0.580 Test Loss: 0.743 Test Acc: 0.580
Validation loss decreased (-0.449993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 5.182835340499878
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.809 Vali Acc: 0.590 Test Loss: 0.809 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 5.975403308868408
Epoch: 4, Steps: 18 | Train Loss: 0.474 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.953984975814819
Epoch: 5, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.898 Vali Acc: 0.560 Test Loss: 0.898 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.690033912658691
Epoch: 6, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.005 Vali Acc: 0.530 Test Loss: 1.005 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.409607172012329
Epoch: 7, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.110 Vali Acc: 0.510 Test Loss: 1.110 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.753145456314087
Epoch: 8, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.959 Vali Acc: 0.530 Test Loss: 0.959 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.952146053314209
Epoch: 9, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.216 Vali Acc: 0.510 Test Loss: 1.216 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.600618124008179
Epoch: 10, Steps: 18 | Train Loss: 0.152 Vali Loss: 1.260 Vali Acc: 0.480 Test Loss: 1.260 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.790127754211426
Epoch: 11, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.809 Vali Acc: 0.500 Test Loss: 1.809 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.010509252548218
Epoch: 12, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.654667615890503
Epoch: 13, Steps: 18 | Train Loss: 0.057 Vali Loss: 1.930 Vali Acc: 0.520 Test Loss: 1.930 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 271586
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.146312713623047
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.735 Vali Acc: 0.590 Test Loss: 0.735 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 9.194775819778442
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.747 Vali Acc: 0.490 Test Loss: 0.747 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.771922826766968
Epoch: 3, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.114655494689941
Epoch: 4, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.900 Vali Acc: 0.530 Test Loss: 0.900 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.168998718261719
Epoch: 5, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.135350465774536
Epoch: 6, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.849 Vali Acc: 0.480 Test Loss: 0.849 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.776106834411621
Epoch: 7, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.14993143081665
Epoch: 8, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.012 Vali Acc: 0.550 Test Loss: 1.012 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.115017890930176
Epoch: 9, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.368 Vali Acc: 0.480 Test Loss: 1.368 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.501075267791748
Epoch: 10, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.524 Vali Acc: 0.490 Test Loss: 1.524 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.502809286117554
Epoch: 11, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.057 Vali Acc: 0.530 Test Loss: 1.057 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 685474
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.890072822570801
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.729 Vali Acc: 0.450 Test Loss: 0.729 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 3.8911571502685547
Epoch: 2, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.741 Vali Acc: 0.580 Test Loss: 0.741 Test Acc: 0.580
Validation loss decreased (-0.449993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 4.105530738830566
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.802 Vali Acc: 0.600 Test Loss: 0.802 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 4.24758243560791
Epoch: 4, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.140506029129028
Epoch: 5, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.896 Vali Acc: 0.560 Test Loss: 0.896 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.848804235458374
Epoch: 6, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.002 Vali Acc: 0.520 Test Loss: 1.002 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.222607374191284
Epoch: 7, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.389234781265259
Epoch: 8, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.905 Vali Acc: 0.540 Test Loss: 0.905 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.1810219287872314
Epoch: 9, Steps: 18 | Train Loss: 0.385 Vali Loss: 1.412 Vali Acc: 0.510 Test Loss: 1.412 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.102197170257568
Epoch: 10, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.007 Vali Acc: 0.520 Test Loss: 1.007 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.855848789215088
Epoch: 11, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.934 Vali Acc: 0.510 Test Loss: 1.934 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.796885967254639
Epoch: 12, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.240 Vali Acc: 0.510 Test Loss: 1.240 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.110685110092163
Epoch: 13, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.742 Vali Acc: 0.510 Test Loss: 1.742 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 271586
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.484819650650024
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 12.979114055633545
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.687 Vali Acc: 0.540 Test Loss: 0.687 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 13.280718326568604
Epoch: 3, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.935 Vali Acc: 0.520 Test Loss: 0.935 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.657262802124023
Epoch: 4, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 10.932698965072632
Epoch: 5, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.710788249969482
Epoch: 6, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.894273042678833
Epoch: 7, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.934 Vali Acc: 0.530 Test Loss: 0.934 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.262122392654419
Epoch: 8, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.329308986663818
Epoch: 9, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.859 Vali Acc: 0.520 Test Loss: 0.859 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.213433980941772
Epoch: 10, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.475 Vali Acc: 0.560 Test Loss: 1.475 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.587122440338135
Epoch: 11, Steps: 18 | Train Loss: 0.282 Vali Loss: 0.939 Vali Acc: 0.570 Test Loss: 0.939 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.36736249923706
Epoch: 12, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.220 Vali Acc: 0.560 Test Loss: 1.220 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.645685911178589
Epoch: 13, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.775 Vali Acc: 0.500 Test Loss: 1.775 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.953436613082886
Epoch: 14, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.826 Vali Acc: 0.520 Test Loss: 1.826 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 392418
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.15161657333374
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.730 Vali Acc: 0.630 Test Loss: 0.730 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 6.687770843505859
Epoch: 2, Steps: 18 | Train Loss: 0.762 Vali Loss: 1.077 Vali Acc: 0.460 Test Loss: 1.077 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.772988319396973
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.299 Vali Acc: 0.460 Test Loss: 1.299 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.711562871932983
Epoch: 4, Steps: 18 | Train Loss: 0.635 Vali Loss: 1.119 Vali Acc: 0.450 Test Loss: 1.119 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.265599489212036
Epoch: 5, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.929 Vali Acc: 0.480 Test Loss: 0.929 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.642146348953247
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.855 Vali Acc: 0.490 Test Loss: 0.855 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.547802448272705
Epoch: 7, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.955 Vali Acc: 0.440 Test Loss: 0.955 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.789408922195435
Epoch: 8, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.056 Vali Acc: 0.510 Test Loss: 1.056 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.258914947509766
Epoch: 9, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.960 Vali Acc: 0.500 Test Loss: 0.960 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.746151447296143
Epoch: 10, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.666186571121216
Epoch: 11, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.971 Vali Acc: 0.480 Test Loss: 0.971 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 185442
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.100528001785278
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.713 Vali Acc: 0.540 Test Loss: 0.713 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 9.014633417129517
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.686 Vali Acc: 0.540 Test Loss: 0.686 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 9.469122171401978
Epoch: 3, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.932 Vali Acc: 0.520 Test Loss: 0.932 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.148862600326538
Epoch: 4, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.747 Vali Acc: 0.560 Test Loss: 0.747 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 11.575912714004517
Epoch: 5, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.639157056808472
Epoch: 6, Steps: 18 | Train Loss: 0.384 Vali Loss: 1.251 Vali Acc: 0.530 Test Loss: 1.251 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.884035348892212
Epoch: 7, Steps: 18 | Train Loss: 0.331 Vali Loss: 0.930 Vali Acc: 0.520 Test Loss: 0.930 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.727688550949097
Epoch: 8, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.580902338027954
Epoch: 9, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.907 Vali Acc: 0.540 Test Loss: 0.907 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.10664701461792
Epoch: 10, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.177 Vali Acc: 0.560 Test Loss: 1.177 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.701271295547485
Epoch: 11, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.214 Vali Acc: 0.530 Test Loss: 1.214 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.019794464111328
Epoch: 12, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.389 Vali Acc: 0.490 Test Loss: 1.389 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.562250137329102
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.649 Vali Acc: 0.450 Test Loss: 1.649 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.827414751052856
Epoch: 14, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.982 Vali Acc: 0.530 Test Loss: 1.982 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 392418
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.5690248012542725
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.730 Vali Acc: 0.630 Test Loss: 0.730 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 4.740676164627075
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 1.078 Vali Acc: 0.460 Test Loss: 1.078 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.720896005630493
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.304 Vali Acc: 0.460 Test Loss: 1.304 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.049511194229126
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 1.112 Vali Acc: 0.450 Test Loss: 1.112 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.650670528411865
Epoch: 5, Steps: 18 | Train Loss: 0.418 Vali Loss: 0.941 Vali Acc: 0.470 Test Loss: 0.941 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.87884783744812
Epoch: 6, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.862857341766357
Epoch: 7, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.007 Vali Acc: 0.470 Test Loss: 1.007 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.842127084732056
Epoch: 8, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.143 Vali Acc: 0.510 Test Loss: 1.143 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.60840630531311
Epoch: 9, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.970 Vali Acc: 0.490 Test Loss: 0.970 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.585820436477661
Epoch: 10, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.102 Vali Acc: 0.530 Test Loss: 1.102 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.914057731628418
Epoch: 11, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.091 Vali Acc: 0.510 Test Loss: 1.091 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 185442
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.461859703063965
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.712 Vali Acc: 0.550 Test Loss: 0.712 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 7.5407960414886475
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.685 Vali Acc: 0.540 Test Loss: 0.685 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.156101703643799
Epoch: 3, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.933 Vali Acc: 0.520 Test Loss: 0.933 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.420500993728638
Epoch: 4, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.745 Vali Acc: 0.580 Test Loss: 0.745 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 7.489713668823242
Epoch: 5, Steps: 18 | Train Loss: 0.480 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.5677947998046875
Epoch: 6, Steps: 18 | Train Loss: 0.407 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.117009878158569
Epoch: 7, Steps: 18 | Train Loss: 0.335 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.384080648422241
Epoch: 8, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.532468318939209
Epoch: 9, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.876 Vali Acc: 0.560 Test Loss: 0.876 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.132730484008789
Epoch: 10, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.120 Vali Acc: 0.560 Test Loss: 1.120 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.066044330596924
Epoch: 11, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.347 Vali Acc: 0.530 Test Loss: 1.347 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.807746648788452
Epoch: 12, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.662707567214966
Epoch: 13, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.803 Vali Acc: 0.490 Test Loss: 1.803 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.22182559967041
Epoch: 14, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.613 Vali Acc: 0.510 Test Loss: 1.613 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 392418
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.134878158569336
Epoch: 1, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.730 Vali Acc: 0.630 Test Loss: 0.730 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 3.317811965942383
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 1.073 Vali Acc: 0.460 Test Loss: 1.073 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.210894823074341
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 1.304 Vali Acc: 0.460 Test Loss: 1.304 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.206773996353149
Epoch: 4, Steps: 18 | Train Loss: 0.639 Vali Loss: 1.130 Vali Acc: 0.430 Test Loss: 1.130 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.217320442199707
Epoch: 5, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.928 Vali Acc: 0.510 Test Loss: 0.928 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.027939558029175
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.850 Vali Acc: 0.490 Test Loss: 0.850 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.119184494018555
Epoch: 7, Steps: 18 | Train Loss: 0.277 Vali Loss: 1.013 Vali Acc: 0.470 Test Loss: 1.013 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.100668907165527
Epoch: 8, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.107 Vali Acc: 0.510 Test Loss: 1.107 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.152436256408691
Epoch: 9, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.005 Vali Acc: 0.470 Test Loss: 1.005 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.142026662826538
Epoch: 10, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.055 Vali Acc: 0.480 Test Loss: 1.055 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.9421229362487793
Epoch: 11, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.198 Vali Acc: 0.570 Test Loss: 1.198 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 185442
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 21.7623348236084
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 16.53592348098755
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.921065092086792
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.711 Vali Acc: 0.590 Test Loss: 0.711 Test Acc: 0.590
Validation loss decreased (-0.489992 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 16.036279439926147
Epoch: 4, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.880 Vali Acc: 0.490 Test Loss: 0.880 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.939929962158203
Epoch: 5, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.158 Vali Acc: 0.490 Test Loss: 1.158 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.23982834815979
Epoch: 6, Steps: 18 | Train Loss: 0.402 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.866927862167358
Epoch: 7, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.124 Vali Acc: 0.510 Test Loss: 1.124 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.562742471694946
Epoch: 8, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.100 Vali Acc: 0.460 Test Loss: 1.100 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 19.027111530303955
Epoch: 9, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.091 Vali Acc: 0.450 Test Loss: 1.091 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 19.43509864807129
Epoch: 10, Steps: 18 | Train Loss: 0.244 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 19.720287799835205
Epoch: 11, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.096 Vali Acc: 0.450 Test Loss: 1.096 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 19.53532910346985
Epoch: 12, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.326 Vali Acc: 0.470 Test Loss: 1.326 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.16418743133545
Epoch: 13, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.330 Vali Acc: 0.480 Test Loss: 1.330 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 636178
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.749046802520752
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.704 Vali Acc: 0.450 Test Loss: 0.704 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 8.103396892547607
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
Validation loss decreased (-0.449993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 7.55634617805481
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.713210821151733
Epoch: 4, Steps: 18 | Train Loss: 0.575 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.633298873901367
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.6140429973602295
Epoch: 6, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.960 Vali Acc: 0.470 Test Loss: 0.960 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.748743534088135
Epoch: 7, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.924 Vali Acc: 0.470 Test Loss: 0.924 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.110247135162354
Epoch: 8, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.974 Vali Acc: 0.510 Test Loss: 0.974 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.394956588745117
Epoch: 9, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.072 Vali Acc: 0.510 Test Loss: 1.072 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.653422594070435
Epoch: 10, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.280 Vali Acc: 0.530 Test Loss: 1.280 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.253630638122559
Epoch: 11, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.035 Vali Acc: 0.540 Test Loss: 1.035 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539990).  Saving model ...
Epoch: 12 cost time: 8.669400930404663
Epoch: 12, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.147236824035645
Epoch: 13, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.345 Vali Acc: 0.460 Test Loss: 1.345 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.134764671325684
Epoch: 14, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.535 Vali Acc: 0.440 Test Loss: 1.535 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.78816294670105
Epoch: 15, Steps: 18 | Train Loss: 0.090 Vali Loss: 2.049 Vali Acc: 0.460 Test Loss: 2.049 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.008272886276245
Epoch: 16, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.553 Vali Acc: 0.460 Test Loss: 1.553 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.151147603988647
Epoch: 17, Steps: 18 | Train Loss: 0.082 Vali Loss: 1.578 Vali Acc: 0.490 Test Loss: 1.578 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.889593124389648
Epoch: 18, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.955 Vali Acc: 0.450 Test Loss: 1.955 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.36435079574585
Epoch: 19, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.318 Vali Acc: 0.500 Test Loss: 2.318 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.24030351638794
Epoch: 20, Steps: 18 | Train Loss: 0.076 Vali Loss: 2.050 Vali Acc: 0.450 Test Loss: 2.050 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.031273126602173
Epoch: 21, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.996 Vali Acc: 0.490 Test Loss: 1.996 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 222194
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.687471628189087
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 11.679889917373657
Epoch: 2, Steps: 18 | Train Loss: 0.697 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 13.336520910263062
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
Validation loss decreased (-0.489992 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 12.67881178855896
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.909 Vali Acc: 0.500 Test Loss: 0.909 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.400833368301392
Epoch: 5, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.655411005020142
Epoch: 6, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.195 Vali Acc: 0.470 Test Loss: 1.195 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 14.872068405151367
Epoch: 7, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.987836122512817
Epoch: 8, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.611955881118774
Epoch: 9, Steps: 18 | Train Loss: 0.297 Vali Loss: 0.952 Vali Acc: 0.440 Test Loss: 0.952 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.733296155929565
Epoch: 10, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.084 Vali Acc: 0.520 Test Loss: 1.084 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 14.83183741569519
Epoch: 11, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.363 Vali Acc: 0.510 Test Loss: 1.363 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 14.649354219436646
Epoch: 12, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.023 Vali Acc: 0.490 Test Loss: 1.023 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.886743307113647
Epoch: 13, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.256 Vali Acc: 0.490 Test Loss: 1.256 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 636178
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.463672637939453
Epoch: 1, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.702 Vali Acc: 0.450 Test Loss: 0.702 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.899120330810547
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.732 Vali Acc: 0.530 Test Loss: 0.732 Test Acc: 0.530
Validation loss decreased (-0.449993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 5.96605110168457
Epoch: 3, Steps: 18 | Train Loss: 0.608 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 5.219818830490112
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.491464376449585
Epoch: 5, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.9513421058654785
Epoch: 6, Steps: 18 | Train Loss: 0.418 Vali Loss: 0.944 Vali Acc: 0.490 Test Loss: 0.944 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.916340589523315
Epoch: 7, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.848 Vali Acc: 0.470 Test Loss: 0.848 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.768758773803711
Epoch: 8, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.848 Vali Acc: 0.510 Test Loss: 0.848 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.5603110790252686
Epoch: 9, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.74954080581665
Epoch: 10, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.017 Vali Acc: 0.500 Test Loss: 1.017 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.981371879577637
Epoch: 11, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.129 Vali Acc: 0.460 Test Loss: 1.129 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.959725856781006
Epoch: 12, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.301 Vali Acc: 0.470 Test Loss: 1.301 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.981920003890991
Epoch: 13, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.065 Vali Acc: 0.490 Test Loss: 1.065 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 222194
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.227838277816772
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.750 Vali Acc: 0.470 Test Loss: 0.750 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 9.364653587341309
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.762 Vali Acc: 0.490 Test Loss: 0.762 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 9.624814748764038
Epoch: 3, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.706 Vali Acc: 0.600 Test Loss: 0.706 Test Acc: 0.600
Validation loss decreased (-0.489992 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 9.573729038238525
Epoch: 4, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.884 Vali Acc: 0.500 Test Loss: 0.884 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.073539972305298
Epoch: 5, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.769818067550659
Epoch: 6, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.160 Vali Acc: 0.460 Test Loss: 1.160 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.286131381988525
Epoch: 7, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.14622974395752
Epoch: 8, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.130 Vali Acc: 0.510 Test Loss: 1.130 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.139328241348267
Epoch: 9, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.977 Vali Acc: 0.440 Test Loss: 0.977 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.463288307189941
Epoch: 10, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.095 Vali Acc: 0.540 Test Loss: 1.095 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.285338401794434
Epoch: 11, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.193 Vali Acc: 0.480 Test Loss: 1.193 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.8554301261901855
Epoch: 12, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.321717500686646
Epoch: 13, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.245 Vali Acc: 0.490 Test Loss: 1.245 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 636178
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.884901523590088
Epoch: 1, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.698 Vali Acc: 0.460 Test Loss: 0.698 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 4.917748928070068
Epoch: 2, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 4.95977783203125
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.694 Vali Acc: 0.560 Test Loss: 0.694 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 4.972653150558472
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.042442560195923
Epoch: 5, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.818 Vali Acc: 0.550 Test Loss: 0.818 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.030362129211426
Epoch: 6, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.962 Vali Acc: 0.490 Test Loss: 0.962 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.004058122634888
Epoch: 7, Steps: 18 | Train Loss: 0.349 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.969182729721069
Epoch: 8, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.030834674835205
Epoch: 9, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.851 Vali Acc: 0.580 Test Loss: 0.851 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 10 cost time: 5.008773326873779
Epoch: 10, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.252 Vali Acc: 0.490 Test Loss: 1.252 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.011654615402222
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.360657691955566
Epoch: 12, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.147 Vali Acc: 0.510 Test Loss: 1.147 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.070482492446899
Epoch: 13, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.069 Vali Acc: 0.510 Test Loss: 1.069 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.174092769622803
Epoch: 14, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.366 Vali Acc: 0.530 Test Loss: 1.366 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.132290363311768
Epoch: 15, Steps: 18 | Train Loss: 0.070 Vali Loss: 1.568 Vali Acc: 0.480 Test Loss: 1.568 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.117760419845581
Epoch: 16, Steps: 18 | Train Loss: 0.059 Vali Loss: 1.598 Vali Acc: 0.490 Test Loss: 1.598 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.993394613265991
Epoch: 17, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.202229022979736
Epoch: 18, Steps: 18 | Train Loss: 0.027 Vali Loss: 1.688 Vali Acc: 0.530 Test Loss: 1.688 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.388808012008667
Epoch: 19, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.923 Vali Acc: 0.490 Test Loss: 1.923 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 222194
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.045665502548218
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 9.426740884780884
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.758 Vali Acc: 0.630 Test Loss: 0.758 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 11.765596151351929
Epoch: 3, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.733 Vali Acc: 0.620 Test Loss: 0.733 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.851584434509277
Epoch: 4, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.688 Vali Acc: 0.490 Test Loss: 0.688 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.840970754623413
Epoch: 5, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.718 Vali Acc: 0.610 Test Loss: 0.718 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.917993545532227
Epoch: 6, Steps: 18 | Train Loss: 0.487 Vali Loss: 0.784 Vali Acc: 0.540 Test Loss: 0.784 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.825673818588257
Epoch: 7, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.813 Vali Acc: 0.600 Test Loss: 0.813 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.811643838882446
Epoch: 8, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.812 Vali Acc: 0.560 Test Loss: 0.812 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.859291791915894
Epoch: 9, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.859 Vali Acc: 0.490 Test Loss: 0.859 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.856942176818848
Epoch: 10, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.929 Vali Acc: 0.510 Test Loss: 0.929 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.86229157447815
Epoch: 11, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.486 Vali Acc: 0.490 Test Loss: 1.486 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.140119314193726
Epoch: 12, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.264 Vali Acc: 0.510 Test Loss: 1.264 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 342930
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.553596496582031
Epoch: 1, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.722616910934448
Epoch: 2, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
Validation loss decreased (-0.469993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 4.830805540084839
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.910 Vali Acc: 0.530 Test Loss: 0.910 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 4.908452272415161
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.708 Vali Acc: 0.580 Test Loss: 0.708 Test Acc: 0.580
Validation loss decreased (-0.529991 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 4.832011461257935
Epoch: 5, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.714 Vali Acc: 0.530 Test Loss: 0.714 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.627734661102295
Epoch: 6, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.760 Vali Acc: 0.590 Test Loss: 0.760 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 4.599154233932495
Epoch: 7, Steps: 18 | Train Loss: 0.423 Vali Loss: 0.727 Vali Acc: 0.620 Test Loss: 0.727 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619993).  Saving model ...
Epoch: 8 cost time: 4.502396821975708
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.884073495864868
Epoch: 9, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.778 Vali Acc: 0.590 Test Loss: 0.778 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.972381353378296
Epoch: 10, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.913 Vali Acc: 0.510 Test Loss: 0.913 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.923197507858276
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.020 Vali Acc: 0.580 Test Loss: 1.020 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.856396675109863
Epoch: 12, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.899944305419922
Epoch: 13, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.231 Vali Acc: 0.510 Test Loss: 1.231 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.8294970989227295
Epoch: 14, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.600 Vali Acc: 0.480 Test Loss: 1.600 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.797968626022339
Epoch: 15, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.349 Vali Acc: 0.530 Test Loss: 1.349 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.833327054977417
Epoch: 16, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.692 Vali Acc: 0.490 Test Loss: 1.692 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.911096572875977
Epoch: 17, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.460 Vali Acc: 0.510 Test Loss: 1.460 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 135922
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.783919334411621
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.686 Vali Acc: 0.590 Test Loss: 0.686 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 7.844702482223511
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.759 Vali Acc: 0.630 Test Loss: 0.759 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 8.186220169067383
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.721 Vali Acc: 0.630 Test Loss: 0.721 Test Acc: 0.630
Validation loss decreased (-0.629992 --> -0.629993).  Saving model ...
Epoch: 4 cost time: 7.987502574920654
Epoch: 4, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.689 Vali Acc: 0.490 Test Loss: 0.689 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.430706262588501
Epoch: 5, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.706 Vali Acc: 0.590 Test Loss: 0.706 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.929407835006714
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.246201515197754
Epoch: 7, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.731 Vali Acc: 0.600 Test Loss: 0.731 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.19241738319397
Epoch: 8, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.234722137451172
Epoch: 9, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.146055698394775
Epoch: 10, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.835 Vali Acc: 0.480 Test Loss: 0.835 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.551123857498169
Epoch: 11, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.924 Vali Acc: 0.470 Test Loss: 0.924 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.692129850387573
Epoch: 12, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.275 Vali Acc: 0.510 Test Loss: 1.275 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.653151273727417
Epoch: 13, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.391 Vali Acc: 0.480 Test Loss: 1.391 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 342930
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.811787128448486
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.732 Vali Acc: 0.470 Test Loss: 0.732 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.757296323776245
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.708 Vali Acc: 0.480 Test Loss: 0.708 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 4.935672283172607
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.920 Vali Acc: 0.530 Test Loss: 0.920 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 5.228665828704834
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.712 Vali Acc: 0.570 Test Loss: 0.712 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 5.088550806045532
Epoch: 5, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.094820261001587
Epoch: 6, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.748 Vali Acc: 0.540 Test Loss: 0.748 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.065325498580933
Epoch: 7, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.722 Vali Acc: 0.600 Test Loss: 0.722 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 5.028933048248291
Epoch: 8, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.838 Vali Acc: 0.520 Test Loss: 0.838 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.064807891845703
Epoch: 9, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.750 Vali Acc: 0.570 Test Loss: 0.750 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.046406984329224
Epoch: 10, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.93579363822937
Epoch: 11, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.975090980529785
Epoch: 12, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.423 Vali Acc: 0.540 Test Loss: 1.423 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.010229110717773
Epoch: 13, Steps: 18 | Train Loss: 0.189 Vali Loss: 1.410 Vali Acc: 0.560 Test Loss: 1.410 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.9960291385650635
Epoch: 14, Steps: 18 | Train Loss: 0.332 Vali Loss: 1.381 Vali Acc: 0.470 Test Loss: 1.381 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.278352499008179
Epoch: 15, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.148 Vali Acc: 0.480 Test Loss: 1.148 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.232998371124268
Epoch: 16, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.296283483505249
Epoch: 17, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.234 Vali Acc: 0.530 Test Loss: 1.234 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 135922
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.974061727523804
Epoch: 1, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.685 Vali Acc: 0.590 Test Loss: 0.685 Test Acc: 0.590
Validation loss decreased (inf --> -0.589993).  Saving model ...
Epoch: 2 cost time: 5.425120830535889
Epoch: 2, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.759 Vali Acc: 0.630 Test Loss: 0.759 Test Acc: 0.630
Validation loss decreased (-0.589993 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 5.38747763633728
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.725 Vali Acc: 0.610 Test Loss: 0.725 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.748136281967163
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.689 Vali Acc: 0.500 Test Loss: 0.689 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.6540141105651855
Epoch: 5, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.716 Vali Acc: 0.600 Test Loss: 0.716 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.697236061096191
Epoch: 6, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.757 Vali Acc: 0.510 Test Loss: 0.757 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.403749942779541
Epoch: 7, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.715 Vali Acc: 0.600 Test Loss: 0.715 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.5404205322265625
Epoch: 8, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.630088806152344
Epoch: 9, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.691186428070068
Epoch: 10, Steps: 18 | Train Loss: 0.270 Vali Loss: 0.833 Vali Acc: 0.510 Test Loss: 0.833 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.7771992683410645
Epoch: 11, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.6661927700042725
Epoch: 12, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.096 Vali Acc: 0.490 Test Loss: 1.096 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 342930
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.238137245178223
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.800421714782715
Epoch: 2, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.707 Vali Acc: 0.470 Test Loss: 0.707 Test Acc: 0.470
Validation loss decreased (-0.469993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 3.8200268745422363
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 3.7571945190429688
Epoch: 4, Steps: 18 | Train Loss: 0.574 Vali Loss: 0.715 Vali Acc: 0.570 Test Loss: 0.715 Test Acc: 0.570
Validation loss decreased (-0.529991 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 3.844183921813965
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.788717031478882
Epoch: 6, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.753 Vali Acc: 0.590 Test Loss: 0.753 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 7 cost time: 3.741598606109619
Epoch: 7, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.730 Vali Acc: 0.590 Test Loss: 0.730 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589993).  Saving model ...
Epoch: 8 cost time: 3.50410532951355
Epoch: 8, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1143710613250732
Epoch: 9, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.23339581489563
Epoch: 10, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.938 Vali Acc: 0.480 Test Loss: 0.938 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2031943798065186
Epoch: 11, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.839 Vali Acc: 0.460 Test Loss: 0.839 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.105987071990967
Epoch: 12, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.392 Vali Acc: 0.530 Test Loss: 1.392 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1457440853118896
Epoch: 13, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.207 Vali Acc: 0.530 Test Loss: 1.207 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.205575466156006
Epoch: 14, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1083574295043945
Epoch: 15, Steps: 18 | Train Loss: 0.161 Vali Loss: 1.067 Vali Acc: 0.520 Test Loss: 1.067 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.2978250980377197
Epoch: 16, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.631 Vali Acc: 0.480 Test Loss: 1.631 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1400718688964844
Epoch: 17, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.329 Vali Acc: 0.500 Test Loss: 1.329 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 135922
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.193943500518799
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 7.408804416656494
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.030899286270142
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.755 Vali Acc: 0.610 Test Loss: 0.755 Test Acc: 0.610
Validation loss decreased (-0.549992 --> -0.609992).  Saving model ...
Epoch: 4 cost time: 8.853697776794434
Epoch: 4, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.666 Vali Acc: 0.630 Test Loss: 0.666 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629993).  Saving model ...
Epoch: 5 cost time: 8.950669288635254
Epoch: 5, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.720 Vali Acc: 0.520 Test Loss: 0.720 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.895920753479004
Epoch: 6, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.858 Vali Acc: 0.490 Test Loss: 0.858 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.953113079071045
Epoch: 7, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.737 Vali Acc: 0.520 Test Loss: 0.737 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.899364709854126
Epoch: 8, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.816 Vali Acc: 0.580 Test Loss: 0.816 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.92803144454956
Epoch: 9, Steps: 18 | Train Loss: 0.339 Vali Loss: 0.819 Vali Acc: 0.530 Test Loss: 0.819 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.99131178855896
Epoch: 10, Steps: 18 | Train Loss: 0.366 Vali Loss: 1.483 Vali Acc: 0.490 Test Loss: 1.483 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.10841155052185
Epoch: 11, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.000 Vali Acc: 0.570 Test Loss: 1.000 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.187289476394653
Epoch: 12, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.119 Vali Acc: 0.530 Test Loss: 1.119 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.15378713607788
Epoch: 13, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.981 Vali Acc: 0.490 Test Loss: 0.981 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.511732578277588
Epoch: 14, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 196306
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.017334222793579
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.725 Vali Acc: 0.480 Test Loss: 0.725 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.954291582107544
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
Validation loss decreased (-0.479993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 3.835676431655884
Epoch: 3, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 3.855328321456909
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.933 Vali Acc: 0.480 Test Loss: 0.933 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.053955316543579
Epoch: 5, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.750 Vali Acc: 0.510 Test Loss: 0.750 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 4.025611162185669
Epoch: 6, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.851 Vali Acc: 0.480 Test Loss: 0.851 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.046675682067871
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.105 Vali Acc: 0.510 Test Loss: 1.105 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.975656509399414
Epoch: 8, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.963 Vali Acc: 0.540 Test Loss: 0.963 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539990).  Saving model ...
Epoch: 9 cost time: 3.796344757080078
Epoch: 9, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.076329469680786
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.864 Vali Acc: 0.530 Test Loss: 0.864 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8696353435516357
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9534666538238525
Epoch: 12, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.941 Vali Acc: 0.540 Test Loss: 0.941 Test Acc: 0.540
Validation loss decreased (-0.539990 --> -0.539991).  Saving model ...
Epoch: 13 cost time: 4.5823259353637695
Epoch: 13, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.686792850494385
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.072 Vali Acc: 0.520 Test Loss: 1.072 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.55788254737854
Epoch: 15, Steps: 18 | Train Loss: 0.104 Vali Loss: 2.316 Vali Acc: 0.480 Test Loss: 2.316 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.726032495498657
Epoch: 16, Steps: 18 | Train Loss: 0.085 Vali Loss: 1.359 Vali Acc: 0.460 Test Loss: 1.359 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.591411113739014
Epoch: 17, Steps: 18 | Train Loss: 0.094 Vali Loss: 2.163 Vali Acc: 0.500 Test Loss: 2.163 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.604834318161011
Epoch: 18, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.455 Vali Acc: 0.540 Test Loss: 1.455 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.609860420227051
Epoch: 19, Steps: 18 | Train Loss: 0.040 Vali Loss: 2.264 Vali Acc: 0.510 Test Loss: 2.264 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.567117691040039
Epoch: 20, Steps: 18 | Train Loss: 0.034 Vali Loss: 2.275 Vali Acc: 0.510 Test Loss: 2.275 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.69564962387085
Epoch: 21, Steps: 18 | Train Loss: 0.040 Vali Loss: 1.558 Vali Acc: 0.540 Test Loss: 1.558 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.693238019943237
Epoch: 22, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.890 Vali Acc: 0.540 Test Loss: 1.890 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 92786
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.402039766311646
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 6.406224489212036
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.422156095504761
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.754 Vali Acc: 0.600 Test Loss: 0.754 Test Acc: 0.600
Validation loss decreased (-0.539992 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 6.466006755828857
Epoch: 4, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.666 Vali Acc: 0.630 Test Loss: 0.666 Test Acc: 0.630
Validation loss decreased (-0.599992 --> -0.629993).  Saving model ...
Epoch: 5 cost time: 6.436249256134033
Epoch: 5, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.369835376739502
Epoch: 6, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.837 Vali Acc: 0.480 Test Loss: 0.837 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.33069372177124
Epoch: 7, Steps: 18 | Train Loss: 0.491 Vali Loss: 0.729 Vali Acc: 0.520 Test Loss: 0.729 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.38493800163269
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.849 Vali Acc: 0.600 Test Loss: 0.849 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.433055877685547
Epoch: 9, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.386912822723389
Epoch: 10, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.506 Vali Acc: 0.510 Test Loss: 1.506 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.541805028915405
Epoch: 11, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.914 Vali Acc: 0.620 Test Loss: 0.914 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.61156153678894
Epoch: 12, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.485090970993042
Epoch: 13, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.959 Vali Acc: 0.510 Test Loss: 0.959 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.682835340499878
Epoch: 14, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.940 Vali Acc: 0.530 Test Loss: 0.940 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 196306
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.202997446060181
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.724 Vali Acc: 0.480 Test Loss: 0.724 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 4.202996730804443
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.754 Vali Acc: 0.520 Test Loss: 0.754 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 4.139888286590576
Epoch: 3, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.157642126083374
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.959 Vali Acc: 0.480 Test Loss: 0.959 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.177352428436279
Epoch: 5, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.08460545539856
Epoch: 6, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.866 Vali Acc: 0.490 Test Loss: 0.866 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.089529752731323
Epoch: 7, Steps: 18 | Train Loss: 0.448 Vali Loss: 1.029 Vali Acc: 0.500 Test Loss: 1.029 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.228133916854858
Epoch: 8, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.943 Vali Acc: 0.490 Test Loss: 0.943 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.144044399261475
Epoch: 9, Steps: 18 | Train Loss: 0.332 Vali Loss: 0.870 Vali Acc: 0.580 Test Loss: 0.870 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579991).  Saving model ...
Epoch: 10 cost time: 3.2696828842163086
Epoch: 10, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.928 Vali Acc: 0.520 Test Loss: 0.928 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6004254817962646
Epoch: 11, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.920 Vali Acc: 0.510 Test Loss: 0.920 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.433608293533325
Epoch: 12, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.023 Vali Acc: 0.530 Test Loss: 1.023 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.455883026123047
Epoch: 13, Steps: 18 | Train Loss: 0.155 Vali Loss: 1.247 Vali Acc: 0.540 Test Loss: 1.247 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.486440896987915
Epoch: 14, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.148 Vali Acc: 0.510 Test Loss: 1.148 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3925907611846924
Epoch: 15, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.355 Vali Acc: 0.480 Test Loss: 2.355 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.49505352973938
Epoch: 16, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.418 Vali Acc: 0.490 Test Loss: 1.418 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.426381826400757
Epoch: 17, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.653 Vali Acc: 0.520 Test Loss: 1.653 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.34769868850708
Epoch: 18, Steps: 18 | Train Loss: 0.116 Vali Loss: 1.258 Vali Acc: 0.530 Test Loss: 1.258 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5164968967437744
Epoch: 19, Steps: 18 | Train Loss: 0.041 Vali Loss: 2.197 Vali Acc: 0.530 Test Loss: 2.197 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 92786
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.295993328094482
Epoch: 1, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 4.177144765853882
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.051270961761475
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.751 Vali Acc: 0.610 Test Loss: 0.751 Test Acc: 0.610
Validation loss decreased (-0.529992 --> -0.609992).  Saving model ...
Epoch: 4 cost time: 5.121389150619507
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.665 Vali Acc: 0.630 Test Loss: 0.665 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629993).  Saving model ...
Epoch: 5 cost time: 5.161230802536011
Epoch: 5, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.724 Vali Acc: 0.530 Test Loss: 0.724 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.21706223487854
Epoch: 6, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.159959316253662
Epoch: 7, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.732 Vali Acc: 0.510 Test Loss: 0.732 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.151410818099976
Epoch: 8, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.887 Vali Acc: 0.570 Test Loss: 0.887 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.172099351882935
Epoch: 9, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.239039897918701
Epoch: 10, Steps: 18 | Train Loss: 0.388 Vali Loss: 1.535 Vali Acc: 0.490 Test Loss: 1.535 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.158211946487427
Epoch: 11, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.841 Vali Acc: 0.570 Test Loss: 0.841 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.065884590148926
Epoch: 12, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.175 Vali Acc: 0.520 Test Loss: 1.175 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.202667951583862
Epoch: 13, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.101525545120239
Epoch: 14, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.982 Vali Acc: 0.520 Test Loss: 0.982 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 196306
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.287447452545166
Epoch: 1, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.721 Vali Acc: 0.480 Test Loss: 0.721 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.5595455169677734
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.625563859939575
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.762 Vali Acc: 0.570 Test Loss: 0.762 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.6665265560150146
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.933 Vali Acc: 0.480 Test Loss: 0.933 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7048871517181396
Epoch: 5, Steps: 18 | Train Loss: 0.518 Vali Loss: 0.738 Vali Acc: 0.540 Test Loss: 0.738 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.648071050643921
Epoch: 6, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.66796612739563
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.57497239112854
Epoch: 8, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.794 Vali Acc: 0.530 Test Loss: 0.794 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.739985227584839
Epoch: 9, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.909 Vali Acc: 0.550 Test Loss: 0.909 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.625298261642456
Epoch: 10, Steps: 18 | Train Loss: 0.310 Vali Loss: 0.929 Vali Acc: 0.540 Test Loss: 0.929 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4126291275024414
Epoch: 11, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.009 Vali Acc: 0.520 Test Loss: 1.009 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7463741302490234
Epoch: 12, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.891 Vali Acc: 0.550 Test Loss: 0.891 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6266727447509766
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.265 Vali Acc: 0.550 Test Loss: 1.265 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_TimesNet_UEA_ftM_sl3000_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 92786
model size : 0.52MB
