Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 9.896870136260986
Epoch: 1, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 8.489155292510986
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 8.4863862991333
Epoch: 3, Steps: 3 | Train Loss: 1.017 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
Validation loss decreased (-0.599988 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 8.66061019897461
Epoch: 4, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.677 Vali Acc: 0.800 Test Loss: 0.677 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 8.61442494392395
Epoch: 5, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.799993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 8.711265802383423
Epoch: 6, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974997).  Saving model ...
Epoch: 7 cost time: 8.215495347976685
Epoch: 7, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 8 cost time: 9.029014348983765
Epoch: 8, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 8.982977390289307
Epoch: 9, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 8.826974868774414
Epoch: 10, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 11 cost time: 8.787063360214233
Epoch: 11, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 12 cost time: 8.84400224685669
Epoch: 12, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 13 cost time: 7.804726600646973
Epoch: 13, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 14 cost time: 9.025858163833618
Epoch: 14, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 1.000 Test Loss: 0.071 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 75036676
model size : 288.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 5.16690993309021
Epoch: 1, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.349 Vali Acc: 0.250 Test Loss: 1.349 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 3.291137218475342
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.240 Vali Acc: 0.575 Test Loss: 1.240 Test Acc: 0.575
Validation loss decreased (-0.249987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 3.2340290546417236
Epoch: 3, Steps: 3 | Train Loss: 1.086 Vali Loss: 0.965 Vali Acc: 0.750 Test Loss: 0.965 Test Acc: 0.750
Validation loss decreased (-0.574988 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 3.2480926513671875
Epoch: 4, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 3.2586472034454346
Epoch: 5, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.799993 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 3.237661361694336
Epoch: 6, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 3.1741204261779785
Epoch: 7, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 3.200751781463623
Epoch: 8, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 2.977757692337036
Epoch: 9, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.156 Vali Acc: 1.000 Test Loss: 0.156 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22080516
model size : 86.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 7.776393890380859
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 5.792224168777466
Epoch: 2, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.228 Vali Acc: 0.575 Test Loss: 1.228 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 6.04971170425415
Epoch: 3, Steps: 3 | Train Loss: 1.051 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
Validation loss decreased (-0.574988 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 5.410720586776733
Epoch: 4, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 5.72306489944458
Epoch: 5, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.799992 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 5.312081575393677
Epoch: 6, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 5.659642219543457
Epoch: 7, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.239 Vali Acc: 1.000 Test Loss: 0.239 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 75036676
model size : 288.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.9357359409332275
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.331 Vali Acc: 0.250 Test Loss: 1.331 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 1.92405104637146
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.233 Vali Acc: 0.550 Test Loss: 1.233 Test Acc: 0.550
Validation loss decreased (-0.249987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 2.073831558227539
Epoch: 3, Steps: 3 | Train Loss: 1.126 Vali Loss: 0.987 Vali Acc: 0.775 Test Loss: 0.987 Test Acc: 0.775
Validation loss decreased (-0.549988 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 1.9723341464996338
Epoch: 4, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 2.11468243598938
Epoch: 5, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 2.1149747371673584
Epoch: 6, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
Validation loss decreased (-0.874994 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 2.368252754211426
Epoch: 7, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.298 Vali Acc: 1.000 Test Loss: 0.298 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22080516
model size : 86.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 5.1031293869018555
Epoch: 1, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 3.662672996520996
Epoch: 2, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 3.482779026031494
Epoch: 3, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 3.4409680366516113
Epoch: 4, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.872 Vali Acc: 0.675 Test Loss: 0.872 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674991).  Saving model ...
Epoch: 5 cost time: 3.363666534423828
Epoch: 5, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.687 Vali Acc: 0.800 Test Loss: 0.687 Test Acc: 0.800
Validation loss decreased (-0.674991 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 3.241530418395996
Epoch: 6, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 3.3244283199310303
Epoch: 7, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 3.6923747062683105
Epoch: 8, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 3.537463665008545
Epoch: 9, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 3.5559515953063965
Epoch: 10, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.899996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 3.278761386871338
Epoch: 11, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7079155445098877
Epoch: 12, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6134424209594727
Epoch: 13, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5147409439086914
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2924768924713135
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.328 Vali Acc: 0.875 Test Loss: 0.328 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2462785243988037
Epoch: 16, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.371743679046631
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2615089416503906
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.594492197036743
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.5259389877319336
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 75036676
model size : 288.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.162611484527588
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.338 Vali Acc: 0.250 Test Loss: 1.338 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 1.4345946311950684
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.249987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.8308560848236084
Epoch: 3, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.056 Vali Acc: 0.575 Test Loss: 1.056 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 4 cost time: 1.6688451766967773
Epoch: 4, Steps: 3 | Train Loss: 0.898 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.5614063739776611
Epoch: 5, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 1.678189754486084
Epoch: 6, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.520 Vali Acc: 0.975 Test Loss: 0.520 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974995).  Saving model ...
Epoch: 7 cost time: 1.6576313972473145
Epoch: 7, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.391 Vali Acc: 1.000 Test Loss: 0.391 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 22080516
model size : 86.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 7.058048963546753
Epoch: 1, Steps: 3 | Train Loss: 1.535 Vali Loss: 1.406 Vali Acc: 0.325 Test Loss: 1.406 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 5.519671678543091
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
Validation loss decreased (-0.324986 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 5.259416103363037
Epoch: 3, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.042 Vali Acc: 0.800 Test Loss: 1.042 Test Acc: 0.800
Validation loss decreased (-0.549987 --> -0.799990).  Saving model ...
Epoch: 4 cost time: 5.128197908401489
Epoch: 4, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 4.318008184432983
Epoch: 5, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.596 Vali Acc: 0.875 Test Loss: 0.596 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 5.448759078979492
Epoch: 6, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.874994 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 5.505084753036499
Epoch: 7, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 5.050753116607666
Epoch: 8, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 5.125041961669922
Epoch: 9, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 5.473560333251953
Epoch: 10, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.493207693099976
Epoch: 11, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.662681341171265
Epoch: 12, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 5.473634481430054
Epoch: 13, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 5.409231185913086
Epoch: 14, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 15 cost time: 5.51861310005188
Epoch: 15, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 1.000 Test Loss: 0.129 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 37547012
model size : 145.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.1615989208221436
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.403 Vali Acc: 0.300 Test Loss: 1.403 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 2.4915120601654053
Epoch: 2, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.312 Vali Acc: 0.625 Test Loss: 1.312 Test Acc: 0.625
Validation loss decreased (-0.299986 --> -0.624987).  Saving model ...
Epoch: 3 cost time: 2.459520101547241
Epoch: 3, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.098 Vali Acc: 0.700 Test Loss: 1.098 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 2.42734694480896
Epoch: 4, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.881 Vali Acc: 0.825 Test Loss: 0.881 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 2.472914457321167
Epoch: 5, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 2.093446969985962
Epoch: 6, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.493 Vali Acc: 0.925 Test Loss: 0.493 Test Acc: 0.925
Validation loss decreased (-0.824993 --> -0.924995).  Saving model ...
Epoch: 7 cost time: 2.272456169128418
Epoch: 7, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 2.5559887886047363
Epoch: 8, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 2.3940889835357666
Epoch: 9, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 1.9839086532592773
Epoch: 10, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 2.0066826343536377
Epoch: 11, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.140 Vali Acc: 1.000 Test Loss: 0.140 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11068420
model size : 44.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 5.841876745223999
Epoch: 1, Steps: 3 | Train Loss: 1.552 Vali Loss: 1.406 Vali Acc: 0.300 Test Loss: 1.406 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 3.995328664779663
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
Validation loss decreased (-0.299986 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 3.7177770137786865
Epoch: 3, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.054 Vali Acc: 0.825 Test Loss: 1.054 Test Acc: 0.825
Validation loss decreased (-0.549987 --> -0.824989).  Saving model ...
Epoch: 4 cost time: 3.7143867015838623
Epoch: 4, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
Validation loss decreased (-0.824989 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 3.382936477661133
Epoch: 5, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 3.9305670261383057
Epoch: 6, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924995).  Saving model ...
Epoch: 7 cost time: 3.1982576847076416
Epoch: 7, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.335 Vali Acc: 1.000 Test Loss: 0.335 Test Acc: 1.000
Validation loss decreased (-0.924995 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 37547012
model size : 145.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.6781625747680664
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.425 Vali Acc: 0.300 Test Loss: 1.425 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.975494623184204
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.336 Vali Acc: 0.550 Test Loss: 1.336 Test Acc: 0.550
Validation loss decreased (-0.299986 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.9304780960083008
Epoch: 3, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 1.8377251625061035
Epoch: 4, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 2.04101824760437
Epoch: 5, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.728 Vali Acc: 0.850 Test Loss: 0.728 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849993).  Saving model ...
Epoch: 6 cost time: 1.6855430603027344
Epoch: 6, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924995).  Saving model ...
Epoch: 7 cost time: 1.799635887145996
Epoch: 7, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.8826427459716797
Epoch: 8, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 1.8578743934631348
Epoch: 9, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 1.8128986358642578
Epoch: 10, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.203 Vali Acc: 1.000 Test Loss: 0.203 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11068420
model size : 44.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.230881929397583
Epoch: 1, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.411 Vali Acc: 0.325 Test Loss: 1.411 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 2.1271286010742188
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 2.3711087703704834
Epoch: 3, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 2.229823589324951
Epoch: 4, Steps: 3 | Train Loss: 0.924 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 2.4412014484405518
Epoch: 5, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.802 Vali Acc: 0.825 Test Loss: 0.802 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 2.5097177028656006
Epoch: 6, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3467822074890137
Epoch: 7, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2584645748138428
Epoch: 8, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 2.3132381439208984
Epoch: 9, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 2.2858216762542725
Epoch: 10, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 2.18440842628479
Epoch: 11, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 2.0192949771881104
Epoch: 12, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 2.1359410285949707
Epoch: 13, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.558422565460205
Epoch: 14, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5103437900543213
Epoch: 15, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2799503803253174
Epoch: 16, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 2.5128934383392334
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.314924716949463
Epoch: 18, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.244896411895752
Epoch: 19, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1544275283813477
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1926681995391846
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 2.2763805389404297
Epoch: 22, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3746678829193115
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.216463088989258
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.062627077102661
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9912335872650146
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0037014484405518
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.3676486015319824
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.45416259765625
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.443540096282959
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37547012
model size : 145.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.184227466583252
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.454 Vali Acc: 0.250 Test Loss: 1.454 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.3947522640228271
Epoch: 2, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.366 Vali Acc: 0.450 Test Loss: 1.366 Test Acc: 0.450
Validation loss decreased (-0.249985 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.2124531269073486
Epoch: 3, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.200 Vali Acc: 0.525 Test Loss: 1.200 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 1.3966107368469238
Epoch: 4, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 1.2935960292816162
Epoch: 5, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.599990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.5049235820770264
Epoch: 6, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 1.4369385242462158
Epoch: 7, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.165614366531372
Epoch: 8, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.557448387145996
Epoch: 9, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 10 cost time: 1.483091115951538
Epoch: 10, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 1.1213054656982422
Epoch: 11, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 1.4463098049163818
Epoch: 12, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 1.3598368167877197
Epoch: 13, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 1.3725926876068115
Epoch: 14, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 1.3703687191009521
Epoch: 15, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.4140253067016602
Epoch: 16, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.4327349662780762
Epoch: 17, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.4834632873535156
Epoch: 18, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 1.4019806385040283
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 1.3641993999481201
Epoch: 20, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 1.381718635559082
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 1.529299020767212
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 1.4093103408813477
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 1.4683613777160645
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 1.3713586330413818
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 1.000 Test Loss: 0.115 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11068420
model size : 44.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 8.013067245483398
Epoch: 1, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.369 Vali Acc: 0.325 Test Loss: 1.369 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 5.84339714050293
Epoch: 2, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 5.09333348274231
Epoch: 3, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
Validation loss decreased (-0.474987 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 5.906480550765991
Epoch: 4, Steps: 3 | Train Loss: 0.950 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 6.114520311355591
Epoch: 5, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 6.135148763656616
Epoch: 6, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 6.009180068969727
Epoch: 7, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.040431499481201
Epoch: 8, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.97260594367981
Epoch: 9, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 6.19532585144043
Epoch: 10, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 5.934004306793213
Epoch: 11, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 5.8700854778289795
Epoch: 12, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 6.0124688148498535
Epoch: 13, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.487430095672607
Epoch: 14, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.869247913360596
Epoch: 15, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.011127948760986
Epoch: 16, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.789764165878296
Epoch: 17, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.866501569747925
Epoch: 18, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.535507678985596
Epoch: 19, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.249847412109375
Epoch: 20, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.253262758255005
Epoch: 21, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.925 Test Loss: 0.189 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.3360631465911865
Epoch: 22, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.171 Vali Acc: 0.925 Test Loss: 0.171 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37521412
model size : 144.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.336596488952637
Epoch: 1, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.479 Vali Acc: 0.275 Test Loss: 1.479 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 2.404224157333374
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.376 Vali Acc: 0.300 Test Loss: 1.376 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 2.150892972946167
Epoch: 3, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.165 Vali Acc: 0.575 Test Loss: 1.165 Test Acc: 0.575
Validation loss decreased (-0.299986 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.9970779418945312
Epoch: 4, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.574988 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 1.9390826225280762
Epoch: 5, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 1.8529412746429443
Epoch: 6, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.621 Vali Acc: 0.875 Test Loss: 0.621 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 2.414364814758301
Epoch: 7, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 2.3296058177948
Epoch: 8, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 2.110502004623413
Epoch: 9, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 2.230051040649414
Epoch: 10, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 2.426640033721924
Epoch: 11, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4896016120910645
Epoch: 12, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2640628814697266
Epoch: 13, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 2.0592031478881836
Epoch: 14, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 2.7962892055511475
Epoch: 15, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 2.276346206665039
Epoch: 16, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.471353530883789
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.558651924133301
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.417996406555176
Epoch: 19, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 2.4737708568573
Epoch: 20, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 2.126461982727051
Epoch: 21, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 2.6047987937927246
Epoch: 22, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.508463144302368
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.950 Test Loss: 0.120 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.32463002204895
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 2.357548952102661
Epoch: 25, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 1.000 Test Loss: 0.088 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11042308
model size : 43.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 6.298719882965088
Epoch: 1, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.368 Vali Acc: 0.250 Test Loss: 1.368 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 4.420830249786377
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.285 Vali Acc: 0.375 Test Loss: 1.285 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 4.159111976623535
Epoch: 3, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.085 Vali Acc: 0.700 Test Loss: 1.085 Test Acc: 0.700
Validation loss decreased (-0.374987 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 4.214550971984863
Epoch: 4, Steps: 3 | Train Loss: 0.995 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 4.290854215621948
Epoch: 5, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.713 Vali Acc: 0.900 Test Loss: 0.713 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 4.419204235076904
Epoch: 6, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.572 Vali Acc: 0.925 Test Loss: 0.572 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 4.041181564331055
Epoch: 7, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 3.3970823287963867
Epoch: 8, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 4.344588279724121
Epoch: 9, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 4.292241811752319
Epoch: 10, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.039865970611572
Epoch: 11, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.262296438217163
Epoch: 12, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.258970022201538
Epoch: 13, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.393 Vali Acc: 0.775 Test Loss: 0.393 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.087082147598267
Epoch: 14, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0985755920410156
Epoch: 15, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7998740673065186
Epoch: 16, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.667980670928955
Epoch: 17, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4633121490478516
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.882589101791382
Epoch: 19, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37521412
model size : 144.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.9170572757720947
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.477 Vali Acc: 0.275 Test Loss: 1.477 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.8797738552093506
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.379 Vali Acc: 0.275 Test Loss: 1.379 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.5305781364440918
Epoch: 3, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.274986 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.8793530464172363
Epoch: 4, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.047 Vali Acc: 0.575 Test Loss: 1.047 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574990).  Saving model ...
Epoch: 5 cost time: 1.7815613746643066
Epoch: 5, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.574990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.6569974422454834
Epoch: 6, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 1.8900609016418457
Epoch: 7, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.581 Vali Acc: 0.975 Test Loss: 0.581 Test Acc: 0.975
Validation loss decreased (-0.849993 --> -0.974994).  Saving model ...
Epoch: 8 cost time: 1.9485745429992676
Epoch: 8, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.474 Vali Acc: 0.975 Test Loss: 0.474 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 1.8163812160491943
Epoch: 9, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.381 Vali Acc: 1.000 Test Loss: 0.381 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11042308
model size : 43.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.585501432418823
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.381 Vali Acc: 0.225 Test Loss: 1.381 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 2.601217269897461
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.297 Vali Acc: 0.325 Test Loss: 1.297 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 2.4854495525360107
Epoch: 3, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.120 Vali Acc: 0.525 Test Loss: 1.120 Test Acc: 0.525
Validation loss decreased (-0.324987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 2.654606580734253
Epoch: 4, Steps: 3 | Train Loss: 1.070 Vali Loss: 0.962 Vali Acc: 0.575 Test Loss: 0.962 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 5 cost time: 2.506887912750244
Epoch: 5, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.574990 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 2.584162473678589
Epoch: 6, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.749992 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 2.52054762840271
Epoch: 7, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.537 Vali Acc: 0.925 Test Loss: 0.537 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 2.473442792892456
Epoch: 8, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 2.4770002365112305
Epoch: 9, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 2.5584046840667725
Epoch: 10, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 2.065999984741211
Epoch: 11, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.974607229232788
Epoch: 12, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 2.399930715560913
Epoch: 13, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5973308086395264
Epoch: 14, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 2.175964593887329
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 16 cost time: 2.5956575870513916
Epoch: 16, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 2.539728879928589
Epoch: 17, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 2.6516764163970947
Epoch: 18, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.542240619659424
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 2.4464609622955322
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.510435104370117
Epoch: 21, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3078083992004395
Epoch: 22, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.22151517868042
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.067265748977661
Epoch: 24, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 2.5573220252990723
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.432695150375366
Epoch: 26, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.580122947692871
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.3923990726470947
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4652748107910156
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.396026372909546
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37521412
model size : 144.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.175989866256714
Epoch: 1, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.487 Vali Acc: 0.300 Test Loss: 1.487 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.2054705619812012
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.3333492279052734
Epoch: 3, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2680883407592773
Epoch: 4, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.070 Vali Acc: 0.475 Test Loss: 1.070 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3186564445495605
Epoch: 5, Steps: 3 | Train Loss: 0.879 Vali Loss: 0.936 Vali Acc: 0.550 Test Loss: 0.936 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 1.2720367908477783
Epoch: 6, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.789 Vali Acc: 0.700 Test Loss: 0.789 Test Acc: 0.700
Validation loss decreased (-0.549991 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 1.3954639434814453
Epoch: 7, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.699992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 1.380598545074463
Epoch: 8, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 1.3342392444610596
Epoch: 9, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 1.1632106304168701
Epoch: 10, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 1.2122528553009033
Epoch: 11, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.068103313446045
Epoch: 12, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.09635591506958
Epoch: 13, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 1.0966460704803467
Epoch: 14, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.2008357048034668
Epoch: 15, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 1.000 Test Loss: 0.214 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11042308
model size : 43.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 5.8809895515441895
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.435 Vali Acc: 0.350 Test Loss: 1.435 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 3.818936586380005
Epoch: 2, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 3.7623136043548584
Epoch: 3, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.173 Vali Acc: 0.700 Test Loss: 1.173 Test Acc: 0.700
Validation loss decreased (-0.374987 --> -0.699988).  Saving model ...
Epoch: 4 cost time: 3.046811819076538
Epoch: 4, Steps: 3 | Train Loss: 0.984 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 3.0261459350585938
Epoch: 5, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.796 Vali Acc: 0.775 Test Loss: 0.796 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 3.423013210296631
Epoch: 6, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 3.6445648670196533
Epoch: 7, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 3.4669198989868164
Epoch: 8, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 3.7911529541015625
Epoch: 9, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.352 Vali Acc: 0.975 Test Loss: 0.352 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 4.097687244415283
Epoch: 10, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 4.085625886917114
Epoch: 11, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.277 Vali Acc: 1.000 Test Loss: 0.277 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18775044
model size : 72.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.539074182510376
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.456 Vali Acc: 0.200 Test Loss: 1.456 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 2.073906421661377
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.388 Vali Acc: 0.325 Test Loss: 1.388 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.9136860370635986
Epoch: 3, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.254 Vali Acc: 0.675 Test Loss: 1.254 Test Acc: 0.675
Validation loss decreased (-0.324986 --> -0.674987).  Saving model ...
Epoch: 4 cost time: 2.072122097015381
Epoch: 4, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.095 Vali Acc: 0.750 Test Loss: 1.095 Test Acc: 0.750
Validation loss decreased (-0.674987 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 2.0745038986206055
Epoch: 5, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.9714207649230957
Epoch: 6, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 2.0459530353546143
Epoch: 7, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 1.9248764514923096
Epoch: 8, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 2.0418872833251953
Epoch: 9, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 2.071134567260742
Epoch: 10, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.347 Vali Acc: 1.000 Test Loss: 0.347 Test Acc: 1.000
Validation loss decreased (-0.924996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5535236
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.594983816146851
Epoch: 1, Steps: 3 | Train Loss: 1.515 Vali Loss: 1.434 Vali Acc: 0.325 Test Loss: 1.434 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 2.732238292694092
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 2.9503333568573
Epoch: 3, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.209 Vali Acc: 0.625 Test Loss: 1.209 Test Acc: 0.625
Validation loss decreased (-0.349986 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 3.0506162643432617
Epoch: 4, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.041 Vali Acc: 0.725 Test Loss: 1.041 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 2.9792027473449707
Epoch: 5, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.862 Vali Acc: 0.775 Test Loss: 0.862 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 2.6551897525787354
Epoch: 6, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.712 Vali Acc: 0.900 Test Loss: 0.712 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 2.858633518218994
Epoch: 7, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.590 Vali Acc: 0.925 Test Loss: 0.590 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 2.9298250675201416
Epoch: 8, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 2.5447652339935303
Epoch: 9, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 2.6659975051879883
Epoch: 10, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 3.12499737739563
Epoch: 11, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 3.341799736022949
Epoch: 12, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 3.4014503955841064
Epoch: 13, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 3.420017719268799
Epoch: 14, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 3.2270588874816895
Epoch: 15, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.26168155670166
Epoch: 16, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.222686529159546
Epoch: 17, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2165307998657227
Epoch: 18, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 3.2285115718841553
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 3.3454012870788574
Epoch: 20, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 3.080733060836792
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.312187671661377
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2387521266937256
Epoch: 23, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 2.6498303413391113
Epoch: 24, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 2.757385730743408
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 1.000 Test Loss: 0.127 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18775044
model size : 72.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.852163076400757
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.427 Vali Acc: 0.200 Test Loss: 1.427 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.6252398490905762
Epoch: 2, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.362 Vali Acc: 0.350 Test Loss: 1.362 Test Acc: 0.350
Validation loss decreased (-0.199986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.5562074184417725
Epoch: 3, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.236 Vali Acc: 0.650 Test Loss: 1.236 Test Acc: 0.650
Validation loss decreased (-0.349986 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 1.7143611907958984
Epoch: 4, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 1.6936376094818115
Epoch: 5, Steps: 3 | Train Loss: 0.932 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.6565487384796143
Epoch: 6, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.807 Vali Acc: 0.850 Test Loss: 0.807 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 1.5922191143035889
Epoch: 7, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 1.4140372276306152
Epoch: 8, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.569 Vali Acc: 0.925 Test Loss: 0.569 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 1.444901466369629
Epoch: 9, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4470136165618896
Epoch: 10, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 1.3813660144805908
Epoch: 11, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.7122316360473633
Epoch: 12, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.298 Vali Acc: 1.000 Test Loss: 0.298 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5535236
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8751611709594727
Epoch: 1, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.435 Vali Acc: 0.275 Test Loss: 1.435 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 2.000457525253296
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.357 Vali Acc: 0.475 Test Loss: 1.357 Test Acc: 0.475
Validation loss decreased (-0.274986 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 1.9655272960662842
Epoch: 3, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.242 Vali Acc: 0.425 Test Loss: 1.242 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0241754055023193
Epoch: 4, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.149 Vali Acc: 0.450 Test Loss: 1.149 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9582173824310303
Epoch: 5, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.016 Vali Acc: 0.550 Test Loss: 1.016 Test Acc: 0.550
Validation loss decreased (-0.474986 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 1.8710999488830566
Epoch: 6, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
Validation loss decreased (-0.549990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.9365544319152832
Epoch: 7, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.740 Vali Acc: 0.925 Test Loss: 0.740 Test Acc: 0.925
Validation loss decreased (-0.749991 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 2.038910388946533
Epoch: 8, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.623 Vali Acc: 0.900 Test Loss: 0.623 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.81856369972229
Epoch: 9, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6559972763061523
Epoch: 10, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7300269603729248
Epoch: 11, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.504 Vali Acc: 0.825 Test Loss: 0.504 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6703321933746338
Epoch: 12, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.469 Vali Acc: 0.825 Test Loss: 0.469 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9300105571746826
Epoch: 13, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.448 Vali Acc: 0.825 Test Loss: 0.448 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0234622955322266
Epoch: 14, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.421 Vali Acc: 0.875 Test Loss: 0.421 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0582966804504395
Epoch: 15, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9666740894317627
Epoch: 16, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 2.0232529640197754
Epoch: 17, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 1.798518419265747
Epoch: 18, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 1.5187113285064697
Epoch: 19, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6983048915863037
Epoch: 20, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.660921335220337
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6455464363098145
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.8557188510894775
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 1.9742562770843506
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 1.9019114971160889
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9297010898590088
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0799708366394043
Epoch: 27, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 2.0935826301574707
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 2.042403221130371
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.871744155883789
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 18775044
model size : 72.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.947002410888672
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.399 Vali Acc: 0.300 Test Loss: 1.399 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2795698642730713
Epoch: 2, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.331 Vali Acc: 0.500 Test Loss: 1.331 Test Acc: 0.500
Validation loss decreased (-0.299986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.1009554862976074
Epoch: 3, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.8784070014953613
Epoch: 4, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.9430091381072998
Epoch: 5, Steps: 3 | Train Loss: 0.903 Vali Loss: 0.954 Vali Acc: 0.675 Test Loss: 0.954 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.9572598934173584
Epoch: 6, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.842 Vali Acc: 0.825 Test Loss: 0.842 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824992).  Saving model ...
Epoch: 7 cost time: 0.9291653633117676
Epoch: 7, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 0.9257640838623047
Epoch: 8, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.0972857475280762
Epoch: 9, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.1432361602783203
Epoch: 10, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.507 Vali Acc: 0.925 Test Loss: 0.507 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.1678504943847656
Epoch: 11, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.2041237354278564
Epoch: 12, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 1.135544776916504
Epoch: 13, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 1.0877392292022705
Epoch: 14, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.8961505889892578
Epoch: 15, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 1.0672087669372559
Epoch: 16, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.217 Vali Acc: 1.000 Test Loss: 0.217 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5535236
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.2417731285095215
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 2.5152029991149902
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 2.8659675121307373
Epoch: 3, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.229 Vali Acc: 0.625 Test Loss: 1.229 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 3.1748223304748535
Epoch: 4, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.114 Vali Acc: 0.750 Test Loss: 1.114 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 3.0296573638916016
Epoch: 5, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.986 Vali Acc: 0.825 Test Loss: 0.986 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 2.925245523452759
Epoch: 6, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.847 Vali Acc: 0.875 Test Loss: 0.847 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 3.20151948928833
Epoch: 7, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 2.9602816104888916
Epoch: 8, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.584 Vali Acc: 0.925 Test Loss: 0.584 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 3.121403217315674
Epoch: 9, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.146854877471924
Epoch: 10, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.577877998352051
Epoch: 11, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7094156742095947
Epoch: 12, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.272355318069458
Epoch: 13, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 3.0653984546661377
Epoch: 14, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 3.03066349029541
Epoch: 15, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 2.9904415607452393
Epoch: 16, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 2.399332284927368
Epoch: 17, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.286832809448242
Epoch: 18, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8873960971832275
Epoch: 19, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.694720506668091
Epoch: 20, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 2.93485689163208
Epoch: 21, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.0890185832977295
Epoch: 22, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 3.0236752033233643
Epoch: 23, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.113 Vali Acc: 1.000 Test Loss: 0.113 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 9401860
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4294538497924805
Epoch: 1, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.5247876644134521
Epoch: 2, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.297 Vali Acc: 0.425 Test Loss: 1.297 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.4278860092163086
Epoch: 3, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.212 Vali Acc: 0.675 Test Loss: 1.212 Test Acc: 0.675
Validation loss decreased (-0.424987 --> -0.674988).  Saving model ...
Epoch: 4 cost time: 1.4771363735198975
Epoch: 4, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.5802781581878662
Epoch: 5, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.7087700366973877
Epoch: 6, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.863 Vali Acc: 0.725 Test Loss: 0.863 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.7416508197784424
Epoch: 7, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.741 Vali Acc: 0.800 Test Loss: 0.741 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 1.6245741844177246
Epoch: 8, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.5820789337158203
Epoch: 9, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
Validation loss decreased (-0.824994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 1.2637038230895996
Epoch: 10, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 1.6319420337677002
Epoch: 11, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 1.692115068435669
Epoch: 12, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 1.6346776485443115
Epoch: 13, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 1.6589634418487549
Epoch: 14, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.255 Vali Acc: 1.000 Test Loss: 0.255 Test Acc: 1.000
Validation loss decreased (-0.924997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2781700
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.995007038116455
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.351 Vali Acc: 0.350 Test Loss: 1.351 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 2.410501003265381
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.313 Vali Acc: 0.425 Test Loss: 1.313 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 2.4089772701263428
Epoch: 3, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.234 Vali Acc: 0.575 Test Loss: 1.234 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 2.495535135269165
Epoch: 4, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 2.451737403869629
Epoch: 5, Steps: 3 | Train Loss: 0.922 Vali Loss: 0.998 Vali Acc: 0.825 Test Loss: 0.998 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 2.359811305999756
Epoch: 6, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.857 Vali Acc: 0.850 Test Loss: 0.857 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 7 cost time: 2.21868896484375
Epoch: 7, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.723 Vali Acc: 0.925 Test Loss: 0.723 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 2.089247941970825
Epoch: 8, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.603 Vali Acc: 0.950 Test Loss: 0.603 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 2.25673770904541
Epoch: 9, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.504 Vali Acc: 0.975 Test Loss: 0.504 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 2.313305616378784
Epoch: 10, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.423 Vali Acc: 0.975 Test Loss: 0.423 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 2.43690824508667
Epoch: 11, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 2.454434394836426
Epoch: 12, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 2.3282358646392822
Epoch: 13, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 2.4958603382110596
Epoch: 14, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 2.534193754196167
Epoch: 15, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 2.5120811462402344
Epoch: 16, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 2.5460948944091797
Epoch: 17, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 2.3242483139038086
Epoch: 18, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0892817974090576
Epoch: 19, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.186980962753296
Epoch: 20, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.136302947998047
Epoch: 21, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2418839931488037
Epoch: 22, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 2.1514456272125244
Epoch: 23, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 1.8702476024627686
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.590238571166992
Epoch: 25, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4452338218688965
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 2.6155788898468018
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 2.1362662315368652
Epoch: 28, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 2.10526442527771
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0680224895477295
Epoch: 30, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 9401860
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3445990085601807
Epoch: 1, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.436678171157837
Epoch: 2, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.303 Vali Acc: 0.375 Test Loss: 1.303 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.380737066268921
Epoch: 3, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
Validation loss decreased (-0.374987 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 1.244598388671875
Epoch: 4, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.121 Vali Acc: 0.650 Test Loss: 1.121 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.6116347312927246
Epoch: 5, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.3348400592803955
Epoch: 6, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.2649304866790771
Epoch: 7, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 1.0648996829986572
Epoch: 8, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.692 Vali Acc: 0.875 Test Loss: 0.692 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.2177090644836426
Epoch: 9, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.609 Vali Acc: 0.900 Test Loss: 0.609 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.375321865081787
Epoch: 10, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.519 Vali Acc: 0.975 Test Loss: 0.519 Test Acc: 0.975
Validation loss decreased (-0.899994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 1.2989070415496826
Epoch: 11, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 1.408019781112671
Epoch: 12, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 1.4497268199920654
Epoch: 13, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.323 Vali Acc: 1.000 Test Loss: 0.323 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2781700
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.901359796524048
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.2852356433868408
Epoch: 2, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.326 Vali Acc: 0.375 Test Loss: 1.326 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.5506572723388672
Epoch: 3, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.6143381595611572
Epoch: 4, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.151 Vali Acc: 0.525 Test Loss: 1.151 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.5593998432159424
Epoch: 5, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
Validation loss decreased (-0.524988 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.4728682041168213
Epoch: 6, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.7545039653778076
Epoch: 7, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.6859445571899414
Epoch: 8, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.4579379558563232
Epoch: 9, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.569 Vali Acc: 0.925 Test Loss: 0.569 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.4918403625488281
Epoch: 10, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.4156036376953125
Epoch: 11, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.4248886108398438
Epoch: 12, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 1.3455641269683838
Epoch: 13, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5514910221099854
Epoch: 14, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 1.5640861988067627
Epoch: 15, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5769703388214111
Epoch: 16, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 1.5153543949127197
Epoch: 17, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.755720853805542
Epoch: 18, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 1.731816053390503
Epoch: 19, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 1.5469164848327637
Epoch: 20, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6884064674377441
Epoch: 21, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6551196575164795
Epoch: 22, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6788272857666016
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.742049217224121
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5093317031860352
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 1.480217695236206
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 1.4498052597045898
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 1.3216381072998047
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 1.244079351425171
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 1.4382331371307373
Epoch: 30, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 9401860
model size : 37.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.785081148147583
Epoch: 1, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.9093165397644043
Epoch: 2, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9866471290588379
Epoch: 3, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.1392865180969238
Epoch: 4, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.9703011512756348
Epoch: 5, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.032 Vali Acc: 0.625 Test Loss: 1.032 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.7869341373443604
Epoch: 6, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.624990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.9671375751495361
Epoch: 7, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.9513204097747803
Epoch: 8, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.1491527557373047
Epoch: 9, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 1.2027528285980225
Epoch: 10, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.1139886379241943
Epoch: 11, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 1.1013402938842773
Epoch: 12, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.1605157852172852
Epoch: 13, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 1.1545460224151611
Epoch: 14, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 1.0663244724273682
Epoch: 15, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 1.085064172744751
Epoch: 16, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.9586267471313477
Epoch: 17, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.315122127532959
Epoch: 18, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.036832332611084
Epoch: 19, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1058061122894287
Epoch: 20, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.0786190032958984
Epoch: 21, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.1510567665100098
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.0959718227386475
Epoch: 23, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 1.2306387424468994
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 1.1994688510894775
Epoch: 25, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 1.0005722045898438
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 1.1038024425506592
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 1.0108823776245117
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 1.1496121883392334
Epoch: 29, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 1.0577914714813232
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2781700
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.419259309768677
Epoch: 1, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.273 Vali Acc: 0.425 Test Loss: 1.273 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 2.264618396759033
Epoch: 2, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.246 Vali Acc: 0.475 Test Loss: 1.246 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 2.257930278778076
Epoch: 3, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.183 Vali Acc: 0.575 Test Loss: 1.183 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 2.3552045822143555
Epoch: 4, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 2.1817822456359863
Epoch: 5, Steps: 3 | Train Loss: 1.022 Vali Loss: 0.993 Vali Acc: 0.775 Test Loss: 0.993 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 2.207812786102295
Epoch: 6, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 2.35622501373291
Epoch: 7, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 2.517646312713623
Epoch: 8, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.738 Vali Acc: 0.850 Test Loss: 0.738 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 2.3872904777526855
Epoch: 9, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 2.3464574813842773
Epoch: 10, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 2.5104899406433105
Epoch: 11, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 2.4512534141540527
Epoch: 12, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.430 Vali Acc: 0.975 Test Loss: 0.430 Test Acc: 0.975
Validation loss decreased (-0.899995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 2.6089680194854736
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 2.6236517429351807
Epoch: 14, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.387 Vali Acc: 0.875 Test Loss: 0.387 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4329259395599365
Epoch: 15, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2951769828796387
Epoch: 16, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2860968112945557
Epoch: 17, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.310296058654785
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4556825160980225
Epoch: 19, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 2.608546257019043
Epoch: 20, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 2.5543320178985596
Epoch: 21, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 2.46173357963562
Epoch: 22, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 2.200702667236328
Epoch: 23, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.182 Vali Acc: 1.000 Test Loss: 0.182 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 9389060
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3265583515167236
Epoch: 1, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.255 Vali Acc: 0.450 Test Loss: 1.255 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.4791085720062256
Epoch: 2, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.3673136234283447
Epoch: 3, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.4877557754516602
Epoch: 4, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.5072460174560547
Epoch: 5, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.007 Vali Acc: 0.650 Test Loss: 1.007 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 1.3898751735687256
Epoch: 6, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.5549142360687256
Epoch: 7, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 1.4289681911468506
Epoch: 8, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.723 Vali Acc: 0.825 Test Loss: 0.723 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 1.4622890949249268
Epoch: 9, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.3545644283294678
Epoch: 10, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 11 cost time: 1.2101950645446777
Epoch: 11, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 1.3530042171478271
Epoch: 12, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.321244239807129
Epoch: 13, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 1.3427655696868896
Epoch: 14, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.4162497520446777
Epoch: 15, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.273 Vali Acc: 1.000 Test Loss: 0.273 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2768644
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.66819167137146
Epoch: 1, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.6657042503356934
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6733837127685547
Epoch: 3, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.5255560874938965
Epoch: 4, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.8009464740753174
Epoch: 5, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.047 Vali Acc: 0.725 Test Loss: 1.047 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 1.952197551727295
Epoch: 6, Steps: 3 | Train Loss: 0.970 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 1.8761346340179443
Epoch: 7, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 1.7221477031707764
Epoch: 8, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 1.6766576766967773
Epoch: 9, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.695 Vali Acc: 0.825 Test Loss: 0.695 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 1.825843334197998
Epoch: 10, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.9517643451690674
Epoch: 11, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.535 Vali Acc: 0.925 Test Loss: 0.535 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.7284555435180664
Epoch: 12, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5842711925506592
Epoch: 13, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.5473592281341553
Epoch: 14, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 1.4684147834777832
Epoch: 15, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 1.5605366230010986
Epoch: 16, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 1.579056978225708
Epoch: 17, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6525695323944092
Epoch: 18, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 1.7611956596374512
Epoch: 19, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.72344970703125
Epoch: 20, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.672910213470459
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5855956077575684
Epoch: 22, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.363548994064331
Epoch: 23, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.506150245666504
Epoch: 24, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 1.5754334926605225
Epoch: 25, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 1.6629819869995117
Epoch: 26, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 1.000 Test Loss: 0.150 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 9389060
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.218073606491089
Epoch: 1, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.9901161193847656
Epoch: 2, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.251 Vali Acc: 0.525 Test Loss: 1.251 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 1.1220788955688477
Epoch: 3, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 1.152728796005249
Epoch: 4, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.141 Vali Acc: 0.550 Test Loss: 1.141 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 0.9908597469329834
Epoch: 5, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.0370850563049316
Epoch: 6, Steps: 3 | Train Loss: 0.888 Vali Loss: 0.991 Vali Acc: 0.650 Test Loss: 0.991 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 1.1398875713348389
Epoch: 7, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 1.0485937595367432
Epoch: 8, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.9865262508392334
Epoch: 9, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 1.0180165767669678
Epoch: 10, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 11 cost time: 1.1030378341674805
Epoch: 11, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 1.1497726440429688
Epoch: 12, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 1.0250706672668457
Epoch: 13, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.410 Vali Acc: 0.975 Test Loss: 0.410 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 1.190464735031128
Epoch: 14, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.358 Vali Acc: 1.000 Test Loss: 0.358 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2768644
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.013624906539917
Epoch: 1, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.263 Vali Acc: 0.425 Test Loss: 1.263 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.2395753860473633
Epoch: 2, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2095985412597656
Epoch: 3, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.165 Vali Acc: 0.525 Test Loss: 1.165 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 1.2363011837005615
Epoch: 4, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.381917953491211
Epoch: 5, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 1.3456287384033203
Epoch: 6, Steps: 3 | Train Loss: 1.014 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.3546407222747803
Epoch: 7, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 1.248274326324463
Epoch: 8, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 1.1110937595367432
Epoch: 9, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 1.2889647483825684
Epoch: 10, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 11 cost time: 1.306706190109253
Epoch: 11, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.590 Vali Acc: 0.875 Test Loss: 0.590 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 1.2111821174621582
Epoch: 12, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 13 cost time: 1.173828363418579
Epoch: 13, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 1.1717956066131592
Epoch: 14, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.874995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 1.2278733253479004
Epoch: 15, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 1.2180540561676025
Epoch: 16, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.156052827835083
Epoch: 17, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1402380466461182
Epoch: 18, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 1.2610862255096436
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.0649292469024658
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.256950855255127
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1876215934753418
Epoch: 22, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 1.2137749195098877
Epoch: 23, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 1.2325561046600342
Epoch: 24, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3289101123809814
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.925 Test Loss: 0.234 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.128737449645996
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 1.2886548042297363
Epoch: 27, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1905574798583984
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2102038860321045
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.229828119277954
Epoch: 30, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.126 Vali Acc: 1.000 Test Loss: 0.126 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 9389060
model size : 36.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0164129734039307
Epoch: 1, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.296 Vali Acc: 0.425 Test Loss: 1.296 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.0281095504760742
Epoch: 2, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.266 Vali Acc: 0.425 Test Loss: 1.266 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.9358527660369873
Epoch: 3, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 1.0351884365081787
Epoch: 4, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.0515217781066895
Epoch: 5, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.129 Vali Acc: 0.525 Test Loss: 1.129 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 1.0779414176940918
Epoch: 6, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.065 Vali Acc: 0.575 Test Loss: 1.065 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.9579951763153076
Epoch: 7, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.9300942420959473
Epoch: 8, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.893 Vali Acc: 0.700 Test Loss: 0.893 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 9 cost time: 0.8709204196929932
Epoch: 9, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.84311842918396
Epoch: 10, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.7439248561859131
Epoch: 11, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.654 Vali Acc: 0.925 Test Loss: 0.654 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.8562066555023193
Epoch: 12, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.588 Vali Acc: 0.925 Test Loss: 0.588 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.9509823322296143
Epoch: 13, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.536 Vali Acc: 0.925 Test Loss: 0.536 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.9739573001861572
Epoch: 14, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.8224408626556396
Epoch: 15, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.875563383102417
Epoch: 16, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.8544645309448242
Epoch: 17, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.7665445804595947
Epoch: 18, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.8564243316650391
Epoch: 19, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8249392509460449
Epoch: 20, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.9187698364257812
Epoch: 21, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.9121377468109131
Epoch: 22, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 1.000 Test Loss: 0.217 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2768644
model size : 11.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.036104679107666
Epoch: 1, Steps: 3 | Train Loss: 1.619 Vali Loss: 1.478 Vali Acc: 0.225 Test Loss: 1.478 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 2.0211124420166016
Epoch: 2, Steps: 3 | Train Loss: 1.574 Vali Loss: 1.437 Vali Acc: 0.250 Test Loss: 1.437 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 2.14497709274292
Epoch: 3, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 2.202989339828491
Epoch: 4, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.951402187347412
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.201 Vali Acc: 0.625 Test Loss: 1.201 Test Acc: 0.625
Validation loss decreased (-0.374987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 1.9766099452972412
Epoch: 6, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.111 Vali Acc: 0.675 Test Loss: 1.111 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.8442888259887695
Epoch: 7, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 1.691899061203003
Epoch: 8, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 2.062088966369629
Epoch: 9, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.6689081192016602
Epoch: 10, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.702 Vali Acc: 0.925 Test Loss: 0.702 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 1.6868560314178467
Epoch: 11, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.603 Vali Acc: 0.950 Test Loss: 0.603 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 1.856072187423706
Epoch: 12, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.515 Vali Acc: 0.975 Test Loss: 0.515 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 13 cost time: 1.939021110534668
Epoch: 13, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.448 Vali Acc: 0.975 Test Loss: 0.448 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 1.9130759239196777
Epoch: 14, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.385 Vali Acc: 0.975 Test Loss: 0.385 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 1.8879499435424805
Epoch: 15, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.339 Vali Acc: 1.000 Test Loss: 0.339 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4701700
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3394198417663574
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.458 Vali Acc: 0.250 Test Loss: 1.458 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.3009095191955566
Epoch: 2, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.431 Vali Acc: 0.275 Test Loss: 1.431 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.2849249839782715
Epoch: 3, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.386 Vali Acc: 0.300 Test Loss: 1.386 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.4296774864196777
Epoch: 4, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.322 Vali Acc: 0.350 Test Loss: 1.322 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.2737340927124023
Epoch: 5, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.4921848773956299
Epoch: 6, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.175 Vali Acc: 0.600 Test Loss: 1.175 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.3115079402923584
Epoch: 7, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.091 Vali Acc: 0.700 Test Loss: 1.091 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.3318758010864258
Epoch: 8, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.008 Vali Acc: 0.775 Test Loss: 1.008 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.2066574096679688
Epoch: 9, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.920 Vali Acc: 0.825 Test Loss: 0.920 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 1.1347291469573975
Epoch: 10, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.826 Vali Acc: 0.850 Test Loss: 0.826 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.9734342098236084
Epoch: 11, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 1.163682460784912
Epoch: 12, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.2039299011230469
Epoch: 13, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.561 Vali Acc: 0.975 Test Loss: 0.561 Test Acc: 0.975
Validation loss decreased (-0.899994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 1.2212588787078857
Epoch: 14, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.485 Vali Acc: 1.000 Test Loss: 0.485 Test Acc: 1.000
Validation loss decreased (-0.974994 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1391364
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.326702833175659
Epoch: 1, Steps: 3 | Train Loss: 1.605 Vali Loss: 1.490 Vali Acc: 0.250 Test Loss: 1.490 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.4514989852905273
Epoch: 2, Steps: 3 | Train Loss: 1.593 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.3861992359161377
Epoch: 3, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.5077836513519287
Epoch: 4, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.304 Vali Acc: 0.450 Test Loss: 1.304 Test Acc: 0.450
Validation loss decreased (-0.299986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.5061261653900146
Epoch: 5, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.214 Vali Acc: 0.625 Test Loss: 1.214 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 1.5638883113861084
Epoch: 6, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.3233914375305176
Epoch: 7, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 1.5740466117858887
Epoch: 8, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.5229077339172363
Epoch: 9, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.890 Vali Acc: 0.800 Test Loss: 0.890 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 1.5462872982025146
Epoch: 10, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.784 Vali Acc: 0.875 Test Loss: 0.784 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 1.6292741298675537
Epoch: 11, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.681 Vali Acc: 0.950 Test Loss: 0.681 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 1.1215343475341797
Epoch: 12, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.596 Vali Acc: 0.975 Test Loss: 0.596 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 1.5043182373046875
Epoch: 13, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.517 Vali Acc: 0.975 Test Loss: 0.517 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 1.446702241897583
Epoch: 14, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.445 Vali Acc: 1.000 Test Loss: 0.445 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4701700
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1303465366363525
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.467 Vali Acc: 0.250 Test Loss: 1.467 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.039423942565918
Epoch: 2, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.442 Vali Acc: 0.250 Test Loss: 1.442 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1086676120758057
Epoch: 3, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.399 Vali Acc: 0.275 Test Loss: 1.399 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.1081428527832031
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.337 Vali Acc: 0.275 Test Loss: 1.337 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 1.0132381916046143
Epoch: 5, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.268 Vali Acc: 0.525 Test Loss: 1.268 Test Acc: 0.525
Validation loss decreased (-0.274987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 1.063783884048462
Epoch: 6, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.1065382957458496
Epoch: 7, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.9532368183135986
Epoch: 8, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.087268590927124
Epoch: 9, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.943 Vali Acc: 0.775 Test Loss: 0.943 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.9520125389099121
Epoch: 10, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 1.1370820999145508
Epoch: 11, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.774 Vali Acc: 0.850 Test Loss: 0.774 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 1.0408058166503906
Epoch: 12, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.691 Vali Acc: 0.875 Test Loss: 0.691 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.9976434707641602
Epoch: 13, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.607 Vali Acc: 0.925 Test Loss: 0.607 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 1.0100631713867188
Epoch: 14, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.9696614742279053
Epoch: 15, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.467 Vali Acc: 0.975 Test Loss: 0.467 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 1.000925064086914
Epoch: 16, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.416 Vali Acc: 1.000 Test Loss: 0.416 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1391364
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0501413345336914
Epoch: 1, Steps: 3 | Train Loss: 1.608 Vali Loss: 1.532 Vali Acc: 0.275 Test Loss: 1.532 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.1296005249023438
Epoch: 2, Steps: 3 | Train Loss: 1.589 Vali Loss: 1.491 Vali Acc: 0.300 Test Loss: 1.491 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.140044927597046
Epoch: 3, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.421 Vali Acc: 0.300 Test Loss: 1.421 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.2008163928985596
Epoch: 4, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.336 Vali Acc: 0.350 Test Loss: 1.336 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.1876955032348633
Epoch: 5, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0426356792449951
Epoch: 6, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.170 Vali Acc: 0.425 Test Loss: 1.170 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0963160991668701
Epoch: 7, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.1490223407745361
Epoch: 8, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.023 Vali Acc: 0.575 Test Loss: 1.023 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574990).  Saving model ...
Epoch: 9 cost time: 1.067018747329712
Epoch: 9, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.937 Vali Acc: 0.775 Test Loss: 0.937 Test Acc: 0.775
Validation loss decreased (-0.574990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 1.1037530899047852
Epoch: 10, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.850 Vali Acc: 0.850 Test Loss: 0.850 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.0933268070220947
Epoch: 11, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.762 Vali Acc: 0.900 Test Loss: 0.762 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 1.098116397857666
Epoch: 12, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.0557727813720703
Epoch: 13, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1003642082214355
Epoch: 14, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 1.0497357845306396
Epoch: 15, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.9186058044433594
Epoch: 16, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 1.0980291366577148
Epoch: 17, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 1.1442859172821045
Epoch: 18, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1525349617004395
Epoch: 19, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.351 Vali Acc: 0.975 Test Loss: 0.351 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 1.0090179443359375
Epoch: 20, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0361862182617188
Epoch: 21, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.374 Vali Acc: 0.875 Test Loss: 0.374 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1139717102050781
Epoch: 22, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 1.0127151012420654
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 1.053513765335083
Epoch: 24, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0387706756591797
Epoch: 25, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 1.1309924125671387
Epoch: 26, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 1.146714687347412
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 1.000 Test Loss: 0.147 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4701700
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.787627935409546
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.8403811454772949
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.0689239501953125
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.9210712909698486
Epoch: 4, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.343 Vali Acc: 0.325 Test Loss: 1.343 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.8561482429504395
Epoch: 5, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.290 Vali Acc: 0.475 Test Loss: 1.290 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.8428568840026855
Epoch: 6, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.229 Vali Acc: 0.550 Test Loss: 1.229 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.923328161239624
Epoch: 7, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.9285783767700195
Epoch: 8, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.083 Vali Acc: 0.725 Test Loss: 1.083 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.8858678340911865
Epoch: 9, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.8218047618865967
Epoch: 10, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.966956615447998
Epoch: 11, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9428462982177734
Epoch: 12, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.0077056884765625
Epoch: 13, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.9125418663024902
Epoch: 14, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.8624866008758545
Epoch: 15, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.0152084827423096
Epoch: 16, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.9360361099243164
Epoch: 17, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.9619600772857666
Epoch: 18, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.9349756240844727
Epoch: 19, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.9897794723510742
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.883354663848877
Epoch: 21, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.8213262557983398
Epoch: 22, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.8812496662139893
Epoch: 23, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.8758466243743896
Epoch: 24, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.9317100048065186
Epoch: 25, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.8710381984710693
Epoch: 26, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.9508144855499268
Epoch: 27, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.9952752590179443
Epoch: 28, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.193 Vali Acc: 1.000 Test Loss: 0.193 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1391364
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4401674270629883
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.440 Vali Acc: 0.225 Test Loss: 1.440 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.7334814071655273
Epoch: 2, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.615469217300415
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.4660804271697998
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.280 Vali Acc: 0.525 Test Loss: 1.280 Test Acc: 0.525
Validation loss decreased (-0.349986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 1.6052563190460205
Epoch: 5, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.200 Vali Acc: 0.600 Test Loss: 1.200 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.5351388454437256
Epoch: 6, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.5889811515808105
Epoch: 7, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 1.6408450603485107
Epoch: 8, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.4379072189331055
Epoch: 9, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.843 Vali Acc: 0.850 Test Loss: 0.843 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.6388318538665771
Epoch: 10, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.6885573863983154
Epoch: 11, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.6334891319274902
Epoch: 12, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.5863194465637207
Epoch: 13, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 1.6203632354736328
Epoch: 14, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 1.6742796897888184
Epoch: 15, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 1.5457220077514648
Epoch: 16, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 1.38004732131958
Epoch: 17, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 1.224057674407959
Epoch: 18, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.5729188919067383
Epoch: 19, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 1.8166630268096924
Epoch: 20, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 1.584216594696045
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 1.8203909397125244
Epoch: 22, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.188 Vali Acc: 1.000 Test Loss: 0.188 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2358020
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.17026424407959
Epoch: 1, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.396 Vali Acc: 0.425 Test Loss: 1.396 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 1.2358098030090332
Epoch: 2, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.368 Vali Acc: 0.450 Test Loss: 1.368 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.0937373638153076
Epoch: 3, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.322 Vali Acc: 0.475 Test Loss: 1.322 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.1989502906799316
Epoch: 4, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 1.2194011211395264
Epoch: 5, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.2514331340789795
Epoch: 6, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.1570255756378174
Epoch: 7, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.041 Vali Acc: 0.775 Test Loss: 1.041 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.169677495956421
Epoch: 8, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.952 Vali Acc: 0.800 Test Loss: 0.952 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 1.253624439239502
Epoch: 9, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.865 Vali Acc: 0.875 Test Loss: 0.865 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 1.109325647354126
Epoch: 10, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.785 Vali Acc: 0.900 Test Loss: 0.785 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 1.2318720817565918
Epoch: 11, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.701 Vali Acc: 0.900 Test Loss: 0.701 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 1.105741262435913
Epoch: 12, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.626 Vali Acc: 0.925 Test Loss: 0.626 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.9046573638916016
Epoch: 13, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 1.2298967838287354
Epoch: 14, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.495 Vali Acc: 0.975 Test Loss: 0.495 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 1.1925060749053955
Epoch: 15, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.435 Vali Acc: 0.975 Test Loss: 0.435 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 1.154991626739502
Epoch: 16, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 1.1405351161956787
Epoch: 17, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 1.1688549518585205
Epoch: 18, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.1158568859100342
Epoch: 19, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 1.2030539512634277
Epoch: 20, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 1.2733080387115479
Epoch: 21, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 1.302659273147583
Epoch: 22, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 1.2607388496398926
Epoch: 23, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.182 Vali Acc: 1.000 Test Loss: 0.182 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 702724
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.986992359161377
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.460 Vali Acc: 0.225 Test Loss: 1.460 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 1.133777379989624
Epoch: 2, Steps: 3 | Train Loss: 1.498 Vali Loss: 1.428 Vali Acc: 0.300 Test Loss: 1.428 Test Acc: 0.300
Validation loss decreased (-0.224985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.3273577690124512
Epoch: 3, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.3039848804473877
Epoch: 4, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.2187414169311523
Epoch: 5, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.2637696266174316
Epoch: 6, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.970712423324585
Epoch: 7, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.1952714920043945
Epoch: 8, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.990 Vali Acc: 0.775 Test Loss: 0.990 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.2046828269958496
Epoch: 9, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.896 Vali Acc: 0.800 Test Loss: 0.896 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 1.2146682739257812
Epoch: 10, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.805 Vali Acc: 0.850 Test Loss: 0.805 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.197361946105957
Epoch: 11, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.1312921047210693
Epoch: 12, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 1.3726649284362793
Epoch: 13, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 1.247544288635254
Epoch: 14, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.2065117359161377
Epoch: 15, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 1.3767147064208984
Epoch: 16, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 1.4326655864715576
Epoch: 17, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 1.41868257522583
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.263753890991211
Epoch: 19, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 1.242051601409912
Epoch: 20, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 1.3467516899108887
Epoch: 21, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 1.2791109085083008
Epoch: 22, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 1.325624942779541
Epoch: 23, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 1.3397819995880127
Epoch: 24, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 1.4667668342590332
Epoch: 25, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 1.452286720275879
Epoch: 26, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 1.3022620677947998
Epoch: 27, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 1.3515689373016357
Epoch: 28, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 1.000 Test Loss: 0.170 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2358020
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8037047386169434
Epoch: 1, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.402 Vali Acc: 0.350 Test Loss: 1.402 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.0362210273742676
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.374 Vali Acc: 0.425 Test Loss: 1.374 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.9760794639587402
Epoch: 3, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.0964384078979492
Epoch: 4, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.270 Vali Acc: 0.550 Test Loss: 1.270 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.9993257522583008
Epoch: 5, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.203 Vali Acc: 0.575 Test Loss: 1.203 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.14424729347229
Epoch: 6, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.9528210163116455
Epoch: 7, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 1.0251781940460205
Epoch: 8, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.968827486038208
Epoch: 9, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.9467983245849609
Epoch: 10, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.830 Vali Acc: 0.850 Test Loss: 0.830 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.0640125274658203
Epoch: 11, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.753 Vali Acc: 0.900 Test Loss: 0.753 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 1.013878345489502
Epoch: 12, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.676 Vali Acc: 0.925 Test Loss: 0.676 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.9955136775970459
Epoch: 13, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.609 Vali Acc: 0.925 Test Loss: 0.609 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.7910676002502441
Epoch: 14, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.542 Vali Acc: 0.950 Test Loss: 0.542 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.0452959537506104
Epoch: 15, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.480 Vali Acc: 0.975 Test Loss: 0.480 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 1.1440482139587402
Epoch: 16, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 1.000 Test Loss: 0.421 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 702724
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.555694341659546
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.8807275295257568
Epoch: 2, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.439 Vali Acc: 0.225 Test Loss: 1.439 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.9025888442993164
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.9833800792694092
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.316 Vali Acc: 0.450 Test Loss: 1.316 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.013833999633789
Epoch: 5, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.057483196258545
Epoch: 6, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.9658138751983643
Epoch: 7, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.106 Vali Acc: 0.575 Test Loss: 1.106 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.9707798957824707
Epoch: 8, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.025 Vali Acc: 0.700 Test Loss: 1.025 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.9478540420532227
Epoch: 9, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.946 Vali Acc: 0.750 Test Loss: 0.946 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.0254788398742676
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.869 Vali Acc: 0.825 Test Loss: 0.869 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.9605205059051514
Epoch: 11, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.793 Vali Acc: 0.875 Test Loss: 0.793 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.9570584297180176
Epoch: 12, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.719 Vali Acc: 0.875 Test Loss: 0.719 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.9001717567443848
Epoch: 13, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.651 Vali Acc: 0.875 Test Loss: 0.651 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.9528322219848633
Epoch: 14, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.8961801528930664
Epoch: 15, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.547 Vali Acc: 0.925 Test Loss: 0.547 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.8773767948150635
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.8960905075073242
Epoch: 17, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.7513606548309326
Epoch: 18, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.7547616958618164
Epoch: 19, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.1003997325897217
Epoch: 20, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 1.0617363452911377
Epoch: 21, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.9375736713409424
Epoch: 22, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.924997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 1.0108416080474854
Epoch: 23, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.941882848739624
Epoch: 24, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.9880075454711914
Epoch: 25, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.96042799949646
Epoch: 26, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.9419059753417969
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.8691773414611816
Epoch: 28, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.9699461460113525
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 1.0241541862487793
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2358020
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.745215654373169
Epoch: 1, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.365 Vali Acc: 0.425 Test Loss: 1.365 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.8891315460205078
Epoch: 2, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.338 Vali Acc: 0.450 Test Loss: 1.338 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.8866944313049316
Epoch: 3, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.299 Vali Acc: 0.475 Test Loss: 1.299 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.7902462482452393
Epoch: 4, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8916034698486328
Epoch: 5, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.194 Vali Acc: 0.525 Test Loss: 1.194 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.9707658290863037
Epoch: 6, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.9726312160491943
Epoch: 7, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.071 Vali Acc: 0.675 Test Loss: 1.071 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.9047229290008545
Epoch: 8, Steps: 3 | Train Loss: 0.883 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.8684902191162109
Epoch: 9, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.6948146820068359
Epoch: 10, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.862 Vali Acc: 0.775 Test Loss: 0.862 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.6981868743896484
Epoch: 11, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.9184999465942383
Epoch: 12, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.8175597190856934
Epoch: 13, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.9044556617736816
Epoch: 14, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.7827115058898926
Epoch: 15, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.8851897716522217
Epoch: 16, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.469 Vali Acc: 0.950 Test Loss: 0.469 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.903740644454956
Epoch: 17, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.8147544860839844
Epoch: 18, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.9457311630249023
Epoch: 19, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.8648889064788818
Epoch: 20, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.876267671585083
Epoch: 21, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.9749484062194824
Epoch: 22, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.271 Vali Acc: 1.000 Test Loss: 0.271 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 702724
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3538002967834473
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.331 Vali Acc: 0.350 Test Loss: 1.331 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.4852550029754639
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.305 Vali Acc: 0.425 Test Loss: 1.305 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.5877258777618408
Epoch: 3, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 1.6660552024841309
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.210 Vali Acc: 0.575 Test Loss: 1.210 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.6471703052520752
Epoch: 5, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.154 Vali Acc: 0.625 Test Loss: 1.154 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 1.5075888633728027
Epoch: 6, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.099 Vali Acc: 0.700 Test Loss: 1.099 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 1.2448396682739258
Epoch: 7, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.044 Vali Acc: 0.725 Test Loss: 1.044 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 1.439300537109375
Epoch: 8, Steps: 3 | Train Loss: 0.996 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 1.5926148891448975
Epoch: 9, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.954 Vali Acc: 0.700 Test Loss: 0.954 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8078839778900146
Epoch: 10, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 1.5108568668365479
Epoch: 11, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.849 Vali Acc: 0.775 Test Loss: 0.849 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 1.5361731052398682
Epoch: 12, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.4469044208526611
Epoch: 13, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.4473083019256592
Epoch: 14, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.5854661464691162
Epoch: 15, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 1.4636874198913574
Epoch: 16, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.522 Vali Acc: 0.950 Test Loss: 0.522 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 1.4293632507324219
Epoch: 17, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.478 Vali Acc: 0.975 Test Loss: 0.478 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 1.489492416381836
Epoch: 18, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.443 Vali Acc: 0.975 Test Loss: 0.443 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 1.40128493309021
Epoch: 19, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 1.4264824390411377
Epoch: 20, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 1.4974513053894043
Epoch: 21, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 1.423276662826538
Epoch: 22, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 1.5370736122131348
Epoch: 23, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.296 Vali Acc: 1.000 Test Loss: 0.296 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2351620
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.142500400543213
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.408 Vali Acc: 0.275 Test Loss: 1.408 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.116699457168579
Epoch: 2, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.1108083724975586
Epoch: 3, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.356 Vali Acc: 0.300 Test Loss: 1.356 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.156062126159668
Epoch: 4, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.318 Vali Acc: 0.350 Test Loss: 1.318 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.3114187717437744
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.273 Vali Acc: 0.425 Test Loss: 1.273 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.2374975681304932
Epoch: 6, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.229 Vali Acc: 0.425 Test Loss: 1.229 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 1.0768308639526367
Epoch: 7, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.181 Vali Acc: 0.550 Test Loss: 1.181 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.2331769466400146
Epoch: 8, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 1.0876555442810059
Epoch: 9, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.082 Vali Acc: 0.675 Test Loss: 1.082 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 1.1545312404632568
Epoch: 10, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.032 Vali Acc: 0.625 Test Loss: 1.032 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1297998428344727
Epoch: 11, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.973 Vali Acc: 0.675 Test Loss: 0.973 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.1601274013519287
Epoch: 12, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.1375718116760254
Epoch: 13, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.839 Vali Acc: 0.750 Test Loss: 0.839 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.1394445896148682
Epoch: 14, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 1.0617997646331787
Epoch: 15, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 1.1577479839324951
Epoch: 16, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.1114652156829834
Epoch: 17, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 1.1575477123260498
Epoch: 18, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 1.0624008178710938
Epoch: 19, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 1.0492210388183594
Epoch: 20, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.982907772064209
Epoch: 21, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.0938916206359863
Epoch: 22, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.0767958164215088
Epoch: 23, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 1.1469736099243164
Epoch: 24, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0767638683319092
Epoch: 25, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.08284592628479
Epoch: 26, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.1278507709503174
Epoch: 27, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.0215532779693604
Epoch: 28, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.0995237827301025
Epoch: 29, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.0255451202392578
Epoch: 30, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 696196
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1679306030273438
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.320 Vali Acc: 0.250 Test Loss: 1.320 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 1.2824652194976807
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.305 Vali Acc: 0.350 Test Loss: 1.305 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.3023648262023926
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.264 Vali Acc: 0.475 Test Loss: 1.264 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.3918731212615967
Epoch: 4, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.2791469097137451
Epoch: 5, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.2499134540557861
Epoch: 6, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.121 Vali Acc: 0.575 Test Loss: 1.121 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 1.2243225574493408
Epoch: 7, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.9765219688415527
Epoch: 8, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.032059669494629
Epoch: 9, Steps: 3 | Train Loss: 0.945 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.1622633934020996
Epoch: 10, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.3163580894470215
Epoch: 11, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 1.1794407367706299
Epoch: 12, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 1.0570251941680908
Epoch: 13, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.200179100036621
Epoch: 14, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.1492371559143066
Epoch: 15, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 1.1192626953125
Epoch: 16, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 1.2361571788787842
Epoch: 17, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.537 Vali Acc: 0.950 Test Loss: 0.537 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 1.2305514812469482
Epoch: 18, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.493 Vali Acc: 0.950 Test Loss: 0.493 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 1.2524399757385254
Epoch: 19, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.466 Vali Acc: 1.000 Test Loss: 0.466 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2351620
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.829866886138916
Epoch: 1, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.425 Vali Acc: 0.225 Test Loss: 1.425 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.8892922401428223
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.400 Vali Acc: 0.225 Test Loss: 1.400 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.0042288303375244
Epoch: 3, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.364 Vali Acc: 0.250 Test Loss: 1.364 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.9926304817199707
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.316 Vali Acc: 0.300 Test Loss: 1.316 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 1.0128445625305176
Epoch: 5, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.299987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0503249168395996
Epoch: 6, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.219 Vali Acc: 0.525 Test Loss: 1.219 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.8650259971618652
Epoch: 7, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.169 Vali Acc: 0.550 Test Loss: 1.169 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.8351800441741943
Epoch: 8, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.9773094654083252
Epoch: 9, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.9238016605377197
Epoch: 10, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.018 Vali Acc: 0.625 Test Loss: 1.018 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.9512515068054199
Epoch: 11, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 1.0687899589538574
Epoch: 12, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.9663562774658203
Epoch: 13, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.834 Vali Acc: 0.725 Test Loss: 0.834 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 14 cost time: 0.9974093437194824
Epoch: 14, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.724992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.9411380290985107
Epoch: 15, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.9928600788116455
Epoch: 16, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.659 Vali Acc: 0.875 Test Loss: 0.659 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.9133460521697998
Epoch: 17, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.611 Vali Acc: 0.875 Test Loss: 0.611 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.9853513240814209
Epoch: 18, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.951331615447998
Epoch: 19, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.89530348777771
Epoch: 20, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.9323616027832031
Epoch: 21, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.97391676902771
Epoch: 22, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0726144313812256
Epoch: 23, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9701664447784424
Epoch: 24, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0480613708496094
Epoch: 25, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.0900964736938477
Epoch: 26, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.952599048614502
Epoch: 27, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.894824743270874
Epoch: 28, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.9088034629821777
Epoch: 29, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.9314589500427246
Epoch: 30, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 696196
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8296096324920654
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.351 Vali Acc: 0.300 Test Loss: 1.351 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.0975022315979004
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0453999042510986
Epoch: 3, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.284 Vali Acc: 0.475 Test Loss: 1.284 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.9681458473205566
Epoch: 4, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.245 Vali Acc: 0.475 Test Loss: 1.245 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 1.0435726642608643
Epoch: 5, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0969734191894531
Epoch: 6, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.9766576290130615
Epoch: 7, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.149 Vali Acc: 0.475 Test Loss: 1.149 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9502556324005127
Epoch: 8, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.984368085861206
Epoch: 9, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9552907943725586
Epoch: 10, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.037 Vali Acc: 0.625 Test Loss: 1.037 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.959510326385498
Epoch: 11, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9736082553863525
Epoch: 12, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.920 Vali Acc: 0.625 Test Loss: 0.920 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 0.9669346809387207
Epoch: 13, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.856 Vali Acc: 0.725 Test Loss: 0.856 Test Acc: 0.725
Validation loss decreased (-0.624991 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.965989351272583
Epoch: 14, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.0234737396240234
Epoch: 15, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 1.0428049564361572
Epoch: 16, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.8914387226104736
Epoch: 17, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.8452272415161133
Epoch: 18, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.624 Vali Acc: 0.925 Test Loss: 0.624 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 1.0080180168151855
Epoch: 19, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0762755870819092
Epoch: 20, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.9920778274536133
Epoch: 21, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.522 Vali Acc: 0.925 Test Loss: 0.522 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.059687614440918
Epoch: 22, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 1.0158641338348389
Epoch: 23, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.957500696182251
Epoch: 24, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.9150676727294922
Epoch: 25, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.0292675495147705
Epoch: 26, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.087083339691162
Epoch: 27, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 1.0351831912994385
Epoch: 28, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 1.0318074226379395
Epoch: 29, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.354 Vali Acc: 0.975 Test Loss: 0.354 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.9334583282470703
Epoch: 30, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2351620
model size : 9.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6242902278900146
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.367 Vali Acc: 0.250 Test Loss: 1.367 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.85616135597229
Epoch: 2, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.345 Vali Acc: 0.275 Test Loss: 1.345 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.8374631404876709
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.315 Vali Acc: 0.275 Test Loss: 1.315 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.7848420143127441
Epoch: 4, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.274 Vali Acc: 0.400 Test Loss: 1.274 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.7023589611053467
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.232 Vali Acc: 0.525 Test Loss: 1.232 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.6722209453582764
Epoch: 6, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.189 Vali Acc: 0.525 Test Loss: 1.189 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.9242072105407715
Epoch: 7, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.146 Vali Acc: 0.525 Test Loss: 1.146 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.8631880283355713
Epoch: 8, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.103 Vali Acc: 0.550 Test Loss: 1.103 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.8008568286895752
Epoch: 9, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.057 Vali Acc: 0.550 Test Loss: 1.057 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.8295125961303711
Epoch: 10, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.8812830448150635
Epoch: 11, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.8019058704376221
Epoch: 12, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.916 Vali Acc: 0.700 Test Loss: 0.916 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.7922992706298828
Epoch: 13, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.7727675437927246
Epoch: 14, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 15 cost time: 0.8602325916290283
Epoch: 15, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.775 Vali Acc: 0.725 Test Loss: 0.775 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 16 cost time: 0.8681309223175049
Epoch: 16, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774993).  Saving model ...
Epoch: 17 cost time: 0.8129663467407227
Epoch: 17, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.7567143440246582
Epoch: 18, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 0.8451120853424072
Epoch: 19, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.8693740367889404
Epoch: 20, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.7727887630462646
Epoch: 21, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 0.8104488849639893
Epoch: 22, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 0.8913710117340088
Epoch: 23, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.8779993057250977
Epoch: 24, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.8440043926239014
Epoch: 25, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.8409171104431152
Epoch: 26, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.9619512557983398
Epoch: 27, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.9141964912414551
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.980884313583374
Epoch: 29, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0714058876037598
Epoch: 30, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 696196
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.972850799560547
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.410 Vali Acc: 0.375 Test Loss: 1.410 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.9617505073547363
Epoch: 2, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9245848655700684
Epoch: 3, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.362 Vali Acc: 0.350 Test Loss: 1.362 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8887529373168945
Epoch: 4, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.8871002197265625
Epoch: 5, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.286 Vali Acc: 0.375 Test Loss: 1.286 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 2.0345542430877686
Epoch: 6, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.240 Vali Acc: 0.475 Test Loss: 1.240 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 1.940403938293457
Epoch: 7, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.190 Vali Acc: 0.575 Test Loss: 1.190 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 1.994765281677246
Epoch: 8, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.138 Vali Acc: 0.650 Test Loss: 1.138 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 1.8627126216888428
Epoch: 9, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.082 Vali Acc: 0.725 Test Loss: 1.082 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 2.0007309913635254
Epoch: 10, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.025 Vali Acc: 0.775 Test Loss: 1.025 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 1.7523188591003418
Epoch: 11, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.959 Vali Acc: 0.850 Test Loss: 0.959 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 2.0383098125457764
Epoch: 12, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.895 Vali Acc: 0.875 Test Loss: 0.895 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 2.0801000595092773
Epoch: 13, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.826 Vali Acc: 0.925 Test Loss: 0.826 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 14 cost time: 1.9323348999023438
Epoch: 14, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.754 Vali Acc: 0.925 Test Loss: 0.754 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 15 cost time: 2.029531717300415
Epoch: 15, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.684 Vali Acc: 0.925 Test Loss: 0.684 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 16 cost time: 1.7928040027618408
Epoch: 16, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.623 Vali Acc: 0.925 Test Loss: 0.623 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 1.870854139328003
Epoch: 17, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.565 Vali Acc: 0.950 Test Loss: 0.565 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 18 cost time: 2.2674882411956787
Epoch: 18, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.503 Vali Acc: 0.950 Test Loss: 0.503 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 2.0827646255493164
Epoch: 19, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 1.8727633953094482
Epoch: 20, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.400 Vali Acc: 0.975 Test Loss: 0.400 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 1.7181205749511719
Epoch: 21, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.357 Vali Acc: 1.000 Test Loss: 0.357 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1179396
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4130852222442627
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.440 Vali Acc: 0.175 Test Loss: 1.440 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.2643260955810547
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.423 Vali Acc: 0.200 Test Loss: 1.423 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.3418920040130615
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.3784725666046143
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.3400144577026367
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.219144582748413
Epoch: 6, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.332 Vali Acc: 0.425 Test Loss: 1.332 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.2745897769927979
Epoch: 7, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.301 Vali Acc: 0.450 Test Loss: 1.301 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.2876341342926025
Epoch: 8, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.2054879665374756
Epoch: 9, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.2400915622711182
Epoch: 10, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.197 Vali Acc: 0.550 Test Loss: 1.197 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 1.3562688827514648
Epoch: 11, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 1.234379768371582
Epoch: 12, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.1969702243804932
Epoch: 13, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 1.3152282238006592
Epoch: 14, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.2955176830291748
Epoch: 15, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 1.3938689231872559
Epoch: 16, Steps: 3 | Train Loss: 0.754 Vali Loss: 0.926 Vali Acc: 0.725 Test Loss: 0.926 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.3372392654418945
Epoch: 17, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.877 Vali Acc: 0.725 Test Loss: 0.877 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 1.4044981002807617
Epoch: 18, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.828 Vali Acc: 0.725 Test Loss: 0.828 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 19 cost time: 1.271345853805542
Epoch: 19, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 1.087794303894043
Epoch: 20, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 21 cost time: 1.3571748733520508
Epoch: 21, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 1.3134775161743164
Epoch: 22, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 1.2887091636657715
Epoch: 23, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 1.2259814739227295
Epoch: 24, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 1.269150972366333
Epoch: 25, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 1.4481277465820312
Epoch: 26, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 1.4303922653198242
Epoch: 27, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 1.3096590042114258
Epoch: 28, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 1.2735753059387207
Epoch: 29, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 1.2084252834320068
Epoch: 30, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 351620
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3527731895446777
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.398 Vali Acc: 0.375 Test Loss: 1.398 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.3420519828796387
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.2186744213104248
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3738226890563965
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4171860218048096
Epoch: 5, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.288 Vali Acc: 0.350 Test Loss: 1.288 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4992101192474365
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 1.2829995155334473
Epoch: 7, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.199 Vali Acc: 0.575 Test Loss: 1.199 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 1.2207913398742676
Epoch: 8, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.4244208335876465
Epoch: 9, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 1.3601903915405273
Epoch: 10, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.042 Vali Acc: 0.725 Test Loss: 1.042 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.4224610328674316
Epoch: 11, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.984 Vali Acc: 0.825 Test Loss: 0.984 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824990).  Saving model ...
Epoch: 12 cost time: 1.4307355880737305
Epoch: 12, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.926 Vali Acc: 0.875 Test Loss: 0.926 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 1.4148972034454346
Epoch: 13, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.864 Vali Acc: 0.900 Test Loss: 0.864 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 1.4848699569702148
Epoch: 14, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.802 Vali Acc: 0.900 Test Loss: 0.802 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 1.3144214153289795
Epoch: 15, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.745 Vali Acc: 0.900 Test Loss: 0.745 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 1.5102064609527588
Epoch: 16, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.687 Vali Acc: 0.925 Test Loss: 0.687 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 1.3199467658996582
Epoch: 17, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.631 Vali Acc: 0.925 Test Loss: 0.631 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 18 cost time: 1.4527685642242432
Epoch: 18, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.574 Vali Acc: 0.925 Test Loss: 0.574 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 1.4354662895202637
Epoch: 19, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 1.3860597610473633
Epoch: 20, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 21 cost time: 1.2328989505767822
Epoch: 21, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.414 Vali Acc: 1.000 Test Loss: 0.414 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1179396
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0706515312194824
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.421 Vali Acc: 0.150 Test Loss: 1.421 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.1158082485198975
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
Validation loss decreased (-0.149986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.1149790287017822
Epoch: 3, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.080904483795166
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.367 Vali Acc: 0.400 Test Loss: 1.367 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.1437997817993164
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.342 Vali Acc: 0.425 Test Loss: 1.342 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.9480624198913574
Epoch: 6, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.315 Vali Acc: 0.425 Test Loss: 1.315 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.9103353023529053
Epoch: 7, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.9152851104736328
Epoch: 8, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.255 Vali Acc: 0.525 Test Loss: 1.255 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.9289777278900146
Epoch: 9, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.221 Vali Acc: 0.575 Test Loss: 1.221 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.9921743869781494
Epoch: 10, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.186 Vali Acc: 0.575 Test Loss: 1.186 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 1.128040075302124
Epoch: 11, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.150 Vali Acc: 0.575 Test Loss: 1.150 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.1116678714752197
Epoch: 12, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.113 Vali Acc: 0.625 Test Loss: 1.113 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.112001895904541
Epoch: 13, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 1.1176178455352783
Epoch: 14, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.022 Vali Acc: 0.750 Test Loss: 1.022 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.1526801586151123
Epoch: 15, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.964 Vali Acc: 0.750 Test Loss: 0.964 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 1.0138146877288818
Epoch: 16, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.909 Vali Acc: 0.825 Test Loss: 0.909 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 1.1216609477996826
Epoch: 17, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.865 Vali Acc: 0.825 Test Loss: 0.865 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 1.0739445686340332
Epoch: 18, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0676655769348145
Epoch: 19, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0947597026824951
Epoch: 20, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.739 Vali Acc: 0.825 Test Loss: 0.739 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.2269959449768066
Epoch: 21, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.706 Vali Acc: 0.800 Test Loss: 0.706 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0656614303588867
Epoch: 22, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.666 Vali Acc: 0.875 Test Loss: 0.666 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 1.2122819423675537
Epoch: 23, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.1903908252716064
Epoch: 24, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.589 Vali Acc: 0.925 Test Loss: 0.589 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 1.2396364212036133
Epoch: 25, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.555 Vali Acc: 0.925 Test Loss: 0.555 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 1.0552709102630615
Epoch: 26, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.2417919635772705
Epoch: 27, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 1.0362069606781006
Epoch: 28, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.448 Vali Acc: 0.975 Test Loss: 0.448 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 1.1494855880737305
Epoch: 29, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.410 Vali Acc: 0.975 Test Loss: 0.410 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 1.1974678039550781
Epoch: 30, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 351620
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1066253185272217
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.1451010704040527
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.135577917098999
Epoch: 3, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.331 Vali Acc: 0.350 Test Loss: 1.331 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9577264785766602
Epoch: 4, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.297 Vali Acc: 0.350 Test Loss: 1.297 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0101382732391357
Epoch: 5, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.8835015296936035
Epoch: 6, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.9522209167480469
Epoch: 7, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.9645278453826904
Epoch: 8, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 1.1548750400543213
Epoch: 9, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.1975553035736084
Epoch: 10, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 1.1691358089447021
Epoch: 11, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.1535327434539795
Epoch: 12, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.924 Vali Acc: 0.800 Test Loss: 0.924 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 1.1087753772735596
Epoch: 13, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.872 Vali Acc: 0.825 Test Loss: 0.872 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 1.1085617542266846
Epoch: 14, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.822 Vali Acc: 0.875 Test Loss: 0.822 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 1.1340935230255127
Epoch: 15, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.775 Vali Acc: 0.900 Test Loss: 0.775 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.9786005020141602
Epoch: 16, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.728 Vali Acc: 0.925 Test Loss: 0.728 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.9855601787567139
Epoch: 17, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.681 Vali Acc: 0.925 Test Loss: 0.681 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 1.025245189666748
Epoch: 18, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.670156717300415
Epoch: 19, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.609 Vali Acc: 0.925 Test Loss: 0.609 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.9078373908996582
Epoch: 20, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.567 Vali Acc: 0.950 Test Loss: 0.567 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 1.0356526374816895
Epoch: 21, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.527 Vali Acc: 0.950 Test Loss: 0.527 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 22 cost time: 1.118229627609253
Epoch: 22, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 1.1243188381195068
Epoch: 23, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 1.1402270793914795
Epoch: 24, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.1467726230621338
Epoch: 25, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.201052188873291
Epoch: 26, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.201829195022583
Epoch: 27, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.1169977188110352
Epoch: 28, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.0776889324188232
Epoch: 29, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.074021339416504
Epoch: 30, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1179396
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9750590324401855
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.383 Vali Acc: 0.275 Test Loss: 1.383 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.9536478519439697
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.0375490188598633
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.353 Vali Acc: 0.425 Test Loss: 1.353 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 1.1039206981658936
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.335 Vali Acc: 0.450 Test Loss: 1.335 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.8517599105834961
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.332 Vali Acc: 0.250 Test Loss: 1.332 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9498414993286133
Epoch: 6, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.306 Vali Acc: 0.325 Test Loss: 1.306 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.081709623336792
Epoch: 7, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9421162605285645
Epoch: 8, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9092354774475098
Epoch: 9, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.215 Vali Acc: 0.450 Test Loss: 1.215 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.0639052391052246
Epoch: 10, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 1.0214974880218506
Epoch: 11, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 0.8439793586730957
Epoch: 12, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.083 Vali Acc: 0.675 Test Loss: 1.083 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.8393926620483398
Epoch: 13, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 0.9690549373626709
Epoch: 14, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.009 Vali Acc: 0.725 Test Loss: 1.009 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.0140933990478516
Epoch: 15, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9098880290985107
Epoch: 16, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.882648229598999
Epoch: 17, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.913 Vali Acc: 0.725 Test Loss: 0.913 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 0.9471526145935059
Epoch: 18, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.7594313621520996
Epoch: 19, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.8658976554870605
Epoch: 20, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 0.775949239730835
Epoch: 21, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 0.7022581100463867
Epoch: 22, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.713 Vali Acc: 0.775 Test Loss: 0.713 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 23 cost time: 0.7686712741851807
Epoch: 23, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 24 cost time: 0.7269511222839355
Epoch: 24, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.644 Vali Acc: 0.825 Test Loss: 0.644 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 0.8186028003692627
Epoch: 25, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 0.7945332527160645
Epoch: 26, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.9912378787994385
Epoch: 27, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 0.981853723526001
Epoch: 28, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 29 cost time: 1.023334264755249
Epoch: 29, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 1.075218677520752
Epoch: 30, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 351620
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2981605529785156
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.5288512706756592
Epoch: 2, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.354 Vali Acc: 0.450 Test Loss: 1.354 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.752316951751709
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.327 Vali Acc: 0.475 Test Loss: 1.327 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.5815510749816895
Epoch: 4, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.291 Vali Acc: 0.575 Test Loss: 1.291 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574987).  Saving model ...
Epoch: 5 cost time: 1.4330341815948486
Epoch: 5, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 1.4291131496429443
Epoch: 6, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.6409616470336914
Epoch: 7, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.162 Vali Acc: 0.625 Test Loss: 1.162 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 1.2324788570404053
Epoch: 8, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.117 Vali Acc: 0.675 Test Loss: 1.117 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 1.041203260421753
Epoch: 9, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 1.175530195236206
Epoch: 10, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.021 Vali Acc: 0.750 Test Loss: 1.021 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 1.2628355026245117
Epoch: 11, Steps: 3 | Train Loss: 0.959 Vali Loss: 0.971 Vali Acc: 0.800 Test Loss: 0.971 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 1.2936978340148926
Epoch: 12, Steps: 3 | Train Loss: 0.937 Vali Loss: 0.921 Vali Acc: 0.825 Test Loss: 0.921 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 1.3807299137115479
Epoch: 13, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 1.4272966384887695
Epoch: 14, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.815 Vali Acc: 0.850 Test Loss: 0.815 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 1.6243128776550293
Epoch: 15, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 1.4251666069030762
Epoch: 16, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 1.3580358028411865
Epoch: 17, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 1.6591362953186035
Epoch: 18, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.598 Vali Acc: 0.925 Test Loss: 0.598 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 1.4611895084381104
Epoch: 19, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 20 cost time: 1.7069282531738281
Epoch: 20, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.509 Vali Acc: 0.950 Test Loss: 0.509 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 21 cost time: 1.5101346969604492
Epoch: 21, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 22 cost time: 1.5852665901184082
Epoch: 22, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 1.4566397666931152
Epoch: 23, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 1.9299051761627197
Epoch: 24, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 1.406341791152954
Epoch: 25, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 1.755427598953247
Epoch: 26, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.331 Vali Acc: 1.000 Test Loss: 0.331 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 593284
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.129556179046631
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.435 Vali Acc: 0.150 Test Loss: 1.435 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.1751508712768555
Epoch: 2, Steps: 3 | Train Loss: 1.544 Vali Loss: 1.416 Vali Acc: 0.200 Test Loss: 1.416 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.193502426147461
Epoch: 3, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.399 Vali Acc: 0.275 Test Loss: 1.399 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.1158158779144287
Epoch: 4, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.377 Vali Acc: 0.350 Test Loss: 1.377 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.1807646751403809
Epoch: 5, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.2006478309631348
Epoch: 6, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1003220081329346
Epoch: 7, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.286 Vali Acc: 0.450 Test Loss: 1.286 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.9966897964477539
Epoch: 8, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.9806606769561768
Epoch: 9, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.214 Vali Acc: 0.600 Test Loss: 1.214 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 1.022002935409546
Epoch: 10, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.173 Vali Acc: 0.650 Test Loss: 1.173 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.940654993057251
Epoch: 11, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.130 Vali Acc: 0.700 Test Loss: 1.130 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.0881705284118652
Epoch: 12, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.085 Vali Acc: 0.725 Test Loss: 1.085 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.2114918231964111
Epoch: 13, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.038 Vali Acc: 0.725 Test Loss: 1.038 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.051401138305664
Epoch: 14, Steps: 3 | Train Loss: 0.901 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.1667399406433105
Epoch: 15, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.940 Vali Acc: 0.775 Test Loss: 0.940 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 1.2554337978363037
Epoch: 16, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.889 Vali Acc: 0.825 Test Loss: 0.889 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 1.385545015335083
Epoch: 17, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.840 Vali Acc: 0.825 Test Loss: 0.840 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 1.4113647937774658
Epoch: 18, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 1.2633578777313232
Epoch: 19, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.750 Vali Acc: 0.825 Test Loss: 0.750 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 1.400944709777832
Epoch: 20, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.707 Vali Acc: 0.825 Test Loss: 0.707 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.1948432922363281
Epoch: 21, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 1.0562999248504639
Epoch: 22, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.620 Vali Acc: 0.900 Test Loss: 0.620 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.3355693817138672
Epoch: 23, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.562 Vali Acc: 0.925 Test Loss: 0.562 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 1.3851521015167236
Epoch: 24, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 1.3322727680206299
Epoch: 25, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 1.1801679134368896
Epoch: 26, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.1534080505371094
Epoch: 27, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.136962652206421
Epoch: 28, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.0448486804962158
Epoch: 29, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 1.0291686058044434
Epoch: 30, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 179332
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.386565923690796
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.396 Vali Acc: 0.325 Test Loss: 1.396 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.283534288406372
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.366 Vali Acc: 0.450 Test Loss: 1.366 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.1276090145111084
Epoch: 3, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.342 Vali Acc: 0.475 Test Loss: 1.342 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.1251277923583984
Epoch: 4, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.309 Vali Acc: 0.550 Test Loss: 1.309 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 1.389420747756958
Epoch: 5, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.273 Vali Acc: 0.600 Test Loss: 1.273 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 1.2931513786315918
Epoch: 6, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.254368543624878
Epoch: 7, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.188 Vali Acc: 0.600 Test Loss: 1.188 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 1.1448895931243896
Epoch: 8, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.3320953845977783
Epoch: 9, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.3014349937438965
Epoch: 10, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.2385094165802002
Epoch: 11, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 1.2533056735992432
Epoch: 12, Steps: 3 | Train Loss: 0.919 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.1945428848266602
Epoch: 13, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.922 Vali Acc: 0.750 Test Loss: 0.922 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.0425457954406738
Epoch: 14, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 1.376915693283081
Epoch: 15, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.4076809883117676
Epoch: 16, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.3339109420776367
Epoch: 17, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.705 Vali Acc: 0.875 Test Loss: 0.705 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 1.3873295783996582
Epoch: 18, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.3533928394317627
Epoch: 19, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.602 Vali Acc: 0.925 Test Loss: 0.602 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 1.5602452754974365
Epoch: 20, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.561 Vali Acc: 0.925 Test Loss: 0.561 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 1.5179882049560547
Epoch: 21, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.527 Vali Acc: 0.925 Test Loss: 0.527 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.3855395317077637
Epoch: 22, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 1.597719430923462
Epoch: 23, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 1.4666242599487305
Epoch: 24, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.434 Vali Acc: 0.975 Test Loss: 0.434 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 1.5457899570465088
Epoch: 25, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.414 Vali Acc: 0.975 Test Loss: 0.414 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 1.2744596004486084
Epoch: 26, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.388 Vali Acc: 0.975 Test Loss: 0.388 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 1.61869478225708
Epoch: 27, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 1.487842082977295
Epoch: 28, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.344 Vali Acc: 1.000 Test Loss: 0.344 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 593284
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5840184688568115
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.427 Vali Acc: 0.175 Test Loss: 1.427 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.9300441741943359
Epoch: 2, Steps: 3 | Train Loss: 1.557 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.9722752571105957
Epoch: 3, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0435268878936768
Epoch: 4, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 1.1382699012756348
Epoch: 5, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.087829828262329
Epoch: 6, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.306 Vali Acc: 0.425 Test Loss: 1.306 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.0209882259368896
Epoch: 7, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 1.076472282409668
Epoch: 8, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.971137285232544
Epoch: 9, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.8857262134552002
Epoch: 10, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.156 Vali Acc: 0.675 Test Loss: 1.156 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 1.0323824882507324
Epoch: 11, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.025022268295288
Epoch: 12, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.068 Vali Acc: 0.725 Test Loss: 1.068 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.0486605167388916
Epoch: 13, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.023 Vali Acc: 0.725 Test Loss: 1.023 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.0623774528503418
Epoch: 14, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.976 Vali Acc: 0.725 Test Loss: 0.976 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.1581909656524658
Epoch: 15, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.0096964836120605
Epoch: 16, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 1.0378522872924805
Epoch: 17, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.828 Vali Acc: 0.825 Test Loss: 0.828 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 1.092345952987671
Epoch: 18, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.782 Vali Acc: 0.850 Test Loss: 0.782 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 19 cost time: 0.9673359394073486
Epoch: 19, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.9043271541595459
Epoch: 20, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.697 Vali Acc: 0.900 Test Loss: 0.697 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.8912618160247803
Epoch: 21, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.653 Vali Acc: 0.900 Test Loss: 0.653 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.892366886138916
Epoch: 22, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.611 Vali Acc: 0.925 Test Loss: 0.611 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.7791273593902588
Epoch: 23, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.565 Vali Acc: 0.925 Test Loss: 0.565 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.9786458015441895
Epoch: 24, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.524 Vali Acc: 0.925 Test Loss: 0.524 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.9095711708068848
Epoch: 25, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 1.0505316257476807
Epoch: 26, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 1.0279479026794434
Epoch: 27, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.1138393878936768
Epoch: 28, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.1413822174072266
Epoch: 29, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 1.019845724105835
Epoch: 30, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 179332
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.878401756286621
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.1841986179351807
Epoch: 2, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.09712815284729
Epoch: 3, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.351 Vali Acc: 0.475 Test Loss: 1.351 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.9698598384857178
Epoch: 4, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.036445140838623
Epoch: 5, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.281 Vali Acc: 0.550 Test Loss: 1.281 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 1.12593412399292
Epoch: 6, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.237 Vali Acc: 0.550 Test Loss: 1.237 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.8498961925506592
Epoch: 7, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.050947904586792
Epoch: 8, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.153 Vali Acc: 0.575 Test Loss: 1.153 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.992102861404419
Epoch: 9, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.112 Vali Acc: 0.575 Test Loss: 1.112 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 1.0075984001159668
Epoch: 10, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.9901812076568604
Epoch: 11, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.9938275814056396
Epoch: 12, Steps: 3 | Train Loss: 0.916 Vali Loss: 0.989 Vali Acc: 0.675 Test Loss: 0.989 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 1.012723684310913
Epoch: 13, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.944 Vali Acc: 0.700 Test Loss: 0.944 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 1.0319757461547852
Epoch: 14, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.901 Vali Acc: 0.750 Test Loss: 0.901 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.1072242259979248
Epoch: 15, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 1.0610833168029785
Epoch: 16, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.038731575012207
Epoch: 17, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.8624768257141113
Epoch: 18, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.9168233871459961
Epoch: 19, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.8520245552062988
Epoch: 20, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.8456811904907227
Epoch: 21, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.7644281387329102
Epoch: 22, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.561 Vali Acc: 0.925 Test Loss: 0.561 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.7763552665710449
Epoch: 23, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.533 Vali Acc: 0.950 Test Loss: 0.533 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.8720483779907227
Epoch: 24, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.505 Vali Acc: 0.950 Test Loss: 0.505 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.6983630657196045
Epoch: 25, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.9529039859771729
Epoch: 26, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 1.068096399307251
Epoch: 27, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.447 Vali Acc: 0.975 Test Loss: 0.447 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.8444559574127197
Epoch: 28, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.431 Vali Acc: 0.975 Test Loss: 0.431 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.8985521793365479
Epoch: 29, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.412 Vali Acc: 0.975 Test Loss: 0.412 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.9526617527008057
Epoch: 30, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 593284
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5220725536346436
Epoch: 1, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.403 Vali Acc: 0.175 Test Loss: 1.403 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.8615849018096924
Epoch: 2, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.386 Vali Acc: 0.200 Test Loss: 1.386 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.130491018295288
Epoch: 3, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.369 Vali Acc: 0.275 Test Loss: 1.369 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.9191522598266602
Epoch: 4, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 1.0692667961120605
Epoch: 5, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.320 Vali Acc: 0.350 Test Loss: 1.320 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.9182381629943848
Epoch: 6, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.288 Vali Acc: 0.375 Test Loss: 1.288 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.8698623180389404
Epoch: 7, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.255 Vali Acc: 0.450 Test Loss: 1.255 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.8184309005737305
Epoch: 8, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.219 Vali Acc: 0.525 Test Loss: 1.219 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.8460774421691895
Epoch: 9, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.182 Vali Acc: 0.525 Test Loss: 1.182 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.865969181060791
Epoch: 10, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 0.855212926864624
Epoch: 11, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 1.0179753303527832
Epoch: 12, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.061 Vali Acc: 0.725 Test Loss: 1.061 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.8717803955078125
Epoch: 13, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.02321195602417
Epoch: 14, Steps: 3 | Train Loss: 0.918 Vali Loss: 0.973 Vali Acc: 0.750 Test Loss: 0.973 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.6940279006958008
Epoch: 15, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.0409038066864014
Epoch: 16, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.850658655166626
Epoch: 17, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.830 Vali Acc: 0.775 Test Loss: 0.830 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.8043458461761475
Epoch: 18, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.784 Vali Acc: 0.800 Test Loss: 0.784 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.8817398548126221
Epoch: 19, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.7607481479644775
Epoch: 20, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 0.8975486755371094
Epoch: 21, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.6852309703826904
Epoch: 22, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.617 Vali Acc: 0.925 Test Loss: 0.617 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.7126994132995605
Epoch: 23, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.578 Vali Acc: 0.975 Test Loss: 0.578 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 24 cost time: 0.9059743881225586
Epoch: 24, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.540 Vali Acc: 0.975 Test Loss: 0.540 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.9731736183166504
Epoch: 25, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.507 Vali Acc: 0.975 Test Loss: 0.507 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.9853909015655518
Epoch: 26, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.477 Vali Acc: 0.975 Test Loss: 0.477 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 1.156069278717041
Epoch: 27, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.8996398448944092
Epoch: 28, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 1.1778090000152588
Epoch: 29, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.403 Vali Acc: 1.000 Test Loss: 0.403 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 179332
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0242514610290527
Epoch: 1, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.509 Vali Acc: 0.075 Test Loss: 1.509 Test Acc: 0.075
Validation loss decreased (inf --> -0.074985).  Saving model ...
Epoch: 2 cost time: 1.4310827255249023
Epoch: 2, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.488 Vali Acc: 0.075 Test Loss: 1.488 Test Acc: 0.075
Validation loss decreased (-0.074985 --> -0.074985).  Saving model ...
Epoch: 3 cost time: 1.4726569652557373
Epoch: 3, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.457 Vali Acc: 0.100 Test Loss: 1.457 Test Acc: 0.100
Validation loss decreased (-0.074985 --> -0.099985).  Saving model ...
Epoch: 4 cost time: 1.4559509754180908
Epoch: 4, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
Validation loss decreased (-0.099985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.6467807292938232
Epoch: 5, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.380 Vali Acc: 0.325 Test Loss: 1.380 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.4978554248809814
Epoch: 6, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.345 Vali Acc: 0.350 Test Loss: 1.345 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.4910824298858643
Epoch: 7, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 1.4863932132720947
Epoch: 8, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.281 Vali Acc: 0.450 Test Loss: 1.281 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 1.4269139766693115
Epoch: 9, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 1.5695726871490479
Epoch: 10, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.225 Vali Acc: 0.450 Test Loss: 1.225 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 1.477076530456543
Epoch: 11, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.194 Vali Acc: 0.525 Test Loss: 1.194 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 1.334280252456665
Epoch: 12, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.156 Vali Acc: 0.575 Test Loss: 1.156 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 1.2949352264404297
Epoch: 13, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.118 Vali Acc: 0.650 Test Loss: 1.118 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 1.407914161682129
Epoch: 14, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.079 Vali Acc: 0.650 Test Loss: 1.079 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.2787034511566162
Epoch: 15, Steps: 3 | Train Loss: 0.755 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 1.4560561180114746
Epoch: 16, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 1.2771399021148682
Epoch: 17, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.5451853275299072
Epoch: 18, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.924 Vali Acc: 0.775 Test Loss: 0.924 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.612992525100708
Epoch: 19, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849991).  Saving model ...
Epoch: 20 cost time: 1.5058906078338623
Epoch: 20, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.540283203125
Epoch: 21, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 1.5117592811584473
Epoch: 22, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 1.494255542755127
Epoch: 23, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 1.519228458404541
Epoch: 24, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.728 Vali Acc: 0.875 Test Loss: 0.728 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 1.4735989570617676
Epoch: 25, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.696 Vali Acc: 0.900 Test Loss: 0.696 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 1.6506140232086182
Epoch: 26, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.661 Vali Acc: 0.925 Test Loss: 0.661 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 1.5183250904083252
Epoch: 27, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.631 Vali Acc: 0.950 Test Loss: 0.631 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 1.6263375282287598
Epoch: 28, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.605 Vali Acc: 0.950 Test Loss: 0.605 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 1.5333805084228516
Epoch: 29, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.578 Vali Acc: 0.950 Test Loss: 0.578 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 1.4575800895690918
Epoch: 30, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.557 Vali Acc: 0.950 Test Loss: 0.557 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1176580
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3253989219665527
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.3234598636627197
Epoch: 2, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.501 Vali Acc: 0.300 Test Loss: 1.501 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.2525088787078857
Epoch: 3, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.480 Vali Acc: 0.325 Test Loss: 1.480 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 4 cost time: 1.2963602542877197
Epoch: 4, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.450 Vali Acc: 0.325 Test Loss: 1.450 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 5 cost time: 1.1569509506225586
Epoch: 5, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.413 Vali Acc: 0.325 Test Loss: 1.413 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.3123502731323242
Epoch: 6, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.375 Vali Acc: 0.375 Test Loss: 1.375 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 1.3717753887176514
Epoch: 7, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.339 Vali Acc: 0.525 Test Loss: 1.339 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 1.3212804794311523
Epoch: 8, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.306 Vali Acc: 0.550 Test Loss: 1.306 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 1.2430148124694824
Epoch: 9, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.143343448638916
Epoch: 10, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.241 Vali Acc: 0.425 Test Loss: 1.241 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0838911533355713
Epoch: 11, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.204 Vali Acc: 0.425 Test Loss: 1.204 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0993616580963135
Epoch: 12, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.163 Vali Acc: 0.475 Test Loss: 1.163 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1170079708099365
Epoch: 13, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.105329990386963
Epoch: 14, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.060 Vali Acc: 0.525 Test Loss: 1.060 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0479390621185303
Epoch: 15, Steps: 3 | Train Loss: 0.814 Vali Loss: 1.011 Vali Acc: 0.625 Test Loss: 1.011 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 1.2420814037322998
Epoch: 16, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.962 Vali Acc: 0.700 Test Loss: 0.962 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 1.1489765644073486
Epoch: 17, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 1.1005194187164307
Epoch: 18, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.2513797283172607
Epoch: 19, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 1.316589117050171
Epoch: 20, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.780 Vali Acc: 0.850 Test Loss: 0.780 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.3147556781768799
Epoch: 21, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 1.2725934982299805
Epoch: 22, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.692 Vali Acc: 0.875 Test Loss: 0.692 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 1.2689588069915771
Epoch: 23, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.654 Vali Acc: 0.875 Test Loss: 0.654 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 1.2435071468353271
Epoch: 24, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 1.2985498905181885
Epoch: 25, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.596 Vali Acc: 0.875 Test Loss: 0.596 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 1.2490816116333008
Epoch: 26, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 1.288252830505371
Epoch: 27, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.535 Vali Acc: 0.950 Test Loss: 0.535 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 1.2869842052459717
Epoch: 28, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3040494918823242
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3182003498077393
Epoch: 30, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 348612
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.138065814971924
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.516 Vali Acc: 0.100 Test Loss: 1.516 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 1.186713695526123
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.494 Vali Acc: 0.075 Test Loss: 1.494 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2538440227508545
Epoch: 3, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.461 Vali Acc: 0.100 Test Loss: 1.461 Test Acc: 0.100
Validation loss decreased (-0.099985 --> -0.099985).  Saving model ...
Epoch: 4 cost time: 1.1368193626403809
Epoch: 4, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.422 Vali Acc: 0.250 Test Loss: 1.422 Test Acc: 0.250
Validation loss decreased (-0.099985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.3683967590332031
Epoch: 5, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.381 Vali Acc: 0.325 Test Loss: 1.381 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.3421413898468018
Epoch: 6, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.121751308441162
Epoch: 7, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.170872449874878
Epoch: 8, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.986701488494873
Epoch: 9, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.251 Vali Acc: 0.425 Test Loss: 1.251 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 1.2493436336517334
Epoch: 10, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.234 Vali Acc: 0.425 Test Loss: 1.234 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 1.1444880962371826
Epoch: 11, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.200 Vali Acc: 0.450 Test Loss: 1.200 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 1.4252345561981201
Epoch: 12, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.161 Vali Acc: 0.575 Test Loss: 1.161 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 1.3983256816864014
Epoch: 13, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 1.416792631149292
Epoch: 14, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.079 Vali Acc: 0.700 Test Loss: 1.079 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 1.4177546501159668
Epoch: 15, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.040 Vali Acc: 0.725 Test Loss: 1.040 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 1.3853862285614014
Epoch: 16, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 1.1767280101776123
Epoch: 17, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 1.4297714233398438
Epoch: 18, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.309051275253296
Epoch: 19, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.901 Vali Acc: 0.825 Test Loss: 0.901 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 20 cost time: 1.2473082542419434
Epoch: 20, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.862 Vali Acc: 0.825 Test Loss: 0.862 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 21 cost time: 1.2629470825195312
Epoch: 21, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.9713187217712402
Epoch: 22, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 1.3008196353912354
Epoch: 23, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.3252358436584473
Epoch: 24, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.346229076385498
Epoch: 25, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.720 Vali Acc: 0.900 Test Loss: 0.720 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 1.2694480419158936
Epoch: 26, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.701 Vali Acc: 0.925 Test Loss: 0.701 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 1.1820950508117676
Epoch: 27, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.678 Vali Acc: 0.925 Test Loss: 0.678 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 1.2283823490142822
Epoch: 28, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.657 Vali Acc: 0.925 Test Loss: 0.657 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 29 cost time: 1.1615803241729736
Epoch: 29, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.632 Vali Acc: 0.925 Test Loss: 0.632 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 1.2381742000579834
Epoch: 30, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1176580
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0548582077026367
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.495 Vali Acc: 0.275 Test Loss: 1.495 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.8832039833068848
Epoch: 2, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.479 Vali Acc: 0.300 Test Loss: 1.479 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.890474796295166
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.459 Vali Acc: 0.325 Test Loss: 1.459 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 4 cost time: 0.8818433284759521
Epoch: 4, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.429 Vali Acc: 0.325 Test Loss: 1.429 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.2122554779052734
Epoch: 5, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.395 Vali Acc: 0.325 Test Loss: 1.395 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.176640510559082
Epoch: 6, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 1.2623820304870605
Epoch: 7, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.1962618827819824
Epoch: 8, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.294 Vali Acc: 0.475 Test Loss: 1.294 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9776103496551514
Epoch: 9, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.263 Vali Acc: 0.425 Test Loss: 1.263 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.148041009902954
Epoch: 10, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0672833919525146
Epoch: 11, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.193 Vali Acc: 0.425 Test Loss: 1.193 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2533416748046875
Epoch: 12, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.155 Vali Acc: 0.425 Test Loss: 1.155 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1866934299468994
Epoch: 13, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 0.9881212711334229
Epoch: 14, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 0.9558568000793457
Epoch: 15, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.9587142467498779
Epoch: 16, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 1.0087687969207764
Epoch: 17, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 1.0345382690429688
Epoch: 18, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.863 Vali Acc: 0.825 Test Loss: 0.863 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 19 cost time: 1.0080347061157227
Epoch: 19, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.827 Vali Acc: 0.825 Test Loss: 0.827 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.9636461734771729
Epoch: 20, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.1548337936401367
Epoch: 21, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 1.1205894947052002
Epoch: 22, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 1.177553415298462
Epoch: 23, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 1.1855909824371338
Epoch: 24, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 1.2658195495605469
Epoch: 25, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.599 Vali Acc: 0.900 Test Loss: 0.599 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 1.044022560119629
Epoch: 26, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 1.1921627521514893
Epoch: 27, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.533 Vali Acc: 0.950 Test Loss: 0.533 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 1.2546818256378174
Epoch: 28, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.512 Vali Acc: 0.925 Test Loss: 0.512 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2010219097137451
Epoch: 29, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1396703720092773
Epoch: 30, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 348612
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.039740562438965
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.537 Vali Acc: 0.075 Test Loss: 1.537 Test Acc: 0.075
Validation loss decreased (inf --> -0.074985).  Saving model ...
Epoch: 2 cost time: 1.1829583644866943
Epoch: 2, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.515 Vali Acc: 0.050 Test Loss: 1.515 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0978553295135498
Epoch: 3, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.485 Vali Acc: 0.075 Test Loss: 1.485 Test Acc: 0.075
Validation loss decreased (-0.074985 --> -0.074985).  Saving model ...
Epoch: 4 cost time: 0.9709887504577637
Epoch: 4, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (-0.074985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.9870717525482178
Epoch: 5, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.385 Vali Acc: 0.375 Test Loss: 1.385 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.9506039619445801
Epoch: 6, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.347 Vali Acc: 0.375 Test Loss: 1.347 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.942777156829834
Epoch: 7, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.8681559562683105
Epoch: 8, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 1.0138580799102783
Epoch: 9, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.9828035831451416
Epoch: 10, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 1.0299723148345947
Epoch: 11, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 1.0034496784210205
Epoch: 12, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 1.0182256698608398
Epoch: 13, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 14 cost time: 0.9751009941101074
Epoch: 14, Steps: 3 | Train Loss: 0.862 Vali Loss: 1.123 Vali Acc: 0.650 Test Loss: 1.123 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8987698554992676
Epoch: 15, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.092 Vali Acc: 0.675 Test Loss: 1.092 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.8386001586914062
Epoch: 16, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.058 Vali Acc: 0.700 Test Loss: 1.058 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 1.1376862525939941
Epoch: 17, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.1151835918426514
Epoch: 18, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 1.051321268081665
Epoch: 19, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.990 Vali Acc: 0.775 Test Loss: 0.990 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 0.9892678260803223
Epoch: 20, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.990 Vali Acc: 0.775 Test Loss: 0.990 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.125072956085205
Epoch: 21, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.950 Vali Acc: 0.800 Test Loss: 0.950 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 1.1289341449737549
Epoch: 22, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 1.1193146705627441
Epoch: 23, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.898 Vali Acc: 0.800 Test Loss: 0.898 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 0.8136749267578125
Epoch: 24, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 0.8548223972320557
Epoch: 25, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.8806731700897217
Epoch: 26, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 0.8239922523498535
Epoch: 27, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 0.9820389747619629
Epoch: 28, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 0.9179415702819824
Epoch: 29, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 30 cost time: 0.8549282550811768
Epoch: 30, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 1176580
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8737876415252686
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.496 Vali Acc: 0.250 Test Loss: 1.496 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.1080684661865234
Epoch: 2, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.480 Vali Acc: 0.300 Test Loss: 1.480 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.0458767414093018
Epoch: 3, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.460 Vali Acc: 0.300 Test Loss: 1.460 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.0705630779266357
Epoch: 4, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.431 Vali Acc: 0.325 Test Loss: 1.431 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.03078031539917
Epoch: 5, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.398 Vali Acc: 0.325 Test Loss: 1.398 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.8851521015167236
Epoch: 6, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.364 Vali Acc: 0.325 Test Loss: 1.364 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 1.1285614967346191
Epoch: 7, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.331 Vali Acc: 0.525 Test Loss: 1.331 Test Acc: 0.525
Validation loss decreased (-0.324986 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 1.0876047611236572
Epoch: 8, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.302 Vali Acc: 0.550 Test Loss: 1.302 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 1.1528465747833252
Epoch: 9, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.273 Vali Acc: 0.475 Test Loss: 1.273 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1077790260314941
Epoch: 10, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0121288299560547
Epoch: 11, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.211 Vali Acc: 0.475 Test Loss: 1.211 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9978249073028564
Epoch: 12, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.177 Vali Acc: 0.475 Test Loss: 1.177 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1904163360595703
Epoch: 13, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.139 Vali Acc: 0.550 Test Loss: 1.139 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549989).  Saving model ...
Epoch: 14 cost time: 1.1176583766937256
Epoch: 14, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.1657204627990723
Epoch: 15, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 16 cost time: 1.1502978801727295
Epoch: 16, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 1.2258398532867432
Epoch: 17, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.953 Vali Acc: 0.775 Test Loss: 0.953 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.0926809310913086
Epoch: 18, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.1842198371887207
Epoch: 19, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 1.288651943206787
Epoch: 20, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.826 Vali Acc: 0.800 Test Loss: 0.826 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 1.2127127647399902
Epoch: 21, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 1.0985019207000732
Epoch: 22, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 1.1121618747711182
Epoch: 23, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.727 Vali Acc: 0.825 Test Loss: 0.727 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 1.0753929615020752
Epoch: 24, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.083338975906372
Epoch: 25, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 1.2384834289550781
Epoch: 26, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 1.132192611694336
Epoch: 27, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 1.1990842819213867
Epoch: 28, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.630 Vali Acc: 0.900 Test Loss: 0.630 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 1.1571805477142334
Epoch: 29, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.620 Vali Acc: 0.900 Test Loss: 0.620 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 1.1664905548095703
Epoch: 30, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 348612
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8417513370513916
Epoch: 1, Steps: 3 | Train Loss: 1.562 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.776993751525879
Epoch: 2, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.8521196842193604
Epoch: 3, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.9820396900177002
Epoch: 4, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.8335955142974854
Epoch: 5, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.291 Vali Acc: 0.425 Test Loss: 1.291 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.515244722366333
Epoch: 6, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.263 Vali Acc: 0.425 Test Loss: 1.263 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 2.007650136947632
Epoch: 7, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.230 Vali Acc: 0.425 Test Loss: 1.230 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.9470634460449219
Epoch: 8, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.792083740234375
Epoch: 9, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.155 Vali Acc: 0.425 Test Loss: 1.155 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 1.701918125152588
Epoch: 10, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.121 Vali Acc: 0.425 Test Loss: 1.121 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424989).  Saving model ...
Epoch: 11 cost time: 1.568333387374878
Epoch: 11, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.088 Vali Acc: 0.425 Test Loss: 1.088 Test Acc: 0.425
Validation loss decreased (-0.424989 --> -0.424989).  Saving model ...
Epoch: 12 cost time: 1.719092607498169
Epoch: 12, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
Validation loss decreased (-0.424989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 2.07850980758667
Epoch: 13, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.499989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.8828356266021729
Epoch: 14, Steps: 3 | Train Loss: 1.026 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 1.812345266342163
Epoch: 15, Steps: 3 | Train Loss: 0.907 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.7366399765014648
Epoch: 16, Steps: 3 | Train Loss: 0.879 Vali Loss: 0.906 Vali Acc: 0.775 Test Loss: 0.906 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 2.0339605808258057
Epoch: 17, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 1.6296861171722412
Epoch: 18, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9318945407867432
Epoch: 19, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.785 Vali Acc: 0.875 Test Loss: 0.785 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 1.8488318920135498
Epoch: 20, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.747 Vali Acc: 0.900 Test Loss: 0.747 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 1.7523610591888428
Epoch: 21, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7860891819000244
Epoch: 22, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.675 Vali Acc: 0.925 Test Loss: 0.675 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 1.7575523853302002
Epoch: 23, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.637 Vali Acc: 0.950 Test Loss: 0.637 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 1.8315720558166504
Epoch: 24, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.600 Vali Acc: 0.950 Test Loss: 0.600 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 25 cost time: 1.9913992881774902
Epoch: 25, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.574 Vali Acc: 0.975 Test Loss: 0.574 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 26 cost time: 2.0520288944244385
Epoch: 26, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.547 Vali Acc: 0.975 Test Loss: 0.547 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 2.2456600666046143
Epoch: 27, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.518 Vali Acc: 0.975 Test Loss: 0.518 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 1.8183016777038574
Epoch: 28, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.487 Vali Acc: 0.975 Test Loss: 0.487 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 1.7650012969970703
Epoch: 29, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.458 Vali Acc: 0.975 Test Loss: 0.458 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 30 cost time: 2.005199670791626
Epoch: 30, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 590084
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.820359230041504
Epoch: 1, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.341 Vali Acc: 0.350 Test Loss: 1.341 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.0056283473968506
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.335 Vali Acc: 0.350 Test Loss: 1.335 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.0209095478057861
Epoch: 3, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.322 Vali Acc: 0.325 Test Loss: 1.322 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1381645202636719
Epoch: 4, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.306 Vali Acc: 0.325 Test Loss: 1.306 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.008915901184082
Epoch: 5, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.287 Vali Acc: 0.300 Test Loss: 1.287 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1503617763519287
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.266 Vali Acc: 0.300 Test Loss: 1.266 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2410085201263428
Epoch: 7, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.244 Vali Acc: 0.325 Test Loss: 1.244 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.296431303024292
Epoch: 8, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.221 Vali Acc: 0.475 Test Loss: 1.221 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 1.2231338024139404
Epoch: 9, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.2012221813201904
Epoch: 10, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 1.308593988418579
Epoch: 11, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.151 Vali Acc: 0.575 Test Loss: 1.151 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.282776117324829
Epoch: 12, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.128 Vali Acc: 0.575 Test Loss: 1.128 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 1.1856191158294678
Epoch: 13, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.103 Vali Acc: 0.575 Test Loss: 1.103 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 1.304574728012085
Epoch: 14, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.2315921783447266
Epoch: 15, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.13346266746521
Epoch: 16, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.022 Vali Acc: 0.650 Test Loss: 1.022 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 1.0091419219970703
Epoch: 17, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.1254711151123047
Epoch: 18, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 1.1173515319824219
Epoch: 19, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 1.3700435161590576
Epoch: 20, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 1.1464784145355225
Epoch: 21, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.9700851440429688
Epoch: 22, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.0835189819335938
Epoch: 23, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 1.1165337562561035
Epoch: 24, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 1.276792049407959
Epoch: 25, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.4445819854736328
Epoch: 26, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.726 Vali Acc: 0.825 Test Loss: 0.726 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 1.0850038528442383
Epoch: 27, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 1.2257423400878906
Epoch: 28, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 1.2344181537628174
Epoch: 29, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 1.4127542972564697
Epoch: 30, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.626 Vali Acc: 0.875 Test Loss: 0.626 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 176068
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.667987108230591
Epoch: 1, Steps: 3 | Train Loss: 1.572 Vali Loss: 1.377 Vali Acc: 0.350 Test Loss: 1.377 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.406830072402954
Epoch: 2, Steps: 3 | Train Loss: 1.528 Vali Loss: 1.363 Vali Acc: 0.375 Test Loss: 1.363 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.1214873790740967
Epoch: 3, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.2395622730255127
Epoch: 4, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.324 Vali Acc: 0.425 Test Loss: 1.324 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.5583164691925049
Epoch: 5, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.299 Vali Acc: 0.425 Test Loss: 1.299 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.6413567066192627
Epoch: 6, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.4755089282989502
Epoch: 7, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.2502689361572266
Epoch: 8, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2252414226531982
Epoch: 9, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2469792366027832
Epoch: 10, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.145 Vali Acc: 0.425 Test Loss: 1.145 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424989).  Saving model ...
Epoch: 11 cost time: 1.388411045074463
Epoch: 11, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.115 Vali Acc: 0.450 Test Loss: 1.115 Test Acc: 0.450
Validation loss decreased (-0.424989 --> -0.449989).  Saving model ...
Epoch: 12 cost time: 1.5910604000091553
Epoch: 12, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.080 Vali Acc: 0.450 Test Loss: 1.080 Test Acc: 0.450
Validation loss decreased (-0.449989 --> -0.449989).  Saving model ...
Epoch: 13 cost time: 1.5738794803619385
Epoch: 13, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.449989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.1288936138153076
Epoch: 14, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.004 Vali Acc: 0.575 Test Loss: 1.004 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3045170307159424
Epoch: 15, Steps: 3 | Train Loss: 0.927 Vali Loss: 0.965 Vali Acc: 0.675 Test Loss: 0.965 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 1.6367626190185547
Epoch: 16, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.0861611366271973
Epoch: 17, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.885 Vali Acc: 0.775 Test Loss: 0.885 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.8836169242858887
Epoch: 18, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.2065114974975586
Epoch: 19, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 1.2040486335754395
Epoch: 20, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.3131263256072998
Epoch: 21, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 1.2613043785095215
Epoch: 22, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.689 Vali Acc: 0.925 Test Loss: 0.689 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 1.5252947807312012
Epoch: 23, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.649 Vali Acc: 0.925 Test Loss: 0.649 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 1.6963303089141846
Epoch: 24, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 1.2497889995574951
Epoch: 25, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.595 Vali Acc: 0.925 Test Loss: 0.595 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 1.4307756423950195
Epoch: 26, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.572 Vali Acc: 0.925 Test Loss: 0.572 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 27 cost time: 1.4891383647918701
Epoch: 27, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.506504774093628
Epoch: 28, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 1.6740765571594238
Epoch: 29, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.6559510231018066
Epoch: 30, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 590084
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0147228240966797
Epoch: 1, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.330 Vali Acc: 0.325 Test Loss: 1.330 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.9748554229736328
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.323 Vali Acc: 0.350 Test Loss: 1.323 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.9853508472442627
Epoch: 3, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.311 Vali Acc: 0.325 Test Loss: 1.311 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9756700992584229
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.295 Vali Acc: 0.275 Test Loss: 1.295 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.910386323928833
Epoch: 5, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.276 Vali Acc: 0.275 Test Loss: 1.276 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.044316291809082
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.256 Vali Acc: 0.300 Test Loss: 1.256 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0903785228729248
Epoch: 7, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.234 Vali Acc: 0.325 Test Loss: 1.234 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.094313144683838
Epoch: 8, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.212 Vali Acc: 0.450 Test Loss: 1.212 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 1.274803876876831
Epoch: 9, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.0644478797912598
Epoch: 10, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.8718068599700928
Epoch: 11, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.143 Vali Acc: 0.575 Test Loss: 1.143 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 1.0402915477752686
Epoch: 12, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.120 Vali Acc: 0.575 Test Loss: 1.120 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 1.1366994380950928
Epoch: 13, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 1.1013154983520508
Epoch: 14, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.1733932495117188
Epoch: 15, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 1.0508818626403809
Epoch: 16, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.9704360961914062
Epoch: 17, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 1.0491082668304443
Epoch: 18, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.951 Vali Acc: 0.725 Test Loss: 0.951 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 1.0897395610809326
Epoch: 19, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.920 Vali Acc: 0.750 Test Loss: 0.920 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.9760012626647949
Epoch: 20, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 1.1584675312042236
Epoch: 21, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 1.0839354991912842
Epoch: 22, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.1671154499053955
Epoch: 23, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.802 Vali Acc: 0.750 Test Loss: 0.802 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 1.0882112979888916
Epoch: 24, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 1.3126614093780518
Epoch: 25, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 1.2594659328460693
Epoch: 26, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.9842896461486816
Epoch: 27, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 0.9922749996185303
Epoch: 28, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.043426513671875
Epoch: 29, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.1555776596069336
Epoch: 30, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 176068
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8822760581970215
Epoch: 1, Steps: 3 | Train Loss: 1.579 Vali Loss: 1.384 Vali Acc: 0.350 Test Loss: 1.384 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.0346791744232178
Epoch: 2, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.0827059745788574
Epoch: 3, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.037240982055664
Epoch: 4, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.0151314735412598
Epoch: 5, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.301 Vali Acc: 0.425 Test Loss: 1.301 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.0044782161712646
Epoch: 6, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.271 Vali Acc: 0.425 Test Loss: 1.271 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.1070928573608398
Epoch: 7, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.240 Vali Acc: 0.425 Test Loss: 1.240 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.1168291568756104
Epoch: 8, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.210 Vali Acc: 0.425 Test Loss: 1.210 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.905120849609375
Epoch: 9, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.178 Vali Acc: 0.450 Test Loss: 1.178 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.1150782108306885
Epoch: 10, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.145 Vali Acc: 0.475 Test Loss: 1.145 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474989).  Saving model ...
Epoch: 11 cost time: 1.1700410842895508
Epoch: 11, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.104832410812378
Epoch: 12, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.2225854396820068
Epoch: 13, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.036 Vali Acc: 0.575 Test Loss: 1.036 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574990).  Saving model ...
Epoch: 14 cost time: 1.0047051906585693
Epoch: 14, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.9785683155059814
Epoch: 15, Steps: 3 | Train Loss: 1.052 Vali Loss: 0.966 Vali Acc: 0.675 Test Loss: 0.966 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 1.006906509399414
Epoch: 16, Steps: 3 | Train Loss: 0.993 Vali Loss: 0.929 Vali Acc: 0.725 Test Loss: 0.929 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.0246498584747314
Epoch: 17, Steps: 3 | Train Loss: 0.885 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 1.0447065830230713
Epoch: 18, Steps: 3 | Train Loss: 0.848 Vali Loss: 0.864 Vali Acc: 0.725 Test Loss: 0.864 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.8782081604003906
Epoch: 19, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.9800004959106445
Epoch: 20, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.786 Vali Acc: 0.800 Test Loss: 0.786 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 1.0175342559814453
Epoch: 21, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.740 Vali Acc: 0.875 Test Loss: 0.740 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 1.113640308380127
Epoch: 22, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 1.1580536365509033
Epoch: 23, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.666 Vali Acc: 0.925 Test Loss: 0.666 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 1.194469690322876
Epoch: 24, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.624 Vali Acc: 0.925 Test Loss: 0.624 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.8889362812042236
Epoch: 25, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.599 Vali Acc: 0.950 Test Loss: 0.599 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 1.1786694526672363
Epoch: 26, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.576 Vali Acc: 0.950 Test Loss: 0.576 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 1.0092620849609375
Epoch: 27, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 1.051492691040039
Epoch: 28, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1876070499420166
Epoch: 29, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.512 Vali Acc: 0.950 Test Loss: 0.512 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 1.098219394683838
Epoch: 30, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 590084
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8986048698425293
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.326 Vali Acc: 0.375 Test Loss: 1.326 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.1601858139038086
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.320 Vali Acc: 0.375 Test Loss: 1.320 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.7973535060882568
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.307 Vali Acc: 0.350 Test Loss: 1.307 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9070286750793457
Epoch: 4, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.291 Vali Acc: 0.300 Test Loss: 1.291 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0626153945922852
Epoch: 5, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.273 Vali Acc: 0.275 Test Loss: 1.273 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0150947570800781
Epoch: 6, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.253 Vali Acc: 0.300 Test Loss: 1.253 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1639447212219238
Epoch: 7, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.233 Vali Acc: 0.375 Test Loss: 1.233 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 1.0352897644042969
Epoch: 8, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.211 Vali Acc: 0.450 Test Loss: 1.211 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.995957612991333
Epoch: 9, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.0397756099700928
Epoch: 10, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.166 Vali Acc: 0.550 Test Loss: 1.166 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 1.1401984691619873
Epoch: 11, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 1.0615615844726562
Epoch: 12, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.119 Vali Acc: 0.550 Test Loss: 1.119 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 1.0535871982574463
Epoch: 13, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.094 Vali Acc: 0.525 Test Loss: 1.094 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1785807609558105
Epoch: 14, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.068 Vali Acc: 0.625 Test Loss: 1.068 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 1.2180986404418945
Epoch: 15, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 1.3183836936950684
Epoch: 16, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 1.1592316627502441
Epoch: 17, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.982 Vali Acc: 0.775 Test Loss: 0.982 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.276336908340454
Epoch: 18, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.951 Vali Acc: 0.775 Test Loss: 0.951 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.947420597076416
Epoch: 19, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 1.126631498336792
Epoch: 20, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 1.2919645309448242
Epoch: 21, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 1.336820125579834
Epoch: 22, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.845 Vali Acc: 0.775 Test Loss: 0.845 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 23 cost time: 1.1503448486328125
Epoch: 23, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 1.2478418350219727
Epoch: 24, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 25 cost time: 1.30057954788208
Epoch: 25, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.1350860595703125
Epoch: 26, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 1.0765721797943115
Epoch: 27, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 1.3053104877471924
Epoch: 28, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.3569848537445068
Epoch: 29, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 1.3363823890686035
Epoch: 30, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 176068
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.923880100250244
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.528 Vali Acc: 0.250 Test Loss: 1.528 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.8146624565124512
Epoch: 2, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.507 Vali Acc: 0.250 Test Loss: 1.507 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.8610501289367676
Epoch: 3, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.487 Vali Acc: 0.250 Test Loss: 1.487 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 2.022048234939575
Epoch: 4, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.463 Vali Acc: 0.250 Test Loss: 1.463 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 5 cost time: 2.1513984203338623
Epoch: 5, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.436 Vali Acc: 0.250 Test Loss: 1.436 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 2.10455322265625
Epoch: 6, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.403 Vali Acc: 0.275 Test Loss: 1.403 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 1.9070839881896973
Epoch: 7, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.367 Vali Acc: 0.300 Test Loss: 1.367 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 1.858384132385254
Epoch: 8, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.330 Vali Acc: 0.300 Test Loss: 1.330 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 9 cost time: 2.0153095722198486
Epoch: 9, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.293 Vali Acc: 0.300 Test Loss: 1.293 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 10 cost time: 2.1393537521362305
Epoch: 10, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.256 Vali Acc: 0.425 Test Loss: 1.256 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 1.6510789394378662
Epoch: 11, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.218 Vali Acc: 0.575 Test Loss: 1.218 Test Acc: 0.575
Validation loss decreased (-0.424987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.634176254272461
Epoch: 12, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.182 Vali Acc: 0.625 Test Loss: 1.182 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 2.1850523948669434
Epoch: 13, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.145 Vali Acc: 0.650 Test Loss: 1.145 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 2.182506561279297
Epoch: 14, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.112 Vali Acc: 0.700 Test Loss: 1.112 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 2.2200231552124023
Epoch: 15, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 2.0820460319519043
Epoch: 16, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.044 Vali Acc: 0.750 Test Loss: 1.044 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 2.296048879623413
Epoch: 17, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.906566858291626
Epoch: 18, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.976 Vali Acc: 0.750 Test Loss: 0.976 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.996852159500122
Epoch: 19, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.939 Vali Acc: 0.800 Test Loss: 0.939 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 1.9654266834259033
Epoch: 20, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.902 Vali Acc: 0.850 Test Loss: 0.902 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 21 cost time: 1.9800310134887695
Epoch: 21, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.866 Vali Acc: 0.850 Test Loss: 0.866 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 22 cost time: 1.8333592414855957
Epoch: 22, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.828 Vali Acc: 0.875 Test Loss: 0.828 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 2.204737663269043
Epoch: 23, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.792 Vali Acc: 0.875 Test Loss: 0.792 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 2.0961058139801025
Epoch: 24, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.757 Vali Acc: 0.900 Test Loss: 0.757 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 1.881901502609253
Epoch: 25, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.724 Vali Acc: 0.900 Test Loss: 0.724 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 1.7029228210449219
Epoch: 26, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.692 Vali Acc: 0.925 Test Loss: 0.692 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 1.6963636875152588
Epoch: 27, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.664 Vali Acc: 0.925 Test Loss: 0.664 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 1.559098243713379
Epoch: 28, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.632 Vali Acc: 0.925 Test Loss: 0.632 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 1.9041390419006348
Epoch: 29, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.600 Vali Acc: 0.925 Test Loss: 0.600 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 1.8725931644439697
Epoch: 30, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.567 Vali Acc: 0.925 Test Loss: 0.567 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 296836
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1871414184570312
Epoch: 1, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.379 Vali Acc: 0.300 Test Loss: 1.379 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2585511207580566
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.1959223747253418
Epoch: 3, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.353 Vali Acc: 0.300 Test Loss: 1.353 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.3171360492706299
Epoch: 4, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.338 Vali Acc: 0.300 Test Loss: 1.338 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 1.3692269325256348
Epoch: 5, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.320 Vali Acc: 0.350 Test Loss: 1.320 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 1.1635618209838867
Epoch: 6, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.3815016746520996
Epoch: 7, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.4902591705322266
Epoch: 8, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 1.360426664352417
Epoch: 9, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.2718820571899414
Epoch: 10, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.202 Vali Acc: 0.450 Test Loss: 1.202 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 1.414646863937378
Epoch: 11, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.6564958095550537
Epoch: 12, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.149 Vali Acc: 0.525 Test Loss: 1.149 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 13 cost time: 1.354010820388794
Epoch: 13, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.121 Vali Acc: 0.550 Test Loss: 1.121 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 14 cost time: 1.4137706756591797
Epoch: 14, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 15 cost time: 1.4169108867645264
Epoch: 15, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 1.3988714218139648
Epoch: 16, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 1.25823974609375
Epoch: 17, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 1.2641217708587646
Epoch: 18, Steps: 3 | Train Loss: 0.926 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 1.4363007545471191
Epoch: 19, Steps: 3 | Train Loss: 0.888 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 1.2285878658294678
Epoch: 20, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 1.465569257736206
Epoch: 21, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 1.2631134986877441
Epoch: 22, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 1.3355553150177002
Epoch: 23, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.830 Vali Acc: 0.775 Test Loss: 0.830 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 1.1501824855804443
Epoch: 24, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 1.3241748809814453
Epoch: 25, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 1.3610711097717285
Epoch: 26, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 1.2339973449707031
Epoch: 27, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 28 cost time: 1.3393726348876953
Epoch: 28, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3551743030548096
Epoch: 29, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 30 cost time: 1.178812026977539
Epoch: 30, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 89796
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.900527238845825
Epoch: 1, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.539 Vali Acc: 0.275 Test Loss: 1.539 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.5316665172576904
Epoch: 2, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.518 Vali Acc: 0.275 Test Loss: 1.518 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.2290058135986328
Epoch: 3, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.498 Vali Acc: 0.250 Test Loss: 1.498 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.939385175704956
Epoch: 4, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.473 Vali Acc: 0.250 Test Loss: 1.473 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7511720657348633
Epoch: 5, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4491891860961914
Epoch: 6, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.411 Vali Acc: 0.250 Test Loss: 1.411 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4434823989868164
Epoch: 7, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.376 Vali Acc: 0.250 Test Loss: 1.376 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5456881523132324
Epoch: 8, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.338 Vali Acc: 0.275 Test Loss: 1.338 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274987).  Saving model ...
Epoch: 9 cost time: 1.3842687606811523
Epoch: 9, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.300 Vali Acc: 0.275 Test Loss: 1.300 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 10 cost time: 1.5281267166137695
Epoch: 10, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.2329521179199219
Epoch: 11, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 1.0711102485656738
Epoch: 12, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.191 Vali Acc: 0.625 Test Loss: 1.191 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 1.0226144790649414
Epoch: 13, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.157 Vali Acc: 0.650 Test Loss: 1.157 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 1.2632803916931152
Epoch: 14, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.123 Vali Acc: 0.725 Test Loss: 1.123 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 1.5345337390899658
Epoch: 15, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 1.0696773529052734
Epoch: 16, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.057 Vali Acc: 0.725 Test Loss: 1.057 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 17 cost time: 1.0934531688690186
Epoch: 17, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 1.428495168685913
Epoch: 18, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.986 Vali Acc: 0.775 Test Loss: 0.986 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 1.501466989517212
Epoch: 19, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.947 Vali Acc: 0.825 Test Loss: 0.947 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 20 cost time: 1.358081579208374
Epoch: 20, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.908 Vali Acc: 0.825 Test Loss: 0.908 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 21 cost time: 1.0189354419708252
Epoch: 21, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.867 Vali Acc: 0.825 Test Loss: 0.867 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.964465856552124
Epoch: 22, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.9190750122070312
Epoch: 23, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 0.843505859375
Epoch: 24, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.8732047080993652
Epoch: 25, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.712 Vali Acc: 0.900 Test Loss: 0.712 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.9682278633117676
Epoch: 26, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.678 Vali Acc: 0.950 Test Loss: 0.678 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949993).  Saving model ...
Epoch: 27 cost time: 1.516690969467163
Epoch: 27, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.646 Vali Acc: 0.950 Test Loss: 0.646 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 1.5637154579162598
Epoch: 28, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.612 Vali Acc: 0.950 Test Loss: 0.612 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 1.4997141361236572
Epoch: 29, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.578 Vali Acc: 0.950 Test Loss: 0.578 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 1.594268560409546
Epoch: 30, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.541 Vali Acc: 0.950 Test Loss: 0.541 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 296836
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.826084852218628
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.363 Vali Acc: 0.375 Test Loss: 1.363 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.8455793857574463
Epoch: 2, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.0187022686004639
Epoch: 3, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.8791944980621338
Epoch: 4, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.3055000305175781
Epoch: 5, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.306 Vali Acc: 0.450 Test Loss: 1.306 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.3034088611602783
Epoch: 6, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.286 Vali Acc: 0.425 Test Loss: 1.286 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1878430843353271
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.264 Vali Acc: 0.425 Test Loss: 1.264 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.23527193069458
Epoch: 8, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.241 Vali Acc: 0.450 Test Loss: 1.241 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 1.1040112972259521
Epoch: 9, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.217 Vali Acc: 0.450 Test Loss: 1.217 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.1225581169128418
Epoch: 10, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.193 Vali Acc: 0.450 Test Loss: 1.193 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.9008841514587402
Epoch: 11, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.1902461051940918
Epoch: 12, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.0519824028015137
Epoch: 13, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.113 Vali Acc: 0.525 Test Loss: 1.113 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 14 cost time: 1.0980806350708008
Epoch: 14, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.084 Vali Acc: 0.550 Test Loss: 1.084 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 0.9639918804168701
Epoch: 15, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.055 Vali Acc: 0.650 Test Loss: 1.055 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.0532748699188232
Epoch: 16, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 1.082388162612915
Epoch: 17, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 1.0298752784729004
Epoch: 18, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.967 Vali Acc: 0.725 Test Loss: 0.967 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 1.4348480701446533
Epoch: 19, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 1.1883552074432373
Epoch: 20, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 1.370316505432129
Epoch: 21, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.875 Vali Acc: 0.750 Test Loss: 0.875 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 1.0044939517974854
Epoch: 22, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 1.2817628383636475
Epoch: 23, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 1.1931343078613281
Epoch: 24, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 0.9356844425201416
Epoch: 25, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 1.0469779968261719
Epoch: 26, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 27 cost time: 1.0821163654327393
Epoch: 27, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 28 cost time: 1.0906171798706055
Epoch: 28, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 29 cost time: 0.9822759628295898
Epoch: 29, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 30 cost time: 1.0881259441375732
Epoch: 30, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 89796
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9593725204467773
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.532 Vali Acc: 0.250 Test Loss: 1.532 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2341482639312744
Epoch: 2, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.511 Vali Acc: 0.250 Test Loss: 1.511 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.0819799900054932
Epoch: 3, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.490 Vali Acc: 0.250 Test Loss: 1.490 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.8307180404663086
Epoch: 4, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.466 Vali Acc: 0.275 Test Loss: 1.466 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 5 cost time: 1.2071731090545654
Epoch: 5, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.438 Vali Acc: 0.275 Test Loss: 1.438 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.2761669158935547
Epoch: 6, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.406 Vali Acc: 0.275 Test Loss: 1.406 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 1.1702072620391846
Epoch: 7, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.371 Vali Acc: 0.250 Test Loss: 1.371 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1879560947418213
Epoch: 8, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.334 Vali Acc: 0.225 Test Loss: 1.334 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.302372932434082
Epoch: 9, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.295 Vali Acc: 0.250 Test Loss: 1.295 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.237163782119751
Epoch: 10, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.259 Vali Acc: 0.375 Test Loss: 1.259 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 1.0797569751739502
Epoch: 11, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.227 Vali Acc: 0.475 Test Loss: 1.227 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 1.2448124885559082
Epoch: 12, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.193 Vali Acc: 0.575 Test Loss: 1.193 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 1.4171743392944336
Epoch: 13, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 1.083022117614746
Epoch: 14, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 1.0550017356872559
Epoch: 15, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 1.100531816482544
Epoch: 16, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.063 Vali Acc: 0.650 Test Loss: 1.063 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 1.0328938961029053
Epoch: 17, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.030 Vali Acc: 0.675 Test Loss: 1.030 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 1.0851445198059082
Epoch: 18, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 1.1106011867523193
Epoch: 19, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.961 Vali Acc: 0.800 Test Loss: 0.961 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 20 cost time: 1.1413731575012207
Epoch: 20, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.927 Vali Acc: 0.800 Test Loss: 0.927 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.193819522857666
Epoch: 21, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.893 Vali Acc: 0.800 Test Loss: 0.893 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.0259802341461182
Epoch: 22, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1250321865081787
Epoch: 23, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 1.1437177658081055
Epoch: 24, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 1.2002599239349365
Epoch: 25, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 1.2621421813964844
Epoch: 26, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.742 Vali Acc: 0.825 Test Loss: 0.742 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 1.0602478981018066
Epoch: 27, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.714 Vali Acc: 0.825 Test Loss: 0.714 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 1.221940517425537
Epoch: 28, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.147038221359253
Epoch: 29, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.1991126537322998
Epoch: 30, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 296836
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5243048667907715
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.383 Vali Acc: 0.400 Test Loss: 1.383 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.0281310081481934
Epoch: 2, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.369 Vali Acc: 0.425 Test Loss: 1.369 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.7768442630767822
Epoch: 3, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.359 Vali Acc: 0.425 Test Loss: 1.359 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 1.0076756477355957
Epoch: 4, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.346 Vali Acc: 0.425 Test Loss: 1.346 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.0821988582611084
Epoch: 5, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0605711936950684
Epoch: 6, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1956887245178223
Epoch: 7, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.288 Vali Acc: 0.425 Test Loss: 1.288 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.0592591762542725
Epoch: 8, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.266 Vali Acc: 0.425 Test Loss: 1.266 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.1381502151489258
Epoch: 9, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.243 Vali Acc: 0.450 Test Loss: 1.243 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.1855566501617432
Epoch: 10, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.218 Vali Acc: 0.450 Test Loss: 1.218 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 1.1014692783355713
Epoch: 11, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.192 Vali Acc: 0.450 Test Loss: 1.192 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 1.069586992263794
Epoch: 12, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.1802103519439697
Epoch: 13, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.140 Vali Acc: 0.525 Test Loss: 1.140 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 14 cost time: 1.0107111930847168
Epoch: 14, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.112 Vali Acc: 0.575 Test Loss: 1.112 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 15 cost time: 0.958533763885498
Epoch: 15, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.8415384292602539
Epoch: 16, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 0.9596757888793945
Epoch: 17, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 18 cost time: 0.8422160148620605
Epoch: 18, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.000 Vali Acc: 0.675 Test Loss: 1.000 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 1.0467936992645264
Epoch: 19, Steps: 3 | Train Loss: 0.913 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 1.1407184600830078
Epoch: 20, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 1.1691648960113525
Epoch: 21, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 1.0549004077911377
Epoch: 22, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 1.0390117168426514
Epoch: 23, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 24 cost time: 0.9889914989471436
Epoch: 24, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 1.0018579959869385
Epoch: 25, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 1.075150966644287
Epoch: 26, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 1.164896011352539
Epoch: 27, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.721 Vali Acc: 0.825 Test Loss: 0.721 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 1.0193805694580078
Epoch: 28, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 1.0433642864227295
Epoch: 29, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.677 Vali Acc: 0.825 Test Loss: 0.677 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 0.9765589237213135
Epoch: 30, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 89796
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 6.741257190704346
Epoch: 1, Steps: 3 | Train Loss: 1.538 Vali Loss: 1.528 Vali Acc: 0.275 Test Loss: 1.528 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 4.967520713806152
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
Validation loss decreased (-0.274985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 4.209958076477051
Epoch: 3, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.399986 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 5.1173272132873535
Epoch: 4, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 6.08797812461853
Epoch: 5, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849993).  Saving model ...
Epoch: 6 cost time: 6.094974517822266
Epoch: 6, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 6.036203384399414
Epoch: 7, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 6.793327569961548
Epoch: 8, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.881173610687256
Epoch: 9, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 6.709082126617432
Epoch: 10, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 5.931164503097534
Epoch: 11, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 6.5886406898498535
Epoch: 12, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.769647121429443
Epoch: 13, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.835155725479126
Epoch: 14, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.214 Vali Acc: 0.900 Test Loss: 0.214 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.609270095825195
Epoch: 15, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.254 Vali Acc: 0.875 Test Loss: 0.254 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.888212442398071
Epoch: 16, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.287 Vali Acc: 0.875 Test Loss: 0.287 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.745359182357788
Epoch: 17, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.275 Vali Acc: 0.875 Test Loss: 0.275 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.4855992794036865
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.925 Test Loss: 0.209 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.0278167724609375
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.120650768280029
Epoch: 20, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.144546031951904
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 56291076
model size : 217.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.6631317138671875
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.392 Vali Acc: 0.325 Test Loss: 1.392 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 2.4555397033691406
Epoch: 2, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.306 Vali Acc: 0.450 Test Loss: 1.306 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 2.42885422706604
Epoch: 3, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.104 Vali Acc: 0.725 Test Loss: 1.104 Test Acc: 0.725
Validation loss decreased (-0.449987 --> -0.724989).  Saving model ...
Epoch: 4 cost time: 2.428598403930664
Epoch: 4, Steps: 3 | Train Loss: 0.906 Vali Loss: 0.890 Vali Acc: 0.825 Test Loss: 0.890 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 2.420894145965576
Epoch: 5, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 2.3097519874572754
Epoch: 6, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 2.0618176460266113
Epoch: 7, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1344406604766846
Epoch: 8, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1296257972717285
Epoch: 9, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.225 Vali Acc: 0.875 Test Loss: 0.225 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2371604442596436
Epoch: 10, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.899995 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 2.355543375015259
Epoch: 11, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 2.235288619995117
Epoch: 12, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 13 cost time: 2.1108529567718506
Epoch: 13, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 14 cost time: 2.104642152786255
Epoch: 14, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 15 cost time: 1.8513271808624268
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.950 Test Loss: 0.114 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2133145332336426
Epoch: 16, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.950 Test Loss: 0.114 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.314737319946289
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.950 Test Loss: 0.117 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.805443525314331
Epoch: 18, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.690889596939087
Epoch: 19, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.7818655967712402
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7913269996643066
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.759399890899658
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7535595893859863
Epoch: 23, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.580782890319824
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 16573956
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 6.697098970413208
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.527 Vali Acc: 0.275 Test Loss: 1.527 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 4.670636177062988
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.415 Vali Acc: 0.325 Test Loss: 1.415 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 4.658635377883911
Epoch: 3, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.324986 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 4.467379570007324
Epoch: 4, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.885 Vali Acc: 0.775 Test Loss: 0.885 Test Acc: 0.775
Validation loss decreased (-0.599988 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 4.69276762008667
Epoch: 5, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 4.817376136779785
Epoch: 6, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 4.8194580078125
Epoch: 7, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 4.098443269729614
Epoch: 8, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 4.774736404418945
Epoch: 9, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 4.5390050411224365
Epoch: 10, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 4.572784185409546
Epoch: 11, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 4.65793776512146
Epoch: 12, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.737948179244995
Epoch: 13, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.617187738418579
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 4.570368766784668
Epoch: 15, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 16 cost time: 4.406652927398682
Epoch: 16, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.364439487457275
Epoch: 17, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.168 Vali Acc: 0.900 Test Loss: 0.168 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.517289638519287
Epoch: 18, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.1068549156188965
Epoch: 19, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 4.2352073192596436
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8498692512512207
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.4448981285095215
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.574814796447754
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.617826700210571
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.597644329071045
Epoch: 25, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.687658786773682
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.21508526802063
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.925 Test Loss: 0.173 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.527500867843628
Epoch: 28, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.55514669418335
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 56291076
model size : 217.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.7745141983032227
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.389 Vali Acc: 0.350 Test Loss: 1.389 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.869985818862915
Epoch: 2, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.306 Vali Acc: 0.425 Test Loss: 1.306 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.9868121147155762
Epoch: 3, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.130 Vali Acc: 0.625 Test Loss: 1.130 Test Acc: 0.625
Validation loss decreased (-0.424987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.9912662506103516
Epoch: 4, Steps: 3 | Train Loss: 0.947 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724991).  Saving model ...
Epoch: 5 cost time: 1.9831643104553223
Epoch: 5, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.724991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 1.9090502262115479
Epoch: 6, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 2.052910804748535
Epoch: 7, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 1.9954214096069336
Epoch: 8, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 9 cost time: 2.0187320709228516
Epoch: 9, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.899997 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 1.8031516075134277
Epoch: 10, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 1.8229434490203857
Epoch: 11, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 12 cost time: 1.9371278285980225
Epoch: 12, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 2.0596442222595215
Epoch: 13, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 2.044926881790161
Epoch: 14, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.787848711013794
Epoch: 15, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8287692070007324
Epoch: 16, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.898500680923462
Epoch: 17, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.8416566848754883
Epoch: 18, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 1.9807064533233643
Epoch: 19, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.023486852645874
Epoch: 20, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.837881326675415
Epoch: 21, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0121822357177734
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0845909118652344
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9105861186981201
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8665568828582764
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9584333896636963
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9428622722625732
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9987144470214844
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 16573956
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.55830454826355
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.539 Vali Acc: 0.300 Test Loss: 1.539 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 2.579549551010132
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 2.5363705158233643
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.299986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.4855494499206543
Epoch: 4, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.980 Vali Acc: 0.700 Test Loss: 0.980 Test Acc: 0.700
Validation loss decreased (-0.499988 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 2.7726824283599854
Epoch: 5, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 2.6866743564605713
Epoch: 6, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.565 Vali Acc: 0.825 Test Loss: 0.565 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 2.9059102535247803
Epoch: 7, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 2.9729249477386475
Epoch: 8, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.824995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 2.922173500061035
Epoch: 9, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.281 Vali Acc: 1.000 Test Loss: 0.281 Test Acc: 1.000
Validation loss decreased (-0.949996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 56291076
model size : 217.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0463013648986816
Epoch: 1, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.419 Vali Acc: 0.150 Test Loss: 1.419 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.3088364601135254
Epoch: 2, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.338 Vali Acc: 0.425 Test Loss: 1.338 Test Acc: 0.425
Validation loss decreased (-0.149986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.5190939903259277
Epoch: 3, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.182 Vali Acc: 0.550 Test Loss: 1.182 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.5035991668701172
Epoch: 4, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.015 Vali Acc: 0.675 Test Loss: 1.015 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 1.420011281967163
Epoch: 5, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.832 Vali Acc: 0.775 Test Loss: 0.832 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 1.455275058746338
Epoch: 6, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 1.3785791397094727
Epoch: 7, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.4056971073150635
Epoch: 8, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 1.4162533283233643
Epoch: 9, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 10 cost time: 1.5235059261322021
Epoch: 10, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 1.4722840785980225
Epoch: 11, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.4154841899871826
Epoch: 12, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 1.398158073425293
Epoch: 13, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2753574848175049
Epoch: 14, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.1849784851074219
Epoch: 15, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.4085938930511475
Epoch: 16, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.3506877422332764
Epoch: 17, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4143590927124023
Epoch: 18, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2458617687225342
Epoch: 19, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4126598834991455
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.52650785446167
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 1.3063757419586182
Epoch: 22, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4920926094055176
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2284080982208252
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.234147071838379
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 1.3700299263000488
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 1.261319637298584
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3703064918518066
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3840327262878418
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 1.3488101959228516
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 16573956
model size : 65.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 6.123892784118652
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.435 Vali Acc: 0.325 Test Loss: 1.435 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 3.9622750282287598
Epoch: 2, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.337 Vali Acc: 0.475 Test Loss: 1.337 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 4.12513279914856
Epoch: 3, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 4.365536451339722
Epoch: 4, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724991).  Saving model ...
Epoch: 5 cost time: 4.2435266971588135
Epoch: 5, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.676 Vali Acc: 0.875 Test Loss: 0.676 Test Acc: 0.875
Validation loss decreased (-0.724991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 3.91614031791687
Epoch: 6, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 3.9062881469726562
Epoch: 7, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 3.786886692047119
Epoch: 8, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.954922914505005
Epoch: 9, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8505005836486816
Epoch: 10, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8096182346343994
Epoch: 11, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 4.323490381240845
Epoch: 12, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 13 cost time: 4.1771416664123535
Epoch: 13, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 14 cost time: 3.713038444519043
Epoch: 14, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 15 cost time: 3.822202205657959
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 16 cost time: 4.139804124832153
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 4.010044097900391
Epoch: 17, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.163759469985962
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 1.000 Test Loss: 0.092 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 28173828
model size : 109.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.894824504852295
Epoch: 1, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.8200840950012207
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.351 Vali Acc: 0.425 Test Loss: 1.351 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 1.8470675945281982
Epoch: 3, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.154 Vali Acc: 0.675 Test Loss: 1.154 Test Acc: 0.675
Validation loss decreased (-0.424986 --> -0.674988).  Saving model ...
Epoch: 4 cost time: 1.8019945621490479
Epoch: 4, Steps: 3 | Train Loss: 0.955 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
Validation loss decreased (-0.674988 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 1.6782407760620117
Epoch: 5, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.720 Vali Acc: 0.875 Test Loss: 0.720 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 1.8684825897216797
Epoch: 6, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 1.9569573402404785
Epoch: 7, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.429 Vali Acc: 1.000 Test Loss: 0.429 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 8314884
model size : 34.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.964375257492065
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.416 Vali Acc: 0.325 Test Loss: 1.416 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 2.907742500305176
Epoch: 2, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.326 Vali Acc: 0.475 Test Loss: 1.326 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 3.083068370819092
Epoch: 3, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 3.15218448638916
Epoch: 4, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.892 Vali Acc: 0.800 Test Loss: 0.892 Test Acc: 0.800
Validation loss decreased (-0.624989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 3.066803216934204
Epoch: 5, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.685 Vali Acc: 0.875 Test Loss: 0.685 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 3.3017220497131348
Epoch: 6, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 3.129608392715454
Epoch: 7, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 2.996840000152588
Epoch: 8, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.343 Vali Acc: 0.975 Test Loss: 0.343 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 2.8369970321655273
Epoch: 9, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 3.102071523666382
Epoch: 10, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 3.1239664554595947
Epoch: 11, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.166 Vali Acc: 1.000 Test Loss: 0.166 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 28173828
model size : 109.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.6223433017730713
Epoch: 1, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.5150508880615234
Epoch: 2, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.508253574371338
Epoch: 3, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.164 Vali Acc: 0.650 Test Loss: 1.164 Test Acc: 0.650
Validation loss decreased (-0.374986 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 1.4698569774627686
Epoch: 4, Steps: 3 | Train Loss: 0.954 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 1.42844820022583
Epoch: 5, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.763 Vali Acc: 0.925 Test Loss: 0.763 Test Acc: 0.925
Validation loss decreased (-0.749990 --> -0.924992).  Saving model ...
Epoch: 6 cost time: 1.3156423568725586
Epoch: 6, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.600 Vali Acc: 0.975 Test Loss: 0.600 Test Acc: 0.975
Validation loss decreased (-0.924992 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 1.1564702987670898
Epoch: 7, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.468 Vali Acc: 1.000 Test Loss: 0.468 Test Acc: 1.000
Validation loss decreased (-0.974994 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 8314884
model size : 34.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.730097532272339
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.412 Vali Acc: 0.300 Test Loss: 1.412 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.7226715087890625
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.331 Vali Acc: 0.425 Test Loss: 1.331 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.8251252174377441
Epoch: 3, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.7360706329345703
Epoch: 4, Steps: 3 | Train Loss: 0.976 Vali Loss: 0.954 Vali Acc: 0.800 Test Loss: 0.954 Test Acc: 0.800
Validation loss decreased (-0.499988 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 1.918400764465332
Epoch: 5, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.779 Vali Acc: 0.875 Test Loss: 0.779 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 1.7925629615783691
Epoch: 6, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 1.9337923526763916
Epoch: 7, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 1.7567238807678223
Epoch: 8, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 1.832306146621704
Epoch: 9, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 1.6014430522918701
Epoch: 10, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 1.8293483257293701
Epoch: 11, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.846663236618042
Epoch: 12, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7552528381347656
Epoch: 13, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 1.8519210815429688
Epoch: 14, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 2.006146192550659
Epoch: 15, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8235862255096436
Epoch: 16, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9104340076446533
Epoch: 17, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.7897357940673828
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.477 Vali Acc: 0.825 Test Loss: 0.477 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.680901050567627
Epoch: 19, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7483010292053223
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7686116695404053
Epoch: 21, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.539811134338379
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7858390808105469
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.780134677886963
Epoch: 24, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8058946132659912
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8421225547790527
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.850 Test Loss: 0.260 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9498612880706787
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.850 Test Loss: 0.246 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 28173828
model size : 109.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1033058166503906
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2370917797088623
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.1305873394012451
Epoch: 3, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.202 Vali Acc: 0.425 Test Loss: 1.202 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 1.12618088722229
Epoch: 4, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 1.0860989093780518
Epoch: 5, Steps: 3 | Train Loss: 0.828 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.549990 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 1.2238013744354248
Epoch: 6, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.1764705181121826
Epoch: 7, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.575 Vali Acc: 0.950 Test Loss: 0.575 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 1.1452090740203857
Epoch: 8, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.469 Vali Acc: 0.975 Test Loss: 0.469 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 1.1666953563690186
Epoch: 9, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 1.2474567890167236
Epoch: 10, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 1.187474012374878
Epoch: 11, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.260 Vali Acc: 1.000 Test Loss: 0.260 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 8314884
model size : 34.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 6.8285605907440186
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.445 Vali Acc: 0.375 Test Loss: 1.445 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 4.695994138717651
Epoch: 2, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.371 Vali Acc: 0.475 Test Loss: 1.371 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 4.647613763809204
Epoch: 3, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.210 Vali Acc: 0.600 Test Loss: 1.210 Test Acc: 0.600
Validation loss decreased (-0.474986 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 4.907300710678101
Epoch: 4, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 4.623770236968994
Epoch: 5, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724991).  Saving model ...
Epoch: 6 cost time: 5.12486720085144
Epoch: 6, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 7 cost time: 5.269819021224976
Epoch: 7, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.599 Vali Acc: 0.875 Test Loss: 0.599 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 5.374707937240601
Epoch: 8, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 5.416651725769043
Epoch: 9, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 5.590566396713257
Epoch: 10, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.286 Vali Acc: 1.000 Test Loss: 0.286 Test Acc: 1.000
Validation loss decreased (-0.949996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 28147844
model size : 108.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.046098232269287
Epoch: 1, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 2.2653262615203857
Epoch: 2, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 2.329108953475952
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.225 Vali Acc: 0.475 Test Loss: 1.225 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 2.0672667026519775
Epoch: 4, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.059 Vali Acc: 0.800 Test Loss: 1.059 Test Acc: 0.800
Validation loss decreased (-0.474988 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 2.218053102493286
Epoch: 5, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.896 Vali Acc: 0.875 Test Loss: 0.896 Test Acc: 0.875
Validation loss decreased (-0.799989 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 2.201620101928711
Epoch: 6, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.750 Vali Acc: 0.900 Test Loss: 0.750 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 2.069287061691284
Epoch: 7, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.611 Vali Acc: 0.925 Test Loss: 0.611 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 2.3207058906555176
Epoch: 8, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 2.2307183742523193
Epoch: 9, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 2.3649861812591553
Epoch: 10, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.315 Vali Acc: 1.000 Test Loss: 0.315 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 8288516
model size : 32.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 5.707663297653198
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.447 Vali Acc: 0.325 Test Loss: 1.447 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 3.7769603729248047
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.384 Vali Acc: 0.425 Test Loss: 1.384 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 3.038823127746582
Epoch: 3, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 3.069805145263672
Epoch: 4, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 3.6230239868164062
Epoch: 5, Steps: 3 | Train Loss: 0.766 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 3.7781460285186768
Epoch: 6, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.909 Vali Acc: 0.750 Test Loss: 0.909 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 3.481304407119751
Epoch: 7, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.727 Vali Acc: 0.825 Test Loss: 0.727 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 3.5754623413085938
Epoch: 8, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 3.8352432250976562
Epoch: 9, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 3.4906957149505615
Epoch: 10, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.390 Vali Acc: 0.975 Test Loss: 0.390 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 3.439157485961914
Epoch: 11, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4497733116149902
Epoch: 12, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.668673515319824
Epoch: 13, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.6331160068511963
Epoch: 14, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4262948036193848
Epoch: 15, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4431920051574707
Epoch: 16, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3002264499664307
Epoch: 17, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.539910316467285
Epoch: 18, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9620208740234375
Epoch: 19, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 2.8431499004364014
Epoch: 20, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 3.6827633380889893
Epoch: 21, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.8494553565979004
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1354362964630127
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4383397102355957
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.5120224952697754
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6004862785339355
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.6484601497650146
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.431796073913574
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.5013883113861084
Epoch: 29, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.6781363487243652
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 28147844
model size : 108.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.9049642086029053
Epoch: 1, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.413 Vali Acc: 0.375 Test Loss: 1.413 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.5329737663269043
Epoch: 2, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.8324551582336426
Epoch: 3, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.223 Vali Acc: 0.525 Test Loss: 1.223 Test Acc: 0.525
Validation loss decreased (-0.399986 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 1.7949090003967285
Epoch: 4, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.075 Vali Acc: 0.775 Test Loss: 1.075 Test Acc: 0.775
Validation loss decreased (-0.524988 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 1.7361276149749756
Epoch: 5, Steps: 3 | Train Loss: 0.901 Vali Loss: 0.929 Vali Acc: 0.875 Test Loss: 0.929 Test Acc: 0.875
Validation loss decreased (-0.774989 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 1.8045248985290527
Epoch: 6, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.795 Vali Acc: 0.850 Test Loss: 0.795 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4475271701812744
Epoch: 7, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.667 Vali Acc: 0.900 Test Loss: 0.667 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 1.478667974472046
Epoch: 8, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.547 Vali Acc: 0.950 Test Loss: 0.547 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 1.4103186130523682
Epoch: 9, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.439 Vali Acc: 0.975 Test Loss: 0.439 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 1.515665054321289
Epoch: 10, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 1.8367834091186523
Epoch: 11, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.8865253925323486
Epoch: 12, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.296 Vali Acc: 1.000 Test Loss: 0.296 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 8288516
model size : 32.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.467166900634766
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.471 Vali Acc: 0.225 Test Loss: 1.471 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 2.2622218132019043
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.402 Vali Acc: 0.425 Test Loss: 1.402 Test Acc: 0.425
Validation loss decreased (-0.224985 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 2.1953351497650146
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.264 Vali Acc: 0.525 Test Loss: 1.264 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 2.436180830001831
Epoch: 4, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 2.280608654022217
Epoch: 5, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 2.165184259414673
Epoch: 6, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.891 Vali Acc: 0.775 Test Loss: 0.891 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 2.3718056678771973
Epoch: 7, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 2.387094736099243
Epoch: 8, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.676 Vali Acc: 0.825 Test Loss: 0.676 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 2.323133945465088
Epoch: 9, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3263683319091797
Epoch: 10, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.193997859954834
Epoch: 11, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.362560749053955
Epoch: 12, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849995).  Saving model ...
Epoch: 13 cost time: 2.364957332611084
Epoch: 13, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 14 cost time: 1.8188414573669434
Epoch: 14, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0695838928222656
Epoch: 15, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.392 Vali Acc: 0.825 Test Loss: 0.392 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.070727825164795
Epoch: 16, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.874996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 2.3289787769317627
Epoch: 17, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 2.376768112182617
Epoch: 18, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.221869468688965
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3390090465545654
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4242055416107178
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4368607997894287
Epoch: 22, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3486640453338623
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.318328380584717
Epoch: 24, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.319 Vali Acc: 0.875 Test Loss: 0.319 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.180356979370117
Epoch: 25, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.27097225189209
Epoch: 26, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 2.4089574813842773
Epoch: 27, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 2.304377317428589
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.3018577098846436
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.512357234954834
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 28147844
model size : 108.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.246656656265259
Epoch: 1, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.413 Vali Acc: 0.350 Test Loss: 1.413 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.1346559524536133
Epoch: 2, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.368 Vali Acc: 0.325 Test Loss: 1.368 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.178257942199707
Epoch: 3, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.276 Vali Acc: 0.275 Test Loss: 1.276 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1913721561431885
Epoch: 4, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
Validation loss decreased (-0.349986 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.1115739345550537
Epoch: 5, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.2909047603607178
Epoch: 6, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.911 Vali Acc: 0.800 Test Loss: 0.911 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.177556037902832
Epoch: 7, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.783 Vali Acc: 0.875 Test Loss: 0.783 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 1.2431626319885254
Epoch: 8, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.2946114540100098
Epoch: 9, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.4296023845672607
Epoch: 10, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 1.3549132347106934
Epoch: 11, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.363586664199829
Epoch: 12, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 1.372392177581787
Epoch: 13, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3135836124420166
Epoch: 14, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 1.3269975185394287
Epoch: 15, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.4496049880981445
Epoch: 16, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.225 Vali Acc: 1.000 Test Loss: 0.225 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 8288516
model size : 32.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 5.171508073806763
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.428 Vali Acc: 0.375 Test Loss: 1.428 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 3.1544272899627686
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 4.082615613937378
Epoch: 3, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.245 Vali Acc: 0.550 Test Loss: 1.245 Test Acc: 0.550
Validation loss decreased (-0.399986 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 3.4692413806915283
Epoch: 4, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 3.342643976211548
Epoch: 5, Steps: 3 | Train Loss: 0.871 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 3.7500600814819336
Epoch: 6, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 4.079482078552246
Epoch: 7, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.615 Vali Acc: 0.875 Test Loss: 0.615 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 3.8323731422424316
Epoch: 8, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 3.975637197494507
Epoch: 9, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 3.9173572063446045
Epoch: 10, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 11 cost time: 3.8941261768341064
Epoch: 11, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 3.861940622329712
Epoch: 12, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 4.087480306625366
Epoch: 13, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 3.7918739318847656
Epoch: 14, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 3.5899105072021484
Epoch: 15, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 3.635587692260742
Epoch: 16, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 2.980381965637207
Epoch: 17, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 3.3819873332977295
Epoch: 18, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.597886323928833
Epoch: 19, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.549180269241333
Epoch: 20, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 3.603101968765259
Epoch: 21, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6587088108062744
Epoch: 22, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.637474298477173
Epoch: 23, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.033060073852539
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.277 Vali Acc: 0.875 Test Loss: 0.277 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.124929428100586
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.744446039199829
Epoch: 26, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.68440842628479
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 1.000 Test Loss: 0.098 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 14088068
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.013956785202026
Epoch: 1, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.8761401176452637
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.313 Vali Acc: 0.375 Test Loss: 1.313 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.734299898147583
Epoch: 3, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.188 Vali Acc: 0.475 Test Loss: 1.188 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 1.5720863342285156
Epoch: 4, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
Validation loss decreased (-0.474988 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 1.882089376449585
Epoch: 5, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.926 Vali Acc: 0.750 Test Loss: 0.926 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.9473962783813477
Epoch: 6, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.9422516822814941
Epoch: 7, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.717 Vali Acc: 0.875 Test Loss: 0.717 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 1.913093090057373
Epoch: 8, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.595 Vali Acc: 0.950 Test Loss: 0.595 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 1.7542805671691895
Epoch: 9, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.483 Vali Acc: 0.950 Test Loss: 0.483 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 1.6496860980987549
Epoch: 10, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 1.7129731178283691
Epoch: 11, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.9272229671478271
Epoch: 12, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.8952133655548096
Epoch: 13, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 2.010667562484741
Epoch: 14, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.9584472179412842
Epoch: 15, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.9954829216003418
Epoch: 16, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 2.094273328781128
Epoch: 17, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 2.119022846221924
Epoch: 18, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 2.078007936477661
Epoch: 19, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 1.8488233089447021
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 1.9834673404693604
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 1.8287749290466309
Epoch: 22, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 1.9211342334747314
Epoch: 23, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 2.3932597637176514
Epoch: 24, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1192338466644287
Epoch: 25, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.284158229827881
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1213393211364746
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 1.000 Test Loss: 0.116 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4158212
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.946319341659546
Epoch: 1, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.417 Vali Acc: 0.375 Test Loss: 1.417 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 2.883732795715332
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.363 Vali Acc: 0.425 Test Loss: 1.363 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 2.449538469314575
Epoch: 3, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.4128293991088867
Epoch: 4, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 2.5359935760498047
Epoch: 5, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724991).  Saving model ...
Epoch: 6 cost time: 2.6827480792999268
Epoch: 6, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824992).  Saving model ...
Epoch: 7 cost time: 2.765878677368164
Epoch: 7, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 2.6146466732025146
Epoch: 8, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 2.853233814239502
Epoch: 9, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 2.4095449447631836
Epoch: 10, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 2.399254322052002
Epoch: 11, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 2.886500597000122
Epoch: 12, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.288 Vali Acc: 1.000 Test Loss: 0.288 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 14088068
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.942415714263916
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.7110390663146973
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.6432397365570068
Epoch: 3, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.215 Vali Acc: 0.375 Test Loss: 1.215 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 1.6230969429016113
Epoch: 4, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
Validation loss decreased (-0.374988 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 1.636582612991333
Epoch: 5, Steps: 3 | Train Loss: 0.953 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.6305370330810547
Epoch: 6, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.752312421798706
Epoch: 7, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 1.677126407623291
Epoch: 8, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.615 Vali Acc: 0.950 Test Loss: 0.615 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 1.7047626972198486
Epoch: 9, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6070740222930908
Epoch: 10, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.404 Vali Acc: 0.975 Test Loss: 0.404 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 1.7117106914520264
Epoch: 11, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.6144225597381592
Epoch: 12, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.7401492595672607
Epoch: 13, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 1.7578680515289307
Epoch: 14, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.7523584365844727
Epoch: 15, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.7947053909301758
Epoch: 16, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.8613314628601074
Epoch: 17, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 1.000 Test Loss: 0.196 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4158212
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8264739513397217
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.440 Vali Acc: 0.300 Test Loss: 1.440 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.7908687591552734
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.393 Vali Acc: 0.300 Test Loss: 1.393 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.8373286724090576
Epoch: 3, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.8668346405029297
Epoch: 4, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.5196831226348877
Epoch: 5, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.034 Vali Acc: 0.675 Test Loss: 1.034 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 1.630281686782837
Epoch: 6, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.6179718971252441
Epoch: 7, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 1.722933292388916
Epoch: 8, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.7720890045166016
Epoch: 9, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.9192709922790527
Epoch: 10, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8881361484527588
Epoch: 11, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.9552772045135498
Epoch: 12, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9407706260681152
Epoch: 13, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9579877853393555
Epoch: 14, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.842721939086914
Epoch: 15, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7461695671081543
Epoch: 16, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7263877391815186
Epoch: 17, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7836635112762451
Epoch: 18, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6253232955932617
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.6957433223724365
Epoch: 20, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.7775192260742188
Epoch: 21, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.423 Vali Acc: 0.875 Test Loss: 0.423 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7032477855682373
Epoch: 22, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 1.8102383613586426
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 1.9064915180206299
Epoch: 24, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 2.022247314453125
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.955003023147583
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9143271446228027
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6820015907287598
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6276228427886963
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5882744789123535
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 14088068
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1202406883239746
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.379 Vali Acc: 0.175 Test Loss: 1.379 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.2195191383361816
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.174986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.1181135177612305
Epoch: 3, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.235 Vali Acc: 0.550 Test Loss: 1.235 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.2321562767028809
Epoch: 4, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.139 Vali Acc: 0.525 Test Loss: 1.139 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.189779281616211
Epoch: 5, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.044 Vali Acc: 0.675 Test Loss: 1.044 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 1.2771222591400146
Epoch: 6, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.948 Vali Acc: 0.750 Test Loss: 0.948 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.188190221786499
Epoch: 7, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.844 Vali Acc: 0.825 Test Loss: 0.844 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 1.387610912322998
Epoch: 8, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 1.2947850227355957
Epoch: 9, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.1756556034088135
Epoch: 10, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.2704708576202393
Epoch: 11, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 1.290003776550293
Epoch: 12, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.413 Vali Acc: 0.975 Test Loss: 0.413 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 1.2650303840637207
Epoch: 13, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2729988098144531
Epoch: 14, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2913074493408203
Epoch: 15, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 1.2950239181518555
Epoch: 16, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.265 Vali Acc: 1.000 Test Loss: 0.265 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4158212
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.991046905517578
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.280 Vali Acc: 0.425 Test Loss: 1.280 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 3.0247833728790283
Epoch: 2, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 2.48535418510437
Epoch: 3, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 2.4523918628692627
Epoch: 4, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.027 Vali Acc: 0.825 Test Loss: 1.027 Test Acc: 0.825
Validation loss decreased (-0.649989 --> -0.824990).  Saving model ...
Epoch: 5 cost time: 2.6344728469848633
Epoch: 5, Steps: 3 | Train Loss: 0.967 Vali Loss: 0.899 Vali Acc: 0.850 Test Loss: 0.899 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 6 cost time: 2.7559354305267334
Epoch: 6, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 2.8014698028564453
Epoch: 7, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.646 Vali Acc: 0.925 Test Loss: 0.646 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 2.9173636436462402
Epoch: 8, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.534 Vali Acc: 0.950 Test Loss: 0.534 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 2.7786295413970947
Epoch: 9, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 2.756178379058838
Epoch: 10, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 2.804795026779175
Epoch: 11, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 2.9062576293945312
Epoch: 12, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 2.673511028289795
Epoch: 13, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 2.426861524581909
Epoch: 14, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 2.362487554550171
Epoch: 15, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 2.623026132583618
Epoch: 16, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 2.755859375
Epoch: 17, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.180 Vali Acc: 1.000 Test Loss: 0.180 Test Acc: 1.000
Validation loss decreased (-0.949998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 7058180
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8281784057617188
Epoch: 1, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.7568767070770264
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.6751198768615723
Epoch: 3, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.212 Vali Acc: 0.575 Test Loss: 1.212 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.6434252262115479
Epoch: 4, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 1.618525743484497
Epoch: 5, Steps: 3 | Train Loss: 0.938 Vali Loss: 0.989 Vali Acc: 0.775 Test Loss: 0.989 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 1.5336620807647705
Epoch: 6, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.876 Vali Acc: 0.850 Test Loss: 0.876 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 7 cost time: 1.726228952407837
Epoch: 7, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.750 Vali Acc: 0.925 Test Loss: 0.750 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924992).  Saving model ...
Epoch: 8 cost time: 1.980745553970337
Epoch: 8, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.634 Vali Acc: 0.950 Test Loss: 0.634 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 1.8827877044677734
Epoch: 9, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.525 Vali Acc: 0.975 Test Loss: 0.525 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 1.7761192321777344
Epoch: 10, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 1.7087123394012451
Epoch: 11, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4742982387542725
Epoch: 12, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.647587776184082
Epoch: 13, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.305192232131958
Epoch: 14, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.4686191082000732
Epoch: 15, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.445953130722046
Epoch: 16, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.35797119140625
Epoch: 17, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.688044786453247
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 1.6032347679138184
Epoch: 19, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 1.000 Test Loss: 0.128 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2093060
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.00767183303833
Epoch: 1, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.277 Vali Acc: 0.425 Test Loss: 1.277 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 2.075045108795166
Epoch: 2, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 1.9743402004241943
Epoch: 3, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 1.7551922798156738
Epoch: 4, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.038 Vali Acc: 0.750 Test Loss: 1.038 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 2.091505765914917
Epoch: 5, Steps: 3 | Train Loss: 1.015 Vali Loss: 0.921 Vali Acc: 0.875 Test Loss: 0.921 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 2.028404474258423
Epoch: 6, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.799 Vali Acc: 0.925 Test Loss: 0.799 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 7 cost time: 2.2374584674835205
Epoch: 7, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.676 Vali Acc: 0.950 Test Loss: 0.676 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 2.147120714187622
Epoch: 8, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.562 Vali Acc: 0.975 Test Loss: 0.562 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 1.9202945232391357
Epoch: 9, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.464 Vali Acc: 0.975 Test Loss: 0.464 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 2.192000150680542
Epoch: 10, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.379 Vali Acc: 1.000 Test Loss: 0.379 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 7058180
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4036808013916016
Epoch: 1, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.345 Vali Acc: 0.375 Test Loss: 1.345 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.5051229000091553
Epoch: 2, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.3804774284362793
Epoch: 3, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.4200425148010254
Epoch: 4, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.128 Vali Acc: 0.625 Test Loss: 1.128 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.460129976272583
Epoch: 5, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 1.609015703201294
Epoch: 6, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.910 Vali Acc: 0.825 Test Loss: 0.910 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 1.3806915283203125
Epoch: 7, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.795 Vali Acc: 0.900 Test Loss: 0.795 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 1.4631948471069336
Epoch: 8, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.693 Vali Acc: 0.925 Test Loss: 0.693 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 1.3813705444335938
Epoch: 9, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.590 Vali Acc: 1.000 Test Loss: 0.590 Test Acc: 1.000
Validation loss decreased (-0.924993 --> -0.999994).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2093060
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3042469024658203
Epoch: 1, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.257 Vali Acc: 0.475 Test Loss: 1.257 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 1.6136374473571777
Epoch: 2, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 1.3468785285949707
Epoch: 3, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 4 cost time: 1.4097084999084473
Epoch: 4, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.401808261871338
Epoch: 5, Steps: 3 | Train Loss: 1.028 Vali Loss: 0.955 Vali Acc: 0.700 Test Loss: 0.955 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.3522272109985352
Epoch: 6, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.857 Vali Acc: 0.725 Test Loss: 0.857 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.603954792022705
Epoch: 7, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 1.3270010948181152
Epoch: 8, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.3310809135437012
Epoch: 9, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.567 Vali Acc: 0.925 Test Loss: 0.567 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.1965889930725098
Epoch: 10, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.493 Vali Acc: 0.975 Test Loss: 0.493 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 1.1938402652740479
Epoch: 11, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.436 Vali Acc: 0.975 Test Loss: 0.436 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 1.2994372844696045
Epoch: 12, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.558703899383545
Epoch: 13, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 1.613572359085083
Epoch: 14, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.314 Vali Acc: 1.000 Test Loss: 0.314 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 7058180
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.028099775314331
Epoch: 1, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.367 Vali Acc: 0.325 Test Loss: 1.367 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.2819232940673828
Epoch: 2, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 1.0466866493225098
Epoch: 3, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.266 Vali Acc: 0.425 Test Loss: 1.266 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.087782859802246
Epoch: 4, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1111743450164795
Epoch: 5, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
Validation loss decreased (-0.499988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 1.1826562881469727
Epoch: 6, Steps: 3 | Train Loss: 0.915 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 1.111029863357544
Epoch: 7, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 1.0828449726104736
Epoch: 8, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 1.2369945049285889
Epoch: 9, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 1.127671241760254
Epoch: 10, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.9985320568084717
Epoch: 11, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.530 Vali Acc: 0.950 Test Loss: 0.530 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.9239981174468994
Epoch: 12, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.429 Vali Acc: 0.975 Test Loss: 0.429 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 1.1534605026245117
Epoch: 13, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 1.20192289352417
Epoch: 14, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.2268524169921875
Epoch: 15, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.9799716472625732
Epoch: 16, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 1.05499267578125
Epoch: 17, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.241 Vali Acc: 1.000 Test Loss: 0.241 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2093060
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.29412579536438
Epoch: 1, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.234 Vali Acc: 0.575 Test Loss: 1.234 Test Acc: 0.575
Validation loss decreased (inf --> -0.574988).  Saving model ...
Epoch: 2 cost time: 1.9036154747009277
Epoch: 2, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.201 Vali Acc: 0.625 Test Loss: 1.201 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.8910770416259766
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.131 Vali Acc: 0.725 Test Loss: 1.131 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724989).  Saving model ...
Epoch: 4 cost time: 2.170797348022461
Epoch: 4, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.041 Vali Acc: 0.725 Test Loss: 1.041 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 2.0902512073516846
Epoch: 5, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.942 Vali Acc: 0.800 Test Loss: 0.942 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 2.4702816009521484
Epoch: 6, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 2.174900770187378
Epoch: 7, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 1.9540021419525146
Epoch: 8, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.646 Vali Acc: 0.925 Test Loss: 0.646 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 1.956094741821289
Epoch: 9, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.550 Vali Acc: 0.975 Test Loss: 0.550 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 2.2618794441223145
Epoch: 10, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 2.268125295639038
Epoch: 11, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.385 Vali Acc: 0.975 Test Loss: 0.385 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 1.9420835971832275
Epoch: 12, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.956009864807129
Epoch: 13, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.285 Vali Acc: 1.000 Test Loss: 0.285 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 7045188
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.360201597213745
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.424 Vali Acc: 0.375 Test Loss: 1.424 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.4547204971313477
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.395 Vali Acc: 0.375 Test Loss: 1.395 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.3193159103393555
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.347 Vali Acc: 0.375 Test Loss: 1.347 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.1225504875183105
Epoch: 4, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.285 Vali Acc: 0.375 Test Loss: 1.285 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.3114116191864014
Epoch: 5, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.2641396522521973
Epoch: 6, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.130 Vali Acc: 0.700 Test Loss: 1.130 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 1.2169358730316162
Epoch: 7, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.043 Vali Acc: 0.800 Test Loss: 1.043 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 1.372488260269165
Epoch: 8, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.947 Vali Acc: 0.850 Test Loss: 0.947 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 1.177213191986084
Epoch: 9, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.853 Vali Acc: 0.850 Test Loss: 0.853 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 1.439906358718872
Epoch: 10, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.204009771347046
Epoch: 11, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 1.4029066562652588
Epoch: 12, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 1.4390861988067627
Epoch: 13, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.492 Vali Acc: 0.975 Test Loss: 0.492 Test Acc: 0.975
Validation loss decreased (-0.874994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 1.2526049613952637
Epoch: 14, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.437 Vali Acc: 1.000 Test Loss: 0.437 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2079876
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.6507067680358887
Epoch: 1, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.232 Vali Acc: 0.600 Test Loss: 1.232 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 1.4263701438903809
Epoch: 2, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.199 Vali Acc: 0.625 Test Loss: 1.199 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.4356703758239746
Epoch: 3, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.133 Vali Acc: 0.700 Test Loss: 1.133 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 1.447103500366211
Epoch: 4, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.047 Vali Acc: 0.700 Test Loss: 1.047 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 1.6199331283569336
Epoch: 5, Steps: 3 | Train Loss: 0.966 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.613426685333252
Epoch: 6, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.71107816696167
Epoch: 7, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.761 Vali Acc: 0.875 Test Loss: 0.761 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 1.701808214187622
Epoch: 8, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.660 Vali Acc: 0.925 Test Loss: 0.660 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 1.556166172027588
Epoch: 9, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.579 Vali Acc: 0.975 Test Loss: 0.579 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 1.6272673606872559
Epoch: 10, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.694575548171997
Epoch: 11, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.449 Vali Acc: 0.975 Test Loss: 0.449 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 1.6027922630310059
Epoch: 12, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.397 Vali Acc: 1.000 Test Loss: 0.397 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 7045188
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.180001735687256
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.442 Vali Acc: 0.400 Test Loss: 1.442 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.193880558013916
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.2558989524841309
Epoch: 3, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.1730561256408691
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.299 Vali Acc: 0.425 Test Loss: 1.299 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.1474826335906982
Epoch: 5, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
Validation loss decreased (-0.424987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 1.0891201496124268
Epoch: 6, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.140 Vali Acc: 0.675 Test Loss: 1.140 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.1399540901184082
Epoch: 7, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 1.0944607257843018
Epoch: 8, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 1.1507322788238525
Epoch: 9, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.898 Vali Acc: 0.750 Test Loss: 0.898 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.1345491409301758
Epoch: 10, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 1.077721357345581
Epoch: 11, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.0619144439697266
Epoch: 12, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.799993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.1781647205352783
Epoch: 13, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 1.1051445007324219
Epoch: 14, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.523 Vali Acc: 0.975 Test Loss: 0.523 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 1.1483604907989502
Epoch: 15, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.474 Vali Acc: 1.000 Test Loss: 0.474 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2079876
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.415911912918091
Epoch: 1, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.234 Vali Acc: 0.575 Test Loss: 1.234 Test Acc: 0.575
Validation loss decreased (inf --> -0.574988).  Saving model ...
Epoch: 2 cost time: 1.0981581211090088
Epoch: 2, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.201 Vali Acc: 0.575 Test Loss: 1.201 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 1.1291077136993408
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 1.2732269763946533
Epoch: 4, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.2829270362854004
Epoch: 5, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 1.2392082214355469
Epoch: 6, Steps: 3 | Train Loss: 0.900 Vali Loss: 0.934 Vali Acc: 0.650 Test Loss: 0.934 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 7 cost time: 1.14961838722229
Epoch: 7, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.861 Vali Acc: 0.675 Test Loss: 0.861 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 8 cost time: 1.1793510913848877
Epoch: 8, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.674991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 1.0579066276550293
Epoch: 9, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.2290990352630615
Epoch: 10, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.2800312042236328
Epoch: 11, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.585 Vali Acc: 0.925 Test Loss: 0.585 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 1.190037488937378
Epoch: 12, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2343964576721191
Epoch: 13, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2186062335968018
Epoch: 14, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2697293758392334
Epoch: 15, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.426628828048706
Epoch: 16, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 1.2006447315216064
Epoch: 17, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.147707223892212
Epoch: 18, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0521552562713623
Epoch: 19, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.319 Vali Acc: 1.000 Test Loss: 0.319 Test Acc: 1.000
Validation loss decreased (-0.949996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 7045188
model size : 27.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.94111967086792
Epoch: 1, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.411 Vali Acc: 0.425 Test Loss: 1.411 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.9907798767089844
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.381 Vali Acc: 0.425 Test Loss: 1.381 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.921799898147583
Epoch: 3, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.328 Vali Acc: 0.550 Test Loss: 1.328 Test Acc: 0.550
Validation loss decreased (-0.424986 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.8979289531707764
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.268 Vali Acc: 0.600 Test Loss: 1.268 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.9099130630493164
Epoch: 5, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.203 Vali Acc: 0.625 Test Loss: 1.203 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.8440296649932861
Epoch: 6, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.143 Vali Acc: 0.625 Test Loss: 1.143 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.0118203163146973
Epoch: 7, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.910426139831543
Epoch: 8, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.9755792617797852
Epoch: 9, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 10 cost time: 0.9514954090118408
Epoch: 10, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.8533351421356201
Epoch: 11, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 12 cost time: 0.9218711853027344
Epoch: 12, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
Validation loss decreased (-0.724992 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 0.906752347946167
Epoch: 13, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.656 Vali Acc: 0.800 Test Loss: 0.656 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 0.8837051391601562
Epoch: 14, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.871619701385498
Epoch: 15, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.9052078723907471
Epoch: 16, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.9912362098693848
Epoch: 17, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.9063296318054199
Epoch: 18, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 1.0047235488891602
Epoch: 19, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 0.9665126800537109
Epoch: 20, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.9181506633758545
Epoch: 21, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 1.0243804454803467
Epoch: 22, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.858536958694458
Epoch: 23, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8997859954833984
Epoch: 24, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0634615421295166
Epoch: 25, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9996516704559326
Epoch: 26, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.317 Vali Acc: 1.000 Test Loss: 0.317 Test Acc: 1.000
Validation loss decreased (-0.949996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2079876
model size : 8.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.059032201766968
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.453 Vali Acc: 0.175 Test Loss: 1.453 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 2.0005321502685547
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (-0.174985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 2.066606283187866
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.8739299774169922
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.6776914596557617
Epoch: 5, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.232 Vali Acc: 0.575 Test Loss: 1.232 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.7192513942718506
Epoch: 6, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.149 Vali Acc: 0.675 Test Loss: 1.149 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.7596006393432617
Epoch: 7, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.059 Vali Acc: 0.725 Test Loss: 1.059 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 8 cost time: 1.7551486492156982
Epoch: 8, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.970 Vali Acc: 0.775 Test Loss: 0.970 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.684981107711792
Epoch: 9, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 1.7896356582641602
Epoch: 10, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.729252576828003
Epoch: 11, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.704 Vali Acc: 0.950 Test Loss: 0.704 Test Acc: 0.950
Validation loss decreased (-0.849992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 1.7793734073638916
Epoch: 12, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.629 Vali Acc: 0.950 Test Loss: 0.629 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 1.7180209159851074
Epoch: 13, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.560 Vali Acc: 0.975 Test Loss: 0.560 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 1.6746242046356201
Epoch: 14, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.499 Vali Acc: 0.975 Test Loss: 0.499 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 1.570014476776123
Epoch: 15, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 1.000 Test Loss: 0.421 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 3529668
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.403027296066284
Epoch: 1, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.3876471519470215
Epoch: 2, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.335 Vali Acc: 0.300 Test Loss: 1.335 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 1.2629120349884033
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.290 Vali Acc: 0.375 Test Loss: 1.290 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.27839994430542
Epoch: 4, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.229 Vali Acc: 0.600 Test Loss: 1.229 Test Acc: 0.600
Validation loss decreased (-0.374987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.363910436630249
Epoch: 5, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.157 Vali Acc: 0.725 Test Loss: 1.157 Test Acc: 0.725
Validation loss decreased (-0.599988 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 1.2698309421539307
Epoch: 6, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.078 Vali Acc: 0.725 Test Loss: 1.078 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 1.3938682079315186
Epoch: 7, Steps: 3 | Train Loss: 0.939 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.353135585784912
Epoch: 8, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 1.4137659072875977
Epoch: 9, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 1.20025634765625
Epoch: 10, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 1.186638593673706
Epoch: 11, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 1.206676959991455
Epoch: 12, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 1.1918511390686035
Epoch: 13, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.504 Vali Acc: 0.925 Test Loss: 0.504 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 1.332979440689087
Epoch: 14, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 1.1575965881347656
Epoch: 15, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 1.2075598239898682
Epoch: 16, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 1.3412916660308838
Epoch: 17, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 1.2529690265655518
Epoch: 18, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.3362083435058594
Epoch: 19, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 1.0520799160003662
Epoch: 20, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 1.1653387546539307
Epoch: 21, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 1.326096773147583
Epoch: 22, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.202 Vali Acc: 1.000 Test Loss: 0.202 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1046916
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3406593799591064
Epoch: 1, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.456 Vali Acc: 0.200 Test Loss: 1.456 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.5790047645568848
Epoch: 2, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.428 Vali Acc: 0.325 Test Loss: 1.428 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.3238208293914795
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.384 Vali Acc: 0.450 Test Loss: 1.384 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 1.6750147342681885
Epoch: 4, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.5276634693145752
Epoch: 5, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 1.5918147563934326
Epoch: 6, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.185 Vali Acc: 0.650 Test Loss: 1.185 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 1.5373587608337402
Epoch: 7, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.108 Vali Acc: 0.675 Test Loss: 1.108 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 1.6293895244598389
Epoch: 8, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.495091438293457
Epoch: 9, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.966 Vali Acc: 0.675 Test Loss: 0.966 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 1.3718323707580566
Epoch: 10, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.4281630516052246
Epoch: 11, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.797 Vali Acc: 0.825 Test Loss: 0.797 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 1.21431565284729
Epoch: 12, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.4288074970245361
Epoch: 13, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 1.5467548370361328
Epoch: 14, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 1.5135624408721924
Epoch: 15, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 1.4735190868377686
Epoch: 16, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 1.4535198211669922
Epoch: 17, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 1.404017686843872
Epoch: 18, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.5266399383544922
Epoch: 19, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 1.4155306816101074
Epoch: 20, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.275 Vali Acc: 1.000 Test Loss: 0.275 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 3529668
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3253531455993652
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.348 Vali Acc: 0.325 Test Loss: 1.348 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 1.150367259979248
Epoch: 2, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.320 Vali Acc: 0.300 Test Loss: 1.320 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2639119625091553
Epoch: 3, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.1903820037841797
Epoch: 4, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.222 Vali Acc: 0.650 Test Loss: 1.222 Test Acc: 0.650
Validation loss decreased (-0.399987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.1553797721862793
Epoch: 5, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.157 Vali Acc: 0.700 Test Loss: 1.157 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 6 cost time: 1.0829312801361084
Epoch: 6, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 1.2444934844970703
Epoch: 7, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 1.0584211349487305
Epoch: 8, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 1.1731829643249512
Epoch: 9, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.851 Vali Acc: 0.750 Test Loss: 0.851 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.1561195850372314
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.771 Vali Acc: 0.800 Test Loss: 0.771 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.2178478240966797
Epoch: 11, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.1169207096099854
Epoch: 12, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.623 Vali Acc: 0.900 Test Loss: 0.623 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.1345844268798828
Epoch: 13, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.9643607139587402
Epoch: 14, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.9931042194366455
Epoch: 15, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 1.0902931690216064
Epoch: 16, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 1.1319057941436768
Epoch: 17, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.0728447437286377
Epoch: 18, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 1.0846812725067139
Epoch: 19, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.0666813850402832
Epoch: 20, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 1.0656459331512451
Epoch: 21, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.253 Vali Acc: 1.000 Test Loss: 0.253 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1046916
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7986514568328857
Epoch: 1, Steps: 3 | Train Loss: 1.504 Vali Loss: 1.459 Vali Acc: 0.175 Test Loss: 1.459 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.9984743595123291
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.428 Vali Acc: 0.175 Test Loss: 1.428 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.1476151943206787
Epoch: 3, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.379 Vali Acc: 0.250 Test Loss: 1.379 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.1601483821868896
Epoch: 4, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (-0.249986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.9817419052124023
Epoch: 5, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.261 Vali Acc: 0.425 Test Loss: 1.261 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.1632277965545654
Epoch: 6, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.0670483112335205
Epoch: 7, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.138 Vali Acc: 0.575 Test Loss: 1.138 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.240023136138916
Epoch: 8, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.074 Vali Acc: 0.575 Test Loss: 1.074 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.2066636085510254
Epoch: 9, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.006 Vali Acc: 0.650 Test Loss: 1.006 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.1912107467651367
Epoch: 10, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.924 Vali Acc: 0.675 Test Loss: 0.924 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 11 cost time: 1.0505642890930176
Epoch: 11, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 1.1848394870758057
Epoch: 12, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 1.090181827545166
Epoch: 13, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.724 Vali Acc: 0.825 Test Loss: 0.724 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.0402007102966309
Epoch: 14, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 1.0120880603790283
Epoch: 15, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 1.1057755947113037
Epoch: 16, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 1.1375279426574707
Epoch: 17, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 1.1479895114898682
Epoch: 18, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 1.1545612812042236
Epoch: 19, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 1.2030162811279297
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 1.1019880771636963
Epoch: 21, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 1.1344740390777588
Epoch: 22, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0929667949676514
Epoch: 23, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0341119766235352
Epoch: 24, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.0646681785583496
Epoch: 25, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 1.1715338230133057
Epoch: 26, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1633834838867188
Epoch: 27, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0622096061706543
Epoch: 28, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1519362926483154
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 1.2367453575134277
Epoch: 30, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3529668
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0053465366363525
Epoch: 1, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.343 Vali Acc: 0.250 Test Loss: 1.343 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.926109790802002
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.315 Vali Acc: 0.300 Test Loss: 1.315 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.8987469673156738
Epoch: 3, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.9494023323059082
Epoch: 4, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
Validation loss decreased (-0.349987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.016371488571167
Epoch: 5, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.178 Vali Acc: 0.675 Test Loss: 1.178 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 0.901533842086792
Epoch: 6, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.9422845840454102
Epoch: 7, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.042 Vali Acc: 0.675 Test Loss: 1.042 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 1.0071351528167725
Epoch: 8, Steps: 3 | Train Loss: 0.878 Vali Loss: 0.967 Vali Acc: 0.700 Test Loss: 0.967 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.9118754863739014
Epoch: 9, Steps: 3 | Train Loss: 0.738 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.041733741760254
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.802 Vali Acc: 0.775 Test Loss: 0.802 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 0.7890346050262451
Epoch: 11, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 0.8882486820220947
Epoch: 12, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.653 Vali Acc: 0.825 Test Loss: 0.653 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 0.9509329795837402
Epoch: 13, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.586 Vali Acc: 0.825 Test Loss: 0.586 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 0.9133729934692383
Epoch: 14, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7903506755828857
Epoch: 15, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.494 Vali Acc: 0.825 Test Loss: 0.494 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 16 cost time: 0.8752124309539795
Epoch: 16, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.824995 --> -0.874996).  Saving model ...
Epoch: 17 cost time: 1.072265863418579
Epoch: 17, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.874996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.9164233207702637
Epoch: 18, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.9021520614624023
Epoch: 19, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 1.0001170635223389
Epoch: 20, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.9347531795501709
Epoch: 21, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.1144886016845703
Epoch: 22, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.9857969284057617
Epoch: 23, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.9251883029937744
Epoch: 24, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.9518651962280273
Epoch: 25, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.9226045608520508
Epoch: 26, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.234 Vali Acc: 1.000 Test Loss: 0.234 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1046916
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.483680248260498
Epoch: 1, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.498 Vali Acc: 0.325 Test Loss: 1.498 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.4274466037750244
Epoch: 2, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.466 Vali Acc: 0.325 Test Loss: 1.466 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 1.3564512729644775
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.421 Vali Acc: 0.350 Test Loss: 1.421 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.365624189376831
Epoch: 4, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 1.4209249019622803
Epoch: 5, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.290 Vali Acc: 0.475 Test Loss: 1.290 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4463918209075928
Epoch: 6, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.499986 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 1.5544800758361816
Epoch: 7, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.134 Vali Acc: 0.675 Test Loss: 1.134 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 1.3982336521148682
Epoch: 8, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.052 Vali Acc: 0.725 Test Loss: 1.052 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 1.382404088973999
Epoch: 9, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.962 Vali Acc: 0.850 Test Loss: 0.962 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849990).  Saving model ...
Epoch: 10 cost time: 1.5129835605621338
Epoch: 10, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.874 Vali Acc: 0.875 Test Loss: 0.874 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 1.4794576168060303
Epoch: 11, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.783 Vali Acc: 0.900 Test Loss: 0.783 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 1.3892371654510498
Epoch: 12, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.699 Vali Acc: 0.950 Test Loss: 0.699 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 1.328925371170044
Epoch: 13, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.620 Vali Acc: 0.950 Test Loss: 0.620 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 1.3437790870666504
Epoch: 14, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.541 Vali Acc: 0.950 Test Loss: 0.541 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.3354201316833496
Epoch: 15, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.473 Vali Acc: 1.000 Test Loss: 0.473 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1771908
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2144572734832764
Epoch: 1, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.448 Vali Acc: 0.050 Test Loss: 1.448 Test Acc: 0.050
Validation loss decreased (inf --> -0.049986).  Saving model ...
Epoch: 2 cost time: 1.1625735759735107
Epoch: 2, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.421 Vali Acc: 0.075 Test Loss: 1.421 Test Acc: 0.075
Validation loss decreased (-0.049986 --> -0.074986).  Saving model ...
Epoch: 3 cost time: 1.1887085437774658
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.385 Vali Acc: 0.125 Test Loss: 1.385 Test Acc: 0.125
Validation loss decreased (-0.074986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.9966187477111816
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.338 Vali Acc: 0.275 Test Loss: 1.338 Test Acc: 0.275
Validation loss decreased (-0.124986 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 1.1342182159423828
Epoch: 5, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
Validation loss decreased (-0.274987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.2449727058410645
Epoch: 6, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.228 Vali Acc: 0.625 Test Loss: 1.228 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 1.1276698112487793
Epoch: 7, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.171 Vali Acc: 0.625 Test Loss: 1.171 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 1.105375051498413
Epoch: 8, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 1.0971052646636963
Epoch: 9, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.029341459274292
Epoch: 10, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.944 Vali Acc: 0.850 Test Loss: 0.944 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.9355001449584961
Epoch: 11, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.859 Vali Acc: 0.900 Test Loss: 0.859 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 0.9969849586486816
Epoch: 12, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.773 Vali Acc: 0.925 Test Loss: 0.773 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 13 cost time: 0.9708456993103027
Epoch: 13, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.690 Vali Acc: 0.975 Test Loss: 0.690 Test Acc: 0.975
Validation loss decreased (-0.924992 --> -0.974993).  Saving model ...
Epoch: 14 cost time: 1.0188205242156982
Epoch: 14, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.615 Vali Acc: 0.975 Test Loss: 0.615 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 15 cost time: 1.101243019104004
Epoch: 15, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.549 Vali Acc: 0.975 Test Loss: 0.549 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 1.1610095500946045
Epoch: 16, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.491 Vali Acc: 0.975 Test Loss: 0.491 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 1.148066520690918
Epoch: 17, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.446 Vali Acc: 0.975 Test Loss: 0.446 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 1.1424036026000977
Epoch: 18, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.409 Vali Acc: 1.000 Test Loss: 0.409 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 530436
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2123019695281982
Epoch: 1, Steps: 3 | Train Loss: 1.522 Vali Loss: 1.496 Vali Acc: 0.325 Test Loss: 1.496 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.1514616012573242
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.465 Vali Acc: 0.325 Test Loss: 1.465 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 1.2063829898834229
Epoch: 3, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.419 Vali Acc: 0.350 Test Loss: 1.419 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.108625888824463
Epoch: 4, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.128615140914917
Epoch: 5, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.1467525959014893
Epoch: 6, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 1.1293971538543701
Epoch: 7, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.1067259311676025
Epoch: 8, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 1.1769793033599854
Epoch: 9, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.981 Vali Acc: 0.725 Test Loss: 0.981 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 1.2439866065979004
Epoch: 10, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.900 Vali Acc: 0.875 Test Loss: 0.900 Test Acc: 0.875
Validation loss decreased (-0.724990 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 1.0145134925842285
Epoch: 11, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.812 Vali Acc: 0.875 Test Loss: 0.812 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 1.0725560188293457
Epoch: 12, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.733 Vali Acc: 0.875 Test Loss: 0.733 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 1.031710147857666
Epoch: 13, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.660 Vali Acc: 0.950 Test Loss: 0.660 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949993).  Saving model ...
Epoch: 14 cost time: 1.013106107711792
Epoch: 14, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.594 Vali Acc: 0.950 Test Loss: 0.594 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 1.2615244388580322
Epoch: 15, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.535 Vali Acc: 0.950 Test Loss: 0.535 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 1.1645288467407227
Epoch: 16, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 1.1115226745605469
Epoch: 17, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 1.0459237098693848
Epoch: 18, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.397 Vali Acc: 1.000 Test Loss: 0.397 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1771908
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0640416145324707
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.457 Vali Acc: 0.050 Test Loss: 1.457 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 1.1240007877349854
Epoch: 2, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.431 Vali Acc: 0.050 Test Loss: 1.431 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049986).  Saving model ...
Epoch: 3 cost time: 1.0508599281311035
Epoch: 3, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.398 Vali Acc: 0.175 Test Loss: 1.398 Test Acc: 0.175
Validation loss decreased (-0.049986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.9835293292999268
Epoch: 4, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.355 Vali Acc: 0.250 Test Loss: 1.355 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.0248234272003174
Epoch: 5, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.304 Vali Acc: 0.425 Test Loss: 1.304 Test Acc: 0.425
Validation loss decreased (-0.249986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.9532554149627686
Epoch: 6, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.0285401344299316
Epoch: 7, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.185 Vali Acc: 0.575 Test Loss: 1.185 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.9849820137023926
Epoch: 8, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.0314888954162598
Epoch: 9, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.051 Vali Acc: 0.725 Test Loss: 1.051 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 1.1516683101654053
Epoch: 10, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.976 Vali Acc: 0.800 Test Loss: 0.976 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.995736837387085
Epoch: 11, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.899 Vali Acc: 0.825 Test Loss: 0.899 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 1.087993860244751
Epoch: 12, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.817 Vali Acc: 0.875 Test Loss: 0.817 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 1.0500071048736572
Epoch: 13, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.737 Vali Acc: 0.925 Test Loss: 0.737 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 14 cost time: 1.1035232543945312
Epoch: 14, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.655 Vali Acc: 0.975 Test Loss: 0.655 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974993).  Saving model ...
Epoch: 15 cost time: 1.0804429054260254
Epoch: 15, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.588 Vali Acc: 0.975 Test Loss: 0.588 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 16 cost time: 0.8971221446990967
Epoch: 16, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.530 Vali Acc: 0.975 Test Loss: 0.530 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 1.0403754711151123
Epoch: 17, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.480 Vali Acc: 0.975 Test Loss: 0.480 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 1.1156141757965088
Epoch: 18, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.436 Vali Acc: 1.000 Test Loss: 0.436 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 530436
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.984990358352661
Epoch: 1, Steps: 3 | Train Loss: 1.525 Vali Loss: 1.504 Vali Acc: 0.300 Test Loss: 1.504 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.931072473526001
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.474 Vali Acc: 0.300 Test Loss: 1.474 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.8857953548431396
Epoch: 3, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.431 Vali Acc: 0.325 Test Loss: 1.431 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8626730442047119
Epoch: 4, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.8205580711364746
Epoch: 5, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.0213418006896973
Epoch: 6, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.256 Vali Acc: 0.425 Test Loss: 1.256 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.9927151203155518
Epoch: 7, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 1.096956491470337
Epoch: 8, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.967869758605957
Epoch: 9, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.9882333278656006
Epoch: 10, Steps: 3 | Train Loss: 0.842 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.0692880153656006
Epoch: 11, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.9327638149261475
Epoch: 12, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 0.9523005485534668
Epoch: 13, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 1.009108543395996
Epoch: 14, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 0.9323930740356445
Epoch: 15, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 0.9171814918518066
Epoch: 16, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 1.0018765926361084
Epoch: 17, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.526 Vali Acc: 0.925 Test Loss: 0.526 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 1.007582664489746
Epoch: 18, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.488 Vali Acc: 0.925 Test Loss: 0.488 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 1.1033854484558105
Epoch: 19, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.9619207382202148
Epoch: 20, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 1.0512125492095947
Epoch: 21, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9703366756439209
Epoch: 22, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2106547355651855
Epoch: 23, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0898847579956055
Epoch: 24, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.328 Vali Acc: 0.975 Test Loss: 0.328 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 1.0152041912078857
Epoch: 25, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.298 Vali Acc: 1.000 Test Loss: 0.298 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1771908
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.83720064163208
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.449 Vali Acc: 0.125 Test Loss: 1.449 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.8706369400024414
Epoch: 2, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.422 Vali Acc: 0.125 Test Loss: 1.422 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 3 cost time: 0.8764770030975342
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.387 Vali Acc: 0.175 Test Loss: 1.387 Test Acc: 0.175
Validation loss decreased (-0.124986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.8887410163879395
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.343 Vali Acc: 0.400 Test Loss: 1.343 Test Acc: 0.400
Validation loss decreased (-0.174986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.9032573699951172
Epoch: 5, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.8505303859710693
Epoch: 6, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9098374843597412
Epoch: 7, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.8940815925598145
Epoch: 8, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.881782054901123
Epoch: 9, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.9468696117401123
Epoch: 10, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.938107967376709
Epoch: 11, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.8859384059906006
Epoch: 12, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.861 Vali Acc: 0.825 Test Loss: 0.861 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.9126489162445068
Epoch: 13, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.786 Vali Acc: 0.925 Test Loss: 0.786 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924992).  Saving model ...
Epoch: 14 cost time: 0.8978793621063232
Epoch: 14, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.717 Vali Acc: 0.950 Test Loss: 0.717 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 15 cost time: 0.8085041046142578
Epoch: 15, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.656 Vali Acc: 0.950 Test Loss: 0.656 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 16 cost time: 1.060633897781372
Epoch: 16, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.603 Vali Acc: 0.950 Test Loss: 0.603 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 1.0181474685668945
Epoch: 17, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.555 Vali Acc: 0.975 Test Loss: 0.555 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 18 cost time: 0.9427328109741211
Epoch: 18, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8259134292602539
Epoch: 19, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9909334182739258
Epoch: 20, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.456 Vali Acc: 0.925 Test Loss: 0.456 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9623825550079346
Epoch: 21, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9291670322418213
Epoch: 22, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9239768981933594
Epoch: 23, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 1.0937018394470215
Epoch: 24, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.9744918346405029
Epoch: 25, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.309 Vali Acc: 1.000 Test Loss: 0.309 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 530436
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.8348746299743652
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.452 Vali Acc: 0.275 Test Loss: 1.452 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.5688037872314453
Epoch: 2, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.439 Vali Acc: 0.275 Test Loss: 1.439 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.4479846954345703
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.420 Vali Acc: 0.300 Test Loss: 1.420 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.6309163570404053
Epoch: 4, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.397 Vali Acc: 0.350 Test Loss: 1.397 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.507237195968628
Epoch: 5, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.4495763778686523
Epoch: 6, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.547532081604004
Epoch: 7, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.299 Vali Acc: 0.475 Test Loss: 1.299 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 1.5444824695587158
Epoch: 8, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.4885647296905518
Epoch: 9, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.207 Vali Acc: 0.575 Test Loss: 1.207 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 1.4546244144439697
Epoch: 10, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.156 Vali Acc: 0.625 Test Loss: 1.156 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 1.442667007446289
Epoch: 11, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.5497701168060303
Epoch: 12, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.036 Vali Acc: 0.675 Test Loss: 1.036 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 1.5914537906646729
Epoch: 13, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.963 Vali Acc: 0.700 Test Loss: 0.963 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.4818024635314941
Epoch: 14, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.4285013675689697
Epoch: 15, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 1.328989028930664
Epoch: 16, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.764 Vali Acc: 0.875 Test Loss: 0.764 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 1.334707498550415
Epoch: 17, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.694 Vali Acc: 0.900 Test Loss: 0.694 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 1.5167200565338135
Epoch: 18, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.640 Vali Acc: 0.925 Test Loss: 0.640 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 1.6219377517700195
Epoch: 19, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.592 Vali Acc: 0.950 Test Loss: 0.592 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 20 cost time: 1.4681611061096191
Epoch: 20, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.549 Vali Acc: 0.975 Test Loss: 0.549 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 1.383660078048706
Epoch: 21, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.516 Vali Acc: 0.975 Test Loss: 0.516 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 1.613736629486084
Epoch: 22, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.474 Vali Acc: 0.975 Test Loss: 0.474 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 1.6089577674865723
Epoch: 23, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.422 Vali Acc: 0.975 Test Loss: 0.422 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 1.5002248287200928
Epoch: 24, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 1.3421666622161865
Epoch: 25, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.340 Vali Acc: 0.975 Test Loss: 0.340 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 1.4355785846710205
Epoch: 26, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 1.3462164402008057
Epoch: 27, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 1.3373217582702637
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 1.3142805099487305
Epoch: 29, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.3661456108093262
Epoch: 30, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1765412
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.960472345352173
Epoch: 1, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.307 Vali Acc: 0.375 Test Loss: 1.307 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.0668025016784668
Epoch: 2, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.289 Vali Acc: 0.375 Test Loss: 1.289 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.1686697006225586
Epoch: 3, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.267 Vali Acc: 0.375 Test Loss: 1.267 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.1441490650177002
Epoch: 4, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.1058084964752197
Epoch: 5, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.1661620140075684
Epoch: 6, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.162 Vali Acc: 0.525 Test Loss: 1.162 Test Acc: 0.525
Validation loss decreased (-0.399988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.0209548473358154
Epoch: 7, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.9837613105773926
Epoch: 8, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.074 Vali Acc: 0.675 Test Loss: 1.074 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 1.0327181816101074
Epoch: 9, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1075665950775146
Epoch: 10, Steps: 3 | Train Loss: 0.914 Vali Loss: 0.973 Vali Acc: 0.725 Test Loss: 0.973 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.0796265602111816
Epoch: 11, Steps: 3 | Train Loss: 0.838 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.0981101989746094
Epoch: 12, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 1.1261093616485596
Epoch: 13, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.817 Vali Acc: 0.825 Test Loss: 0.817 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.9844651222229004
Epoch: 14, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 1.0876173973083496
Epoch: 15, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 1.1339430809020996
Epoch: 16, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.1348538398742676
Epoch: 17, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 1.1023752689361572
Epoch: 18, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.563 Vali Acc: 0.925 Test Loss: 0.563 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 1.0205738544464111
Epoch: 19, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.521 Vali Acc: 0.925 Test Loss: 0.521 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 1.0298635959625244
Epoch: 20, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 1.0183994770050049
Epoch: 21, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.1238341331481934
Epoch: 22, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 1.0435130596160889
Epoch: 23, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.9924945831298828
Epoch: 24, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 1.027726173400879
Epoch: 25, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.370 Vali Acc: 0.975 Test Loss: 0.370 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.9986677169799805
Epoch: 26, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.352 Vali Acc: 0.975 Test Loss: 0.352 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 1.0189614295959473
Epoch: 27, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.9514632225036621
Epoch: 28, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.9236502647399902
Epoch: 29, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.0148987770080566
Epoch: 30, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 523844
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1221060752868652
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.459 Vali Acc: 0.275 Test Loss: 1.459 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.1157023906707764
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.446 Vali Acc: 0.275 Test Loss: 1.446 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.204923152923584
Epoch: 3, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.429 Vali Acc: 0.300 Test Loss: 1.429 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.3058812618255615
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.405 Vali Acc: 0.325 Test Loss: 1.405 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.235234260559082
Epoch: 5, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.2215416431427002
Epoch: 6, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.283825159072876
Epoch: 7, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.310 Vali Acc: 0.425 Test Loss: 1.310 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.2437796592712402
Epoch: 8, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.2970447540283203
Epoch: 9, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 1.262481451034546
Epoch: 10, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 1.223757266998291
Epoch: 11, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.1471233367919922
Epoch: 12, Steps: 3 | Train Loss: 0.844 Vali Loss: 1.065 Vali Acc: 0.625 Test Loss: 1.065 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.2346165180206299
Epoch: 13, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.994 Vali Acc: 0.650 Test Loss: 0.994 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 1.1501054763793945
Epoch: 14, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.143859624862671
Epoch: 15, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 1.1921601295471191
Epoch: 16, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.818 Vali Acc: 0.775 Test Loss: 0.818 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 1.1412465572357178
Epoch: 17, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.0843288898468018
Epoch: 18, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.1029362678527832
Epoch: 19, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.1207125186920166
Epoch: 20, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.1802265644073486
Epoch: 21, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 1.1784040927886963
Epoch: 22, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.180799961090088
Epoch: 23, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.1523957252502441
Epoch: 24, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.0739436149597168
Epoch: 25, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.122983694076538
Epoch: 26, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.15728759765625
Epoch: 27, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.374 Vali Acc: 0.975 Test Loss: 0.374 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 1.1826207637786865
Epoch: 28, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 1.1690645217895508
Epoch: 29, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.154895544052124
Epoch: 30, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1765412
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.048927068710327
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.297 Vali Acc: 0.375 Test Loss: 1.297 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.8822290897369385
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.279 Vali Acc: 0.375 Test Loss: 1.279 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0362217426300049
Epoch: 3, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.259 Vali Acc: 0.375 Test Loss: 1.259 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.9903175830841064
Epoch: 4, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.231 Vali Acc: 0.425 Test Loss: 1.231 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 1.0230531692504883
Epoch: 5, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.196 Vali Acc: 0.450 Test Loss: 1.196 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.9119834899902344
Epoch: 6, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.160 Vali Acc: 0.475 Test Loss: 1.160 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.9357945919036865
Epoch: 7, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.118 Vali Acc: 0.550 Test Loss: 1.118 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.9624006748199463
Epoch: 8, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.044919729232788
Epoch: 9, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.013 Vali Acc: 0.700 Test Loss: 1.013 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.9928035736083984
Epoch: 10, Steps: 3 | Train Loss: 0.903 Vali Loss: 0.964 Vali Acc: 0.775 Test Loss: 0.964 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 0.859389066696167
Epoch: 11, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.9967045783996582
Epoch: 12, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 1.0754814147949219
Epoch: 13, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.029700756072998
Epoch: 14, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 1.0295825004577637
Epoch: 15, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.945303201675415
Epoch: 16, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.664 Vali Acc: 0.825 Test Loss: 0.664 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 17 cost time: 0.9903774261474609
Epoch: 17, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 1.03358793258667
Epoch: 18, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.0505552291870117
Epoch: 19, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 1.0750181674957275
Epoch: 20, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.9977679252624512
Epoch: 21, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.493 Vali Acc: 0.925 Test Loss: 0.493 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.0468626022338867
Epoch: 22, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.9449903964996338
Epoch: 23, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.9961397647857666
Epoch: 24, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.020277976989746
Epoch: 25, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.0956056118011475
Epoch: 26, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.9713897705078125
Epoch: 27, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.0190417766571045
Epoch: 28, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.9549038410186768
Epoch: 29, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.9691078662872314
Epoch: 30, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 523844
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.473533868789673
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.466 Vali Acc: 0.150 Test Loss: 1.466 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.9583394527435303
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.452 Vali Acc: 0.150 Test Loss: 1.452 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 3 cost time: 1.088890552520752
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.432 Vali Acc: 0.225 Test Loss: 1.432 Test Acc: 0.225
Validation loss decreased (-0.149985 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 1.1053099632263184
Epoch: 4, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.405 Vali Acc: 0.325 Test Loss: 1.405 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.0585708618164062
Epoch: 5, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.379 Vali Acc: 0.325 Test Loss: 1.379 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.9922833442687988
Epoch: 6, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.349 Vali Acc: 0.350 Test Loss: 1.349 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.049126148223877
Epoch: 7, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 1.0050489902496338
Epoch: 8, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.282 Vali Acc: 0.450 Test Loss: 1.282 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 1.0306322574615479
Epoch: 9, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.243 Vali Acc: 0.475 Test Loss: 1.243 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 1.0411620140075684
Epoch: 10, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 1.0126135349273682
Epoch: 11, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 1.0152406692504883
Epoch: 12, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 0.9436616897583008
Epoch: 13, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.059 Vali Acc: 0.625 Test Loss: 1.059 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.013634204864502
Epoch: 14, Steps: 3 | Train Loss: 0.733 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 1.0028760433197021
Epoch: 15, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.959 Vali Acc: 0.700 Test Loss: 0.959 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 1.0918242931365967
Epoch: 16, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.904 Vali Acc: 0.725 Test Loss: 0.904 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.0192170143127441
Epoch: 17, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.837 Vali Acc: 0.775 Test Loss: 0.837 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 1.0771379470825195
Epoch: 18, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 1.1159439086914062
Epoch: 19, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0355019569396973
Epoch: 20, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9878959655761719
Epoch: 21, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 1.0170190334320068
Epoch: 22, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.633 Vali Acc: 0.825 Test Loss: 0.633 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 1.0320429801940918
Epoch: 23, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 1.0864155292510986
Epoch: 24, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.9893708229064941
Epoch: 25, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.0090093612670898
Epoch: 26, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.505 Vali Acc: 0.925 Test Loss: 0.505 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.9974076747894287
Epoch: 27, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.9832813739776611
Epoch: 28, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9817121028900146
Epoch: 29, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.010270118713379
Epoch: 30, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1765412
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.784743070602417
Epoch: 1, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.0669562816619873
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.9364075660705566
Epoch: 3, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.9638838768005371
Epoch: 4, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.8834280967712402
Epoch: 5, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.232 Vali Acc: 0.425 Test Loss: 1.232 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 1.065751552581787
Epoch: 6, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.920621395111084
Epoch: 7, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.0597496032714844
Epoch: 8, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.106 Vali Acc: 0.550 Test Loss: 1.106 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 1.041405439376831
Epoch: 9, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.0190861225128174
Epoch: 10, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.9279968738555908
Epoch: 11, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.946 Vali Acc: 0.750 Test Loss: 0.946 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.9037225246429443
Epoch: 12, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.893 Vali Acc: 0.750 Test Loss: 0.893 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.9738235473632812
Epoch: 13, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.94767165184021
Epoch: 14, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.0240018367767334
Epoch: 15, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 16 cost time: 0.9417791366577148
Epoch: 16, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.9540896415710449
Epoch: 17, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.9195883274078369
Epoch: 18, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.668 Vali Acc: 0.800 Test Loss: 0.668 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8716771602630615
Epoch: 19, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 0.8870484828948975
Epoch: 20, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 1.0205702781677246
Epoch: 21, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 1.0629675388336182
Epoch: 22, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 0.8788425922393799
Epoch: 23, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 0.9160492420196533
Epoch: 24, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 25 cost time: 0.949573278427124
Epoch: 25, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.514 Vali Acc: 0.875 Test Loss: 0.514 Test Acc: 0.875
Validation loss decreased (-0.799995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 0.9032711982727051
Epoch: 26, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 0.8824818134307861
Epoch: 27, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.487 Vali Acc: 0.875 Test Loss: 0.487 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.936354398727417
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.474 Vali Acc: 0.875 Test Loss: 0.474 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.902456521987915
Epoch: 29, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.9653160572052002
Epoch: 30, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 523844
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.6011340618133545
Epoch: 1, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.474 Vali Acc: 0.150 Test Loss: 1.474 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.4545114040374756
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.455 Vali Acc: 0.250 Test Loss: 1.455 Test Acc: 0.250
Validation loss decreased (-0.149985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.3674404621124268
Epoch: 3, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.432 Vali Acc: 0.250 Test Loss: 1.432 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.3563001155853271
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.403 Vali Acc: 0.350 Test Loss: 1.403 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.3858885765075684
Epoch: 5, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.3280694484710693
Epoch: 6, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.331 Vali Acc: 0.450 Test Loss: 1.331 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 1.3968119621276855
Epoch: 7, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.3605461120605469
Epoch: 8, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.238 Vali Acc: 0.575 Test Loss: 1.238 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 1.4392969608306885
Epoch: 9, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.189 Vali Acc: 0.625 Test Loss: 1.189 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 1.4671149253845215
Epoch: 10, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.140 Vali Acc: 0.625 Test Loss: 1.140 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 1.4702553749084473
Epoch: 11, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.088 Vali Acc: 0.650 Test Loss: 1.088 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.5001468658447266
Epoch: 12, Steps: 3 | Train Loss: 0.849 Vali Loss: 1.034 Vali Acc: 0.700 Test Loss: 1.034 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 1.3745994567871094
Epoch: 13, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.4295907020568848
Epoch: 14, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.911 Vali Acc: 0.750 Test Loss: 0.911 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.420032024383545
Epoch: 15, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 1.3738181591033936
Epoch: 16, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.4907269477844238
Epoch: 17, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.3371198177337646
Epoch: 18, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 1.301262378692627
Epoch: 19, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.619 Vali Acc: 0.925 Test Loss: 0.619 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 1.342984676361084
Epoch: 20, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.572 Vali Acc: 0.925 Test Loss: 0.572 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 1.32204270362854
Epoch: 21, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.530 Vali Acc: 0.925 Test Loss: 0.530 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.3271207809448242
Epoch: 22, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.489 Vali Acc: 0.925 Test Loss: 0.489 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 1.3630986213684082
Epoch: 23, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 1.4187028408050537
Epoch: 24, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.2921078205108643
Epoch: 25, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.1767868995666504
Epoch: 26, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.354842185974121
Epoch: 27, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.5431292057037354
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 1.478041172027588
Epoch: 29, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.3980622291564941
Epoch: 30, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 1.000 Test Loss: 0.228 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 886244
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.6204874515533447
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.458 Vali Acc: 0.325 Test Loss: 1.458 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.232377052307129
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.437 Vali Acc: 0.350 Test Loss: 1.437 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.1506521701812744
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.419 Vali Acc: 0.350 Test Loss: 1.419 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.1224696636199951
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.199739694595337
Epoch: 5, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.366 Vali Acc: 0.350 Test Loss: 1.366 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.10188627243042
Epoch: 6, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.334 Vali Acc: 0.350 Test Loss: 1.334 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.208446741104126
Epoch: 7, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.297 Vali Acc: 0.350 Test Loss: 1.297 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 1.2111799716949463
Epoch: 8, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.260 Vali Acc: 0.350 Test Loss: 1.260 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 1.1140763759613037
Epoch: 9, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 1.203033447265625
Epoch: 10, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.2157659530639648
Epoch: 11, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.131 Vali Acc: 0.575 Test Loss: 1.131 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 1.1371376514434814
Epoch: 12, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 1.0904135704040527
Epoch: 13, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.1883583068847656
Epoch: 14, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.1676290035247803
Epoch: 15, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.939 Vali Acc: 0.750 Test Loss: 0.939 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.2702457904815674
Epoch: 16, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 1.3220791816711426
Epoch: 17, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.835 Vali Acc: 0.800 Test Loss: 0.835 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.1136932373046875
Epoch: 18, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.785 Vali Acc: 0.875 Test Loss: 0.785 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 1.1342334747314453
Epoch: 19, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.737 Vali Acc: 0.900 Test Loss: 0.737 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.9846599102020264
Epoch: 20, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.692 Vali Acc: 0.900 Test Loss: 0.692 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 1.1113831996917725
Epoch: 21, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1281847953796387
Epoch: 22, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.608 Vali Acc: 0.875 Test Loss: 0.608 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1896021366119385
Epoch: 23, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.571 Vali Acc: 0.950 Test Loss: 0.571 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 1.2453069686889648
Epoch: 24, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.538 Vali Acc: 0.950 Test Loss: 0.538 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 1.353126049041748
Epoch: 25, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.502 Vali Acc: 0.975 Test Loss: 0.502 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 1.363490343093872
Epoch: 26, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.462 Vali Acc: 0.975 Test Loss: 0.462 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 1.2458910942077637
Epoch: 27, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.431 Vali Acc: 0.975 Test Loss: 0.431 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 1.2033414840698242
Epoch: 28, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 1.2532265186309814
Epoch: 29, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 1.168872594833374
Epoch: 30, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 265412
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.337937116622925
Epoch: 1, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.477 Vali Acc: 0.200 Test Loss: 1.477 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.2550458908081055
Epoch: 2, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.458 Vali Acc: 0.250 Test Loss: 1.458 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.2080042362213135
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.435 Vali Acc: 0.275 Test Loss: 1.435 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.1801412105560303
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.1651575565338135
Epoch: 5, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.388 Vali Acc: 0.375 Test Loss: 1.388 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1378991603851318
Epoch: 6, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 1.1866254806518555
Epoch: 7, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 1.1323838233947754
Epoch: 8, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.266 Vali Acc: 0.475 Test Loss: 1.266 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.1229567527770996
Epoch: 9, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 1.075010061264038
Epoch: 10, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 1.1663784980773926
Epoch: 11, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.120 Vali Acc: 0.625 Test Loss: 1.120 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.1959176063537598
Epoch: 12, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.068 Vali Acc: 0.625 Test Loss: 1.068 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.1672008037567139
Epoch: 13, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.093432903289795
Epoch: 14, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.0899484157562256
Epoch: 15, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 1.1040031909942627
Epoch: 16, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.1604588031768799
Epoch: 17, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.1580510139465332
Epoch: 18, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.2515678405761719
Epoch: 19, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.675 Vali Acc: 0.800 Test Loss: 0.675 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.205482006072998
Epoch: 20, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.631 Vali Acc: 0.825 Test Loss: 0.631 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 1.1235835552215576
Epoch: 21, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 1.1394450664520264
Epoch: 22, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 1.0968890190124512
Epoch: 23, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.16501784324646
Epoch: 24, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.477 Vali Acc: 0.925 Test Loss: 0.477 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.0639245510101318
Epoch: 25, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.438 Vali Acc: 0.975 Test Loss: 0.438 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 1.1343281269073486
Epoch: 26, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 1.1814076900482178
Epoch: 27, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 1.1190507411956787
Epoch: 28, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 1.1649014949798584
Epoch: 29, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.0855638980865479
Epoch: 30, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 886244
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9367055892944336
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.452 Vali Acc: 0.350 Test Loss: 1.452 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 1.0821983814239502
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.430 Vali Acc: 0.350 Test Loss: 1.430 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.0873491764068604
Epoch: 3, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.411 Vali Acc: 0.350 Test Loss: 1.411 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0738790035247803
Epoch: 4, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.385 Vali Acc: 0.325 Test Loss: 1.385 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1314916610717773
Epoch: 5, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.355 Vali Acc: 0.350 Test Loss: 1.355 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.024101734161377
Epoch: 6, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.321 Vali Acc: 0.350 Test Loss: 1.321 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.0525214672088623
Epoch: 7, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.285 Vali Acc: 0.350 Test Loss: 1.285 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 1.0273232460021973
Epoch: 8, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.248 Vali Acc: 0.350 Test Loss: 1.248 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 9 cost time: 1.1668524742126465
Epoch: 9, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.206 Vali Acc: 0.375 Test Loss: 1.206 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 10 cost time: 1.111928939819336
Epoch: 10, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.161 Vali Acc: 0.475 Test Loss: 1.161 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 1.0404179096221924
Epoch: 11, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.1104652881622314
Epoch: 12, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.070 Vali Acc: 0.600 Test Loss: 1.070 Test Acc: 0.600
Validation loss decreased (-0.499989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.0690441131591797
Epoch: 13, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 1.0395939350128174
Epoch: 14, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.973 Vali Acc: 0.675 Test Loss: 0.973 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 15 cost time: 1.0291624069213867
Epoch: 15, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.029585361480713
Epoch: 16, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.0795457363128662
Epoch: 17, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.827 Vali Acc: 0.775 Test Loss: 0.827 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 1.1126480102539062
Epoch: 18, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.779 Vali Acc: 0.875 Test Loss: 0.779 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 1.0558366775512695
Epoch: 19, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 1.0584275722503662
Epoch: 20, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 1.0873444080352783
Epoch: 21, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 1.0318188667297363
Epoch: 22, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 1.0355403423309326
Epoch: 23, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.8986048698425293
Epoch: 24, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.538 Vali Acc: 0.950 Test Loss: 0.538 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 1.1606512069702148
Epoch: 25, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.500 Vali Acc: 0.975 Test Loss: 0.500 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 1.0892493724822998
Epoch: 26, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.462 Vali Acc: 1.000 Test Loss: 0.462 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 265412
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9181466102600098
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.462 Vali Acc: 0.300 Test Loss: 1.462 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.0856385231018066
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.444 Vali Acc: 0.350 Test Loss: 1.444 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.084336757659912
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.424 Vali Acc: 0.350 Test Loss: 1.424 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0288231372833252
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.398 Vali Acc: 0.425 Test Loss: 1.398 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.9835693836212158
Epoch: 5, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.368 Vali Acc: 0.450 Test Loss: 1.368 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 6 cost time: 0.9788520336151123
Epoch: 6, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.334 Vali Acc: 0.475 Test Loss: 1.334 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.9907667636871338
Epoch: 7, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.298 Vali Acc: 0.475 Test Loss: 1.298 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.989854097366333
Epoch: 8, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.259 Vali Acc: 0.475 Test Loss: 1.259 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.9613277912139893
Epoch: 9, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9160444736480713
Epoch: 10, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.173 Vali Acc: 0.575 Test Loss: 1.173 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.9362027645111084
Epoch: 11, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.127 Vali Acc: 0.575 Test Loss: 1.127 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.9662871360778809
Epoch: 12, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.9557609558105469
Epoch: 13, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.056 Vali Acc: 0.575 Test Loss: 1.056 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 0.9801757335662842
Epoch: 14, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.9838168621063232
Epoch: 15, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.957 Vali Acc: 0.625 Test Loss: 0.957 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 0.9385721683502197
Epoch: 16, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.906 Vali Acc: 0.675 Test Loss: 0.906 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 0.9411273002624512
Epoch: 17, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.891 Vali Acc: 0.700 Test Loss: 0.891 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.978790283203125
Epoch: 18, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.847 Vali Acc: 0.700 Test Loss: 0.847 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 19 cost time: 0.9117996692657471
Epoch: 19, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.804 Vali Acc: 0.700 Test Loss: 0.804 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 20 cost time: 0.9669053554534912
Epoch: 20, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.770 Vali Acc: 0.700 Test Loss: 0.770 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 21 cost time: 0.9124345779418945
Epoch: 21, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.742 Vali Acc: 0.725 Test Loss: 0.742 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724993).  Saving model ...
Epoch: 22 cost time: 0.9124500751495361
Epoch: 22, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.724993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 0.9006462097167969
Epoch: 23, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 0.9071369171142578
Epoch: 24, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 0.9348876476287842
Epoch: 25, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 0.9555971622467041
Epoch: 26, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 0.8814544677734375
Epoch: 27, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 0.8953390121459961
Epoch: 28, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 0.9585556983947754
Epoch: 29, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 0.909966230392456
Epoch: 30, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 886244
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5474064350128174
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.8948225975036621
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.415 Vali Acc: 0.400 Test Loss: 1.415 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.8839695453643799
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.393 Vali Acc: 0.425 Test Loss: 1.393 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.8867120742797852
Epoch: 4, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9528429508209229
Epoch: 5, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.334 Vali Acc: 0.375 Test Loss: 1.334 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9427812099456787
Epoch: 6, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9482052326202393
Epoch: 7, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.263 Vali Acc: 0.375 Test Loss: 1.263 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8965613842010498
Epoch: 8, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.227 Vali Acc: 0.350 Test Loss: 1.227 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7596325874328613
Epoch: 9, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.187 Vali Acc: 0.475 Test Loss: 1.187 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.8932023048400879
Epoch: 10, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.8576540946960449
Epoch: 11, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.107 Vali Acc: 0.575 Test Loss: 1.107 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.9983973503112793
Epoch: 12, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.065 Vali Acc: 0.575 Test Loss: 1.065 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.8645980358123779
Epoch: 13, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.019 Vali Acc: 0.625 Test Loss: 1.019 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.8786013126373291
Epoch: 14, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.8652222156524658
Epoch: 15, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 0.8224208354949951
Epoch: 16, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.886 Vali Acc: 0.725 Test Loss: 0.886 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 0.846590518951416
Epoch: 17, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 0.9416360855102539
Epoch: 18, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.8742120265960693
Epoch: 19, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.8897688388824463
Epoch: 20, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.707 Vali Acc: 0.875 Test Loss: 0.707 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.8987252712249756
Epoch: 21, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.9331338405609131
Epoch: 22, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.8844280242919922
Epoch: 23, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.594 Vali Acc: 0.875 Test Loss: 0.594 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.9090766906738281
Epoch: 24, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.866715669631958
Epoch: 25, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.8738195896148682
Epoch: 26, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.498 Vali Acc: 0.925 Test Loss: 0.498 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.8519341945648193
Epoch: 27, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.8796753883361816
Epoch: 28, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.8434419631958008
Epoch: 29, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.8875253200531006
Epoch: 30, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 265412
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4129745960235596
Epoch: 1, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.361 Vali Acc: 0.425 Test Loss: 1.361 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 1.567011833190918
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.346 Vali Acc: 0.450 Test Loss: 1.346 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.619314432144165
Epoch: 3, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.5532066822052002
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.609363079071045
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.469785451889038
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 1.390066385269165
Epoch: 7, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.454486608505249
Epoch: 8, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.188 Vali Acc: 0.575 Test Loss: 1.188 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 1.6417205333709717
Epoch: 9, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 1.386521577835083
Epoch: 10, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.520559549331665
Epoch: 11, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.5563702583312988
Epoch: 12, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.029 Vali Acc: 0.725 Test Loss: 1.029 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.4686636924743652
Epoch: 13, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.983 Vali Acc: 0.800 Test Loss: 0.983 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 1.5540616512298584
Epoch: 14, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.936 Vali Acc: 0.825 Test Loss: 0.936 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 1.571237325668335
Epoch: 15, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.887 Vali Acc: 0.825 Test Loss: 0.887 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 1.3745012283325195
Epoch: 16, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.836 Vali Acc: 0.850 Test Loss: 0.836 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.415496826171875
Epoch: 17, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 1.4373443126678467
Epoch: 18, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 1.4459235668182373
Epoch: 19, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 1.4381992816925049
Epoch: 20, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.630 Vali Acc: 0.900 Test Loss: 0.630 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.23710036277771
Epoch: 21, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 1.4209153652191162
Epoch: 22, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 1.4116432666778564
Epoch: 23, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.514 Vali Acc: 0.950 Test Loss: 0.514 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 1.4719879627227783
Epoch: 24, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 1.4498894214630127
Epoch: 25, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.4446330070495605
Epoch: 26, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.5548462867736816
Epoch: 27, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.571784257888794
Epoch: 28, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.5463764667510986
Epoch: 29, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 1.704333782196045
Epoch: 30, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 446660
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1272289752960205
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.1713440418243408
Epoch: 2, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.091076374053955
Epoch: 3, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.338 Vali Acc: 0.350 Test Loss: 1.338 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.2145328521728516
Epoch: 4, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.1807310581207275
Epoch: 5, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.287 Vali Acc: 0.375 Test Loss: 1.287 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.1329221725463867
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1271884441375732
Epoch: 7, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.225 Vali Acc: 0.425 Test Loss: 1.225 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.094606637954712
Epoch: 8, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.9803810119628906
Epoch: 9, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.157 Vali Acc: 0.525 Test Loss: 1.157 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.1769051551818848
Epoch: 10, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.1774921417236328
Epoch: 11, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 1.2166740894317627
Epoch: 12, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.047 Vali Acc: 0.625 Test Loss: 1.047 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 1.146498203277588
Epoch: 13, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 1.109287977218628
Epoch: 14, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 15 cost time: 1.1151423454284668
Epoch: 15, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.915 Vali Acc: 0.675 Test Loss: 0.915 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 1.2335240840911865
Epoch: 16, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.870 Vali Acc: 0.700 Test Loss: 0.870 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 1.2811026573181152
Epoch: 17, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.823 Vali Acc: 0.700 Test Loss: 0.823 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 18 cost time: 1.1825928688049316
Epoch: 18, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.205007791519165
Epoch: 19, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 1.1605274677276611
Epoch: 20, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.1367104053497314
Epoch: 21, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 1.3213715553283691
Epoch: 22, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.1074869632720947
Epoch: 23, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.2162799835205078
Epoch: 24, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.549 Vali Acc: 0.925 Test Loss: 0.549 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.109978199005127
Epoch: 25, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.0698294639587402
Epoch: 26, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.1998028755187988
Epoch: 27, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.1277363300323486
Epoch: 28, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 1.2933800220489502
Epoch: 29, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.418 Vali Acc: 0.975 Test Loss: 0.418 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 1.22481107711792
Epoch: 30, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.400 Vali Acc: 0.975 Test Loss: 0.400 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 136196
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.603985548019409
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 1.3330085277557373
Epoch: 2, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.2812511920928955
Epoch: 3, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.343 Vali Acc: 0.450 Test Loss: 1.343 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.1651415824890137
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.322 Vali Acc: 0.450 Test Loss: 1.322 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.3597688674926758
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.283658742904663
Epoch: 6, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.270 Vali Acc: 0.525 Test Loss: 1.270 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 1.200314998626709
Epoch: 7, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.238 Vali Acc: 0.525 Test Loss: 1.238 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.2462291717529297
Epoch: 8, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.203 Vali Acc: 0.550 Test Loss: 1.203 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 1.1754343509674072
Epoch: 9, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 1.1871187686920166
Epoch: 10, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.1988272666931152
Epoch: 11, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 1.2281708717346191
Epoch: 12, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.042 Vali Acc: 0.725 Test Loss: 1.042 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.2421128749847412
Epoch: 13, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.997 Vali Acc: 0.800 Test Loss: 0.997 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 1.2869517803192139
Epoch: 14, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.951 Vali Acc: 0.800 Test Loss: 0.951 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 1.2385461330413818
Epoch: 15, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.902 Vali Acc: 0.825 Test Loss: 0.902 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 1.1489160060882568
Epoch: 16, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.853 Vali Acc: 0.825 Test Loss: 0.853 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 1.2281317710876465
Epoch: 17, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.805 Vali Acc: 0.850 Test Loss: 0.805 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 1.1825976371765137
Epoch: 18, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 19 cost time: 1.13120436668396
Epoch: 19, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 1.3017301559448242
Epoch: 20, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 1.2568554878234863
Epoch: 21, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 1.2438616752624512
Epoch: 22, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.3101146221160889
Epoch: 23, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.1913888454437256
Epoch: 24, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.2998237609863281
Epoch: 25, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.3303351402282715
Epoch: 26, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.32666015625
Epoch: 27, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.3534526824951172
Epoch: 28, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.3739736080169678
Epoch: 29, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 1.4395413398742676
Epoch: 30, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 446660
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8520076274871826
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.0716750621795654
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.373 Vali Acc: 0.350 Test Loss: 1.373 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.1405012607574463
Epoch: 3, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.1727592945098877
Epoch: 4, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9525301456451416
Epoch: 5, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.0423345565795898
Epoch: 6, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.274 Vali Acc: 0.425 Test Loss: 1.274 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.0180613994598389
Epoch: 7, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.242 Vali Acc: 0.450 Test Loss: 1.242 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 1.0762038230895996
Epoch: 8, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0583181381225586
Epoch: 9, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.174 Vali Acc: 0.525 Test Loss: 1.174 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.1042745113372803
Epoch: 10, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.138 Vali Acc: 0.525 Test Loss: 1.138 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 0.9291157722473145
Epoch: 11, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.099 Vali Acc: 0.575 Test Loss: 1.099 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 1.0316834449768066
Epoch: 12, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.049560308456421
Epoch: 13, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.0542106628417969
Epoch: 14, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.974 Vali Acc: 0.625 Test Loss: 0.974 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 1.0651359558105469
Epoch: 15, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.928 Vali Acc: 0.650 Test Loss: 0.928 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 16 cost time: 1.0267372131347656
Epoch: 16, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.884 Vali Acc: 0.675 Test Loss: 0.884 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 17 cost time: 1.0485591888427734
Epoch: 17, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.838 Vali Acc: 0.700 Test Loss: 0.838 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699992).  Saving model ...
Epoch: 18 cost time: 1.0690510272979736
Epoch: 18, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
Validation loss decreased (-0.699992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.0119400024414062
Epoch: 19, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 20 cost time: 1.0900440216064453
Epoch: 20, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.043386459350586
Epoch: 21, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.672 Vali Acc: 0.825 Test Loss: 0.672 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 1.0669598579406738
Epoch: 22, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.640 Vali Acc: 0.825 Test Loss: 0.640 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 1.0579569339752197
Epoch: 23, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 1.0092179775238037
Epoch: 24, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 0.9376752376556396
Epoch: 25, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.0509886741638184
Epoch: 26, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.1013925075531006
Epoch: 27, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.504 Vali Acc: 0.925 Test Loss: 0.504 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.125450611114502
Epoch: 28, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 1.1121535301208496
Epoch: 29, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.1214709281921387
Epoch: 30, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 136196
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.908294916152954
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.394 Vali Acc: 0.350 Test Loss: 1.394 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.0670690536499023
Epoch: 2, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.9451236724853516
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.361 Vali Acc: 0.425 Test Loss: 1.361 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.9227862358093262
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.338 Vali Acc: 0.450 Test Loss: 1.338 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.9284458160400391
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.013024091720581
Epoch: 6, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.9900572299957275
Epoch: 7, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.246 Vali Acc: 0.525 Test Loss: 1.246 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.9597880840301514
Epoch: 8, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 1.013861894607544
Epoch: 9, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.9931764602661133
Epoch: 10, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.8820579051971436
Epoch: 11, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 1.024937391281128
Epoch: 12, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.058 Vali Acc: 0.725 Test Loss: 1.058 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.9684572219848633
Epoch: 13, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.020 Vali Acc: 0.775 Test Loss: 1.020 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 1.0424103736877441
Epoch: 14, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 1.048896312713623
Epoch: 15, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.934 Vali Acc: 0.825 Test Loss: 0.934 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 1.0076470375061035
Epoch: 16, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.887 Vali Acc: 0.825 Test Loss: 0.887 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 0.9418518543243408
Epoch: 17, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.839 Vali Acc: 0.825 Test Loss: 0.839 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.898231029510498
Epoch: 18, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.9691932201385498
Epoch: 19, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.753 Vali Acc: 0.850 Test Loss: 0.753 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 1.0760631561279297
Epoch: 20, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 0.958073616027832
Epoch: 21, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.9783351421356201
Epoch: 22, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.9596202373504639
Epoch: 23, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.9741921424865723
Epoch: 24, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 25 cost time: 0.971228837966919
Epoch: 25, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.944758415222168
Epoch: 26, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.9934630393981934
Epoch: 27, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.1126618385314941
Epoch: 28, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.0303740501403809
Epoch: 29, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.9973969459533691
Epoch: 30, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 446660
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.730903387069702
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.420 Vali Acc: 0.350 Test Loss: 1.420 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.9638099670410156
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.9228312969207764
Epoch: 3, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.9842274188995361
Epoch: 4, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.358 Vali Acc: 0.350 Test Loss: 1.358 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.0141232013702393
Epoch: 5, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.330 Vali Acc: 0.375 Test Loss: 1.330 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.016965627670288
Epoch: 6, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.9025778770446777
Epoch: 7, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.268 Vali Acc: 0.375 Test Loss: 1.268 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.8766820430755615
Epoch: 8, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.233 Vali Acc: 0.425 Test Loss: 1.233 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.9054746627807617
Epoch: 9, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.199 Vali Acc: 0.450 Test Loss: 1.199 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.9905900955200195
Epoch: 10, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.9425396919250488
Epoch: 11, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 12 cost time: 0.9727916717529297
Epoch: 12, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.8867142200469971
Epoch: 13, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.929915189743042
Epoch: 14, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 0.9497370719909668
Epoch: 15, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.952 Vali Acc: 0.625 Test Loss: 0.952 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 1.005953311920166
Epoch: 16, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.909 Vali Acc: 0.625 Test Loss: 0.909 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 17 cost time: 1.0173137187957764
Epoch: 17, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.862 Vali Acc: 0.675 Test Loss: 0.862 Test Acc: 0.675
Validation loss decreased (-0.624991 --> -0.674991).  Saving model ...
Epoch: 18 cost time: 1.0119569301605225
Epoch: 18, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.815 Vali Acc: 0.675 Test Loss: 0.815 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 19 cost time: 0.9162001609802246
Epoch: 19, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
Validation loss decreased (-0.674992 --> -0.724992).  Saving model ...
Epoch: 20 cost time: 1.0053949356079102
Epoch: 20, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.737 Vali Acc: 0.725 Test Loss: 0.737 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724993).  Saving model ...
Epoch: 21 cost time: 0.942375898361206
Epoch: 21, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.724993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 0.9727909564971924
Epoch: 22, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.048699140548706
Epoch: 23, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.646 Vali Acc: 0.825 Test Loss: 0.646 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 0.976855993270874
Epoch: 24, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 0.845491886138916
Epoch: 25, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.594 Vali Acc: 0.800 Test Loss: 0.594 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8959589004516602
Epoch: 26, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 0.9179022312164307
Epoch: 27, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 0.8876771926879883
Epoch: 28, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 0.9983513355255127
Epoch: 29, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.512 Vali Acc: 0.875 Test Loss: 0.512 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 0.984978199005127
Epoch: 30, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 136196
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.5639591217041016
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.4015460014343262
Epoch: 2, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.4254348278045654
Epoch: 3, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.4188239574432373
Epoch: 4, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.251 Vali Acc: 0.550 Test Loss: 1.251 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 1.4586267471313477
Epoch: 5, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.223 Vali Acc: 0.650 Test Loss: 1.223 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 1.4545114040374756
Epoch: 6, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.194 Vali Acc: 0.700 Test Loss: 1.194 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 1.3857131004333496
Epoch: 7, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.165 Vali Acc: 0.700 Test Loss: 1.165 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 1.401658296585083
Epoch: 8, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.137 Vali Acc: 0.725 Test Loss: 1.137 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 1.3444504737854004
Epoch: 9, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3892955780029297
Epoch: 10, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4091641902923584
Epoch: 11, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.051 Vali Acc: 0.700 Test Loss: 1.051 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4440901279449463
Epoch: 12, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.4294099807739258
Epoch: 13, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.992 Vali Acc: 0.750 Test Loss: 0.992 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.4883911609649658
Epoch: 14, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.967 Vali Acc: 0.775 Test Loss: 0.967 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 1.4500997066497803
Epoch: 15, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.934 Vali Acc: 0.800 Test Loss: 0.934 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.4323866367340088
Epoch: 16, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.901 Vali Acc: 0.800 Test Loss: 0.901 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 1.4128961563110352
Epoch: 17, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 1.4840312004089355
Epoch: 18, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.4893832206726074
Epoch: 19, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 1.3691434860229492
Epoch: 20, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4061830043792725
Epoch: 21, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.3689699172973633
Epoch: 22, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 1.4451775550842285
Epoch: 23, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 1.4479475021362305
Epoch: 24, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.432234287261963
Epoch: 25, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.3876569271087646
Epoch: 26, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 1.4369606971740723
Epoch: 27, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 1.3797903060913086
Epoch: 28, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.4732120037078857
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.508 Vali Acc: 0.925 Test Loss: 0.508 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.3907809257507324
Epoch: 30, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 883284
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.305910348892212
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.240 Vali Acc: 0.350 Test Loss: 1.240 Test Acc: 0.350
Validation loss decreased (inf --> -0.349988).  Saving model ...
Epoch: 2 cost time: 1.2241864204406738
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.228 Vali Acc: 0.350 Test Loss: 1.228 Test Acc: 0.350
Validation loss decreased (-0.349988 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 1.183547019958496
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.212 Vali Acc: 0.375 Test Loss: 1.212 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 1.1469552516937256
Epoch: 4, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.1261770725250244
Epoch: 5, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1577727794647217
Epoch: 6, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.138 Vali Acc: 0.575 Test Loss: 1.138 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 1.2156779766082764
Epoch: 7, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.110 Vali Acc: 0.625 Test Loss: 1.110 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.2055528163909912
Epoch: 8, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 1.1331570148468018
Epoch: 9, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.055 Vali Acc: 0.725 Test Loss: 1.055 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 1.1249327659606934
Epoch: 10, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1640675067901611
Epoch: 11, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2396824359893799
Epoch: 12, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 1.238036870956421
Epoch: 13, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.959 Vali Acc: 0.775 Test Loss: 0.959 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 1.313408374786377
Epoch: 14, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.931 Vali Acc: 0.825 Test Loss: 0.931 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 1.1876654624938965
Epoch: 15, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.901 Vali Acc: 0.825 Test Loss: 0.901 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 1.146838903427124
Epoch: 16, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 1.1975674629211426
Epoch: 17, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.850 Vali Acc: 0.875 Test Loss: 0.850 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 1.2446391582489014
Epoch: 18, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.818 Vali Acc: 0.875 Test Loss: 0.818 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 1.1737499237060547
Epoch: 19, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1904497146606445
Epoch: 20, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.759 Vali Acc: 0.825 Test Loss: 0.759 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1565489768981934
Epoch: 21, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.185067892074585
Epoch: 22, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2661726474761963
Epoch: 23, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2933895587921143
Epoch: 24, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1287083625793457
Epoch: 25, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1887693405151367
Epoch: 26, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.095508337020874
Epoch: 27, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0930356979370117
Epoch: 28, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.558 Vali Acc: 0.875 Test Loss: 0.558 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 1.1254310607910156
Epoch: 29, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.1027028560638428
Epoch: 30, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 262308
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2930006980895996
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.318 Vali Acc: 0.425 Test Loss: 1.318 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.2407829761505127
Epoch: 2, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.306 Vali Acc: 0.450 Test Loss: 1.306 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.2377748489379883
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.232210636138916
Epoch: 4, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.265 Vali Acc: 0.525 Test Loss: 1.265 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 1.1996808052062988
Epoch: 5, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.238 Vali Acc: 0.625 Test Loss: 1.238 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 1.176365852355957
Epoch: 6, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.211 Vali Acc: 0.700 Test Loss: 1.211 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 1.2190449237823486
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.182 Vali Acc: 0.700 Test Loss: 1.182 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 1.1845383644104004
Epoch: 8, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.153 Vali Acc: 0.700 Test Loss: 1.153 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 1.1748971939086914
Epoch: 9, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.124 Vali Acc: 0.675 Test Loss: 1.124 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1854424476623535
Epoch: 10, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 1.174015998840332
Epoch: 11, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.060 Vali Acc: 0.700 Test Loss: 1.060 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.2290716171264648
Epoch: 12, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.026 Vali Acc: 0.725 Test Loss: 1.026 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.1680662631988525
Epoch: 13, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.1891710758209229
Epoch: 14, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.1411547660827637
Epoch: 15, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.913 Vali Acc: 0.800 Test Loss: 0.913 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.1652557849884033
Epoch: 16, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.873 Vali Acc: 0.825 Test Loss: 0.873 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 1.167940616607666
Epoch: 17, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.835 Vali Acc: 0.825 Test Loss: 0.835 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 1.1997268199920654
Epoch: 18, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.801 Vali Acc: 0.800 Test Loss: 0.801 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.245917558670044
Epoch: 19, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 1.2135634422302246
Epoch: 20, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 1.3221113681793213
Epoch: 21, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.694 Vali Acc: 0.825 Test Loss: 0.694 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1438944339752197
Epoch: 22, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 1.0908129215240479
Epoch: 23, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 1.1984081268310547
Epoch: 24, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 1.243288278579712
Epoch: 25, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.568 Vali Acc: 0.925 Test Loss: 0.568 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 1.231492042541504
Epoch: 26, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.2380576133728027
Epoch: 27, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.2162857055664062
Epoch: 28, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 1.199239730834961
Epoch: 29, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.483 Vali Acc: 1.000 Test Loss: 0.483 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 883284
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1344246864318848
Epoch: 1, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.255 Vali Acc: 0.350 Test Loss: 1.255 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.022519826889038
Epoch: 2, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.243 Vali Acc: 0.350 Test Loss: 1.243 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 1.1555862426757812
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.227 Vali Acc: 0.350 Test Loss: 1.227 Test Acc: 0.350
Validation loss decreased (-0.349988 --> -0.349988).  Saving model ...
Epoch: 4 cost time: 1.074794054031372
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.349988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.0983948707580566
Epoch: 5, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.182 Vali Acc: 0.450 Test Loss: 1.182 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.0967001914978027
Epoch: 6, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.154 Vali Acc: 0.550 Test Loss: 1.154 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 1.0619227886199951
Epoch: 7, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.125 Vali Acc: 0.625 Test Loss: 1.125 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.0484497547149658
Epoch: 8, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 1.1266167163848877
Epoch: 9, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.117116928100586
Epoch: 10, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1338481903076172
Epoch: 11, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.9674177169799805
Epoch: 12, Steps: 3 | Train Loss: 0.951 Vali Loss: 0.988 Vali Acc: 0.775 Test Loss: 0.988 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 1.1478712558746338
Epoch: 13, Steps: 3 | Train Loss: 0.906 Vali Loss: 0.959 Vali Acc: 0.825 Test Loss: 0.959 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 1.173661708831787
Epoch: 14, Steps: 3 | Train Loss: 0.910 Vali Loss: 0.931 Vali Acc: 0.850 Test Loss: 0.931 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 1.1046667098999023
Epoch: 15, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.902 Vali Acc: 0.875 Test Loss: 0.902 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 1.1039588451385498
Epoch: 16, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.872 Vali Acc: 0.875 Test Loss: 0.872 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 17 cost time: 1.2453579902648926
Epoch: 17, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.840 Vali Acc: 0.875 Test Loss: 0.840 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 1.1025094985961914
Epoch: 18, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.807 Vali Acc: 0.875 Test Loss: 0.807 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 1.0678627490997314
Epoch: 19, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.776 Vali Acc: 0.875 Test Loss: 0.776 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 1.075732946395874
Epoch: 20, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.745 Vali Acc: 0.900 Test Loss: 0.745 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 1.0139081478118896
Epoch: 21, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0635201930999756
Epoch: 22, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.102682113647461
Epoch: 23, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1378114223480225
Epoch: 24, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.635 Vali Acc: 0.875 Test Loss: 0.635 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0775408744812012
Epoch: 25, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0165681838989258
Epoch: 26, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9901008605957031
Epoch: 27, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0721681118011475
Epoch: 28, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 1.2435431480407715
Epoch: 29, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.540 Vali Acc: 0.925 Test Loss: 0.540 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.1718189716339111
Epoch: 30, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 262308
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9849700927734375
Epoch: 1, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.0374212265014648
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.307 Vali Acc: 0.475 Test Loss: 1.307 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.0399718284606934
Epoch: 3, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.014822006225586
Epoch: 4, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.266 Vali Acc: 0.625 Test Loss: 1.266 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 1.0433032512664795
Epoch: 5, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 1.0815060138702393
Epoch: 6, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.213 Vali Acc: 0.725 Test Loss: 1.213 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 1.1318652629852295
Epoch: 7, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.185 Vali Acc: 0.725 Test Loss: 1.185 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 8 cost time: 1.0461885929107666
Epoch: 8, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.157 Vali Acc: 0.725 Test Loss: 1.157 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 9 cost time: 1.0705044269561768
Epoch: 9, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.127 Vali Acc: 0.700 Test Loss: 1.127 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0537490844726562
Epoch: 10, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.097 Vali Acc: 0.750 Test Loss: 1.097 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749989).  Saving model ...
Epoch: 11 cost time: 0.9535131454467773
Epoch: 11, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.066 Vali Acc: 0.750 Test Loss: 1.066 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 1.0005712509155273
Epoch: 12, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.9910016059875488
Epoch: 13, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.000 Vali Acc: 0.750 Test Loss: 1.000 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.0308001041412354
Epoch: 14, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.0681607723236084
Epoch: 15, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.931 Vali Acc: 0.775 Test Loss: 0.931 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 16 cost time: 1.0311622619628906
Epoch: 16, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.896 Vali Acc: 0.800 Test Loss: 0.896 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 1.0639257431030273
Epoch: 17, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 0.9913046360015869
Epoch: 18, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.826 Vali Acc: 0.800 Test Loss: 0.826 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.0581903457641602
Epoch: 19, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 1.061542272567749
Epoch: 20, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.0898370742797852
Epoch: 21, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.732 Vali Acc: 0.850 Test Loss: 0.732 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 1.2054436206817627
Epoch: 22, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 1.0009429454803467
Epoch: 23, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 1.0182714462280273
Epoch: 24, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8910782337188721
Epoch: 25, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 1.0950193405151367
Epoch: 26, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 1.0205967426300049
Epoch: 27, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.9929606914520264
Epoch: 28, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 1.0729577541351318
Epoch: 29, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.606 Vali Acc: 0.875 Test Loss: 0.606 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 1.0236413478851318
Epoch: 30, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 883284
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9400181770324707
Epoch: 1, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.306 Vali Acc: 0.300 Test Loss: 1.306 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.9773621559143066
Epoch: 2, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.293 Vali Acc: 0.300 Test Loss: 1.293 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 1.060640573501587
Epoch: 3, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.278 Vali Acc: 0.325 Test Loss: 1.278 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.9684996604919434
Epoch: 4, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.257 Vali Acc: 0.375 Test Loss: 1.257 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9017684459686279
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.9807395935058594
Epoch: 6, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.9363489151000977
Epoch: 7, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.173 Vali Acc: 0.450 Test Loss: 1.173 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.9146933555603027
Epoch: 8, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.141 Vali Acc: 0.525 Test Loss: 1.141 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.876795768737793
Epoch: 9, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.524989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.0057239532470703
Epoch: 10, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.083 Vali Acc: 0.675 Test Loss: 1.083 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.9793071746826172
Epoch: 11, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.055 Vali Acc: 0.675 Test Loss: 1.055 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.9784424304962158
Epoch: 12, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 1.0296835899353027
Epoch: 13, Steps: 3 | Train Loss: 0.949 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.9923191070556641
Epoch: 14, Steps: 3 | Train Loss: 0.961 Vali Loss: 0.964 Vali Acc: 0.775 Test Loss: 0.964 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 0.9814455509185791
Epoch: 15, Steps: 3 | Train Loss: 0.909 Vali Loss: 0.933 Vali Acc: 0.875 Test Loss: 0.933 Test Acc: 0.875
Validation loss decreased (-0.774990 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 0.9398674964904785
Epoch: 16, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.901 Vali Acc: 0.850 Test Loss: 0.901 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9807620048522949
Epoch: 17, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0272903442382812
Epoch: 18, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.834 Vali Acc: 0.825 Test Loss: 0.834 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9819521903991699
Epoch: 19, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.799 Vali Acc: 0.825 Test Loss: 0.799 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9119598865509033
Epoch: 20, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.766 Vali Acc: 0.825 Test Loss: 0.766 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9626553058624268
Epoch: 21, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.734 Vali Acc: 0.825 Test Loss: 0.734 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9342441558837891
Epoch: 22, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.95644211769104
Epoch: 23, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.9989829063415527
Epoch: 24, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.643 Vali Acc: 0.925 Test Loss: 0.643 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.898108959197998
Epoch: 25, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.615 Vali Acc: 0.950 Test Loss: 0.615 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.9910726547241211
Epoch: 26, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 0.9816126823425293
Epoch: 27, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.566 Vali Acc: 0.950 Test Loss: 0.566 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 0.8991148471832275
Epoch: 28, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.546 Vali Acc: 0.950 Test Loss: 0.546 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.9186224937438965
Epoch: 29, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.567 Vali Acc: 0.975 Test Loss: 0.567 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974994).  Saving model ...
Epoch: 30 cost time: 0.9914827346801758
Epoch: 30, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.548 Vali Acc: 0.975 Test Loss: 0.548 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 262308
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.6282708644866943
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.459 Vali Acc: 0.150 Test Loss: 1.459 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.510533094406128
Epoch: 2, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.447 Vali Acc: 0.175 Test Loss: 1.447 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.4723269939422607
Epoch: 3, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.431 Vali Acc: 0.250 Test Loss: 1.431 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.5493199825286865
Epoch: 4, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.410 Vali Acc: 0.350 Test Loss: 1.410 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.4115700721740723
Epoch: 5, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.386 Vali Acc: 0.375 Test Loss: 1.386 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.4108903408050537
Epoch: 6, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 1.5100467205047607
Epoch: 7, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.337 Vali Acc: 0.425 Test Loss: 1.337 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.483767032623291
Epoch: 8, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.312 Vali Acc: 0.425 Test Loss: 1.312 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.4346823692321777
Epoch: 9, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.287 Vali Acc: 0.450 Test Loss: 1.287 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 1.4375534057617188
Epoch: 10, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4830987453460693
Epoch: 11, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.236 Vali Acc: 0.425 Test Loss: 1.236 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.457634687423706
Epoch: 12, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.208 Vali Acc: 0.425 Test Loss: 1.208 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5230796337127686
Epoch: 13, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.453514814376831
Epoch: 14, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.145 Vali Acc: 0.550 Test Loss: 1.145 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 1.3772013187408447
Epoch: 15, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 1.3844566345214844
Epoch: 16, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.081 Vali Acc: 0.625 Test Loss: 1.081 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 1.3747692108154297
Epoch: 17, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 1.3651347160339355
Epoch: 18, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.017 Vali Acc: 0.625 Test Loss: 1.017 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 1.248051643371582
Epoch: 19, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 1.5107421875
Epoch: 20, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.945 Vali Acc: 0.725 Test Loss: 0.945 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 1.4716346263885498
Epoch: 21, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 1.7636597156524658
Epoch: 22, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.876 Vali Acc: 0.825 Test Loss: 0.876 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 23 cost time: 1.4861760139465332
Epoch: 23, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.841 Vali Acc: 0.850 Test Loss: 0.841 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.3676416873931885
Epoch: 24, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.810 Vali Acc: 0.850 Test Loss: 0.810 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 1.4889979362487793
Epoch: 25, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4490041732788086
Epoch: 26, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.417388677597046
Epoch: 27, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.487586498260498
Epoch: 28, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3743610382080078
Epoch: 29, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6150469779968262
Epoch: 30, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.658 Vali Acc: 0.850 Test Loss: 0.658 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 443412
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1132760047912598
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.414 Vali Acc: 0.200 Test Loss: 1.414 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.1049764156341553
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.390 Vali Acc: 0.200 Test Loss: 1.390 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.2569653987884521
Epoch: 3, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.3010618686676025
Epoch: 4, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.249147891998291
Epoch: 5, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.2392382621765137
Epoch: 6, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.289 Vali Acc: 0.575 Test Loss: 1.289 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 1.33669114112854
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.260 Vali Acc: 0.600 Test Loss: 1.260 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 1.2315471172332764
Epoch: 8, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 1.3199386596679688
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.202 Vali Acc: 0.625 Test Loss: 1.202 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 1.2106823921203613
Epoch: 10, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 1.1802425384521484
Epoch: 11, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.140599012374878
Epoch: 12, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.2144348621368408
Epoch: 13, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.081 Vali Acc: 0.625 Test Loss: 1.081 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.277763843536377
Epoch: 14, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.3267958164215088
Epoch: 15, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 1.2401204109191895
Epoch: 16, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 1.232104778289795
Epoch: 17, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.3928978443145752
Epoch: 18, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 1.2957453727722168
Epoch: 19, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 1.4570801258087158
Epoch: 20, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 1.1733338832855225
Epoch: 21, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.1734890937805176
Epoch: 22, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 1.2233467102050781
Epoch: 23, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.787 Vali Acc: 0.800 Test Loss: 0.787 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 1.190887451171875
Epoch: 24, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 25 cost time: 1.290971279144287
Epoch: 25, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 26 cost time: 1.2315502166748047
Epoch: 26, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 1.2895355224609375
Epoch: 27, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 28 cost time: 1.316784381866455
Epoch: 28, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.668 Vali Acc: 0.900 Test Loss: 0.668 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 1.25351881980896
Epoch: 29, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 1.372523546218872
Epoch: 30, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 132900
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4604969024658203
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.460 Vali Acc: 0.175 Test Loss: 1.460 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 1.24609375
Epoch: 2, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.448 Vali Acc: 0.200 Test Loss: 1.448 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.2322039604187012
Epoch: 3, Steps: 3 | Train Loss: 1.478 Vali Loss: 1.431 Vali Acc: 0.250 Test Loss: 1.431 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.369269847869873
Epoch: 4, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.2391011714935303
Epoch: 5, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.275639295578003
Epoch: 6, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.359 Vali Acc: 0.425 Test Loss: 1.359 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 1.2640774250030518
Epoch: 7, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.1951370239257812
Epoch: 8, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.308 Vali Acc: 0.450 Test Loss: 1.308 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 1.4087917804718018
Epoch: 9, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.284 Vali Acc: 0.450 Test Loss: 1.284 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 1.3007168769836426
Epoch: 10, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.260 Vali Acc: 0.450 Test Loss: 1.260 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 1.4786412715911865
Epoch: 11, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.236 Vali Acc: 0.425 Test Loss: 1.236 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3200082778930664
Epoch: 12, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.211 Vali Acc: 0.450 Test Loss: 1.211 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 1.3329944610595703
Epoch: 13, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.3581047058105469
Epoch: 14, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 1.402139663696289
Epoch: 15, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 1.353015661239624
Epoch: 16, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3460958003997803
Epoch: 17, Steps: 3 | Train Loss: 0.857 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 1.3052282333374023
Epoch: 18, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 1.3879458904266357
Epoch: 19, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 1.336629867553711
Epoch: 20, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.950 Vali Acc: 0.675 Test Loss: 0.950 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 1.4047181606292725
Epoch: 21, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.912 Vali Acc: 0.700 Test Loss: 0.912 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 1.1810598373413086
Epoch: 22, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.877 Vali Acc: 0.675 Test Loss: 0.877 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4125568866729736
Epoch: 23, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.839 Vali Acc: 0.700 Test Loss: 0.839 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.4793345928192139
Epoch: 24, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.699992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 1.3938453197479248
Epoch: 25, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.762 Vali Acc: 0.825 Test Loss: 0.762 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.3700644969940186
Epoch: 26, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 1.396296501159668
Epoch: 27, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 1.3307478427886963
Epoch: 28, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.3724250793457031
Epoch: 29, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 1.4622275829315186
Epoch: 30, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 443412
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.143911123275757
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.447 Vali Acc: 0.150 Test Loss: 1.447 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.1293504238128662
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.423 Vali Acc: 0.175 Test Loss: 1.423 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.1352388858795166
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 1.3482661247253418
Epoch: 4, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.2563903331756592
Epoch: 5, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.354 Vali Acc: 0.325 Test Loss: 1.354 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.2458016872406006
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.2319707870483398
Epoch: 7, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.296 Vali Acc: 0.450 Test Loss: 1.296 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.1344642639160156
Epoch: 8, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.267 Vali Acc: 0.525 Test Loss: 1.267 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 1.1642165184020996
Epoch: 9, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.238 Vali Acc: 0.575 Test Loss: 1.238 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 1.1677443981170654
Epoch: 10, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.208 Vali Acc: 0.600 Test Loss: 1.208 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 1.1627893447875977
Epoch: 11, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.178 Vali Acc: 0.625 Test Loss: 1.178 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 12 cost time: 1.2284622192382812
Epoch: 12, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.1771998405456543
Epoch: 13, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1186256408691406
Epoch: 14, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2685341835021973
Epoch: 15, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2759771347045898
Epoch: 16, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2685754299163818
Epoch: 17, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 1.2052972316741943
Epoch: 18, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 1.2087810039520264
Epoch: 19, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.941 Vali Acc: 0.675 Test Loss: 0.941 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674991).  Saving model ...
Epoch: 20 cost time: 1.3090364933013916
Epoch: 20, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.913 Vali Acc: 0.675 Test Loss: 0.913 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 21 cost time: 1.3984839916229248
Epoch: 21, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.886 Vali Acc: 0.700 Test Loss: 0.886 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 22 cost time: 1.2453007698059082
Epoch: 22, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 23 cost time: 1.148294448852539
Epoch: 23, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.833 Vali Acc: 0.700 Test Loss: 0.833 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.2921841144561768
Epoch: 24, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.808 Vali Acc: 0.725 Test Loss: 0.808 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 25 cost time: 1.1452610492706299
Epoch: 25, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.784 Vali Acc: 0.675 Test Loss: 0.784 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2879822254180908
Epoch: 26, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.761 Vali Acc: 0.700 Test Loss: 0.761 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2440528869628906
Epoch: 27, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.740 Vali Acc: 0.700 Test Loss: 0.740 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2812020778656006
Epoch: 28, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.719 Vali Acc: 0.700 Test Loss: 0.719 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.195324182510376
Epoch: 29, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.699 Vali Acc: 0.750 Test Loss: 0.699 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 1.2206249237060547
Epoch: 30, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 132900
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8443710803985596
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.460 Vali Acc: 0.150 Test Loss: 1.460 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.0825910568237305
Epoch: 2, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.448 Vali Acc: 0.175 Test Loss: 1.448 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.0106046199798584
Epoch: 3, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.432 Vali Acc: 0.250 Test Loss: 1.432 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.0855348110198975
Epoch: 4, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.412 Vali Acc: 0.375 Test Loss: 1.412 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.0487091541290283
Epoch: 5, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.390 Vali Acc: 0.400 Test Loss: 1.390 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.061598539352417
Epoch: 6, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.367 Vali Acc: 0.400 Test Loss: 1.367 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.9068100452423096
Epoch: 7, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.9501469135284424
Epoch: 8, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 0.9528102874755859
Epoch: 9, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.296 Vali Acc: 0.450 Test Loss: 1.296 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.8376815319061279
Epoch: 10, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.271 Vali Acc: 0.450 Test Loss: 1.271 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 0.9336261749267578
Epoch: 11, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.246 Vali Acc: 0.450 Test Loss: 1.246 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 12 cost time: 0.8336710929870605
Epoch: 12, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.220 Vali Acc: 0.450 Test Loss: 1.220 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 1.0694046020507812
Epoch: 13, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.193 Vali Acc: 0.450 Test Loss: 1.193 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 1.1480951309204102
Epoch: 14, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.164 Vali Acc: 0.525 Test Loss: 1.164 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 1.1288321018218994
Epoch: 15, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.135 Vali Acc: 0.550 Test Loss: 1.135 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 1.0598711967468262
Epoch: 16, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.106 Vali Acc: 0.575 Test Loss: 1.106 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 1.0260186195373535
Epoch: 17, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 1.0488524436950684
Epoch: 18, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.042 Vali Acc: 0.625 Test Loss: 1.042 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 1.0738956928253174
Epoch: 19, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.011 Vali Acc: 0.675 Test Loss: 1.011 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 1.0476524829864502
Epoch: 20, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.9867289066314697
Epoch: 21, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.949 Vali Acc: 0.725 Test Loss: 0.949 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 1.008573055267334
Epoch: 22, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 23 cost time: 0.9559590816497803
Epoch: 23, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.886 Vali Acc: 0.725 Test Loss: 0.886 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 24 cost time: 1.0106878280639648
Epoch: 24, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 1.1230583190917969
Epoch: 25, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 1.178485631942749
Epoch: 26, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 1.1032471656799316
Epoch: 27, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 1.1416893005371094
Epoch: 28, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0256004333496094
Epoch: 29, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.027571201324463
Epoch: 30, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.736 Vali Acc: 0.875 Test Loss: 0.736 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 443412
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8914272785186768
Epoch: 1, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.458 Vali Acc: 0.175 Test Loss: 1.458 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 1.0481231212615967
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.433 Vali Acc: 0.175 Test Loss: 1.433 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.0912847518920898
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.415 Vali Acc: 0.200 Test Loss: 1.415 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.9115111827850342
Epoch: 4, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.391 Vali Acc: 0.250 Test Loss: 1.391 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.9972107410430908
Epoch: 5, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.0705831050872803
Epoch: 6, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.336 Vali Acc: 0.425 Test Loss: 1.336 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.9601917266845703
Epoch: 7, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.309 Vali Acc: 0.475 Test Loss: 1.309 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.9103529453277588
Epoch: 8, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.002018690109253
Epoch: 9, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 1.0520389080047607
Epoch: 10, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.9642019271850586
Epoch: 11, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0329508781433105
Epoch: 12, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.167 Vali Acc: 0.550 Test Loss: 1.167 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0231273174285889
Epoch: 13, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.137 Vali Acc: 0.525 Test Loss: 1.137 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1131036281585693
Epoch: 14, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.108 Vali Acc: 0.550 Test Loss: 1.108 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0454230308532715
Epoch: 15, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.078 Vali Acc: 0.575 Test Loss: 1.078 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 0.9917812347412109
Epoch: 16, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 0.9310896396636963
Epoch: 17, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.016 Vali Acc: 0.625 Test Loss: 1.016 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 1.0533778667449951
Epoch: 18, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 0.9432456493377686
Epoch: 19, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.959 Vali Acc: 0.650 Test Loss: 0.959 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 0.9408447742462158
Epoch: 20, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.933 Vali Acc: 0.650 Test Loss: 0.933 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 21 cost time: 0.961998701095581
Epoch: 21, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.908 Vali Acc: 0.650 Test Loss: 0.908 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 22 cost time: 1.0143134593963623
Epoch: 22, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.883 Vali Acc: 0.650 Test Loss: 0.883 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 23 cost time: 1.0559017658233643
Epoch: 23, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.859 Vali Acc: 0.650 Test Loss: 0.859 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 24 cost time: 1.065281867980957
Epoch: 24, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.835 Vali Acc: 0.650 Test Loss: 0.835 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649992).  Saving model ...
Epoch: 25 cost time: 1.1022274494171143
Epoch: 25, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.811 Vali Acc: 0.700 Test Loss: 0.811 Test Acc: 0.700
Validation loss decreased (-0.649992 --> -0.699992).  Saving model ...
Epoch: 26 cost time: 1.071199655532837
Epoch: 26, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.789 Vali Acc: 0.700 Test Loss: 0.789 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 27 cost time: 0.9676203727722168
Epoch: 27, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.768 Vali Acc: 0.700 Test Loss: 0.768 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 28 cost time: 1.076338529586792
Epoch: 28, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.748 Vali Acc: 0.700 Test Loss: 0.748 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699993).  Saving model ...
Epoch: 29 cost time: 0.9325296878814697
Epoch: 29, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.729 Vali Acc: 0.700 Test Loss: 0.729 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 30 cost time: 1.050102710723877
Epoch: 30, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.715 Vali Acc: 0.725 Test Loss: 0.715 Test Acc: 0.725
Validation loss decreased (-0.699993 --> -0.724993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 132900
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.0409111976623535
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.449 Vali Acc: 0.225 Test Loss: 1.449 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.5695030689239502
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.432 Vali Acc: 0.350 Test Loss: 1.432 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.5288667678833008
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.417 Vali Acc: 0.375 Test Loss: 1.417 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.6647546291351318
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.5618622303009033
Epoch: 5, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.375 Vali Acc: 0.425 Test Loss: 1.375 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 1.672905683517456
Epoch: 6, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.351 Vali Acc: 0.425 Test Loss: 1.351 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 1.5214672088623047
Epoch: 7, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.330 Vali Acc: 0.450 Test Loss: 1.330 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.752910852432251
Epoch: 8, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.305 Vali Acc: 0.475 Test Loss: 1.305 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.6908609867095947
Epoch: 9, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 1.6360361576080322
Epoch: 10, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.254 Vali Acc: 0.475 Test Loss: 1.254 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 1.703012228012085
Epoch: 11, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.229 Vali Acc: 0.475 Test Loss: 1.229 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 1.7017476558685303
Epoch: 12, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.3683269023895264
Epoch: 13, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.177 Vali Acc: 0.525 Test Loss: 1.177 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.751072883605957
Epoch: 14, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.149 Vali Acc: 0.550 Test Loss: 1.149 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 15 cost time: 1.415590524673462
Epoch: 15, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 1.6697402000427246
Epoch: 16, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.089 Vali Acc: 0.550 Test Loss: 1.089 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.6672914028167725
Epoch: 17, Steps: 3 | Train Loss: 0.827 Vali Loss: 1.058 Vali Acc: 0.550 Test Loss: 1.058 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 1.4748623371124268
Epoch: 18, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 1.8043198585510254
Epoch: 19, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 20 cost time: 1.6452326774597168
Epoch: 20, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 1.7546842098236084
Epoch: 21, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 22 cost time: 1.5529046058654785
Epoch: 22, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 1.6973865032196045
Epoch: 23, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6667683124542236
Epoch: 24, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 25 cost time: 1.6526460647583008
Epoch: 25, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.813 Vali Acc: 0.825 Test Loss: 0.813 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 2.0363659858703613
Epoch: 26, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 1.6966307163238525
Epoch: 27, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 1.7173807621002197
Epoch: 28, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6539232730865479
Epoch: 29, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6833257675170898
Epoch: 30, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.687 Vali Acc: 0.825 Test Loss: 0.687 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 223476
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.5197150707244873
Epoch: 1, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.445 Vali Acc: 0.200 Test Loss: 1.445 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.3627843856811523
Epoch: 2, Steps: 3 | Train Loss: 1.555 Vali Loss: 1.426 Vali Acc: 0.200 Test Loss: 1.426 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.5609772205352783
Epoch: 3, Steps: 3 | Train Loss: 1.530 Vali Loss: 1.413 Vali Acc: 0.200 Test Loss: 1.413 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 1.3955779075622559
Epoch: 4, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.394 Vali Acc: 0.200 Test Loss: 1.394 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 1.271303415298462
Epoch: 5, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.372 Vali Acc: 0.250 Test Loss: 1.372 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.4398469924926758
Epoch: 6, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.347 Vali Acc: 0.275 Test Loss: 1.347 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 1.4536778926849365
Epoch: 7, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.321 Vali Acc: 0.475 Test Loss: 1.321 Test Acc: 0.475
Validation loss decreased (-0.274987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 1.509582281112671
Epoch: 8, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.6128997802734375
Epoch: 9, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 1.5107765197753906
Epoch: 10, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 1.365206241607666
Epoch: 11, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.204 Vali Acc: 0.575 Test Loss: 1.204 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.6133792400360107
Epoch: 12, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 1.4489634037017822
Epoch: 13, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.139 Vali Acc: 0.575 Test Loss: 1.139 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 14 cost time: 1.5792701244354248
Epoch: 14, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 1.210801601409912
Epoch: 15, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.5226101875305176
Epoch: 16, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.035 Vali Acc: 0.675 Test Loss: 1.035 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 1.5106651782989502
Epoch: 17, Steps: 3 | Train Loss: 0.989 Vali Loss: 0.999 Vali Acc: 0.750 Test Loss: 0.999 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 1.7154796123504639
Epoch: 18, Steps: 3 | Train Loss: 0.934 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 1.4000730514526367
Epoch: 19, Steps: 3 | Train Loss: 0.939 Vali Loss: 0.922 Vali Acc: 0.825 Test Loss: 0.922 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 20 cost time: 1.6256780624389648
Epoch: 20, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.883 Vali Acc: 0.900 Test Loss: 0.883 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899991).  Saving model ...
Epoch: 21 cost time: 1.4125285148620605
Epoch: 21, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.844 Vali Acc: 0.925 Test Loss: 0.844 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 22 cost time: 1.4092271327972412
Epoch: 22, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.806 Vali Acc: 0.925 Test Loss: 0.806 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 23 cost time: 1.359886884689331
Epoch: 23, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.771 Vali Acc: 0.925 Test Loss: 0.771 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 24 cost time: 1.394120454788208
Epoch: 24, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.737 Vali Acc: 0.925 Test Loss: 0.737 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 25 cost time: 1.467578411102295
Epoch: 25, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.706 Vali Acc: 0.925 Test Loss: 0.706 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 26 cost time: 1.4979088306427002
Epoch: 26, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.683 Vali Acc: 0.925 Test Loss: 0.683 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 1.2833771705627441
Epoch: 27, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.656 Vali Acc: 0.950 Test Loss: 0.656 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 28 cost time: 1.2153575420379639
Epoch: 28, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.630 Vali Acc: 0.950 Test Loss: 0.630 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 1.3006556034088135
Epoch: 29, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.607 Vali Acc: 0.950 Test Loss: 0.607 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 1.1882638931274414
Epoch: 30, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.583 Vali Acc: 0.950 Test Loss: 0.583 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 68196
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.567464828491211
Epoch: 1, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.441 Vali Acc: 0.300 Test Loss: 1.441 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.5784060955047607
Epoch: 2, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.425 Vali Acc: 0.350 Test Loss: 1.425 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.5329551696777344
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.411 Vali Acc: 0.350 Test Loss: 1.411 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.544813632965088
Epoch: 4, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.4720311164855957
Epoch: 5, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.373 Vali Acc: 0.350 Test Loss: 1.373 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5017130374908447
Epoch: 6, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 1.529693365097046
Epoch: 7, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.329 Vali Acc: 0.450 Test Loss: 1.329 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.510026216506958
Epoch: 8, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.306 Vali Acc: 0.475 Test Loss: 1.306 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.4119973182678223
Epoch: 9, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.604222297668457
Epoch: 10, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 1.6627006530761719
Epoch: 11, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.4651978015899658
Epoch: 12, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.207 Vali Acc: 0.525 Test Loss: 1.207 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.530860185623169
Epoch: 13, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.182 Vali Acc: 0.550 Test Loss: 1.182 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 1.4795422554016113
Epoch: 14, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 1.5895941257476807
Epoch: 15, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 16 cost time: 1.772461175918579
Epoch: 16, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.095 Vali Acc: 0.575 Test Loss: 1.095 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 1.5408732891082764
Epoch: 17, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 1.6372580528259277
Epoch: 18, Steps: 3 | Train Loss: 0.839 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 1.6321110725402832
Epoch: 19, Steps: 3 | Train Loss: 0.817 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 20 cost time: 1.4560375213623047
Epoch: 20, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.971 Vali Acc: 0.675 Test Loss: 0.971 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 1.8596043586730957
Epoch: 21, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 22 cost time: 1.497445821762085
Epoch: 22, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 1.5603721141815186
Epoch: 23, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5891852378845215
Epoch: 24, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.845 Vali Acc: 0.825 Test Loss: 0.845 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 25 cost time: 1.4599575996398926
Epoch: 25, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.675614356994629
Epoch: 26, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.785 Vali Acc: 0.825 Test Loss: 0.785 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 1.4896795749664307
Epoch: 27, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 1.2292799949645996
Epoch: 28, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.6101984977722168
Epoch: 29, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.5698046684265137
Epoch: 30, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 223476
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.198096752166748
Epoch: 1, Steps: 3 | Train Loss: 1.570 Vali Loss: 1.454 Vali Acc: 0.200 Test Loss: 1.454 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.1229219436645508
Epoch: 2, Steps: 3 | Train Loss: 1.566 Vali Loss: 1.435 Vali Acc: 0.200 Test Loss: 1.435 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.2805123329162598
Epoch: 3, Steps: 3 | Train Loss: 1.537 Vali Loss: 1.422 Vali Acc: 0.200 Test Loss: 1.422 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 1.1286611557006836
Epoch: 4, Steps: 3 | Train Loss: 1.552 Vali Loss: 1.403 Vali Acc: 0.200 Test Loss: 1.403 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 1.0518414974212646
Epoch: 5, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.382 Vali Acc: 0.200 Test Loss: 1.382 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 6 cost time: 1.1055691242218018
Epoch: 6, Steps: 3 | Train Loss: 1.482 Vali Loss: 1.359 Vali Acc: 0.250 Test Loss: 1.359 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.2134597301483154
Epoch: 7, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.334 Vali Acc: 0.425 Test Loss: 1.334 Test Acc: 0.425
Validation loss decreased (-0.249986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.197525978088379
Epoch: 8, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.307 Vali Acc: 0.475 Test Loss: 1.307 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.019378423690796
Epoch: 9, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 1.3468682765960693
Epoch: 10, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 1.1518325805664062
Epoch: 11, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 1.3857030868530273
Epoch: 12, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 1.2334845066070557
Epoch: 13, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.158 Vali Acc: 0.575 Test Loss: 1.158 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 1.2275872230529785
Epoch: 14, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.1672091484069824
Epoch: 15, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.092 Vali Acc: 0.650 Test Loss: 1.092 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.2182385921478271
Epoch: 16, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 1.2253408432006836
Epoch: 17, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.1923859119415283
Epoch: 18, Steps: 3 | Train Loss: 0.965 Vali Loss: 0.983 Vali Acc: 0.775 Test Loss: 0.983 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 1.1279354095458984
Epoch: 19, Steps: 3 | Train Loss: 0.961 Vali Loss: 0.944 Vali Acc: 0.825 Test Loss: 0.944 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 20 cost time: 1.2351536750793457
Epoch: 20, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.905 Vali Acc: 0.875 Test Loss: 0.905 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874991).  Saving model ...
Epoch: 21 cost time: 1.2072641849517822
Epoch: 21, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.864 Vali Acc: 0.875 Test Loss: 0.864 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 1.0625767707824707
Epoch: 22, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.825 Vali Acc: 0.875 Test Loss: 0.825 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 1.219545602798462
Epoch: 23, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 24 cost time: 1.1980774402618408
Epoch: 24, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.754 Vali Acc: 0.900 Test Loss: 0.754 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 1.2321486473083496
Epoch: 25, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.722 Vali Acc: 0.925 Test Loss: 0.722 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 26 cost time: 0.9511792659759521
Epoch: 26, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.694 Vali Acc: 0.925 Test Loss: 0.694 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 1.0051867961883545
Epoch: 27, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.667 Vali Acc: 0.925 Test Loss: 0.667 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 1.179133415222168
Epoch: 28, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.642 Vali Acc: 0.950 Test Loss: 0.642 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 1.3027820587158203
Epoch: 29, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.619 Vali Acc: 0.950 Test Loss: 0.619 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 1.1725363731384277
Epoch: 30, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.597 Vali Acc: 0.950 Test Loss: 0.597 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 68196
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0028903484344482
Epoch: 1, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.459 Vali Acc: 0.150 Test Loss: 1.459 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.3119091987609863
Epoch: 2, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (-0.149985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.3036975860595703
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.428 Vali Acc: 0.350 Test Loss: 1.428 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.078826904296875
Epoch: 4, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.410 Vali Acc: 0.350 Test Loss: 1.410 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.247558832168579
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.390 Vali Acc: 0.350 Test Loss: 1.390 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.2769408226013184
Epoch: 6, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 1.306915521621704
Epoch: 7, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.2689335346221924
Epoch: 8, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.323 Vali Acc: 0.475 Test Loss: 1.323 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.0269923210144043
Epoch: 9, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.298 Vali Acc: 0.450 Test Loss: 1.298 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3272829055786133
Epoch: 10, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.275 Vali Acc: 0.475 Test Loss: 1.275 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 1.2449209690093994
Epoch: 11, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.250 Vali Acc: 0.475 Test Loss: 1.250 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 1.3853373527526855
Epoch: 12, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.225 Vali Acc: 0.525 Test Loss: 1.225 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.2903594970703125
Epoch: 13, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.2608890533447266
Epoch: 14, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 1.359968662261963
Epoch: 15, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 1.4600646495819092
Epoch: 16, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 17 cost time: 1.3539886474609375
Epoch: 17, Steps: 3 | Train Loss: 0.820 Vali Loss: 1.078 Vali Acc: 0.625 Test Loss: 1.078 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 1.3188374042510986
Epoch: 18, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.048 Vali Acc: 0.625 Test Loss: 1.048 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 1.2707626819610596
Epoch: 19, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.016 Vali Acc: 0.650 Test Loss: 1.016 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 1.3670732975006104
Epoch: 20, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 1.28230619430542
Epoch: 21, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.952 Vali Acc: 0.675 Test Loss: 0.952 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 1.3357930183410645
Epoch: 22, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.922 Vali Acc: 0.650 Test Loss: 0.922 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2880561351776123
Epoch: 23, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.893 Vali Acc: 0.700 Test Loss: 0.893 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 24 cost time: 1.2893192768096924
Epoch: 24, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 1.2772042751312256
Epoch: 25, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 1.3232676982879639
Epoch: 26, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.815 Vali Acc: 0.750 Test Loss: 0.815 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 27 cost time: 1.2794852256774902
Epoch: 27, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 1.355069875717163
Epoch: 28, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.759 Vali Acc: 0.825 Test Loss: 0.759 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 29 cost time: 1.3839080333709717
Epoch: 29, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.3589179515838623
Epoch: 30, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 223476
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8743362426757812
Epoch: 1, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.478 Vali Acc: 0.125 Test Loss: 1.478 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.0682506561279297
Epoch: 2, Steps: 3 | Train Loss: 1.558 Vali Loss: 1.459 Vali Acc: 0.125 Test Loss: 1.459 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 1.0316555500030518
Epoch: 3, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.446 Vali Acc: 0.125 Test Loss: 1.446 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 1.0764546394348145
Epoch: 4, Steps: 3 | Train Loss: 1.548 Vali Loss: 1.427 Vali Acc: 0.125 Test Loss: 1.427 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 5 cost time: 1.0595672130584717
Epoch: 5, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.405 Vali Acc: 0.125 Test Loss: 1.405 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 6 cost time: 1.0271613597869873
Epoch: 6, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.381 Vali Acc: 0.150 Test Loss: 1.381 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 7 cost time: 0.9831862449645996
Epoch: 7, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
Validation loss decreased (-0.149986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 1.0300946235656738
Epoch: 8, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.329 Vali Acc: 0.475 Test Loss: 1.329 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.0521137714385986
Epoch: 9, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.301 Vali Acc: 0.475 Test Loss: 1.301 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 1.0546448230743408
Epoch: 10, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 1.059683084487915
Epoch: 11, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.8736667633056641
Epoch: 12, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.1579504013061523
Epoch: 13, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.179 Vali Acc: 0.525 Test Loss: 1.179 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.0416154861450195
Epoch: 14, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.134235143661499
Epoch: 15, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.114 Vali Acc: 0.675 Test Loss: 1.114 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 1.0231497287750244
Epoch: 16, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.080 Vali Acc: 0.750 Test Loss: 1.080 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749989).  Saving model ...
Epoch: 17 cost time: 1.10817551612854
Epoch: 17, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.045 Vali Acc: 0.775 Test Loss: 1.045 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.0849690437316895
Epoch: 18, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.008 Vali Acc: 0.825 Test Loss: 1.008 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 19 cost time: 1.0495262145996094
Epoch: 19, Steps: 3 | Train Loss: 0.980 Vali Loss: 0.971 Vali Acc: 0.850 Test Loss: 0.971 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 20 cost time: 1.0633761882781982
Epoch: 20, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.933 Vali Acc: 0.900 Test Loss: 0.933 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 21 cost time: 1.0444388389587402
Epoch: 21, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.895 Vali Acc: 0.900 Test Loss: 0.895 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 22 cost time: 1.1454367637634277
Epoch: 22, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.857 Vali Acc: 0.900 Test Loss: 0.857 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 23 cost time: 1.0260519981384277
Epoch: 23, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.822 Vali Acc: 0.900 Test Loss: 0.822 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 24 cost time: 1.0463018417358398
Epoch: 24, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 1.0238358974456787
Epoch: 25, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.757 Vali Acc: 0.900 Test Loss: 0.757 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 26 cost time: 1.0196354389190674
Epoch: 26, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.729 Vali Acc: 0.900 Test Loss: 0.729 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 1.0598461627960205
Epoch: 27, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.8764417171478271
Epoch: 28, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 1.0396044254302979
Epoch: 29, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 30 cost time: 1.0747079849243164
Epoch: 30, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 68196
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 6.202872276306152
Epoch: 1, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.392 Vali Acc: 0.350 Test Loss: 1.392 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 4.160458564758301
Epoch: 2, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.305 Vali Acc: 0.450 Test Loss: 1.305 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 4.14211368560791
Epoch: 3, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
Validation loss decreased (-0.449987 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 4.101939678192139
Epoch: 4, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.828 Vali Acc: 0.825 Test Loss: 0.828 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 4.0287230014801025
Epoch: 5, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 4.160984516143799
Epoch: 6, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 4.243658065795898
Epoch: 7, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 8 cost time: 4.039916276931763
Epoch: 8, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 4.015766382217407
Epoch: 9, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 3.840226411819458
Epoch: 10, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 4.051194429397583
Epoch: 11, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 4.19274115562439
Epoch: 12, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 4.07751202583313
Epoch: 13, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 3.9784393310546875
Epoch: 14, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.789165496826172
Epoch: 15, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7871415615081787
Epoch: 16, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.7716236114501953
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.140883684158325
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.025831937789917
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.13849401473999
Epoch: 20, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.1064536571502686
Epoch: 21, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.195288181304932
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.011534690856934
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37545476
model size : 145.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.702575445175171
Epoch: 1, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.515 Vali Acc: 0.375 Test Loss: 1.515 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 1.7510967254638672
Epoch: 2, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.438 Vali Acc: 0.400 Test Loss: 1.438 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.7200875282287598
Epoch: 3, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.237 Vali Acc: 0.600 Test Loss: 1.237 Test Acc: 0.600
Validation loss decreased (-0.399986 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.659217357635498
Epoch: 4, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.006 Vali Acc: 0.775 Test Loss: 1.006 Test Acc: 0.775
Validation loss decreased (-0.599988 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.795363187789917
Epoch: 5, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 1.708416223526001
Epoch: 6, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.584 Vali Acc: 0.950 Test Loss: 0.584 Test Acc: 0.950
Validation loss decreased (-0.849992 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 1.6528851985931396
Epoch: 7, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.414 Vali Acc: 1.000 Test Loss: 0.414 Test Acc: 1.000
Validation loss decreased (-0.949994 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11067396
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.54448127746582
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.405 Vali Acc: 0.350 Test Loss: 1.405 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 3.24686598777771
Epoch: 2, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.318 Vali Acc: 0.450 Test Loss: 1.318 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 3.0612974166870117
Epoch: 3, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.101 Vali Acc: 0.625 Test Loss: 1.101 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 3.1856281757354736
Epoch: 4, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 3.2558364868164062
Epoch: 5, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 2.948794364929199
Epoch: 6, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 2.883342742919922
Epoch: 7, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 3.098715305328369
Epoch: 8, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.675203561782837
Epoch: 9, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 3.1512463092803955
Epoch: 10, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9436187744140625
Epoch: 11, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 3.0602974891662598
Epoch: 12, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 3.159118890762329
Epoch: 13, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9637386798858643
Epoch: 14, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9621481895446777
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 3.012221097946167
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.021426200866699
Epoch: 17, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.016038179397583
Epoch: 18, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.992058515548706
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9011130332946777
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 2.9853515625
Epoch: 21, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 2.8635811805725098
Epoch: 22, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.950 Test Loss: 0.116 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.844273805618286
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.950 Test Loss: 0.106 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.834627151489258
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.950 Test Loss: 0.104 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.90386962890625
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 2.4571778774261475
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.8694493770599365
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9387519359588623
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.7759718894958496
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0088555812835693
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37545476
model size : 145.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.040522336959839
Epoch: 1, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.498 Vali Acc: 0.350 Test Loss: 1.498 Test Acc: 0.350
Validation loss decreased (inf --> -0.349985).  Saving model ...
Epoch: 2 cost time: 1.336615800857544
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.419 Vali Acc: 0.400 Test Loss: 1.419 Test Acc: 0.400
Validation loss decreased (-0.349985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.414719581604004
Epoch: 3, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.225 Vali Acc: 0.575 Test Loss: 1.225 Test Acc: 0.575
Validation loss decreased (-0.399986 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.4206008911132812
Epoch: 4, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.574988 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.4058382511138916
Epoch: 5, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 1.408914566040039
Epoch: 6, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.651 Vali Acc: 0.925 Test Loss: 0.651 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924993).  Saving model ...
Epoch: 7 cost time: 1.4837021827697754
Epoch: 7, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 1.4656062126159668
Epoch: 8, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.371 Vali Acc: 1.000 Test Loss: 0.371 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11067396
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.63893985748291
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.408 Vali Acc: 0.350 Test Loss: 1.408 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 2.0372321605682373
Epoch: 2, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.9197111129760742
Epoch: 3, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 1.886620044708252
Epoch: 4, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.947 Vali Acc: 0.650 Test Loss: 0.947 Test Acc: 0.650
Validation loss decreased (-0.499989 --> -0.649991).  Saving model ...
Epoch: 5 cost time: 1.9367506504058838
Epoch: 5, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.776 Vali Acc: 0.675 Test Loss: 0.776 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674992).  Saving model ...
Epoch: 6 cost time: 2.0060172080993652
Epoch: 6, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.674992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.9857237339019775
Epoch: 7, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.477 Vali Acc: 0.925 Test Loss: 0.477 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 2.028752326965332
Epoch: 8, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 2.0958826541900635
Epoch: 9, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 1.9164690971374512
Epoch: 10, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8295059204101562
Epoch: 11, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.8821771144866943
Epoch: 12, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8492038249969482
Epoch: 13, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9876651763916016
Epoch: 14, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.990140676498413
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6998844146728516
Epoch: 16, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8090989589691162
Epoch: 17, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9823112487792969
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8361740112304688
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 2.0047504901885986
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9227819442749023
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9249112606048584
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.925 Test Loss: 0.209 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8636879920959473
Epoch: 23, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.925 Test Loss: 0.239 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8736486434936523
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.925 Test Loss: 0.196 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9463684558868408
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6982951164245605
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8198785781860352
Epoch: 27, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.797867774963379
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8668193817138672
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 37545476
model size : 145.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6810495853424072
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.492 Vali Acc: 0.375 Test Loss: 1.492 Test Acc: 0.375
Validation loss decreased (inf --> -0.374985).  Saving model ...
Epoch: 2 cost time: 1.1694035530090332
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.1392900943756104
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.0608410835266113
Epoch: 4, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 0.9762816429138184
Epoch: 5, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.9459707736968994
Epoch: 6, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.714 Vali Acc: 0.875 Test Loss: 0.714 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.9917230606079102
Epoch: 7, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 1.045436143875122
Epoch: 8, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.478 Vali Acc: 0.975 Test Loss: 0.478 Test Acc: 0.975
Validation loss decreased (-0.899994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 0.9981889724731445
Epoch: 9, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.395 Vali Acc: 0.975 Test Loss: 0.395 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.9477815628051758
Epoch: 10, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.989764928817749
Epoch: 11, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.8858962059020996
Epoch: 12, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 1.000 Test Loss: 0.275 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 11067396
model size : 44.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.829787969589233
Epoch: 1, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.291 Vali Acc: 0.575 Test Loss: 1.291 Test Acc: 0.575
Validation loss decreased (inf --> -0.574987).  Saving model ...
Epoch: 2 cost time: 2.783961057662964
Epoch: 2, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.225 Vali Acc: 0.600 Test Loss: 1.225 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 2.6949658393859863
Epoch: 3, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.072 Vali Acc: 0.875 Test Loss: 1.072 Test Acc: 0.875
Validation loss decreased (-0.599988 --> -0.874989).  Saving model ...
Epoch: 4 cost time: 2.7995612621307373
Epoch: 4, Steps: 3 | Train Loss: 0.907 Vali Loss: 0.897 Vali Acc: 0.875 Test Loss: 0.897 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 2.7621817588806152
Epoch: 5, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.697 Vali Acc: 0.925 Test Loss: 0.697 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 2.7780745029449463
Epoch: 6, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.522 Vali Acc: 0.950 Test Loss: 0.522 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 7 cost time: 2.858203411102295
Epoch: 7, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 2.812312602996826
Epoch: 8, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 2.906240701675415
Epoch: 9, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 2.846897602081299
Epoch: 10, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 2.8046061992645264
Epoch: 11, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.213 Vali Acc: 1.000 Test Loss: 0.213 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18800644
model size : 74.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2896904945373535
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.333 Vali Acc: 0.450 Test Loss: 1.333 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.2955970764160156
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.4407076835632324
Epoch: 3, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.115 Vali Acc: 0.625 Test Loss: 1.115 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.4308466911315918
Epoch: 4, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.947 Vali Acc: 0.800 Test Loss: 0.947 Test Acc: 0.800
Validation loss decreased (-0.624989 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 1.438875675201416
Epoch: 5, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.775 Vali Acc: 0.875 Test Loss: 0.775 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 1.4032890796661377
Epoch: 6, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.607 Vali Acc: 0.975 Test Loss: 0.607 Test Acc: 0.975
Validation loss decreased (-0.874992 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 1.362360954284668
Epoch: 7, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.470 Vali Acc: 0.975 Test Loss: 0.470 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 1.417759895324707
Epoch: 8, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 1.3639440536499023
Epoch: 9, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 1.1873812675476074
Epoch: 10, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 1.4243464469909668
Epoch: 11, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 1.4927287101745605
Epoch: 12, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 1.3747363090515137
Epoch: 13, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 14 cost time: 1.4038903713226318
Epoch: 14, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 15 cost time: 1.396634817123413
Epoch: 15, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 16 cost time: 1.3935465812683105
Epoch: 16, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 1.2740004062652588
Epoch: 17, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3986766338348389
Epoch: 18, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.390326738357544
Epoch: 19, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4365148544311523
Epoch: 20, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5993530750274658
Epoch: 21, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4204332828521729
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.950 Test Loss: 0.110 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3707871437072754
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5378978252410889
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4337220191955566
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.950 Test Loss: 0.113 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4021317958831787
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 1.3472576141357422
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 1.3925576210021973
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 1.4915096759796143
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 1.492128849029541
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 5561348
model size : 23.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.0725953578948975
Epoch: 1, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 2.2180075645446777
Epoch: 2, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 2.198962688446045
Epoch: 3, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.074 Vali Acc: 0.800 Test Loss: 1.074 Test Acc: 0.800
Validation loss decreased (-0.599988 --> -0.799989).  Saving model ...
Epoch: 4 cost time: 2.2069625854492188
Epoch: 4, Steps: 3 | Train Loss: 0.932 Vali Loss: 0.897 Vali Acc: 0.875 Test Loss: 0.897 Test Acc: 0.875
Validation loss decreased (-0.799989 --> -0.874991).  Saving model ...
Epoch: 5 cost time: 2.394207239151001
Epoch: 5, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.716 Vali Acc: 0.925 Test Loss: 0.716 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 2.185957431793213
Epoch: 6, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.543 Vali Acc: 0.975 Test Loss: 0.543 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974995).  Saving model ...
Epoch: 7 cost time: 2.2924997806549072
Epoch: 7, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.410 Vali Acc: 1.000 Test Loss: 0.410 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18800644
model size : 74.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1227869987487793
Epoch: 1, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.323 Vali Acc: 0.450 Test Loss: 1.323 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.198089599609375
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.248 Vali Acc: 0.525 Test Loss: 1.248 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 1.1757011413574219
Epoch: 3, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.2409274578094482
Epoch: 4, Steps: 3 | Train Loss: 0.945 Vali Loss: 0.959 Vali Acc: 0.750 Test Loss: 0.959 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 1.2516419887542725
Epoch: 5, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 1.2987678050994873
Epoch: 6, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 1.24300217628479
Epoch: 7, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.510 Vali Acc: 0.975 Test Loss: 0.510 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 1.312075138092041
Epoch: 8, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3005731105804443
Epoch: 9, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1953253746032715
Epoch: 10, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 1.2439422607421875
Epoch: 11, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 1.2023224830627441
Epoch: 12, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 1.2695083618164062
Epoch: 13, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 1.2007179260253906
Epoch: 14, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.237403154373169
Epoch: 15, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.1712615489959717
Epoch: 16, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.193589687347412
Epoch: 17, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.1686415672302246
Epoch: 18, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1933372020721436
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 1.2831778526306152
Epoch: 20, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 1.1405539512634277
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 1.121708869934082
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 1.171924352645874
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2179322242736816
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.205970287322998
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2225401401519775
Epoch: 26, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1235463619232178
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1515769958496094
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2038872241973877
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.950 Test Loss: 0.113 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0714154243469238
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 5561348
model size : 23.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2021079063415527
Epoch: 1, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.305 Vali Acc: 0.550 Test Loss: 1.305 Test Acc: 0.550
Validation loss decreased (inf --> -0.549987).  Saving model ...
Epoch: 2 cost time: 1.3412699699401855
Epoch: 2, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.236 Vali Acc: 0.575 Test Loss: 1.236 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 1.3943164348602295
Epoch: 3, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 1.3281376361846924
Epoch: 4, Steps: 3 | Train Loss: 0.969 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774990).  Saving model ...
Epoch: 5 cost time: 1.3674612045288086
Epoch: 5, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.782 Vali Acc: 0.900 Test Loss: 0.782 Test Acc: 0.900
Validation loss decreased (-0.774990 --> -0.899992).  Saving model ...
Epoch: 6 cost time: 1.3757808208465576
Epoch: 6, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.356278896331787
Epoch: 7, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.521 Vali Acc: 0.925 Test Loss: 0.521 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 1.3655962944030762
Epoch: 8, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 1.388413906097412
Epoch: 9, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4028427600860596
Epoch: 10, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 1.328369379043579
Epoch: 11, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.3679068088531494
Epoch: 12, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.370521068572998
Epoch: 13, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.257 Vali Acc: 1.000 Test Loss: 0.257 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18800644
model size : 74.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.716139078140259
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.333 Vali Acc: 0.475 Test Loss: 1.333 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.8503155708312988
Epoch: 2, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.262 Vali Acc: 0.550 Test Loss: 1.262 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.9864990711212158
Epoch: 3, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.8543896675109863
Epoch: 4, Steps: 3 | Train Loss: 0.974 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.8865325450897217
Epoch: 5, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 0.8414306640625
Epoch: 6, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.749992 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 0.8905496597290039
Epoch: 7, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.570 Vali Acc: 0.925 Test Loss: 0.570 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 0.8821380138397217
Epoch: 8, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 0.8124258518218994
Epoch: 9, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8259422779083252
Epoch: 10, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8652997016906738
Epoch: 11, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8933813571929932
Epoch: 12, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.9831066131591797
Epoch: 13, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.8629541397094727
Epoch: 14, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.7336771488189697
Epoch: 15, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 1.000 Test Loss: 0.228 Test Acc: 1.000
Validation loss decreased (-0.949998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5561348
model size : 23.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.017920255661011
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.302 Vali Acc: 0.300 Test Loss: 1.302 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 2.643852710723877
Epoch: 2, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.243 Vali Acc: 0.350 Test Loss: 1.243 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 3.050983190536499
Epoch: 3, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.107 Vali Acc: 0.525 Test Loss: 1.107 Test Acc: 0.525
Validation loss decreased (-0.349988 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 2.956059217453003
Epoch: 4, Steps: 3 | Train Loss: 0.972 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
Validation loss decreased (-0.524989 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 2.843670606613159
Epoch: 5, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.782 Vali Acc: 0.925 Test Loss: 0.782 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924992).  Saving model ...
Epoch: 6 cost time: 2.940819263458252
Epoch: 6, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.626 Vali Acc: 0.950 Test Loss: 0.626 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 3.1166610717773438
Epoch: 7, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.487 Vali Acc: 0.975 Test Loss: 0.487 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 3.0496551990509033
Epoch: 8, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 3.0198631286621094
Epoch: 9, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.273 Vali Acc: 1.000 Test Loss: 0.273 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18774276
model size : 72.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.316272497177124
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.437 Vali Acc: 0.300 Test Loss: 1.437 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.4225335121154785
Epoch: 2, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.388 Vali Acc: 0.350 Test Loss: 1.388 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.3420181274414062
Epoch: 3, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.3084444999694824
Epoch: 4, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.472809076309204
Epoch: 5, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 1.4463202953338623
Epoch: 6, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.877 Vali Acc: 0.825 Test Loss: 0.877 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 1.467897653579712
Epoch: 7, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.745 Vali Acc: 0.925 Test Loss: 0.745 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 1.3468337059020996
Epoch: 8, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.617 Vali Acc: 0.925 Test Loss: 0.617 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 1.378345251083374
Epoch: 9, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.498 Vali Acc: 0.975 Test Loss: 0.498 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 1.466932773590088
Epoch: 10, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.401 Vali Acc: 1.000 Test Loss: 0.401 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5534724
model size : 22.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.28441047668457
Epoch: 1, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.306 Vali Acc: 0.300 Test Loss: 1.306 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 2.359513521194458
Epoch: 2, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.245 Vali Acc: 0.375 Test Loss: 1.245 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 3 cost time: 2.189180374145508
Epoch: 3, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
Validation loss decreased (-0.374988 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 2.317014217376709
Epoch: 4, Steps: 3 | Train Loss: 0.958 Vali Loss: 0.942 Vali Acc: 0.850 Test Loss: 0.942 Test Acc: 0.850
Validation loss decreased (-0.699989 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 2.3134262561798096
Epoch: 5, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.807 Vali Acc: 0.850 Test Loss: 0.807 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 2.190265655517578
Epoch: 6, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.681 Vali Acc: 0.925 Test Loss: 0.681 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 7 cost time: 2.1037371158599854
Epoch: 7, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.559 Vali Acc: 1.000 Test Loss: 0.559 Test Acc: 1.000
Validation loss decreased (-0.924993 --> -0.999994).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 18774276
model size : 72.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.982184886932373
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.1264336109161377
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
Validation loss decreased (-0.274986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.1517720222473145
Epoch: 3, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.285 Vali Acc: 0.425 Test Loss: 1.285 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.1833610534667969
Epoch: 4, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.148 Vali Acc: 0.550 Test Loss: 1.148 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 1.2254512310028076
Epoch: 5, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 1.1836395263671875
Epoch: 6, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.869 Vali Acc: 0.775 Test Loss: 0.869 Test Acc: 0.775
Validation loss decreased (-0.649990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.167848825454712
Epoch: 7, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.725 Vali Acc: 0.875 Test Loss: 0.725 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 1.162459373474121
Epoch: 8, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.604 Vali Acc: 0.950 Test Loss: 0.604 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 1.168105125427246
Epoch: 9, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.502 Vali Acc: 0.975 Test Loss: 0.502 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 1.128849744796753
Epoch: 10, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.414 Vali Acc: 1.000 Test Loss: 0.414 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5534724
model size : 22.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.300240993499756
Epoch: 1, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.311 Vali Acc: 0.300 Test Loss: 1.311 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 1.426363229751587
Epoch: 2, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.256 Vali Acc: 0.350 Test Loss: 1.256 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.383253574371338
Epoch: 3, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 1.6631407737731934
Epoch: 4, Steps: 3 | Train Loss: 0.976 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 1.4762442111968994
Epoch: 5, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.885 Vali Acc: 0.750 Test Loss: 0.885 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 1.494621753692627
Epoch: 6, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.5244994163513184
Epoch: 7, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.620 Vali Acc: 0.925 Test Loss: 0.620 Test Acc: 0.925
Validation loss decreased (-0.824993 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 1.5357425212860107
Epoch: 8, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.494 Vali Acc: 0.975 Test Loss: 0.494 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 1.4418234825134277
Epoch: 9, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3943219184875488
Epoch: 10, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 1.3694679737091064
Epoch: 11, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4075310230255127
Epoch: 12, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.448909044265747
Epoch: 13, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4736413955688477
Epoch: 14, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4825754165649414
Epoch: 15, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 1.4198596477508545
Epoch: 16, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.296238660812378
Epoch: 17, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3872504234313965
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4922163486480713
Epoch: 19, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4915621280670166
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 1.392657995223999
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4858760833740234
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4339957237243652
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3504164218902588
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 1.4482371807098389
Epoch: 25, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3957157135009766
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 1.3752000331878662
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 1.4454233646392822
Epoch: 28, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.441772699356079
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4923930168151855
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 18774276
model size : 72.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6000735759735107
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.432 Vali Acc: 0.300 Test Loss: 1.432 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.8952326774597168
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.379 Vali Acc: 0.400 Test Loss: 1.379 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.9265613555908203
Epoch: 3, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.271 Vali Acc: 0.425 Test Loss: 1.271 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.9491574764251709
Epoch: 4, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.8075501918792725
Epoch: 5, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.043 Vali Acc: 0.625 Test Loss: 1.043 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.8745267391204834
Epoch: 6, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.9269261360168457
Epoch: 7, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.8947546482086182
Epoch: 8, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.667 Vali Acc: 0.925 Test Loss: 0.667 Test Acc: 0.925
Validation loss decreased (-0.799992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.9030780792236328
Epoch: 9, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.557 Vali Acc: 0.950 Test Loss: 0.557 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.8939692974090576
Epoch: 10, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.9794571399688721
Epoch: 11, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.828331470489502
Epoch: 12, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.352 Vali Acc: 0.975 Test Loss: 0.352 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.871727466583252
Epoch: 13, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.8484368324279785
Epoch: 14, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.798865795135498
Epoch: 15, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.9704439640045166
Epoch: 16, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.8878521919250488
Epoch: 17, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 1.000 Test Loss: 0.225 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 5534724
model size : 22.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.9462454319000244
Epoch: 1, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 2.089834451675415
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.340 Vali Acc: 0.450 Test Loss: 1.340 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 2.2407186031341553
Epoch: 3, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.246 Vali Acc: 0.600 Test Loss: 1.246 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 2.1904475688934326
Epoch: 4, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.134 Vali Acc: 0.700 Test Loss: 1.134 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 2.0563535690307617
Epoch: 5, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.005 Vali Acc: 0.775 Test Loss: 1.005 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 1.9928739070892334
Epoch: 6, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 2.115168809890747
Epoch: 7, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.726 Vali Acc: 0.875 Test Loss: 0.726 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 2.2507641315460205
Epoch: 8, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.576 Vali Acc: 0.950 Test Loss: 0.576 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 2.1475231647491455
Epoch: 9, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 1.952225685119629
Epoch: 10, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 2.0656368732452393
Epoch: 11, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 2.1620850563049316
Epoch: 12, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 2.2000670433044434
Epoch: 13, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 2.180083751678467
Epoch: 14, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 2.0744943618774414
Epoch: 15, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 2.2472782135009766
Epoch: 16, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1474545001983643
Epoch: 17, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 2.2820348739624023
Epoch: 18, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 2.288302183151245
Epoch: 19, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.124814033508301
Epoch: 20, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1359376907348633
Epoch: 21, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.211900234222412
Epoch: 22, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 2.231600522994995
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 2.2043771743774414
Epoch: 24, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 2.237173080444336
Epoch: 25, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 2.240415096282959
Epoch: 26, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 2.2046453952789307
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.049323081970215
Epoch: 28, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2814278602600098
Epoch: 29, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.327681541442871
Epoch: 30, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 9401092
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1978065967559814
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.346 Vali Acc: 0.425 Test Loss: 1.346 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.300722360610962
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.276221752166748
Epoch: 3, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.217 Vali Acc: 0.525 Test Loss: 1.217 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 1.3597908020019531
Epoch: 4, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 1.2032623291015625
Epoch: 5, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.004 Vali Acc: 0.725 Test Loss: 1.004 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 1.1829946041107178
Epoch: 6, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.888 Vali Acc: 0.750 Test Loss: 0.888 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.325402021408081
Epoch: 7, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 1.2134177684783936
Epoch: 8, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.2529489994049072
Epoch: 9, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 1.285409688949585
Epoch: 10, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.427 Vali Acc: 0.975 Test Loss: 0.427 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 1.410947561264038
Epoch: 11, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.2906227111816406
Epoch: 12, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.2192435264587402
Epoch: 13, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 1.2335090637207031
Epoch: 14, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.2261605262756348
Epoch: 15, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.2581193447113037
Epoch: 16, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.1915276050567627
Epoch: 17, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.2935638427734375
Epoch: 18, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 1.3581559658050537
Epoch: 19, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.126 Vali Acc: 1.000 Test Loss: 0.126 Test Acc: 1.000
Validation loss decreased (-0.974999 --> -0.999999).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2781188
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.5260677337646484
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.378 Vali Acc: 0.375 Test Loss: 1.378 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.784672498703003
Epoch: 2, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.334 Vali Acc: 0.475 Test Loss: 1.334 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.894681692123413
Epoch: 3, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.244 Vali Acc: 0.575 Test Loss: 1.244 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.902580976486206
Epoch: 4, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.136 Vali Acc: 0.725 Test Loss: 1.136 Test Acc: 0.725
Validation loss decreased (-0.574988 --> -0.724989).  Saving model ...
Epoch: 5 cost time: 1.7196812629699707
Epoch: 5, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.019 Vali Acc: 0.775 Test Loss: 1.019 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 1.8198778629302979
Epoch: 6, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.8190393447875977
Epoch: 7, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.6809730529785156
Epoch: 8, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.635 Vali Acc: 0.925 Test Loss: 0.635 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 1.805058240890503
Epoch: 9, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 1.799872875213623
Epoch: 10, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.462 Vali Acc: 0.975 Test Loss: 0.462 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 1.6642649173736572
Epoch: 11, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.407 Vali Acc: 0.975 Test Loss: 0.407 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 1.7965269088745117
Epoch: 12, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 1.7148551940917969
Epoch: 13, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 1.6807091236114502
Epoch: 14, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.90036940574646
Epoch: 15, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 1.8502824306488037
Epoch: 16, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 1.7028863430023193
Epoch: 17, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.6906929016113281
Epoch: 18, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7326116561889648
Epoch: 19, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 1.6606829166412354
Epoch: 20, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8300328254699707
Epoch: 21, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9291932582855225
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.924262285232544
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7714006900787354
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.852233648300171
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7169592380523682
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8099887371063232
Epoch: 27, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8228719234466553
Epoch: 28, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7817423343658447
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 9401092
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8801233768463135
Epoch: 1, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.1154439449310303
Epoch: 2, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.294 Vali Acc: 0.550 Test Loss: 1.294 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.9380578994750977
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.220 Vali Acc: 0.650 Test Loss: 1.220 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 0.9942371845245361
Epoch: 4, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.123 Vali Acc: 0.725 Test Loss: 1.123 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 5 cost time: 0.9717578887939453
Epoch: 5, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.8842458724975586
Epoch: 6, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8954617977142334
Epoch: 7, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 0.9304914474487305
Epoch: 8, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 1.0266070365905762
Epoch: 9, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.1018357276916504
Epoch: 10, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.0351829528808594
Epoch: 11, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.0745272636413574
Epoch: 12, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 1.095522165298462
Epoch: 13, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 1.0825321674346924
Epoch: 14, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.0213079452514648
Epoch: 15, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.253 Vali Acc: 1.000 Test Loss: 0.253 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2781188
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7478368282318115
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.1351101398468018
Epoch: 2, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.323 Vali Acc: 0.475 Test Loss: 1.323 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.1360325813293457
Epoch: 3, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.240 Vali Acc: 0.550 Test Loss: 1.240 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.1195068359375
Epoch: 4, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.139 Vali Acc: 0.675 Test Loss: 1.139 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.1285769939422607
Epoch: 5, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.020402431488037
Epoch: 6, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.922 Vali Acc: 0.800 Test Loss: 0.922 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.1337602138519287
Epoch: 7, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.796 Vali Acc: 0.875 Test Loss: 0.796 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 1.1066935062408447
Epoch: 8, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 1.0778133869171143
Epoch: 9, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.1062860488891602
Epoch: 10, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.0261671543121338
Epoch: 11, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.9875516891479492
Epoch: 12, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.424 Vali Acc: 0.975 Test Loss: 0.424 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 1.082427740097046
Epoch: 13, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 1.1017858982086182
Epoch: 14, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 1.1249401569366455
Epoch: 15, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.105818748474121
Epoch: 16, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2362408638000488
Epoch: 17, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1029751300811768
Epoch: 18, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0907464027404785
Epoch: 19, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1145045757293701
Epoch: 20, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0531024932861328
Epoch: 21, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.138469934463501
Epoch: 22, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 1.108184814453125
Epoch: 23, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 1.1871042251586914
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 1.1729001998901367
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.171699047088623
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1849782466888428
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0639619827270508
Epoch: 28, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 1.1676757335662842
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 1.1060373783111572
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 9401092
model size : 37.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.351086139678955
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.8028645515441895
Epoch: 2, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.281 Vali Acc: 0.525 Test Loss: 1.281 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.8226146697998047
Epoch: 3, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.206 Vali Acc: 0.575 Test Loss: 1.206 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.8462562561035156
Epoch: 4, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.110 Vali Acc: 0.625 Test Loss: 1.110 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.8490109443664551
Epoch: 5, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.018 Vali Acc: 0.625 Test Loss: 1.018 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.9382109642028809
Epoch: 6, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674991).  Saving model ...
Epoch: 7 cost time: 0.8434548377990723
Epoch: 7, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 0.8453788757324219
Epoch: 8, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.8716645240783691
Epoch: 9, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.618 Vali Acc: 0.925 Test Loss: 0.618 Test Acc: 0.925
Validation loss decreased (-0.824993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.8285231590270996
Epoch: 10, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.8813469409942627
Epoch: 11, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.457 Vali Acc: 0.975 Test Loss: 0.457 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.9171204566955566
Epoch: 12, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.8611464500427246
Epoch: 13, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.371 Vali Acc: 0.975 Test Loss: 0.371 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.920790433883667
Epoch: 14, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8496651649475098
Epoch: 15, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8871471881866455
Epoch: 16, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7703783512115479
Epoch: 17, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8859295845031738
Epoch: 18, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.8789021968841553
Epoch: 19, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.8885269165039062
Epoch: 20, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.191 Vali Acc: 1.000 Test Loss: 0.191 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2781188
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.697094440460205
Epoch: 1, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.6046388149261475
Epoch: 2, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.272 Vali Acc: 0.525 Test Loss: 1.272 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 1.7530534267425537
Epoch: 3, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.6881694793701172
Epoch: 4, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.8466618061065674
Epoch: 5, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.7321734428405762
Epoch: 6, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.888 Vali Acc: 0.800 Test Loss: 0.888 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.8122761249542236
Epoch: 7, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.767 Vali Acc: 0.900 Test Loss: 0.767 Test Acc: 0.900
Validation loss decreased (-0.799991 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 1.7638685703277588
Epoch: 8, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.649 Vali Acc: 0.925 Test Loss: 0.649 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 1.6580543518066406
Epoch: 9, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 1.8714501857757568
Epoch: 10, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 1.8338994979858398
Epoch: 11, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 1.8548657894134521
Epoch: 12, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 1.662038803100586
Epoch: 13, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 1.846022129058838
Epoch: 14, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 1.8694021701812744
Epoch: 15, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 1.9708521366119385
Epoch: 16, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 2.0158092975616455
Epoch: 17, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 1.9247386455535889
Epoch: 18, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 1.9313883781433105
Epoch: 19, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 1.7790579795837402
Epoch: 20, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8959574699401855
Epoch: 21, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9209187030792236
Epoch: 22, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9833672046661377
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.174 Vali Acc: 0.925 Test Loss: 0.174 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.933356523513794
Epoch: 24, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 1.9128057956695557
Epoch: 25, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 1.9039597511291504
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 1.906524419784546
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8256895542144775
Epoch: 28, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9343311786651611
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.039031744003296
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4714500
model size : 19.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.023653745651245
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.429 Vali Acc: 0.375 Test Loss: 1.429 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.2080562114715576
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.388 Vali Acc: 0.375 Test Loss: 1.388 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.131392002105713
Epoch: 3, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.1258251667022705
Epoch: 4, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.222 Vali Acc: 0.675 Test Loss: 1.222 Test Acc: 0.675
Validation loss decreased (-0.449987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 1.0597584247589111
Epoch: 5, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.115 Vali Acc: 0.750 Test Loss: 1.115 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 1.1479859352111816
Epoch: 6, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.996 Vali Acc: 0.800 Test Loss: 0.996 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 7 cost time: 1.1538450717926025
Epoch: 7, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 1.1544864177703857
Epoch: 8, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 1.127148151397705
Epoch: 9, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.662 Vali Acc: 0.950 Test Loss: 0.662 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 10 cost time: 1.119255781173706
Epoch: 10, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.562 Vali Acc: 1.000 Test Loss: 0.562 Test Acc: 1.000
Validation loss decreased (-0.949993 --> -0.999994).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1404420
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.387899160385132
Epoch: 1, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 1.378981351852417
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.273 Vali Acc: 0.550 Test Loss: 1.273 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.48691725730896
Epoch: 3, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.400371789932251
Epoch: 4, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.4230387210845947
Epoch: 5, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.013 Vali Acc: 0.675 Test Loss: 1.013 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 1.4245243072509766
Epoch: 6, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.906 Vali Acc: 0.775 Test Loss: 0.906 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.3438835144042969
Epoch: 7, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.789 Vali Acc: 0.875 Test Loss: 0.789 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 1.3894317150115967
Epoch: 8, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.672 Vali Acc: 0.925 Test Loss: 0.672 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 1.4153287410736084
Epoch: 9, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.4601490497589111
Epoch: 10, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.498551368713379
Epoch: 11, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.4461262226104736
Epoch: 12, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 1.261066198348999
Epoch: 13, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 1.1779389381408691
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 1.1127455234527588
Epoch: 15, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.236 Vali Acc: 1.000 Test Loss: 0.236 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4714500
model size : 19.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7484359741210938
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.430 Vali Acc: 0.375 Test Loss: 1.430 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.985480546951294
Epoch: 2, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.392 Vali Acc: 0.425 Test Loss: 1.392 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.9292700290679932
Epoch: 3, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.326 Vali Acc: 0.475 Test Loss: 1.326 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.965228796005249
Epoch: 4, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.238 Vali Acc: 0.550 Test Loss: 1.238 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.9017739295959473
Epoch: 5, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.138 Vali Acc: 0.725 Test Loss: 1.138 Test Acc: 0.725
Validation loss decreased (-0.549988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.9802932739257812
Epoch: 6, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.026 Vali Acc: 0.775 Test Loss: 1.026 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.9835712909698486
Epoch: 7, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 1.011078119277954
Epoch: 8, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.802 Vali Acc: 0.825 Test Loss: 0.802 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.8937201499938965
Epoch: 9, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.689 Vali Acc: 0.925 Test Loss: 0.689 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.946831464767456
Epoch: 10, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.597 Vali Acc: 0.950 Test Loss: 0.597 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.9723904132843018
Epoch: 11, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.514 Vali Acc: 1.000 Test Loss: 0.514 Test Acc: 1.000
Validation loss decreased (-0.949994 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1404420
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6945557594299316
Epoch: 1, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.301 Vali Acc: 0.450 Test Loss: 1.301 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.9834039211273193
Epoch: 2, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.267 Vali Acc: 0.525 Test Loss: 1.267 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.9980168342590332
Epoch: 3, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.203 Vali Acc: 0.575 Test Loss: 1.203 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.9977672100067139
Epoch: 4, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.9686059951782227
Epoch: 5, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.042 Vali Acc: 0.625 Test Loss: 1.042 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.9473745822906494
Epoch: 6, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.947 Vali Acc: 0.775 Test Loss: 0.947 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.9757680892944336
Epoch: 7, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.840 Vali Acc: 0.850 Test Loss: 0.840 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.931288480758667
Epoch: 8, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.732 Vali Acc: 0.875 Test Loss: 0.732 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.8588695526123047
Epoch: 9, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.8766088485717773
Epoch: 10, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.547 Vali Acc: 0.925 Test Loss: 0.547 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.9629037380218506
Epoch: 11, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 1.0090816020965576
Epoch: 12, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 1.1003615856170654
Epoch: 13, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 1.0185413360595703
Epoch: 14, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 1.0141050815582275
Epoch: 15, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.9588186740875244
Epoch: 16, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 1.012866497039795
Epoch: 17, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0086712837219238
Epoch: 18, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 1.0035288333892822
Epoch: 19, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.943842887878418
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9166178703308105
Epoch: 21, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9607856273651123
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0418939590454102
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 1.0302400588989258
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 1.0736815929412842
Epoch: 25, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.9669766426086426
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0297770500183105
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0216481685638428
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9722645282745361
Epoch: 29, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9741263389587402
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4714500
model size : 19.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6213326454162598
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.446 Vali Acc: 0.325 Test Loss: 1.446 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.8273389339447021
Epoch: 2, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.409 Vali Acc: 0.375 Test Loss: 1.409 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.8429074287414551
Epoch: 3, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.347 Vali Acc: 0.425 Test Loss: 1.347 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.8511826992034912
Epoch: 4, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.267 Vali Acc: 0.525 Test Loss: 1.267 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.7174687385559082
Epoch: 5, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.179 Vali Acc: 0.625 Test Loss: 1.179 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.7595891952514648
Epoch: 6, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.075 Vali Acc: 0.675 Test Loss: 1.075 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.8163635730743408
Epoch: 7, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.973 Vali Acc: 0.700 Test Loss: 0.973 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.6614933013916016
Epoch: 8, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.739863395690918
Epoch: 9, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.6855313777923584
Epoch: 10, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.669 Vali Acc: 0.925 Test Loss: 0.669 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.7146246433258057
Epoch: 11, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.583 Vali Acc: 0.950 Test Loss: 0.583 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.8421390056610107
Epoch: 12, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.521 Vali Acc: 0.925 Test Loss: 0.521 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7990434169769287
Epoch: 13, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6913547515869141
Epoch: 14, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.8288125991821289
Epoch: 15, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.7716922760009766
Epoch: 16, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.8081870079040527
Epoch: 17, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.805497407913208
Epoch: 18, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.797257661819458
Epoch: 19, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.8682546615600586
Epoch: 20, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7964887619018555
Epoch: 21, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8211448192596436
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8003296852111816
Epoch: 23, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.7263917922973633
Epoch: 24, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.184 Vali Acc: 1.000 Test Loss: 0.184 Test Acc: 1.000
Validation loss decreased (-0.974998 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1404420
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.226611852645874
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.444 Vali Acc: 0.175 Test Loss: 1.444 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.248715877532959
Epoch: 2, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.413 Vali Acc: 0.175 Test Loss: 1.413 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.4565882682800293
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.359 Vali Acc: 0.275 Test Loss: 1.359 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.3224899768829346
Epoch: 4, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (-0.274986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.3485355377197266
Epoch: 5, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.202 Vali Acc: 0.650 Test Loss: 1.202 Test Acc: 0.650
Validation loss decreased (-0.499987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 1.3741724491119385
Epoch: 6, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.114 Vali Acc: 0.675 Test Loss: 1.114 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.4852180480957031
Epoch: 7, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 1.3847603797912598
Epoch: 8, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.918 Vali Acc: 0.825 Test Loss: 0.918 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 1.3686394691467285
Epoch: 9, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.823 Vali Acc: 0.875 Test Loss: 0.823 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 1.3503406047821045
Epoch: 10, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.731 Vali Acc: 0.925 Test Loss: 0.731 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 1.3063545227050781
Epoch: 11, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.634 Vali Acc: 0.950 Test Loss: 0.634 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 1.420133352279663
Epoch: 12, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.546 Vali Acc: 0.950 Test Loss: 0.546 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 1.402874231338501
Epoch: 13, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.461 Vali Acc: 1.000 Test Loss: 0.461 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 4701316
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.803396224975586
Epoch: 1, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.374 Vali Acc: 0.275 Test Loss: 1.374 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.0035011768341064
Epoch: 2, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.343 Vali Acc: 0.275 Test Loss: 1.343 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.9252932071685791
Epoch: 3, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.295 Vali Acc: 0.275 Test Loss: 1.295 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.972527265548706
Epoch: 4, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.233 Vali Acc: 0.300 Test Loss: 1.233 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.9506137371063232
Epoch: 5, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.154 Vali Acc: 0.450 Test Loss: 1.154 Test Acc: 0.450
Validation loss decreased (-0.299988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.9851970672607422
Epoch: 6, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.449988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.9831447601318359
Epoch: 7, Steps: 3 | Train Loss: 0.939 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.9443497657775879
Epoch: 8, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.890 Vali Acc: 0.850 Test Loss: 0.890 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.9292359352111816
Epoch: 9, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.795 Vali Acc: 0.850 Test Loss: 0.795 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.9581217765808105
Epoch: 10, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.702 Vali Acc: 0.900 Test Loss: 0.702 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.9659717082977295
Epoch: 11, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.612 Vali Acc: 0.950 Test Loss: 0.612 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 1.0873005390167236
Epoch: 12, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 1.0814058780670166
Epoch: 13, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.9748013019561768
Epoch: 14, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.410 Vali Acc: 1.000 Test Loss: 0.410 Test Acc: 1.000
Validation loss decreased (-0.949995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1391108
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.96203875541687
Epoch: 1, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.441 Vali Acc: 0.175 Test Loss: 1.441 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.0777525901794434
Epoch: 2, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.405 Vali Acc: 0.175 Test Loss: 1.405 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.1589927673339844
Epoch: 3, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.341 Vali Acc: 0.425 Test Loss: 1.341 Test Acc: 0.425
Validation loss decreased (-0.174986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.0153179168701172
Epoch: 4, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 1.08412766456604
Epoch: 5, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.174 Vali Acc: 0.525 Test Loss: 1.174 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1589694023132324
Epoch: 6, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 1.108482837677002
Epoch: 7, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.010 Vali Acc: 0.650 Test Loss: 1.010 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.9650912284851074
Epoch: 8, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.164525032043457
Epoch: 9, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.825 Vali Acc: 0.825 Test Loss: 0.825 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 1.03499174118042
Epoch: 10, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.740 Vali Acc: 0.875 Test Loss: 0.740 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 1.2037127017974854
Epoch: 11, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.659 Vali Acc: 0.950 Test Loss: 0.659 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 1.1573562622070312
Epoch: 12, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.578 Vali Acc: 0.950 Test Loss: 0.578 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 1.0866734981536865
Epoch: 13, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 1.1143872737884521
Epoch: 14, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.084529161453247
Epoch: 15, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 1.1213223934173584
Epoch: 16, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 1.1714062690734863
Epoch: 17, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 1.1045429706573486
Epoch: 18, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.1142246723175049
Epoch: 19, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 1.104996919631958
Epoch: 20, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 1.0821611881256104
Epoch: 21, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 1.1512959003448486
Epoch: 22, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 1.1444621086120605
Epoch: 23, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 1.196418046951294
Epoch: 24, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 1.1048040390014648
Epoch: 25, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 1.121748924255371
Epoch: 26, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 1.121417760848999
Epoch: 27, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 1.120680809020996
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 1.1497068405151367
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.9431459903717041
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4701316
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.616288661956787
Epoch: 1, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.360 Vali Acc: 0.275 Test Loss: 1.360 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.7860410213470459
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.329 Vali Acc: 0.275 Test Loss: 1.329 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.8408308029174805
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.280 Vali Acc: 0.275 Test Loss: 1.280 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.7753522396087646
Epoch: 4, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.217 Vali Acc: 0.300 Test Loss: 1.217 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.8439583778381348
Epoch: 5, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.142 Vali Acc: 0.475 Test Loss: 1.142 Test Acc: 0.475
Validation loss decreased (-0.299988 --> -0.474989).  Saving model ...
Epoch: 6 cost time: 0.8656706809997559
Epoch: 6, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.062 Vali Acc: 0.650 Test Loss: 1.062 Test Acc: 0.650
Validation loss decreased (-0.474989 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.9425187110900879
Epoch: 7, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.983 Vali Acc: 0.675 Test Loss: 0.983 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.7784323692321777
Epoch: 8, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.6995182037353516
Epoch: 9, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.805 Vali Acc: 0.800 Test Loss: 0.805 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.7684714794158936
Epoch: 10, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.722 Vali Acc: 0.850 Test Loss: 0.722 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.8371849060058594
Epoch: 11, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.9063732624053955
Epoch: 12, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.571 Vali Acc: 0.950 Test Loss: 0.571 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.7942512035369873
Epoch: 13, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.516 Vali Acc: 0.975 Test Loss: 0.516 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.9676604270935059
Epoch: 14, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.470 Vali Acc: 0.975 Test Loss: 0.470 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.8062722682952881
Epoch: 15, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.417 Vali Acc: 1.000 Test Loss: 0.417 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1391108
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5626449584960938
Epoch: 1, Steps: 3 | Train Loss: 1.507 Vali Loss: 1.444 Vali Acc: 0.175 Test Loss: 1.444 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.8642244338989258
Epoch: 2, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.410 Vali Acc: 0.150 Test Loss: 1.410 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8047027587890625
Epoch: 3, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.344 Vali Acc: 0.425 Test Loss: 1.344 Test Acc: 0.425
Validation loss decreased (-0.174986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.8028922080993652
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.8780226707458496
Epoch: 5, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8426826000213623
Epoch: 6, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.150 Vali Acc: 0.450 Test Loss: 1.150 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8347947597503662
Epoch: 7, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.082 Vali Acc: 0.550 Test Loss: 1.082 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.8129088878631592
Epoch: 8, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.8240678310394287
Epoch: 9, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.8232393264770508
Epoch: 10, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.836 Vali Acc: 0.900 Test Loss: 0.836 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.769507646560669
Epoch: 11, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.755 Vali Acc: 0.925 Test Loss: 0.755 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 12 cost time: 0.8467094898223877
Epoch: 12, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.679 Vali Acc: 0.925 Test Loss: 0.679 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.8370254039764404
Epoch: 13, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.625 Vali Acc: 0.925 Test Loss: 0.625 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.8667669296264648
Epoch: 14, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.9472415447235107
Epoch: 15, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.538 Vali Acc: 0.950 Test Loss: 0.538 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.8895013332366943
Epoch: 16, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.8268322944641113
Epoch: 17, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.9010522365570068
Epoch: 18, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.9085462093353271
Epoch: 19, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.7855536937713623
Epoch: 20, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.8409459590911865
Epoch: 21, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.8138778209686279
Epoch: 22, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.8078134059906006
Epoch: 23, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.7538695335388184
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.8608078956604004
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8201844692230225
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8652207851409912
Epoch: 27, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8532373905181885
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7776029109954834
Epoch: 29, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8558051586151123
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4701316
model size : 18.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.629326343536377
Epoch: 1, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.337 Vali Acc: 0.300 Test Loss: 1.337 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.71234130859375
Epoch: 2, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.306 Vali Acc: 0.300 Test Loss: 1.306 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.7785658836364746
Epoch: 3, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.258 Vali Acc: 0.325 Test Loss: 1.258 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.7042820453643799
Epoch: 4, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.201 Vali Acc: 0.350 Test Loss: 1.201 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349988).  Saving model ...
Epoch: 5 cost time: 0.7165918350219727
Epoch: 5, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.136 Vali Acc: 0.550 Test Loss: 1.136 Test Acc: 0.550
Validation loss decreased (-0.349988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.7009198665618896
Epoch: 6, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.7008819580078125
Epoch: 7, Steps: 3 | Train Loss: 0.939 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 8 cost time: 0.6887638568878174
Epoch: 8, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.925 Vali Acc: 0.725 Test Loss: 0.925 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 0.7571253776550293
Epoch: 9, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.850 Vali Acc: 0.800 Test Loss: 0.850 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.7045154571533203
Epoch: 10, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 0.7669281959533691
Epoch: 11, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 0.7209873199462891
Epoch: 12, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 0.7360587120056152
Epoch: 13, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.6783740520477295
Epoch: 14, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.7395191192626953
Epoch: 15, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.7512085437774658
Epoch: 16, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.7606275081634521
Epoch: 17, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.6813054084777832
Epoch: 18, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.7191150188446045
Epoch: 19, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.370 Vali Acc: 1.000 Test Loss: 0.370 Test Acc: 1.000
Validation loss decreased (-0.924996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1391108
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.254422426223755
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.436 Vali Acc: 0.325 Test Loss: 1.436 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.127035140991211
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.406 Vali Acc: 0.325 Test Loss: 1.406 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2514214515686035
Epoch: 3, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.360 Vali Acc: 0.325 Test Loss: 1.360 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.2073533535003662
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.298 Vali Acc: 0.375 Test Loss: 1.298 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.2071053981781006
Epoch: 5, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.226 Vali Acc: 0.525 Test Loss: 1.226 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 1.3216402530670166
Epoch: 6, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.150 Vali Acc: 0.650 Test Loss: 1.150 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.1823546886444092
Epoch: 7, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.068 Vali Acc: 0.800 Test Loss: 1.068 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 1.1549701690673828
Epoch: 8, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.972 Vali Acc: 0.825 Test Loss: 0.972 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 9 cost time: 1.2284090518951416
Epoch: 9, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 1.176741123199463
Epoch: 10, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.766 Vali Acc: 0.900 Test Loss: 0.766 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 1.2273809909820557
Epoch: 11, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 1.2439138889312744
Epoch: 12, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.1852340698242188
Epoch: 13, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.513 Vali Acc: 0.950 Test Loss: 0.513 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 1.1607389450073242
Epoch: 14, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.1884043216705322
Epoch: 15, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 1.2497475147247314
Epoch: 16, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.371 Vali Acc: 0.975 Test Loss: 0.371 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 1.1203091144561768
Epoch: 17, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.329 Vali Acc: 1.000 Test Loss: 0.329 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 2357636
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.834073066711426
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.412 Vali Acc: 0.250 Test Loss: 1.412 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.0258679389953613
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.92498779296875
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.360 Vali Acc: 0.275 Test Loss: 1.360 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.9588954448699951
Epoch: 4, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.314 Vali Acc: 0.325 Test Loss: 1.314 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.9463448524475098
Epoch: 5, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.9613358974456787
Epoch: 6, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.202 Vali Acc: 0.525 Test Loss: 1.202 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.9948720932006836
Epoch: 7, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.135 Vali Acc: 0.575 Test Loss: 1.135 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.8964452743530273
Epoch: 8, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.9021477699279785
Epoch: 9, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.987 Vali Acc: 0.775 Test Loss: 0.987 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.9094939231872559
Epoch: 10, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.908 Vali Acc: 0.825 Test Loss: 0.908 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.9247019290924072
Epoch: 11, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.8402583599090576
Epoch: 12, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.9591338634490967
Epoch: 13, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.9208898544311523
Epoch: 14, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.608 Vali Acc: 0.925 Test Loss: 0.608 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.9663815498352051
Epoch: 15, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.543 Vali Acc: 0.975 Test Loss: 0.543 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.9028270244598389
Epoch: 16, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.483 Vali Acc: 0.975 Test Loss: 0.483 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.9482848644256592
Epoch: 17, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.426 Vali Acc: 1.000 Test Loss: 0.426 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 702468
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.926631212234497
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.435 Vali Acc: 0.325 Test Loss: 1.435 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.038529396057129
Epoch: 2, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.403 Vali Acc: 0.325 Test Loss: 1.403 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.0790948867797852
Epoch: 3, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.352 Vali Acc: 0.325 Test Loss: 1.352 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.0832107067108154
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.0695629119873047
Epoch: 5, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.220 Vali Acc: 0.550 Test Loss: 1.220 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.0377106666564941
Epoch: 6, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.152 Vali Acc: 0.625 Test Loss: 1.152 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 1.0608551502227783
Epoch: 7, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.082 Vali Acc: 0.775 Test Loss: 1.082 Test Acc: 0.775
Validation loss decreased (-0.624988 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 1.0657334327697754
Epoch: 8, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.999 Vali Acc: 0.775 Test Loss: 0.999 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.0381948947906494
Epoch: 9, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 1.0116233825683594
Epoch: 10, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 1.0886867046356201
Epoch: 11, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.726 Vali Acc: 0.925 Test Loss: 0.726 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 1.1206603050231934
Epoch: 12, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.645 Vali Acc: 0.925 Test Loss: 0.645 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 1.0787389278411865
Epoch: 13, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 1.054311990737915
Epoch: 14, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 1.1079916954040527
Epoch: 15, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 1.0550270080566406
Epoch: 16, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 1.0929927825927734
Epoch: 17, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 1.0609190464019775
Epoch: 18, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 1.0652403831481934
Epoch: 19, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 1.048398494720459
Epoch: 20, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 1.0077307224273682
Epoch: 21, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.059206247329712
Epoch: 22, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1101901531219482
Epoch: 23, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.9382295608520508
Epoch: 24, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0899872779846191
Epoch: 25, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 1.0788373947143555
Epoch: 26, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 1.016897201538086
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0260751247406006
Epoch: 28, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1144914627075195
Epoch: 29, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1076979637145996
Epoch: 30, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2357636
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5814504623413086
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7953009605407715
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.8094077110290527
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.357 Vali Acc: 0.350 Test Loss: 1.357 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.7985672950744629
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.313 Vali Acc: 0.350 Test Loss: 1.313 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.8318827152252197
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.7867593765258789
Epoch: 6, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7978506088256836
Epoch: 7, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.8776664733886719
Epoch: 8, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.8451504707336426
Epoch: 9, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.005 Vali Acc: 0.800 Test Loss: 1.005 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.8138577938079834
Epoch: 10, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.928 Vali Acc: 0.825 Test Loss: 0.928 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.781651496887207
Epoch: 11, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.855 Vali Acc: 0.825 Test Loss: 0.855 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.7548272609710693
Epoch: 12, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.7583603858947754
Epoch: 13, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.706 Vali Acc: 0.875 Test Loss: 0.706 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.8034591674804688
Epoch: 14, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.7667405605316162
Epoch: 15, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.7798779010772705
Epoch: 16, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.522 Vali Acc: 0.950 Test Loss: 0.522 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.7927887439727783
Epoch: 17, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.467 Vali Acc: 0.975 Test Loss: 0.467 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.7486276626586914
Epoch: 18, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.7728581428527832
Epoch: 19, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.7462630271911621
Epoch: 20, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.6769931316375732
Epoch: 21, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.7804899215698242
Epoch: 22, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.8071208000183105
Epoch: 23, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.7479727268218994
Epoch: 24, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.8818252086639404
Epoch: 25, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.235 Vali Acc: 1.000 Test Loss: 0.235 Test Acc: 1.000
Validation loss decreased (-0.974997 --> -0.999998).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 702468
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.631721019744873
Epoch: 1, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.7391579151153564
Epoch: 2, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.807248592376709
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.355 Vali Acc: 0.325 Test Loss: 1.355 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7520356178283691
Epoch: 4, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.296 Vali Acc: 0.350 Test Loss: 1.296 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.7206730842590332
Epoch: 5, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.236 Vali Acc: 0.525 Test Loss: 1.236 Test Acc: 0.525
Validation loss decreased (-0.349987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.7774286270141602
Epoch: 6, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.175 Vali Acc: 0.675 Test Loss: 1.175 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.6471953392028809
Epoch: 7, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7086038589477539
Epoch: 8, Steps: 3 | Train Loss: 0.909 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.7427713871002197
Epoch: 9, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.7167153358459473
Epoch: 10, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.829 Vali Acc: 0.850 Test Loss: 0.829 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.7906806468963623
Epoch: 11, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.7728297710418701
Epoch: 12, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.666 Vali Acc: 0.900 Test Loss: 0.666 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.7374846935272217
Epoch: 13, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.8316600322723389
Epoch: 14, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.536 Vali Acc: 0.925 Test Loss: 0.536 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.7733402252197266
Epoch: 15, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7864820957183838
Epoch: 16, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.503 Vali Acc: 0.950 Test Loss: 0.503 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.7708470821380615
Epoch: 17, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.7187509536743164
Epoch: 18, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.7384529113769531
Epoch: 19, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.7616190910339355
Epoch: 20, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.421 Vali Acc: 0.950 Test Loss: 0.421 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.7605912685394287
Epoch: 21, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7737033367156982
Epoch: 22, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7136287689208984
Epoch: 23, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7049734592437744
Epoch: 24, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7506940364837646
Epoch: 25, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8108479976654053
Epoch: 26, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7922823429107666
Epoch: 27, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.800990104675293
Epoch: 28, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7851240634918213
Epoch: 29, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7954275608062744
Epoch: 30, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2357636
model size : 9.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6435487270355225
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.437 Vali Acc: 0.175 Test Loss: 1.437 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.7570967674255371
Epoch: 2, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.419 Vali Acc: 0.200 Test Loss: 1.419 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.7356758117675781
Epoch: 3, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.679492712020874
Epoch: 4, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.344 Vali Acc: 0.225 Test Loss: 1.344 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 5 cost time: 0.7056550979614258
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
Validation loss decreased (-0.224987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.7140970230102539
Epoch: 6, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.240 Vali Acc: 0.425 Test Loss: 1.240 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.7698218822479248
Epoch: 7, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.179 Vali Acc: 0.475 Test Loss: 1.179 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.6528811454772949
Epoch: 8, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.117 Vali Acc: 0.575 Test Loss: 1.117 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.7801039218902588
Epoch: 9, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.048 Vali Acc: 0.700 Test Loss: 1.048 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.7051534652709961
Epoch: 10, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 0.719855546951294
Epoch: 11, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.7954609394073486
Epoch: 12, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.8145170211791992
Epoch: 13, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.772 Vali Acc: 0.825 Test Loss: 0.772 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.8461377620697021
Epoch: 14, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.7824215888977051
Epoch: 15, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.7815999984741211
Epoch: 16, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.587 Vali Acc: 0.925 Test Loss: 0.587 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.8120198249816895
Epoch: 17, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.530 Vali Acc: 0.925 Test Loss: 0.530 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.6573364734649658
Epoch: 18, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.480 Vali Acc: 0.950 Test Loss: 0.480 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.7938945293426514
Epoch: 19, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.443 Vali Acc: 0.950 Test Loss: 0.443 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.7431623935699463
Epoch: 20, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.7519540786743164
Epoch: 21, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7309415340423584
Epoch: 22, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6149659156799316
Epoch: 23, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7083806991577148
Epoch: 24, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7147536277770996
Epoch: 25, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8066542148590088
Epoch: 26, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.813554048538208
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.8180058002471924
Epoch: 28, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7609348297119141
Epoch: 29, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7644848823547363
Epoch: 30, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 702468
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.846546173095703
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.374 Vali Acc: 0.325 Test Loss: 1.374 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.9755947589874268
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.0099096298217773
Epoch: 3, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.313 Vali Acc: 0.425 Test Loss: 1.313 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.9992060661315918
Epoch: 4, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.267 Vali Acc: 0.550 Test Loss: 1.267 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 1.0007600784301758
Epoch: 5, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.215 Vali Acc: 0.575 Test Loss: 1.215 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.0310323238372803
Epoch: 6, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.160 Vali Acc: 0.675 Test Loss: 1.160 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 1.0336370468139648
Epoch: 7, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.095 Vali Acc: 0.750 Test Loss: 1.095 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 0.9780616760253906
Epoch: 8, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.031 Vali Acc: 0.800 Test Loss: 1.031 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.9569535255432129
Epoch: 9, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.965 Vali Acc: 0.850 Test Loss: 0.965 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849990).  Saving model ...
Epoch: 10 cost time: 1.046382188796997
Epoch: 10, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.901 Vali Acc: 0.900 Test Loss: 0.901 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 11 cost time: 1.0655951499938965
Epoch: 11, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.836 Vali Acc: 0.950 Test Loss: 0.836 Test Acc: 0.950
Validation loss decreased (-0.899991 --> -0.949992).  Saving model ...
Epoch: 12 cost time: 1.062610387802124
Epoch: 12, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.766 Vali Acc: 0.950 Test Loss: 0.766 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 13 cost time: 1.0530588626861572
Epoch: 13, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.693 Vali Acc: 0.950 Test Loss: 0.693 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 14 cost time: 1.0267269611358643
Epoch: 14, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.630 Vali Acc: 0.975 Test Loss: 0.630 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 15 cost time: 1.0156943798065186
Epoch: 15, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.582 Vali Acc: 1.000 Test Loss: 0.582 Test Acc: 1.000
Validation loss decreased (-0.974994 --> -0.999994).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1185796
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7123255729675293
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.915616512298584
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.324 Vali Acc: 0.425 Test Loss: 1.324 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9319291114807129
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.287 Vali Acc: 0.425 Test Loss: 1.287 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8891057968139648
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.239 Vali Acc: 0.425 Test Loss: 1.239 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8377552032470703
Epoch: 5, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9204986095428467
Epoch: 6, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.9003341197967529
Epoch: 7, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.957406759262085
Epoch: 8, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.863774299621582
Epoch: 9, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.8947813510894775
Epoch: 10, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.8655257225036621
Epoch: 11, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.9528849124908447
Epoch: 12, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.745 Vali Acc: 0.875 Test Loss: 0.745 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.9659004211425781
Epoch: 13, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.9589846134185791
Epoch: 14, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.9074199199676514
Epoch: 15, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.9264955520629883
Epoch: 16, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.9410483837127686
Epoch: 17, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.8153524398803711
Epoch: 18, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.386 Vali Acc: 0.975 Test Loss: 0.386 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.8661274909973145
Epoch: 19, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.348 Vali Acc: 1.000 Test Loss: 0.348 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 358148
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.679314374923706
Epoch: 1, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.361 Vali Acc: 0.350 Test Loss: 1.361 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.8823962211608887
Epoch: 2, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.8648135662078857
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.301 Vali Acc: 0.450 Test Loss: 1.301 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.8294060230255127
Epoch: 4, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.256 Vali Acc: 0.525 Test Loss: 1.256 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.878852128982544
Epoch: 5, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.8558349609375
Epoch: 6, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.142 Vali Acc: 0.675 Test Loss: 1.142 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.8225071430206299
Epoch: 7, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.076 Vali Acc: 0.675 Test Loss: 1.076 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.8263792991638184
Epoch: 8, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.010 Vali Acc: 0.750 Test Loss: 1.010 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.8394885063171387
Epoch: 9, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.939 Vali Acc: 0.800 Test Loss: 0.939 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.8390350341796875
Epoch: 10, Steps: 3 | Train Loss: 0.833 Vali Loss: 0.871 Vali Acc: 0.850 Test Loss: 0.871 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.8309814929962158
Epoch: 11, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.800 Vali Acc: 0.900 Test Loss: 0.800 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 0.844994068145752
Epoch: 12, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.729 Vali Acc: 0.925 Test Loss: 0.729 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.884634256362915
Epoch: 13, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.663 Vali Acc: 0.925 Test Loss: 0.663 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 14 cost time: 0.8114557266235352
Epoch: 14, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.603 Vali Acc: 0.925 Test Loss: 0.603 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.8717715740203857
Epoch: 15, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.554 Vali Acc: 0.975 Test Loss: 0.554 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 16 cost time: 0.8327343463897705
Epoch: 16, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.504 Vali Acc: 1.000 Test Loss: 0.504 Test Acc: 1.000
Validation loss decreased (-0.974994 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1185796
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5461292266845703
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.808826208114624
Epoch: 2, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.325 Vali Acc: 0.425 Test Loss: 1.325 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8106184005737305
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.287 Vali Acc: 0.425 Test Loss: 1.287 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7240123748779297
Epoch: 4, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.242 Vali Acc: 0.425 Test Loss: 1.242 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7562339305877686
Epoch: 5, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8319041728973389
Epoch: 6, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.8136324882507324
Epoch: 7, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.7537462711334229
Epoch: 8, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.022 Vali Acc: 0.725 Test Loss: 1.022 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.8317685127258301
Epoch: 9, Steps: 3 | Train Loss: 0.954 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.7850549221038818
Epoch: 10, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.899 Vali Acc: 0.775 Test Loss: 0.899 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.7756485939025879
Epoch: 11, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.6869046688079834
Epoch: 12, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.762 Vali Acc: 0.825 Test Loss: 0.762 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.9049162864685059
Epoch: 13, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.697 Vali Acc: 0.900 Test Loss: 0.697 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.8499801158905029
Epoch: 14, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.8628485202789307
Epoch: 15, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.7798497676849365
Epoch: 16, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.7513008117675781
Epoch: 17, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.7525844573974609
Epoch: 18, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.8018276691436768
Epoch: 19, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.8354623317718506
Epoch: 20, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.8016400337219238
Epoch: 21, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.323 Vali Acc: 1.000 Test Loss: 0.323 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999997).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 358148
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.47646164894104
Epoch: 1, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.372 Vali Acc: 0.300 Test Loss: 1.372 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.6900711059570312
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.345 Vali Acc: 0.350 Test Loss: 1.345 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.7310152053833008
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.312 Vali Acc: 0.475 Test Loss: 1.312 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.7497470378875732
Epoch: 4, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.270 Vali Acc: 0.550 Test Loss: 1.270 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.6751959323883057
Epoch: 5, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.7018063068389893
Epoch: 6, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.158 Vali Acc: 0.625 Test Loss: 1.158 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.7767446041107178
Epoch: 7, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.092 Vali Acc: 0.650 Test Loss: 1.092 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 0.7313601970672607
Epoch: 8, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 9 cost time: 0.7042772769927979
Epoch: 9, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.715263843536377
Epoch: 10, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.7160334587097168
Epoch: 11, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.823 Vali Acc: 0.850 Test Loss: 0.823 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 0.6931362152099609
Epoch: 12, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.754 Vali Acc: 0.875 Test Loss: 0.754 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.7826666831970215
Epoch: 13, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.695 Vali Acc: 0.875 Test Loss: 0.695 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.7531278133392334
Epoch: 14, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6854078769683838
Epoch: 15, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.6686375141143799
Epoch: 16, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.6950573921203613
Epoch: 17, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.519 Vali Acc: 0.925 Test Loss: 0.519 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.8027341365814209
Epoch: 18, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.8423624038696289
Epoch: 19, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 0.6016032695770264
Epoch: 20, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.7383449077606201
Epoch: 21, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.6821024417877197
Epoch: 22, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.7386536598205566
Epoch: 23, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.750063419342041
Epoch: 24, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.7270863056182861
Epoch: 25, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.6674685478210449
Epoch: 26, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.7384476661682129
Epoch: 27, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.7605366706848145
Epoch: 28, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.7104995250701904
Epoch: 29, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.6907651424407959
Epoch: 30, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1185796
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3940985202789307
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.380 Vali Acc: 0.325 Test Loss: 1.380 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.6047191619873047
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.349 Vali Acc: 0.425 Test Loss: 1.349 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.7454419136047363
Epoch: 3, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6651043891906738
Epoch: 4, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7130508422851562
Epoch: 5, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.217 Vali Acc: 0.425 Test Loss: 1.217 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.6885323524475098
Epoch: 6, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.166 Vali Acc: 0.475 Test Loss: 1.166 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.6942007541656494
Epoch: 7, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.112 Vali Acc: 0.525 Test Loss: 1.112 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.7365283966064453
Epoch: 8, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.524989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.7580647468566895
Epoch: 9, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.6901431083679199
Epoch: 10, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.7011997699737549
Epoch: 11, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 0.7099807262420654
Epoch: 12, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.7310166358947754
Epoch: 13, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.728 Vali Acc: 0.875 Test Loss: 0.728 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.7045977115631104
Epoch: 14, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.666 Vali Acc: 0.875 Test Loss: 0.666 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.7096998691558838
Epoch: 15, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.686060905456543
Epoch: 16, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.6277244091033936
Epoch: 17, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.7122809886932373
Epoch: 18, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6843228340148926
Epoch: 19, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.7156147956848145
Epoch: 20, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.7259788513183594
Epoch: 21, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.5581128597259521
Epoch: 22, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.7377760410308838
Epoch: 23, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.6929047107696533
Epoch: 24, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.816988468170166
Epoch: 25, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.7062170505523682
Epoch: 26, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.722506046295166
Epoch: 27, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.7190914154052734
Epoch: 28, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.6783425807952881
Epoch: 29, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.7181396484375
Epoch: 30, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 358148
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.991584539413452
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.438 Vali Acc: 0.325 Test Loss: 1.438 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.0134875774383545
Epoch: 2, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.415 Vali Acc: 0.325 Test Loss: 1.415 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.159029245376587
Epoch: 3, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.388 Vali Acc: 0.350 Test Loss: 1.388 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.0175747871398926
Epoch: 4, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.352 Vali Acc: 0.375 Test Loss: 1.352 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.9307212829589844
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.0715041160583496
Epoch: 6, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.261 Vali Acc: 0.450 Test Loss: 1.261 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 1.0726523399353027
Epoch: 7, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.212 Vali Acc: 0.575 Test Loss: 1.212 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.9930710792541504
Epoch: 8, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.160 Vali Acc: 0.700 Test Loss: 1.160 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 1.0571057796478271
Epoch: 9, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 1.097851276397705
Epoch: 10, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.056 Vali Acc: 0.725 Test Loss: 1.056 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 1.0444955825805664
Epoch: 11, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.9975793361663818
Epoch: 12, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 1.0658340454101562
Epoch: 13, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.883 Vali Acc: 0.825 Test Loss: 0.883 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 1.0106499195098877
Epoch: 14, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.819 Vali Acc: 0.850 Test Loss: 0.819 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 1.0576756000518799
Epoch: 15, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 1.0725371837615967
Epoch: 16, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.692 Vali Acc: 0.850 Test Loss: 0.692 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.0453662872314453
Epoch: 17, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 1.0252084732055664
Epoch: 18, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.0578563213348389
Epoch: 19, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.535 Vali Acc: 0.925 Test Loss: 0.535 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 1.110830307006836
Epoch: 20, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.490 Vali Acc: 0.925 Test Loss: 0.490 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 1.0364952087402344
Epoch: 21, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.452 Vali Acc: 0.975 Test Loss: 0.452 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 1.018233060836792
Epoch: 22, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.416 Vali Acc: 1.000 Test Loss: 0.416 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1179204
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7572221755981445
Epoch: 1, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.336 Vali Acc: 0.150 Test Loss: 1.336 Test Acc: 0.150
Validation loss decreased (inf --> -0.149987).  Saving model ...
Epoch: 2 cost time: 0.8142006397247314
Epoch: 2, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.317 Vali Acc: 0.175 Test Loss: 1.317 Test Acc: 0.175
Validation loss decreased (-0.149987 --> -0.174987).  Saving model ...
Epoch: 3 cost time: 0.7758219242095947
Epoch: 3, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.296 Vali Acc: 0.200 Test Loss: 1.296 Test Acc: 0.200
Validation loss decreased (-0.174987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.7797410488128662
Epoch: 4, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.269 Vali Acc: 0.225 Test Loss: 1.269 Test Acc: 0.225
Validation loss decreased (-0.199987 --> -0.224987).  Saving model ...
Epoch: 5 cost time: 0.8388645648956299
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.239 Vali Acc: 0.375 Test Loss: 1.239 Test Acc: 0.375
Validation loss decreased (-0.224987 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.8076817989349365
Epoch: 6, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.374988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.8132853507995605
Epoch: 7, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.173 Vali Acc: 0.600 Test Loss: 1.173 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.8108344078063965
Epoch: 8, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.138 Vali Acc: 0.675 Test Loss: 1.138 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.7238929271697998
Epoch: 9, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.099 Vali Acc: 0.700 Test Loss: 1.099 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.811682939529419
Epoch: 10, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.061 Vali Acc: 0.725 Test Loss: 1.061 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.8302798271179199
Epoch: 11, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.018 Vali Acc: 0.750 Test Loss: 1.018 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.8374378681182861
Epoch: 12, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.974 Vali Acc: 0.775 Test Loss: 0.974 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 0.7841019630432129
Epoch: 13, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.8899054527282715
Epoch: 14, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.882 Vali Acc: 0.825 Test Loss: 0.882 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.7792351245880127
Epoch: 15, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.837 Vali Acc: 0.850 Test Loss: 0.837 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.8344721794128418
Epoch: 16, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.82633376121521
Epoch: 17, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.744 Vali Acc: 0.900 Test Loss: 0.744 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.85892653465271
Epoch: 18, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.698 Vali Acc: 0.950 Test Loss: 0.698 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949993).  Saving model ...
Epoch: 19 cost time: 0.8124215602874756
Epoch: 19, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.656 Vali Acc: 0.950 Test Loss: 0.656 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 20 cost time: 0.7864522933959961
Epoch: 20, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.619 Vali Acc: 0.975 Test Loss: 0.619 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 21 cost time: 0.8119246959686279
Epoch: 21, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.583 Vali Acc: 0.975 Test Loss: 0.583 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 22 cost time: 0.802985429763794
Epoch: 22, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.546 Vali Acc: 0.975 Test Loss: 0.546 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 0.8545618057250977
Epoch: 23, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.512 Vali Acc: 0.975 Test Loss: 0.512 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 0.8094727993011475
Epoch: 24, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.480 Vali Acc: 0.975 Test Loss: 0.480 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.8043038845062256
Epoch: 25, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.453 Vali Acc: 0.975 Test Loss: 0.453 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.8279566764831543
Epoch: 26, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8141281604766846
Epoch: 27, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7640316486358643
Epoch: 28, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8088984489440918
Epoch: 29, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8114545345306396
Epoch: 30, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 351492
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.826578378677368
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.439 Vali Acc: 0.300 Test Loss: 1.439 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.8237307071685791
Epoch: 2, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.416 Vali Acc: 0.300 Test Loss: 1.416 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.8412308692932129
Epoch: 3, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.391 Vali Acc: 0.325 Test Loss: 1.391 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.8502004146575928
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.357 Vali Acc: 0.350 Test Loss: 1.357 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.9842119216918945
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.317 Vali Acc: 0.350 Test Loss: 1.317 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.8272521495819092
Epoch: 6, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.275 Vali Acc: 0.450 Test Loss: 1.275 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.916799783706665
Epoch: 7, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.230 Vali Acc: 0.625 Test Loss: 1.230 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.8357594013214111
Epoch: 8, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.184 Vali Acc: 0.675 Test Loss: 1.184 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.883359432220459
Epoch: 9, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9192345142364502
Epoch: 10, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.094 Vali Acc: 0.675 Test Loss: 1.094 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.8682115077972412
Epoch: 11, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 12 cost time: 0.8582167625427246
Epoch: 12, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.8846457004547119
Epoch: 13, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.8970451354980469
Epoch: 14, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 0.9691581726074219
Epoch: 15, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 0.9491910934448242
Epoch: 16, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.764 Vali Acc: 0.850 Test Loss: 0.764 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.9833695888519287
Epoch: 17, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.713 Vali Acc: 0.875 Test Loss: 0.713 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.9319117069244385
Epoch: 18, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.9006621837615967
Epoch: 19, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.9081563949584961
Epoch: 20, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.9146034717559814
Epoch: 21, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.8925504684448242
Epoch: 22, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.9155035018920898
Epoch: 23, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.472 Vali Acc: 0.975 Test Loss: 0.472 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 0.9718661308288574
Epoch: 24, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.8447165489196777
Epoch: 25, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8954477310180664
Epoch: 26, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9829719066619873
Epoch: 27, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0109283924102783
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.9692237377166748
Epoch: 29, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.356 Vali Acc: 1.000 Test Loss: 0.356 Test Acc: 1.000
Validation loss decreased (-0.974996 --> -0.999996).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 1179204
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5452191829681396
Epoch: 1, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.326 Vali Acc: 0.175 Test Loss: 1.326 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.7671003341674805
Epoch: 2, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.305 Vali Acc: 0.200 Test Loss: 1.305 Test Acc: 0.200
Validation loss decreased (-0.174987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.604060173034668
Epoch: 3, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.283 Vali Acc: 0.225 Test Loss: 1.283 Test Acc: 0.225
Validation loss decreased (-0.199987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.6633827686309814
Epoch: 4, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.255 Vali Acc: 0.225 Test Loss: 1.255 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 5 cost time: 0.7720165252685547
Epoch: 5, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.223 Vali Acc: 0.450 Test Loss: 1.223 Test Acc: 0.450
Validation loss decreased (-0.224987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.6844420433044434
Epoch: 6, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5991034507751465
Epoch: 7, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.7770085334777832
Epoch: 8, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.121 Vali Acc: 0.575 Test Loss: 1.121 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.73313307762146
Epoch: 9, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.081 Vali Acc: 0.625 Test Loss: 1.081 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.7471644878387451
Epoch: 10, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.7189521789550781
Epoch: 11, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.7949967384338379
Epoch: 12, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.850977897644043
Epoch: 13, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.902 Vali Acc: 0.750 Test Loss: 0.902 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 0.7889716625213623
Epoch: 14, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.857 Vali Acc: 0.800 Test Loss: 0.857 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 0.8366420269012451
Epoch: 15, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.8125607967376709
Epoch: 16, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.8418102264404297
Epoch: 17, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.720 Vali Acc: 0.925 Test Loss: 0.720 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.7191951274871826
Epoch: 18, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.676 Vali Acc: 0.925 Test Loss: 0.676 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.7564544677734375
Epoch: 19, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.633 Vali Acc: 0.925 Test Loss: 0.633 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.7713682651519775
Epoch: 20, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.595 Vali Acc: 0.925 Test Loss: 0.595 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.8106913566589355
Epoch: 21, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.562 Vali Acc: 0.925 Test Loss: 0.562 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.7939136028289795
Epoch: 22, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.530 Vali Acc: 0.925 Test Loss: 0.530 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.7935798168182373
Epoch: 23, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.7364828586578369
Epoch: 24, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.7611887454986572
Epoch: 25, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.444 Vali Acc: 0.950 Test Loss: 0.444 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.807342529296875
Epoch: 26, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.8182172775268555
Epoch: 27, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.800868034362793
Epoch: 28, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7836425304412842
Epoch: 29, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8100669384002686
Epoch: 30, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 351492
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6872668266296387
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.443 Vali Acc: 0.325 Test Loss: 1.443 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.7200517654418945
Epoch: 2, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.420 Vali Acc: 0.325 Test Loss: 1.420 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.8263664245605469
Epoch: 3, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.395 Vali Acc: 0.325 Test Loss: 1.395 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.7753396034240723
Epoch: 4, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.756173849105835
Epoch: 5, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.6573104858398438
Epoch: 6, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.7245070934295654
Epoch: 7, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.224 Vali Acc: 0.650 Test Loss: 1.224 Test Acc: 0.650
Validation loss decreased (-0.499987 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.762768030166626
Epoch: 8, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.181 Vali Acc: 0.600 Test Loss: 1.181 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.758110761642456
Epoch: 9, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.770477294921875
Epoch: 10, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7408983707427979
Epoch: 11, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.057 Vali Acc: 0.650 Test Loss: 1.057 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.7575588226318359
Epoch: 12, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.7751319408416748
Epoch: 13, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.958 Vali Acc: 0.725 Test Loss: 0.958 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.8144090175628662
Epoch: 14, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.911 Vali Acc: 0.800 Test Loss: 0.911 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 0.7424557209014893
Epoch: 15, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.862 Vali Acc: 0.825 Test Loss: 0.862 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 0.7551066875457764
Epoch: 16, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.815 Vali Acc: 0.850 Test Loss: 0.815 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.7680854797363281
Epoch: 17, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.777 Vali Acc: 0.875 Test Loss: 0.777 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.7552318572998047
Epoch: 18, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 0.7527129650115967
Epoch: 19, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.700 Vali Acc: 0.850 Test Loss: 0.700 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7049119472503662
Epoch: 20, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.7524669170379639
Epoch: 21, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.7630405426025391
Epoch: 22, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.7631683349609375
Epoch: 23, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.778984785079956
Epoch: 24, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.814777135848999
Epoch: 25, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.8577430248260498
Epoch: 26, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7802791595458984
Epoch: 27, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.7675948143005371
Epoch: 28, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.7635900974273682
Epoch: 29, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 0.7774596214294434
Epoch: 30, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1179204
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5248804092407227
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.290 Vali Acc: 0.250 Test Loss: 1.290 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.7715408802032471
Epoch: 2, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.268 Vali Acc: 0.275 Test Loss: 1.268 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.6399154663085938
Epoch: 3, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.243 Vali Acc: 0.325 Test Loss: 1.243 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.712367057800293
Epoch: 4, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.211 Vali Acc: 0.475 Test Loss: 1.211 Test Acc: 0.475
Validation loss decreased (-0.324988 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.70986008644104
Epoch: 5, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.7075161933898926
Epoch: 6, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.140 Vali Acc: 0.575 Test Loss: 1.140 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7634830474853516
Epoch: 7, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8718307018280029
Epoch: 8, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.070 Vali Acc: 0.625 Test Loss: 1.070 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.7663223743438721
Epoch: 9, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.032 Vali Acc: 0.625 Test Loss: 1.032 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.7269275188446045
Epoch: 10, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.994 Vali Acc: 0.725 Test Loss: 0.994 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.7603015899658203
Epoch: 11, Steps: 3 | Train Loss: 0.833 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.8210544586181641
Epoch: 12, Steps: 3 | Train Loss: 0.833 Vali Loss: 0.910 Vali Acc: 0.800 Test Loss: 0.910 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.753544807434082
Epoch: 13, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.865 Vali Acc: 0.800 Test Loss: 0.865 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.7406775951385498
Epoch: 14, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 0.7586991786956787
Epoch: 15, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.772 Vali Acc: 0.875 Test Loss: 0.772 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.8194549083709717
Epoch: 16, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.726 Vali Acc: 0.900 Test Loss: 0.726 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.7951099872589111
Epoch: 17, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.6703629493713379
Epoch: 18, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.640 Vali Acc: 0.925 Test Loss: 0.640 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 0.7957355976104736
Epoch: 19, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.601 Vali Acc: 0.925 Test Loss: 0.601 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.7241477966308594
Epoch: 20, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7729949951171875
Epoch: 21, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7454938888549805
Epoch: 22, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7626264095306396
Epoch: 23, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.7181751728057861
Epoch: 24, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.7254986763000488
Epoch: 25, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.9077048301696777
Epoch: 26, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.6831469535827637
Epoch: 27, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.7674036026000977
Epoch: 28, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.7668614387512207
Epoch: 29, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.7409231662750244
Epoch: 30, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 351492
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.3537588119506836
Epoch: 1, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.510 Vali Acc: 0.100 Test Loss: 1.510 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 1.2867603302001953
Epoch: 2, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.481 Vali Acc: 0.125 Test Loss: 1.481 Test Acc: 0.125
Validation loss decreased (-0.099985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 1.284494161605835
Epoch: 3, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.452 Vali Acc: 0.200 Test Loss: 1.452 Test Acc: 0.200
Validation loss decreased (-0.124985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 1.2023704051971436
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.416 Vali Acc: 0.325 Test Loss: 1.416 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.2045714855194092
Epoch: 5, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.164388656616211
Epoch: 6, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.329 Vali Acc: 0.575 Test Loss: 1.329 Test Acc: 0.575
Validation loss decreased (-0.374986 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 1.2729299068450928
Epoch: 7, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.285 Vali Acc: 0.575 Test Loss: 1.285 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 1.3068130016326904
Epoch: 8, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.242 Vali Acc: 0.600 Test Loss: 1.242 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 1.2376964092254639
Epoch: 9, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.198 Vali Acc: 0.675 Test Loss: 1.198 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 1.3961102962493896
Epoch: 10, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.155 Vali Acc: 0.675 Test Loss: 1.155 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 1.2825453281402588
Epoch: 11, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.112 Vali Acc: 0.750 Test Loss: 1.112 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 1.3184869289398193
Epoch: 12, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.066 Vali Acc: 0.800 Test Loss: 1.066 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799989).  Saving model ...
Epoch: 13 cost time: 1.269749402999878
Epoch: 13, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.014 Vali Acc: 0.825 Test Loss: 1.014 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 1.2156422138214111
Epoch: 14, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.958 Vali Acc: 0.825 Test Loss: 0.958 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 15 cost time: 1.2754008769989014
Epoch: 15, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.899 Vali Acc: 0.850 Test Loss: 0.899 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 1.151521921157837
Epoch: 16, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.838 Vali Acc: 0.850 Test Loss: 0.838 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.2851428985595703
Epoch: 17, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.778 Vali Acc: 0.875 Test Loss: 0.778 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 1.0892753601074219
Epoch: 18, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.722 Vali Acc: 0.875 Test Loss: 0.722 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 1.2712242603302002
Epoch: 19, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 1.2572886943817139
Epoch: 20, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.616 Vali Acc: 0.925 Test Loss: 0.616 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 1.1620779037475586
Epoch: 21, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.568 Vali Acc: 0.950 Test Loss: 0.568 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 1.108640432357788
Epoch: 22, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 1.1793873310089111
Epoch: 23, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.490 Vali Acc: 0.975 Test Loss: 0.490 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 1.2557446956634521
Epoch: 24, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.457 Vali Acc: 0.975 Test Loss: 0.457 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 1.2122914791107178
Epoch: 25, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.423 Vali Acc: 0.975 Test Loss: 0.423 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 1.1891682147979736
Epoch: 26, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 1.2840917110443115
Epoch: 27, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.366 Vali Acc: 0.975 Test Loss: 0.366 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 1.2539186477661133
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 1.311767578125
Epoch: 29, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 1.2745320796966553
Epoch: 30, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 593092
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1163227558135986
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.445 Vali Acc: 0.325 Test Loss: 1.445 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.9377591609954834
Epoch: 2, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.072758674621582
Epoch: 3, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.423 Vali Acc: 0.425 Test Loss: 1.423 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.9844970703125
Epoch: 4, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.407 Vali Acc: 0.425 Test Loss: 1.407 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.936992883682251
Epoch: 5, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.388 Vali Acc: 0.425 Test Loss: 1.388 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.9029312133789062
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.366 Vali Acc: 0.450 Test Loss: 1.366 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 1.009596586227417
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.344 Vali Acc: 0.450 Test Loss: 1.344 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.8815569877624512
Epoch: 8, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.321 Vali Acc: 0.475 Test Loss: 1.321 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.9371039867401123
Epoch: 9, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.296 Vali Acc: 0.475 Test Loss: 1.296 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 10 cost time: 0.9518172740936279
Epoch: 10, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 0.922553539276123
Epoch: 11, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.011735200881958
Epoch: 12, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.013540267944336
Epoch: 13, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.0737895965576172
Epoch: 14, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 0.9740579128265381
Epoch: 15, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.100 Vali Acc: 0.650 Test Loss: 1.100 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.0201866626739502
Epoch: 16, Steps: 3 | Train Loss: 0.799 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.057 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 17 cost time: 0.9446587562561035
Epoch: 17, Steps: 3 | Train Loss: 0.754 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 1.0545084476470947
Epoch: 18, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.967 Vali Acc: 0.700 Test Loss: 0.967 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 0.8967571258544922
Epoch: 19, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 1.0334508419036865
Epoch: 20, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.880 Vali Acc: 0.725 Test Loss: 0.880 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 21 cost time: 1.0559768676757812
Epoch: 21, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.0399634838104248
Epoch: 22, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 1.0746254920959473
Epoch: 23, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.737 Vali Acc: 0.825 Test Loss: 0.737 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 1.0106163024902344
Epoch: 24, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.914435625076294
Epoch: 25, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 1.0328145027160645
Epoch: 26, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 1.147312879562378
Epoch: 27, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.594 Vali Acc: 0.875 Test Loss: 0.594 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.9641327857971191
Epoch: 28, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 1.1085913181304932
Epoch: 29, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.995438814163208
Epoch: 30, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 179204
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0255162715911865
Epoch: 1, Steps: 3 | Train Loss: 1.506 Vali Loss: 1.523 Vali Acc: 0.125 Test Loss: 1.523 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.0847103595733643
Epoch: 2, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.495 Vali Acc: 0.125 Test Loss: 1.495 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 1.0176653861999512
Epoch: 3, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.466 Vali Acc: 0.175 Test Loss: 1.466 Test Acc: 0.175
Validation loss decreased (-0.124985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 1.0377140045166016
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.432 Vali Acc: 0.325 Test Loss: 1.432 Test Acc: 0.325
Validation loss decreased (-0.174985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.1703486442565918
Epoch: 5, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.392 Vali Acc: 0.375 Test Loss: 1.392 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.9778037071228027
Epoch: 6, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.350 Vali Acc: 0.475 Test Loss: 1.350 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.9434480667114258
Epoch: 7, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.307 Vali Acc: 0.575 Test Loss: 1.307 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574987).  Saving model ...
Epoch: 8 cost time: 1.0429985523223877
Epoch: 8, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.265 Vali Acc: 0.575 Test Loss: 1.265 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 1.0031509399414062
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.9690518379211426
Epoch: 10, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.180 Vali Acc: 0.575 Test Loss: 1.180 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 11 cost time: 0.9445457458496094
Epoch: 11, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.137 Vali Acc: 0.700 Test Loss: 1.137 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.0539612770080566
Epoch: 12, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.092 Vali Acc: 0.775 Test Loss: 1.092 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 13 cost time: 1.1279034614562988
Epoch: 13, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.043 Vali Acc: 0.775 Test Loss: 1.043 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 0.9255211353302002
Epoch: 14, Steps: 3 | Train Loss: 0.857 Vali Loss: 0.992 Vali Acc: 0.775 Test Loss: 0.992 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 1.1724817752838135
Epoch: 15, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.935 Vali Acc: 0.800 Test Loss: 0.935 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.0373835563659668
Epoch: 16, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 1.0312511920928955
Epoch: 17, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.817 Vali Acc: 0.825 Test Loss: 0.817 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 1.084775447845459
Epoch: 18, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.761 Vali Acc: 0.825 Test Loss: 0.761 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 1.050567388534546
Epoch: 19, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.708 Vali Acc: 0.825 Test Loss: 0.708 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 1.0446794033050537
Epoch: 20, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 1.0120601654052734
Epoch: 21, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.609 Vali Acc: 0.900 Test Loss: 0.609 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 1.0250585079193115
Epoch: 22, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.569 Vali Acc: 0.900 Test Loss: 0.569 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.1010518074035645
Epoch: 23, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.9979720115661621
Epoch: 24, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.1160602569580078
Epoch: 25, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.0175094604492188
Epoch: 26, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.0232691764831543
Epoch: 27, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.0443389415740967
Epoch: 28, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.9949300289154053
Epoch: 29, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.089564561843872
Epoch: 30, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 593092
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0598719120025635
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.456 Vali Acc: 0.225 Test Loss: 1.456 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 0.8979732990264893
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.446 Vali Acc: 0.350 Test Loss: 1.446 Test Acc: 0.350
Validation loss decreased (-0.224985 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.002054214477539
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.432 Vali Acc: 0.450 Test Loss: 1.432 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.973308801651001
Epoch: 4, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.415 Vali Acc: 0.475 Test Loss: 1.415 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 5 cost time: 0.9020020961761475
Epoch: 5, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.389 Vali Acc: 0.475 Test Loss: 1.389 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.8111109733581543
Epoch: 6, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.366 Vali Acc: 0.500 Test Loss: 1.366 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.0791220664978027
Epoch: 7, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.340 Vali Acc: 0.500 Test Loss: 1.340 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.9176168441772461
Epoch: 8, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.988227128982544
Epoch: 9, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.284 Vali Acc: 0.525 Test Loss: 1.284 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 1.0386669635772705
Epoch: 10, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.257 Vali Acc: 0.525 Test Loss: 1.257 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.8741796016693115
Epoch: 11, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.227 Vali Acc: 0.550 Test Loss: 1.227 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.9612865447998047
Epoch: 12, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 0.9273979663848877
Epoch: 13, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 0.9644014835357666
Epoch: 14, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.8975212574005127
Epoch: 15, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 0.9855525493621826
Epoch: 16, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.9456052780151367
Epoch: 17, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.981 Vali Acc: 0.700 Test Loss: 0.981 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 0.9755887985229492
Epoch: 18, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.9844057559967041
Epoch: 19, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.921015739440918
Epoch: 20, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 0.9768743515014648
Epoch: 21, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.9606432914733887
Epoch: 22, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.9668073654174805
Epoch: 23, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.708 Vali Acc: 0.875 Test Loss: 0.708 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.9035110473632812
Epoch: 24, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.8810639381408691
Epoch: 25, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 1.0550217628479004
Epoch: 26, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.9994509220123291
Epoch: 27, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.9753224849700928
Epoch: 28, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.97821044921875
Epoch: 29, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.0119740962982178
Epoch: 30, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 179204
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.759798765182495
Epoch: 1, Steps: 3 | Train Loss: 1.476 Vali Loss: 1.533 Vali Acc: 0.100 Test Loss: 1.533 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 0.895021915435791
Epoch: 2, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.506 Vali Acc: 0.100 Test Loss: 1.506 Test Acc: 0.100
Validation loss decreased (-0.099985 --> -0.099985).  Saving model ...
Epoch: 3 cost time: 0.8723256587982178
Epoch: 3, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.480 Vali Acc: 0.125 Test Loss: 1.480 Test Acc: 0.125
Validation loss decreased (-0.099985 --> -0.124985).  Saving model ...
Epoch: 4 cost time: 0.8101019859313965
Epoch: 4, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (-0.124985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.8428657054901123
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.8103575706481934
Epoch: 6, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.8035132884979248
Epoch: 7, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.327 Vali Acc: 0.525 Test Loss: 1.327 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.8555402755737305
Epoch: 8, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.289 Vali Acc: 0.525 Test Loss: 1.289 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.7741272449493408
Epoch: 9, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.252 Vali Acc: 0.475 Test Loss: 1.252 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8463771343231201
Epoch: 10, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7847614288330078
Epoch: 11, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8212954998016357
Epoch: 12, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.7791557312011719
Epoch: 13, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.086 Vali Acc: 0.675 Test Loss: 1.086 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.762014627456665
Epoch: 14, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.039 Vali Acc: 0.750 Test Loss: 1.039 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.6887760162353516
Epoch: 15, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.7044217586517334
Epoch: 16, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.936 Vali Acc: 0.825 Test Loss: 0.936 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 0.7855618000030518
Epoch: 17, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.881 Vali Acc: 0.825 Test Loss: 0.881 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 0.8443748950958252
Epoch: 18, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.828 Vali Acc: 0.825 Test Loss: 0.828 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.8972346782684326
Epoch: 19, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.930793046951294
Epoch: 20, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.9084830284118652
Epoch: 21, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.8633739948272705
Epoch: 22, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.8190133571624756
Epoch: 23, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.601 Vali Acc: 0.875 Test Loss: 0.601 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8837234973907471
Epoch: 24, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8278841972351074
Epoch: 25, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.8746919631958008
Epoch: 26, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.8180994987487793
Epoch: 27, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.8266878128051758
Epoch: 28, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.7871401309967041
Epoch: 29, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.8103930950164795
Epoch: 30, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 593092
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6738409996032715
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 0.8292109966278076
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.463 Vali Acc: 0.275 Test Loss: 1.463 Test Acc: 0.275
Validation loss decreased (-0.199985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 0.7853519916534424
Epoch: 3, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.449 Vali Acc: 0.375 Test Loss: 1.449 Test Acc: 0.375
Validation loss decreased (-0.274985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.8946623802185059
Epoch: 4, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.431 Vali Acc: 0.425 Test Loss: 1.431 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.851144552230835
Epoch: 5, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.411 Vali Acc: 0.450 Test Loss: 1.411 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 6 cost time: 0.8350503444671631
Epoch: 6, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.388 Vali Acc: 0.475 Test Loss: 1.388 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 7 cost time: 0.9325706958770752
Epoch: 7, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.363 Vali Acc: 0.475 Test Loss: 1.363 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474986).  Saving model ...
Epoch: 8 cost time: 0.7904455661773682
Epoch: 8, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.339 Vali Acc: 0.475 Test Loss: 1.339 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.8292114734649658
Epoch: 9, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.312 Vali Acc: 0.525 Test Loss: 1.312 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 0.7608866691589355
Epoch: 10, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.766366720199585
Epoch: 11, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.252 Vali Acc: 0.525 Test Loss: 1.252 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8399331569671631
Epoch: 12, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.217 Vali Acc: 0.525 Test Loss: 1.217 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7977859973907471
Epoch: 13, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.179 Vali Acc: 0.550 Test Loss: 1.179 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.8467366695404053
Epoch: 14, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.139 Vali Acc: 0.650 Test Loss: 1.139 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.8229961395263672
Epoch: 15, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 16 cost time: 0.8624122142791748
Epoch: 16, Steps: 3 | Train Loss: 0.790 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 0.8791205883026123
Epoch: 17, Steps: 3 | Train Loss: 0.730 Vali Loss: 1.025 Vali Acc: 0.725 Test Loss: 1.025 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 0.8752937316894531
Epoch: 18, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8747923374176025
Epoch: 19, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7841970920562744
Epoch: 20, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8077051639556885
Epoch: 21, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.8195033073425293
Epoch: 22, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 23 cost time: 0.8310146331787109
Epoch: 23, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 0.9150424003601074
Epoch: 24, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.751 Vali Acc: 0.800 Test Loss: 0.751 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.8120698928833008
Epoch: 25, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 0.8004622459411621
Epoch: 26, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.684 Vali Acc: 0.825 Test Loss: 0.684 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 27 cost time: 0.8632733821868896
Epoch: 27, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.655 Vali Acc: 0.825 Test Loss: 0.655 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 28 cost time: 0.8056178092956543
Epoch: 28, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.628 Vali Acc: 0.825 Test Loss: 0.628 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 29 cost time: 0.8482317924499512
Epoch: 29, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 0.8082928657531738
Epoch: 30, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 179204
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.697551965713501
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.496 Vali Acc: 0.100 Test Loss: 1.496 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 1.3344671726226807
Epoch: 2, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.463 Vali Acc: 0.100 Test Loss: 1.463 Test Acc: 0.100
Validation loss decreased (-0.099985 --> -0.099985).  Saving model ...
Epoch: 3 cost time: 1.4232754707336426
Epoch: 3, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.439 Vali Acc: 0.125 Test Loss: 1.439 Test Acc: 0.125
Validation loss decreased (-0.099985 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 1.3101699352264404
Epoch: 4, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.409 Vali Acc: 0.150 Test Loss: 1.409 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 5 cost time: 1.3216605186462402
Epoch: 5, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.374 Vali Acc: 0.275 Test Loss: 1.374 Test Acc: 0.275
Validation loss decreased (-0.149986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.2689762115478516
Epoch: 6, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.336 Vali Acc: 0.475 Test Loss: 1.336 Test Acc: 0.475
Validation loss decreased (-0.274986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 1.261253833770752
Epoch: 7, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.298 Vali Acc: 0.550 Test Loss: 1.298 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 1.3934540748596191
Epoch: 8, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 1.2563977241516113
Epoch: 9, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.219 Vali Acc: 0.525 Test Loss: 1.219 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3378942012786865
Epoch: 10, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 1.1448209285736084
Epoch: 11, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 1.3339829444885254
Epoch: 12, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 1.4095768928527832
Epoch: 13, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.045 Vali Acc: 0.725 Test Loss: 1.045 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.3984313011169434
Epoch: 14, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.000 Vali Acc: 0.725 Test Loss: 1.000 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.3452188968658447
Epoch: 15, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 1.3008372783660889
Epoch: 16, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 1.372135877609253
Epoch: 17, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 1.2969543933868408
Epoch: 18, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 19 cost time: 1.4002652168273926
Epoch: 19, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.744 Vali Acc: 0.875 Test Loss: 0.744 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 1.295123815536499
Epoch: 20, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.694 Vali Acc: 0.900 Test Loss: 0.694 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 1.3137891292572021
Epoch: 21, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.647 Vali Acc: 0.925 Test Loss: 0.647 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 1.2252049446105957
Epoch: 22, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.606 Vali Acc: 0.925 Test Loss: 0.606 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 1.4357869625091553
Epoch: 23, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.569 Vali Acc: 0.925 Test Loss: 0.569 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 1.1439018249511719
Epoch: 24, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.533 Vali Acc: 0.925 Test Loss: 0.533 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.4212734699249268
Epoch: 25, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.2996528148651123
Epoch: 26, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.495821237564087
Epoch: 27, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.3263421058654785
Epoch: 28, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.3650143146514893
Epoch: 29, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.3541717529296875
Epoch: 30, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 300036
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2304186820983887
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.12483811378479
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.366 Vali Acc: 0.350 Test Loss: 1.366 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.0890100002288818
Epoch: 3, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.1892600059509277
Epoch: 4, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.185347318649292
Epoch: 5, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.1613903045654297
Epoch: 6, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.3005115985870361
Epoch: 7, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.202160120010376
Epoch: 8, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.230 Vali Acc: 0.425 Test Loss: 1.230 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 1.2556586265563965
Epoch: 9, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.204 Vali Acc: 0.450 Test Loss: 1.204 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.116032600402832
Epoch: 10, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.0964024066925049
Epoch: 11, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.147 Vali Acc: 0.675 Test Loss: 1.147 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 1.2094149589538574
Epoch: 12, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.119 Vali Acc: 0.725 Test Loss: 1.119 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.2176907062530518
Epoch: 13, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.088 Vali Acc: 0.750 Test Loss: 1.088 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 1.1637165546417236
Epoch: 14, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.056 Vali Acc: 0.775 Test Loss: 1.056 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 15 cost time: 1.1563162803649902
Epoch: 15, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.023 Vali Acc: 0.775 Test Loss: 1.023 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 16 cost time: 1.0655958652496338
Epoch: 16, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.987 Vali Acc: 0.800 Test Loss: 0.987 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 17 cost time: 1.0673377513885498
Epoch: 17, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.949 Vali Acc: 0.800 Test Loss: 0.949 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 1.1078109741210938
Epoch: 18, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.911 Vali Acc: 0.800 Test Loss: 0.911 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 1.113135576248169
Epoch: 19, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.874 Vali Acc: 0.825 Test Loss: 0.874 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 20 cost time: 1.2767322063446045
Epoch: 20, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.1208670139312744
Epoch: 21, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.800 Vali Acc: 0.850 Test Loss: 0.800 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 1.2663795948028564
Epoch: 22, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 1.2573230266571045
Epoch: 23, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 1.3834013938903809
Epoch: 24, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 1.1003880500793457
Epoch: 25, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 1.176490068435669
Epoch: 26, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.639 Vali Acc: 0.850 Test Loss: 0.639 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.1575536727905273
Epoch: 27, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.1283366680145264
Epoch: 28, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.1188790798187256
Epoch: 29, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 1.202209711074829
Epoch: 30, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 93060
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2221665382385254
Epoch: 1, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.495 Vali Acc: 0.100 Test Loss: 1.495 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 1.1548449993133545
Epoch: 2, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.463 Vali Acc: 0.100 Test Loss: 1.463 Test Acc: 0.100
Validation loss decreased (-0.099985 --> -0.099985).  Saving model ...
Epoch: 3 cost time: 1.0728247165679932
Epoch: 3, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.440 Vali Acc: 0.125 Test Loss: 1.440 Test Acc: 0.125
Validation loss decreased (-0.099985 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 1.1697845458984375
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.411 Vali Acc: 0.175 Test Loss: 1.411 Test Acc: 0.175
Validation loss decreased (-0.124986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 1.147810935974121
Epoch: 5, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (-0.174986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.0734083652496338
Epoch: 6, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.342 Vali Acc: 0.450 Test Loss: 1.342 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 1.0294668674468994
Epoch: 7, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.306 Vali Acc: 0.500 Test Loss: 1.306 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.148141860961914
Epoch: 8, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9944169521331787
Epoch: 9, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.0508201122283936
Epoch: 10, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 1.0997228622436523
Epoch: 11, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.147 Vali Acc: 0.550 Test Loss: 1.147 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 1.0689971446990967
Epoch: 12, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.1061444282531738
Epoch: 13, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.060 Vali Acc: 0.725 Test Loss: 1.060 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 1.1044270992279053
Epoch: 14, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 15 cost time: 1.1615936756134033
Epoch: 15, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 1.118980884552002
Epoch: 16, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 1.215918779373169
Epoch: 17, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 1.0514013767242432
Epoch: 18, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.828 Vali Acc: 0.800 Test Loss: 0.828 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.0574216842651367
Epoch: 19, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.781 Vali Acc: 0.875 Test Loss: 0.781 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 1.1511774063110352
Epoch: 20, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.740 Vali Acc: 0.900 Test Loss: 0.740 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 1.178948163986206
Epoch: 21, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.698 Vali Acc: 0.900 Test Loss: 0.698 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 1.0612339973449707
Epoch: 22, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0917718410491943
Epoch: 23, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.626 Vali Acc: 0.900 Test Loss: 0.626 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.1577928066253662
Epoch: 24, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.9696238040924072
Epoch: 25, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 1.1633045673370361
Epoch: 26, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.1355745792388916
Epoch: 27, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.2937188148498535
Epoch: 28, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.1306335926055908
Epoch: 29, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.0923008918762207
Epoch: 30, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 300036
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0829813480377197
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.07322359085083
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.0895092487335205
Epoch: 3, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.345 Vali Acc: 0.400 Test Loss: 1.345 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.1593189239501953
Epoch: 4, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.0377192497253418
Epoch: 5, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.0604844093322754
Epoch: 6, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.0936262607574463
Epoch: 7, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.0478243827819824
Epoch: 8, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.217 Vali Acc: 0.450 Test Loss: 1.217 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.9918019771575928
Epoch: 9, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.187 Vali Acc: 0.475 Test Loss: 1.187 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 1.0952284336090088
Epoch: 10, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 1.0906481742858887
Epoch: 11, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.128 Vali Acc: 0.750 Test Loss: 1.128 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 1.0086042881011963
Epoch: 12, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.099 Vali Acc: 0.725 Test Loss: 1.099 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0591239929199219
Epoch: 13, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.067 Vali Acc: 0.750 Test Loss: 1.067 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 1.0383868217468262
Epoch: 14, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.035 Vali Acc: 0.775 Test Loss: 1.035 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 1.0197675228118896
Epoch: 15, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.001 Vali Acc: 0.800 Test Loss: 1.001 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 16 cost time: 1.0144243240356445
Epoch: 16, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.964 Vali Acc: 0.850 Test Loss: 0.964 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849990).  Saving model ...
Epoch: 17 cost time: 1.0968132019042969
Epoch: 17, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.925 Vali Acc: 0.850 Test Loss: 0.925 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 1.0092408657073975
Epoch: 18, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 1.0692875385284424
Epoch: 19, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.9439122676849365
Epoch: 20, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.810 Vali Acc: 0.850 Test Loss: 0.810 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.9370360374450684
Epoch: 21, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.776 Vali Acc: 0.850 Test Loss: 0.776 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 1.1592915058135986
Epoch: 22, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.744 Vali Acc: 0.875 Test Loss: 0.744 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 1.0425517559051514
Epoch: 23, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.714 Vali Acc: 0.875 Test Loss: 0.714 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 1.0289380550384521
Epoch: 24, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 1.0210890769958496
Epoch: 25, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0125207901000977
Epoch: 26, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0333971977233887
Epoch: 27, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0073120594024658
Epoch: 28, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0523552894592285
Epoch: 29, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0697963237762451
Epoch: 30, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 93060
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.82707142829895
Epoch: 1, Steps: 3 | Train Loss: 1.545 Vali Loss: 1.514 Vali Acc: 0.050 Test Loss: 1.514 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 0.9368038177490234
Epoch: 2, Steps: 3 | Train Loss: 1.526 Vali Loss: 1.481 Vali Acc: 0.050 Test Loss: 1.481 Test Acc: 0.050
Validation loss decreased (-0.049985 --> -0.049985).  Saving model ...
Epoch: 3 cost time: 0.8825435638427734
Epoch: 3, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.457 Vali Acc: 0.075 Test Loss: 1.457 Test Acc: 0.075
Validation loss decreased (-0.049985 --> -0.074985).  Saving model ...
Epoch: 4 cost time: 0.8974654674530029
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.428 Vali Acc: 0.175 Test Loss: 1.428 Test Acc: 0.175
Validation loss decreased (-0.074985 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.9029481410980225
Epoch: 5, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.174986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.9655077457427979
Epoch: 6, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.359 Vali Acc: 0.450 Test Loss: 1.359 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 7 cost time: 0.9526517391204834
Epoch: 7, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.324 Vali Acc: 0.475 Test Loss: 1.324 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.8539228439331055
Epoch: 8, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.287 Vali Acc: 0.475 Test Loss: 1.287 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.838146448135376
Epoch: 9, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.249 Vali Acc: 0.475 Test Loss: 1.249 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.8632407188415527
Epoch: 10, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.209 Vali Acc: 0.475 Test Loss: 1.209 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.9447066783905029
Epoch: 11, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.169 Vali Acc: 0.575 Test Loss: 1.169 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.8190586566925049
Epoch: 12, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.128 Vali Acc: 0.575 Test Loss: 1.128 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.879951000213623
Epoch: 13, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.8635873794555664
Epoch: 14, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.8538787364959717
Epoch: 15, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.8868136405944824
Epoch: 16, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.9009196758270264
Epoch: 17, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.918 Vali Acc: 0.750 Test Loss: 0.918 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 0.9001679420471191
Epoch: 18, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.8513662815093994
Epoch: 19, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.828 Vali Acc: 0.800 Test Loss: 0.828 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.8531079292297363
Epoch: 20, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.9881317615509033
Epoch: 21, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.754 Vali Acc: 0.825 Test Loss: 0.754 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.8660092353820801
Epoch: 22, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.723 Vali Acc: 0.825 Test Loss: 0.723 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.8376102447509766
Epoch: 23, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 0.8975963592529297
Epoch: 24, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.8180139064788818
Epoch: 25, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.8482608795166016
Epoch: 26, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.618 Vali Acc: 0.875 Test Loss: 0.618 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.8021059036254883
Epoch: 27, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.596 Vali Acc: 0.875 Test Loss: 0.596 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.8897967338562012
Epoch: 28, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.574 Vali Acc: 0.875 Test Loss: 0.574 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.8736972808837891
Epoch: 29, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.828679084777832
Epoch: 30, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 300036
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.905949831008911
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.346 Vali Acc: 0.350 Test Loss: 1.346 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.8868768215179443
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.328 Vali Acc: 0.350 Test Loss: 1.328 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.8936765193939209
Epoch: 3, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.314 Vali Acc: 0.350 Test Loss: 1.314 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.8759205341339111
Epoch: 4, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.754178524017334
Epoch: 5, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.270 Vali Acc: 0.350 Test Loss: 1.270 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.764427661895752
Epoch: 6, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8875575065612793
Epoch: 7, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.219 Vali Acc: 0.425 Test Loss: 1.219 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.85308837890625
Epoch: 8, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.7828469276428223
Epoch: 9, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.166 Vali Acc: 0.625 Test Loss: 1.166 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 0.8714613914489746
Epoch: 10, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.140 Vali Acc: 0.675 Test Loss: 1.140 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.8415594100952148
Epoch: 11, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.8118457794189453
Epoch: 12, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.7963201999664307
Epoch: 13, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.8792834281921387
Epoch: 14, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.026 Vali Acc: 0.750 Test Loss: 1.026 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.8226637840270996
Epoch: 15, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.9046788215637207
Epoch: 16, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.958 Vali Acc: 0.775 Test Loss: 0.958 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 17 cost time: 0.8102290630340576
Epoch: 17, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.8471889495849609
Epoch: 18, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 0.8242967128753662
Epoch: 19, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.9437868595123291
Epoch: 20, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.811 Vali Acc: 0.825 Test Loss: 0.811 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 21 cost time: 0.829056978225708
Epoch: 21, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.779 Vali Acc: 0.825 Test Loss: 0.779 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.9126203060150146
Epoch: 22, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.748 Vali Acc: 0.850 Test Loss: 0.748 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 23 cost time: 0.8733949661254883
Epoch: 23, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 0.887199878692627
Epoch: 24, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.692 Vali Acc: 0.875 Test Loss: 0.692 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.8237526416778564
Epoch: 25, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.663 Vali Acc: 0.875 Test Loss: 0.663 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.8343961238861084
Epoch: 26, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.869147539138794
Epoch: 27, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9742636680603027
Epoch: 28, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.878375768661499
Epoch: 29, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.8740768432617188
Epoch: 30, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 93060
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.67885160446167
Epoch: 1, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.2908220291137695
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.2951805591583252
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.2257158756256104
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.274 Vali Acc: 0.525 Test Loss: 1.274 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 1.224921703338623
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.251 Vali Acc: 0.525 Test Loss: 1.251 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 1.2111937999725342
Epoch: 6, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.226 Vali Acc: 0.525 Test Loss: 1.226 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.2077882289886475
Epoch: 7, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.201 Vali Acc: 0.525 Test Loss: 1.201 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.3105227947235107
Epoch: 8, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 1.27685546875
Epoch: 9, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.148 Vali Acc: 0.550 Test Loss: 1.148 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 1.2633419036865234
Epoch: 10, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.121 Vali Acc: 0.650 Test Loss: 1.121 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.270167589187622
Epoch: 11, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.091 Vali Acc: 0.700 Test Loss: 1.091 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.2451763153076172
Epoch: 12, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.061 Vali Acc: 0.725 Test Loss: 1.061 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.2740223407745361
Epoch: 13, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.030 Vali Acc: 0.750 Test Loss: 1.030 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.3373322486877441
Epoch: 14, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.998 Vali Acc: 0.800 Test Loss: 0.998 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 1.2684144973754883
Epoch: 15, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.967 Vali Acc: 0.875 Test Loss: 0.967 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874990).  Saving model ...
Epoch: 16 cost time: 1.3012022972106934
Epoch: 16, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.933 Vali Acc: 0.875 Test Loss: 0.933 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 17 cost time: 1.336789608001709
Epoch: 17, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.899 Vali Acc: 0.925 Test Loss: 0.899 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924991).  Saving model ...
Epoch: 18 cost time: 1.3172521591186523
Epoch: 18, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.863 Vali Acc: 0.950 Test Loss: 0.863 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949991).  Saving model ...
Epoch: 19 cost time: 1.2851464748382568
Epoch: 19, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.827 Vali Acc: 0.950 Test Loss: 0.827 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949992).  Saving model ...
Epoch: 20 cost time: 1.3427581787109375
Epoch: 20, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.793 Vali Acc: 0.950 Test Loss: 0.793 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 21 cost time: 1.2287461757659912
Epoch: 21, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.759 Vali Acc: 0.950 Test Loss: 0.759 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 22 cost time: 1.209235668182373
Epoch: 22, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.728 Vali Acc: 0.950 Test Loss: 0.728 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 23 cost time: 1.343449592590332
Epoch: 23, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.697 Vali Acc: 0.950 Test Loss: 0.697 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 24 cost time: 1.2940504550933838
Epoch: 24, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.669 Vali Acc: 0.950 Test Loss: 0.669 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 25 cost time: 1.2369084358215332
Epoch: 25, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.646 Vali Acc: 0.950 Test Loss: 0.646 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 1.2164726257324219
Epoch: 26, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.624 Vali Acc: 0.950 Test Loss: 0.624 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 1.2949879169464111
Epoch: 27, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.605 Vali Acc: 0.950 Test Loss: 0.605 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 1.2360575199127197
Epoch: 28, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 1.3007588386535645
Epoch: 29, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.547 Vali Acc: 0.975 Test Loss: 0.547 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 30 cost time: 1.2664070129394531
Epoch: 30, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.519 Vali Acc: 0.975 Test Loss: 0.519 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 589988
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2607927322387695
Epoch: 1, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.413 Vali Acc: 0.250 Test Loss: 1.413 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.088519811630249
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.399 Vali Acc: 0.225 Test Loss: 1.399 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.009657621383667
Epoch: 3, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.386 Vali Acc: 0.225 Test Loss: 1.386 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0295326709747314
Epoch: 4, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.368 Vali Acc: 0.225 Test Loss: 1.368 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0594017505645752
Epoch: 5, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.0817277431488037
Epoch: 6, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.1359703540802002
Epoch: 7, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.301 Vali Acc: 0.525 Test Loss: 1.301 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 1.0899009704589844
Epoch: 8, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.274 Vali Acc: 0.550 Test Loss: 1.274 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 1.0702707767486572
Epoch: 9, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 1.078587532043457
Epoch: 10, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.219 Vali Acc: 0.575 Test Loss: 1.219 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1076722145080566
Epoch: 11, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.9846353530883789
Epoch: 12, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 13 cost time: 1.1105008125305176
Epoch: 13, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.128 Vali Acc: 0.650 Test Loss: 1.128 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.9938654899597168
Epoch: 14, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.094 Vali Acc: 0.675 Test Loss: 1.094 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 1.0870840549468994
Epoch: 15, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 1.1200122833251953
Epoch: 16, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 1.0987656116485596
Epoch: 17, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.992 Vali Acc: 0.775 Test Loss: 0.992 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.0434730052947998
Epoch: 18, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.955 Vali Acc: 0.775 Test Loss: 0.955 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 1.0914533138275146
Epoch: 19, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 1.0914723873138428
Epoch: 20, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.1584224700927734
Epoch: 21, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.850 Vali Acc: 0.825 Test Loss: 0.850 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 1.0252702236175537
Epoch: 22, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.818 Vali Acc: 0.825 Test Loss: 0.818 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 1.0708513259887695
Epoch: 23, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.083970308303833
Epoch: 24, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.760 Vali Acc: 0.875 Test Loss: 0.760 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 1.1499078273773193
Epoch: 25, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.730 Vali Acc: 0.875 Test Loss: 0.730 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 1.0389854907989502
Epoch: 26, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.701 Vali Acc: 0.900 Test Loss: 0.701 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 1.0332303047180176
Epoch: 27, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.673 Vali Acc: 0.900 Test Loss: 0.673 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 1.066431999206543
Epoch: 28, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.648 Vali Acc: 0.925 Test Loss: 0.648 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 1.0633811950683594
Epoch: 29, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.622 Vali Acc: 0.925 Test Loss: 0.622 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 1.0864031314849854
Epoch: 30, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.596 Vali Acc: 0.925 Test Loss: 0.596 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 176004
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.364733934402466
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.322 Vali Acc: 0.500 Test Loss: 1.322 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.085573673248291
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.048438549041748
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.0471057891845703
Epoch: 4, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.0731236934661865
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0794734954833984
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.0131213665008545
Epoch: 7, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.013904094696045
Epoch: 8, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.0401678085327148
Epoch: 9, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.0909051895141602
Epoch: 10, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 1.0834341049194336
Epoch: 11, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 1.121891975402832
Epoch: 12, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.058 Vali Acc: 0.725 Test Loss: 1.058 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.0980751514434814
Epoch: 13, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 1.1205816268920898
Epoch: 14, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.999 Vali Acc: 0.800 Test Loss: 0.999 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 1.0952849388122559
Epoch: 15, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.968 Vali Acc: 0.825 Test Loss: 0.968 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 16 cost time: 1.06998872756958
Epoch: 16, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.937 Vali Acc: 0.850 Test Loss: 0.937 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 1.1380894184112549
Epoch: 17, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.904 Vali Acc: 0.850 Test Loss: 0.904 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 0.9905550479888916
Epoch: 18, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.868 Vali Acc: 0.900 Test Loss: 0.868 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 1.111048698425293
Epoch: 19, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.832 Vali Acc: 0.900 Test Loss: 0.832 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 1.0211765766143799
Epoch: 20, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.796 Vali Acc: 0.925 Test Loss: 0.796 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 21 cost time: 0.981250524520874
Epoch: 21, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.761 Vali Acc: 0.925 Test Loss: 0.761 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 22 cost time: 0.9980323314666748
Epoch: 22, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.728 Vali Acc: 0.950 Test Loss: 0.728 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 23 cost time: 1.0263218879699707
Epoch: 23, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.696 Vali Acc: 0.950 Test Loss: 0.696 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 24 cost time: 1.0733680725097656
Epoch: 24, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.664 Vali Acc: 0.950 Test Loss: 0.664 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 25 cost time: 1.0401604175567627
Epoch: 25, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.636 Vali Acc: 0.950 Test Loss: 0.636 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 1.0287001132965088
Epoch: 26, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.605 Vali Acc: 0.950 Test Loss: 0.605 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 1.0884807109832764
Epoch: 27, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0494229793548584
Epoch: 28, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.553 Vali Acc: 0.950 Test Loss: 0.553 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 1.122786045074463
Epoch: 29, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.530 Vali Acc: 0.950 Test Loss: 0.530 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 1.1261985301971436
Epoch: 30, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 589988
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1481385231018066
Epoch: 1, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.410 Vali Acc: 0.250 Test Loss: 1.410 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1444196701049805
Epoch: 2, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.9579513072967529
Epoch: 3, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.384 Vali Acc: 0.225 Test Loss: 1.384 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9858930110931396
Epoch: 4, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.367 Vali Acc: 0.225 Test Loss: 1.367 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9488475322723389
Epoch: 5, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.9831027984619141
Epoch: 6, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.0101649761199951
Epoch: 7, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.9550895690917969
Epoch: 8, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.276 Vali Acc: 0.600 Test Loss: 1.276 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 0.9756674766540527
Epoch: 9, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.249 Vali Acc: 0.625 Test Loss: 1.249 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 1.085141658782959
Epoch: 10, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.221 Vali Acc: 0.625 Test Loss: 1.221 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.9616069793701172
Epoch: 11, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.193 Vali Acc: 0.650 Test Loss: 1.193 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 1.0069105625152588
Epoch: 12, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.163 Vali Acc: 0.650 Test Loss: 1.163 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 13 cost time: 0.9822189807891846
Epoch: 13, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.132 Vali Acc: 0.700 Test Loss: 1.132 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.9829716682434082
Epoch: 14, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.099 Vali Acc: 0.725 Test Loss: 1.099 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.9743177890777588
Epoch: 15, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.067 Vali Acc: 0.725 Test Loss: 1.067 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 0.9826674461364746
Epoch: 16, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.033 Vali Acc: 0.725 Test Loss: 1.033 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.902245044708252
Epoch: 17, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.8671650886535645
Epoch: 18, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.964 Vali Acc: 0.725 Test Loss: 0.964 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9587264060974121
Epoch: 19, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.928 Vali Acc: 0.750 Test Loss: 0.928 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.9068756103515625
Epoch: 20, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.894 Vali Acc: 0.750 Test Loss: 0.894 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.9920566082000732
Epoch: 21, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.861 Vali Acc: 0.825 Test Loss: 0.861 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.9586532115936279
Epoch: 22, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.9368581771850586
Epoch: 23, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.0859453678131104
Epoch: 24, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 0.9775176048278809
Epoch: 25, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.736 Vali Acc: 0.875 Test Loss: 0.736 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 1.0734703540802002
Epoch: 26, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.707 Vali Acc: 0.900 Test Loss: 0.707 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 1.0047471523284912
Epoch: 27, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 1.0755650997161865
Epoch: 28, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.938469648361206
Epoch: 29, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.631 Vali Acc: 0.925 Test Loss: 0.631 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.9282104969024658
Epoch: 30, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.607 Vali Acc: 0.925 Test Loss: 0.607 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 176004
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.042619466781616
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.9342391490936279
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.8784372806549072
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.8549759387969971
Epoch: 4, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.8469066619873047
Epoch: 5, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8711016178131104
Epoch: 6, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9170453548431396
Epoch: 7, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.870600700378418
Epoch: 8, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.8725030422210693
Epoch: 9, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.134 Vali Acc: 0.525 Test Loss: 1.134 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 0.9185822010040283
Epoch: 10, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.107 Vali Acc: 0.550 Test Loss: 1.107 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.8862559795379639
Epoch: 11, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.077 Vali Acc: 0.700 Test Loss: 1.077 Test Acc: 0.700
Validation loss decreased (-0.549989 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.9358320236206055
Epoch: 12, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.046 Vali Acc: 0.700 Test Loss: 1.046 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 0.8555517196655273
Epoch: 13, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.015 Vali Acc: 0.750 Test Loss: 1.015 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.9085469245910645
Epoch: 14, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.983 Vali Acc: 0.825 Test Loss: 0.983 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824990).  Saving model ...
Epoch: 15 cost time: 0.8400318622589111
Epoch: 15, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.951 Vali Acc: 0.825 Test Loss: 0.951 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 16 cost time: 0.9362809658050537
Epoch: 16, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.916 Vali Acc: 0.825 Test Loss: 0.916 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 0.8941769599914551
Epoch: 17, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.880 Vali Acc: 0.875 Test Loss: 0.880 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874991).  Saving model ...
Epoch: 18 cost time: 0.8489933013916016
Epoch: 18, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.843 Vali Acc: 0.875 Test Loss: 0.843 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.9109756946563721
Epoch: 19, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.805 Vali Acc: 0.900 Test Loss: 0.805 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.8438210487365723
Epoch: 20, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.768 Vali Acc: 0.900 Test Loss: 0.768 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.865492582321167
Epoch: 21, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.731 Vali Acc: 0.900 Test Loss: 0.731 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.8676333427429199
Epoch: 22, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.695 Vali Acc: 0.925 Test Loss: 0.695 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 0.9268052577972412
Epoch: 23, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.663 Vali Acc: 0.925 Test Loss: 0.663 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 0.8401315212249756
Epoch: 24, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.629 Vali Acc: 0.925 Test Loss: 0.629 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.7910928726196289
Epoch: 25, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.599 Vali Acc: 0.950 Test Loss: 0.599 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.9650743007659912
Epoch: 26, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.566 Vali Acc: 0.975 Test Loss: 0.566 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 27 cost time: 0.8462862968444824
Epoch: 27, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.536 Vali Acc: 0.975 Test Loss: 0.536 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.8570449352264404
Epoch: 28, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.511 Vali Acc: 0.975 Test Loss: 0.511 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.9158806800842285
Epoch: 29, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.484 Vali Acc: 0.975 Test Loss: 0.484 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 30 cost time: 0.925936222076416
Epoch: 30, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.460 Vali Acc: 1.000 Test Loss: 0.460 Test Acc: 1.000
Validation loss decreased (-0.974995 --> -0.999995).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 589988
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8424184322357178
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.408 Vali Acc: 0.250 Test Loss: 1.408 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.010343313217163
Epoch: 2, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.920438289642334
Epoch: 3, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.8623251914978027
Epoch: 4, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.369 Vali Acc: 0.275 Test Loss: 1.369 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.8962161540985107
Epoch: 5, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.8522078990936279
Epoch: 6, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.333 Vali Acc: 0.475 Test Loss: 1.333 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.8257009983062744
Epoch: 7, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.312 Vali Acc: 0.600 Test Loss: 1.312 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 0.8929989337921143
Epoch: 8, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.288 Vali Acc: 0.625 Test Loss: 1.288 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.8815605640411377
Epoch: 9, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.264 Vali Acc: 0.600 Test Loss: 1.264 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8740568161010742
Epoch: 10, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.239 Vali Acc: 0.600 Test Loss: 1.239 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8524646759033203
Epoch: 11, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.212 Vali Acc: 0.575 Test Loss: 1.212 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8940267562866211
Epoch: 12, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8057925701141357
Epoch: 13, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.153 Vali Acc: 0.650 Test Loss: 1.153 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 0.7821118831634521
Epoch: 14, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.8467447757720947
Epoch: 15, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.091 Vali Acc: 0.750 Test Loss: 1.091 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749989).  Saving model ...
Epoch: 16 cost time: 0.9667346477508545
Epoch: 16, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 17 cost time: 0.8753523826599121
Epoch: 17, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.024 Vali Acc: 0.750 Test Loss: 1.024 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.9157314300537109
Epoch: 18, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.050847053527832
Epoch: 19, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.951 Vali Acc: 0.750 Test Loss: 0.951 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 20 cost time: 0.9246385097503662
Epoch: 20, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.9620935916900635
Epoch: 21, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.882 Vali Acc: 0.825 Test Loss: 0.882 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.9430735111236572
Epoch: 22, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.850 Vali Acc: 0.875 Test Loss: 0.850 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.8611640930175781
Epoch: 23, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.818 Vali Acc: 0.875 Test Loss: 0.818 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 0.9169497489929199
Epoch: 24, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.786 Vali Acc: 0.900 Test Loss: 0.786 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 0.987433671951294
Epoch: 25, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.755 Vali Acc: 0.900 Test Loss: 0.755 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 26 cost time: 0.9077694416046143
Epoch: 26, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.726 Vali Acc: 0.900 Test Loss: 0.726 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 0.9312920570373535
Epoch: 27, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.699 Vali Acc: 0.900 Test Loss: 0.699 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.9401946067810059
Epoch: 28, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.9368619918823242
Epoch: 29, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.652 Vali Acc: 0.900 Test Loss: 0.652 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 30 cost time: 0.9795591831207275
Epoch: 30, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 176004
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.906687021255493
Epoch: 1, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.473 Vali Acc: 0.250 Test Loss: 1.473 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.4993555545806885
Epoch: 2, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.457 Vali Acc: 0.250 Test Loss: 1.457 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.462825059890747
Epoch: 3, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.442 Vali Acc: 0.275 Test Loss: 1.442 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.5014195442199707
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.423 Vali Acc: 0.275 Test Loss: 1.423 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.6599483489990234
Epoch: 5, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.635042667388916
Epoch: 6, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.374 Vali Acc: 0.300 Test Loss: 1.374 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 1.6233417987823486
Epoch: 7, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 8 cost time: 1.527395248413086
Epoch: 8, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.318 Vali Acc: 0.300 Test Loss: 1.318 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 9 cost time: 1.4399890899658203
Epoch: 9, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.290 Vali Acc: 0.325 Test Loss: 1.290 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 10 cost time: 1.5847740173339844
Epoch: 10, Steps: 3 | Train Loss: 1.166 Vali Loss: 1.263 Vali Acc: 0.525 Test Loss: 1.263 Test Acc: 0.525
Validation loss decreased (-0.324987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 1.554985761642456
Epoch: 11, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.235 Vali Acc: 0.575 Test Loss: 1.235 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 1.4400079250335693
Epoch: 12, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.207 Vali Acc: 0.600 Test Loss: 1.207 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 1.5194053649902344
Epoch: 13, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 1.4410896301269531
Epoch: 14, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 15 cost time: 1.4445171356201172
Epoch: 15, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.117 Vali Acc: 0.700 Test Loss: 1.117 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 1.4395661354064941
Epoch: 16, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 1.5726478099822998
Epoch: 17, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.054 Vali Acc: 0.700 Test Loss: 1.054 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 18 cost time: 1.4299933910369873
Epoch: 18, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.021 Vali Acc: 0.750 Test Loss: 1.021 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.4865012168884277
Epoch: 19, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.985 Vali Acc: 0.775 Test Loss: 0.985 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 1.551199197769165
Epoch: 20, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.947 Vali Acc: 0.800 Test Loss: 0.947 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.5782768726348877
Epoch: 21, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.909 Vali Acc: 0.800 Test Loss: 0.909 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.5593993663787842
Epoch: 22, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.871 Vali Acc: 0.800 Test Loss: 0.871 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 1.5948939323425293
Epoch: 23, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.4451110363006592
Epoch: 24, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 1.718895673751831
Epoch: 25, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.761 Vali Acc: 0.875 Test Loss: 0.761 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 26 cost time: 1.5149550437927246
Epoch: 26, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.728 Vali Acc: 0.900 Test Loss: 0.728 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 1.5268609523773193
Epoch: 27, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.697 Vali Acc: 0.950 Test Loss: 0.697 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949993).  Saving model ...
Epoch: 28 cost time: 1.5077342987060547
Epoch: 28, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.667 Vali Acc: 0.950 Test Loss: 0.667 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 29 cost time: 1.4442498683929443
Epoch: 29, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.639 Vali Acc: 0.950 Test Loss: 0.639 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 1.4817790985107422
Epoch: 30, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.608 Vali Acc: 0.950 Test Loss: 0.608 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 296740
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.454679250717163
Epoch: 1, Steps: 3 | Train Loss: 1.543 Vali Loss: 1.448 Vali Acc: 0.150 Test Loss: 1.448 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.3605096340179443
Epoch: 2, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.437 Vali Acc: 0.175 Test Loss: 1.437 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.466627836227417
Epoch: 3, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.425 Vali Acc: 0.175 Test Loss: 1.425 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 1.4027764797210693
Epoch: 4, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.410 Vali Acc: 0.275 Test Loss: 1.410 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.4309148788452148
Epoch: 5, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.2786812782287598
Epoch: 6, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 1.2502720355987549
Epoch: 7, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.352 Vali Acc: 0.425 Test Loss: 1.352 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 1.304337978363037
Epoch: 8, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.331 Vali Acc: 0.425 Test Loss: 1.331 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.3837199211120605
Epoch: 9, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.390462875366211
Epoch: 10, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.289 Vali Acc: 0.425 Test Loss: 1.289 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 1.176927089691162
Epoch: 11, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.268 Vali Acc: 0.425 Test Loss: 1.268 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 1.4321818351745605
Epoch: 12, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.246 Vali Acc: 0.475 Test Loss: 1.246 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 1.3435587882995605
Epoch: 13, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 1.3034493923187256
Epoch: 14, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.199 Vali Acc: 0.475 Test Loss: 1.199 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 1.3262403011322021
Epoch: 15, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.2781879901885986
Epoch: 16, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.146 Vali Acc: 0.550 Test Loss: 1.146 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.343454122543335
Epoch: 17, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.120 Vali Acc: 0.575 Test Loss: 1.120 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 1.170959234237671
Epoch: 18, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.092 Vali Acc: 0.575 Test Loss: 1.092 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 1.259204626083374
Epoch: 19, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 1.2869958877563477
Epoch: 20, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 21 cost time: 1.3614349365234375
Epoch: 21, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.999 Vali Acc: 0.675 Test Loss: 0.999 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 1.3379011154174805
Epoch: 22, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.966 Vali Acc: 0.725 Test Loss: 0.966 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 23 cost time: 1.138068437576294
Epoch: 23, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 24 cost time: 1.581641674041748
Epoch: 24, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.897 Vali Acc: 0.825 Test Loss: 0.897 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 1.2320713996887207
Epoch: 25, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 26 cost time: 1.4031882286071777
Epoch: 26, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.831 Vali Acc: 0.875 Test Loss: 0.831 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 27 cost time: 1.4755141735076904
Epoch: 27, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.799 Vali Acc: 0.875 Test Loss: 0.799 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 28 cost time: 1.3684797286987305
Epoch: 28, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 1.4281699657440186
Epoch: 29, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 1.4701528549194336
Epoch: 30, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.708 Vali Acc: 0.925 Test Loss: 0.708 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 89732
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.429039239883423
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.479 Vali Acc: 0.250 Test Loss: 1.479 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2816357612609863
Epoch: 2, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.462 Vali Acc: 0.250 Test Loss: 1.462 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.3620789051055908
Epoch: 3, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.338930606842041
Epoch: 4, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.427 Vali Acc: 0.275 Test Loss: 1.427 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.2604353427886963
Epoch: 5, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.403 Vali Acc: 0.275 Test Loss: 1.403 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.3864681720733643
Epoch: 6, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 1.2491636276245117
Epoch: 7, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.349 Vali Acc: 0.300 Test Loss: 1.349 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 8 cost time: 1.228485107421875
Epoch: 8, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.319 Vali Acc: 0.275 Test Loss: 1.319 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3064327239990234
Epoch: 9, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.291 Vali Acc: 0.450 Test Loss: 1.291 Test Acc: 0.450
Validation loss decreased (-0.299987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 1.3333909511566162
Epoch: 10, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.264 Vali Acc: 0.525 Test Loss: 1.264 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 1.3378231525421143
Epoch: 11, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.235 Vali Acc: 0.525 Test Loss: 1.235 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 1.3097116947174072
Epoch: 12, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.207 Vali Acc: 0.525 Test Loss: 1.207 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.2790884971618652
Epoch: 13, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.178 Vali Acc: 0.575 Test Loss: 1.178 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 1.183260202407837
Epoch: 14, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.149 Vali Acc: 0.600 Test Loss: 1.149 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 15 cost time: 1.2992420196533203
Epoch: 15, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 1.2981898784637451
Epoch: 16, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 17 cost time: 1.358151912689209
Epoch: 17, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 1.2921218872070312
Epoch: 18, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 19 cost time: 1.2579197883605957
Epoch: 19, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.988 Vali Acc: 0.775 Test Loss: 0.988 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 1.3534114360809326
Epoch: 20, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.950 Vali Acc: 0.800 Test Loss: 0.950 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.34535551071167
Epoch: 21, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.3217761516571045
Epoch: 22, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.868 Vali Acc: 0.850 Test Loss: 0.868 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 1.3650271892547607
Epoch: 23, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.2475111484527588
Epoch: 24, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 1.237795114517212
Epoch: 25, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 1.2376251220703125
Epoch: 26, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 1.2311441898345947
Epoch: 27, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.706 Vali Acc: 0.900 Test Loss: 0.706 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 1.1296727657318115
Epoch: 28, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.676 Vali Acc: 0.900 Test Loss: 0.676 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 1.3830938339233398
Epoch: 29, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 1.4653263092041016
Epoch: 30, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 296740
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.256770372390747
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.456 Vali Acc: 0.125 Test Loss: 1.456 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.2568304538726807
Epoch: 2, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.445 Vali Acc: 0.150 Test Loss: 1.445 Test Acc: 0.150
Validation loss decreased (-0.124985 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 1.3461997509002686
Epoch: 3, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.433 Vali Acc: 0.150 Test Loss: 1.433 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 1.2404241561889648
Epoch: 4, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.418 Vali Acc: 0.225 Test Loss: 1.418 Test Acc: 0.225
Validation loss decreased (-0.149986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 1.2597827911376953
Epoch: 5, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.2335469722747803
Epoch: 6, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.380 Vali Acc: 0.375 Test Loss: 1.380 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 1.1310710906982422
Epoch: 7, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.356 Vali Acc: 0.425 Test Loss: 1.356 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 1.2528204917907715
Epoch: 8, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.335 Vali Acc: 0.425 Test Loss: 1.335 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.1750879287719727
Epoch: 9, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 1.1987395286560059
Epoch: 10, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.292 Vali Acc: 0.425 Test Loss: 1.292 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1974549293518066
Epoch: 11, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.271 Vali Acc: 0.450 Test Loss: 1.271 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 1.2274510860443115
Epoch: 12, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.250 Vali Acc: 0.450 Test Loss: 1.250 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 13 cost time: 1.207719087600708
Epoch: 13, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.226 Vali Acc: 0.450 Test Loss: 1.226 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 14 cost time: 1.2355401515960693
Epoch: 14, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.211 Vali Acc: 0.450 Test Loss: 1.211 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 1.2522180080413818
Epoch: 15, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.186 Vali Acc: 0.475 Test Loss: 1.186 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 1.2189290523529053
Epoch: 16, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 1.2448337078094482
Epoch: 17, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.136 Vali Acc: 0.550 Test Loss: 1.136 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 1.1182661056518555
Epoch: 18, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 1.2206029891967773
Epoch: 19, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 1.25205397605896
Epoch: 20, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.051 Vali Acc: 0.575 Test Loss: 1.051 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 1.1806309223175049
Epoch: 21, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.020 Vali Acc: 0.625 Test Loss: 1.020 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 1.2443573474884033
Epoch: 22, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.987 Vali Acc: 0.650 Test Loss: 0.987 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 1.1220996379852295
Epoch: 23, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 24 cost time: 1.2401158809661865
Epoch: 24, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 1.3084461688995361
Epoch: 25, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.885 Vali Acc: 0.825 Test Loss: 0.885 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 1.2288570404052734
Epoch: 26, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.852 Vali Acc: 0.850 Test Loss: 0.852 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 27 cost time: 1.27866530418396
Epoch: 27, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 1.2075860500335693
Epoch: 28, Steps: 3 | Train Loss: 0.584 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 1.2477643489837646
Epoch: 29, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 30 cost time: 1.302361011505127
Epoch: 30, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.725 Vali Acc: 0.875 Test Loss: 0.725 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 89732
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9699466228485107
Epoch: 1, Steps: 3 | Train Loss: 1.519 Vali Loss: 1.490 Vali Acc: 0.250 Test Loss: 1.490 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.0558009147644043
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.474 Vali Acc: 0.250 Test Loss: 1.474 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.016775131225586
Epoch: 3, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.457 Vali Acc: 0.250 Test Loss: 1.457 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 0.9824135303497314
Epoch: 4, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.436 Vali Acc: 0.250 Test Loss: 1.436 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.024519443511963
Epoch: 5, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.411 Vali Acc: 0.275 Test Loss: 1.411 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 0.9989094734191895
Epoch: 6, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 0.974128007888794
Epoch: 7, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.354 Vali Acc: 0.300 Test Loss: 1.354 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 0.9491260051727295
Epoch: 8, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.322 Vali Acc: 0.300 Test Loss: 1.322 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 9 cost time: 0.9466300010681152
Epoch: 9, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
Validation loss decreased (-0.299987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.8790500164031982
Epoch: 10, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.263 Vali Acc: 0.525 Test Loss: 1.263 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 1.0181691646575928
Epoch: 11, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 1.0036213397979736
Epoch: 12, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.205 Vali Acc: 0.525 Test Loss: 1.205 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.0656988620758057
Epoch: 13, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.175 Vali Acc: 0.600 Test Loss: 1.175 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 1.021265983581543
Epoch: 14, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0308027267456055
Epoch: 15, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.116 Vali Acc: 0.575 Test Loss: 1.116 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9471361637115479
Epoch: 16, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.086 Vali Acc: 0.575 Test Loss: 1.086 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9828989505767822
Epoch: 17, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.056 Vali Acc: 0.575 Test Loss: 1.056 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.050370216369629
Epoch: 18, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.025 Vali Acc: 0.650 Test Loss: 1.025 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649990).  Saving model ...
Epoch: 19 cost time: 1.0126843452453613
Epoch: 19, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 1.0897345542907715
Epoch: 20, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 21 cost time: 0.9526185989379883
Epoch: 21, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.909 Vali Acc: 0.800 Test Loss: 0.909 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.0049073696136475
Epoch: 22, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 23 cost time: 1.0041983127593994
Epoch: 23, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.021632432937622
Epoch: 24, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.800 Vali Acc: 0.850 Test Loss: 0.800 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 25 cost time: 1.0909497737884521
Epoch: 25, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 1.021416425704956
Epoch: 26, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 0.976060152053833
Epoch: 27, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.706 Vali Acc: 0.900 Test Loss: 0.706 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 1.0607194900512695
Epoch: 28, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.673 Vali Acc: 0.900 Test Loss: 0.673 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.9415807723999023
Epoch: 29, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.639 Vali Acc: 0.900 Test Loss: 0.639 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 1.0925769805908203
Epoch: 30, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 296740
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.033109188079834
Epoch: 1, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.441 Vali Acc: 0.150 Test Loss: 1.441 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.9925456047058105
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.431 Vali Acc: 0.150 Test Loss: 1.431 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.9895119667053223
Epoch: 3, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.420 Vali Acc: 0.175 Test Loss: 1.420 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 1.0243580341339111
Epoch: 4, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 1.0165996551513672
Epoch: 5, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.036461591720581
Epoch: 6, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 1.0294420719146729
Epoch: 7, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.0528771877288818
Epoch: 8, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0055840015411377
Epoch: 9, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.306 Vali Acc: 0.425 Test Loss: 1.306 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 1.0258944034576416
Epoch: 10, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.285 Vali Acc: 0.425 Test Loss: 1.285 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 1.015580415725708
Epoch: 11, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.264 Vali Acc: 0.425 Test Loss: 1.264 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 1.1174039840698242
Epoch: 12, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 1.0101861953735352
Epoch: 13, Steps: 3 | Train Loss: 1.151 Vali Loss: 1.219 Vali Acc: 0.475 Test Loss: 1.219 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 1.010714054107666
Epoch: 14, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.196 Vali Acc: 0.475 Test Loss: 1.196 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 15 cost time: 0.9952938556671143
Epoch: 15, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.0155680179595947
Epoch: 16, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.143 Vali Acc: 0.575 Test Loss: 1.143 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 1.0475890636444092
Epoch: 17, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.117 Vali Acc: 0.575 Test Loss: 1.117 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 1.1044456958770752
Epoch: 18, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.9780044555664062
Epoch: 19, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.058 Vali Acc: 0.625 Test Loss: 1.058 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 1.0311651229858398
Epoch: 20, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0383999347686768
Epoch: 21, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.035 Vali Acc: 0.650 Test Loss: 1.035 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 22 cost time: 0.9998917579650879
Epoch: 22, Steps: 3 | Train Loss: 0.794 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 0.9450478553771973
Epoch: 23, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 1.0915677547454834
Epoch: 24, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 25 cost time: 1.0372514724731445
Epoch: 25, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.918 Vali Acc: 0.800 Test Loss: 0.918 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 0.9901320934295654
Epoch: 26, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.891 Vali Acc: 0.825 Test Loss: 0.891 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 27 cost time: 0.9588627815246582
Epoch: 27, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.862 Vali Acc: 0.850 Test Loss: 0.862 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 28 cost time: 0.981907844543457
Epoch: 28, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 1.0784521102905273
Epoch: 29, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 0.8878259658813477
Epoch: 30, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 89732
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 4.337687969207764
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.281 Vali Acc: 0.425 Test Loss: 1.281 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.7744948863983154
Epoch: 2, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.270 Vali Acc: 0.425 Test Loss: 1.270 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.8355646133422852
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.261 Vali Acc: 0.425 Test Loss: 1.261 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.7204184532165527
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.248 Vali Acc: 0.450 Test Loss: 1.248 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 1.9478580951690674
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.232 Vali Acc: 0.475 Test Loss: 1.232 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 2.0058958530426025
Epoch: 6, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.213 Vali Acc: 0.475 Test Loss: 1.213 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 1.9699828624725342
Epoch: 7, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.193 Vali Acc: 0.475 Test Loss: 1.193 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 1.9613449573516846
Epoch: 8, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.171 Vali Acc: 0.525 Test Loss: 1.171 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 1.8347737789154053
Epoch: 9, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.148 Vali Acc: 0.525 Test Loss: 1.148 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 1.7666215896606445
Epoch: 10, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
Validation loss decreased (-0.524989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 1.9110524654388428
Epoch: 11, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.690549612045288
Epoch: 12, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 1.6280279159545898
Epoch: 13, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.043 Vali Acc: 0.725 Test Loss: 1.043 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.8952617645263672
Epoch: 14, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.015 Vali Acc: 0.775 Test Loss: 1.015 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 1.9145867824554443
Epoch: 15, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.985 Vali Acc: 0.775 Test Loss: 0.985 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 16 cost time: 1.8971223831176758
Epoch: 16, Steps: 3 | Train Loss: 0.933 Vali Loss: 0.954 Vali Acc: 0.825 Test Loss: 0.954 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 17 cost time: 1.6479294300079346
Epoch: 17, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.921 Vali Acc: 0.825 Test Loss: 0.921 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 1.7574849128723145
Epoch: 18, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.889 Vali Acc: 0.875 Test Loss: 0.889 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874991).  Saving model ...
Epoch: 19 cost time: 1.8496530055999756
Epoch: 19, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.855 Vali Acc: 0.875 Test Loss: 0.855 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 20 cost time: 1.979182243347168
Epoch: 20, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.823 Vali Acc: 0.875 Test Loss: 0.823 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 21 cost time: 1.8725428581237793
Epoch: 21, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 22 cost time: 1.9281213283538818
Epoch: 22, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.760 Vali Acc: 0.900 Test Loss: 0.760 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 23 cost time: 1.7435383796691895
Epoch: 23, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.727 Vali Acc: 0.900 Test Loss: 0.727 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 1.82918381690979
Epoch: 24, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 1.6887707710266113
Epoch: 25, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 1.7640950679779053
Epoch: 26, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 27 cost time: 1.6767020225524902
Epoch: 27, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.605 Vali Acc: 0.925 Test Loss: 0.605 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 2.0012714862823486
Epoch: 28, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 1.8896996974945068
Epoch: 29, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 1.6137535572052002
Epoch: 30, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.527 Vali Acc: 0.975 Test Loss: 0.527 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 150116
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.4090359210968018
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.441 Vali Acc: 0.150 Test Loss: 1.441 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.3563432693481445
Epoch: 2, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.428 Vali Acc: 0.150 Test Loss: 1.428 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 1.514484167098999
Epoch: 3, Steps: 3 | Train Loss: 1.511 Vali Loss: 1.418 Vali Acc: 0.175 Test Loss: 1.418 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 1.3462250232696533
Epoch: 4, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.404 Vali Acc: 0.225 Test Loss: 1.404 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 1.4570765495300293
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.389 Vali Acc: 0.275 Test Loss: 1.389 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.408977746963501
Epoch: 6, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.372 Vali Acc: 0.375 Test Loss: 1.372 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 1.4653618335723877
Epoch: 7, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.354 Vali Acc: 0.425 Test Loss: 1.354 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 8 cost time: 1.32077956199646
Epoch: 8, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.336 Vali Acc: 0.425 Test Loss: 1.336 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.622755527496338
Epoch: 9, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.317 Vali Acc: 0.525 Test Loss: 1.317 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 10 cost time: 1.5768036842346191
Epoch: 10, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.297 Vali Acc: 0.575 Test Loss: 1.297 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 11 cost time: 1.5083694458007812
Epoch: 11, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.276 Vali Acc: 0.575 Test Loss: 1.276 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 12 cost time: 1.5517642498016357
Epoch: 12, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.255 Vali Acc: 0.575 Test Loss: 1.255 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 13 cost time: 1.3595576286315918
Epoch: 13, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.233 Vali Acc: 0.575 Test Loss: 1.233 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 1.3748137950897217
Epoch: 14, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.211 Vali Acc: 0.575 Test Loss: 1.211 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 1.4722802639007568
Epoch: 15, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.187 Vali Acc: 0.650 Test Loss: 1.187 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 1.507192611694336
Epoch: 16, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.162 Vali Acc: 0.650 Test Loss: 1.162 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 17 cost time: 1.5181889533996582
Epoch: 17, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 1.3552298545837402
Epoch: 18, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.108 Vali Acc: 0.650 Test Loss: 1.108 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 1.2491123676300049
Epoch: 19, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.081 Vali Acc: 0.675 Test Loss: 1.081 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 20 cost time: 1.486515998840332
Epoch: 20, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.053 Vali Acc: 0.675 Test Loss: 1.053 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 21 cost time: 1.3939144611358643
Epoch: 21, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 1.533581018447876
Epoch: 22, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 1.5675787925720215
Epoch: 23, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 1.5081768035888672
Epoch: 24, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 1.4998562335968018
Epoch: 25, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 1.4411265850067139
Epoch: 26, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.883 Vali Acc: 0.775 Test Loss: 0.883 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 27 cost time: 1.4555613994598389
Epoch: 27, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 28 cost time: 1.401343822479248
Epoch: 28, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 1.5345213413238525
Epoch: 29, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4646036624908447
Epoch: 30, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 46596
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.7070188522338867
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.489694595336914
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.277 Vali Acc: 0.450 Test Loss: 1.277 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.6048545837402344
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.268 Vali Acc: 0.450 Test Loss: 1.268 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.643803596496582
Epoch: 4, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.255 Vali Acc: 0.450 Test Loss: 1.255 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.6128480434417725
Epoch: 5, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.623504638671875
Epoch: 6, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 1.6106529235839844
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.3788318634033203
Epoch: 8, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.180 Vali Acc: 0.525 Test Loss: 1.180 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 1.5496256351470947
Epoch: 9, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.157 Vali Acc: 0.525 Test Loss: 1.157 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 1.633901596069336
Epoch: 10, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.132 Vali Acc: 0.575 Test Loss: 1.132 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 1.52327299118042
Epoch: 11, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 1.7493178844451904
Epoch: 12, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 1.6268866062164307
Epoch: 13, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.6233336925506592
Epoch: 14, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 15 cost time: 1.5659801959991455
Epoch: 15, Steps: 3 | Train Loss: 0.954 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 1.6539599895477295
Epoch: 16, Steps: 3 | Train Loss: 0.939 Vali Loss: 0.964 Vali Acc: 0.725 Test Loss: 0.964 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 1.5805222988128662
Epoch: 17, Steps: 3 | Train Loss: 0.943 Vali Loss: 0.932 Vali Acc: 0.725 Test Loss: 0.932 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 1.6311876773834229
Epoch: 18, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.900 Vali Acc: 0.825 Test Loss: 0.900 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824991).  Saving model ...
Epoch: 19 cost time: 1.623521327972412
Epoch: 19, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 20 cost time: 1.640554666519165
Epoch: 20, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.835 Vali Acc: 0.875 Test Loss: 0.835 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 21 cost time: 1.671837568283081
Epoch: 21, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.804 Vali Acc: 0.900 Test Loss: 0.804 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 22 cost time: 1.8228535652160645
Epoch: 22, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.774 Vali Acc: 0.900 Test Loss: 0.774 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 23 cost time: 1.5838706493377686
Epoch: 23, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.743 Vali Acc: 0.900 Test Loss: 0.743 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 1.6774792671203613
Epoch: 24, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.711 Vali Acc: 0.900 Test Loss: 0.711 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 1.584026575088501
Epoch: 25, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.681 Vali Acc: 0.900 Test Loss: 0.681 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 1.6680645942687988
Epoch: 26, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 1.7623214721679688
Epoch: 27, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.627 Vali Acc: 0.925 Test Loss: 0.627 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 1.865452527999878
Epoch: 28, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.601 Vali Acc: 0.925 Test Loss: 0.601 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 1.7304949760437012
Epoch: 29, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 1.563406229019165
Epoch: 30, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 150116
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0501863956451416
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.442 Vali Acc: 0.125 Test Loss: 1.442 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 1.2480909824371338
Epoch: 2, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.428 Vali Acc: 0.175 Test Loss: 1.428 Test Acc: 0.175
Validation loss decreased (-0.124986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.2857210636138916
Epoch: 3, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.418 Vali Acc: 0.175 Test Loss: 1.418 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 1.2063767910003662
Epoch: 4, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.404 Vali Acc: 0.200 Test Loss: 1.404 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 1.2676429748535156
Epoch: 5, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.2021043300628662
Epoch: 6, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.371 Vali Acc: 0.375 Test Loss: 1.371 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 1.1584482192993164
Epoch: 7, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.173401117324829
Epoch: 8, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.334 Vali Acc: 0.575 Test Loss: 1.334 Test Acc: 0.575
Validation loss decreased (-0.499986 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 1.2391870021820068
Epoch: 9, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.315 Vali Acc: 0.575 Test Loss: 1.315 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 10 cost time: 1.206956386566162
Epoch: 10, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.295 Vali Acc: 0.600 Test Loss: 1.295 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 1.0986032485961914
Epoch: 11, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.273 Vali Acc: 0.600 Test Loss: 1.273 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 1.2471957206726074
Epoch: 12, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.251 Vali Acc: 0.600 Test Loss: 1.251 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 1.2086844444274902
Epoch: 13, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.229 Vali Acc: 0.600 Test Loss: 1.229 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 1.257962703704834
Epoch: 14, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 1.2727711200714111
Epoch: 15, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.182 Vali Acc: 0.625 Test Loss: 1.182 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 1.174997091293335
Epoch: 16, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 17 cost time: 1.1687824726104736
Epoch: 17, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.129 Vali Acc: 0.725 Test Loss: 1.129 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 18 cost time: 1.20200777053833
Epoch: 18, Steps: 3 | Train Loss: 1.030 Vali Loss: 1.101 Vali Acc: 0.725 Test Loss: 1.101 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 19 cost time: 1.1997671127319336
Epoch: 19, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.073 Vali Acc: 0.700 Test Loss: 1.073 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1430232524871826
Epoch: 20, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.044 Vali Acc: 0.700 Test Loss: 1.044 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1381323337554932
Epoch: 21, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.015 Vali Acc: 0.700 Test Loss: 1.015 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2926781177520752
Epoch: 22, Steps: 3 | Train Loss: 0.828 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 23 cost time: 1.2817180156707764
Epoch: 23, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 24 cost time: 1.2649824619293213
Epoch: 24, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.931 Vali Acc: 0.750 Test Loss: 0.931 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 25 cost time: 1.2837655544281006
Epoch: 25, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 26 cost time: 1.2599091529846191
Epoch: 26, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.875 Vali Acc: 0.800 Test Loss: 0.875 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 27 cost time: 1.194751262664795
Epoch: 27, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1479215621948242
Epoch: 28, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 1.0657565593719482
Epoch: 29, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.796 Vali Acc: 0.850 Test Loss: 0.796 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 30 cost time: 1.2898845672607422
Epoch: 30, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 46596
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0903635025024414
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.289 Vali Acc: 0.450 Test Loss: 1.289 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.1350011825561523
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.154195785522461
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.269 Vali Acc: 0.450 Test Loss: 1.269 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.1845624446868896
Epoch: 4, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.256 Vali Acc: 0.450 Test Loss: 1.256 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.0966384410858154
Epoch: 5, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.241 Vali Acc: 0.450 Test Loss: 1.241 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.0819189548492432
Epoch: 6, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.223 Vali Acc: 0.475 Test Loss: 1.223 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 1.2216906547546387
Epoch: 7, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.203 Vali Acc: 0.475 Test Loss: 1.203 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 1.1510093212127686
Epoch: 8, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.1408233642578125
Epoch: 9, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.2410433292388916
Epoch: 10, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.136 Vali Acc: 0.525 Test Loss: 1.136 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 1.1299645900726318
Epoch: 11, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 1.1046621799468994
Epoch: 12, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.086 Vali Acc: 0.550 Test Loss: 1.086 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 13 cost time: 1.3182721138000488
Epoch: 13, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 1.1829237937927246
Epoch: 14, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 15 cost time: 1.182114601135254
Epoch: 15, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.002 Vali Acc: 0.725 Test Loss: 1.002 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 1.1335196495056152
Epoch: 16, Steps: 3 | Train Loss: 0.934 Vali Loss: 0.971 Vali Acc: 0.750 Test Loss: 0.971 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 1.3450360298156738
Epoch: 17, Steps: 3 | Train Loss: 0.951 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 1.175853967666626
Epoch: 18, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 1.243346929550171
Epoch: 19, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 1.2318310737609863
Epoch: 20, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.843 Vali Acc: 0.850 Test Loss: 0.843 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 1.2085597515106201
Epoch: 21, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 1.1851646900177002
Epoch: 22, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 1.1056647300720215
Epoch: 23, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.757 Vali Acc: 0.850 Test Loss: 0.757 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 24 cost time: 1.144181489944458
Epoch: 24, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1532821655273438
Epoch: 25, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1483969688415527
Epoch: 26, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 1.1377177238464355
Epoch: 27, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 1.222409725189209
Epoch: 28, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 1.2100164890289307
Epoch: 29, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 1.2064647674560547
Epoch: 30, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 150116
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7099759578704834
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.405 Vali Acc: 0.150 Test Loss: 1.405 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.946021318435669
Epoch: 2, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.391 Vali Acc: 0.200 Test Loss: 1.391 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.0610713958740234
Epoch: 3, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.9472167491912842
Epoch: 4, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.369 Vali Acc: 0.275 Test Loss: 1.369 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.8391039371490479
Epoch: 5, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.354 Vali Acc: 0.350 Test Loss: 1.354 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.8995471000671387
Epoch: 6, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.337 Vali Acc: 0.450 Test Loss: 1.337 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.8702008724212646
Epoch: 7, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.320 Vali Acc: 0.500 Test Loss: 1.320 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.8892977237701416
Epoch: 8, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.302 Vali Acc: 0.525 Test Loss: 1.302 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.9252963066101074
Epoch: 9, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.284 Vali Acc: 0.550 Test Loss: 1.284 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 10 cost time: 0.9088399410247803
Epoch: 10, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 0.9373109340667725
Epoch: 11, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 12 cost time: 0.9150564670562744
Epoch: 12, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.221 Vali Acc: 0.575 Test Loss: 1.221 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.9952065944671631
Epoch: 13, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.198 Vali Acc: 0.575 Test Loss: 1.198 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.9697844982147217
Epoch: 14, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.176 Vali Acc: 0.600 Test Loss: 1.176 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 15 cost time: 0.9169633388519287
Epoch: 15, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.152 Vali Acc: 0.675 Test Loss: 1.152 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674988).  Saving model ...
Epoch: 16 cost time: 1.0486798286437988
Epoch: 16, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.125 Vali Acc: 0.725 Test Loss: 1.125 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 17 cost time: 0.8947601318359375
Epoch: 17, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.097 Vali Acc: 0.725 Test Loss: 1.097 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 18 cost time: 1.0312166213989258
Epoch: 18, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.069 Vali Acc: 0.725 Test Loss: 1.069 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 19 cost time: 1.007981300354004
Epoch: 19, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.039 Vali Acc: 0.775 Test Loss: 1.039 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 20 cost time: 0.9695987701416016
Epoch: 20, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.009 Vali Acc: 0.750 Test Loss: 1.009 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0993046760559082
Epoch: 21, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.978 Vali Acc: 0.775 Test Loss: 0.978 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 22 cost time: 0.9132318496704102
Epoch: 22, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.947 Vali Acc: 0.775 Test Loss: 0.947 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 0.9191849231719971
Epoch: 23, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.918 Vali Acc: 0.800 Test Loss: 0.918 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 1.0585594177246094
Epoch: 24, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.888 Vali Acc: 0.825 Test Loss: 0.888 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 1.048238754272461
Epoch: 25, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.857 Vali Acc: 0.825 Test Loss: 0.857 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 1.033478021621704
Epoch: 26, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.826 Vali Acc: 0.825 Test Loss: 0.826 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 1.026261806488037
Epoch: 27, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 1.072995901107788
Epoch: 28, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 1.0588397979736328
Epoch: 29, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.0632097721099854
Epoch: 30, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.740 Vali Acc: 0.825 Test Loss: 0.740 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_TimesNet_UEA_ftM_sl100_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 46596
model size : 0.34MB
