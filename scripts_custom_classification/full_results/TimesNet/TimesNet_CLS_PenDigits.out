Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1955250
	speed: 1.5620s/iter; left time: 21822.7797s
	iters: 200, epoch: 1 | loss: 0.0264906
	speed: 1.5004s/iter; left time: 20811.6096s
	iters: 300, epoch: 1 | loss: 0.0382938
	speed: 1.5366s/iter; left time: 21160.1599s
	iters: 400, epoch: 1 | loss: 0.6063110
	speed: 1.5644s/iter; left time: 21386.6618s
Epoch: 1 cost time: 727.5109677314758
Epoch: 1, Steps: 469 | Train Loss: 0.285 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (inf --> -0.924812).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0575292
	speed: 4.7868s/iter; left time: 64631.2471s
	iters: 200, epoch: 2 | loss: 0.0014150
	speed: 1.5301s/iter; left time: 20506.0782s
	iters: 300, epoch: 2 | loss: 0.2875234
	speed: 1.4280s/iter; left time: 18995.4062s
	iters: 400, epoch: 2 | loss: 0.0253798
	speed: 1.4427s/iter; left time: 19046.1045s
Epoch: 2 cost time: 694.9596879482269
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.952 Test Loss: 0.142 Test Acc: 0.952
Validation loss decreased (-0.924812 --> -0.951971).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0048969
	speed: 4.4980s/iter; left time: 58621.7860s
	iters: 200, epoch: 3 | loss: 0.3887652
	speed: 1.4790s/iter; left time: 19127.4701s
	iters: 300, epoch: 3 | loss: 0.0037764
	speed: 1.5283s/iter; left time: 19612.3736s
	iters: 400, epoch: 3 | loss: 0.0044821
	speed: 1.5833s/iter; left time: 20160.5673s
Epoch: 3 cost time: 718.9092733860016
Epoch: 3, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.951971 --> -0.961691).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0027042
	speed: 4.7628s/iter; left time: 59839.5356s
	iters: 200, epoch: 4 | loss: 0.0038208
	speed: 1.4855s/iter; left time: 18514.9627s
	iters: 300, epoch: 4 | loss: 0.0161204
	speed: 1.4329s/iter; left time: 17716.8689s
	iters: 400, epoch: 4 | loss: 0.2683853
	speed: 1.4424s/iter; left time: 17689.4314s
Epoch: 4 cost time: 690.7223815917969
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
Validation loss decreased (-0.961691 --> -0.966265).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0190187
	speed: 4.3124s/iter; left time: 52157.8761s
	iters: 200, epoch: 5 | loss: 0.0239735
	speed: 1.5191s/iter; left time: 18221.9949s
	iters: 300, epoch: 5 | loss: 0.0029891
	speed: 1.5437s/iter; left time: 18362.8089s
	iters: 400, epoch: 5 | loss: 0.0011477
	speed: 1.4082s/iter; left time: 16610.0235s
Epoch: 5 cost time: 682.9237253665924
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.966265 --> -0.977129).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018212
	speed: 4.0145s/iter; left time: 46672.8893s
	iters: 200, epoch: 6 | loss: 0.0010958
	speed: 1.5487s/iter; left time: 17850.1400s
	iters: 300, epoch: 6 | loss: 0.0519285
	speed: 1.5443s/iter; left time: 17644.6903s
	iters: 400, epoch: 6 | loss: 0.4337524
	speed: 1.5829s/iter; left time: 17928.4850s
Epoch: 6 cost time: 708.3002219200134
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0109186
	speed: 4.6172s/iter; left time: 51513.8771s
	iters: 200, epoch: 7 | loss: 0.0065539
	speed: 1.4303s/iter; left time: 15814.5013s
	iters: 300, epoch: 7 | loss: 0.0102453
	speed: 1.3062s/iter; left time: 14311.5498s
	iters: 400, epoch: 7 | loss: 0.0328405
	speed: 1.3916s/iter; left time: 15108.3767s
Epoch: 7 cost time: 657.5197694301605
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0003163
	speed: 4.3885s/iter; left time: 46903.9320s
	iters: 200, epoch: 8 | loss: 0.0004402
	speed: 1.4246s/iter; left time: 15083.2941s
	iters: 300, epoch: 8 | loss: 0.0003782
	speed: 1.3754s/iter; left time: 14425.2365s
	iters: 400, epoch: 8 | loss: 0.0159284
	speed: 1.3968s/iter; left time: 14510.1673s
Epoch: 8 cost time: 670.9384140968323
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001889
	speed: 4.1077s/iter; left time: 41976.5702s
	iters: 200, epoch: 9 | loss: 0.0110026
	speed: 1.2246s/iter; left time: 12391.3015s
	iters: 300, epoch: 9 | loss: 0.0006764
	speed: 1.2153s/iter; left time: 12176.2462s
	iters: 400, epoch: 9 | loss: 0.0015130
	speed: 1.4903s/iter; left time: 14782.7547s
Epoch: 9 cost time: 627.4140810966492
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0009829
	speed: 4.5062s/iter; left time: 43935.8596s
	iters: 200, epoch: 10 | loss: 0.0002408
	speed: 1.4284s/iter; left time: 13783.8258s
	iters: 300, epoch: 10 | loss: 0.0003714
	speed: 1.4672s/iter; left time: 14011.7289s
	iters: 400, epoch: 10 | loss: 0.1898421
	speed: 1.4968s/iter; left time: 14144.4165s
Epoch: 10 cost time: 682.7377469539642
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0005988
	speed: 4.4155s/iter; left time: 40980.7143s
	iters: 200, epoch: 11 | loss: 0.0005525
	speed: 1.5509s/iter; left time: 14238.6878s
	iters: 300, epoch: 11 | loss: 0.0008241
	speed: 1.5310s/iter; left time: 13902.7643s
	iters: 400, epoch: 11 | loss: 0.0212953
	speed: 1.5674s/iter; left time: 14076.7691s
Epoch: 11 cost time: 718.3032031059265
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0001354
	speed: 4.4321s/iter; left time: 39056.0567s
	iters: 200, epoch: 12 | loss: 0.0002783
	speed: 1.3583s/iter; left time: 11833.5252s
	iters: 300, epoch: 12 | loss: 0.0343967
	speed: 1.3527s/iter; left time: 11649.3215s
	iters: 400, epoch: 12 | loss: 0.0000643
	speed: 1.4155s/iter; left time: 12048.6342s
Epoch: 12 cost time: 636.4044699668884
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0033590
	speed: 4.0987s/iter; left time: 34195.1574s
	iters: 200, epoch: 13 | loss: 0.0618998
	speed: 1.4458s/iter; left time: 11918.0463s
	iters: 300, epoch: 13 | loss: 0.0001114
	speed: 1.5428s/iter; left time: 12563.0557s
	iters: 400, epoch: 13 | loss: 0.1621242
	speed: 1.5119s/iter; left time: 12159.9384s
Epoch: 13 cost time: 692.2396581172943
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0001997
	speed: 4.2778s/iter; left time: 33683.0047s
	iters: 200, epoch: 14 | loss: 0.0003622
	speed: 1.2979s/iter; left time: 10089.6619s
	iters: 300, epoch: 14 | loss: 0.0024192
	speed: 1.3667s/iter; left time: 10488.0503s
	iters: 400, epoch: 14 | loss: 0.0004560
	speed: 1.3438s/iter; left time: 10178.3158s
Epoch: 14 cost time: 629.9111130237579
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1962915
	speed: 4.1246s/iter; left time: 30542.3526s
	iters: 200, epoch: 15 | loss: 0.0004004
	speed: 1.3655s/iter; left time: 9975.3092s
	iters: 300, epoch: 15 | loss: 0.0001723
	speed: 1.2946s/iter; left time: 9327.3310s
	iters: 400, epoch: 15 | loss: 0.0003541
	speed: 1.2283s/iter; left time: 8727.0826s
Epoch: 15 cost time: 604.83935713768
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 74994186
model size : 288.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2230512
	speed: 0.5030s/iter; left time: 7027.4476s
	iters: 200, epoch: 1 | loss: 0.1030200
	speed: 0.4831s/iter; left time: 6701.0998s
	iters: 300, epoch: 1 | loss: 0.0796078
	speed: 0.4863s/iter; left time: 6697.2806s
	iters: 400, epoch: 1 | loss: 0.1965492
	speed: 0.4759s/iter; left time: 6505.9084s
Epoch: 1 cost time: 227.95738458633423
Epoch: 1, Steps: 469 | Train Loss: 0.302 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
Validation loss decreased (inf --> -0.953400).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2624471
	speed: 1.4990s/iter; left time: 20239.6004s
	iters: 200, epoch: 2 | loss: 0.1753932
	speed: 0.4385s/iter; left time: 5876.1077s
	iters: 300, epoch: 2 | loss: 0.0246471
	speed: 0.4482s/iter; left time: 5962.1272s
	iters: 400, epoch: 2 | loss: 0.0454185
	speed: 0.4495s/iter; left time: 5933.6958s
Epoch: 2 cost time: 206.8370771408081
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.953400 --> -0.959118).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5317278
	speed: 1.4709s/iter; left time: 19170.2143s
	iters: 200, epoch: 3 | loss: 0.0215854
	speed: 0.4349s/iter; left time: 5624.2845s
	iters: 300, epoch: 3 | loss: 0.0020802
	speed: 0.4376s/iter; left time: 5616.0167s
	iters: 400, epoch: 3 | loss: 0.0309211
	speed: 0.4433s/iter; left time: 5645.0957s
Epoch: 3 cost time: 205.90542340278625
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0005724
	speed: 1.4053s/iter; left time: 17656.4329s
	iters: 200, epoch: 4 | loss: 0.0274601
	speed: 0.4216s/iter; left time: 5254.9678s
	iters: 300, epoch: 4 | loss: 0.3121893
	speed: 0.4168s/iter; left time: 5153.3760s
	iters: 400, epoch: 4 | loss: 0.0394514
	speed: 0.4213s/iter; left time: 5166.2208s
Epoch: 4 cost time: 195.1855366230011
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3674604
	speed: 1.4852s/iter; left time: 17963.9275s
	iters: 200, epoch: 5 | loss: 0.0020650
	speed: 0.4397s/iter; left time: 5273.8546s
	iters: 300, epoch: 5 | loss: 0.0756446
	speed: 0.4378s/iter; left time: 5207.6845s
	iters: 400, epoch: 5 | loss: 0.0299906
	speed: 0.4052s/iter; left time: 4779.5047s
Epoch: 5 cost time: 200.1303586959839
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.959118 --> -0.959690).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0013247
	speed: 1.3982s/iter; left time: 16255.2946s
	iters: 200, epoch: 6 | loss: 0.0011226
	speed: 0.3460s/iter; left time: 3987.7375s
	iters: 300, epoch: 6 | loss: 0.1177917
	speed: 0.4355s/iter; left time: 4976.5199s
	iters: 400, epoch: 6 | loss: 0.0121316
	speed: 0.4415s/iter; left time: 5000.9771s
Epoch: 6 cost time: 193.29945278167725
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0004833
	speed: 1.4617s/iter; left time: 16307.6815s
	iters: 200, epoch: 7 | loss: 0.0020652
	speed: 0.4181s/iter; left time: 4623.1047s
	iters: 300, epoch: 7 | loss: 0.0037173
	speed: 0.4592s/iter; left time: 5031.8608s
	iters: 400, epoch: 7 | loss: 0.0066298
	speed: 0.4572s/iter; left time: 4963.6642s
Epoch: 7 cost time: 204.20904922485352
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.959690 --> -0.975128).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0250053
	speed: 1.4604s/iter; left time: 15608.5345s
	iters: 200, epoch: 8 | loss: 0.0000531
	speed: 0.3481s/iter; left time: 3686.0904s
	iters: 300, epoch: 8 | loss: 0.2557786
	speed: 0.3843s/iter; left time: 4030.9930s
	iters: 400, epoch: 8 | loss: 0.0026266
	speed: 0.3652s/iter; left time: 3793.2135s
Epoch: 8 cost time: 181.77840757369995
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.975128 --> -0.981417).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0001968
	speed: 1.4442s/iter; left time: 14757.8208s
	iters: 200, epoch: 9 | loss: 0.0001719
	speed: 0.4659s/iter; left time: 4714.7870s
	iters: 300, epoch: 9 | loss: 0.0002228
	speed: 0.4541s/iter; left time: 4549.4855s
	iters: 400, epoch: 9 | loss: 0.0000781
	speed: 0.4473s/iter; left time: 4436.5910s
Epoch: 9 cost time: 206.11377906799316
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000347
	speed: 1.3986s/iter; left time: 13636.4352s
	iters: 200, epoch: 10 | loss: 0.0007887
	speed: 0.4193s/iter; left time: 4046.2306s
	iters: 300, epoch: 10 | loss: 0.0002194
	speed: 0.4022s/iter; left time: 3841.1844s
	iters: 400, epoch: 10 | loss: 0.0007258
	speed: 0.4222s/iter; left time: 3989.9345s
Epoch: 10 cost time: 189.871723651886
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1574676
	speed: 1.2910s/iter; left time: 11982.0461s
	iters: 200, epoch: 11 | loss: 0.0001752
	speed: 0.3823s/iter; left time: 3509.7452s
	iters: 300, epoch: 11 | loss: 0.0001567
	speed: 0.3670s/iter; left time: 3332.4000s
	iters: 400, epoch: 11 | loss: 0.0000924
	speed: 0.3773s/iter; left time: 3388.2071s
Epoch: 11 cost time: 178.74246764183044
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0867317
	speed: 1.2757s/iter; left time: 11241.7895s
	iters: 200, epoch: 12 | loss: 0.0001875
	speed: 0.4376s/iter; left time: 3812.7530s
	iters: 300, epoch: 12 | loss: 0.0044983
	speed: 0.4319s/iter; left time: 3719.4628s
	iters: 400, epoch: 12 | loss: 0.0004702
	speed: 0.4413s/iter; left time: 3756.5372s
Epoch: 12 cost time: 198.24025893211365
Epoch: 12, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0032747
	speed: 1.5164s/iter; left time: 12651.2697s
	iters: 200, epoch: 13 | loss: 0.0001934
	speed: 0.4037s/iter; left time: 3327.9253s
	iters: 300, epoch: 13 | loss: 0.0005972
	speed: 0.3583s/iter; left time: 2918.0415s
	iters: 400, epoch: 13 | loss: 0.0026624
	speed: 0.3779s/iter; left time: 3039.3206s
Epoch: 13 cost time: 185.25436735153198
Epoch: 13, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0001869
	speed: 1.2527s/iter; left time: 9863.8432s
	iters: 200, epoch: 14 | loss: 0.0002811
	speed: 0.3868s/iter; left time: 3007.0252s
	iters: 300, epoch: 14 | loss: 0.0007601
	speed: 0.3919s/iter; left time: 3007.7109s
	iters: 400, epoch: 14 | loss: 0.4248685
	speed: 0.3877s/iter; left time: 2936.6443s
Epoch: 14 cost time: 175.85865473747253
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000941
	speed: 1.3146s/iter; left time: 9734.5949s
	iters: 200, epoch: 15 | loss: 0.0001770
	speed: 0.3545s/iter; left time: 2589.7657s
	iters: 300, epoch: 15 | loss: 0.0030259
	speed: 0.3639s/iter; left time: 2622.2040s
	iters: 400, epoch: 15 | loss: 0.0039581
	speed: 0.3688s/iter; left time: 2620.6636s
Epoch: 15 cost time: 173.5378179550171
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0003686
	speed: 1.1579s/iter; left time: 8031.5106s
	iters: 200, epoch: 16 | loss: 0.0018438
	speed: 0.3655s/iter; left time: 2498.3242s
	iters: 300, epoch: 16 | loss: 0.0024720
	speed: 0.3673s/iter; left time: 2474.3723s
	iters: 400, epoch: 16 | loss: 0.0003742
	speed: 0.3618s/iter; left time: 2401.0941s
Epoch: 16 cost time: 170.15627789497375
Epoch: 16, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000769
	speed: 1.2167s/iter; left time: 7868.4616s
	iters: 200, epoch: 17 | loss: 0.0000566
	speed: 0.4017s/iter; left time: 2557.8477s
	iters: 300, epoch: 17 | loss: 0.0001265
	speed: 0.4088s/iter; left time: 2562.1177s
	iters: 400, epoch: 17 | loss: 0.0017013
	speed: 0.4238s/iter; left time: 2613.7478s
Epoch: 17 cost time: 194.91337156295776
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0001388
	speed: 1.5212s/iter; left time: 9124.2973s
	iters: 200, epoch: 18 | loss: 0.0003389
	speed: 0.4353s/iter; left time: 2567.5578s
	iters: 300, epoch: 18 | loss: 0.1345522
	speed: 0.4366s/iter; left time: 2531.2769s
	iters: 400, epoch: 18 | loss: 0.0037673
	speed: 0.4132s/iter; left time: 2354.4749s
Epoch: 18 cost time: 200.93056106567383
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 22038026
model size : 86.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2008161
	speed: 0.8134s/iter; left time: 11364.5862s
	iters: 200, epoch: 1 | loss: 0.0618973
	speed: 0.8236s/iter; left time: 11424.8146s
	iters: 300, epoch: 1 | loss: 0.0612651
	speed: 0.8247s/iter; left time: 11356.4320s
	iters: 400, epoch: 1 | loss: 0.5484307
	speed: 0.7437s/iter; left time: 10167.1654s
Epoch: 1 cost time: 377.90988850593567
Epoch: 1, Steps: 469 | Train Loss: 0.296 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (inf --> -0.936533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0066266
	speed: 2.5766s/iter; left time: 34789.3149s
	iters: 200, epoch: 2 | loss: 0.0020722
	speed: 0.7985s/iter; left time: 10700.9984s
	iters: 300, epoch: 2 | loss: 0.0328789
	speed: 0.7440s/iter; left time: 9896.8035s
	iters: 400, epoch: 2 | loss: 0.0963935
	speed: 0.7939s/iter; left time: 10481.5251s
Epoch: 2 cost time: 379.3967626094818
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.936533 --> -0.965407).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0791610
	speed: 2.5744s/iter; left time: 33552.5197s
	iters: 200, epoch: 3 | loss: 0.0090400
	speed: 0.8038s/iter; left time: 10395.7646s
	iters: 300, epoch: 3 | loss: 0.0021380
	speed: 0.8059s/iter; left time: 10341.7287s
	iters: 400, epoch: 3 | loss: 0.0280835
	speed: 0.8619s/iter; left time: 10973.9479s
Epoch: 3 cost time: 382.0717144012451
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3509119
	speed: 2.2471s/iter; left time: 28232.1177s
	iters: 200, epoch: 4 | loss: 0.0691915
	speed: 0.7678s/iter; left time: 9569.9059s
	iters: 300, epoch: 4 | loss: 0.0073242
	speed: 0.8404s/iter; left time: 10390.6264s
	iters: 400, epoch: 4 | loss: 0.2108764
	speed: 0.8375s/iter; left time: 10271.5556s
Epoch: 4 cost time: 372.4452829360962
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.965407 --> -0.968838).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3861700
	speed: 2.4589s/iter; left time: 29739.8234s
	iters: 200, epoch: 5 | loss: 0.0149631
	speed: 0.7954s/iter; left time: 9540.8366s
	iters: 300, epoch: 5 | loss: 0.0028969
	speed: 0.8015s/iter; left time: 9533.5830s
	iters: 400, epoch: 5 | loss: 0.0120530
	speed: 0.7517s/iter; left time: 8866.2926s
Epoch: 5 cost time: 367.73328375816345
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.968838 --> -0.969696).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0007595
	speed: 2.4562s/iter; left time: 28555.7783s
	iters: 200, epoch: 6 | loss: 0.0012437
	speed: 0.7751s/iter; left time: 8934.0554s
	iters: 300, epoch: 6 | loss: 0.0002491
	speed: 0.7312s/iter; left time: 8354.4789s
	iters: 400, epoch: 6 | loss: 0.1320798
	speed: 0.7126s/iter; left time: 8070.8060s
Epoch: 6 cost time: 349.82366275787354
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0062992
	speed: 2.1020s/iter; left time: 23452.4305s
	iters: 200, epoch: 7 | loss: 0.0462412
	speed: 0.7219s/iter; left time: 7982.0331s
	iters: 300, epoch: 7 | loss: 0.0001608
	speed: 0.6532s/iter; left time: 7157.1716s
	iters: 400, epoch: 7 | loss: 0.0006984
	speed: 0.6750s/iter; left time: 7328.5681s
Epoch: 7 cost time: 315.33577513694763
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.971697).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001763
	speed: 2.1529s/iter; left time: 23009.8731s
	iters: 200, epoch: 8 | loss: 0.0006811
	speed: 0.7054s/iter; left time: 7468.3336s
	iters: 300, epoch: 8 | loss: 0.0010897
	speed: 0.6834s/iter; left time: 7167.1643s
	iters: 400, epoch: 8 | loss: 0.0016345
	speed: 0.6989s/iter; left time: 7260.5459s
Epoch: 8 cost time: 328.25568175315857
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0011702
	speed: 1.9698s/iter; left time: 20129.0048s
	iters: 200, epoch: 9 | loss: 0.0013740
	speed: 0.6836s/iter; left time: 6917.8312s
	iters: 300, epoch: 9 | loss: 0.0673872
	speed: 0.6533s/iter; left time: 6545.4957s
	iters: 400, epoch: 9 | loss: 0.0175294
	speed: 0.6584s/iter; left time: 6530.9026s
Epoch: 9 cost time: 308.782142162323
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0018097
	speed: 1.8491s/iter; left time: 18028.9797s
	iters: 200, epoch: 10 | loss: 0.0010233
	speed: 0.6870s/iter; left time: 6629.2521s
	iters: 300, epoch: 10 | loss: 0.0001743
	speed: 0.7119s/iter; left time: 6798.8304s
	iters: 400, epoch: 10 | loss: 0.0297443
	speed: 0.7335s/iter; left time: 6931.1089s
Epoch: 10 cost time: 327.69188618659973
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.971697 --> -0.974556).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001322
	speed: 2.1664s/iter; left time: 20106.5952s
	iters: 200, epoch: 11 | loss: 0.0002305
	speed: 0.7324s/iter; left time: 6723.9173s
	iters: 300, epoch: 11 | loss: 0.0010954
	speed: 0.7281s/iter; left time: 6612.3166s
	iters: 400, epoch: 11 | loss: 0.0016853
	speed: 0.6855s/iter; left time: 6156.2509s
Epoch: 11 cost time: 333.1589877605438
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.974556 --> -0.977701).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0007297
	speed: 2.0350s/iter; left time: 17932.6982s
	iters: 200, epoch: 12 | loss: 0.0008245
	speed: 0.7364s/iter; left time: 6415.9205s
	iters: 300, epoch: 12 | loss: 0.0155694
	speed: 0.7312s/iter; left time: 6296.8524s
	iters: 400, epoch: 12 | loss: 0.0001357
	speed: 0.6152s/iter; left time: 5236.4528s
Epoch: 12 cost time: 325.3461091518402
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.977701 --> -0.981131).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0021852
	speed: 1.9851s/iter; left time: 16561.7391s
	iters: 200, epoch: 13 | loss: 0.0000947
	speed: 0.7163s/iter; left time: 5904.0765s
	iters: 300, epoch: 13 | loss: 0.0000526
	speed: 0.7061s/iter; left time: 5749.5325s
	iters: 400, epoch: 13 | loss: 0.0027502
	speed: 0.6288s/iter; left time: 5057.4227s
Epoch: 13 cost time: 315.36667919158936
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002398
	speed: 1.8877s/iter; left time: 14863.4045s
	iters: 200, epoch: 14 | loss: 0.0001756
	speed: 0.7406s/iter; left time: 5757.2070s
	iters: 300, epoch: 14 | loss: 0.0012412
	speed: 0.7202s/iter; left time: 5526.9448s
	iters: 400, epoch: 14 | loss: 0.0003415
	speed: 0.6871s/iter; left time: 5204.2648s
Epoch: 14 cost time: 326.05402994155884
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1654138
	speed: 1.9726s/iter; left time: 14607.0942s
	iters: 200, epoch: 15 | loss: 0.0001000
	speed: 0.6707s/iter; left time: 4899.6111s
	iters: 300, epoch: 15 | loss: 0.0003961
	speed: 0.6604s/iter; left time: 4758.4763s
	iters: 400, epoch: 15 | loss: 0.0008413
	speed: 0.6676s/iter; left time: 4743.4234s
Epoch: 15 cost time: 316.0698857307434
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0842595
	speed: 2.0094s/iter; left time: 13937.3281s
	iters: 200, epoch: 16 | loss: 0.0000934
	speed: 0.6485s/iter; left time: 4433.2086s
	iters: 300, epoch: 16 | loss: 0.0099888
	speed: 0.6311s/iter; left time: 4251.3821s
	iters: 400, epoch: 16 | loss: 0.0001422
	speed: 0.5973s/iter; left time: 3963.7783s
Epoch: 16 cost time: 294.1028325557709
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0019647
	speed: 1.8973s/iter; left time: 12269.8908s
	iters: 200, epoch: 17 | loss: 0.0004301
	speed: 0.6297s/iter; left time: 4009.3208s
	iters: 300, epoch: 17 | loss: 0.0001249
	speed: 0.6093s/iter; left time: 3818.3349s
	iters: 400, epoch: 17 | loss: 0.0391188
	speed: 0.6675s/iter; left time: 4116.5957s
Epoch: 17 cost time: 297.7503900527954
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0147070
	speed: 1.9255s/iter; left time: 11548.9561s
	iters: 200, epoch: 18 | loss: 0.0000564
	speed: 0.6869s/iter; left time: 4051.1759s
	iters: 300, epoch: 18 | loss: 0.0001685
	speed: 0.8672s/iter; left time: 5027.8098s
	iters: 400, epoch: 18 | loss: 0.0006991
	speed: 0.8438s/iter; left time: 4807.7793s
Epoch: 18 cost time: 363.4262602329254
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4531789
	speed: 2.6183s/iter; left time: 14476.6888s
	iters: 200, epoch: 19 | loss: 0.0065503
	speed: 0.8547s/iter; left time: 4640.0682s
	iters: 300, epoch: 19 | loss: 0.0157185
	speed: 0.8521s/iter; left time: 4540.5760s
	iters: 400, epoch: 19 | loss: 0.0113753
	speed: 0.8306s/iter; left time: 4343.1746s
Epoch: 19 cost time: 393.69506764411926
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0001302
	speed: 2.4032s/iter; left time: 12160.3145s
	iters: 200, epoch: 20 | loss: 0.0002105
	speed: 0.7790s/iter; left time: 3863.9014s
	iters: 300, epoch: 20 | loss: 0.0001982
	speed: 0.8569s/iter; left time: 4164.5337s
	iters: 400, epoch: 20 | loss: 0.0008732
	speed: 0.8644s/iter; left time: 4114.7109s
Epoch: 20 cost time: 385.1643385887146
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000195
	speed: 2.6345s/iter; left time: 12095.1068s
	iters: 200, epoch: 21 | loss: 0.0089910
	speed: 0.8979s/iter; left time: 4032.6125s
	iters: 300, epoch: 21 | loss: 0.0001298
	speed: 0.9011s/iter; left time: 3956.7646s
	iters: 400, epoch: 21 | loss: 0.0050562
	speed: 0.8670s/iter; left time: 3720.3095s
Epoch: 21 cost time: 412.74918270111084
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0001411
	speed: 2.6850s/iter; left time: 11067.4373s
	iters: 200, epoch: 22 | loss: 0.0001554
	speed: 0.8239s/iter; left time: 3313.6882s
	iters: 300, epoch: 22 | loss: 0.1005404
	speed: 0.7934s/iter; left time: 3111.6131s
	iters: 400, epoch: 22 | loss: 0.0354287
	speed: 0.7533s/iter; left time: 2879.0739s
Epoch: 22 cost time: 370.3884029388428
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 74994186
model size : 288.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2406107
	speed: 0.3019s/iter; left time: 4217.4396s
	iters: 200, epoch: 1 | loss: 0.0656931
	speed: 0.2903s/iter; left time: 4026.8222s
	iters: 300, epoch: 1 | loss: 0.0817087
	speed: 0.2924s/iter; left time: 4026.3979s
	iters: 400, epoch: 1 | loss: 0.0599481
	speed: 0.2869s/iter; left time: 3922.7419s
Epoch: 1 cost time: 136.68190264701843
Epoch: 1, Steps: 469 | Train Loss: 0.316 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (inf --> -0.969124).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2318259
	speed: 0.9016s/iter; left time: 12173.0222s
	iters: 200, epoch: 2 | loss: 0.2935656
	speed: 0.2679s/iter; left time: 3589.8174s
	iters: 300, epoch: 2 | loss: 0.0526688
	speed: 0.2776s/iter; left time: 3693.0520s
	iters: 400, epoch: 2 | loss: 0.1025941
	speed: 0.2752s/iter; left time: 3632.7072s
Epoch: 2 cost time: 123.43319010734558
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2583475
	speed: 0.9691s/iter; left time: 12630.7411s
	iters: 200, epoch: 3 | loss: 0.2776802
	speed: 0.3066s/iter; left time: 3965.3111s
	iters: 300, epoch: 3 | loss: 0.0043054
	speed: 0.3090s/iter; left time: 3964.8641s
	iters: 400, epoch: 3 | loss: 0.0400894
	speed: 0.2725s/iter; left time: 3469.1776s
Epoch: 3 cost time: 135.75151443481445
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0009721
	speed: 1.0276s/iter; left time: 12910.7830s
	iters: 200, epoch: 4 | loss: 0.0314000
	speed: 0.2835s/iter; left time: 3533.1986s
	iters: 300, epoch: 4 | loss: 0.0008904
	speed: 0.2766s/iter; left time: 3419.3995s
	iters: 400, epoch: 4 | loss: 0.0616688
	speed: 0.2731s/iter; left time: 3349.8179s
Epoch: 4 cost time: 131.52123403549194
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.269 Vali Acc: 0.931 Test Loss: 0.269 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0339422
	speed: 0.9996s/iter; left time: 12090.4382s
	iters: 200, epoch: 5 | loss: 0.0125456
	speed: 0.3094s/iter; left time: 3711.3754s
	iters: 300, epoch: 5 | loss: 0.0033134
	speed: 0.3088s/iter; left time: 3672.6046s
	iters: 400, epoch: 5 | loss: 0.0029728
	speed: 0.3126s/iter; left time: 3686.5394s
Epoch: 5 cost time: 144.3789451122284
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0369713
	speed: 0.9767s/iter; left time: 11354.7204s
	iters: 200, epoch: 6 | loss: 0.0120766
	speed: 0.2495s/iter; left time: 2875.4642s
	iters: 300, epoch: 6 | loss: 0.0567283
	speed: 0.2459s/iter; left time: 2809.4516s
	iters: 400, epoch: 6 | loss: 0.1922350
	speed: 0.2462s/iter; left time: 2789.0038s
Epoch: 6 cost time: 116.86590385437012
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0003765
	speed: 0.8705s/iter; left time: 9712.6055s
	iters: 200, epoch: 7 | loss: 0.0327388
	speed: 0.2237s/iter; left time: 2472.9288s
	iters: 300, epoch: 7 | loss: 0.0014799
	speed: 0.2737s/iter; left time: 2999.0465s
	iters: 400, epoch: 7 | loss: 0.0039046
	speed: 0.2942s/iter; left time: 3194.0880s
Epoch: 7 cost time: 123.59113121032715
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.969124 --> -0.971983).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0096602
	speed: 1.0554s/iter; left time: 11279.7633s
	iters: 200, epoch: 8 | loss: 0.0002077
	speed: 0.2852s/iter; left time: 3019.3368s
	iters: 300, epoch: 8 | loss: 0.0038867
	speed: 0.2854s/iter; left time: 2992.9131s
	iters: 400, epoch: 8 | loss: 0.0004176
	speed: 0.2788s/iter; left time: 2895.9062s
Epoch: 8 cost time: 132.31628036499023
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0011407
	speed: 0.8826s/iter; left time: 9019.7138s
	iters: 200, epoch: 9 | loss: 0.0010405
	speed: 0.2301s/iter; left time: 2328.3691s
	iters: 300, epoch: 9 | loss: 0.0097257
	speed: 0.2234s/iter; left time: 2238.0792s
	iters: 400, epoch: 9 | loss: 0.0009711
	speed: 0.2354s/iter; left time: 2334.8566s
Epoch: 9 cost time: 107.88905692100525
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.976843).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000666
	speed: 0.9570s/iter; left time: 9330.2834s
	iters: 200, epoch: 10 | loss: 0.0004197
	speed: 0.2447s/iter; left time: 2361.7762s
	iters: 300, epoch: 10 | loss: 0.0000960
	speed: 0.2747s/iter; left time: 2622.9291s
	iters: 400, epoch: 10 | loss: 0.0029794
	speed: 0.2756s/iter; left time: 2604.7491s
Epoch: 10 cost time: 124.78261208534241
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0987514
	speed: 0.9156s/iter; left time: 8497.8331s
	iters: 200, epoch: 11 | loss: 0.0014724
	speed: 0.2584s/iter; left time: 2372.4331s
	iters: 300, epoch: 11 | loss: 0.0007571
	speed: 0.2528s/iter; left time: 2295.9214s
	iters: 400, epoch: 11 | loss: 0.0002843
	speed: 0.2664s/iter; left time: 2392.1220s
Epoch: 11 cost time: 122.49188876152039
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0041183
	speed: 0.8184s/iter; left time: 7211.7924s
	iters: 200, epoch: 12 | loss: 0.0009880
	speed: 0.2291s/iter; left time: 1995.6795s
	iters: 300, epoch: 12 | loss: 0.0013216
	speed: 0.2428s/iter; left time: 2091.1917s
	iters: 400, epoch: 12 | loss: 0.0001872
	speed: 0.2457s/iter; left time: 2091.7774s
Epoch: 12 cost time: 111.24447464942932
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1244294
	speed: 0.9261s/iter; left time: 7726.1512s
	iters: 200, epoch: 13 | loss: 0.0005747
	speed: 0.2963s/iter; left time: 2442.3352s
	iters: 300, epoch: 13 | loss: 0.0015104
	speed: 0.2803s/iter; left time: 2282.6596s
	iters: 400, epoch: 13 | loss: 0.0018959
	speed: 0.2691s/iter; left time: 2164.0734s
Epoch: 13 cost time: 132.78503680229187
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0001755
	speed: 0.9660s/iter; left time: 7606.6093s
	iters: 200, epoch: 14 | loss: 0.0013184
	speed: 0.2819s/iter; left time: 2191.1850s
	iters: 300, epoch: 14 | loss: 0.0001774
	speed: 0.2801s/iter; left time: 2149.2554s
	iters: 400, epoch: 14 | loss: 0.1689834
	speed: 0.2907s/iter; left time: 2201.4594s
Epoch: 14 cost time: 130.87069630622864
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0249043
	speed: 1.0253s/iter; left time: 7592.3282s
	iters: 200, epoch: 15 | loss: 0.0001343
	speed: 0.2907s/iter; left time: 2123.4630s
	iters: 300, epoch: 15 | loss: 0.0015292
	speed: 0.2883s/iter; left time: 2077.5320s
	iters: 400, epoch: 15 | loss: 0.0616663
	speed: 0.2836s/iter; left time: 2014.8768s
Epoch: 15 cost time: 134.76479697227478
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0010517
	speed: 0.8745s/iter; left time: 6065.3810s
	iters: 200, epoch: 16 | loss: 0.0015095
	speed: 0.2385s/iter; left time: 1630.2709s
	iters: 300, epoch: 16 | loss: 0.0033111
	speed: 0.2391s/iter; left time: 1610.8094s
	iters: 400, epoch: 16 | loss: 0.0006135
	speed: 0.2426s/iter; left time: 1609.9896s
Epoch: 16 cost time: 113.97764587402344
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0044436
	speed: 0.9919s/iter; left time: 6414.5122s
	iters: 200, epoch: 17 | loss: 0.0007968
	speed: 0.3624s/iter; left time: 2307.5961s
	iters: 300, epoch: 17 | loss: 0.0001416
	speed: 0.3587s/iter; left time: 2247.9355s
	iters: 400, epoch: 17 | loss: 0.0064870
	speed: 0.3710s/iter; left time: 2287.9837s
Epoch: 17 cost time: 167.54630088806152
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0003285
	speed: 1.3311s/iter; left time: 7983.7467s
	iters: 200, epoch: 18 | loss: 0.0040607
	speed: 0.3555s/iter; left time: 2096.9111s
	iters: 300, epoch: 18 | loss: 0.0005121
	speed: 0.3649s/iter; left time: 2115.8921s
	iters: 400, epoch: 18 | loss: 0.0002321
	speed: 0.3781s/iter; left time: 2154.5057s
Epoch: 18 cost time: 171.8685200214386
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977415).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0002153
	speed: 1.3504s/iter; left time: 7466.2353s
	iters: 200, epoch: 19 | loss: 0.1774992
	speed: 0.3642s/iter; left time: 1977.3871s
	iters: 300, epoch: 19 | loss: 0.0000623
	speed: 0.3275s/iter; left time: 1745.0081s
	iters: 400, epoch: 19 | loss: 0.0000761
	speed: 0.3724s/iter; left time: 1947.0799s
Epoch: 19 cost time: 166.36193895339966
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0120900
	speed: 1.2919s/iter; left time: 6537.2446s
	iters: 200, epoch: 20 | loss: 0.0070325
	speed: 0.3597s/iter; left time: 1784.0223s
	iters: 300, epoch: 20 | loss: 0.0000850
	speed: 0.3535s/iter; left time: 1717.8346s
	iters: 400, epoch: 20 | loss: 0.0000751
	speed: 0.3614s/iter; left time: 1720.1919s
Epoch: 20 cost time: 168.65856909751892
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0002374
	speed: 1.2944s/iter; left time: 5942.6333s
	iters: 200, epoch: 21 | loss: 0.0000414
	speed: 0.3725s/iter; left time: 1672.9921s
	iters: 300, epoch: 21 | loss: 0.0002057
	speed: 0.3787s/iter; left time: 1662.9510s
	iters: 400, epoch: 21 | loss: 0.0126164
	speed: 0.3747s/iter; left time: 1607.7598s
Epoch: 21 cost time: 176.3080973625183
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0332643
	speed: 1.2558s/iter; left time: 5176.4342s
	iters: 200, epoch: 22 | loss: 0.0011987
	speed: 0.2926s/iter; left time: 1176.7085s
	iters: 300, epoch: 22 | loss: 0.0000873
	speed: 0.3141s/iter; left time: 1231.8992s
	iters: 400, epoch: 22 | loss: 0.0000180
	speed: 0.3083s/iter; left time: 1178.3298s
Epoch: 22 cost time: 144.06451630592346
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002317
	speed: 1.1525s/iter; left time: 4210.1374s
	iters: 200, epoch: 23 | loss: 0.0008106
	speed: 0.3642s/iter; left time: 1293.8494s
	iters: 300, epoch: 23 | loss: 0.0017519
	speed: 0.3538s/iter; left time: 1221.5913s
	iters: 400, epoch: 23 | loss: 0.0011534
	speed: 0.3569s/iter; left time: 1196.6499s
Epoch: 23 cost time: 162.70298624038696
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.955 Test Loss: 0.220 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0042035
	speed: 1.2414s/iter; left time: 3952.7647s
	iters: 200, epoch: 24 | loss: 0.4222166
	speed: 0.3859s/iter; left time: 1190.1041s
	iters: 300, epoch: 24 | loss: 0.0007351
	speed: 0.3941s/iter; left time: 1176.1108s
	iters: 400, epoch: 24 | loss: 0.0004778
	speed: 0.3774s/iter; left time: 1088.3317s
Epoch: 24 cost time: 171.41420936584473
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0003166
	speed: 1.3216s/iter; left time: 3588.1370s
	iters: 200, epoch: 25 | loss: 0.0001817
	speed: 0.3497s/iter; left time: 914.4487s
	iters: 300, epoch: 25 | loss: 0.0006628
	speed: 0.3497s/iter; left time: 879.5201s
	iters: 400, epoch: 25 | loss: 0.0000653
	speed: 0.3537s/iter; left time: 854.2169s
Epoch: 25 cost time: 164.07742381095886
Epoch: 25, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000181
	speed: 1.2909s/iter; left time: 2899.4218s
	iters: 200, epoch: 26 | loss: 0.0005063
	speed: 0.3566s/iter; left time: 765.1713s
	iters: 300, epoch: 26 | loss: 0.0287195
	speed: 0.3594s/iter; left time: 735.4022s
	iters: 400, epoch: 26 | loss: 0.0005286
	speed: 0.3579s/iter; left time: 696.3925s
Epoch: 26 cost time: 169.40173840522766
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.978558 --> -0.983704).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0006120
	speed: 1.3288s/iter; left time: 2361.2155s
	iters: 200, epoch: 27 | loss: 0.0004432
	speed: 0.3684s/iter; left time: 617.8709s
	iters: 300, epoch: 27 | loss: 0.0047002
	speed: 0.3700s/iter; left time: 583.4491s
	iters: 400, epoch: 27 | loss: 0.2541392
	speed: 0.3424s/iter; left time: 505.6570s
Epoch: 27 cost time: 168.46691823005676
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0001753
	speed: 1.0852s/iter; left time: 1419.4020s
	iters: 200, epoch: 28 | loss: 0.0000877
	speed: 0.3165s/iter; left time: 382.3728s
	iters: 300, epoch: 28 | loss: 0.0004200
	speed: 0.3018s/iter; left time: 334.4451s
	iters: 400, epoch: 28 | loss: 0.0030330
	speed: 0.3300s/iter; left time: 332.6578s
Epoch: 28 cost time: 145.07837200164795
Epoch: 28, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0001889
	speed: 1.2168s/iter; left time: 1020.8956s
	iters: 200, epoch: 29 | loss: 0.0319590
	speed: 0.3414s/iter; left time: 252.2712s
	iters: 300, epoch: 29 | loss: 0.0000757
	speed: 0.3352s/iter; left time: 214.1784s
	iters: 400, epoch: 29 | loss: 0.0000255
	speed: 0.2989s/iter; left time: 161.1196s
Epoch: 29 cost time: 152.80182003974915
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000029
	speed: 1.0437s/iter; left time: 386.1611s
	iters: 200, epoch: 30 | loss: 0.0000806
	speed: 0.3132s/iter; left time: 84.5755s
	iters: 300, epoch: 30 | loss: 0.0039070
	speed: 0.3627s/iter; left time: 61.6670s
	iters: 400, epoch: 30 | loss: 0.0003057
	speed: 0.3528s/iter; left time: 24.6982s
Epoch: 30 cost time: 159.8225872516632
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 22038026
model size : 86.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2766925
	speed: 0.5745s/iter; left time: 8026.3097s
	iters: 200, epoch: 1 | loss: 0.0291717
	speed: 0.5743s/iter; left time: 7965.8051s
	iters: 300, epoch: 1 | loss: 0.0487178
	speed: 0.5247s/iter; left time: 7225.6945s
	iters: 400, epoch: 1 | loss: 0.4131613
	speed: 0.5311s/iter; left time: 7260.0237s
Epoch: 1 cost time: 257.5746822357178
Epoch: 1, Steps: 469 | Train Loss: 0.324 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (inf --> -0.947968).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0030553
	speed: 1.5009s/iter; left time: 20265.4235s
	iters: 200, epoch: 2 | loss: 0.0086744
	speed: 0.5205s/iter; left time: 6975.5834s
	iters: 300, epoch: 2 | loss: 0.0496559
	speed: 0.5244s/iter; left time: 6975.8166s
	iters: 400, epoch: 2 | loss: 0.6537211
	speed: 0.5353s/iter; left time: 7066.4335s
Epoch: 2 cost time: 244.6611247062683
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.947968 --> -0.959690).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0017211
	speed: 1.6076s/iter; left time: 20951.7187s
	iters: 200, epoch: 3 | loss: 0.2338036
	speed: 0.5158s/iter; left time: 6670.4793s
	iters: 300, epoch: 3 | loss: 0.0025941
	speed: 0.5223s/iter; left time: 6702.8583s
	iters: 400, epoch: 3 | loss: 0.2785326
	speed: 0.5582s/iter; left time: 7108.1283s
Epoch: 3 cost time: 249.68656206130981
Epoch: 3, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0119753
	speed: 1.6415s/iter; left time: 20623.2884s
	iters: 200, epoch: 4 | loss: 0.0025443
	speed: 0.5027s/iter; left time: 6266.0274s
	iters: 300, epoch: 4 | loss: 0.0064664
	speed: 0.5009s/iter; left time: 6193.0248s
	iters: 400, epoch: 4 | loss: 0.0081518
	speed: 0.5395s/iter; left time: 6616.9234s
Epoch: 4 cost time: 243.30145025253296
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.959690 --> -0.968552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0103781
	speed: 1.7495s/iter; left time: 21160.4690s
	iters: 200, epoch: 5 | loss: 0.6076567
	speed: 0.5454s/iter; left time: 6542.0779s
	iters: 300, epoch: 5 | loss: 0.0010474
	speed: 0.5398s/iter; left time: 6420.6563s
	iters: 400, epoch: 5 | loss: 0.0988707
	speed: 0.5028s/iter; left time: 5930.4239s
Epoch: 5 cost time: 247.53872179985046
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0007727
	speed: 1.5328s/iter; left time: 17820.4660s
	iters: 200, epoch: 6 | loss: 0.0002127
	speed: 0.5633s/iter; left time: 6492.7483s
	iters: 300, epoch: 6 | loss: 0.0088586
	speed: 0.5576s/iter; left time: 6371.6967s
	iters: 400, epoch: 6 | loss: 0.0073425
	speed: 0.5610s/iter; left time: 6353.7873s
Epoch: 6 cost time: 249.1852731704712
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0011470
	speed: 1.6683s/iter; left time: 18613.7413s
	iters: 200, epoch: 7 | loss: 0.0279767
	speed: 0.5223s/iter; left time: 5775.5646s
	iters: 300, epoch: 7 | loss: 0.0027224
	speed: 0.5068s/iter; left time: 5553.1210s
	iters: 400, epoch: 7 | loss: 0.0518512
	speed: 0.4984s/iter; left time: 5411.0444s
Epoch: 7 cost time: 240.17222023010254
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.968552 --> -0.976271).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0007174
	speed: 1.4679s/iter; left time: 15688.5824s
	iters: 200, epoch: 8 | loss: 0.0004012
	speed: 0.4724s/iter; left time: 5002.0007s
	iters: 300, epoch: 8 | loss: 0.0008264
	speed: 0.4731s/iter; left time: 4961.7836s
	iters: 400, epoch: 8 | loss: 0.0059525
	speed: 0.4597s/iter; left time: 4774.9294s
Epoch: 8 cost time: 217.55395793914795
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001176
	speed: 1.5837s/iter; left time: 16183.9651s
	iters: 200, epoch: 9 | loss: 0.0050153
	speed: 0.5445s/iter; left time: 5510.0259s
	iters: 300, epoch: 9 | loss: 0.0053380
	speed: 0.5375s/iter; left time: 5385.5647s
	iters: 400, epoch: 9 | loss: 0.0075893
	speed: 0.4962s/iter; left time: 4921.6381s
Epoch: 9 cost time: 245.90876126289368
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0386596
	speed: 1.4434s/iter; left time: 14073.3291s
	iters: 200, epoch: 10 | loss: 0.0003230
	speed: 0.4749s/iter; left time: 4582.5049s
	iters: 300, epoch: 10 | loss: 0.0000517
	speed: 0.4718s/iter; left time: 4506.0896s
	iters: 400, epoch: 10 | loss: 0.0343690
	speed: 0.4711s/iter; left time: 4451.4487s
Epoch: 10 cost time: 215.24046921730042
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0016603
	speed: 1.4389s/iter; left time: 13354.5842s
	iters: 200, epoch: 11 | loss: 0.0001461
	speed: 0.4755s/iter; left time: 4365.7680s
	iters: 300, epoch: 11 | loss: 0.0013508
	speed: 0.5040s/iter; left time: 4576.6314s
	iters: 400, epoch: 11 | loss: 0.0009533
	speed: 0.5283s/iter; left time: 4744.4416s
Epoch: 11 cost time: 236.24349665641785
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0009316
	speed: 1.6425s/iter; left time: 14473.5846s
	iters: 200, epoch: 12 | loss: 0.0002966
	speed: 0.4984s/iter; left time: 4341.8092s
	iters: 300, epoch: 12 | loss: 0.1316655
	speed: 0.5071s/iter; left time: 4367.5689s
	iters: 400, epoch: 12 | loss: 0.0002059
	speed: 0.5392s/iter; left time: 4589.6039s
Epoch: 12 cost time: 242.89448881149292
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.976271 --> -0.977701).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0007695
	speed: 1.7706s/iter; left time: 14771.7953s
	iters: 200, epoch: 13 | loss: 0.0001398
	speed: 0.5002s/iter; left time: 4123.5590s
	iters: 300, epoch: 13 | loss: 0.0001997
	speed: 0.4979s/iter; left time: 4054.5409s
	iters: 400, epoch: 13 | loss: 0.0279340
	speed: 0.5192s/iter; left time: 4175.9326s
Epoch: 13 cost time: 240.33632469177246
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0003698
	speed: 1.4850s/iter; left time: 11692.8543s
	iters: 200, epoch: 14 | loss: 0.0008037
	speed: 0.4816s/iter; left time: 3744.1143s
	iters: 300, epoch: 14 | loss: 0.0234460
	speed: 0.4442s/iter; left time: 3408.5736s
	iters: 400, epoch: 14 | loss: 0.0022392
	speed: 0.4626s/iter; left time: 3503.8452s
Epoch: 14 cost time: 220.19830703735352
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.978844).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0036855
	speed: 1.5240s/iter; left time: 11284.8956s
	iters: 200, epoch: 15 | loss: 0.0009845
	speed: 0.4892s/iter; left time: 3573.3966s
	iters: 300, epoch: 15 | loss: 0.9723540
	speed: 0.3981s/iter; left time: 2868.3247s
	iters: 400, epoch: 15 | loss: 0.4019448
	speed: 0.4873s/iter; left time: 3462.2133s
Epoch: 15 cost time: 219.24126291275024
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0014744
	speed: 1.6060s/iter; left time: 11138.9832s
	iters: 200, epoch: 16 | loss: 0.0172273
	speed: 0.5456s/iter; left time: 3729.8342s
	iters: 300, epoch: 16 | loss: 0.0002568
	speed: 0.5280s/iter; left time: 3556.8302s
	iters: 400, epoch: 16 | loss: 0.0050808
	speed: 0.5036s/iter; left time: 3341.6652s
Epoch: 16 cost time: 247.28309392929077
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1841787
	speed: 1.5644s/iter; left time: 10116.7426s
	iters: 200, epoch: 17 | loss: 0.0000798
	speed: 0.5132s/iter; left time: 3267.6521s
	iters: 300, epoch: 17 | loss: 0.0029209
	speed: 0.5338s/iter; left time: 3345.3794s
	iters: 400, epoch: 17 | loss: 0.0212505
	speed: 0.5160s/iter; left time: 3182.3177s
Epoch: 17 cost time: 244.07555437088013
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0006617
	speed: 1.4577s/iter; left time: 8743.2079s
	iters: 200, epoch: 18 | loss: 0.0001014
	speed: 0.4732s/iter; left time: 2791.1367s
	iters: 300, epoch: 18 | loss: 0.0001334
	speed: 0.4685s/iter; left time: 2716.5429s
	iters: 400, epoch: 18 | loss: 0.0010090
	speed: 0.4860s/iter; left time: 2769.4421s
Epoch: 18 cost time: 222.12144088745117
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0003241
	speed: 1.4128s/iter; left time: 7811.3708s
	iters: 200, epoch: 19 | loss: 0.0000785
	speed: 0.4721s/iter; left time: 2563.2931s
	iters: 300, epoch: 19 | loss: 0.0022036
	speed: 0.4744s/iter; left time: 2528.3151s
	iters: 400, epoch: 19 | loss: 0.0530800
	speed: 0.5138s/iter; left time: 2686.6987s
Epoch: 19 cost time: 222.6283254623413
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000641
	speed: 1.5465s/iter; left time: 7825.2482s
	iters: 200, epoch: 20 | loss: 0.0000516
	speed: 0.4740s/iter; left time: 2351.2310s
	iters: 300, epoch: 20 | loss: 0.0021158
	speed: 0.4831s/iter; left time: 2347.9072s
	iters: 400, epoch: 20 | loss: 0.0008466
	speed: 0.4888s/iter; left time: 2326.7904s
Epoch: 20 cost time: 225.52279686927795
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0008923
	speed: 1.4244s/iter; left time: 6539.3819s
	iters: 200, epoch: 21 | loss: 0.0031447
	speed: 0.4501s/iter; left time: 2021.5582s
	iters: 300, epoch: 21 | loss: 0.0024577
	speed: 0.4416s/iter; left time: 1938.9325s
	iters: 400, epoch: 21 | loss: 0.0060757
	speed: 0.4520s/iter; left time: 1939.7009s
Epoch: 21 cost time: 211.41834092140198
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0018522
	speed: 1.4559s/iter; left time: 6001.3993s
	iters: 200, epoch: 22 | loss: 0.0026642
	speed: 0.4919s/iter; left time: 1978.3693s
	iters: 300, epoch: 22 | loss: 0.0096701
	speed: 0.4792s/iter; left time: 1879.4685s
	iters: 400, epoch: 22 | loss: 0.0001061
	speed: 0.4721s/iter; left time: 1804.3007s
Epoch: 22 cost time: 227.07407474517822
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0006550
	speed: 1.5624s/iter; left time: 5707.4155s
	iters: 200, epoch: 23 | loss: 0.0000011
	speed: 0.4978s/iter; left time: 1768.6116s
	iters: 300, epoch: 23 | loss: 0.0001105
	speed: 0.4869s/iter; left time: 1681.2168s
	iters: 400, epoch: 23 | loss: 0.0039788
	speed: 0.4791s/iter; left time: 1606.4880s
Epoch: 23 cost time: 229.39339208602905
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0001235
	speed: 1.3594s/iter; left time: 4328.3463s
	iters: 200, epoch: 24 | loss: 0.0002754
	speed: 0.4669s/iter; left time: 1440.0693s
	iters: 300, epoch: 24 | loss: 0.0000897
	speed: 0.4703s/iter; left time: 1403.3918s
	iters: 400, epoch: 24 | loss: 0.0001061
	speed: 0.4076s/iter; left time: 1175.5306s
Epoch: 24 cost time: 211.33273100852966
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 74994186
model size : 288.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3545730
	speed: 0.1884s/iter; left time: 2631.6124s
	iters: 200, epoch: 1 | loss: 0.1506818
	speed: 0.1873s/iter; left time: 2597.5761s
	iters: 300, epoch: 1 | loss: 0.0814421
	speed: 0.1898s/iter; left time: 2613.3708s
	iters: 400, epoch: 1 | loss: 0.0609288
	speed: 0.1850s/iter; left time: 2529.2634s
Epoch: 1 cost time: 88.26336526870728
Epoch: 1, Steps: 469 | Train Loss: 0.347 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (inf --> -0.967409).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2560020
	speed: 0.7364s/iter; left time: 9943.1817s
	iters: 200, epoch: 2 | loss: 0.1485562
	speed: 0.1686s/iter; left time: 2259.3764s
	iters: 300, epoch: 2 | loss: 0.0280030
	speed: 0.1733s/iter; left time: 2304.9586s
	iters: 400, epoch: 2 | loss: 0.1461492
	speed: 0.1748s/iter; left time: 2307.0569s
Epoch: 2 cost time: 80.45708703994751
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0131631
	speed: 0.6760s/iter; left time: 8810.0536s
	iters: 200, epoch: 3 | loss: 0.0163974
	speed: 0.1215s/iter; left time: 1571.7182s
	iters: 300, epoch: 3 | loss: 0.0031657
	speed: 0.1692s/iter; left time: 2171.8374s
	iters: 400, epoch: 3 | loss: 0.0108483
	speed: 0.1755s/iter; left time: 2234.3714s
Epoch: 3 cost time: 74.65113282203674
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0174676
	speed: 0.7215s/iter; left time: 9064.4007s
	iters: 200, epoch: 4 | loss: 0.0141373
	speed: 0.1817s/iter; left time: 2264.7963s
	iters: 300, epoch: 4 | loss: 0.0130393
	speed: 0.1809s/iter; left time: 2236.7928s
	iters: 400, epoch: 4 | loss: 0.0129139
	speed: 0.1728s/iter; left time: 2119.1589s
Epoch: 4 cost time: 80.12341284751892
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.355 Vali Acc: 0.888 Test Loss: 0.355 Test Acc: 0.888
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0045033
	speed: 0.6146s/iter; left time: 7433.7105s
	iters: 200, epoch: 5 | loss: 0.0012260
	speed: 0.1754s/iter; left time: 2104.3288s
	iters: 300, epoch: 5 | loss: 0.0780246
	speed: 0.1783s/iter; left time: 2120.8750s
	iters: 400, epoch: 5 | loss: 0.0017073
	speed: 0.1729s/iter; left time: 2039.1285s
Epoch: 5 cost time: 82.75777769088745
Epoch: 5, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.953 Test Loss: 0.141 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0010738
	speed: 0.7147s/iter; left time: 8308.8402s
	iters: 200, epoch: 6 | loss: 0.0071320
	speed: 0.1847s/iter; left time: 2128.6965s
	iters: 300, epoch: 6 | loss: 0.0442003
	speed: 0.1918s/iter; left time: 2191.6617s
	iters: 400, epoch: 6 | loss: 0.0015048
	speed: 0.1511s/iter; left time: 1711.8718s
Epoch: 6 cost time: 80.39906001091003
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0002312
	speed: 0.6431s/iter; left time: 7175.5506s
	iters: 200, epoch: 7 | loss: 0.0021305
	speed: 0.1659s/iter; left time: 1833.9329s
	iters: 300, epoch: 7 | loss: 0.0102451
	speed: 0.1528s/iter; left time: 1674.0909s
	iters: 400, epoch: 7 | loss: 0.0006798
	speed: 0.1577s/iter; left time: 1712.6619s
Epoch: 7 cost time: 75.0635757446289
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0784381
	speed: 0.5616s/iter; left time: 6001.9950s
	iters: 200, epoch: 8 | loss: 0.0623796
	speed: 0.1679s/iter; left time: 1777.6604s
	iters: 300, epoch: 8 | loss: 0.0260245
	speed: 0.1791s/iter; left time: 1878.8955s
	iters: 400, epoch: 8 | loss: 0.0841868
	speed: 0.1708s/iter; left time: 1773.9764s
Epoch: 8 cost time: 77.22639846801758
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.967409 --> -0.970553).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0037903
	speed: 0.7209s/iter; left time: 7366.9064s
	iters: 200, epoch: 9 | loss: 0.0004492
	speed: 0.1788s/iter; left time: 1809.1242s
	iters: 300, epoch: 9 | loss: 0.0001149
	speed: 0.1849s/iter; left time: 1852.4226s
	iters: 400, epoch: 9 | loss: 0.0244273
	speed: 0.1796s/iter; left time: 1781.8959s
Epoch: 9 cost time: 85.71984934806824
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003997
	speed: 0.6969s/iter; left time: 6794.5073s
	iters: 200, epoch: 10 | loss: 0.0004798
	speed: 0.1253s/iter; left time: 1208.9974s
	iters: 300, epoch: 10 | loss: 0.0022286
	speed: 0.1375s/iter; left time: 1313.4385s
	iters: 400, epoch: 10 | loss: 0.1008743
	speed: 0.1569s/iter; left time: 1482.4176s
Epoch: 10 cost time: 68.78396773338318
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.970553 --> -0.973126).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4212512
	speed: 0.6364s/iter; left time: 5906.6037s
	iters: 200, epoch: 11 | loss: 0.0012906
	speed: 0.1733s/iter; left time: 1590.7442s
	iters: 300, epoch: 11 | loss: 0.0003800
	speed: 0.1737s/iter; left time: 1577.7557s
	iters: 400, epoch: 11 | loss: 0.0006268
	speed: 0.1687s/iter; left time: 1515.0547s
Epoch: 11 cost time: 81.04090309143066
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.973126 --> -0.978558).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0203733
	speed: 0.6457s/iter; left time: 5689.4823s
	iters: 200, epoch: 12 | loss: 0.0019084
	speed: 0.1779s/iter; left time: 1549.9009s
	iters: 300, epoch: 12 | loss: 0.0012375
	speed: 0.1683s/iter; left time: 1449.0406s
	iters: 400, epoch: 12 | loss: 0.0009079
	speed: 0.1782s/iter; left time: 1516.7276s
Epoch: 12 cost time: 82.82570385932922
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0011460
	speed: 0.7164s/iter; left time: 5976.8618s
	iters: 200, epoch: 13 | loss: 0.0068704
	speed: 0.1789s/iter; left time: 1474.4013s
	iters: 300, epoch: 13 | loss: 0.0044290
	speed: 0.1714s/iter; left time: 1396.0630s
	iters: 400, epoch: 13 | loss: 0.0005480
	speed: 0.1736s/iter; left time: 1396.5529s
Epoch: 13 cost time: 79.92765474319458
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0009787
	speed: 0.5912s/iter; left time: 4655.3837s
	iters: 200, epoch: 14 | loss: 0.0044343
	speed: 0.1622s/iter; left time: 1260.6108s
	iters: 300, epoch: 14 | loss: 0.0011032
	speed: 0.1521s/iter; left time: 1166.9478s
	iters: 400, epoch: 14 | loss: 0.0004042
	speed: 0.1555s/iter; left time: 1177.5399s
Epoch: 14 cost time: 74.52581858634949
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0004287
	speed: 0.6089s/iter; left time: 4509.1258s
	iters: 200, epoch: 15 | loss: 0.0007561
	speed: 0.1240s/iter; left time: 906.0416s
	iters: 300, epoch: 15 | loss: 0.1043581
	speed: 0.1413s/iter; left time: 1017.8312s
	iters: 400, epoch: 15 | loss: 0.0329602
	speed: 0.1598s/iter; left time: 1135.6015s
Epoch: 15 cost time: 67.19694352149963
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0006113
	speed: 0.6381s/iter; left time: 4426.1974s
	iters: 200, epoch: 16 | loss: 0.0012977
	speed: 0.1555s/iter; left time: 1062.9944s
	iters: 300, epoch: 16 | loss: 0.0002811
	speed: 0.1583s/iter; left time: 1066.1761s
	iters: 400, epoch: 16 | loss: 0.0036423
	speed: 0.1529s/iter; left time: 1014.3142s
Epoch: 16 cost time: 73.96506190299988
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0001300
	speed: 0.5291s/iter; left time: 3421.8584s
	iters: 200, epoch: 17 | loss: 0.0000747
	speed: 0.1485s/iter; left time: 945.6320s
	iters: 300, epoch: 17 | loss: 0.0217176
	speed: 0.1467s/iter; left time: 919.5312s
	iters: 400, epoch: 17 | loss: 0.0000860
	speed: 0.1398s/iter; left time: 862.3278s
Epoch: 17 cost time: 68.3727240562439
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001146
	speed: 0.5932s/iter; left time: 3557.9877s
	iters: 200, epoch: 18 | loss: 0.0019033
	speed: 0.1494s/iter; left time: 881.1158s
	iters: 300, epoch: 18 | loss: 0.0002877
	speed: 0.1481s/iter; left time: 858.5688s
	iters: 400, epoch: 18 | loss: 0.0048983
	speed: 0.1463s/iter; left time: 833.4788s
Epoch: 18 cost time: 68.63137984275818
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000413
	speed: 0.6454s/iter; left time: 3568.5657s
	iters: 200, epoch: 19 | loss: 0.0138033
	speed: 0.1821s/iter; left time: 988.4853s
	iters: 300, epoch: 19 | loss: 0.0245818
	speed: 0.1873s/iter; left time: 998.3475s
	iters: 400, epoch: 19 | loss: 0.1245323
	speed: 0.1844s/iter; left time: 964.4820s
Epoch: 19 cost time: 87.30081033706665
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0018045
	speed: 0.7343s/iter; left time: 3715.4609s
	iters: 200, epoch: 20 | loss: 0.0121003
	speed: 0.1790s/iter; left time: 887.6103s
	iters: 300, epoch: 20 | loss: 0.0008414
	speed: 0.1799s/iter; left time: 874.3206s
	iters: 400, epoch: 20 | loss: 0.0001029
	speed: 0.1776s/iter; left time: 845.1756s
Epoch: 20 cost time: 83.53225302696228
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0962982
	speed: 0.7235s/iter; left time: 3321.7120s
	iters: 200, epoch: 21 | loss: 0.0005785
	speed: 0.1752s/iter; left time: 786.9321s
	iters: 300, epoch: 21 | loss: 0.0004598
	speed: 0.1252s/iter; left time: 549.8785s
	iters: 400, epoch: 21 | loss: 0.0109847
	speed: 0.1367s/iter; left time: 586.3909s
Epoch: 21 cost time: 73.56323862075806
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 22038026
model size : 86.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2340995
	speed: 0.6344s/iter; left time: 8862.9985s
	iters: 200, epoch: 1 | loss: 0.0452375
	speed: 0.6073s/iter; left time: 8424.3083s
	iters: 300, epoch: 1 | loss: 0.3624700
	speed: 0.5785s/iter; left time: 7966.3954s
	iters: 400, epoch: 1 | loss: 0.0267431
	speed: 0.6783s/iter; left time: 9273.5219s
Epoch: 1 cost time: 297.91074109077454
Epoch: 1, Steps: 469 | Train Loss: 0.332 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (inf --> -0.962549).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0169646
	speed: 2.1099s/iter; left time: 28487.6715s
	iters: 200, epoch: 2 | loss: 0.0067493
	speed: 0.7371s/iter; left time: 9878.2316s
	iters: 300, epoch: 2 | loss: 0.0266569
	speed: 0.8265s/iter; left time: 10994.7680s
	iters: 400, epoch: 2 | loss: 0.0010593
	speed: 0.8090s/iter; left time: 10680.6287s
Epoch: 2 cost time: 348.1625859737396
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.962549 --> -0.964550).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0074859
	speed: 2.6088s/iter; left time: 34001.0261s
	iters: 200, epoch: 3 | loss: 0.4045707
	speed: 0.7458s/iter; left time: 9645.8789s
	iters: 300, epoch: 3 | loss: 0.0172658
	speed: 0.7674s/iter; left time: 9848.6161s
	iters: 400, epoch: 3 | loss: 0.0473815
	speed: 0.6723s/iter; left time: 8560.4813s
Epoch: 3 cost time: 347.5092513561249
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0034397
	speed: 2.2906s/iter; left time: 28779.4789s
	iters: 200, epoch: 4 | loss: 0.0121048
	speed: 0.6473s/iter; left time: 8068.2772s
	iters: 300, epoch: 4 | loss: 0.0007628
	speed: 0.6885s/iter; left time: 8513.1192s
	iters: 400, epoch: 4 | loss: 0.0010838
	speed: 0.7123s/iter; left time: 8735.9264s
Epoch: 4 cost time: 336.3266022205353
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0363640
	speed: 2.3073s/iter; left time: 27906.2896s
	iters: 200, epoch: 5 | loss: 0.0013771
	speed: 0.6029s/iter; left time: 7231.8926s
	iters: 300, epoch: 5 | loss: 0.1417218
	speed: 0.6050s/iter; left time: 7196.3965s
	iters: 400, epoch: 5 | loss: 0.0636808
	speed: 0.6810s/iter; left time: 8032.4548s
Epoch: 5 cost time: 300.5634274482727
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0354851
	speed: 2.0962s/iter; left time: 24370.2414s
	iters: 200, epoch: 6 | loss: 0.0003009
	speed: 0.5502s/iter; left time: 6341.5130s
	iters: 300, epoch: 6 | loss: 0.0007799
	speed: 0.5979s/iter; left time: 6831.0441s
	iters: 400, epoch: 6 | loss: 0.0021589
	speed: 0.6372s/iter; left time: 7216.9344s
Epoch: 6 cost time: 291.45084953308105
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.964550 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0011641
	speed: 2.2538s/iter; left time: 25146.1780s
	iters: 200, epoch: 7 | loss: 0.0033023
	speed: 0.7369s/iter; left time: 8148.2481s
	iters: 300, epoch: 7 | loss: 0.0004819
	speed: 0.7077s/iter; left time: 7754.6457s
	iters: 400, epoch: 7 | loss: 0.0042690
	speed: 0.5945s/iter; left time: 6454.2978s
Epoch: 7 cost time: 313.51111125946045
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0008262
	speed: 2.0409s/iter; left time: 21813.0187s
	iters: 200, epoch: 8 | loss: 0.2928771
	speed: 0.6876s/iter; left time: 7280.4616s
	iters: 300, epoch: 8 | loss: 0.0025428
	speed: 0.6253s/iter; left time: 6558.3311s
	iters: 400, epoch: 8 | loss: 0.0075699
	speed: 0.6580s/iter; left time: 6834.8189s
Epoch: 8 cost time: 303.57958030700684
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0022706
	speed: 1.8818s/iter; left time: 19229.9404s
	iters: 200, epoch: 9 | loss: 0.0044802
	speed: 0.5903s/iter; left time: 5972.8520s
	iters: 300, epoch: 9 | loss: 0.0001373
	speed: 0.6729s/iter; left time: 6741.5353s
	iters: 400, epoch: 9 | loss: 0.0001962
	speed: 0.6691s/iter; left time: 6637.2163s
Epoch: 9 cost time: 298.16186809539795
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
Validation loss decreased (-0.973412 --> -0.981703).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000998
	speed: 2.1722s/iter; left time: 21179.1868s
	iters: 200, epoch: 10 | loss: 0.0001621
	speed: 0.6864s/iter; left time: 6623.7055s
	iters: 300, epoch: 10 | loss: 0.0113046
	speed: 0.6763s/iter; left time: 6458.8163s
	iters: 400, epoch: 10 | loss: 0.0001813
	speed: 0.7657s/iter; left time: 7235.4832s
Epoch: 10 cost time: 336.12818121910095
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001732
	speed: 2.1837s/iter; left time: 20267.3312s
	iters: 200, epoch: 11 | loss: 0.0002588
	speed: 0.6153s/iter; left time: 5649.4460s
	iters: 300, epoch: 11 | loss: 0.0002951
	speed: 0.6328s/iter; left time: 5746.4867s
	iters: 400, epoch: 11 | loss: 0.0002883
	speed: 0.7026s/iter; left time: 6309.9865s
Epoch: 11 cost time: 302.3900158405304
Epoch: 11, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0001732
	speed: 2.1186s/iter; left time: 18669.0518s
	iters: 200, epoch: 12 | loss: 0.0006758
	speed: 0.6209s/iter; left time: 5409.3181s
	iters: 300, epoch: 12 | loss: 0.0094625
	speed: 0.6621s/iter; left time: 5701.9290s
	iters: 400, epoch: 12 | loss: 0.0004995
	speed: 0.6625s/iter; left time: 5639.1724s
Epoch: 12 cost time: 301.27346086502075
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0104758
	speed: 1.9545s/iter; left time: 16306.7094s
	iters: 200, epoch: 13 | loss: 0.0002963
	speed: 0.5816s/iter; left time: 4794.4730s
	iters: 300, epoch: 13 | loss: 0.0004671
	speed: 0.6051s/iter; left time: 4927.5616s
	iters: 400, epoch: 13 | loss: 0.0029687
	speed: 0.5576s/iter; left time: 4484.7568s
Epoch: 13 cost time: 284.86280369758606
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0024405
	speed: 2.0824s/iter; left time: 16396.7336s
	iters: 200, epoch: 14 | loss: 0.0026286
	speed: 0.6417s/iter; left time: 4988.6085s
	iters: 300, epoch: 14 | loss: 0.0004418
	speed: 0.5349s/iter; left time: 4104.8199s
	iters: 400, epoch: 14 | loss: 0.0012242
	speed: 0.5480s/iter; left time: 4150.6379s
Epoch: 14 cost time: 277.9343659877777
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0002053
	speed: 1.9208s/iter; left time: 14223.7386s
	iters: 200, epoch: 15 | loss: 0.0011848
	speed: 0.6457s/iter; left time: 4716.6952s
	iters: 300, epoch: 15 | loss: 0.0002521
	speed: 0.5605s/iter; left time: 4038.3716s
	iters: 400, epoch: 15 | loss: 0.0228119
	speed: 0.5654s/iter; left time: 4017.3068s
Epoch: 15 cost time: 267.47171902656555
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0012888
	speed: 1.7161s/iter; left time: 11902.5904s
	iters: 200, epoch: 16 | loss: 0.0039303
	speed: 0.5688s/iter; left time: 3888.2281s
	iters: 300, epoch: 16 | loss: 0.0003397
	speed: 0.5896s/iter; left time: 3971.3346s
	iters: 400, epoch: 16 | loss: 0.0003414
	speed: 0.6116s/iter; left time: 4058.3509s
Epoch: 16 cost time: 280.92214727401733
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0053958
	speed: 1.8920s/iter; left time: 12235.5916s
	iters: 200, epoch: 17 | loss: 0.0000569
	speed: 0.5776s/iter; left time: 3677.3874s
	iters: 300, epoch: 17 | loss: 0.0006914
	speed: 0.5629s/iter; left time: 3527.5593s
	iters: 400, epoch: 17 | loss: 0.0002630
	speed: 0.6089s/iter; left time: 3755.3891s
Epoch: 17 cost time: 271.0781948566437
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0014288
	speed: 1.8055s/iter; left time: 10829.5296s
	iters: 200, epoch: 18 | loss: 0.0012078
	speed: 0.5713s/iter; left time: 3369.4759s
	iters: 300, epoch: 18 | loss: 0.0292036
	speed: 0.6567s/iter; left time: 3807.4647s
	iters: 400, epoch: 18 | loss: 0.0002313
	speed: 0.6264s/iter; left time: 3569.2931s
Epoch: 18 cost time: 283.9071352481842
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000964
	speed: 1.8891s/iter; left time: 10445.0477s
	iters: 200, epoch: 19 | loss: 0.0006571
	speed: 0.6337s/iter; left time: 3440.5888s
	iters: 300, epoch: 19 | loss: 0.0017876
	speed: 0.6422s/iter; left time: 3422.3959s
	iters: 400, epoch: 19 | loss: 0.0000316
	speed: 0.6025s/iter; left time: 3150.4239s
Epoch: 19 cost time: 292.4372134208679
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 37504522
model size : 145.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4862663
	speed: 0.2407s/iter; left time: 3362.7645s
	iters: 200, epoch: 1 | loss: 0.1611057
	speed: 0.1859s/iter; left time: 2578.0592s
	iters: 300, epoch: 1 | loss: 0.0312751
	speed: 0.1950s/iter; left time: 2685.0420s
	iters: 400, epoch: 1 | loss: 0.0297943
	speed: 0.1967s/iter; left time: 2689.5970s
Epoch: 1 cost time: 95.07957148551941
Epoch: 1, Steps: 469 | Train Loss: 0.331 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (inf --> -0.968552).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0441476
	speed: 0.7085s/iter; left time: 9566.2755s
	iters: 200, epoch: 2 | loss: 0.6146557
	speed: 0.1965s/iter; left time: 2633.6486s
	iters: 300, epoch: 2 | loss: 0.0339812
	speed: 0.2038s/iter; left time: 2711.4310s
	iters: 400, epoch: 2 | loss: 0.0626138
	speed: 0.1535s/iter; left time: 2026.7990s
Epoch: 2 cost time: 86.75870323181152
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0184070
	speed: 0.7254s/iter; left time: 9454.3218s
	iters: 200, epoch: 3 | loss: 0.0014041
	speed: 0.1955s/iter; left time: 2528.5945s
	iters: 300, epoch: 3 | loss: 0.0977929
	speed: 0.1991s/iter; left time: 2554.9220s
	iters: 400, epoch: 3 | loss: 0.0198862
	speed: 0.1949s/iter; left time: 2482.1709s
Epoch: 3 cost time: 91.62359595298767
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0431170
	speed: 0.7942s/iter; left time: 9978.3448s
	iters: 200, epoch: 4 | loss: 0.0144266
	speed: 0.2344s/iter; left time: 2921.3815s
	iters: 300, epoch: 4 | loss: 0.0311782
	speed: 0.2321s/iter; left time: 2869.4992s
	iters: 400, epoch: 4 | loss: 0.3930674
	speed: 0.2290s/iter; left time: 2808.6802s
Epoch: 4 cost time: 109.78383111953735
Epoch: 4, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0131078
	speed: 0.7815s/iter; left time: 9451.8675s
	iters: 200, epoch: 5 | loss: 0.0032341
	speed: 0.1843s/iter; left time: 2210.1139s
	iters: 300, epoch: 5 | loss: 0.1298848
	speed: 0.1862s/iter; left time: 2215.2789s
	iters: 400, epoch: 5 | loss: 0.0409491
	speed: 0.2070s/iter; left time: 2441.4175s
Epoch: 5 cost time: 93.01678800582886
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.238 Vali Acc: 0.945 Test Loss: 0.238 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0380312
	speed: 0.7603s/iter; left time: 8838.9883s
	iters: 200, epoch: 6 | loss: 0.2997301
	speed: 0.2177s/iter; left time: 2509.1161s
	iters: 300, epoch: 6 | loss: 0.0002055
	speed: 0.2193s/iter; left time: 2505.7584s
	iters: 400, epoch: 6 | loss: 0.0075230
	speed: 0.1982s/iter; left time: 2245.0420s
Epoch: 6 cost time: 100.30277109146118
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0009471
	speed: 0.7173s/iter; left time: 8003.3966s
	iters: 200, epoch: 7 | loss: 0.0087705
	speed: 0.1868s/iter; left time: 2065.7079s
	iters: 300, epoch: 7 | loss: 0.0001809
	speed: 0.1862s/iter; left time: 2040.1471s
	iters: 400, epoch: 7 | loss: 0.0868810
	speed: 0.1889s/iter; left time: 2050.6030s
Epoch: 7 cost time: 87.88190603256226
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.974270).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0066899
	speed: 0.6723s/iter; left time: 7185.6665s
	iters: 200, epoch: 8 | loss: 0.2438557
	speed: 0.1991s/iter; left time: 2108.1005s
	iters: 300, epoch: 8 | loss: 0.0071167
	speed: 0.2013s/iter; left time: 2111.1972s
	iters: 400, epoch: 8 | loss: 0.0287817
	speed: 0.1917s/iter; left time: 1991.8945s
Epoch: 8 cost time: 90.3522436618805
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0120379
	speed: 0.6905s/iter; left time: 7055.8083s
	iters: 200, epoch: 9 | loss: 0.0045409
	speed: 0.1771s/iter; left time: 1792.4867s
	iters: 300, epoch: 9 | loss: 0.1242327
	speed: 0.1870s/iter; left time: 1873.3390s
	iters: 400, epoch: 9 | loss: 0.0021386
	speed: 0.2113s/iter; left time: 2096.2750s
Epoch: 9 cost time: 89.57735633850098
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.974270 --> -0.977986).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0055507
	speed: 0.7135s/iter; left time: 6956.7777s
	iters: 200, epoch: 10 | loss: 0.0003223
	speed: 0.1671s/iter; left time: 1612.1778s
	iters: 300, epoch: 10 | loss: 0.0101737
	speed: 0.1725s/iter; left time: 1647.5229s
	iters: 400, epoch: 10 | loss: 0.0334709
	speed: 0.1698s/iter; left time: 1604.6520s
Epoch: 10 cost time: 82.00873637199402
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.977986 --> -0.980274).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0131589
	speed: 0.6570s/iter; left time: 6097.8834s
	iters: 200, epoch: 11 | loss: 0.0004932
	speed: 0.2006s/iter; left time: 1841.6635s
	iters: 300, epoch: 11 | loss: 0.0007880
	speed: 0.1993s/iter; left time: 1809.7125s
	iters: 400, epoch: 11 | loss: 0.0002696
	speed: 0.1959s/iter; left time: 1759.2478s
Epoch: 11 cost time: 91.58909296989441
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0086801
	speed: 0.7484s/iter; left time: 6595.0015s
	iters: 200, epoch: 12 | loss: 0.0000587
	speed: 0.2030s/iter; left time: 1768.9331s
	iters: 300, epoch: 12 | loss: 0.0053432
	speed: 0.1847s/iter; left time: 1591.0308s
	iters: 400, epoch: 12 | loss: 0.0009767
	speed: 0.1871s/iter; left time: 1592.3893s
Epoch: 12 cost time: 91.23060750961304
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0021378
	speed: 0.6556s/iter; left time: 5469.5870s
	iters: 200, epoch: 13 | loss: 0.0003948
	speed: 0.1775s/iter; left time: 1463.0111s
	iters: 300, epoch: 13 | loss: 0.0000727
	speed: 0.1878s/iter; left time: 1529.1766s
	iters: 400, epoch: 13 | loss: 0.0000478
	speed: 0.1735s/iter; left time: 1395.4773s
Epoch: 13 cost time: 83.53744006156921
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001762
	speed: 0.6766s/iter; left time: 5327.8098s
	iters: 200, epoch: 14 | loss: 0.0015046
	speed: 0.1730s/iter; left time: 1344.7193s
	iters: 300, epoch: 14 | loss: 0.0001706
	speed: 0.2015s/iter; left time: 1546.5265s
	iters: 400, epoch: 14 | loss: 0.0008439
	speed: 0.2115s/iter; left time: 1602.0860s
Epoch: 14 cost time: 92.45612406730652
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002237
	speed: 0.7636s/iter; left time: 5654.4804s
	iters: 200, epoch: 15 | loss: 0.0000467
	speed: 0.1981s/iter; left time: 1446.7918s
	iters: 300, epoch: 15 | loss: 0.0009029
	speed: 0.1767s/iter; left time: 1273.1917s
	iters: 400, epoch: 15 | loss: 0.0003773
	speed: 0.1816s/iter; left time: 1290.5275s
Epoch: 15 cost time: 88.0371036529541
Epoch: 15, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0001805
	speed: 0.6393s/iter; left time: 4434.0459s
	iters: 200, epoch: 16 | loss: 0.0001707
	speed: 0.1726s/iter; left time: 1179.7659s
	iters: 300, epoch: 16 | loss: 0.0019355
	speed: 0.1809s/iter; left time: 1218.2175s
	iters: 400, epoch: 16 | loss: 0.0003533
	speed: 0.2065s/iter; left time: 1370.3747s
Epoch: 16 cost time: 88.77954411506653
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001112
	speed: 0.7286s/iter; left time: 4712.0841s
	iters: 200, epoch: 17 | loss: 0.0000935
	speed: 0.1800s/iter; left time: 1145.7642s
	iters: 300, epoch: 17 | loss: 0.0000187
	speed: 0.1891s/iter; left time: 1185.0921s
	iters: 400, epoch: 17 | loss: 0.0027292
	speed: 0.1840s/iter; left time: 1135.0349s
Epoch: 17 cost time: 88.5470826625824
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0014441
	speed: 0.6324s/iter; left time: 3793.2588s
	iters: 200, epoch: 18 | loss: 0.0069620
	speed: 0.1672s/iter; left time: 986.2651s
	iters: 300, epoch: 18 | loss: 0.0007719
	speed: 0.1669s/iter; left time: 967.4178s
	iters: 400, epoch: 18 | loss: 0.0000915
	speed: 0.1757s/iter; left time: 1001.3331s
Epoch: 18 cost time: 79.68756580352783
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000731
	speed: 0.5926s/iter; left time: 3276.2165s
	iters: 200, epoch: 19 | loss: 0.0002385
	speed: 0.1836s/iter; left time: 996.7293s
	iters: 300, epoch: 19 | loss: 0.0000221
	speed: 0.1733s/iter; left time: 923.3317s
	iters: 400, epoch: 19 | loss: 0.0039398
	speed: 0.2247s/iter; left time: 1175.0357s
Epoch: 19 cost time: 88.88796281814575
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0064216
	speed: 1.0242s/iter; left time: 5182.2606s
	iters: 200, epoch: 20 | loss: 0.0564842
	speed: 0.2827s/iter; left time: 1401.9668s
	iters: 300, epoch: 20 | loss: 0.0009855
	speed: 0.2917s/iter; left time: 1417.8847s
	iters: 400, epoch: 20 | loss: 0.0018530
	speed: 0.2734s/iter; left time: 1301.1780s
Epoch: 20 cost time: 132.021879196167
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 11025930
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2257797
	speed: 0.5346s/iter; left time: 7469.4717s
	iters: 200, epoch: 1 | loss: 0.0899557
	speed: 0.5305s/iter; left time: 7357.9283s
	iters: 300, epoch: 1 | loss: 0.3147020
	speed: 0.5276s/iter; left time: 7266.0134s
	iters: 400, epoch: 1 | loss: 0.0343590
	speed: 0.5439s/iter; left time: 7435.4746s
Epoch: 1 cost time: 251.16691327095032
Epoch: 1, Steps: 469 | Train Loss: 0.342 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (inf --> -0.944252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0174262
	speed: 1.7749s/iter; left time: 23964.6028s
	iters: 200, epoch: 2 | loss: 0.0485328
	speed: 0.5113s/iter; left time: 6852.4342s
	iters: 300, epoch: 2 | loss: 0.0186975
	speed: 0.4884s/iter; left time: 6496.6016s
	iters: 400, epoch: 2 | loss: 0.0033101
	speed: 0.3943s/iter; left time: 5205.7466s
Epoch: 2 cost time: 225.4903702735901
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.201 Vali Acc: 0.940 Test Loss: 0.201 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0262487
	speed: 1.6231s/iter; left time: 21154.3265s
	iters: 200, epoch: 3 | loss: 0.3280249
	speed: 0.4884s/iter; left time: 6316.3504s
	iters: 300, epoch: 3 | loss: 0.0023148
	speed: 0.4041s/iter; left time: 5185.5981s
	iters: 400, epoch: 3 | loss: 0.0039993
	speed: 0.5064s/iter; left time: 6447.7403s
Epoch: 3 cost time: 227.09002137184143
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.944252 --> -0.964550).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0019689
	speed: 1.6760s/iter; left time: 21057.1925s
	iters: 200, epoch: 4 | loss: 0.0008316
	speed: 0.4941s/iter; left time: 6158.6506s
	iters: 300, epoch: 4 | loss: 0.0091439
	speed: 0.4878s/iter; left time: 6030.6831s
	iters: 400, epoch: 4 | loss: 0.1460235
	speed: 0.5177s/iter; left time: 6349.4158s
Epoch: 4 cost time: 235.1529197692871
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0078006
	speed: 1.7084s/iter; left time: 20663.5415s
	iters: 200, epoch: 5 | loss: 0.0043574
	speed: 0.5524s/iter; left time: 6626.6119s
	iters: 300, epoch: 5 | loss: 0.0068979
	speed: 0.4619s/iter; left time: 5494.5160s
	iters: 400, epoch: 5 | loss: 0.0104118
	speed: 0.4437s/iter; left time: 5233.1677s
Epoch: 5 cost time: 227.67380595207214
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0214296
	speed: 1.4964s/iter; left time: 17396.6276s
	iters: 200, epoch: 6 | loss: 0.0023614
	speed: 0.4242s/iter; left time: 4889.9000s
	iters: 300, epoch: 6 | loss: 0.0003597
	speed: 0.5155s/iter; left time: 5889.6822s
	iters: 400, epoch: 6 | loss: 0.0000569
	speed: 0.5000s/iter; left time: 5662.6377s
Epoch: 6 cost time: 224.47063374519348
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.964550 --> -0.966551).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0013922
	speed: 1.6181s/iter; left time: 18053.5018s
	iters: 200, epoch: 7 | loss: 0.0003521
	speed: 0.4911s/iter; left time: 5430.3133s
	iters: 300, epoch: 7 | loss: 0.0005062
	speed: 0.4913s/iter; left time: 5382.8940s
	iters: 400, epoch: 7 | loss: 0.0854984
	speed: 0.4731s/iter; left time: 5136.3537s
Epoch: 7 cost time: 221.88518691062927
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0047228
	speed: 1.4707s/iter; left time: 15718.3362s
	iters: 200, epoch: 8 | loss: 0.0033109
	speed: 0.4809s/iter; left time: 5091.9202s
	iters: 300, epoch: 8 | loss: 0.0029312
	speed: 0.4069s/iter; left time: 4267.4202s
	iters: 400, epoch: 8 | loss: 0.0059145
	speed: 0.4787s/iter; left time: 4972.9451s
Epoch: 8 cost time: 216.75273156166077
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4896388
	speed: 1.5495s/iter; left time: 15834.0758s
	iters: 200, epoch: 9 | loss: 0.0044946
	speed: 0.5119s/iter; left time: 5180.0141s
	iters: 300, epoch: 9 | loss: 0.0003393
	speed: 0.5046s/iter; left time: 5055.4824s
	iters: 400, epoch: 9 | loss: 0.0034317
	speed: 0.5102s/iter; left time: 5060.6281s
Epoch: 9 cost time: 226.49025201797485
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.966551 --> -0.975699).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001302
	speed: 1.4364s/iter; left time: 14004.9907s
	iters: 200, epoch: 10 | loss: 0.0004719
	speed: 0.4273s/iter; left time: 4123.4673s
	iters: 300, epoch: 10 | loss: 0.0001614
	speed: 0.3962s/iter; left time: 3783.6238s
	iters: 400, epoch: 10 | loss: 0.0004078
	speed: 0.4239s/iter; left time: 4005.5932s
Epoch: 10 cost time: 202.02418494224548
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0012458
	speed: 1.6435s/iter; left time: 15253.5793s
	iters: 200, epoch: 11 | loss: 0.0002273
	speed: 0.4962s/iter; left time: 4555.2135s
	iters: 300, epoch: 11 | loss: 0.0129731
	speed: 0.4991s/iter; left time: 4532.3683s
	iters: 400, epoch: 11 | loss: 0.1484158
	speed: 0.4223s/iter; left time: 3792.6175s
Epoch: 11 cost time: 221.1381447315216
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.957 Test Loss: 0.231 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0003778
	speed: 1.3997s/iter; left time: 12334.3695s
	iters: 200, epoch: 12 | loss: 0.0004718
	speed: 0.3704s/iter; left time: 3226.7691s
	iters: 300, epoch: 12 | loss: 0.0067059
	speed: 0.4168s/iter; left time: 3589.3231s
	iters: 400, epoch: 12 | loss: 0.0012245
	speed: 0.4549s/iter; left time: 3871.9524s
Epoch: 12 cost time: 197.58147835731506
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.975699 --> -0.980845).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0109709
	speed: 1.5249s/iter; left time: 12721.8472s
	iters: 200, epoch: 13 | loss: 0.0001345
	speed: 0.3781s/iter; left time: 3116.7389s
	iters: 300, epoch: 13 | loss: 0.0420375
	speed: 0.3901s/iter; left time: 3176.3235s
	iters: 400, epoch: 13 | loss: 0.0017885
	speed: 0.3767s/iter; left time: 3030.1444s
Epoch: 13 cost time: 185.25845289230347
Epoch: 13, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.418 Vali Acc: 0.937 Test Loss: 0.418 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0031714
	speed: 1.3932s/iter; left time: 10969.9040s
	iters: 200, epoch: 14 | loss: 0.0017941
	speed: 0.4980s/iter; left time: 3871.6575s
	iters: 300, epoch: 14 | loss: 0.0005155
	speed: 0.4989s/iter; left time: 3828.8915s
	iters: 400, epoch: 14 | loss: 0.0003773
	speed: 0.4985s/iter; left time: 3775.8452s
Epoch: 14 cost time: 233.07493019104004
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0005057
	speed: 1.5814s/iter; left time: 11710.4952s
	iters: 200, epoch: 15 | loss: 0.0002567
	speed: 0.4681s/iter; left time: 3419.2627s
	iters: 300, epoch: 15 | loss: 0.0002511
	speed: 0.3778s/iter; left time: 2721.7075s
	iters: 400, epoch: 15 | loss: 0.0021166
	speed: 0.4276s/iter; left time: 3038.4038s
Epoch: 15 cost time: 204.53315687179565
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0092090
	speed: 1.2512s/iter; left time: 8678.1305s
	iters: 200, epoch: 16 | loss: 0.0017194
	speed: 0.4599s/iter; left time: 3143.7572s
	iters: 300, epoch: 16 | loss: 0.0019939
	speed: 0.4444s/iter; left time: 2993.7773s
	iters: 400, epoch: 16 | loss: 0.0000956
	speed: 0.4320s/iter; left time: 2866.5805s
Epoch: 16 cost time: 200.34485483169556
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0003361
	speed: 1.5201s/iter; left time: 9830.3253s
	iters: 200, epoch: 17 | loss: 0.0021200
	speed: 0.4303s/iter; left time: 2739.5359s
	iters: 300, epoch: 17 | loss: 0.0023088
	speed: 0.3218s/iter; left time: 2016.5202s
	iters: 400, epoch: 17 | loss: 0.0007548
	speed: 0.3880s/iter; left time: 2392.7580s
Epoch: 17 cost time: 190.99141788482666
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0001688
	speed: 1.2929s/iter; left time: 7754.6520s
	iters: 200, epoch: 18 | loss: 0.0003756
	speed: 0.3888s/iter; left time: 2293.4368s
	iters: 300, epoch: 18 | loss: 0.0003295
	speed: 0.4326s/iter; left time: 2508.3100s
	iters: 400, epoch: 18 | loss: 0.0006941
	speed: 0.4291s/iter; left time: 2444.9976s
Epoch: 18 cost time: 187.0653314590454
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0005506
	speed: 1.2560s/iter; left time: 6944.6171s
	iters: 200, epoch: 19 | loss: 0.0012229
	speed: 0.3982s/iter; left time: 2161.7743s
	iters: 300, epoch: 19 | loss: 0.0001102
	speed: 0.3895s/iter; left time: 2075.7912s
	iters: 400, epoch: 19 | loss: 0.0000392
	speed: 0.3123s/iter; left time: 1632.9723s
Epoch: 19 cost time: 168.4196925163269
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0043342
	speed: 1.3736s/iter; left time: 6950.5610s
	iters: 200, epoch: 20 | loss: 0.0001906
	speed: 0.4219s/iter; left time: 2092.4189s
	iters: 300, epoch: 20 | loss: 0.0003026
	speed: 0.4086s/iter; left time: 1985.8743s
	iters: 400, epoch: 20 | loss: 0.0050921
	speed: 0.4334s/iter; left time: 2063.0270s
Epoch: 20 cost time: 194.83330702781677
Epoch: 20, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0003342
	speed: 1.2054s/iter; left time: 5534.0595s
	iters: 200, epoch: 21 | loss: 0.0002652
	speed: 0.3655s/iter; left time: 1641.5861s
	iters: 300, epoch: 21 | loss: 0.0003159
	speed: 0.3692s/iter; left time: 1621.1901s
	iters: 400, epoch: 21 | loss: 0.0037193
	speed: 0.4189s/iter; left time: 1797.5157s
Epoch: 21 cost time: 178.17214107513428
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0002324
	speed: 1.2974s/iter; left time: 5348.0814s
	iters: 200, epoch: 22 | loss: 0.0002176
	speed: 0.4164s/iter; left time: 1674.6352s
	iters: 300, epoch: 22 | loss: 0.0002529
	speed: 0.2852s/iter; left time: 1118.6690s
	iters: 400, epoch: 22 | loss: 0.1335232
	speed: 0.3309s/iter; left time: 1264.6408s
Epoch: 22 cost time: 170.05104875564575
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 37504522
model size : 145.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4998206
	speed: 0.1540s/iter; left time: 2150.9884s
	iters: 200, epoch: 1 | loss: 0.1719641
	speed: 0.1443s/iter; left time: 2001.4109s
	iters: 300, epoch: 1 | loss: 0.0463769
	speed: 0.1528s/iter; left time: 2104.4470s
	iters: 400, epoch: 1 | loss: 0.0320772
	speed: 0.1489s/iter; left time: 2036.1465s
Epoch: 1 cost time: 70.99108457565308
Epoch: 1, Steps: 469 | Train Loss: 0.340 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (inf --> -0.970839).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0386449
	speed: 0.5540s/iter; left time: 7480.5747s
	iters: 200, epoch: 2 | loss: 0.4415715
	speed: 0.1256s/iter; left time: 1683.0915s
	iters: 300, epoch: 2 | loss: 0.0031219
	speed: 0.1028s/iter; left time: 1367.9069s
	iters: 400, epoch: 2 | loss: 0.0125224
	speed: 0.0990s/iter; left time: 1306.5014s
Epoch: 2 cost time: 55.52175855636597
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.970839 --> -0.974270).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0147094
	speed: 0.5356s/iter; left time: 6980.6349s
	iters: 200, epoch: 3 | loss: 0.2902750
	speed: 0.1170s/iter; left time: 1512.6663s
	iters: 300, epoch: 3 | loss: 0.1838580
	speed: 0.1216s/iter; left time: 1560.5802s
	iters: 400, epoch: 3 | loss: 0.0104450
	speed: 0.1112s/iter; left time: 1416.5260s
Epoch: 3 cost time: 57.0745108127594
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2402494
	speed: 0.4887s/iter; left time: 6139.8405s
	iters: 200, epoch: 4 | loss: 0.0006747
	speed: 0.1634s/iter; left time: 2036.2041s
	iters: 300, epoch: 4 | loss: 0.0853870
	speed: 0.1598s/iter; left time: 1976.1660s
	iters: 400, epoch: 4 | loss: 0.5232509
	speed: 0.1503s/iter; left time: 1842.6863s
Epoch: 4 cost time: 73.93818974494934
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0012124
	speed: 0.5354s/iter; left time: 6475.4027s
	iters: 200, epoch: 5 | loss: 0.0015949
	speed: 0.1355s/iter; left time: 1624.8769s
	iters: 300, epoch: 5 | loss: 0.4916546
	speed: 0.1642s/iter; left time: 1953.4334s
	iters: 400, epoch: 5 | loss: 0.0011443
	speed: 0.1584s/iter; left time: 1868.1081s
Epoch: 5 cost time: 71.16889643669128
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0093596
	speed: 0.4601s/iter; left time: 5349.0893s
	iters: 200, epoch: 6 | loss: 0.1610755
	speed: 0.1137s/iter; left time: 1310.1470s
	iters: 300, epoch: 6 | loss: 0.2416586
	speed: 0.1141s/iter; left time: 1304.1062s
	iters: 400, epoch: 6 | loss: 0.0040759
	speed: 0.1213s/iter; left time: 1373.4122s
Epoch: 6 cost time: 57.08849287033081
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.974270 --> -0.978272).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0015805
	speed: 0.5471s/iter; left time: 6103.6818s
	iters: 200, epoch: 7 | loss: 0.0022736
	speed: 0.1122s/iter; left time: 1240.5999s
	iters: 300, epoch: 7 | loss: 0.0040584
	speed: 0.1013s/iter; left time: 1110.0556s
	iters: 400, epoch: 7 | loss: 0.0056694
	speed: 0.1195s/iter; left time: 1297.5275s
Epoch: 7 cost time: 55.59512233734131
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0115384
	speed: 0.5724s/iter; left time: 6117.3442s
	iters: 200, epoch: 8 | loss: 0.0062215
	speed: 0.1540s/iter; left time: 1630.4283s
	iters: 300, epoch: 8 | loss: 0.0690306
	speed: 0.1410s/iter; left time: 1479.0727s
	iters: 400, epoch: 8 | loss: 0.0005522
	speed: 0.1354s/iter; left time: 1406.5454s
Epoch: 8 cost time: 67.92166423797607
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.978272 --> -0.982847).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0205223
	speed: 0.4732s/iter; left time: 4835.1413s
	iters: 200, epoch: 9 | loss: 0.0088940
	speed: 0.1272s/iter; left time: 1287.5045s
	iters: 300, epoch: 9 | loss: 0.0153819
	speed: 0.1366s/iter; left time: 1368.5793s
	iters: 400, epoch: 9 | loss: 0.0027269
	speed: 0.1346s/iter; left time: 1335.1509s
Epoch: 9 cost time: 59.596137046813965
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0341001
	speed: 0.4463s/iter; left time: 4351.8652s
	iters: 200, epoch: 10 | loss: 0.0003958
	speed: 0.1158s/iter; left time: 1117.2583s
	iters: 300, epoch: 10 | loss: 0.0002533
	speed: 0.1258s/iter; left time: 1201.2218s
	iters: 400, epoch: 10 | loss: 0.0185619
	speed: 0.1203s/iter; left time: 1136.5427s
Epoch: 10 cost time: 56.231645822525024
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0071758
	speed: 0.4891s/iter; left time: 4539.2697s
	iters: 200, epoch: 11 | loss: 0.0002399
	speed: 0.1235s/iter; left time: 1134.0843s
	iters: 300, epoch: 11 | loss: 0.0003408
	speed: 0.1186s/iter; left time: 1077.3750s
	iters: 400, epoch: 11 | loss: 0.0223161
	speed: 0.1197s/iter; left time: 1075.3613s
Epoch: 11 cost time: 58.33759117126465
Epoch: 11, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0712737
	speed: 0.4993s/iter; left time: 4399.4239s
	iters: 200, epoch: 12 | loss: 0.0000690
	speed: 0.1054s/iter; left time: 917.9968s
	iters: 300, epoch: 12 | loss: 0.0024863
	speed: 0.1091s/iter; left time: 939.4819s
	iters: 400, epoch: 12 | loss: 0.0003265
	speed: 0.0964s/iter; left time: 820.7236s
Epoch: 12 cost time: 49.482226610183716
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0001595
	speed: 0.4695s/iter; left time: 3916.9510s
	iters: 200, epoch: 13 | loss: 0.0005574
	speed: 0.1257s/iter; left time: 1035.9718s
	iters: 300, epoch: 13 | loss: 0.0003541
	speed: 0.0995s/iter; left time: 810.2682s
	iters: 400, epoch: 13 | loss: 0.0014252
	speed: 0.1200s/iter; left time: 964.9033s
Epoch: 13 cost time: 58.146828413009644
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0017854
	speed: 0.5538s/iter; left time: 4360.9012s
	iters: 200, epoch: 14 | loss: 0.0000545
	speed: 0.1568s/iter; left time: 1218.7623s
	iters: 300, epoch: 14 | loss: 0.0009970
	speed: 0.1635s/iter; left time: 1254.4664s
	iters: 400, epoch: 14 | loss: 0.3171428
	speed: 0.1662s/iter; left time: 1258.7834s
Epoch: 14 cost time: 74.56127190589905
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0004980
	speed: 0.5200s/iter; left time: 3850.9387s
	iters: 200, epoch: 15 | loss: 0.0000600
	speed: 0.1474s/iter; left time: 1076.7993s
	iters: 300, epoch: 15 | loss: 0.0050930
	speed: 0.1142s/iter; left time: 822.6176s
	iters: 400, epoch: 15 | loss: 0.0000366
	speed: 0.1230s/iter; left time: 873.9891s
Epoch: 15 cost time: 62.19062852859497
Epoch: 15, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0005678
	speed: 0.4768s/iter; left time: 3307.2386s
	iters: 200, epoch: 16 | loss: 0.0003197
	speed: 0.1177s/iter; left time: 804.6756s
	iters: 300, epoch: 16 | loss: 0.0003832
	speed: 0.1193s/iter; left time: 803.6572s
	iters: 400, epoch: 16 | loss: 0.0001003
	speed: 0.1341s/iter; left time: 889.9388s
Epoch: 16 cost time: 58.600826025009155
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000415
	speed: 0.4864s/iter; left time: 3145.4877s
	iters: 200, epoch: 17 | loss: 0.0002527
	speed: 0.1289s/iter; left time: 820.7697s
	iters: 300, epoch: 17 | loss: 0.0003058
	speed: 0.1323s/iter; left time: 829.0294s
	iters: 400, epoch: 17 | loss: 0.0019182
	speed: 0.1322s/iter; left time: 815.0522s
Epoch: 17 cost time: 60.83110284805298
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0002614
	speed: 0.5618s/iter; left time: 3369.5273s
	iters: 200, epoch: 18 | loss: 0.0009632
	speed: 0.1313s/iter; left time: 774.2865s
	iters: 300, epoch: 18 | loss: 0.0251786
	speed: 0.1275s/iter; left time: 738.9893s
	iters: 400, epoch: 18 | loss: 0.0003874
	speed: 0.1048s/iter; left time: 597.1287s
Epoch: 18 cost time: 57.86229586601257
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 11025930
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3084399
	speed: 0.2016s/iter; left time: 2817.0245s
	iters: 200, epoch: 1 | loss: 0.1847581
	speed: 0.1831s/iter; left time: 2539.6012s
	iters: 300, epoch: 1 | loss: 0.2952374
	speed: 0.1607s/iter; left time: 2212.6708s
	iters: 400, epoch: 1 | loss: 0.0472113
	speed: 0.1886s/iter; left time: 2578.2451s
Epoch: 1 cost time: 89.21093511581421
Epoch: 1, Steps: 469 | Train Loss: 0.366 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
Validation loss decreased (inf --> -0.950827).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0101883
	speed: 0.7328s/iter; left time: 9894.2712s
	iters: 200, epoch: 2 | loss: 0.0164167
	speed: 0.1888s/iter; left time: 2530.3930s
	iters: 300, epoch: 2 | loss: 0.1845648
	speed: 0.2006s/iter; left time: 2668.2069s
	iters: 400, epoch: 2 | loss: 0.1342177
	speed: 0.1899s/iter; left time: 2507.1148s
Epoch: 2 cost time: 90.5923285484314
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.950827 --> -0.971125).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0163324
	speed: 0.6249s/iter; left time: 8144.0319s
	iters: 200, epoch: 3 | loss: 0.2026412
	speed: 0.1709s/iter; left time: 2210.1481s
	iters: 300, epoch: 3 | loss: 0.0104305
	speed: 0.1748s/iter; left time: 2243.7103s
	iters: 400, epoch: 3 | loss: 0.0076613
	speed: 0.2306s/iter; left time: 2936.0694s
Epoch: 3 cost time: 90.26876544952393
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0005916
	speed: 0.7096s/iter; left time: 8915.4607s
	iters: 200, epoch: 4 | loss: 0.3526081
	speed: 0.2302s/iter; left time: 2868.8118s
	iters: 300, epoch: 4 | loss: 0.0022317
	speed: 0.2282s/iter; left time: 2821.1897s
	iters: 400, epoch: 4 | loss: 0.0028335
	speed: 0.1737s/iter; left time: 2130.6896s
Epoch: 4 cost time: 95.74233937263489
Epoch: 4, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.971125 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0151258
	speed: 0.6208s/iter; left time: 7508.4840s
	iters: 200, epoch: 5 | loss: 0.2175389
	speed: 0.1997s/iter; left time: 2395.1109s
	iters: 300, epoch: 5 | loss: 0.5656048
	speed: 0.1798s/iter; left time: 2138.1901s
	iters: 400, epoch: 5 | loss: 0.0194515
	speed: 0.1844s/iter; left time: 2174.8405s
Epoch: 5 cost time: 88.56070399284363
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0237672
	speed: 0.6395s/iter; left time: 7434.4436s
	iters: 200, epoch: 6 | loss: 0.0008019
	speed: 0.1052s/iter; left time: 1212.1912s
	iters: 300, epoch: 6 | loss: 0.0002817
	speed: 0.2308s/iter; left time: 2637.3392s
	iters: 400, epoch: 6 | loss: 0.0121075
	speed: 0.2090s/iter; left time: 2367.3841s
Epoch: 6 cost time: 88.4476056098938
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0680738
	speed: 0.7992s/iter; left time: 8917.0028s
	iters: 200, epoch: 7 | loss: 0.0011089
	speed: 0.2007s/iter; left time: 2218.6542s
	iters: 300, epoch: 7 | loss: 0.0038578
	speed: 0.2327s/iter; left time: 2549.8627s
	iters: 400, epoch: 7 | loss: 0.0109030
	speed: 0.2313s/iter; left time: 2510.8057s
Epoch: 7 cost time: 105.39615631103516
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004586
	speed: 0.7885s/iter; left time: 8427.0357s
	iters: 200, epoch: 8 | loss: 0.0007348
	speed: 0.2109s/iter; left time: 2233.3828s
	iters: 300, epoch: 8 | loss: 0.0013890
	speed: 0.2114s/iter; left time: 2216.7349s
	iters: 400, epoch: 8 | loss: 0.0065013
	speed: 0.2086s/iter; left time: 2166.7078s
Epoch: 8 cost time: 96.80732989311218
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.974842).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3459938
	speed: 0.7895s/iter; left time: 8067.9854s
	iters: 200, epoch: 9 | loss: 0.0002555
	speed: 0.2303s/iter; left time: 2330.1475s
	iters: 300, epoch: 9 | loss: 0.0011052
	speed: 0.2317s/iter; left time: 2321.3412s
	iters: 400, epoch: 9 | loss: 0.0023668
	speed: 0.2323s/iter; left time: 2304.6630s
Epoch: 9 cost time: 110.05075025558472
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.974842 --> -0.979702).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0011969
	speed: 0.8155s/iter; left time: 7951.5994s
	iters: 200, epoch: 10 | loss: 0.0040301
	speed: 0.2326s/iter; left time: 2244.6002s
	iters: 300, epoch: 10 | loss: 0.0022193
	speed: 0.2217s/iter; left time: 2117.3704s
	iters: 400, epoch: 10 | loss: 0.3172382
	speed: 0.2257s/iter; left time: 2133.2262s
Epoch: 10 cost time: 108.48607134819031
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0033041
	speed: 0.8551s/iter; left time: 7935.7371s
	iters: 200, epoch: 11 | loss: 0.0004823
	speed: 0.2370s/iter; left time: 2176.2006s
	iters: 300, epoch: 11 | loss: 0.0002592
	speed: 0.2126s/iter; left time: 1930.9261s
	iters: 400, epoch: 11 | loss: 0.0007161
	speed: 0.1940s/iter; left time: 1741.8830s
Epoch: 11 cost time: 102.99529504776001
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0002753
	speed: 0.7132s/iter; left time: 6284.5608s
	iters: 200, epoch: 12 | loss: 0.0001744
	speed: 0.2010s/iter; left time: 1750.9883s
	iters: 300, epoch: 12 | loss: 0.0044852
	speed: 0.2135s/iter; left time: 1838.6683s
	iters: 400, epoch: 12 | loss: 0.0010996
	speed: 0.2169s/iter; left time: 1846.0679s
Epoch: 12 cost time: 97.77802515029907
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5403270
	speed: 0.7326s/iter; left time: 6112.4910s
	iters: 200, epoch: 13 | loss: 0.0039337
	speed: 0.2161s/iter; left time: 1781.4192s
	iters: 300, epoch: 13 | loss: 0.0003350
	speed: 0.2152s/iter; left time: 1752.3098s
	iters: 400, epoch: 13 | loss: 0.0004382
	speed: 0.2149s/iter; left time: 1728.8018s
Epoch: 13 cost time: 100.13826966285706
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0133104
	speed: 0.8244s/iter; left time: 6491.5309s
	iters: 200, epoch: 14 | loss: 0.0039110
	speed: 0.2513s/iter; left time: 1953.3414s
	iters: 300, epoch: 14 | loss: 0.0020884
	speed: 0.2547s/iter; left time: 1954.1875s
	iters: 400, epoch: 14 | loss: 0.0014190
	speed: 0.2541s/iter; left time: 1924.3214s
Epoch: 14 cost time: 117.1565477848053
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0007412
	speed: 0.8020s/iter; left time: 5938.8440s
	iters: 200, epoch: 15 | loss: 0.0007660
	speed: 0.2230s/iter; left time: 1628.8638s
	iters: 300, epoch: 15 | loss: 0.0028500
	speed: 0.2108s/iter; left time: 1518.9593s
	iters: 400, epoch: 15 | loss: 0.0116820
	speed: 0.2177s/iter; left time: 1546.4859s
Epoch: 15 cost time: 100.33440518379211
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0515033
	speed: 0.7421s/iter; left time: 5146.9349s
	iters: 200, epoch: 16 | loss: 0.0024131
	speed: 0.2183s/iter; left time: 1492.6046s
	iters: 300, epoch: 16 | loss: 0.0010999
	speed: 0.2426s/iter; left time: 1634.0650s
	iters: 400, epoch: 16 | loss: 0.0002570
	speed: 0.2487s/iter; left time: 1650.1214s
Epoch: 16 cost time: 107.63931918144226
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0012035
	speed: 0.8683s/iter; left time: 5615.0095s
	iters: 200, epoch: 17 | loss: 0.0000998
	speed: 0.2411s/iter; left time: 1535.0845s
	iters: 300, epoch: 17 | loss: 0.0003028
	speed: 0.2112s/iter; left time: 1323.6935s
	iters: 400, epoch: 17 | loss: 0.0002504
	speed: 0.2267s/iter; left time: 1398.2644s
Epoch: 17 cost time: 108.44139671325684
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0001089
	speed: 0.7716s/iter; left time: 4627.9859s
	iters: 200, epoch: 18 | loss: 0.0002011
	speed: 0.1979s/iter; left time: 1167.3552s
	iters: 300, epoch: 18 | loss: 1.6767244
	speed: 0.2076s/iter; left time: 1203.6551s
	iters: 400, epoch: 18 | loss: 0.0002135
	speed: 0.2225s/iter; left time: 1267.7824s
Epoch: 18 cost time: 99.32570767402649
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0007339
	speed: 0.7796s/iter; left time: 4310.6165s
	iters: 200, epoch: 19 | loss: 0.0037271
	speed: 0.2172s/iter; left time: 1178.9444s
	iters: 300, epoch: 19 | loss: 0.0009462
	speed: 0.1933s/iter; left time: 1030.0470s
	iters: 400, epoch: 19 | loss: 0.0002884
	speed: 0.2227s/iter; left time: 1164.6832s
Epoch: 19 cost time: 100.83784866333008
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 37504522
model size : 145.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5881002
	speed: 0.1141s/iter; left time: 1593.6176s
	iters: 200, epoch: 1 | loss: 0.2268110
	speed: 0.1005s/iter; left time: 1394.3633s
	iters: 300, epoch: 1 | loss: 0.0638355
	speed: 0.0989s/iter; left time: 1361.6786s
	iters: 400, epoch: 1 | loss: 0.0335559
	speed: 0.0982s/iter; left time: 1342.0265s
Epoch: 1 cost time: 48.28818917274475
Epoch: 1, Steps: 469 | Train Loss: 0.381 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (inf --> -0.973126).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0250906
	speed: 0.4378s/iter; left time: 5911.0030s
	iters: 200, epoch: 2 | loss: 0.5115527
	speed: 0.1017s/iter; left time: 1362.4134s
	iters: 300, epoch: 2 | loss: 0.0050898
	speed: 0.1023s/iter; left time: 1360.2058s
	iters: 400, epoch: 2 | loss: 0.0603392
	speed: 0.1028s/iter; left time: 1356.5645s
Epoch: 2 cost time: 48.10250282287598
Epoch: 2, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0268244
	speed: 0.3618s/iter; left time: 4715.3212s
	iters: 200, epoch: 3 | loss: 0.0068119
	speed: 0.0874s/iter; left time: 1130.7648s
	iters: 300, epoch: 3 | loss: 0.4374719
	speed: 0.0880s/iter; left time: 1129.6072s
	iters: 400, epoch: 3 | loss: 0.0278721
	speed: 0.0899s/iter; left time: 1144.7692s
Epoch: 3 cost time: 41.73555850982666
Epoch: 3, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0307290
	speed: 0.3759s/iter; left time: 4723.1286s
	iters: 200, epoch: 4 | loss: 0.0367821
	speed: 0.0796s/iter; left time: 992.1416s
	iters: 300, epoch: 4 | loss: 0.0673554
	speed: 0.0866s/iter; left time: 1071.1873s
	iters: 400, epoch: 4 | loss: 0.0704000
	speed: 0.0879s/iter; left time: 1078.2487s
Epoch: 4 cost time: 40.60336351394653
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0087967
	speed: 0.3539s/iter; left time: 4279.8886s
	iters: 200, epoch: 5 | loss: 0.0004219
	speed: 0.0875s/iter; left time: 1050.0450s
	iters: 300, epoch: 5 | loss: 0.3586635
	speed: 0.0892s/iter; left time: 1060.4400s
	iters: 400, epoch: 5 | loss: 0.0009420
	speed: 0.0607s/iter; left time: 715.8554s
Epoch: 5 cost time: 38.52530074119568
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0134890
	speed: 0.4158s/iter; left time: 4834.2343s
	iters: 200, epoch: 6 | loss: 0.3453228
	speed: 0.0975s/iter; left time: 1123.3788s
	iters: 300, epoch: 6 | loss: 0.0927771
	speed: 0.0995s/iter; left time: 1136.9810s
	iters: 400, epoch: 6 | loss: 0.0244540
	speed: 0.0996s/iter; left time: 1128.5135s
Epoch: 6 cost time: 46.49704074859619
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0009149
	speed: 0.3878s/iter; left time: 4326.1593s
	iters: 200, epoch: 7 | loss: 0.1202312
	speed: 0.0935s/iter; left time: 1033.6155s
	iters: 300, epoch: 7 | loss: 0.0002930
	speed: 0.0914s/iter; left time: 1001.0358s
	iters: 400, epoch: 7 | loss: 0.0020942
	speed: 0.0916s/iter; left time: 994.5133s
Epoch: 7 cost time: 43.633169412612915
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.973698).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003390
	speed: 0.4031s/iter; left time: 4308.3695s
	iters: 200, epoch: 8 | loss: 0.0180175
	speed: 0.0913s/iter; left time: 967.0338s
	iters: 300, epoch: 8 | loss: 0.0222850
	speed: 0.0915s/iter; left time: 959.8365s
	iters: 400, epoch: 8 | loss: 0.1956877
	speed: 0.0926s/iter; left time: 961.6641s
Epoch: 8 cost time: 43.36831593513489
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0066621
	speed: 0.3548s/iter; left time: 3625.6036s
	iters: 200, epoch: 9 | loss: 0.0029448
	speed: 0.0863s/iter; left time: 872.8331s
	iters: 300, epoch: 9 | loss: 0.0016594
	speed: 0.0872s/iter; left time: 873.6965s
	iters: 400, epoch: 9 | loss: 0.0010287
	speed: 0.0853s/iter; left time: 845.7931s
Epoch: 9 cost time: 40.25693655014038
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0296617
	speed: 0.3698s/iter; left time: 3605.3450s
	iters: 200, epoch: 10 | loss: 0.0017158
	speed: 0.0873s/iter; left time: 842.1711s
	iters: 300, epoch: 10 | loss: 0.0013720
	speed: 0.0786s/iter; left time: 750.5498s
	iters: 400, epoch: 10 | loss: 0.0153830
	speed: 0.0863s/iter; left time: 815.3622s
Epoch: 10 cost time: 40.22433400154114
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.973698 --> -0.979416).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0979172
	speed: 0.3574s/iter; left time: 3316.9421s
	iters: 200, epoch: 11 | loss: 0.0055991
	speed: 0.0824s/iter; left time: 756.6537s
	iters: 300, epoch: 11 | loss: 0.0941567
	speed: 0.0848s/iter; left time: 769.8863s
	iters: 400, epoch: 11 | loss: 0.0001467
	speed: 0.0832s/iter; left time: 747.1188s
Epoch: 11 cost time: 39.01898908615112
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.981131).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0019304
	speed: 0.3672s/iter; left time: 3235.9408s
	iters: 200, epoch: 12 | loss: 0.0000859
	speed: 0.0897s/iter; left time: 781.7044s
	iters: 300, epoch: 12 | loss: 0.0029635
	speed: 0.0884s/iter; left time: 761.7008s
	iters: 400, epoch: 12 | loss: 0.0196635
	speed: 0.0897s/iter; left time: 763.2355s
Epoch: 12 cost time: 42.18978571891785
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0004315
	speed: 0.3820s/iter; left time: 3186.8389s
	iters: 200, epoch: 13 | loss: 0.0001367
	speed: 0.0993s/iter; left time: 818.5610s
	iters: 300, epoch: 13 | loss: 0.0004734
	speed: 0.0979s/iter; left time: 797.0019s
	iters: 400, epoch: 13 | loss: 0.0002471
	speed: 0.0975s/iter; left time: 784.0112s
Epoch: 13 cost time: 46.66743183135986
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000284
	speed: 0.4230s/iter; left time: 3330.4116s
	iters: 200, epoch: 14 | loss: 0.0002795
	speed: 0.0979s/iter; left time: 760.7666s
	iters: 300, epoch: 14 | loss: 0.0000905
	speed: 0.0989s/iter; left time: 758.7448s
	iters: 400, epoch: 14 | loss: 0.0010328
	speed: 0.0982s/iter; left time: 743.4210s
Epoch: 14 cost time: 46.354360818862915
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0007639
	speed: 0.3886s/iter; left time: 2877.8626s
	iters: 200, epoch: 15 | loss: 0.0003113
	speed: 0.0820s/iter; left time: 599.2327s
	iters: 300, epoch: 15 | loss: 0.0025474
	speed: 0.0872s/iter; left time: 628.4140s
	iters: 400, epoch: 15 | loss: 0.0001891
	speed: 0.0864s/iter; left time: 613.5333s
Epoch: 15 cost time: 39.188114404678345
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0019108
	speed: 0.3726s/iter; left time: 2584.5169s
	iters: 200, epoch: 16 | loss: 0.0007547
	speed: 0.0872s/iter; left time: 595.8418s
	iters: 300, epoch: 16 | loss: 0.0007019
	speed: 0.0877s/iter; left time: 590.4926s
	iters: 400, epoch: 16 | loss: 0.0657322
	speed: 0.0763s/iter; left time: 506.0836s
Epoch: 16 cost time: 40.166301012039185
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0005328
	speed: 0.3590s/iter; left time: 2321.7218s
	iters: 200, epoch: 17 | loss: 0.0000385
	speed: 0.0831s/iter; left time: 529.3465s
	iters: 300, epoch: 17 | loss: 0.0022204
	speed: 0.0908s/iter; left time: 568.9857s
	iters: 400, epoch: 17 | loss: 0.0065638
	speed: 0.0926s/iter; left time: 570.8193s
Epoch: 17 cost time: 41.14834547042847
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0046329
	speed: 0.3830s/iter; left time: 2297.0915s
	iters: 200, epoch: 18 | loss: 0.0032141
	speed: 0.0947s/iter; left time: 558.6982s
	iters: 300, epoch: 18 | loss: 0.0003498
	speed: 0.0940s/iter; left time: 544.8432s
	iters: 400, epoch: 18 | loss: 0.0001110
	speed: 0.0940s/iter; left time: 535.5011s
Epoch: 18 cost time: 44.64515018463135
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0001194
	speed: 0.4018s/iter; left time: 2221.7296s
	iters: 200, epoch: 19 | loss: 0.0000929
	speed: 0.0820s/iter; left time: 445.4404s
	iters: 300, epoch: 19 | loss: 0.0000081
	speed: 0.0870s/iter; left time: 463.3904s
	iters: 400, epoch: 19 | loss: 0.0020098
	speed: 0.0888s/iter; left time: 464.4025s
Epoch: 19 cost time: 40.78881764411926
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0099880
	speed: 0.3908s/iter; left time: 1977.4400s
	iters: 200, epoch: 20 | loss: 0.0006988
	speed: 0.0919s/iter; left time: 455.6287s
	iters: 300, epoch: 20 | loss: 0.0027811
	speed: 0.0910s/iter; left time: 442.3970s
	iters: 400, epoch: 20 | loss: 0.0000521
	speed: 0.0915s/iter; left time: 435.3264s
Epoch: 20 cost time: 43.154027462005615
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000937
	speed: 0.3803s/iter; left time: 1745.8621s
	iters: 200, epoch: 21 | loss: 0.0001153
	speed: 0.0826s/iter; left time: 371.0792s
	iters: 300, epoch: 21 | loss: 0.0013508
	speed: 0.0869s/iter; left time: 381.5315s
	iters: 400, epoch: 21 | loss: 0.0000154
	speed: 0.0868s/iter; left time: 372.3628s
Epoch: 21 cost time: 40.497211933135986
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001730
	speed: 0.3751s/iter; left time: 1546.2413s
	iters: 200, epoch: 22 | loss: 0.0027716
	speed: 0.0868s/iter; left time: 348.9908s
	iters: 300, epoch: 22 | loss: 0.0000981
	speed: 0.0853s/iter; left time: 334.3943s
	iters: 400, epoch: 22 | loss: 0.0081701
	speed: 0.0850s/iter; left time: 324.7532s
Epoch: 22 cost time: 39.60289478302002
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0025100
	speed: 0.3460s/iter; left time: 1263.9312s
	iters: 200, epoch: 23 | loss: 0.0000719
	speed: 0.0820s/iter; left time: 291.3902s
	iters: 300, epoch: 23 | loss: 0.0002352
	speed: 0.0816s/iter; left time: 281.8554s
	iters: 400, epoch: 23 | loss: 0.0001801
	speed: 0.0815s/iter; left time: 273.2907s
Epoch: 23 cost time: 38.447930097579956
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0029251
	speed: 0.3494s/iter; left time: 1112.5518s
	iters: 200, epoch: 24 | loss: 0.0342452
	speed: 0.0863s/iter; left time: 266.0163s
	iters: 300, epoch: 24 | loss: 0.0076505
	speed: 0.0869s/iter; left time: 259.3691s
	iters: 400, epoch: 24 | loss: 0.0001182
	speed: 0.0882s/iter; left time: 254.4359s
Epoch: 24 cost time: 41.55262231826782
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0057124
	speed: 0.3840s/iter; left time: 1042.4352s
	iters: 200, epoch: 25 | loss: 0.3110459
	speed: 0.0989s/iter; left time: 258.6313s
	iters: 300, epoch: 25 | loss: 0.0000376
	speed: 0.1023s/iter; left time: 257.3122s
	iters: 400, epoch: 25 | loss: 0.0056750
	speed: 0.1017s/iter; left time: 245.5488s
Epoch: 25 cost time: 46.60298776626587
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0017544
	speed: 0.4446s/iter; left time: 998.5168s
	iters: 200, epoch: 26 | loss: 0.0000180
	speed: 0.1027s/iter; left time: 220.4581s
	iters: 300, epoch: 26 | loss: 0.0003715
	speed: 0.1034s/iter; left time: 211.6105s
	iters: 400, epoch: 26 | loss: 0.0001039
	speed: 0.1021s/iter; left time: 198.7353s
Epoch: 26 cost time: 48.6551775932312
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0005794
	speed: 0.4404s/iter; left time: 782.5845s
	iters: 200, epoch: 27 | loss: 0.0002891
	speed: 0.1003s/iter; left time: 168.2578s
	iters: 300, epoch: 27 | loss: 0.0014147
	speed: 0.0771s/iter; left time: 121.5986s
	iters: 400, epoch: 27 | loss: 0.0326630
	speed: 0.0780s/iter; left time: 115.2082s
Epoch: 27 cost time: 41.700183629989624
Epoch: 27, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000296
	speed: 0.3741s/iter; left time: 489.2935s
	iters: 200, epoch: 28 | loss: 0.0003547
	speed: 0.0877s/iter; left time: 105.9482s
	iters: 300, epoch: 28 | loss: 0.0120216
	speed: 0.0874s/iter; left time: 96.8808s
	iters: 400, epoch: 28 | loss: 0.0037672
	speed: 0.0865s/iter; left time: 87.2065s
Epoch: 28 cost time: 41.2599732875824
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.3735975
	speed: 0.3701s/iter; left time: 310.5052s
	iters: 200, epoch: 29 | loss: 0.0000659
	speed: 0.0895s/iter; left time: 66.1256s
	iters: 300, epoch: 29 | loss: 0.0002337
	speed: 0.0880s/iter; left time: 56.2312s
	iters: 400, epoch: 29 | loss: 0.0252958
	speed: 0.0879s/iter; left time: 47.3922s
Epoch: 29 cost time: 41.389320611953735
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0037197
	speed: 0.3698s/iter; left time: 136.8445s
	iters: 200, epoch: 30 | loss: 0.0007144
	speed: 0.0991s/iter; left time: 26.7603s
	iters: 300, epoch: 30 | loss: 0.0004626
	speed: 0.0991s/iter; left time: 16.8554s
	iters: 400, epoch: 30 | loss: 0.0026486
	speed: 0.0994s/iter; left time: 6.9576s
Epoch: 30 cost time: 45.58668780326843
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 11025930
model size : 44.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3878891
	speed: 0.5561s/iter; left time: 7769.0365s
	iters: 200, epoch: 1 | loss: 0.1617746
	speed: 0.5364s/iter; left time: 7439.9448s
	iters: 300, epoch: 1 | loss: 0.1031027
	speed: 0.5459s/iter; left time: 7517.4682s
	iters: 400, epoch: 1 | loss: 0.0454145
	speed: 0.5132s/iter; left time: 7015.8793s
Epoch: 1 cost time: 251.0974349975586
Epoch: 1, Steps: 469 | Train Loss: 0.385 Vali Loss: 0.147 Vali Acc: 0.952 Test Loss: 0.147 Test Acc: 0.952
Validation loss decreased (inf --> -0.951971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1399212
	speed: 1.7049s/iter; left time: 23019.6403s
	iters: 200, epoch: 2 | loss: 0.0057783
	speed: 0.4840s/iter; left time: 6487.1037s
	iters: 300, epoch: 2 | loss: 0.0183841
	speed: 0.5074s/iter; left time: 6749.7098s
	iters: 400, epoch: 2 | loss: 0.0499375
	speed: 0.5640s/iter; left time: 7446.0572s
Epoch: 2 cost time: 241.77398467063904
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.951971 --> -0.966837).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0260660
	speed: 1.8479s/iter; left time: 24083.9932s
	iters: 200, epoch: 3 | loss: 0.0058329
	speed: 0.4958s/iter; left time: 6412.6479s
	iters: 300, epoch: 3 | loss: 0.2742791
	speed: 0.4847s/iter; left time: 6220.0604s
	iters: 400, epoch: 3 | loss: 0.0129699
	speed: 0.5114s/iter; left time: 6511.1887s
Epoch: 3 cost time: 235.94034075737
Epoch: 3, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0034279
	speed: 1.7274s/iter; left time: 21702.4828s
	iters: 200, epoch: 4 | loss: 0.0088134
	speed: 0.4954s/iter; left time: 6174.1107s
	iters: 300, epoch: 4 | loss: 0.0037595
	speed: 0.5197s/iter; left time: 6425.8452s
	iters: 400, epoch: 4 | loss: 0.0147223
	speed: 0.5260s/iter; left time: 6451.4207s
Epoch: 4 cost time: 238.77636623382568
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0261468
	speed: 1.6216s/iter; left time: 19613.5714s
	iters: 200, epoch: 5 | loss: 0.0009908
	speed: 0.5078s/iter; left time: 6091.2521s
	iters: 300, epoch: 5 | loss: 0.0014980
	speed: 0.5205s/iter; left time: 6191.0708s
	iters: 400, epoch: 5 | loss: 0.0062894
	speed: 0.5434s/iter; left time: 6409.3924s
Epoch: 5 cost time: 237.99881553649902
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0031132
	speed: 1.7639s/iter; left time: 20507.3644s
	iters: 200, epoch: 6 | loss: 0.1566635
	speed: 0.5209s/iter; left time: 6004.1435s
	iters: 300, epoch: 6 | loss: 0.0033637
	speed: 0.5034s/iter; left time: 5751.4522s
	iters: 400, epoch: 6 | loss: 0.0703015
	speed: 0.4830s/iter; left time: 5470.6407s
Epoch: 6 cost time: 235.12993049621582
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.131 Vali Acc: 0.966 Test Loss: 0.131 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0013779
	speed: 1.6804s/iter; left time: 18748.5307s
	iters: 200, epoch: 7 | loss: 0.0022824
	speed: 0.5117s/iter; left time: 5657.9286s
	iters: 300, epoch: 7 | loss: 0.0012018
	speed: 0.4965s/iter; left time: 5440.3720s
	iters: 400, epoch: 7 | loss: 0.0027696
	speed: 0.5080s/iter; left time: 5515.2581s
Epoch: 7 cost time: 238.03091263771057
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.966837 --> -0.978272).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004066
	speed: 1.6506s/iter; left time: 17641.5902s
	iters: 200, epoch: 8 | loss: 0.0391457
	speed: 0.4504s/iter; left time: 4768.4078s
	iters: 300, epoch: 8 | loss: 0.0022286
	speed: 0.4464s/iter; left time: 4681.9133s
	iters: 400, epoch: 8 | loss: 0.0041989
	speed: 0.4630s/iter; left time: 4809.1979s
Epoch: 8 cost time: 214.671569108963
Epoch: 8, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0112541
	speed: 1.6551s/iter; left time: 16913.2637s
	iters: 200, epoch: 9 | loss: 0.0007292
	speed: 0.4791s/iter; left time: 4848.0079s
	iters: 300, epoch: 9 | loss: 0.0019392
	speed: 0.4722s/iter; left time: 4731.2781s
	iters: 400, epoch: 9 | loss: 0.0048607
	speed: 0.4656s/iter; left time: 4618.3406s
Epoch: 9 cost time: 221.67267513275146
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.981417).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0054150
	speed: 1.5811s/iter; left time: 15415.9461s
	iters: 200, epoch: 10 | loss: 0.0005652
	speed: 0.4605s/iter; left time: 4443.6808s
	iters: 300, epoch: 10 | loss: 0.0046525
	speed: 0.4650s/iter; left time: 4440.7702s
	iters: 400, epoch: 10 | loss: 0.0010486
	speed: 0.2976s/iter; left time: 2812.0616s
Epoch: 10 cost time: 198.89547657966614
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0005387
	speed: 1.6587s/iter; left time: 15394.6133s
	iters: 200, epoch: 11 | loss: 0.0060165
	speed: 1.1186s/iter; left time: 10269.5217s
	iters: 300, epoch: 11 | loss: 0.1970523
	speed: 1.1577s/iter; left time: 10512.6700s
	iters: 400, epoch: 11 | loss: 0.0004550
	speed: 1.1201s/iter; left time: 10059.2980s
Epoch: 11 cost time: 461.19025135040283
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.983418).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002872
	speed: 3.6124s/iter; left time: 31832.4760s
	iters: 200, epoch: 12 | loss: 0.0027208
	speed: 0.9710s/iter; left time: 8459.6275s
	iters: 300, epoch: 12 | loss: 0.0004900
	speed: 0.9991s/iter; left time: 8604.3075s
	iters: 400, epoch: 12 | loss: 0.0021491
	speed: 1.0268s/iter; left time: 8740.3663s
Epoch: 12 cost time: 482.8075053691864
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002550
	speed: 3.4191s/iter; left time: 28525.1989s
	iters: 200, epoch: 13 | loss: 0.0003297
	speed: 0.9534s/iter; left time: 7859.2825s
	iters: 300, epoch: 13 | loss: 0.0004165
	speed: 1.0202s/iter; left time: 8307.3578s
	iters: 400, epoch: 13 | loss: 0.0031450
	speed: 1.0803s/iter; left time: 8689.2251s
Epoch: 13 cost time: 470.15064668655396
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1664989
	speed: 3.6400s/iter; left time: 28661.2190s
	iters: 200, epoch: 14 | loss: 0.0019185
	speed: 1.0234s/iter; left time: 7955.9488s
	iters: 300, epoch: 14 | loss: 0.0008724
	speed: 0.9651s/iter; left time: 7406.5567s
	iters: 400, epoch: 14 | loss: 0.0024819
	speed: 0.9839s/iter; left time: 7451.7431s
Epoch: 14 cost time: 476.9238336086273
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0025963
	speed: 3.3127s/iter; left time: 24530.3403s
	iters: 200, epoch: 15 | loss: 0.0002387
	speed: 0.9249s/iter; left time: 6756.6298s
	iters: 300, epoch: 15 | loss: 0.0397249
	speed: 1.0110s/iter; left time: 7284.0025s
	iters: 400, epoch: 15 | loss: 0.0046608
	speed: 0.9158s/iter; left time: 6506.6639s
Epoch: 15 cost time: 444.0125436782837
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0002351
	speed: 3.1286s/iter; left time: 21700.2422s
	iters: 200, epoch: 16 | loss: 0.0002112
	speed: 0.8327s/iter; left time: 5692.5050s
	iters: 300, epoch: 16 | loss: 0.0006165
	speed: 0.8645s/iter; left time: 5823.2638s
	iters: 400, epoch: 16 | loss: 0.0009571
	speed: 0.8987s/iter; left time: 5963.9752s
Epoch: 16 cost time: 410.1113986968994
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0009019
	speed: 2.8882s/iter; left time: 18678.2286s
	iters: 200, epoch: 17 | loss: 0.0001525
	speed: 0.8012s/iter; left time: 5101.1159s
	iters: 300, epoch: 17 | loss: 0.0002574
	speed: 0.9168s/iter; left time: 5745.2883s
	iters: 400, epoch: 17 | loss: 0.0007960
	speed: 0.8127s/iter; left time: 5011.9594s
Epoch: 17 cost time: 388.51698541641235
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0007149
	speed: 2.7567s/iter; left time: 16534.6301s
	iters: 200, epoch: 18 | loss: 0.0098747
	speed: 0.7599s/iter; left time: 4481.8873s
	iters: 300, epoch: 18 | loss: 0.0002721
	speed: 0.7994s/iter; left time: 4635.0221s
	iters: 400, epoch: 18 | loss: 0.0008358
	speed: 0.7629s/iter; left time: 4346.9625s
Epoch: 18 cost time: 368.69795393943787
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0016758
	speed: 2.7594s/iter; left time: 15256.4688s
	iters: 200, epoch: 19 | loss: 0.0001696
	speed: 0.7353s/iter; left time: 3992.0123s
	iters: 300, epoch: 19 | loss: 0.0013143
	speed: 0.7925s/iter; left time: 4223.1183s
	iters: 400, epoch: 19 | loss: 0.0005964
	speed: 0.7624s/iter; left time: 3986.4076s
Epoch: 19 cost time: 355.432514667511
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0007699
	speed: 2.7652s/iter; left time: 13991.7024s
	iters: 200, epoch: 20 | loss: 0.0231084
	speed: 0.7598s/iter; left time: 3768.4676s
	iters: 300, epoch: 20 | loss: 0.0004545
	speed: 0.7912s/iter; left time: 3845.1812s
	iters: 400, epoch: 20 | loss: 0.0002050
	speed: 0.7498s/iter; left time: 3569.0623s
Epoch: 20 cost time: 360.6176846027374
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001343
	speed: 2.5322s/iter; left time: 11625.1470s
	iters: 200, epoch: 21 | loss: 0.1944983
	speed: 0.6547s/iter; left time: 2940.0928s
	iters: 300, epoch: 21 | loss: 0.0001371
	speed: 0.8452s/iter; left time: 3711.2467s
	iters: 400, epoch: 21 | loss: 0.0000743
	speed: 1.0068s/iter; left time: 4320.0195s
Epoch: 21 cost time: 385.9550642967224
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 37500170
model size : 144.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5737178
	speed: 0.3925s/iter; left time: 5484.1809s
	iters: 200, epoch: 1 | loss: 0.2373920
	speed: 0.3566s/iter; left time: 4946.1010s
	iters: 300, epoch: 1 | loss: 0.0579376
	speed: 0.2604s/iter; left time: 3586.4442s
	iters: 400, epoch: 1 | loss: 0.1028018
	speed: 0.2527s/iter; left time: 3455.2805s
Epoch: 1 cost time: 148.13465404510498
Epoch: 1, Steps: 469 | Train Loss: 0.386 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
Validation loss decreased (inf --> -0.937962).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0925351
	speed: 1.2043s/iter; left time: 16261.0330s
	iters: 200, epoch: 2 | loss: 0.0530066
	speed: 0.2776s/iter; left time: 3720.8701s
	iters: 300, epoch: 2 | loss: 0.1179680
	speed: 0.3295s/iter; left time: 4383.2354s
	iters: 400, epoch: 2 | loss: 0.0850741
	speed: 0.2871s/iter; left time: 3790.5306s
Epoch: 2 cost time: 144.52407884597778
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.937962 --> -0.965408).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0088157
	speed: 1.2743s/iter; left time: 16607.3023s
	iters: 200, epoch: 3 | loss: 0.0020124
	speed: 0.2978s/iter; left time: 3851.7319s
	iters: 300, epoch: 3 | loss: 0.0270157
	speed: 0.2521s/iter; left time: 3235.3854s
	iters: 400, epoch: 3 | loss: 0.0026430
	speed: 0.2984s/iter; left time: 3799.2961s
Epoch: 3 cost time: 133.13149523735046
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0235453
	speed: 1.1249s/iter; left time: 14132.9487s
	iters: 200, epoch: 4 | loss: 0.0328228
	speed: 0.2546s/iter; left time: 3173.4204s
	iters: 300, epoch: 4 | loss: 0.1349587
	speed: 0.3049s/iter; left time: 3770.1765s
	iters: 400, epoch: 4 | loss: 0.0053021
	speed: 0.3188s/iter; left time: 3909.8349s
Epoch: 4 cost time: 134.72472095489502
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0045847
	speed: 1.3431s/iter; left time: 16244.4478s
	iters: 200, epoch: 5 | loss: 0.0041678
	speed: 0.3217s/iter; left time: 3859.1738s
	iters: 300, epoch: 5 | loss: 0.0023594
	speed: 0.3310s/iter; left time: 3936.9571s
	iters: 400, epoch: 5 | loss: 0.0018952
	speed: 0.2961s/iter; left time: 3492.6837s
Epoch: 5 cost time: 152.2607502937317
Epoch: 5, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0042969
	speed: 1.2949s/iter; left time: 15054.0381s
	iters: 200, epoch: 6 | loss: 0.0650289
	speed: 0.2868s/iter; left time: 3306.0259s
	iters: 300, epoch: 6 | loss: 0.0011275
	speed: 0.3288s/iter; left time: 3756.5174s
	iters: 400, epoch: 6 | loss: 0.0009800
	speed: 0.2890s/iter; left time: 3273.4522s
Epoch: 6 cost time: 143.31992435455322
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.965408 --> -0.978844).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0020259
	speed: 1.2434s/iter; left time: 13872.7802s
	iters: 200, epoch: 7 | loss: 0.0015062
	speed: 0.3414s/iter; left time: 3775.1475s
	iters: 300, epoch: 7 | loss: 0.0022909
	speed: 0.3122s/iter; left time: 3420.8835s
	iters: 400, epoch: 7 | loss: 0.0148900
	speed: 0.3094s/iter; left time: 3358.9547s
Epoch: 7 cost time: 153.94710326194763
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0006688
	speed: 1.3187s/iter; left time: 14094.3126s
	iters: 200, epoch: 8 | loss: 0.0069602
	speed: 0.2916s/iter; left time: 3087.3901s
	iters: 300, epoch: 8 | loss: 0.0280704
	speed: 0.3341s/iter; left time: 3504.3462s
	iters: 400, epoch: 8 | loss: 0.0007274
	speed: 0.2995s/iter; left time: 3110.8691s
Epoch: 8 cost time: 146.94217228889465
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979988).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0187947
	speed: 1.1727s/iter; left time: 11983.9215s
	iters: 200, epoch: 9 | loss: 0.0015870
	speed: 0.2995s/iter; left time: 3030.6904s
	iters: 300, epoch: 9 | loss: 0.0021836
	speed: 0.3077s/iter; left time: 3082.5257s
	iters: 400, epoch: 9 | loss: 0.0016523
	speed: 0.2664s/iter; left time: 2642.2335s
Epoch: 9 cost time: 135.30158114433289
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0023178
	speed: 1.1208s/iter; left time: 10928.1777s
	iters: 200, epoch: 10 | loss: 0.0630457
	speed: 0.3462s/iter; left time: 3341.2665s
	iters: 300, epoch: 10 | loss: 0.0097776
	speed: 0.2875s/iter; left time: 2745.1782s
	iters: 400, epoch: 10 | loss: 0.0004138
	speed: 0.3193s/iter; left time: 3017.3128s
Epoch: 10 cost time: 148.15132927894592
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0074577
	speed: 1.2714s/iter; left time: 11799.7385s
	iters: 200, epoch: 11 | loss: 0.0738572
	speed: 0.3025s/iter; left time: 2776.9839s
	iters: 300, epoch: 11 | loss: 0.0002324
	speed: 0.2894s/iter; left time: 2627.8696s
	iters: 400, epoch: 11 | loss: 0.0012010
	speed: 0.2790s/iter; left time: 2505.3242s
Epoch: 11 cost time: 139.22906708717346
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0019208
	speed: 0.9604s/iter; left time: 8462.6137s
	iters: 200, epoch: 12 | loss: 0.0011539
	speed: 0.2593s/iter; left time: 2259.3394s
	iters: 300, epoch: 12 | loss: 0.0004358
	speed: 0.2628s/iter; left time: 2263.1001s
	iters: 400, epoch: 12 | loss: 0.0059331
	speed: 0.2334s/iter; left time: 1986.4403s
Epoch: 12 cost time: 118.78167533874512
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2311244
	speed: 1.0499s/iter; left time: 8759.5877s
	iters: 200, epoch: 13 | loss: 0.0009000
	speed: 0.2650s/iter; left time: 2184.7256s
	iters: 300, epoch: 13 | loss: 0.0017566
	speed: 0.2569s/iter; left time: 2091.8613s
	iters: 400, epoch: 13 | loss: 0.0002225
	speed: 0.2551s/iter; left time: 2051.6755s
Epoch: 13 cost time: 123.26341223716736
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.2865004
	speed: 1.5579s/iter; left time: 12266.6358s
	iters: 200, epoch: 14 | loss: 0.0003108
	speed: 0.4598s/iter; left time: 3574.7218s
	iters: 300, epoch: 14 | loss: 0.0002266
	speed: 0.4867s/iter; left time: 3734.7104s
	iters: 400, epoch: 14 | loss: 0.0007103
	speed: 0.4506s/iter; left time: 3412.7737s
Epoch: 14 cost time: 213.68789768218994
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0006180
	speed: 1.6140s/iter; left time: 11951.4005s
	iters: 200, epoch: 15 | loss: 0.0117131
	speed: 0.4185s/iter; left time: 3057.4671s
	iters: 300, epoch: 15 | loss: 0.0001906
	speed: 0.4625s/iter; left time: 3332.2432s
	iters: 400, epoch: 15 | loss: 0.0002861
	speed: 0.4513s/iter; left time: 3206.8017s
Epoch: 15 cost time: 211.5789201259613
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0008689
	speed: 1.8155s/iter; left time: 12592.6123s
	iters: 200, epoch: 16 | loss: 0.0004207
	speed: 0.4230s/iter; left time: 2891.9501s
	iters: 300, epoch: 16 | loss: 0.0013150
	speed: 0.4238s/iter; left time: 2854.6252s
	iters: 400, epoch: 16 | loss: 0.0098716
	speed: 0.4306s/iter; left time: 2857.4533s
Epoch: 16 cost time: 204.42014455795288
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1447849
	speed: 1.7044s/iter; left time: 11022.0939s
	iters: 200, epoch: 17 | loss: 0.0001943
	speed: 0.4120s/iter; left time: 2623.4130s
	iters: 300, epoch: 17 | loss: 0.0006634
	speed: 0.4053s/iter; left time: 2540.0255s
	iters: 400, epoch: 17 | loss: 0.0034373
	speed: 0.4206s/iter; left time: 2594.1149s
Epoch: 17 cost time: 195.76597261428833
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0004227
	speed: 1.6907s/iter; left time: 10140.7563s
	iters: 200, epoch: 18 | loss: 0.0002529
	speed: 0.4106s/iter; left time: 2421.9026s
	iters: 300, epoch: 18 | loss: 0.0002350
	speed: 0.4394s/iter; left time: 2547.6857s
	iters: 400, epoch: 18 | loss: 0.0014294
	speed: 0.4156s/iter; left time: 2367.8077s
Epoch: 18 cost time: 195.32503008842468
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 11021066
model size : 43.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4066631
	speed: 0.7575s/iter; left time: 10583.1102s
	iters: 200, epoch: 1 | loss: 0.1554719
	speed: 0.8936s/iter; left time: 12395.7767s
	iters: 300, epoch: 1 | loss: 0.1477284
	speed: 0.9230s/iter; left time: 12710.8679s
	iters: 400, epoch: 1 | loss: 0.0912188
	speed: 0.8747s/iter; left time: 11958.0062s
Epoch: 1 cost time: 408.85054111480713
Epoch: 1, Steps: 469 | Train Loss: 0.397 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (inf --> -0.956831).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0983436
	speed: 3.3177s/iter; left time: 44795.4936s
	iters: 200, epoch: 2 | loss: 0.2075323
	speed: 0.9002s/iter; left time: 12064.5289s
	iters: 300, epoch: 2 | loss: 0.0031787
	speed: 0.8636s/iter; left time: 11487.0006s
	iters: 400, epoch: 2 | loss: 0.1352139
	speed: 0.8761s/iter; left time: 11566.5215s
Epoch: 2 cost time: 421.90237617492676
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.956831 --> -0.964550).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2115032
	speed: 3.2573s/iter; left time: 42452.8567s
	iters: 200, epoch: 3 | loss: 0.1447631
	speed: 0.8715s/iter; left time: 11271.3345s
	iters: 300, epoch: 3 | loss: 0.4482024
	speed: 0.9148s/iter; left time: 11739.2556s
	iters: 400, epoch: 3 | loss: 0.0062552
	speed: 0.8717s/iter; left time: 11099.1116s
Epoch: 3 cost time: 408.4922151565552
Epoch: 3, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
Validation loss decreased (-0.964550 --> -0.965693).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0935453
	speed: 3.1854s/iter; left time: 40021.8706s
	iters: 200, epoch: 4 | loss: 0.0032780
	speed: 0.8001s/iter; left time: 9972.4317s
	iters: 300, epoch: 4 | loss: 0.0045786
	speed: 0.7786s/iter; left time: 9626.1784s
	iters: 400, epoch: 4 | loss: 0.0233627
	speed: 0.7727s/iter; left time: 9476.4274s
Epoch: 4 cost time: 367.64386534690857
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.248 Vali Acc: 0.936 Test Loss: 0.248 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0309552
	speed: 2.7988s/iter; left time: 33851.7039s
	iters: 200, epoch: 5 | loss: 0.0004344
	speed: 0.7314s/iter; left time: 8773.4013s
	iters: 300, epoch: 5 | loss: 0.0027454
	speed: 0.7292s/iter; left time: 8674.0885s
	iters: 400, epoch: 5 | loss: 0.1205011
	speed: 0.8037s/iter; left time: 9479.9847s
Epoch: 5 cost time: 353.12476801872253
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0010102
	speed: 2.7944s/iter; left time: 32487.7278s
	iters: 200, epoch: 6 | loss: 0.0048812
	speed: 0.7717s/iter; left time: 8894.1156s
	iters: 300, epoch: 6 | loss: 0.0121536
	speed: 0.7481s/iter; left time: 8547.8617s
	iters: 400, epoch: 6 | loss: 0.3798264
	speed: 0.7274s/iter; left time: 8238.6556s
Epoch: 6 cost time: 352.3417766094208
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0041427
	speed: 2.5271s/iter; left time: 28194.6312s
	iters: 200, epoch: 7 | loss: 0.0403365
	speed: 0.6833s/iter; left time: 7555.7884s
	iters: 300, epoch: 7 | loss: 0.0036197
	speed: 0.7046s/iter; left time: 7720.6227s
	iters: 400, epoch: 7 | loss: 0.0005991
	speed: 0.7093s/iter; left time: 7701.4069s
Epoch: 7 cost time: 330.6398673057556
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.965693 --> -0.977129).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0006355
	speed: 2.5802s/iter; left time: 27576.8807s
	iters: 200, epoch: 8 | loss: 0.0596427
	speed: 0.7257s/iter; left time: 7684.0343s
	iters: 300, epoch: 8 | loss: 0.0011487
	speed: 0.7074s/iter; left time: 7419.0551s
	iters: 400, epoch: 8 | loss: 0.0258114
	speed: 0.7404s/iter; left time: 7690.9998s
Epoch: 8 cost time: 344.4204261302948
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0082848
	speed: 2.8521s/iter; left time: 29145.4420s
	iters: 200, epoch: 9 | loss: 0.0015408
	speed: 0.7590s/iter; left time: 7679.9124s
	iters: 300, epoch: 9 | loss: 0.1057144
	speed: 0.7455s/iter; left time: 7468.6864s
	iters: 400, epoch: 9 | loss: 0.0013392
	speed: 0.7211s/iter; left time: 7152.1818s
Epoch: 9 cost time: 346.93368577957153
Epoch: 9, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0043575
	speed: 2.6179s/iter; left time: 25524.2415s
	iters: 200, epoch: 10 | loss: 0.0017720
	speed: 0.7482s/iter; left time: 7219.9635s
	iters: 300, epoch: 10 | loss: 0.0082403
	speed: 0.7446s/iter; left time: 7110.7185s
	iters: 400, epoch: 10 | loss: 0.0013013
	speed: 0.7379s/iter; left time: 6972.9237s
Epoch: 10 cost time: 346.81217312812805
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0002746
	speed: 2.5844s/iter; left time: 23986.0867s
	iters: 200, epoch: 11 | loss: 0.0003662
	speed: 0.7123s/iter; left time: 6539.2170s
	iters: 300, epoch: 11 | loss: 0.0731086
	speed: 0.7391s/iter; left time: 6712.1194s
	iters: 400, epoch: 11 | loss: 0.0088330
	speed: 0.7148s/iter; left time: 6419.9340s
Epoch: 11 cost time: 336.45586609840393
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0003320
	speed: 2.6678s/iter; left time: 23508.8215s
	iters: 200, epoch: 12 | loss: 0.0006886
	speed: 0.7106s/iter; left time: 6190.4424s
	iters: 300, epoch: 12 | loss: 0.0001818
	speed: 0.6545s/iter; left time: 5636.7343s
	iters: 400, epoch: 12 | loss: 0.0008529
	speed: 0.6862s/iter; left time: 5840.8893s
Epoch: 12 cost time: 325.0604238510132
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0003001
	speed: 2.5277s/iter; left time: 21088.8574s
	iters: 200, epoch: 13 | loss: 0.0011261
	speed: 0.6759s/iter; left time: 5571.1528s
	iters: 300, epoch: 13 | loss: 0.0062021
	speed: 0.6721s/iter; left time: 5472.7052s
	iters: 400, epoch: 13 | loss: 0.0004046
	speed: 0.6773s/iter; left time: 5447.7694s
Epoch: 13 cost time: 311.292578458786
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0282166
	speed: 2.3672s/iter; left time: 18639.0417s
	iters: 200, epoch: 14 | loss: 0.0047333
	speed: 0.6533s/iter; left time: 5078.8934s
	iters: 300, epoch: 14 | loss: 0.0043474
	speed: 0.6774s/iter; left time: 5198.7008s
	iters: 400, epoch: 14 | loss: 0.0045364
	speed: 0.6563s/iter; left time: 4970.8865s
Epoch: 14 cost time: 312.25172758102417
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0003080
	speed: 2.3735s/iter; left time: 17575.7066s
	iters: 200, epoch: 15 | loss: 0.0005389
	speed: 0.7083s/iter; left time: 5174.0608s
	iters: 300, epoch: 15 | loss: 0.0009377
	speed: 0.6966s/iter; left time: 5019.3152s
	iters: 400, epoch: 15 | loss: 0.0010689
	speed: 0.7507s/iter; left time: 5333.5769s
Epoch: 15 cost time: 334.3664798736572
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0002283
	speed: 2.8445s/iter; left time: 19729.3443s
	iters: 200, epoch: 16 | loss: 0.4922013
	speed: 0.7694s/iter; left time: 5259.8555s
	iters: 300, epoch: 16 | loss: 0.0026078
	speed: 0.7324s/iter; left time: 4933.6440s
	iters: 400, epoch: 16 | loss: 0.0028526
	speed: 0.7085s/iter; left time: 4701.5108s
Epoch: 16 cost time: 353.2158372402191
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0022145
	speed: 2.7287s/iter; left time: 17646.5617s
	iters: 200, epoch: 17 | loss: 0.0012967
	speed: 0.7130s/iter; left time: 4539.5978s
	iters: 300, epoch: 17 | loss: 0.0027535
	speed: 0.7295s/iter; left time: 4571.5847s
	iters: 400, epoch: 17 | loss: 0.0020766
	speed: 0.7212s/iter; left time: 4447.3507s
Epoch: 17 cost time: 337.8663833141327
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978558).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0003814
	speed: 2.5441s/iter; left time: 15259.4814s
	iters: 200, epoch: 18 | loss: 0.0024840
	speed: 0.7132s/iter; left time: 4206.2367s
	iters: 300, epoch: 18 | loss: 0.0004192
	speed: 0.6900s/iter; left time: 4000.9068s
	iters: 400, epoch: 18 | loss: 0.0879557
	speed: 0.6731s/iter; left time: 3835.6020s
Epoch: 18 cost time: 329.6899108886719
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0031929
	speed: 2.5297s/iter; left time: 13986.8423s
	iters: 200, epoch: 19 | loss: 0.0007864
	speed: 0.6913s/iter; left time: 3753.0568s
	iters: 300, epoch: 19 | loss: 0.0008822
	speed: 0.6929s/iter; left time: 3692.2870s
	iters: 400, epoch: 19 | loss: 0.0004671
	speed: 0.7262s/iter; left time: 3797.1160s
Epoch: 19 cost time: 331.6485164165497
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0023004
	speed: 2.4043s/iter; left time: 12165.7900s
	iters: 200, epoch: 20 | loss: 0.0066163
	speed: 0.7267s/iter; left time: 3604.3909s
	iters: 300, epoch: 20 | loss: 0.0006468
	speed: 0.7297s/iter; left time: 3546.2320s
	iters: 400, epoch: 20 | loss: 0.0011752
	speed: 0.6516s/iter; left time: 3101.8437s
Epoch: 20 cost time: 322.59040546417236
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.981417).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000787
	speed: 2.2484s/iter; left time: 10322.5540s
	iters: 200, epoch: 21 | loss: 0.0337197
	speed: 0.5740s/iter; left time: 2577.8923s
	iters: 300, epoch: 21 | loss: 0.0002397
	speed: 0.6031s/iter; left time: 2648.1068s
	iters: 400, epoch: 21 | loss: 0.0004699
	speed: 0.6196s/iter; left time: 2658.8648s
Epoch: 21 cost time: 281.8734679222107
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0193016
	speed: 2.2718s/iter; left time: 9364.5352s
	iters: 200, epoch: 22 | loss: 0.0002515
	speed: 0.5930s/iter; left time: 2385.0629s
	iters: 300, epoch: 22 | loss: 0.1885585
	speed: 0.6414s/iter; left time: 2515.6965s
	iters: 400, epoch: 22 | loss: 0.0003209
	speed: 0.7183s/iter; left time: 2745.4445s
Epoch: 22 cost time: 300.66057896614075
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0001964
	speed: 2.3633s/iter; left time: 8633.2641s
	iters: 200, epoch: 23 | loss: 0.0000825
	speed: 0.6691s/iter; left time: 2377.2105s
	iters: 300, epoch: 23 | loss: 0.0002024
	speed: 0.6608s/iter; left time: 2281.7012s
	iters: 400, epoch: 23 | loss: 0.0053827
	speed: 0.6640s/iter; left time: 2226.5461s
Epoch: 23 cost time: 311.65123558044434
Epoch: 23, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000789
	speed: 2.4067s/iter; left time: 7662.8107s
	iters: 200, epoch: 24 | loss: 0.0000121
	speed: 0.6477s/iter; left time: 1997.4214s
	iters: 300, epoch: 24 | loss: 0.0238876
	speed: 0.6373s/iter; left time: 1901.7308s
	iters: 400, epoch: 24 | loss: 0.0040687
	speed: 0.6636s/iter; left time: 1913.7116s
Epoch: 24 cost time: 306.8537805080414
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0005046
	speed: 2.4868s/iter; left time: 6751.6042s
	iters: 200, epoch: 25 | loss: 0.0023152
	speed: 0.8488s/iter; left time: 2219.5029s
	iters: 300, epoch: 25 | loss: 0.0000938
	speed: 0.8105s/iter; left time: 2038.3490s
	iters: 400, epoch: 25 | loss: 0.0001965
	speed: 0.8319s/iter; left time: 2008.9458s
Epoch: 25 cost time: 383.49407052993774
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0001093
	speed: 3.1166s/iter; left time: 6999.9420s
	iters: 200, epoch: 26 | loss: 0.0243087
	speed: 0.8626s/iter; left time: 1851.1162s
	iters: 300, epoch: 26 | loss: 0.0010526
	speed: 0.8397s/iter; left time: 1718.1175s
	iters: 400, epoch: 26 | loss: 0.0000860
	speed: 0.8576s/iter; left time: 1668.8947s
Epoch: 26 cost time: 403.09240221977234
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0001197
	speed: 3.1411s/iter; left time: 5581.6481s
	iters: 200, epoch: 27 | loss: 0.0005260
	speed: 0.8910s/iter; left time: 1494.2033s
	iters: 300, epoch: 27 | loss: 0.0004449
	speed: 0.8465s/iter; left time: 1334.8776s
	iters: 400, epoch: 27 | loss: 0.0005715
	speed: 0.8455s/iter; left time: 1248.8305s
Epoch: 27 cost time: 402.1910309791565
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0014558
	speed: 3.1445s/iter; left time: 4113.0400s
	iters: 200, epoch: 28 | loss: 0.0012245
	speed: 0.8335s/iter; left time: 1006.8753s
	iters: 300, epoch: 28 | loss: 0.0004667
	speed: 0.8007s/iter; left time: 887.1541s
	iters: 400, epoch: 28 | loss: 0.0005232
	speed: 0.8070s/iter; left time: 813.4584s
Epoch: 28 cost time: 388.0721399784088
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0022910
	speed: 3.1417s/iter; left time: 2635.8845s
	iters: 200, epoch: 29 | loss: 0.0001258
	speed: 0.8291s/iter; left time: 612.7135s
	iters: 300, epoch: 29 | loss: 0.4851978
	speed: 0.8279s/iter; left time: 529.0183s
	iters: 400, epoch: 29 | loss: 0.0005353
	speed: 0.8427s/iter; left time: 454.2412s
Epoch: 29 cost time: 395.277813911438
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0002111
	speed: 3.1398s/iter; left time: 1161.7127s
	iters: 200, epoch: 30 | loss: 0.0011010
	speed: 0.7838s/iter; left time: 211.6266s
	iters: 300, epoch: 30 | loss: 0.0111103
	speed: 0.7793s/iter; left time: 132.4742s
	iters: 400, epoch: 30 | loss: 0.0485153
	speed: 0.7923s/iter; left time: 55.4593s
Epoch: 30 cost time: 374.08989667892456
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 37500170
model size : 144.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6227323
	speed: 0.3454s/iter; left time: 4826.2284s
	iters: 200, epoch: 1 | loss: 0.2174390
	speed: 0.3258s/iter; left time: 4519.7346s
	iters: 300, epoch: 1 | loss: 0.0806924
	speed: 0.3260s/iter; left time: 4488.7832s
	iters: 400, epoch: 1 | loss: 0.0286400
	speed: 0.3260s/iter; left time: 4456.3254s
Epoch: 1 cost time: 155.78854417800903
Epoch: 1, Steps: 469 | Train Loss: 0.398 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
Validation loss decreased (inf --> -0.939106).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0847934
	speed: 1.4278s/iter; left time: 19278.3555s
	iters: 200, epoch: 2 | loss: 0.0262283
	speed: 0.3491s/iter; left time: 4678.8838s
	iters: 300, epoch: 2 | loss: 0.0554631
	speed: 0.3485s/iter; left time: 4635.2214s
	iters: 400, epoch: 2 | loss: 0.0055678
	speed: 0.3446s/iter; left time: 4549.1222s
Epoch: 2 cost time: 162.36915612220764
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.137 Vali Acc: 0.953 Test Loss: 0.137 Test Acc: 0.953
Validation loss decreased (-0.939106 --> -0.953115).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0057482
	speed: 1.3727s/iter; left time: 17890.3649s
	iters: 200, epoch: 3 | loss: 0.0029765
	speed: 0.3239s/iter; left time: 4189.4404s
	iters: 300, epoch: 3 | loss: 0.0252871
	speed: 0.3306s/iter; left time: 4242.7616s
	iters: 400, epoch: 3 | loss: 0.0074013
	speed: 0.3281s/iter; left time: 4178.1784s
Epoch: 3 cost time: 155.06849765777588
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.953115 --> -0.957689).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0136701
	speed: 1.4180s/iter; left time: 17816.0726s
	iters: 200, epoch: 4 | loss: 0.0132238
	speed: 0.3093s/iter; left time: 3855.1981s
	iters: 300, epoch: 4 | loss: 0.0352819
	speed: 0.3228s/iter; left time: 3990.6753s
	iters: 400, epoch: 4 | loss: 0.0231453
	speed: 0.3270s/iter; left time: 4009.7422s
Epoch: 4 cost time: 152.98904490470886
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (-0.957689 --> -0.963978).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1326659
	speed: 1.3026s/iter; left time: 15754.4776s
	iters: 200, epoch: 5 | loss: 0.0024299
	speed: 0.3193s/iter; left time: 3830.5455s
	iters: 300, epoch: 5 | loss: 0.0013443
	speed: 0.3143s/iter; left time: 3738.0598s
	iters: 400, epoch: 5 | loss: 0.0011394
	speed: 0.3124s/iter; left time: 3684.5234s
Epoch: 5 cost time: 148.9034721851349
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
Validation loss decreased (-0.963978 --> -0.965693).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0023360
	speed: 1.3225s/iter; left time: 15375.7886s
	iters: 200, epoch: 6 | loss: 0.0089444
	speed: 0.3153s/iter; left time: 3634.6595s
	iters: 300, epoch: 6 | loss: 0.0014107
	speed: 0.3273s/iter; left time: 3740.0718s
	iters: 400, epoch: 6 | loss: 0.0105840
	speed: 0.3271s/iter; left time: 3704.6660s
Epoch: 6 cost time: 151.9506697654724
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0017260
	speed: 1.3324s/iter; left time: 14865.3839s
	iters: 200, epoch: 7 | loss: 0.0005683
	speed: 0.3360s/iter; left time: 3715.5338s
	iters: 300, epoch: 7 | loss: 0.0055663
	speed: 0.3330s/iter; left time: 3648.4874s
	iters: 400, epoch: 7 | loss: 0.0096486
	speed: 0.3181s/iter; left time: 3453.3332s
Epoch: 7 cost time: 154.23737812042236
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.965693 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0213912
	speed: 1.3578s/iter; left time: 14512.0667s
	iters: 200, epoch: 8 | loss: 0.0011424
	speed: 0.3359s/iter; left time: 3556.5545s
	iters: 300, epoch: 8 | loss: 0.0029928
	speed: 0.3420s/iter; left time: 3586.5489s
	iters: 400, epoch: 8 | loss: 0.0019626
	speed: 0.3441s/iter; left time: 3574.8275s
Epoch: 8 cost time: 158.7751772403717
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978844).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0045798
	speed: 1.3727s/iter; left time: 14027.3004s
	iters: 200, epoch: 9 | loss: 0.3336347
	speed: 0.3266s/iter; left time: 3304.8153s
	iters: 300, epoch: 9 | loss: 0.1291624
	speed: 0.3234s/iter; left time: 3239.7517s
	iters: 400, epoch: 9 | loss: 0.0016206
	speed: 0.3214s/iter; left time: 3187.6781s
Epoch: 9 cost time: 151.70007157325745
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0013455
	speed: 1.3735s/iter; left time: 13391.4326s
	iters: 200, epoch: 10 | loss: 0.0022347
	speed: 0.3062s/iter; left time: 2954.7470s
	iters: 300, epoch: 10 | loss: 0.0076976
	speed: 0.3234s/iter; left time: 3088.1929s
	iters: 400, epoch: 10 | loss: 0.0007786
	speed: 0.3240s/iter; left time: 3061.4657s
Epoch: 10 cost time: 150.444030046463
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1670517
	speed: 1.2913s/iter; left time: 11984.5575s
	iters: 200, epoch: 11 | loss: 0.0019322
	speed: 0.2958s/iter; left time: 2715.9640s
	iters: 300, epoch: 11 | loss: 0.0002621
	speed: 0.3073s/iter; left time: 2790.3950s
	iters: 400, epoch: 11 | loss: 0.0005012
	speed: 0.3056s/iter; left time: 2744.3251s
Epoch: 11 cost time: 144.6568968296051
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0032717
	speed: 1.3428s/iter; left time: 11833.1495s
	iters: 200, epoch: 12 | loss: 0.0009643
	speed: 0.3109s/iter; left time: 2708.5434s
	iters: 300, epoch: 12 | loss: 0.0664842
	speed: 0.3030s/iter; left time: 2609.5404s
	iters: 400, epoch: 12 | loss: 0.0004307
	speed: 0.3151s/iter; left time: 2682.3726s
Epoch: 12 cost time: 146.5161988735199
Epoch: 12, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0331706
	speed: 1.2853s/iter; left time: 10723.2315s
	iters: 200, epoch: 13 | loss: 0.0001045
	speed: 0.3050s/iter; left time: 2514.2095s
	iters: 300, epoch: 13 | loss: 0.0052098
	speed: 0.3195s/iter; left time: 2602.0590s
	iters: 400, epoch: 13 | loss: 0.0006808
	speed: 0.3314s/iter; left time: 2665.1434s
Epoch: 13 cost time: 149.4053406715393
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0224376
	speed: 1.3641s/iter; left time: 10740.5344s
	iters: 200, epoch: 14 | loss: 0.0017890
	speed: 0.3136s/iter; left time: 2438.2877s
	iters: 300, epoch: 14 | loss: 0.0019055
	speed: 0.3177s/iter; left time: 2438.2089s
	iters: 400, epoch: 14 | loss: 0.0042869
	speed: 0.3088s/iter; left time: 2339.0104s
Epoch: 14 cost time: 147.2622938156128
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0013777
	speed: 1.2483s/iter; left time: 9243.5649s
	iters: 200, epoch: 15 | loss: 0.0021845
	speed: 0.3013s/iter; left time: 2200.7591s
	iters: 300, epoch: 15 | loss: 0.0008520
	speed: 0.3014s/iter; left time: 2171.2427s
	iters: 400, epoch: 15 | loss: 0.0002617
	speed: 0.3167s/iter; left time: 2250.2974s
Epoch: 15 cost time: 144.42693519592285
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0005467
	speed: 1.3049s/iter; left time: 9050.9477s
	iters: 200, epoch: 16 | loss: 0.0005819
	speed: 0.3029s/iter; left time: 2070.4617s
	iters: 300, epoch: 16 | loss: 0.0002806
	speed: 0.2798s/iter; left time: 1884.8156s
	iters: 400, epoch: 16 | loss: 0.0010787
	speed: 0.2936s/iter; left time: 1948.5323s
Epoch: 16 cost time: 138.7910704612732
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.981989).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0110797
	speed: 1.2902s/iter; left time: 8343.8760s
	iters: 200, epoch: 17 | loss: 0.0000926
	speed: 0.3332s/iter; left time: 2121.3878s
	iters: 300, epoch: 17 | loss: 0.0001699
	speed: 0.3408s/iter; left time: 2135.8316s
	iters: 400, epoch: 17 | loss: 0.0004686
	speed: 0.3467s/iter; left time: 2138.1368s
Epoch: 17 cost time: 158.37741041183472
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0003271
	speed: 1.4256s/iter; left time: 8550.7667s
	iters: 200, epoch: 18 | loss: 0.0003646
	speed: 0.3366s/iter; left time: 1985.1865s
	iters: 300, epoch: 18 | loss: 0.0001606
	speed: 0.3277s/iter; left time: 1899.9125s
	iters: 400, epoch: 18 | loss: 0.0005855
	speed: 0.3161s/iter; left time: 1801.2668s
Epoch: 18 cost time: 151.7771155834198
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0206554
	speed: 1.3037s/iter; left time: 7208.2394s
	iters: 200, epoch: 19 | loss: 0.0001129
	speed: 0.3313s/iter; left time: 1798.7986s
	iters: 300, epoch: 19 | loss: 0.0005913
	speed: 0.3391s/iter; left time: 1806.9868s
	iters: 400, epoch: 19 | loss: 0.0067084
	speed: 0.3385s/iter; left time: 1770.2643s
Epoch: 19 cost time: 157.1325614452362
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0011914
	speed: 1.4183s/iter; left time: 7176.4063s
	iters: 200, epoch: 20 | loss: 0.0003676
	speed: 0.3315s/iter; left time: 1644.3249s
	iters: 300, epoch: 20 | loss: 0.0002485
	speed: 0.3337s/iter; left time: 1621.6518s
	iters: 400, epoch: 20 | loss: 0.0003005
	speed: 0.3282s/iter; left time: 1562.0246s
Epoch: 20 cost time: 156.42719507217407
Epoch: 20, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0002127
	speed: 1.3048s/iter; left time: 5990.3004s
	iters: 200, epoch: 21 | loss: 0.0166224
	speed: 0.3194s/iter; left time: 1434.3647s
	iters: 300, epoch: 21 | loss: 0.0003017
	speed: 0.3139s/iter; left time: 1378.4193s
	iters: 400, epoch: 21 | loss: 0.0002081
	speed: 0.3255s/iter; left time: 1396.7526s
Epoch: 21 cost time: 149.49820160865784
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0097346
	speed: 1.3468s/iter; left time: 5551.4163s
	iters: 200, epoch: 22 | loss: 0.0002463
	speed: 0.3189s/iter; left time: 1282.7400s
	iters: 300, epoch: 22 | loss: 0.0000828
	speed: 0.3145s/iter; left time: 1233.4216s
	iters: 400, epoch: 22 | loss: 0.0003485
	speed: 0.3078s/iter; left time: 1176.5609s
Epoch: 22 cost time: 147.51014852523804
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0007058
	speed: 1.2932s/iter; left time: 4723.9024s
	iters: 200, epoch: 23 | loss: 0.0048777
	speed: 0.3210s/iter; left time: 1140.6203s
	iters: 300, epoch: 23 | loss: 0.0020595
	speed: 0.3270s/iter; left time: 1129.2316s
	iters: 400, epoch: 23 | loss: 0.0019592
	speed: 0.3290s/iter; left time: 1102.9727s
Epoch: 23 cost time: 151.30907893180847
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0002215
	speed: 1.3371s/iter; left time: 4257.3454s
	iters: 200, epoch: 24 | loss: 0.0512390
	speed: 0.3239s/iter; left time: 998.7918s
	iters: 300, epoch: 24 | loss: 0.0001276
	speed: 0.3213s/iter; left time: 958.8630s
	iters: 400, epoch: 24 | loss: 0.0003380
	speed: 0.3212s/iter; left time: 926.2244s
Epoch: 24 cost time: 151.26067280769348
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0001401
	speed: 1.3762s/iter; left time: 3736.3374s
	iters: 200, epoch: 25 | loss: 0.0002337
	speed: 0.3370s/iter; left time: 881.2443s
	iters: 300, epoch: 25 | loss: 0.0627539
	speed: 0.3396s/iter; left time: 854.0477s
	iters: 400, epoch: 25 | loss: 0.0003652
	speed: 0.3316s/iter; left time: 800.8616s
Epoch: 25 cost time: 156.4706585407257
Epoch: 25, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0036571
	speed: 1.2751s/iter; left time: 2863.8066s
	iters: 200, epoch: 26 | loss: 0.0005502
	speed: 0.3225s/iter; left time: 692.1596s
	iters: 300, epoch: 26 | loss: 0.0030259
	speed: 0.3275s/iter; left time: 670.0555s
	iters: 400, epoch: 26 | loss: 0.0014548
	speed: 0.3270s/iter; left time: 636.3415s
Epoch: 26 cost time: 153.62140250205994
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 11021066
model size : 43.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5596668
	speed: 0.5043s/iter; left time: 7045.1921s
	iters: 200, epoch: 1 | loss: 0.3133882
	speed: 0.4839s/iter; left time: 6712.7284s
	iters: 300, epoch: 1 | loss: 0.0845120
	speed: 0.4762s/iter; left time: 6557.4878s
	iters: 400, epoch: 1 | loss: 0.0689320
	speed: 0.4844s/iter; left time: 6621.5974s
Epoch: 1 cost time: 228.26935458183289
Epoch: 1, Steps: 469 | Train Loss: 0.443 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (inf --> -0.953686).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0753094
	speed: 1.9247s/iter; left time: 25987.0036s
	iters: 200, epoch: 2 | loss: 0.0158516
	speed: 0.4994s/iter; left time: 6693.0139s
	iters: 300, epoch: 2 | loss: 0.0076183
	speed: 0.4772s/iter; left time: 6347.6137s
	iters: 400, epoch: 2 | loss: 0.1335774
	speed: 0.4953s/iter; left time: 6538.9707s
Epoch: 2 cost time: 231.9158444404602
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.953686 --> -0.976271).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0727247
	speed: 1.9075s/iter; left time: 24861.0522s
	iters: 200, epoch: 3 | loss: 0.0710115
	speed: 0.5146s/iter; left time: 6655.8402s
	iters: 300, epoch: 3 | loss: 0.0910302
	speed: 0.5192s/iter; left time: 6662.9963s
	iters: 400, epoch: 3 | loss: 0.0034534
	speed: 0.5206s/iter; left time: 6629.3039s
Epoch: 3 cost time: 242.48341870307922
Epoch: 3, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0045112
	speed: 1.9014s/iter; left time: 23889.3541s
	iters: 200, epoch: 4 | loss: 0.0195690
	speed: 0.4567s/iter; left time: 5692.7953s
	iters: 300, epoch: 4 | loss: 0.0034331
	speed: 0.4794s/iter; left time: 5927.6324s
	iters: 400, epoch: 4 | loss: 0.0107449
	speed: 0.4953s/iter; left time: 6073.9407s
Epoch: 4 cost time: 226.64640974998474
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0230483
	speed: 1.8753s/iter; left time: 22681.5520s
	iters: 200, epoch: 5 | loss: 0.0010457
	speed: 0.4814s/iter; left time: 5774.5386s
	iters: 300, epoch: 5 | loss: 0.0082263
	speed: 0.4602s/iter; left time: 5473.9135s
	iters: 400, epoch: 5 | loss: 0.0035190
	speed: 0.4950s/iter; left time: 5838.4688s
Epoch: 5 cost time: 227.1930112838745
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0022058
	speed: 1.9960s/iter; left time: 23205.1779s
	iters: 200, epoch: 6 | loss: 0.0329757
	speed: 0.5201s/iter; left time: 5995.1677s
	iters: 300, epoch: 6 | loss: 0.0028320
	speed: 0.5138s/iter; left time: 5871.0132s
	iters: 400, epoch: 6 | loss: 0.1980647
	speed: 0.5005s/iter; left time: 5668.9845s
Epoch: 6 cost time: 241.81198954582214
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0013022
	speed: 1.8343s/iter; left time: 20465.2387s
	iters: 200, epoch: 7 | loss: 0.1633205
	speed: 0.4922s/iter; left time: 5442.4849s
	iters: 300, epoch: 7 | loss: 0.0015518
	speed: 0.4951s/iter; left time: 5424.7487s
	iters: 400, epoch: 7 | loss: 0.0009683
	speed: 0.4836s/iter; left time: 5250.1514s
Epoch: 7 cost time: 222.06239700317383
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0939721
	speed: 1.8254s/iter; left time: 19510.0527s
	iters: 200, epoch: 8 | loss: 0.0020420
	speed: 0.4862s/iter; left time: 5147.6891s
	iters: 300, epoch: 8 | loss: 0.0003649
	speed: 0.4630s/iter; left time: 4856.3226s
	iters: 400, epoch: 8 | loss: 0.0178382
	speed: 0.4467s/iter; left time: 4640.3636s
Epoch: 8 cost time: 223.61765956878662
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0014180
	speed: 1.8851s/iter; left time: 19263.8608s
	iters: 200, epoch: 9 | loss: 0.0045082
	speed: 0.4859s/iter; left time: 4916.6976s
	iters: 300, epoch: 9 | loss: 0.0108329
	speed: 0.4882s/iter; left time: 4891.6663s
	iters: 400, epoch: 9 | loss: 0.0042834
	speed: 0.5232s/iter; left time: 5189.8245s
Epoch: 9 cost time: 234.16428875923157
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0037045
	speed: 1.7577s/iter; left time: 17137.0996s
	iters: 200, epoch: 10 | loss: 0.0052208
	speed: 0.4767s/iter; left time: 4600.1548s
	iters: 300, epoch: 10 | loss: 0.0100754
	speed: 0.4817s/iter; left time: 4600.4440s
	iters: 400, epoch: 10 | loss: 0.0014417
	speed: 0.4613s/iter; left time: 4359.0060s
Epoch: 10 cost time: 219.03903436660767
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0008694
	speed: 1.7784s/iter; left time: 16505.2414s
	iters: 200, epoch: 11 | loss: 0.0012816
	speed: 0.4711s/iter; left time: 4325.4684s
	iters: 300, epoch: 11 | loss: 0.1289110
	speed: 0.4529s/iter; left time: 4112.4638s
	iters: 400, epoch: 11 | loss: 0.0006856
	speed: 0.4595s/iter; left time: 4126.9490s
Epoch: 11 cost time: 216.72188925743103
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0053247
	speed: 1.7918s/iter; left time: 15789.4118s
	iters: 200, epoch: 12 | loss: 0.0007910
	speed: 0.4223s/iter; left time: 3679.0199s
	iters: 300, epoch: 12 | loss: 0.0003968
	speed: 0.4639s/iter; left time: 3995.2163s
	iters: 400, epoch: 12 | loss: 0.0007480
	speed: 0.4670s/iter; left time: 3975.3052s
Epoch: 12 cost time: 211.62058448791504
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9762721555174385
model parameter : 37500170
model size : 144.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8208975
	speed: 0.2177s/iter; left time: 3041.2208s
	iters: 200, epoch: 1 | loss: 0.2825214
	speed: 0.1805s/iter; left time: 2503.4761s
	iters: 300, epoch: 1 | loss: 0.1609127
	speed: 0.1985s/iter; left time: 2733.4380s
	iters: 400, epoch: 1 | loss: 0.0678743
	speed: 0.2045s/iter; left time: 2795.7284s
Epoch: 1 cost time: 94.76493835449219
Epoch: 1, Steps: 469 | Train Loss: 0.473 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (inf --> -0.943109).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0681019
	speed: 0.9390s/iter; left time: 12677.7272s
	iters: 200, epoch: 2 | loss: 0.0225829
	speed: 0.2217s/iter; left time: 2971.4005s
	iters: 300, epoch: 2 | loss: 0.1014034
	speed: 0.2138s/iter; left time: 2843.7554s
	iters: 400, epoch: 2 | loss: 0.0423294
	speed: 0.2257s/iter; left time: 2979.2723s
Epoch: 2 cost time: 104.1271665096283
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.127 Vali Acc: 0.958 Test Loss: 0.127 Test Acc: 0.958
Validation loss decreased (-0.943109 --> -0.957975).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0033560
	speed: 0.9494s/iter; left time: 12373.3900s
	iters: 200, epoch: 3 | loss: 0.0229366
	speed: 0.2075s/iter; left time: 2683.5064s
	iters: 300, epoch: 3 | loss: 0.1145467
	speed: 0.2042s/iter; left time: 2620.6129s
	iters: 400, epoch: 3 | loss: 0.0156602
	speed: 0.2192s/iter; left time: 2790.5062s
Epoch: 3 cost time: 99.0374755859375
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.957975 --> -0.967981).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2697329
	speed: 0.9505s/iter; left time: 11942.5805s
	iters: 200, epoch: 4 | loss: 0.0039288
	speed: 0.2003s/iter; left time: 2496.9506s
	iters: 300, epoch: 4 | loss: 0.6860424
	speed: 0.1705s/iter; left time: 2108.0998s
	iters: 400, epoch: 4 | loss: 0.0168278
	speed: 0.1790s/iter; left time: 2195.8640s
Epoch: 4 cost time: 88.51469898223877
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0044093
	speed: 0.8816s/iter; left time: 10663.1445s
	iters: 200, epoch: 5 | loss: 0.1457054
	speed: 0.2038s/iter; left time: 2444.0242s
	iters: 300, epoch: 5 | loss: 0.0006617
	speed: 0.1939s/iter; left time: 2306.0327s
	iters: 400, epoch: 5 | loss: 0.1900507
	speed: 0.1857s/iter; left time: 2189.9053s
Epoch: 5 cost time: 90.8952705860138
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.967981 --> -0.983704).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018298
	speed: 0.8400s/iter; left time: 9766.3663s
	iters: 200, epoch: 6 | loss: 0.0016953
	speed: 0.2051s/iter; left time: 2364.1823s
	iters: 300, epoch: 6 | loss: 0.3889641
	speed: 0.2066s/iter; left time: 2360.7849s
	iters: 400, epoch: 6 | loss: 0.0093455
	speed: 0.2034s/iter; left time: 2303.9927s
Epoch: 6 cost time: 95.22934937477112
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2743309
	speed: 0.8018s/iter; left time: 8945.8545s
	iters: 200, epoch: 7 | loss: 0.0010177
	speed: 0.1936s/iter; left time: 2141.0427s
	iters: 300, epoch: 7 | loss: 0.1002644
	speed: 0.2187s/iter; left time: 2396.7751s
	iters: 400, epoch: 7 | loss: 0.0214642
	speed: 0.2126s/iter; left time: 2308.1715s
Epoch: 7 cost time: 96.67170357704163
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0005111
	speed: 0.8318s/iter; left time: 8890.1596s
	iters: 200, epoch: 8 | loss: 0.0022920
	speed: 0.1905s/iter; left time: 2016.8775s
	iters: 300, epoch: 8 | loss: 0.0136820
	speed: 0.1898s/iter; left time: 1990.6744s
	iters: 400, epoch: 8 | loss: 0.0734484
	speed: 0.2026s/iter; left time: 2104.7432s
Epoch: 8 cost time: 91.75306344032288
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0004643
	speed: 0.9311s/iter; left time: 9514.5621s
	iters: 200, epoch: 9 | loss: 0.0025501
	speed: 0.1791s/iter; left time: 1812.5819s
	iters: 300, epoch: 9 | loss: 0.0337533
	speed: 0.1784s/iter; left time: 1787.3004s
	iters: 400, epoch: 9 | loss: 0.0009133
	speed: 0.1662s/iter; left time: 1648.2514s
Epoch: 9 cost time: 84.58105421066284
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0027005
	speed: 0.8284s/iter; left time: 8076.5539s
	iters: 200, epoch: 10 | loss: 0.0015089
	speed: 0.1634s/iter; left time: 1576.7383s
	iters: 300, epoch: 10 | loss: 0.0135300
	speed: 0.1768s/iter; left time: 1688.3894s
	iters: 400, epoch: 10 | loss: 0.0087362
	speed: 0.1918s/iter; left time: 1812.2545s
Epoch: 10 cost time: 86.96130800247192
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0013387
	speed: 0.9512s/iter; left time: 8827.7255s
	iters: 200, epoch: 11 | loss: 0.0012443
	speed: 0.2141s/iter; left time: 1965.9870s
	iters: 300, epoch: 11 | loss: 0.0006859
	speed: 0.2094s/iter; left time: 1902.0034s
	iters: 400, epoch: 11 | loss: 0.0053610
	speed: 0.2088s/iter; left time: 1875.5862s
Epoch: 11 cost time: 99.80765128135681
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0031789
	speed: 0.9203s/iter; left time: 8109.8233s
	iters: 200, epoch: 12 | loss: 0.0175695
	speed: 0.2171s/iter; left time: 1891.1187s
	iters: 300, epoch: 12 | loss: 0.0181605
	speed: 0.2188s/iter; left time: 1884.6035s
	iters: 400, epoch: 12 | loss: 0.0014082
	speed: 0.2145s/iter; left time: 1825.5695s
Epoch: 12 cost time: 101.07540154457092
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0030429
	speed: 0.9377s/iter; left time: 7823.4728s
	iters: 200, epoch: 13 | loss: 0.0033899
	speed: 0.2207s/iter; left time: 1819.1640s
	iters: 300, epoch: 13 | loss: 0.0243392
	speed: 0.2195s/iter; left time: 1787.2297s
	iters: 400, epoch: 13 | loss: 0.0010898
	speed: 0.2242s/iter; left time: 1803.4408s
Epoch: 13 cost time: 103.72184491157532
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0037241
	speed: 0.9220s/iter; left time: 7259.5765s
	iters: 200, epoch: 14 | loss: 0.0002405
	speed: 0.1925s/iter; left time: 1496.3374s
	iters: 300, epoch: 14 | loss: 0.0025771
	speed: 0.2014s/iter; left time: 1545.8583s
	iters: 400, epoch: 14 | loss: 0.0001381
	speed: 0.2004s/iter; left time: 1517.7385s
Epoch: 14 cost time: 93.45373582839966
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0051460
	speed: 0.8853s/iter; left time: 6555.4705s
	iters: 200, epoch: 15 | loss: 0.0005927
	speed: 0.1928s/iter; left time: 1408.5495s
	iters: 300, epoch: 15 | loss: 0.0000432
	speed: 0.1951s/iter; left time: 1405.6906s
	iters: 400, epoch: 15 | loss: 0.0006177
	speed: 0.1721s/iter; left time: 1222.6863s
Epoch: 15 cost time: 87.20575642585754
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 11021066
model size : 43.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4725439
	speed: 0.8759s/iter; left time: 12236.8979s
	iters: 200, epoch: 1 | loss: 0.4193150
	speed: 0.8840s/iter; left time: 12262.5611s
	iters: 300, epoch: 1 | loss: 0.0503252
	speed: 0.8614s/iter; left time: 11862.4244s
	iters: 400, epoch: 1 | loss: 0.0634314
	speed: 0.8971s/iter; left time: 12264.4243s
Epoch: 1 cost time: 414.6250219345093
Epoch: 1, Steps: 469 | Train Loss: 0.413 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (inf --> -0.967409).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0100724
	speed: 2.9563s/iter; left time: 39916.5002s
	iters: 200, epoch: 2 | loss: 0.0738958
	speed: 0.8491s/iter; left time: 11379.2586s
	iters: 300, epoch: 2 | loss: 0.0044585
	speed: 0.8547s/iter; left time: 11368.7572s
	iters: 400, epoch: 2 | loss: 0.0452150
	speed: 0.8070s/iter; left time: 10653.4225s
Epoch: 2 cost time: 389.6645579338074
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0131686
	speed: 2.7161s/iter; left time: 35398.5680s
	iters: 200, epoch: 3 | loss: 0.2775333
	speed: 0.8219s/iter; left time: 10629.1059s
	iters: 300, epoch: 3 | loss: 0.1610837
	speed: 0.8274s/iter; left time: 10618.1941s
	iters: 400, epoch: 3 | loss: 0.0282654
	speed: 0.8696s/iter; left time: 11072.8928s
Epoch: 3 cost time: 395.7488126754761
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.967409 --> -0.975414).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4154955
	speed: 2.7670s/iter; left time: 34764.8386s
	iters: 200, epoch: 4 | loss: 0.0014547
	speed: 0.8235s/iter; left time: 10264.6291s
	iters: 300, epoch: 4 | loss: 0.0022040
	speed: 0.8204s/iter; left time: 10143.3415s
	iters: 400, epoch: 4 | loss: 0.0216552
	speed: 0.7629s/iter; left time: 9356.6376s
Epoch: 4 cost time: 374.18180871009827
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.447 Vali Acc: 0.893 Test Loss: 0.447 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2783875
	speed: 2.7162s/iter; left time: 32852.4356s
	iters: 200, epoch: 5 | loss: 0.0158626
	speed: 0.7796s/iter; left time: 9350.9105s
	iters: 300, epoch: 5 | loss: 0.0041371
	speed: 0.7812s/iter; left time: 9292.2674s
	iters: 400, epoch: 5 | loss: 0.0517491
	speed: 0.7937s/iter; left time: 9361.4469s
Epoch: 5 cost time: 368.516970872879
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1051996
	speed: 2.6758s/iter; left time: 31108.6005s
	iters: 200, epoch: 6 | loss: 0.0004642
	speed: 0.8605s/iter; left time: 9918.4535s
	iters: 300, epoch: 6 | loss: 0.0146826
	speed: 0.8469s/iter; left time: 9676.6683s
	iters: 400, epoch: 6 | loss: 0.0218093
	speed: 0.8225s/iter; left time: 9315.3634s
Epoch: 6 cost time: 393.4963662624359
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0523605
	speed: 2.6375s/iter; left time: 29426.4687s
	iters: 200, epoch: 7 | loss: 0.0240590
	speed: 0.7521s/iter; left time: 8316.2245s
	iters: 300, epoch: 7 | loss: 0.0036073
	speed: 0.7740s/iter; left time: 8480.6377s
	iters: 400, epoch: 7 | loss: 0.0016922
	speed: 0.7814s/iter; left time: 8483.2865s
Epoch: 7 cost time: 358.65658140182495
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975414 --> -0.976271).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0043457
	speed: 2.7481s/iter; left time: 29371.1947s
	iters: 200, epoch: 8 | loss: 0.0005203
	speed: 0.8188s/iter; left time: 8669.6628s
	iters: 300, epoch: 8 | loss: 0.0006412
	speed: 0.8219s/iter; left time: 8620.3188s
	iters: 400, epoch: 8 | loss: 0.0004987
	speed: 0.7326s/iter; left time: 7609.7990s
Epoch: 8 cost time: 374.61870789527893
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0006829
	speed: 2.6164s/iter; left time: 26736.7244s
	iters: 200, epoch: 9 | loss: 0.0013671
	speed: 0.7538s/iter; left time: 7627.6483s
	iters: 300, epoch: 9 | loss: 0.0075773
	speed: 0.7975s/iter; left time: 7989.9257s
	iters: 400, epoch: 9 | loss: 0.0011565
	speed: 0.7488s/iter; left time: 7426.9256s
Epoch: 9 cost time: 366.1657431125641
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0016165
	speed: 2.8348s/iter; left time: 27638.9466s
	iters: 200, epoch: 10 | loss: 0.0016215
	speed: 0.7896s/iter; left time: 7619.9903s
	iters: 300, epoch: 10 | loss: 0.0001639
	speed: 0.7665s/iter; left time: 7320.4974s
	iters: 400, epoch: 10 | loss: 0.0007124
	speed: 0.7847s/iter; left time: 7415.1548s
Epoch: 10 cost time: 374.8556799888611
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0293104
	speed: 2.8024s/iter; left time: 26008.8735s
	iters: 200, epoch: 11 | loss: 0.0015183
	speed: 0.8111s/iter; left time: 7446.9248s
	iters: 300, epoch: 11 | loss: 0.0033220
	speed: 0.8035s/iter; left time: 7296.9232s
	iters: 400, epoch: 11 | loss: 0.0026813
	speed: 0.7813s/iter; left time: 7016.8434s
Epoch: 11 cost time: 378.40050625801086
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.947 Test Loss: 0.186 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0011548
	speed: 2.7037s/iter; left time: 23825.0473s
	iters: 200, epoch: 12 | loss: 0.0016616
	speed: 0.8503s/iter; left time: 7407.4494s
	iters: 300, epoch: 12 | loss: 0.0002301
	speed: 0.7649s/iter; left time: 6587.4530s
	iters: 400, epoch: 12 | loss: 0.0132981
	speed: 0.8298s/iter; left time: 7063.1138s
Epoch: 12 cost time: 381.2663724422455
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0002252
	speed: 2.6560s/iter; left time: 22158.8434s
	iters: 200, epoch: 13 | loss: 0.0007628
	speed: 0.7715s/iter; left time: 6359.2856s
	iters: 300, epoch: 13 | loss: 0.0006499
	speed: 0.7473s/iter; left time: 6085.0710s
	iters: 400, epoch: 13 | loss: 0.0253580
	speed: 0.7969s/iter; left time: 6409.4120s
Epoch: 13 cost time: 359.0745487213135
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.981417).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0157992
	speed: 2.5874s/iter; left time: 20372.8135s
	iters: 200, epoch: 14 | loss: 0.0005327
	speed: 0.7720s/iter; left time: 6001.7624s
	iters: 300, epoch: 14 | loss: 0.0001342
	speed: 0.7948s/iter; left time: 6099.0142s
	iters: 400, epoch: 14 | loss: 0.0012765
	speed: 0.7476s/iter; left time: 5662.0879s
Epoch: 14 cost time: 366.9336533546448
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0007286
	speed: 2.8889s/iter; left time: 21392.3576s
	iters: 200, epoch: 15 | loss: 0.0003600
	speed: 0.8153s/iter; left time: 5955.6192s
	iters: 300, epoch: 15 | loss: 0.0004267
	speed: 0.8454s/iter; left time: 6090.8863s
	iters: 400, epoch: 15 | loss: 0.0004919
	speed: 0.8250s/iter; left time: 5861.9627s
Epoch: 15 cost time: 391.68280148506165
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000705
	speed: 2.6972s/iter; left time: 18707.9443s
	iters: 200, epoch: 16 | loss: 0.0000773
	speed: 0.8210s/iter; left time: 5612.4093s
	iters: 300, epoch: 16 | loss: 0.0001882
	speed: 0.8099s/iter; left time: 5455.3402s
	iters: 400, epoch: 16 | loss: 0.0023864
	speed: 0.8497s/iter; left time: 5638.6296s
Epoch: 16 cost time: 385.60328245162964
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0151157
	speed: 2.7701s/iter; left time: 17913.9436s
	iters: 200, epoch: 17 | loss: 0.0020579
	speed: 0.8118s/iter; left time: 5168.9793s
	iters: 300, epoch: 17 | loss: 0.0289365
	speed: 0.7518s/iter; left time: 4711.7682s
	iters: 400, epoch: 17 | loss: 0.0003098
	speed: 0.7866s/iter; left time: 4851.1057s
Epoch: 17 cost time: 365.47145199775696
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0721516
	speed: 2.6258s/iter; left time: 15749.7895s
	iters: 200, epoch: 18 | loss: 0.0016698
	speed: 0.7455s/iter; left time: 4396.9753s
	iters: 300, epoch: 18 | loss: 0.0007931
	speed: 0.7523s/iter; left time: 4362.0409s
	iters: 400, epoch: 18 | loss: 0.5470400
	speed: 0.8527s/iter; left time: 4858.6889s
Epoch: 18 cost time: 368.8465220928192
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981989).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0857463
	speed: 2.6992s/iter; left time: 14923.7772s
	iters: 200, epoch: 19 | loss: 0.0002103
	speed: 0.8223s/iter; left time: 4464.2227s
	iters: 300, epoch: 19 | loss: 0.0001730
	speed: 0.8275s/iter; left time: 4409.5509s
	iters: 400, epoch: 19 | loss: 0.0007858
	speed: 0.8331s/iter; left time: 4356.2586s
Epoch: 19 cost time: 388.72578620910645
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0926636
	speed: 2.7787s/iter; left time: 14060.1344s
	iters: 200, epoch: 20 | loss: 0.0070239
	speed: 0.7954s/iter; left time: 3945.2367s
	iters: 300, epoch: 20 | loss: 0.0034291
	speed: 0.7929s/iter; left time: 3853.3391s
	iters: 400, epoch: 20 | loss: 0.0058526
	speed: 0.8174s/iter; left time: 3890.6954s
Epoch: 20 cost time: 376.2617838382721
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0003112
	speed: 2.7494s/iter; left time: 12622.3212s
	iters: 200, epoch: 21 | loss: 0.0001521
	speed: 0.8730s/iter; left time: 3920.4660s
	iters: 300, epoch: 21 | loss: 0.0000468
	speed: 0.8468s/iter; left time: 3718.0997s
	iters: 400, epoch: 21 | loss: 0.0022640
	speed: 0.7902s/iter; left time: 3390.6625s
Epoch: 21 cost time: 389.7040865421295
Epoch: 21, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0003344
	speed: 2.6920s/iter; left time: 11096.5619s
	iters: 200, epoch: 22 | loss: 0.0097117
	speed: 0.7985s/iter; left time: 3211.6289s
	iters: 300, epoch: 22 | loss: 0.0005294
	speed: 0.8144s/iter; left time: 3194.0460s
	iters: 400, epoch: 22 | loss: 0.0047488
	speed: 0.8083s/iter; left time: 3089.4053s
Epoch: 22 cost time: 378.3963234424591
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000666
	speed: 2.7218s/iter; left time: 9942.6110s
	iters: 200, epoch: 23 | loss: 0.0052336
	speed: 0.8033s/iter; left time: 2854.1957s
	iters: 300, epoch: 23 | loss: 0.0006327
	speed: 0.8349s/iter; left time: 2882.8666s
	iters: 400, epoch: 23 | loss: 0.0013704
	speed: 0.8521s/iter; left time: 2857.2241s
Epoch: 23 cost time: 383.35638332366943
Epoch: 23, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0008408
	speed: 2.8228s/iter; left time: 8987.7269s
	iters: 200, epoch: 24 | loss: 0.0002730
	speed: 0.7972s/iter; left time: 2458.6583s
	iters: 300, epoch: 24 | loss: 0.0001622
	speed: 0.8128s/iter; left time: 2425.3025s
	iters: 400, epoch: 24 | loss: 0.0001760
	speed: 0.8004s/iter; left time: 2308.2454s
Epoch: 24 cost time: 381.1233711242676
Epoch: 24, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.981989 --> -0.983990).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0181315
	speed: 2.7777s/iter; left time: 7541.3934s
	iters: 200, epoch: 25 | loss: 0.0003856
	speed: 0.8156s/iter; left time: 2132.6841s
	iters: 300, epoch: 25 | loss: 0.0002319
	speed: 0.8462s/iter; left time: 2128.2878s
	iters: 400, epoch: 25 | loss: 0.0027487
	speed: 0.8554s/iter; left time: 2065.8935s
Epoch: 25 cost time: 388.3240895271301
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0001518
	speed: 2.6868s/iter; left time: 6034.6100s
	iters: 200, epoch: 26 | loss: 0.0003332
	speed: 0.7778s/iter; left time: 1669.0762s
	iters: 300, epoch: 26 | loss: 0.0001354
	speed: 0.7972s/iter; left time: 1630.9895s
	iters: 400, epoch: 26 | loss: 0.0001924
	speed: 0.8033s/iter; left time: 1563.2154s
Epoch: 26 cost time: 374.0696487426758
Epoch: 26, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0002311
	speed: 2.7113s/iter; left time: 4817.8959s
	iters: 200, epoch: 27 | loss: 0.0006077
	speed: 0.7879s/iter; left time: 1321.3086s
	iters: 300, epoch: 27 | loss: 0.0002265
	speed: 0.7691s/iter; left time: 1212.8635s
	iters: 400, epoch: 27 | loss: 0.0001268
	speed: 0.9273s/iter; left time: 1369.6396s
Epoch: 27 cost time: 396.68297290802
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.959 Test Loss: 0.215 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0070780
	speed: 3.1480s/iter; left time: 4117.5561s
	iters: 200, epoch: 28 | loss: 0.0064645
	speed: 0.9413s/iter; left time: 1137.0701s
	iters: 300, epoch: 28 | loss: 0.0039967
	speed: 0.9100s/iter; left time: 1008.3133s
	iters: 400, epoch: 28 | loss: 0.0000872
	speed: 0.9122s/iter; left time: 919.4784s
Epoch: 28 cost time: 433.4608850479126
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0164869
	speed: 3.0771s/iter; left time: 2581.6855s
	iters: 200, epoch: 29 | loss: 0.0215559
	speed: 0.9226s/iter; left time: 681.7778s
	iters: 300, epoch: 29 | loss: 0.0152996
	speed: 0.8684s/iter; left time: 554.9043s
	iters: 400, epoch: 29 | loss: 0.0026512
	speed: 0.8955s/iter; left time: 482.6526s
Epoch: 29 cost time: 419.40238404273987
Epoch: 29, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000820
	speed: 3.0622s/iter; left time: 1132.9990s
	iters: 200, epoch: 30 | loss: 0.0000398
	speed: 0.9234s/iter; left time: 249.3210s
	iters: 300, epoch: 30 | loss: 0.0626702
	speed: 0.8425s/iter; left time: 143.2224s
	iters: 400, epoch: 30 | loss: 0.0033871
	speed: 0.8478s/iter; left time: 59.3486s
Epoch: 30 cost time: 410.9678852558136
Epoch: 30, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 18753802
model size : 72.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6429017
	speed: 0.4829s/iter; left time: 6746.3587s
	iters: 200, epoch: 1 | loss: 0.2045697
	speed: 0.4695s/iter; left time: 6512.4716s
	iters: 300, epoch: 1 | loss: 0.0789465
	speed: 0.5225s/iter; left time: 7195.6250s
	iters: 400, epoch: 1 | loss: 0.0454015
	speed: 0.5292s/iter; left time: 7234.4664s
Epoch: 1 cost time: 236.61315608024597
Epoch: 1, Steps: 469 | Train Loss: 0.442 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (inf --> -0.933103).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0104859
	speed: 1.6720s/iter; left time: 22575.6911s
	iters: 200, epoch: 2 | loss: 0.0174447
	speed: 0.5253s/iter; left time: 7040.4589s
	iters: 300, epoch: 2 | loss: 0.0287695
	speed: 0.5188s/iter; left time: 6900.7838s
	iters: 400, epoch: 2 | loss: 0.2096408
	speed: 0.5228s/iter; left time: 6902.1708s
Epoch: 2 cost time: 238.92002630233765
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.933103 --> -0.972555).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0064106
	speed: 1.7263s/iter; left time: 22498.5143s
	iters: 200, epoch: 3 | loss: 0.0066938
	speed: 0.5033s/iter; left time: 6509.3287s
	iters: 300, epoch: 3 | loss: 0.0122124
	speed: 0.5133s/iter; left time: 6586.7561s
	iters: 400, epoch: 3 | loss: 0.0245243
	speed: 0.5020s/iter; left time: 6391.3547s
Epoch: 3 cost time: 237.99200463294983
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.972555 --> -0.977987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0085612
	speed: 1.7016s/iter; left time: 21378.8763s
	iters: 200, epoch: 4 | loss: 0.0007597
	speed: 0.5205s/iter; left time: 6487.1094s
	iters: 300, epoch: 4 | loss: 0.0126459
	speed: 0.5059s/iter; left time: 6255.3755s
	iters: 400, epoch: 4 | loss: 0.0071883
	speed: 0.5010s/iter; left time: 6144.6597s
Epoch: 4 cost time: 240.02127981185913
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0174851
	speed: 1.7479s/iter; left time: 21140.8818s
	iters: 200, epoch: 5 | loss: 0.0432064
	speed: 0.5368s/iter; left time: 6439.2594s
	iters: 300, epoch: 5 | loss: 0.4989829
	speed: 0.5214s/iter; left time: 6202.4777s
	iters: 400, epoch: 5 | loss: 0.0473088
	speed: 0.5065s/iter; left time: 5974.6377s
Epoch: 5 cost time: 245.31930422782898
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0053884
	speed: 1.7023s/iter; left time: 19790.6594s
	iters: 200, epoch: 6 | loss: 0.0004751
	speed: 0.5130s/iter; left time: 5913.1439s
	iters: 300, epoch: 6 | loss: 0.4212485
	speed: 0.4956s/iter; left time: 5662.1633s
	iters: 400, epoch: 6 | loss: 0.0046185
	speed: 0.4913s/iter; left time: 5565.0019s
Epoch: 6 cost time: 234.9530382156372
Epoch: 6, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0069378
	speed: 1.5388s/iter; left time: 17168.6951s
	iters: 200, epoch: 7 | loss: 0.0009074
	speed: 0.4803s/iter; left time: 5310.6174s
	iters: 300, epoch: 7 | loss: 0.0612064
	speed: 0.4883s/iter; left time: 5350.2133s
	iters: 400, epoch: 7 | loss: 0.0029836
	speed: 0.4839s/iter; left time: 5253.8015s
Epoch: 7 cost time: 222.13971400260925
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0013134
	speed: 1.5833s/iter; left time: 16922.5652s
	iters: 200, epoch: 8 | loss: 0.0006019
	speed: 0.4748s/iter; left time: 5027.3535s
	iters: 300, epoch: 8 | loss: 0.0014068
	speed: 0.4939s/iter; left time: 5180.4719s
	iters: 400, epoch: 8 | loss: 0.0006101
	speed: 0.4707s/iter; left time: 4889.1543s
Epoch: 8 cost time: 224.47174429893494
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007968
	speed: 1.6598s/iter; left time: 16961.5108s
	iters: 200, epoch: 9 | loss: 0.0040776
	speed: 0.4960s/iter; left time: 5018.9510s
	iters: 300, epoch: 9 | loss: 0.0007464
	speed: 0.4703s/iter; left time: 4712.4163s
	iters: 400, epoch: 9 | loss: 0.0002647
	speed: 0.5034s/iter; left time: 4993.5469s
Epoch: 9 cost time: 230.98680567741394
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0003961
	speed: 1.6627s/iter; left time: 16211.7388s
	iters: 200, epoch: 10 | loss: 0.0018055
	speed: 0.4900s/iter; left time: 4728.8150s
	iters: 300, epoch: 10 | loss: 0.0017777
	speed: 0.5162s/iter; left time: 4929.3579s
	iters: 400, epoch: 10 | loss: 0.0006916
	speed: 0.4790s/iter; left time: 4526.2369s
Epoch: 10 cost time: 231.68812465667725
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0006483
	speed: 1.5227s/iter; left time: 14132.0538s
	iters: 200, epoch: 11 | loss: 0.0011373
	speed: 0.4763s/iter; left time: 4373.1484s
	iters: 300, epoch: 11 | loss: 0.0651770
	speed: 0.4640s/iter; left time: 4213.5837s
	iters: 400, epoch: 11 | loss: 0.0018113
	speed: 0.4558s/iter; left time: 4093.3820s
Epoch: 11 cost time: 217.12608981132507
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000748
	speed: 1.5171s/iter; left time: 13368.8550s
	iters: 200, epoch: 12 | loss: 0.0002958
	speed: 0.4823s/iter; left time: 4201.8685s
	iters: 300, epoch: 12 | loss: 0.0001107
	speed: 0.4682s/iter; left time: 4032.5416s
	iters: 400, epoch: 12 | loss: 0.0003519
	speed: 0.5018s/iter; left time: 4271.6168s
Epoch: 12 cost time: 225.3422474861145
Epoch: 12, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0004586
	speed: 1.6052s/iter; left time: 13392.0225s
	iters: 200, epoch: 13 | loss: 0.0096215
	speed: 0.4550s/iter; left time: 3750.4917s
	iters: 300, epoch: 13 | loss: 0.0036283
	speed: 0.4923s/iter; left time: 4008.5012s
	iters: 400, epoch: 13 | loss: 0.0014380
	speed: 0.4817s/iter; left time: 3873.9564s
Epoch: 13 cost time: 223.84704899787903
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 5513994
model size : 22.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4871128
	speed: 0.6597s/iter; left time: 9215.9791s
	iters: 200, epoch: 1 | loss: 0.4764954
	speed: 0.5573s/iter; left time: 7730.4460s
	iters: 300, epoch: 1 | loss: 0.0651202
	speed: 0.5994s/iter; left time: 8253.8175s
	iters: 400, epoch: 1 | loss: 0.0373910
	speed: 0.5878s/iter; left time: 8035.7054s
Epoch: 1 cost time: 281.5881435871124
Epoch: 1, Steps: 469 | Train Loss: 0.422 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
Validation loss decreased (inf --> -0.957403).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0118172
	speed: 2.1476s/iter; left time: 28997.4165s
	iters: 200, epoch: 2 | loss: 0.0903115
	speed: 0.6216s/iter; left time: 8330.7663s
	iters: 300, epoch: 2 | loss: 0.0113807
	speed: 0.6617s/iter; left time: 8802.0468s
	iters: 400, epoch: 2 | loss: 0.0097982
	speed: 0.6536s/iter; left time: 8628.4529s
Epoch: 2 cost time: 303.75333404541016
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.957403 --> -0.969410).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0154987
	speed: 2.2114s/iter; left time: 28821.3652s
	iters: 200, epoch: 3 | loss: 0.1940391
	speed: 0.5919s/iter; left time: 7654.7986s
	iters: 300, epoch: 3 | loss: 0.1723165
	speed: 0.6459s/iter; left time: 8288.5977s
	iters: 400, epoch: 3 | loss: 0.1598539
	speed: 0.6320s/iter; left time: 8047.3195s
Epoch: 3 cost time: 288.2620053291321
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3781665
	speed: 2.1893s/iter; left time: 27506.3983s
	iters: 200, epoch: 4 | loss: 0.0068832
	speed: 0.6309s/iter; left time: 7863.8748s
	iters: 300, epoch: 4 | loss: 0.0169699
	speed: 0.6218s/iter; left time: 7687.3461s
	iters: 400, epoch: 4 | loss: 0.0528342
	speed: 0.6193s/iter; left time: 7595.6850s
Epoch: 4 cost time: 294.8407428264618
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2443800
	speed: 2.1800s/iter; left time: 26367.6162s
	iters: 200, epoch: 5 | loss: 0.2856033
	speed: 0.6148s/iter; left time: 7374.5792s
	iters: 300, epoch: 5 | loss: 0.0071496
	speed: 0.5468s/iter; left time: 6503.7053s
	iters: 400, epoch: 5 | loss: 0.0069720
	speed: 0.5869s/iter; left time: 6922.5975s
Epoch: 5 cost time: 278.48104190826416
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0120423
	speed: 1.9972s/iter; left time: 23219.7264s
	iters: 200, epoch: 6 | loss: 0.0011170
	speed: 0.6004s/iter; left time: 6920.3988s
	iters: 300, epoch: 6 | loss: 0.0057130
	speed: 0.5778s/iter; left time: 6602.4261s
	iters: 400, epoch: 6 | loss: 0.0015440
	speed: 0.6107s/iter; left time: 6916.6718s
Epoch: 6 cost time: 270.604718208313
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0012133
	speed: 2.0854s/iter; left time: 23266.3174s
	iters: 200, epoch: 7 | loss: 0.2751293
	speed: 0.6016s/iter; left time: 6651.9371s
	iters: 300, epoch: 7 | loss: 0.0004973
	speed: 0.6030s/iter; left time: 6606.5763s
	iters: 400, epoch: 7 | loss: 0.0017399
	speed: 0.5957s/iter; left time: 6467.1057s
Epoch: 7 cost time: 281.88627648353577
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.969410 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0012472
	speed: 2.1371s/iter; left time: 22840.8734s
	iters: 200, epoch: 8 | loss: 0.0011526
	speed: 0.6475s/iter; left time: 6855.8706s
	iters: 300, epoch: 8 | loss: 0.0186006
	speed: 0.6463s/iter; left time: 6778.9093s
	iters: 400, epoch: 8 | loss: 0.0006448
	speed: 0.6482s/iter; left time: 6733.9641s
Epoch: 8 cost time: 295.77727580070496
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0013424
	speed: 2.2693s/iter; left time: 23190.3522s
	iters: 200, epoch: 9 | loss: 0.0006587
	speed: 0.6171s/iter; left time: 6244.6988s
	iters: 300, epoch: 9 | loss: 0.1273498
	speed: 0.6155s/iter; left time: 6166.9789s
	iters: 400, epoch: 9 | loss: 0.0019020
	speed: 0.6156s/iter; left time: 6105.6749s
Epoch: 9 cost time: 294.2290389537811
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2705290
	speed: 2.1812s/iter; left time: 21266.9340s
	iters: 200, epoch: 10 | loss: 0.0021258
	speed: 0.5990s/iter; left time: 5780.3800s
	iters: 300, epoch: 10 | loss: 0.0440063
	speed: 0.6641s/iter; left time: 6342.3778s
	iters: 400, epoch: 10 | loss: 0.0010840
	speed: 0.6821s/iter; left time: 6445.3885s
Epoch: 10 cost time: 303.2926015853882
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0006451
	speed: 2.2167s/iter; left time: 20573.2601s
	iters: 200, epoch: 11 | loss: 0.0013575
	speed: 0.6420s/iter; left time: 5894.5922s
	iters: 300, epoch: 11 | loss: 0.0001207
	speed: 0.6708s/iter; left time: 6091.5230s
	iters: 400, epoch: 11 | loss: 0.0218218
	speed: 0.6798s/iter; left time: 6104.8621s
Epoch: 11 cost time: 307.97946763038635
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0026111
	speed: 2.1812s/iter; left time: 19220.7840s
	iters: 200, epoch: 12 | loss: 0.1408805
	speed: 0.5958s/iter; left time: 5190.5345s
	iters: 300, epoch: 12 | loss: 0.0003145
	speed: 0.5929s/iter; left time: 5106.2684s
	iters: 400, epoch: 12 | loss: 0.0047547
	speed: 0.6726s/iter; left time: 5725.3376s
Epoch: 12 cost time: 291.6489682197571
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.979702).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0001664
	speed: 2.3449s/iter; left time: 19563.2980s
	iters: 200, epoch: 13 | loss: 0.0002881
	speed: 0.6469s/iter; left time: 5332.4546s
	iters: 300, epoch: 13 | loss: 0.0005177
	speed: 0.6354s/iter; left time: 5174.1361s
	iters: 400, epoch: 13 | loss: 0.0025491
	speed: 0.6384s/iter; left time: 5135.0000s
Epoch: 13 cost time: 303.70880365371704
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1050129
	speed: 2.3506s/iter; left time: 18508.3865s
	iters: 200, epoch: 14 | loss: 0.0021077
	speed: 0.6515s/iter; left time: 5064.4005s
	iters: 300, epoch: 14 | loss: 0.0028413
	speed: 0.6446s/iter; left time: 4946.7367s
	iters: 400, epoch: 14 | loss: 0.0032244
	speed: 0.6365s/iter; left time: 4820.5051s
Epoch: 14 cost time: 307.42471528053284
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0291240
	speed: 2.2110s/iter; left time: 16372.2580s
	iters: 200, epoch: 15 | loss: 0.0031254
	speed: 0.6297s/iter; left time: 4599.6367s
	iters: 300, epoch: 15 | loss: 0.0004361
	speed: 0.6259s/iter; left time: 4509.8794s
	iters: 400, epoch: 15 | loss: 0.0001990
	speed: 0.6359s/iter; left time: 4518.3728s
Epoch: 15 cost time: 297.11501812934875
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0036780
	speed: 2.1845s/iter; left time: 15151.3817s
	iters: 200, epoch: 16 | loss: 0.0538862
	speed: 0.6193s/iter; left time: 4233.4097s
	iters: 300, epoch: 16 | loss: 0.2249797
	speed: 0.6557s/iter; left time: 4417.0411s
	iters: 400, epoch: 16 | loss: 0.0001190
	speed: 0.6589s/iter; left time: 4372.5507s
Epoch: 16 cost time: 299.69159984588623
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0013262
	speed: 2.2167s/iter; left time: 14335.5652s
	iters: 200, epoch: 17 | loss: 0.0015539
	speed: 0.6370s/iter; left time: 4055.6907s
	iters: 300, epoch: 17 | loss: 0.0157148
	speed: 0.6282s/iter; left time: 3937.0652s
	iters: 400, epoch: 17 | loss: 0.0011056
	speed: 0.6267s/iter; left time: 3864.9119s
Epoch: 17 cost time: 296.01236367225647
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3580693
	speed: 2.2203s/iter; left time: 13317.2669s
	iters: 200, epoch: 18 | loss: 0.7927981
	speed: 0.6221s/iter; left time: 3669.3228s
	iters: 300, epoch: 18 | loss: 0.0011370
	speed: 0.5976s/iter; left time: 3464.7135s
	iters: 400, epoch: 18 | loss: 0.5156510
	speed: 0.5416s/iter; left time: 3086.2071s
Epoch: 18 cost time: 278.019403219223
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0026612
	speed: 2.1445s/iter; left time: 11856.9061s
	iters: 200, epoch: 19 | loss: 0.0361766
	speed: 0.6237s/iter; left time: 3385.8218s
	iters: 300, epoch: 19 | loss: 0.0004933
	speed: 0.6394s/iter; left time: 3407.3623s
	iters: 400, epoch: 19 | loss: 0.0001722
	speed: 0.6181s/iter; left time: 3232.2867s
Epoch: 19 cost time: 293.288578748703
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0065138
	speed: 2.1556s/iter; left time: 10907.1519s
	iters: 200, epoch: 20 | loss: 0.0002831
	speed: 0.6417s/iter; left time: 3182.7658s
	iters: 300, epoch: 20 | loss: 0.0002596
	speed: 0.6437s/iter; left time: 3128.5963s
	iters: 400, epoch: 20 | loss: 0.0033156
	speed: 0.6498s/iter; left time: 3092.8246s
Epoch: 20 cost time: 301.1908628940582
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0005834
	speed: 2.0681s/iter; left time: 9494.7238s
	iters: 200, epoch: 21 | loss: 0.0004350
	speed: 0.5782s/iter; left time: 2596.6635s
	iters: 300, epoch: 21 | loss: 0.0000234
	speed: 0.5912s/iter; left time: 2596.0171s
	iters: 400, epoch: 21 | loss: 0.3653129
	speed: 0.6132s/iter; left time: 2631.1770s
Epoch: 21 cost time: 277.9443564414978
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0007282
	speed: 2.1810s/iter; left time: 8989.8944s
	iters: 200, epoch: 22 | loss: 0.0019047
	speed: 0.6099s/iter; left time: 2452.9289s
	iters: 300, epoch: 22 | loss: 0.0009495
	speed: 0.5887s/iter; left time: 2308.7230s
	iters: 400, epoch: 22 | loss: 0.0025898
	speed: 0.6333s/iter; left time: 2420.5495s
Epoch: 22 cost time: 289.69138765335083
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981989).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0002266
	speed: 2.2185s/iter; left time: 8104.1389s
	iters: 200, epoch: 23 | loss: 0.0016289
	speed: 0.6205s/iter; left time: 2204.6297s
	iters: 300, epoch: 23 | loss: 0.0010544
	speed: 0.6236s/iter; left time: 2153.4311s
	iters: 400, epoch: 23 | loss: 0.0032233
	speed: 0.6260s/iter; left time: 2099.1008s
Epoch: 23 cost time: 283.25376987457275
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0029378
	speed: 1.9014s/iter; left time: 6053.9063s
	iters: 200, epoch: 24 | loss: 0.0001709
	speed: 0.5198s/iter; left time: 1603.1258s
	iters: 300, epoch: 24 | loss: 0.0003660
	speed: 0.6062s/iter; left time: 1808.9613s
	iters: 400, epoch: 24 | loss: 0.0000809
	speed: 0.6169s/iter; left time: 1779.2284s
Epoch: 24 cost time: 272.2241144180298
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0044175
	speed: 2.0855s/iter; left time: 5662.1510s
	iters: 200, epoch: 25 | loss: 0.0021740
	speed: 0.6180s/iter; left time: 1616.0635s
	iters: 300, epoch: 25 | loss: 0.0003108
	speed: 0.6402s/iter; left time: 1610.1984s
	iters: 400, epoch: 25 | loss: 0.0012245
	speed: 0.6276s/iter; left time: 1515.6065s
Epoch: 25 cost time: 293.73559045791626
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0001028
	speed: 2.1433s/iter; left time: 4813.8341s
	iters: 200, epoch: 26 | loss: 0.0022294
	speed: 0.6094s/iter; left time: 1307.7425s
	iters: 300, epoch: 26 | loss: 0.0002136
	speed: 0.5844s/iter; left time: 1195.7190s
	iters: 400, epoch: 26 | loss: 0.0126685
	speed: 0.5973s/iter; left time: 1162.2759s
Epoch: 26 cost time: 280.8976740837097
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0003388
	speed: 2.0896s/iter; left time: 3713.2319s
	iters: 200, epoch: 27 | loss: 0.0001940
	speed: 0.5746s/iter; left time: 963.6153s
	iters: 300, epoch: 27 | loss: 0.0021167
	speed: 0.5979s/iter; left time: 942.9338s
	iters: 400, epoch: 27 | loss: 0.0010433
	speed: 0.6039s/iter; left time: 891.8986s
Epoch: 27 cost time: 279.6601550579071
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0075971
	speed: 2.0562s/iter; left time: 2689.4848s
	iters: 200, epoch: 28 | loss: 0.0020631
	speed: 0.5645s/iter; left time: 681.8750s
	iters: 300, epoch: 28 | loss: 0.0072155
	speed: 0.5865s/iter; left time: 649.8192s
	iters: 400, epoch: 28 | loss: 0.0002352
	speed: 0.5465s/iter; left time: 550.9115s
Epoch: 28 cost time: 260.429452419281
Epoch: 28, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0002294
	speed: 1.9614s/iter; left time: 1645.6121s
	iters: 200, epoch: 29 | loss: 0.0005747
	speed: 0.5734s/iter; left time: 423.7501s
	iters: 300, epoch: 29 | loss: 0.0004900
	speed: 0.6213s/iter; left time: 396.9904s
	iters: 400, epoch: 29 | loss: 0.0001865
	speed: 0.6435s/iter; left time: 346.8474s
Epoch: 29 cost time: 283.65108823776245
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000345
	speed: 2.2226s/iter; left time: 822.3500s
	iters: 200, epoch: 30 | loss: 0.0158015
	speed: 0.6316s/iter; left time: 170.5263s
	iters: 300, epoch: 30 | loss: 0.0871566
	speed: 0.6502s/iter; left time: 110.5273s
	iters: 400, epoch: 30 | loss: 0.0020354
	speed: 0.6252s/iter; left time: 43.7635s
Epoch: 30 cost time: 293.8956928253174
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 18753802
model size : 72.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6398476
	speed: 0.3798s/iter; left time: 5305.5400s
	iters: 200, epoch: 1 | loss: 0.2260463
	speed: 0.3732s/iter; left time: 5177.3215s
	iters: 300, epoch: 1 | loss: 0.0849123
	speed: 0.3762s/iter; left time: 5180.7438s
	iters: 400, epoch: 1 | loss: 0.1014659
	speed: 0.3545s/iter; left time: 4846.4849s
Epoch: 1 cost time: 172.6249716281891
Epoch: 1, Steps: 469 | Train Loss: 0.451 Vali Loss: 0.232 Vali Acc: 0.929 Test Loss: 0.232 Test Acc: 0.929
Validation loss decreased (inf --> -0.928528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0075520
	speed: 1.2859s/iter; left time: 17362.7075s
	iters: 200, epoch: 2 | loss: 0.0161694
	speed: 0.3382s/iter; left time: 4532.8957s
	iters: 300, epoch: 2 | loss: 0.0156864
	speed: 0.3443s/iter; left time: 4579.6171s
	iters: 400, epoch: 2 | loss: 0.1280247
	speed: 0.3538s/iter; left time: 4670.9191s
Epoch: 2 cost time: 164.31608510017395
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.212 Vali Acc: 0.943 Test Loss: 0.212 Test Acc: 0.943
Validation loss decreased (-0.928528 --> -0.942822).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0364501
	speed: 1.2882s/iter; left time: 16788.4696s
	iters: 200, epoch: 3 | loss: 0.0073700
	speed: 0.3443s/iter; left time: 4453.3543s
	iters: 300, epoch: 3 | loss: 0.0060380
	speed: 0.3627s/iter; left time: 4654.2055s
	iters: 400, epoch: 3 | loss: 0.0134920
	speed: 0.3591s/iter; left time: 4572.5971s
Epoch: 3 cost time: 165.42118000984192
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.942822 --> -0.975414).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0127730
	speed: 1.3471s/iter; left time: 16925.1344s
	iters: 200, epoch: 4 | loss: 0.0009044
	speed: 0.3821s/iter; left time: 4763.1001s
	iters: 300, epoch: 4 | loss: 0.0450664
	speed: 0.3533s/iter; left time: 4368.6055s
	iters: 400, epoch: 4 | loss: 0.0032921
	speed: 0.3305s/iter; left time: 4053.7376s
Epoch: 4 cost time: 169.56731295585632
Epoch: 4, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0022291
	speed: 1.3559s/iter; left time: 16399.0606s
	iters: 200, epoch: 5 | loss: 0.3187756
	speed: 0.3602s/iter; left time: 4321.0060s
	iters: 300, epoch: 5 | loss: 0.1419740
	speed: 0.3712s/iter; left time: 4414.9961s
	iters: 400, epoch: 5 | loss: 0.0015661
	speed: 0.3698s/iter; left time: 4361.5768s
Epoch: 5 cost time: 173.901376247406
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.975414 --> -0.977701).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0363883
	speed: 1.3029s/iter; left time: 15147.7763s
	iters: 200, epoch: 6 | loss: 0.0020950
	speed: 0.3516s/iter; left time: 4052.3657s
	iters: 300, epoch: 6 | loss: 0.2095295
	speed: 0.3515s/iter; left time: 4015.9580s
	iters: 400, epoch: 6 | loss: 0.0034104
	speed: 0.3547s/iter; left time: 4017.1829s
Epoch: 6 cost time: 164.59208798408508
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1733056
	speed: 1.3306s/iter; left time: 14845.5649s
	iters: 200, epoch: 7 | loss: 0.0007711
	speed: 0.3562s/iter; left time: 3939.0162s
	iters: 300, epoch: 7 | loss: 0.0685074
	speed: 0.3671s/iter; left time: 4022.0176s
	iters: 400, epoch: 7 | loss: 0.0025104
	speed: 0.3728s/iter; left time: 4047.8968s
Epoch: 7 cost time: 170.6967442035675
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0027958
	speed: 1.2623s/iter; left time: 13491.1998s
	iters: 200, epoch: 8 | loss: 0.0002099
	speed: 0.3348s/iter; left time: 3544.6888s
	iters: 300, epoch: 8 | loss: 0.0004010
	speed: 0.3377s/iter; left time: 3542.2292s
	iters: 400, epoch: 8 | loss: 0.0008047
	speed: 0.3356s/iter; left time: 3486.5077s
Epoch: 8 cost time: 159.04458260536194
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1167837
	speed: 1.2911s/iter; left time: 13194.1838s
	iters: 200, epoch: 9 | loss: 0.0008618
	speed: 0.3637s/iter; left time: 3680.6293s
	iters: 300, epoch: 9 | loss: 0.0054281
	speed: 0.3551s/iter; left time: 3557.4866s
	iters: 400, epoch: 9 | loss: 0.0025286
	speed: 0.3567s/iter; left time: 3537.9523s
Epoch: 9 cost time: 168.09719133377075
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0009270
	speed: 1.3220s/iter; left time: 12889.9272s
	iters: 200, epoch: 10 | loss: 0.0022020
	speed: 0.3459s/iter; left time: 3337.7592s
	iters: 300, epoch: 10 | loss: 0.0023174
	speed: 0.3379s/iter; left time: 3227.1760s
	iters: 400, epoch: 10 | loss: 0.0008088
	speed: 0.3339s/iter; left time: 3155.7712s
Epoch: 10 cost time: 157.70967602729797
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0026450
	speed: 1.3001s/iter; left time: 12066.0428s
	iters: 200, epoch: 11 | loss: 0.0011073
	speed: 0.3596s/iter; left time: 3301.5937s
	iters: 300, epoch: 11 | loss: 0.0067426
	speed: 0.3640s/iter; left time: 3305.1387s
	iters: 400, epoch: 11 | loss: 0.0002634
	speed: 0.3512s/iter; left time: 3153.8356s
Epoch: 11 cost time: 168.010639667511
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0010886
	speed: 1.3146s/iter; left time: 11584.2605s
	iters: 200, epoch: 12 | loss: 0.0003955
	speed: 0.3304s/iter; left time: 2878.3469s
	iters: 300, epoch: 12 | loss: 0.0024661
	speed: 0.3652s/iter; left time: 3144.8390s
	iters: 400, epoch: 12 | loss: 0.0001984
	speed: 0.3693s/iter; left time: 3143.8072s
Epoch: 12 cost time: 167.88606977462769
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0002561
	speed: 1.2543s/iter; left time: 10464.4263s
	iters: 200, epoch: 13 | loss: 0.0005993
	speed: 0.3126s/iter; left time: 2576.8201s
	iters: 300, epoch: 13 | loss: 0.0114612
	speed: 0.3144s/iter; left time: 2560.5425s
	iters: 400, epoch: 13 | loss: 0.0016388
	speed: 0.3159s/iter; left time: 2541.1756s
Epoch: 13 cost time: 145.37279081344604
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0410244
	speed: 1.2442s/iter; left time: 9797.0627s
	iters: 200, epoch: 14 | loss: 0.0023077
	speed: 0.3400s/iter; left time: 2643.1034s
	iters: 300, epoch: 14 | loss: 0.0002980
	speed: 0.3575s/iter; left time: 2743.7271s
	iters: 400, epoch: 14 | loss: 0.0013252
	speed: 0.3541s/iter; left time: 2682.1966s
Epoch: 14 cost time: 164.9757239818573
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0003284
	speed: 1.3471s/iter; left time: 9975.3607s
	iters: 200, epoch: 15 | loss: 0.0711643
	speed: 0.3603s/iter; left time: 2632.0253s
	iters: 300, epoch: 15 | loss: 0.0004507
	speed: 0.3556s/iter; left time: 2561.9054s
	iters: 400, epoch: 15 | loss: 0.0139966
	speed: 0.3547s/iter; left time: 2520.3528s
Epoch: 15 cost time: 165.6614887714386
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 5513994
model size : 22.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6210759
	speed: 0.3506s/iter; left time: 4897.6480s
	iters: 200, epoch: 1 | loss: 0.4671976
	speed: 0.3367s/iter; left time: 4669.9141s
	iters: 300, epoch: 1 | loss: 0.1118213
	speed: 0.3362s/iter; left time: 4629.8383s
	iters: 400, epoch: 1 | loss: 0.0305342
	speed: 0.3211s/iter; left time: 4389.4679s
Epoch: 1 cost time: 156.2628276348114
Epoch: 1, Steps: 469 | Train Loss: 0.487 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
Validation loss decreased (inf --> -0.939106).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0215214
	speed: 1.3512s/iter; left time: 18243.5531s
	iters: 200, epoch: 2 | loss: 0.0247059
	speed: 0.3719s/iter; left time: 4984.2723s
	iters: 300, epoch: 2 | loss: 0.0340060
	speed: 0.3740s/iter; left time: 4974.9441s
	iters: 400, epoch: 2 | loss: 0.0258344
	speed: 0.3754s/iter; left time: 4955.6114s
Epoch: 2 cost time: 175.19870471954346
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.939106 --> -0.957117).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1704961
	speed: 1.3426s/iter; left time: 17498.4247s
	iters: 200, epoch: 3 | loss: 0.2105713
	speed: 0.3639s/iter; left time: 4706.8767s
	iters: 300, epoch: 3 | loss: 0.1033262
	speed: 0.3641s/iter; left time: 4671.9118s
	iters: 400, epoch: 3 | loss: 0.0104171
	speed: 0.3660s/iter; left time: 4660.1719s
Epoch: 3 cost time: 169.2645559310913
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.957117 --> -0.976271).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4885476
	speed: 1.3763s/iter; left time: 17291.9561s
	iters: 200, epoch: 4 | loss: 0.0061037
	speed: 0.3540s/iter; left time: 4412.6262s
	iters: 300, epoch: 4 | loss: 0.0023055
	speed: 0.3563s/iter; left time: 4405.2331s
	iters: 400, epoch: 4 | loss: 0.0354600
	speed: 0.3576s/iter; left time: 4385.3838s
Epoch: 4 cost time: 168.23170351982117
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.947 Test Loss: 0.150 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3345996
	speed: 1.3514s/iter; left time: 16345.4193s
	iters: 200, epoch: 5 | loss: 0.0009787
	speed: 0.3002s/iter; left time: 3600.8572s
	iters: 300, epoch: 5 | loss: 0.0037753
	speed: 0.3227s/iter; left time: 3838.6244s
	iters: 400, epoch: 5 | loss: 0.2126423
	speed: 0.3232s/iter; left time: 3811.8934s
Epoch: 5 cost time: 151.41748213768005
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0180129
	speed: 1.2741s/iter; left time: 14812.2758s
	iters: 200, epoch: 6 | loss: 0.0034015
	speed: 0.3597s/iter; left time: 4145.9423s
	iters: 300, epoch: 6 | loss: 0.0110920
	speed: 0.3571s/iter; left time: 4080.2141s
	iters: 400, epoch: 6 | loss: 0.0123067
	speed: 0.3538s/iter; left time: 4006.9261s
Epoch: 6 cost time: 166.771666765213
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.976271 --> -0.982847).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0036279
	speed: 1.2275s/iter; left time: 13695.0967s
	iters: 200, epoch: 7 | loss: 0.2446076
	speed: 0.3393s/iter; left time: 3752.1321s
	iters: 300, epoch: 7 | loss: 0.0294595
	speed: 0.3422s/iter; left time: 3749.4762s
	iters: 400, epoch: 7 | loss: 0.0021343
	speed: 0.3451s/iter; left time: 3746.2844s
Epoch: 7 cost time: 158.3298306465149
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0007193
	speed: 1.4189s/iter; left time: 15164.8132s
	iters: 200, epoch: 8 | loss: 0.0002462
	speed: 0.3622s/iter; left time: 3835.4605s
	iters: 300, epoch: 8 | loss: 0.0685830
	speed: 0.3660s/iter; left time: 3838.7814s
	iters: 400, epoch: 8 | loss: 0.0008300
	speed: 0.3646s/iter; left time: 3787.1382s
Epoch: 8 cost time: 171.22728514671326
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0021133
	speed: 1.3934s/iter; left time: 14239.5511s
	iters: 200, epoch: 9 | loss: 0.0008958
	speed: 0.3649s/iter; left time: 3692.3347s
	iters: 300, epoch: 9 | loss: 0.0016256
	speed: 0.3627s/iter; left time: 3633.7013s
	iters: 400, epoch: 9 | loss: 0.0026378
	speed: 0.3591s/iter; left time: 3562.0898s
Epoch: 9 cost time: 169.43238186836243
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0175116
	speed: 1.3581s/iter; left time: 13241.5076s
	iters: 200, epoch: 10 | loss: 0.0009543
	speed: 0.3607s/iter; left time: 3481.1819s
	iters: 300, epoch: 10 | loss: 0.2630041
	speed: 0.3595s/iter; left time: 3432.8710s
	iters: 400, epoch: 10 | loss: 0.0013162
	speed: 0.3557s/iter; left time: 3361.2127s
Epoch: 10 cost time: 168.32497692108154
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0031625
	speed: 1.3673s/iter; left time: 12689.6201s
	iters: 200, epoch: 11 | loss: 0.0059954
	speed: 0.3708s/iter; left time: 3404.3135s
	iters: 300, epoch: 11 | loss: 0.1525621
	speed: 0.3696s/iter; left time: 3356.2861s
	iters: 400, epoch: 11 | loss: 0.0133443
	speed: 0.3637s/iter; left time: 3266.5048s
Epoch: 11 cost time: 171.7561981678009
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0017143
	speed: 1.3555s/iter; left time: 11945.0679s
	iters: 200, epoch: 12 | loss: 0.0064470
	speed: 0.3673s/iter; left time: 3200.0214s
	iters: 300, epoch: 12 | loss: 0.0006966
	speed: 0.3552s/iter; left time: 3059.2500s
	iters: 400, epoch: 12 | loss: 0.0023385
	speed: 0.3228s/iter; left time: 2747.7925s
Epoch: 12 cost time: 164.53447771072388
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0002098
	speed: 1.2554s/iter; left time: 10473.9939s
	iters: 200, epoch: 13 | loss: 0.0087503
	speed: 0.3438s/iter; left time: 2834.0905s
	iters: 300, epoch: 13 | loss: 0.0013068
	speed: 0.3481s/iter; left time: 2834.2623s
	iters: 400, epoch: 13 | loss: 0.0004433
	speed: 0.3521s/iter; left time: 2831.5973s
Epoch: 13 cost time: 162.43790221214294
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3236824
	speed: 1.2816s/iter; left time: 10090.9473s
	iters: 200, epoch: 14 | loss: 0.0127191
	speed: 0.3393s/iter; left time: 2637.5226s
	iters: 300, epoch: 14 | loss: 0.0013016
	speed: 0.3451s/iter; left time: 2648.4046s
	iters: 400, epoch: 14 | loss: 0.0004172
	speed: 0.3476s/iter; left time: 2632.6377s
Epoch: 14 cost time: 159.0185239315033
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0094650
	speed: 1.3790s/iter; left time: 10211.4135s
	iters: 200, epoch: 15 | loss: 0.0099696
	speed: 0.3476s/iter; left time: 2539.5534s
	iters: 300, epoch: 15 | loss: 0.0004263
	speed: 0.3209s/iter; left time: 2312.0612s
	iters: 400, epoch: 15 | loss: 0.1410558
	speed: 0.3224s/iter; left time: 2290.9509s
Epoch: 15 cost time: 157.1607382297516
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0128840
	speed: 1.2362s/iter; left time: 8574.0675s
	iters: 200, epoch: 16 | loss: 0.0001329
	speed: 0.3374s/iter; left time: 2306.2821s
	iters: 300, epoch: 16 | loss: 0.0017222
	speed: 0.3348s/iter; left time: 2254.9283s
	iters: 400, epoch: 16 | loss: 0.0000856
	speed: 0.3449s/iter; left time: 2288.8213s
Epoch: 16 cost time: 161.08464360237122
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 18753802
model size : 72.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8486077
	speed: 0.2494s/iter; left time: 3485.0109s
	iters: 200, epoch: 1 | loss: 0.3333592
	speed: 0.2313s/iter; left time: 3207.9447s
	iters: 300, epoch: 1 | loss: 0.1251968
	speed: 0.1968s/iter; left time: 2710.1410s
	iters: 400, epoch: 1 | loss: 0.0915418
	speed: 0.2278s/iter; left time: 3114.3074s
Epoch: 1 cost time: 106.38833856582642
Epoch: 1, Steps: 469 | Train Loss: 0.529 Vali Loss: 0.233 Vali Acc: 0.924 Test Loss: 0.233 Test Acc: 0.924
Validation loss decreased (inf --> -0.923668).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0226348
	speed: 0.9616s/iter; left time: 12982.9227s
	iters: 200, epoch: 2 | loss: 0.0123229
	speed: 0.1974s/iter; left time: 2645.6334s
	iters: 300, epoch: 2 | loss: 0.0650097
	speed: 0.2078s/iter; left time: 2764.5777s
	iters: 400, epoch: 2 | loss: 0.0286572
	speed: 0.2037s/iter; left time: 2689.4077s
Epoch: 2 cost time: 97.33493828773499
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
Validation loss decreased (-0.923668 --> -0.966837).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0606559
	speed: 0.8606s/iter; left time: 11216.1354s
	iters: 200, epoch: 3 | loss: 0.0250480
	speed: 0.2146s/iter; left time: 2775.3824s
	iters: 300, epoch: 3 | loss: 0.0028958
	speed: 0.2113s/iter; left time: 2712.1638s
	iters: 400, epoch: 3 | loss: 0.0117180
	speed: 0.2146s/iter; left time: 2732.0255s
Epoch: 3 cost time: 100.57328271865845
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.966837 --> -0.979988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2149013
	speed: 0.8839s/iter; left time: 11105.7007s
	iters: 200, epoch: 4 | loss: 0.0011644
	speed: 0.2136s/iter; left time: 2662.9330s
	iters: 300, epoch: 4 | loss: 0.0099908
	speed: 0.2183s/iter; left time: 2699.1317s
	iters: 400, epoch: 4 | loss: 0.0034299
	speed: 0.2188s/iter; left time: 2683.7042s
Epoch: 4 cost time: 99.84679818153381
Epoch: 4, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0040362
	speed: 0.9305s/iter; left time: 11254.5063s
	iters: 200, epoch: 5 | loss: 0.1629002
	speed: 0.2220s/iter; left time: 2662.5720s
	iters: 300, epoch: 5 | loss: 0.0685478
	speed: 0.2254s/iter; left time: 2681.5759s
	iters: 400, epoch: 5 | loss: 0.0076870
	speed: 0.2208s/iter; left time: 2604.3821s
Epoch: 5 cost time: 103.81120252609253
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0036574
	speed: 0.9386s/iter; left time: 10911.7641s
	iters: 200, epoch: 6 | loss: 0.0064615
	speed: 0.2073s/iter; left time: 2388.9018s
	iters: 300, epoch: 6 | loss: 0.0514371
	speed: 0.2184s/iter; left time: 2495.4614s
	iters: 400, epoch: 6 | loss: 0.0155459
	speed: 0.2208s/iter; left time: 2500.3547s
Epoch: 6 cost time: 102.32179498672485
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0097091
	speed: 0.9173s/iter; left time: 10233.7605s
	iters: 200, epoch: 7 | loss: 0.0012300
	speed: 0.2133s/iter; left time: 2358.7795s
	iters: 300, epoch: 7 | loss: 0.0072331
	speed: 0.2056s/iter; left time: 2253.1134s
	iters: 400, epoch: 7 | loss: 0.0045524
	speed: 0.2040s/iter; left time: 2215.1295s
Epoch: 7 cost time: 98.62182092666626
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0011825
	speed: 0.8946s/iter; left time: 9561.9535s
	iters: 200, epoch: 8 | loss: 0.0001656
	speed: 0.2187s/iter; left time: 2315.1545s
	iters: 300, epoch: 8 | loss: 0.0060986
	speed: 0.2202s/iter; left time: 2309.2489s
	iters: 400, epoch: 8 | loss: 0.0005287
	speed: 0.2163s/iter; left time: 2246.5583s
Epoch: 8 cost time: 102.43298411369324
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.983418).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0023117
	speed: 0.8445s/iter; left time: 8629.7283s
	iters: 200, epoch: 9 | loss: 0.0029038
	speed: 0.1981s/iter; left time: 2004.2729s
	iters: 300, epoch: 9 | loss: 0.0021473
	speed: 0.1980s/iter; left time: 1984.1781s
	iters: 400, epoch: 9 | loss: 0.0006340
	speed: 0.1956s/iter; left time: 1940.1107s
Epoch: 9 cost time: 92.94539308547974
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003859
	speed: 0.7928s/iter; left time: 7729.8427s
	iters: 200, epoch: 10 | loss: 0.0033589
	speed: 0.1489s/iter; left time: 1436.9167s
	iters: 300, epoch: 10 | loss: 0.0007088
	speed: 0.1909s/iter; left time: 1822.8487s
	iters: 400, epoch: 10 | loss: 0.1556848
	speed: 0.1981s/iter; left time: 1871.7091s
Epoch: 10 cost time: 85.0239999294281
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0006618
	speed: 0.7834s/iter; left time: 7270.7630s
	iters: 200, epoch: 11 | loss: 0.0003265
	speed: 0.1251s/iter; left time: 1148.3671s
	iters: 300, epoch: 11 | loss: 0.0010737
	speed: 0.1954s/iter; left time: 1774.8436s
	iters: 400, epoch: 11 | loss: 0.0017448
	speed: 0.1917s/iter; left time: 1721.7781s
Epoch: 11 cost time: 83.98616290092468
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0009732
	speed: 0.8282s/iter; left time: 7298.3218s
	iters: 200, epoch: 12 | loss: 0.0033164
	speed: 0.2028s/iter; left time: 1767.1791s
	iters: 300, epoch: 12 | loss: 0.0026051
	speed: 0.1968s/iter; left time: 1694.6401s
	iters: 400, epoch: 12 | loss: 0.0011691
	speed: 0.1923s/iter; left time: 1636.6377s
Epoch: 12 cost time: 94.62399911880493
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002629
	speed: 0.8654s/iter; left time: 7219.9721s
	iters: 200, epoch: 13 | loss: 0.0014764
	speed: 0.1910s/iter; left time: 1574.1852s
	iters: 300, epoch: 13 | loss: 0.0008496
	speed: 0.1982s/iter; left time: 1613.8718s
	iters: 400, epoch: 13 | loss: 0.0034444
	speed: 0.2104s/iter; left time: 1692.4147s
Epoch: 13 cost time: 93.68749356269836
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0143020
	speed: 0.8299s/iter; left time: 6534.9624s
	iters: 200, epoch: 14 | loss: 0.0005021
	speed: 0.2061s/iter; left time: 1602.4349s
	iters: 300, epoch: 14 | loss: 0.0003181
	speed: 0.2047s/iter; left time: 1570.6478s
	iters: 400, epoch: 14 | loss: 0.0047336
	speed: 0.2035s/iter; left time: 1541.6334s
Epoch: 14 cost time: 92.95034527778625
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0672158
	speed: 0.7917s/iter; left time: 5862.5167s
	iters: 200, epoch: 15 | loss: 0.0006391
	speed: 0.1960s/iter; left time: 1431.9912s
	iters: 300, epoch: 15 | loss: 0.0001301
	speed: 0.1837s/iter; left time: 1323.8907s
	iters: 400, epoch: 15 | loss: 0.0003092
	speed: 0.1830s/iter; left time: 1300.0633s
Epoch: 15 cost time: 89.80479168891907
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001899
	speed: 0.8989s/iter; left time: 6234.6446s
	iters: 200, epoch: 16 | loss: 0.0057310
	speed: 0.1986s/iter; left time: 1357.8270s
	iters: 300, epoch: 16 | loss: 0.0006084
	speed: 0.1949s/iter; left time: 1312.7033s
	iters: 400, epoch: 16 | loss: 0.4925237
	speed: 0.1951s/iter; left time: 1294.8386s
Epoch: 16 cost time: 91.77785301208496
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0005741
	speed: 0.7748s/iter; left time: 5010.7942s
	iters: 200, epoch: 17 | loss: 0.0109276
	speed: 0.1778s/iter; left time: 1131.7759s
	iters: 300, epoch: 17 | loss: 0.0011111
	speed: 0.1666s/iter; left time: 1043.9571s
	iters: 400, epoch: 17 | loss: 0.0004019
	speed: 0.1854s/iter; left time: 1143.5119s
Epoch: 17 cost time: 84.12794351577759
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0025800
	speed: 0.7991s/iter; left time: 4792.8607s
	iters: 200, epoch: 18 | loss: 0.0000797
	speed: 0.1961s/iter; left time: 1156.5456s
	iters: 300, epoch: 18 | loss: 0.0009679
	speed: 0.1968s/iter; left time: 1141.1022s
	iters: 400, epoch: 18 | loss: 0.0033944
	speed: 0.2010s/iter; left time: 1145.3678s
Epoch: 18 cost time: 91.0097508430481
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 5513994
model size : 22.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6055785
	speed: 0.3702s/iter; left time: 5172.7429s
	iters: 200, epoch: 1 | loss: 0.2020799
	speed: 0.3395s/iter; left time: 4708.9516s
	iters: 300, epoch: 1 | loss: 0.0416780
	speed: 0.3762s/iter; left time: 5181.1517s
	iters: 400, epoch: 1 | loss: 0.1636687
	speed: 0.3972s/iter; left time: 5429.7330s
Epoch: 1 cost time: 174.1851372718811
Epoch: 1, Steps: 469 | Train Loss: 0.458 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (inf --> -0.951399).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5076365
	speed: 1.5641s/iter; left time: 21118.5889s
	iters: 200, epoch: 2 | loss: 0.0242062
	speed: 0.3355s/iter; left time: 4496.5905s
	iters: 300, epoch: 2 | loss: 0.2036936
	speed: 0.3573s/iter; left time: 4752.7146s
	iters: 400, epoch: 2 | loss: 0.2530590
	speed: 0.3515s/iter; left time: 4640.8113s
Epoch: 2 cost time: 163.06766319274902
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.951399 --> -0.967409).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0070378
	speed: 1.5739s/iter; left time: 20513.1470s
	iters: 200, epoch: 3 | loss: 0.0015146
	speed: 0.3914s/iter; left time: 5061.5484s
	iters: 300, epoch: 3 | loss: 0.0390942
	speed: 0.3856s/iter; left time: 4948.1597s
	iters: 400, epoch: 3 | loss: 0.0014543
	speed: 0.3675s/iter; left time: 4679.3508s
Epoch: 3 cost time: 177.98365426063538
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0159119
	speed: 1.5869s/iter; left time: 19937.5578s
	iters: 200, epoch: 4 | loss: 0.0161494
	speed: 0.3982s/iter; left time: 4962.7809s
	iters: 300, epoch: 4 | loss: 0.0060453
	speed: 0.4040s/iter; left time: 4995.0531s
	iters: 400, epoch: 4 | loss: 0.0046104
	speed: 0.3877s/iter; left time: 4754.2522s
Epoch: 4 cost time: 185.20272040367126
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.967409 --> -0.973126).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3006032
	speed: 1.5520s/iter; left time: 18771.8039s
	iters: 200, epoch: 5 | loss: 0.0016033
	speed: 0.3936s/iter; left time: 4721.4318s
	iters: 300, epoch: 5 | loss: 0.0098193
	speed: 0.3939s/iter; left time: 4684.8573s
	iters: 400, epoch: 5 | loss: 0.1098206
	speed: 0.3919s/iter; left time: 4622.4082s
Epoch: 5 cost time: 181.90835618972778
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973126 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0030141
	speed: 1.6636s/iter; left time: 19341.2357s
	iters: 200, epoch: 6 | loss: 0.0161387
	speed: 0.3881s/iter; left time: 4472.8576s
	iters: 300, epoch: 6 | loss: 0.2416394
	speed: 0.3612s/iter; left time: 4126.7167s
	iters: 400, epoch: 6 | loss: 0.0015442
	speed: 0.3554s/iter; left time: 4025.2644s
Epoch: 6 cost time: 174.191477060318
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0009697
	speed: 1.5855s/iter; left time: 17689.7006s
	iters: 200, epoch: 7 | loss: 0.0011101
	speed: 0.3652s/iter; left time: 4037.8414s
	iters: 300, epoch: 7 | loss: 0.0018743
	speed: 0.3067s/iter; left time: 3360.8747s
	iters: 400, epoch: 7 | loss: 0.2431182
	speed: 0.3470s/iter; left time: 3767.4267s
Epoch: 7 cost time: 163.99976658821106
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0008863
	speed: 1.6028s/iter; left time: 17130.4472s
	iters: 200, epoch: 8 | loss: 0.0014576
	speed: 0.4003s/iter; left time: 4238.7384s
	iters: 300, epoch: 8 | loss: 0.0098142
	speed: 0.3761s/iter; left time: 3945.0363s
	iters: 400, epoch: 8 | loss: 0.0048784
	speed: 0.3660s/iter; left time: 3802.2503s
Epoch: 8 cost time: 179.72380948066711
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0196832
	speed: 1.5013s/iter; left time: 15342.0814s
	iters: 200, epoch: 9 | loss: 0.2158244
	speed: 0.3771s/iter; left time: 3815.6862s
	iters: 300, epoch: 9 | loss: 0.0069686
	speed: 0.3144s/iter; left time: 3150.3703s
	iters: 400, epoch: 9 | loss: 0.0003410
	speed: 0.3592s/iter; left time: 3563.2213s
Epoch: 9 cost time: 168.3509407043457
Epoch: 9, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0029087
	speed: 1.4282s/iter; left time: 13924.6975s
	iters: 200, epoch: 10 | loss: 0.0067405
	speed: 0.3666s/iter; left time: 3538.0778s
	iters: 300, epoch: 10 | loss: 0.0030944
	speed: 0.3906s/iter; left time: 3730.4272s
	iters: 400, epoch: 10 | loss: 0.0014348
	speed: 0.3997s/iter; left time: 3776.7909s
Epoch: 10 cost time: 169.98481225967407
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0014534
	speed: 1.6187s/iter; left time: 15023.2397s
	iters: 200, epoch: 11 | loss: 0.0060417
	speed: 0.3404s/iter; left time: 3125.3733s
	iters: 300, epoch: 11 | loss: 0.0016031
	speed: 0.3515s/iter; left time: 3192.1745s
	iters: 400, epoch: 11 | loss: 0.0444904
	speed: 0.3221s/iter; left time: 2892.5609s
Epoch: 11 cost time: 161.7634243965149
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0003236
	speed: 1.4987s/iter; left time: 13206.4677s
	iters: 200, epoch: 12 | loss: 0.0019269
	speed: 0.4103s/iter; left time: 3574.7441s
	iters: 300, epoch: 12 | loss: 0.0019870
	speed: 0.3724s/iter; left time: 3206.8684s
	iters: 400, epoch: 12 | loss: 0.0020278
	speed: 0.3632s/iter; left time: 3091.2523s
Epoch: 12 cost time: 178.58792805671692
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0003144
	speed: 1.6070s/iter; left time: 13407.3148s
	iters: 200, epoch: 13 | loss: 0.0879489
	speed: 0.4002s/iter; left time: 3298.6899s
	iters: 300, epoch: 13 | loss: 0.0008666
	speed: 0.3973s/iter; left time: 3235.1782s
	iters: 400, epoch: 13 | loss: 0.0001271
	speed: 0.3867s/iter; left time: 3110.3050s
Epoch: 13 cost time: 181.45654129981995
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0026235
	speed: 1.5457s/iter; left time: 12171.0033s
	iters: 200, epoch: 14 | loss: 0.0000988
	speed: 0.3595s/iter; left time: 2794.3944s
	iters: 300, epoch: 14 | loss: 0.0004222
	speed: 0.3717s/iter; left time: 2852.2002s
	iters: 400, epoch: 14 | loss: 0.0003181
	speed: 0.3775s/iter; left time: 2859.0091s
Epoch: 14 cost time: 172.11080074310303
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977701).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000942
	speed: 1.6125s/iter; left time: 11940.6402s
	iters: 200, epoch: 15 | loss: 0.0001768
	speed: 0.3394s/iter; left time: 2479.4302s
	iters: 300, epoch: 15 | loss: 0.0016174
	speed: 0.3609s/iter; left time: 2600.6239s
	iters: 400, epoch: 15 | loss: 0.0003113
	speed: 0.3578s/iter; left time: 2542.0925s
Epoch: 15 cost time: 169.45977425575256
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
Validation loss decreased (-0.977701 --> -0.984848).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000927
	speed: 1.5605s/iter; left time: 10823.5433s
	iters: 200, epoch: 16 | loss: 0.0001011
	speed: 0.3730s/iter; left time: 2549.5085s
	iters: 300, epoch: 16 | loss: 0.0004536
	speed: 0.3881s/iter; left time: 2614.2057s
	iters: 400, epoch: 16 | loss: 0.0033349
	speed: 0.3989s/iter; left time: 2647.2785s
Epoch: 16 cost time: 179.64170384407043
Epoch: 16, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000969
	speed: 1.6388s/iter; left time: 10598.3924s
	iters: 200, epoch: 17 | loss: 0.0002764
	speed: 0.3862s/iter; left time: 2458.6393s
	iters: 300, epoch: 17 | loss: 0.0011388
	speed: 0.3733s/iter; left time: 2339.6228s
	iters: 400, epoch: 17 | loss: 0.0059395
	speed: 0.3580s/iter; left time: 2207.8654s
Epoch: 17 cost time: 173.1318154335022
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0013167
	speed: 1.4440s/iter; left time: 8661.0635s
	iters: 200, epoch: 18 | loss: 0.0008500
	speed: 0.3595s/iter; left time: 2120.5105s
	iters: 300, epoch: 18 | loss: 0.0001226
	speed: 0.3889s/iter; left time: 2254.9603s
	iters: 400, epoch: 18 | loss: 0.0004572
	speed: 0.3589s/iter; left time: 2044.9119s
Epoch: 18 cost time: 173.00115203857422
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0001234
	speed: 1.5540s/iter; left time: 8592.2130s
	iters: 200, epoch: 19 | loss: 0.0002833
	speed: 0.2861s/iter; left time: 1553.3984s
	iters: 300, epoch: 19 | loss: 0.0024246
	speed: 0.3315s/iter; left time: 1766.3581s
	iters: 400, epoch: 19 | loss: 0.0009674
	speed: 0.3233s/iter; left time: 1690.3125s
Epoch: 19 cost time: 153.84915733337402
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000428
	speed: 1.4141s/iter; left time: 7155.1160s
	iters: 200, epoch: 20 | loss: 0.0025124
	speed: 0.3616s/iter; left time: 1793.4688s
	iters: 300, epoch: 20 | loss: 0.0062741
	speed: 0.3276s/iter; left time: 1592.2544s
	iters: 400, epoch: 20 | loss: 0.0006428
	speed: 0.3207s/iter; left time: 1526.3743s
Epoch: 20 cost time: 158.29579281806946
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0011819
	speed: 1.4708s/iter; left time: 6752.5502s
	iters: 200, epoch: 21 | loss: 0.0824993
	speed: 0.3361s/iter; left time: 1509.2203s
	iters: 300, epoch: 21 | loss: 0.0396305
	speed: 0.3207s/iter; left time: 1408.4056s
	iters: 400, epoch: 21 | loss: 0.0008873
	speed: 0.3450s/iter; left time: 1480.2661s
Epoch: 21 cost time: 155.43505930900574
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0001147
	speed: 1.4734s/iter; left time: 6073.3934s
	iters: 200, epoch: 22 | loss: 0.0080999
	speed: 0.4563s/iter; left time: 1835.0635s
	iters: 300, epoch: 22 | loss: 0.0004169
	speed: 0.4416s/iter; left time: 1732.1004s
	iters: 400, epoch: 22 | loss: 0.0002154
	speed: 0.4416s/iter; left time: 1687.8037s
Epoch: 22 cost time: 205.2909858226776
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0001089
	speed: 1.8282s/iter; left time: 6678.4902s
	iters: 200, epoch: 23 | loss: 0.0000993
	speed: 0.4477s/iter; left time: 1590.5405s
	iters: 300, epoch: 23 | loss: 0.0000894
	speed: 0.4463s/iter; left time: 1541.2048s
	iters: 400, epoch: 23 | loss: 0.0004490
	speed: 0.4606s/iter; left time: 1544.4645s
Epoch: 23 cost time: 213.3917260169983
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0025584
	speed: 2.0057s/iter; left time: 6386.0861s
	iters: 200, epoch: 24 | loss: 0.0002414
	speed: 0.4528s/iter; left time: 1396.3485s
	iters: 300, epoch: 24 | loss: 0.0005812
	speed: 0.4539s/iter; left time: 1354.5046s
	iters: 400, epoch: 24 | loss: 0.0007188
	speed: 0.4594s/iter; left time: 1324.9113s
Epoch: 24 cost time: 215.25271821022034
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0001275
	speed: 1.8624s/iter; left time: 5056.5230s
	iters: 200, epoch: 25 | loss: 0.0034467
	speed: 0.4103s/iter; left time: 1072.8703s
	iters: 300, epoch: 25 | loss: 0.0008016
	speed: 0.4407s/iter; left time: 1108.4381s
	iters: 400, epoch: 25 | loss: 0.0050106
	speed: 0.4565s/iter; left time: 1102.5377s
Epoch: 25 cost time: 200.03533363342285
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 9380618
model size : 37.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5377743
	speed: 0.2656s/iter; left time: 3710.7950s
	iters: 200, epoch: 1 | loss: 0.2560065
	speed: 0.2524s/iter; left time: 3501.2398s
	iters: 300, epoch: 1 | loss: 0.0410878
	speed: 0.2501s/iter; left time: 3443.8795s
	iters: 400, epoch: 1 | loss: 0.0853760
	speed: 0.2480s/iter; left time: 3389.7403s
Epoch: 1 cost time: 119.63034296035767
Epoch: 1, Steps: 469 | Train Loss: 0.488 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (inf --> -0.954258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0201790
	speed: 1.1747s/iter; left time: 15860.7455s
	iters: 200, epoch: 2 | loss: 0.0452629
	speed: 0.2582s/iter; left time: 3460.0410s
	iters: 300, epoch: 2 | loss: 0.0053234
	speed: 0.2676s/iter; left time: 3559.3762s
	iters: 400, epoch: 2 | loss: 0.0199343
	speed: 0.2640s/iter; left time: 3485.6306s
Epoch: 2 cost time: 122.6717517375946
Epoch: 2, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.954258 --> -0.973984).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034370
	speed: 1.1782s/iter; left time: 15355.4630s
	iters: 200, epoch: 3 | loss: 0.0040022
	speed: 0.2180s/iter; left time: 2819.3180s
	iters: 300, epoch: 3 | loss: 0.0176496
	speed: 0.2281s/iter; left time: 2927.4232s
	iters: 400, epoch: 3 | loss: 0.0446866
	speed: 0.2389s/iter; left time: 3041.4838s
Epoch: 3 cost time: 111.15699124336243
Epoch: 3, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.975699).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0336810
	speed: 1.1440s/iter; left time: 14373.3947s
	iters: 200, epoch: 4 | loss: 0.0036629
	speed: 0.2414s/iter; left time: 3008.2215s
	iters: 300, epoch: 4 | loss: 0.0018617
	speed: 0.2326s/iter; left time: 2876.1960s
	iters: 400, epoch: 4 | loss: 0.0426139
	speed: 0.2564s/iter; left time: 3143.9836s
Epoch: 4 cost time: 116.63994097709656
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.975699 --> -0.981417).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3640940
	speed: 1.2133s/iter; left time: 14675.1549s
	iters: 200, epoch: 5 | loss: 0.0061584
	speed: 0.2660s/iter; left time: 3190.2998s
	iters: 300, epoch: 5 | loss: 0.0013812
	speed: 0.2609s/iter; left time: 3102.9893s
	iters: 400, epoch: 5 | loss: 0.0033377
	speed: 0.2651s/iter; left time: 3126.4769s
Epoch: 5 cost time: 122.72361946105957
Epoch: 5, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0034638
	speed: 1.0979s/iter; left time: 12763.8371s
	iters: 200, epoch: 6 | loss: 0.0016434
	speed: 0.2429s/iter; left time: 2799.9966s
	iters: 300, epoch: 6 | loss: 0.0033223
	speed: 0.2469s/iter; left time: 2820.5465s
	iters: 400, epoch: 6 | loss: 0.0015854
	speed: 0.2294s/iter; left time: 2597.8541s
Epoch: 6 cost time: 110.40153622627258
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0436131
	speed: 1.0842s/iter; left time: 12096.2888s
	iters: 200, epoch: 7 | loss: 0.0004632
	speed: 0.2478s/iter; left time: 2740.3727s
	iters: 300, epoch: 7 | loss: 0.0020035
	speed: 0.2451s/iter; left time: 2686.0044s
	iters: 400, epoch: 7 | loss: 0.0016998
	speed: 0.2573s/iter; left time: 2793.3939s
Epoch: 7 cost time: 117.13261413574219
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0010418
	speed: 1.2005s/iter; left time: 12830.6719s
	iters: 200, epoch: 8 | loss: 0.0008930
	speed: 0.2411s/iter; left time: 2552.2920s
	iters: 300, epoch: 8 | loss: 0.0039480
	speed: 0.2457s/iter; left time: 2577.0128s
	iters: 400, epoch: 8 | loss: 0.0010402
	speed: 0.2399s/iter; left time: 2492.2884s
Epoch: 8 cost time: 114.14393997192383
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6261362
	speed: 1.1330s/iter; left time: 11577.7434s
	iters: 200, epoch: 9 | loss: 0.0104182
	speed: 0.2618s/iter; left time: 2649.3514s
	iters: 300, epoch: 9 | loss: 0.0001419
	speed: 0.2547s/iter; left time: 2551.8232s
	iters: 400, epoch: 9 | loss: 0.0011648
	speed: 0.2462s/iter; left time: 2442.0734s
Epoch: 9 cost time: 112.77418184280396
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0076798
	speed: 1.0873s/iter; left time: 10600.7956s
	iters: 200, epoch: 10 | loss: 0.0072396
	speed: 0.2532s/iter; left time: 2443.7159s
	iters: 300, epoch: 10 | loss: 0.0063957
	speed: 0.2564s/iter; left time: 2449.0328s
	iters: 400, epoch: 10 | loss: 0.0006597
	speed: 0.2477s/iter; left time: 2341.0267s
Epoch: 10 cost time: 118.31788992881775
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0003769
	speed: 1.0817s/iter; left time: 10039.7058s
	iters: 200, epoch: 11 | loss: 0.0005271
	speed: 0.2173s/iter; left time: 1994.8705s
	iters: 300, epoch: 11 | loss: 0.0012861
	speed: 0.2518s/iter; left time: 2286.6939s
	iters: 400, epoch: 11 | loss: 0.0040298
	speed: 0.2579s/iter; left time: 2316.1207s
Epoch: 11 cost time: 113.1466372013092
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0008230
	speed: 1.1869s/iter; left time: 10458.5338s
	iters: 200, epoch: 12 | loss: 0.0003310
	speed: 0.2401s/iter; left time: 2091.8361s
	iters: 300, epoch: 12 | loss: 0.0014308
	speed: 0.2349s/iter; left time: 2023.0005s
	iters: 400, epoch: 12 | loss: 0.0014920
	speed: 0.2360s/iter; left time: 2008.7026s
Epoch: 12 cost time: 110.9597270488739
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0026702
	speed: 1.1128s/iter; left time: 9284.1005s
	iters: 200, epoch: 13 | loss: 0.0007629
	speed: 0.2390s/iter; left time: 1969.8788s
	iters: 300, epoch: 13 | loss: 0.0001627
	speed: 0.1960s/iter; left time: 1595.7405s
	iters: 400, epoch: 13 | loss: 0.0001081
	speed: 0.2129s/iter; left time: 1712.7071s
Epoch: 13 cost time: 103.33257961273193
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0011311
	speed: 1.0180s/iter; left time: 8015.8400s
	iters: 200, epoch: 14 | loss: 0.0060416
	speed: 0.2352s/iter; left time: 1828.0672s
	iters: 300, epoch: 14 | loss: 0.0101609
	speed: 0.2071s/iter; left time: 1589.5264s
	iters: 400, epoch: 14 | loss: 0.0007337
	speed: 0.2476s/iter; left time: 1875.0422s
Epoch: 14 cost time: 110.32268118858337
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 2760458
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6138837
	speed: 0.3507s/iter; left time: 4898.9370s
	iters: 200, epoch: 1 | loss: 0.2612763
	speed: 0.3325s/iter; left time: 4612.7053s
	iters: 300, epoch: 1 | loss: 0.0630809
	speed: 0.3322s/iter; left time: 4574.9822s
	iters: 400, epoch: 1 | loss: 0.1696319
	speed: 0.3316s/iter; left time: 4533.4588s
Epoch: 1 cost time: 157.1947259902954
Epoch: 1, Steps: 469 | Train Loss: 0.468 Vali Loss: 0.210 Vali Acc: 0.917 Test Loss: 0.210 Test Acc: 0.917
Validation loss decreased (inf --> -0.916808).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4141004
	speed: 1.3594s/iter; left time: 18355.1194s
	iters: 200, epoch: 2 | loss: 0.0217023
	speed: 0.3210s/iter; left time: 4301.8281s
	iters: 300, epoch: 2 | loss: 0.0821671
	speed: 0.3284s/iter; left time: 4368.9071s
	iters: 400, epoch: 2 | loss: 0.0996984
	speed: 0.3831s/iter; left time: 5058.2280s
Epoch: 2 cost time: 159.57249855995178
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.916808 --> -0.972841).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0087002
	speed: 1.7581s/iter; left time: 22913.2930s
	iters: 200, epoch: 3 | loss: 0.0568473
	speed: 0.4071s/iter; left time: 5264.4354s
	iters: 300, epoch: 3 | loss: 0.0800494
	speed: 0.4045s/iter; left time: 5191.3357s
	iters: 400, epoch: 3 | loss: 0.0027274
	speed: 0.4079s/iter; left time: 5193.8341s
Epoch: 3 cost time: 189.44637393951416
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0052955
	speed: 1.8456s/iter; left time: 23187.7209s
	iters: 200, epoch: 4 | loss: 0.0546280
	speed: 0.4262s/iter; left time: 5312.7517s
	iters: 300, epoch: 4 | loss: 0.0018688
	speed: 0.4206s/iter; left time: 5199.9082s
	iters: 400, epoch: 4 | loss: 0.3458021
	speed: 0.3533s/iter; left time: 4333.2759s
Epoch: 4 cost time: 190.2280900478363
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.972841 --> -0.976271).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3759971
	speed: 1.7721s/iter; left time: 21433.7141s
	iters: 200, epoch: 5 | loss: 0.0041170
	speed: 0.3801s/iter; left time: 4559.3650s
	iters: 300, epoch: 5 | loss: 0.0067489
	speed: 0.3827s/iter; left time: 4552.7934s
	iters: 400, epoch: 5 | loss: 0.1174726
	speed: 0.3928s/iter; left time: 4633.0130s
Epoch: 5 cost time: 181.59018969535828
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.976271 --> -0.985420).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0012804
	speed: 1.7181s/iter; left time: 19974.7689s
	iters: 200, epoch: 6 | loss: 0.0275154
	speed: 0.3753s/iter; left time: 4325.2201s
	iters: 300, epoch: 6 | loss: 0.0981511
	speed: 0.4012s/iter; left time: 4583.8378s
	iters: 400, epoch: 6 | loss: 0.0026759
	speed: 0.3904s/iter; left time: 4421.9026s
Epoch: 6 cost time: 184.53460812568665
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0415710
	speed: 1.6908s/iter; left time: 18864.4490s
	iters: 200, epoch: 7 | loss: 0.0024024
	speed: 0.3778s/iter; left time: 4177.3196s
	iters: 300, epoch: 7 | loss: 0.0029241
	speed: 0.3873s/iter; left time: 4243.2688s
	iters: 400, epoch: 7 | loss: 0.0371864
	speed: 0.3802s/iter; left time: 4127.9032s
Epoch: 7 cost time: 180.1374020576477
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0009473
	speed: 1.7928s/iter; left time: 19161.2027s
	iters: 200, epoch: 8 | loss: 0.0006459
	speed: 0.4087s/iter; left time: 4327.4128s
	iters: 300, epoch: 8 | loss: 0.0078762
	speed: 0.4118s/iter; left time: 4319.1527s
	iters: 400, epoch: 8 | loss: 0.3042823
	speed: 0.3743s/iter; left time: 3888.6753s
Epoch: 8 cost time: 186.49254250526428
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0022157
	speed: 1.6067s/iter; left time: 16419.0235s
	iters: 200, epoch: 9 | loss: 0.0190049
	speed: 0.3265s/iter; left time: 3304.3463s
	iters: 300, epoch: 9 | loss: 0.0367561
	speed: 0.3220s/iter; left time: 3225.9217s
	iters: 400, epoch: 9 | loss: 0.0047198
	speed: 0.3893s/iter; left time: 3861.0810s
Epoch: 9 cost time: 166.2689995765686
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0031460
	speed: 1.7214s/iter; left time: 16783.3477s
	iters: 200, epoch: 10 | loss: 0.0302542
	speed: 0.3953s/iter; left time: 3815.1222s
	iters: 300, epoch: 10 | loss: 0.0001934
	speed: 0.4023s/iter; left time: 3841.6485s
	iters: 400, epoch: 10 | loss: 0.2670925
	speed: 0.3862s/iter; left time: 3650.0478s
Epoch: 10 cost time: 178.223247051239
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0010451
	speed: 1.7396s/iter; left time: 16144.8579s
	iters: 200, epoch: 11 | loss: 0.0287043
	speed: 0.3969s/iter; left time: 3644.1727s
	iters: 300, epoch: 11 | loss: 0.0133938
	speed: 0.4026s/iter; left time: 3655.9194s
	iters: 400, epoch: 11 | loss: 0.0051921
	speed: 0.4203s/iter; left time: 3774.9538s
Epoch: 11 cost time: 187.70681858062744
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0003092
	speed: 1.8127s/iter; left time: 15973.7032s
	iters: 200, epoch: 12 | loss: 0.0008954
	speed: 0.3986s/iter; left time: 3473.0010s
	iters: 300, epoch: 12 | loss: 0.0004343
	speed: 0.3989s/iter; left time: 3435.0382s
	iters: 400, epoch: 12 | loss: 0.0031808
	speed: 0.3848s/iter; left time: 3275.1213s
Epoch: 12 cost time: 185.99872994422913
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0003166
	speed: 1.7784s/iter; left time: 14837.3718s
	iters: 200, epoch: 13 | loss: 0.0011280
	speed: 0.3947s/iter; left time: 3253.4746s
	iters: 300, epoch: 13 | loss: 0.0003108
	speed: 0.4210s/iter; left time: 3428.0223s
	iters: 400, epoch: 13 | loss: 0.0029367
	speed: 0.4223s/iter; left time: 3396.7738s
Epoch: 13 cost time: 191.7736701965332
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0014495
	speed: 1.7705s/iter; left time: 13940.6003s
	iters: 200, epoch: 14 | loss: 0.0004374
	speed: 0.3641s/iter; left time: 2830.6883s
	iters: 300, epoch: 14 | loss: 0.0005412
	speed: 0.3929s/iter; left time: 3015.3467s
	iters: 400, epoch: 14 | loss: 0.0009176
	speed: 0.4031s/iter; left time: 3052.8549s
Epoch: 14 cost time: 182.9985749721527
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000222
	speed: 1.7631s/iter; left time: 13055.9778s
	iters: 200, epoch: 15 | loss: 0.0007554
	speed: 0.3241s/iter; left time: 2367.3967s
	iters: 300, epoch: 15 | loss: 0.0002161
	speed: 0.3355s/iter; left time: 2416.9881s
	iters: 400, epoch: 15 | loss: 0.0001314
	speed: 0.3868s/iter; left time: 2747.9135s
Epoch: 15 cost time: 168.75978660583496
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 9380618
model size : 37.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5370212
	speed: 0.2396s/iter; left time: 3347.9779s
	iters: 200, epoch: 1 | loss: 0.2618676
	speed: 0.1872s/iter; left time: 2596.0935s
	iters: 300, epoch: 1 | loss: 0.0423956
	speed: 0.2341s/iter; left time: 3223.7696s
	iters: 400, epoch: 1 | loss: 0.0943478
	speed: 0.2381s/iter; left time: 3255.4855s
Epoch: 1 cost time: 106.17450165748596
Epoch: 1, Steps: 469 | Train Loss: 0.494 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (inf --> -0.950828).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0758216
	speed: 1.0068s/iter; left time: 13594.2030s
	iters: 200, epoch: 2 | loss: 0.1362032
	speed: 0.2030s/iter; left time: 2720.9056s
	iters: 300, epoch: 2 | loss: 0.0051607
	speed: 0.2014s/iter; left time: 2679.2977s
	iters: 400, epoch: 2 | loss: 0.0103055
	speed: 0.2049s/iter; left time: 2704.5281s
Epoch: 2 cost time: 93.20686793327332
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.950828 --> -0.974556).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0075343
	speed: 1.0625s/iter; left time: 13847.0838s
	iters: 200, epoch: 3 | loss: 0.0052005
	speed: 0.2381s/iter; left time: 3079.5923s
	iters: 300, epoch: 3 | loss: 0.0863833
	speed: 0.2283s/iter; left time: 2929.5267s
	iters: 400, epoch: 3 | loss: 0.0482283
	speed: 0.2198s/iter; left time: 2798.5102s
Epoch: 3 cost time: 106.65017867088318
Epoch: 3, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975700).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0388168
	speed: 1.0833s/iter; left time: 13610.4201s
	iters: 200, epoch: 4 | loss: 0.0044686
	speed: 0.2304s/iter; left time: 2871.2880s
	iters: 300, epoch: 4 | loss: 0.0030962
	speed: 0.2336s/iter; left time: 2888.5154s
	iters: 400, epoch: 4 | loss: 0.1172545
	speed: 0.2432s/iter; left time: 2982.9101s
Epoch: 4 cost time: 112.7474467754364
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2309740
	speed: 1.1883s/iter; left time: 14372.4039s
	iters: 200, epoch: 5 | loss: 0.0462917
	speed: 0.2425s/iter; left time: 2908.3829s
	iters: 300, epoch: 5 | loss: 0.0333337
	speed: 0.2306s/iter; left time: 2742.9896s
	iters: 400, epoch: 5 | loss: 0.0054079
	speed: 0.2495s/iter; left time: 2943.0849s
Epoch: 5 cost time: 114.00966119766235
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.951 Test Loss: 0.179 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0068619
	speed: 1.0709s/iter; left time: 12449.8912s
	iters: 200, epoch: 6 | loss: 0.0111310
	speed: 0.2263s/iter; left time: 2608.2136s
	iters: 300, epoch: 6 | loss: 0.0008971
	speed: 0.2018s/iter; left time: 2305.5003s
	iters: 400, epoch: 6 | loss: 0.0016446
	speed: 0.1985s/iter; left time: 2248.6842s
Epoch: 6 cost time: 99.76926827430725
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0024552
	speed: 0.9903s/iter; left time: 11048.9186s
	iters: 200, epoch: 7 | loss: 0.0010732
	speed: 0.2326s/iter; left time: 2571.3614s
	iters: 300, epoch: 7 | loss: 0.0003093
	speed: 0.2401s/iter; left time: 2630.8957s
	iters: 400, epoch: 7 | loss: 0.0003644
	speed: 0.2421s/iter; left time: 2628.4640s
Epoch: 7 cost time: 109.16541814804077
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0003531
	speed: 1.0927s/iter; left time: 11679.1912s
	iters: 200, epoch: 8 | loss: 0.0891505
	speed: 0.2319s/iter; left time: 2455.7838s
	iters: 300, epoch: 8 | loss: 0.0105821
	speed: 0.2180s/iter; left time: 2286.0107s
	iters: 400, epoch: 8 | loss: 0.0120817
	speed: 0.2496s/iter; left time: 2592.4342s
Epoch: 8 cost time: 111.58921599388123
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5277376
	speed: 1.1179s/iter; left time: 11423.7578s
	iters: 200, epoch: 9 | loss: 0.1610941
	speed: 0.2264s/iter; left time: 2290.5481s
	iters: 300, epoch: 9 | loss: 0.0013161
	speed: 0.2251s/iter; left time: 2255.0480s
	iters: 400, epoch: 9 | loss: 0.0008432
	speed: 0.2374s/iter; left time: 2354.8626s
Epoch: 9 cost time: 108.14230704307556
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.975700 --> -0.979702).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0007237
	speed: 1.1040s/iter; left time: 10763.6826s
	iters: 200, epoch: 10 | loss: 0.0094666
	speed: 0.2190s/iter; left time: 2113.2875s
	iters: 300, epoch: 10 | loss: 0.0065336
	speed: 0.2053s/iter; left time: 1960.3047s
	iters: 400, epoch: 10 | loss: 0.0017452
	speed: 0.2248s/iter; left time: 2124.7778s
Epoch: 10 cost time: 101.75931358337402
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0004092
	speed: 1.0832s/iter; left time: 10053.5143s
	iters: 200, epoch: 11 | loss: 0.0317506
	speed: 0.2370s/iter; left time: 2175.9520s
	iters: 300, epoch: 11 | loss: 0.0111691
	speed: 0.2483s/iter; left time: 2255.1803s
	iters: 400, epoch: 11 | loss: 0.0003592
	speed: 0.2219s/iter; left time: 1993.2351s
Epoch: 11 cost time: 110.06009769439697
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007743
	speed: 1.0814s/iter; left time: 9529.5936s
	iters: 200, epoch: 12 | loss: 0.0002440
	speed: 0.2138s/iter; left time: 1863.0287s
	iters: 300, epoch: 12 | loss: 0.0318513
	speed: 0.1864s/iter; left time: 1605.1641s
	iters: 400, epoch: 12 | loss: 0.0023303
	speed: 0.2106s/iter; left time: 1792.8615s
Epoch: 12 cost time: 99.99483799934387
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0007468
	speed: 0.9141s/iter; left time: 7625.9375s
	iters: 200, epoch: 13 | loss: 0.0000370
	speed: 0.1829s/iter; left time: 1508.0160s
	iters: 300, epoch: 13 | loss: 0.0007057
	speed: 0.1698s/iter; left time: 1382.8864s
	iters: 400, epoch: 13 | loss: 0.0011660
	speed: 0.2032s/iter; left time: 1634.6730s
Epoch: 13 cost time: 90.20310401916504
Epoch: 13, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0033330
	speed: 0.9493s/iter; left time: 7474.7691s
	iters: 200, epoch: 14 | loss: 0.0096754
	speed: 0.2131s/iter; left time: 1656.3174s
	iters: 300, epoch: 14 | loss: 0.0013667
	speed: 0.2091s/iter; left time: 1604.5040s
	iters: 400, epoch: 14 | loss: 0.0032403
	speed: 0.2139s/iter; left time: 1619.9904s
Epoch: 14 cost time: 100.26701521873474
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0012599
	speed: 0.9898s/iter; left time: 7329.5712s
	iters: 200, epoch: 15 | loss: 0.0002092
	speed: 0.1973s/iter; left time: 1440.9905s
	iters: 300, epoch: 15 | loss: 0.0007967
	speed: 0.1921s/iter; left time: 1383.9752s
	iters: 400, epoch: 15 | loss: 0.0213327
	speed: 0.2034s/iter; left time: 1445.1495s
Epoch: 15 cost time: 92.80248236656189
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0039867
	speed: 0.9026s/iter; left time: 6260.1559s
	iters: 200, epoch: 16 | loss: 0.0071109
	speed: 0.2098s/iter; left time: 1434.2598s
	iters: 300, epoch: 16 | loss: 0.0052294
	speed: 0.2192s/iter; left time: 1476.7207s
	iters: 400, epoch: 16 | loss: 0.0013268
	speed: 0.2237s/iter; left time: 1484.5201s
Epoch: 16 cost time: 97.28620481491089
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0012120
	speed: 1.0440s/iter; left time: 6751.4859s
	iters: 200, epoch: 17 | loss: 0.0001333
	speed: 0.2208s/iter; left time: 1405.7203s
	iters: 300, epoch: 17 | loss: 0.0004476
	speed: 0.2278s/iter; left time: 1427.6108s
	iters: 400, epoch: 17 | loss: 0.0009336
	speed: 0.2216s/iter; left time: 1366.6938s
Epoch: 17 cost time: 102.5549750328064
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0014086
	speed: 1.0365s/iter; left time: 6216.9693s
	iters: 200, epoch: 18 | loss: 0.0008248
	speed: 0.2207s/iter; left time: 1301.9045s
	iters: 300, epoch: 18 | loss: 0.0203190
	speed: 0.2247s/iter; left time: 1302.6054s
	iters: 400, epoch: 18 | loss: 0.0026909
	speed: 0.2307s/iter; left time: 1314.6450s
Epoch: 18 cost time: 105.71895265579224
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0004473
	speed: 1.0428s/iter; left time: 5765.5976s
	iters: 200, epoch: 19 | loss: 0.1177468
	speed: 0.2236s/iter; left time: 1213.7620s
	iters: 300, epoch: 19 | loss: 0.0004373
	speed: 0.2266s/iter; left time: 1207.3663s
	iters: 400, epoch: 19 | loss: 0.0001217
	speed: 0.2280s/iter; left time: 1192.3647s
Epoch: 19 cost time: 106.6066792011261
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981989).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0008241
	speed: 1.0181s/iter; left time: 5151.3876s
	iters: 200, epoch: 20 | loss: 0.0000763
	speed: 0.2041s/iter; left time: 1012.1659s
	iters: 300, epoch: 20 | loss: 0.0000946
	speed: 0.2061s/iter; left time: 1001.6284s
	iters: 400, epoch: 20 | loss: 0.1919758
	speed: 0.1833s/iter; left time: 872.4489s
Epoch: 20 cost time: 94.9011640548706
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0016447
	speed: 0.9485s/iter; left time: 4354.7901s
	iters: 200, epoch: 21 | loss: 0.0001172
	speed: 0.2059s/iter; left time: 924.8829s
	iters: 300, epoch: 21 | loss: 0.0001082
	speed: 0.2056s/iter; left time: 902.7880s
	iters: 400, epoch: 21 | loss: 0.0000311
	speed: 0.2054s/iter; left time: 881.3481s
Epoch: 21 cost time: 95.69846034049988
Epoch: 21, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0002220
	speed: 1.0784s/iter; left time: 4445.3056s
	iters: 200, epoch: 22 | loss: 0.0000221
	speed: 0.2405s/iter; left time: 967.1060s
	iters: 300, epoch: 22 | loss: 0.0001391
	speed: 0.2371s/iter; left time: 929.8134s
	iters: 400, epoch: 22 | loss: 0.0002037
	speed: 0.2318s/iter; left time: 885.8966s
Epoch: 22 cost time: 109.72177219390869
Epoch: 22, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0007134
	speed: 0.9540s/iter; left time: 3485.1022s
	iters: 200, epoch: 23 | loss: 0.0113852
	speed: 0.2010s/iter; left time: 714.2834s
	iters: 300, epoch: 23 | loss: 0.0039403
	speed: 0.2010s/iter; left time: 693.9600s
	iters: 400, epoch: 23 | loss: 0.0203670
	speed: 0.1994s/iter; left time: 668.6247s
Epoch: 23 cost time: 94.29003047943115
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983418).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0037839
	speed: 0.9574s/iter; left time: 3048.3530s
	iters: 200, epoch: 24 | loss: 0.1077766
	speed: 0.2382s/iter; left time: 734.6754s
	iters: 300, epoch: 24 | loss: 0.0007259
	speed: 0.2421s/iter; left time: 722.4545s
	iters: 400, epoch: 24 | loss: 0.0004800
	speed: 0.2394s/iter; left time: 690.3550s
Epoch: 24 cost time: 111.55999636650085
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001312
	speed: 1.1009s/iter; left time: 2989.0379s
	iters: 200, epoch: 25 | loss: 0.0000967
	speed: 0.2207s/iter; left time: 577.1972s
	iters: 300, epoch: 25 | loss: 0.0001145
	speed: 0.2109s/iter; left time: 530.4094s
	iters: 400, epoch: 25 | loss: 0.0004362
	speed: 0.2165s/iter; left time: 522.8094s
Epoch: 25 cost time: 102.86850690841675
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0002308
	speed: 0.9877s/iter; left time: 2218.3398s
	iters: 200, epoch: 26 | loss: 0.0000882
	speed: 0.2076s/iter; left time: 445.4377s
	iters: 300, epoch: 26 | loss: 0.0000452
	speed: 0.2124s/iter; left time: 434.6415s
	iters: 400, epoch: 26 | loss: 0.0188986
	speed: 0.2080s/iter; left time: 404.7757s
Epoch: 26 cost time: 99.17748808860779
Epoch: 26, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0006977
	speed: 1.0296s/iter; left time: 1829.6175s
	iters: 200, epoch: 27 | loss: 0.0000532
	speed: 0.1821s/iter; left time: 305.3657s
	iters: 300, epoch: 27 | loss: 0.0000231
	speed: 0.1708s/iter; left time: 269.2929s
	iters: 400, epoch: 27 | loss: 0.0010764
	speed: 0.1779s/iter; left time: 262.7022s
Epoch: 27 cost time: 87.05310153961182
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0001004
	speed: 0.9308s/iter; left time: 1217.4454s
	iters: 200, epoch: 28 | loss: 0.0008279
	speed: 0.2133s/iter; left time: 257.6230s
	iters: 300, epoch: 28 | loss: 0.0001217
	speed: 0.2123s/iter; left time: 235.1859s
	iters: 400, epoch: 28 | loss: 0.0000416
	speed: 0.2013s/iter; left time: 202.8769s
Epoch: 28 cost time: 97.03714609146118
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0002144
	speed: 0.9746s/iter; left time: 817.7308s
	iters: 200, epoch: 29 | loss: 0.0000278
	speed: 0.2281s/iter; left time: 168.5390s
	iters: 300, epoch: 29 | loss: 0.0001930
	speed: 0.2189s/iter; left time: 139.8669s
	iters: 400, epoch: 29 | loss: 0.0000218
	speed: 0.2353s/iter; left time: 126.8528s
Epoch: 29 cost time: 106.63768720626831
Epoch: 29, Steps: 469 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000340
	speed: 0.9983s/iter; left time: 369.3862s
	iters: 200, epoch: 30 | loss: 0.0077301
	speed: 0.2072s/iter; left time: 55.9311s
	iters: 300, epoch: 30 | loss: 0.0001339
	speed: 0.2063s/iter; left time: 35.0666s
	iters: 400, epoch: 30 | loss: 0.0001498
	speed: 0.2067s/iter; left time: 14.4710s
Epoch: 30 cost time: 96.72731494903564
Epoch: 30, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983704).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 2760458
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7489023
	speed: 0.2736s/iter; left time: 3822.7266s
	iters: 200, epoch: 1 | loss: 0.2579679
	speed: 0.2713s/iter; left time: 3762.7977s
	iters: 300, epoch: 1 | loss: 0.0811036
	speed: 0.2691s/iter; left time: 3705.7059s
	iters: 400, epoch: 1 | loss: 0.1288694
	speed: 0.2762s/iter; left time: 3776.3578s
Epoch: 1 cost time: 127.63293242454529
Epoch: 1, Steps: 469 | Train Loss: 0.525 Vali Loss: 0.192 Vali Acc: 0.932 Test Loss: 0.192 Test Acc: 0.932
Validation loss decreased (inf --> -0.931673).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4985956
	speed: 1.1757s/iter; left time: 15873.7423s
	iters: 200, epoch: 2 | loss: 0.0293549
	speed: 0.2675s/iter; left time: 3584.4126s
	iters: 300, epoch: 2 | loss: 0.5949274
	speed: 0.2660s/iter; left time: 3537.6696s
	iters: 400, epoch: 2 | loss: 0.1990841
	speed: 0.2641s/iter; left time: 3486.4399s
Epoch: 2 cost time: 123.91720247268677
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.931673 --> -0.974556).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0062812
	speed: 1.1156s/iter; left time: 14540.1356s
	iters: 200, epoch: 3 | loss: 0.0047753
	speed: 0.2463s/iter; left time: 3185.8216s
	iters: 300, epoch: 3 | loss: 0.0426143
	speed: 0.2641s/iter; left time: 3388.7015s
	iters: 400, epoch: 3 | loss: 0.0099123
	speed: 0.2613s/iter; left time: 3326.8877s
Epoch: 3 cost time: 119.5594494342804
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0236752
	speed: 1.1258s/iter; left time: 14143.9469s
	iters: 200, epoch: 4 | loss: 0.0205072
	speed: 0.2486s/iter; left time: 3098.7494s
	iters: 300, epoch: 4 | loss: 0.0049934
	speed: 0.2561s/iter; left time: 3166.3066s
	iters: 400, epoch: 4 | loss: 0.0233315
	speed: 0.2760s/iter; left time: 3384.9918s
Epoch: 4 cost time: 121.33768701553345
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.956 Test Loss: 0.132 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4196487
	speed: 1.1482s/iter; left time: 13887.0737s
	iters: 200, epoch: 5 | loss: 0.0049624
	speed: 0.2327s/iter; left time: 2791.7713s
	iters: 300, epoch: 5 | loss: 0.0189860
	speed: 0.2206s/iter; left time: 2624.1802s
	iters: 400, epoch: 5 | loss: 0.0108404
	speed: 0.2278s/iter; left time: 2686.7206s
Epoch: 5 cost time: 106.57248282432556
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.974556 --> -0.979702).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008476
	speed: 1.0878s/iter; left time: 12646.4750s
	iters: 200, epoch: 6 | loss: 0.0014646
	speed: 0.2555s/iter; left time: 2945.0940s
	iters: 300, epoch: 6 | loss: 0.0923289
	speed: 0.2730s/iter; left time: 3118.7452s
	iters: 400, epoch: 6 | loss: 0.0028998
	speed: 0.2739s/iter; left time: 3102.7413s
Epoch: 6 cost time: 124.56900119781494
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0016658
	speed: 1.2379s/iter; left time: 13811.6577s
	iters: 200, epoch: 7 | loss: 0.0015485
	speed: 0.2251s/iter; left time: 2488.4658s
	iters: 300, epoch: 7 | loss: 0.0650407
	speed: 0.2564s/iter; left time: 2809.0279s
	iters: 400, epoch: 7 | loss: 0.0459358
	speed: 0.2546s/iter; left time: 2763.7453s
Epoch: 7 cost time: 115.27457690238953
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0005720
	speed: 1.0897s/iter; left time: 11646.4984s
	iters: 200, epoch: 8 | loss: 0.0103702
	speed: 0.2374s/iter; left time: 2513.1568s
	iters: 300, epoch: 8 | loss: 0.0057433
	speed: 0.2717s/iter; left time: 2849.2591s
	iters: 400, epoch: 8 | loss: 0.0016268
	speed: 0.2695s/iter; left time: 2799.0507s
Epoch: 8 cost time: 118.95330452919006
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0008963
	speed: 1.1070s/iter; left time: 11312.2255s
	iters: 200, epoch: 9 | loss: 0.8096170
	speed: 0.2172s/iter; left time: 2197.4068s
	iters: 300, epoch: 9 | loss: 0.0294543
	speed: 0.2280s/iter; left time: 2283.8620s
	iters: 400, epoch: 9 | loss: 0.0002457
	speed: 0.2412s/iter; left time: 2392.7895s
Epoch: 9 cost time: 106.12359809875488
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0111227
	speed: 1.0646s/iter; left time: 10380.0616s
	iters: 200, epoch: 10 | loss: 0.0019999
	speed: 0.2096s/iter; left time: 2022.8219s
	iters: 300, epoch: 10 | loss: 0.0120305
	speed: 0.2247s/iter; left time: 2146.3381s
	iters: 400, epoch: 10 | loss: 0.0115004
	speed: 0.2342s/iter; left time: 2213.6064s
Epoch: 10 cost time: 103.9719455242157
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0002020
	speed: 1.0387s/iter; left time: 9640.4176s
	iters: 200, epoch: 11 | loss: 0.0247842
	speed: 0.2203s/iter; left time: 2022.3025s
	iters: 300, epoch: 11 | loss: 0.0019978
	speed: 0.2343s/iter; left time: 2127.8872s
	iters: 400, epoch: 11 | loss: 0.0316911
	speed: 0.2370s/iter; left time: 2128.3371s
Epoch: 11 cost time: 99.12257504463196
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0023668
	speed: 1.0977s/iter; left time: 9673.2063s
	iters: 200, epoch: 12 | loss: 0.0025647
	speed: 0.2341s/iter; left time: 2039.5919s
	iters: 300, epoch: 12 | loss: 0.0006122
	speed: 0.2264s/iter; left time: 1950.1233s
	iters: 400, epoch: 12 | loss: 0.0014317
	speed: 0.2256s/iter; left time: 1920.6167s
Epoch: 12 cost time: 107.52215600013733
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0008067
	speed: 1.0820s/iter; left time: 9027.0236s
	iters: 200, epoch: 13 | loss: 0.0003624
	speed: 0.2142s/iter; left time: 1765.8700s
	iters: 300, epoch: 13 | loss: 0.0002911
	speed: 0.2289s/iter; left time: 1864.3369s
	iters: 400, epoch: 13 | loss: 0.0031222
	speed: 0.2259s/iter; left time: 1816.7960s
Epoch: 13 cost time: 105.05606865882874
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980560).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0051730
	speed: 1.0103s/iter; left time: 7955.4876s
	iters: 200, epoch: 14 | loss: 0.0001580
	speed: 0.2213s/iter; left time: 1720.2249s
	iters: 300, epoch: 14 | loss: 0.0005666
	speed: 0.2356s/iter; left time: 1808.3545s
	iters: 400, epoch: 14 | loss: 0.0000916
	speed: 0.2391s/iter; left time: 1810.7768s
Epoch: 14 cost time: 107.11090564727783
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000653
	speed: 1.0140s/iter; left time: 7508.7161s
	iters: 200, epoch: 15 | loss: 0.0008299
	speed: 0.2102s/iter; left time: 1535.7157s
	iters: 300, epoch: 15 | loss: 0.0158947
	speed: 0.2153s/iter; left time: 1551.0716s
	iters: 400, epoch: 15 | loss: 0.0085909
	speed: 0.1743s/iter; left time: 1238.5473s
Epoch: 15 cost time: 91.25178599357605
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0015630
	speed: 1.0910s/iter; left time: 7567.4343s
	iters: 200, epoch: 16 | loss: 0.0011828
	speed: 0.2462s/iter; left time: 1682.7670s
	iters: 300, epoch: 16 | loss: 0.0037886
	speed: 0.2570s/iter; left time: 1731.0696s
	iters: 400, epoch: 16 | loss: 0.0332293
	speed: 0.2317s/iter; left time: 1537.7025s
Epoch: 16 cost time: 113.74994826316833
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0010794
	speed: 1.1337s/iter; left time: 7331.4560s
	iters: 200, epoch: 17 | loss: 0.0109935
	speed: 0.2320s/iter; left time: 1477.0332s
	iters: 300, epoch: 17 | loss: 0.0006501
	speed: 0.2475s/iter; left time: 1550.9749s
	iters: 400, epoch: 17 | loss: 0.0294502
	speed: 0.2451s/iter; left time: 1511.4296s
Epoch: 17 cost time: 112.2994875907898
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0021107
	speed: 1.1140s/iter; left time: 6681.5924s
	iters: 200, epoch: 18 | loss: 0.0000957
	speed: 0.2331s/iter; left time: 1374.8888s
	iters: 300, epoch: 18 | loss: 0.0001185
	speed: 0.2336s/iter; left time: 1354.3165s
	iters: 400, epoch: 18 | loss: 0.0000705
	speed: 0.2497s/iter; left time: 1422.7558s
Epoch: 18 cost time: 114.69406270980835
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0001752
	speed: 1.1885s/iter; left time: 6571.0943s
	iters: 200, epoch: 19 | loss: 0.0002294
	speed: 0.2653s/iter; left time: 1440.2908s
	iters: 300, epoch: 19 | loss: 0.0000788
	speed: 0.2401s/iter; left time: 1279.2799s
	iters: 400, epoch: 19 | loss: 0.0010127
	speed: 0.2467s/iter; left time: 1290.1273s
Epoch: 19 cost time: 119.75214433670044
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000466
	speed: 1.1482s/iter; left time: 5810.1189s
	iters: 200, epoch: 20 | loss: 0.0000786
	speed: 0.2551s/iter; left time: 1265.5161s
	iters: 300, epoch: 20 | loss: 0.0036717
	speed: 0.2523s/iter; left time: 1226.3030s
	iters: 400, epoch: 20 | loss: 0.0003022
	speed: 0.2356s/iter; left time: 1121.4301s
Epoch: 20 cost time: 114.53482508659363
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0033253
	speed: 1.0502s/iter; left time: 4821.5067s
	iters: 200, epoch: 21 | loss: 0.0005466
	speed: 0.2206s/iter; left time: 990.5689s
	iters: 300, epoch: 21 | loss: 0.0004511
	speed: 0.2243s/iter; left time: 984.8778s
	iters: 400, epoch: 21 | loss: 0.0001074
	speed: 0.2253s/iter; left time: 966.7951s
Epoch: 21 cost time: 105.21131539344788
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0002353
	speed: 1.1405s/iter; left time: 4701.2118s
	iters: 200, epoch: 22 | loss: 0.0000441
	speed: 0.2524s/iter; left time: 1015.1653s
	iters: 300, epoch: 22 | loss: 0.0004525
	speed: 0.2575s/iter; left time: 1010.0617s
	iters: 400, epoch: 22 | loss: 0.0015813
	speed: 0.2688s/iter; left time: 1027.3546s
Epoch: 22 cost time: 121.80632185935974
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0001416
	speed: 1.2337s/iter; left time: 4506.6882s
	iters: 200, epoch: 23 | loss: 0.0043154
	speed: 0.2393s/iter; left time: 850.3112s
	iters: 300, epoch: 23 | loss: 0.0004848
	speed: 0.2351s/iter; left time: 811.8745s
	iters: 400, epoch: 23 | loss: 0.0004300
	speed: 0.2462s/iter; left time: 825.4067s
Epoch: 23 cost time: 115.09978795051575
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 9380618
model size : 37.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6783890
	speed: 0.2047s/iter; left time: 2859.5180s
	iters: 200, epoch: 1 | loss: 0.3214334
	speed: 0.1591s/iter; left time: 2207.5206s
	iters: 300, epoch: 1 | loss: 0.0743259
	speed: 0.1802s/iter; left time: 2481.7813s
	iters: 400, epoch: 1 | loss: 0.1508804
	speed: 0.1929s/iter; left time: 2636.8760s
Epoch: 1 cost time: 87.04954719543457
Epoch: 1, Steps: 469 | Train Loss: 0.567 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (inf --> -0.963692).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0919758
	speed: 0.8817s/iter; left time: 11904.5865s
	iters: 200, epoch: 2 | loss: 0.2239255
	speed: 0.1902s/iter; left time: 2549.2625s
	iters: 300, epoch: 2 | loss: 0.0115996
	speed: 0.1908s/iter; left time: 2538.0451s
	iters: 400, epoch: 2 | loss: 0.0230208
	speed: 0.1771s/iter; left time: 2337.5068s
Epoch: 2 cost time: 85.33419752120972
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.963692 --> -0.969696).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0832802
	speed: 0.8682s/iter; left time: 11314.7573s
	iters: 200, epoch: 3 | loss: 0.0254429
	speed: 0.1593s/iter; left time: 2059.6095s
	iters: 300, epoch: 3 | loss: 0.0746508
	speed: 0.1721s/iter; left time: 2208.4016s
	iters: 400, epoch: 3 | loss: 0.0049210
	speed: 0.1606s/iter; left time: 2045.4630s
Epoch: 3 cost time: 79.88034963607788
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021368
	speed: 0.7633s/iter; left time: 9590.3496s
	iters: 200, epoch: 4 | loss: 0.0024141
	speed: 0.1613s/iter; left time: 2009.8460s
	iters: 300, epoch: 4 | loss: 0.0100604
	speed: 0.1806s/iter; left time: 2233.4492s
	iters: 400, epoch: 4 | loss: 0.1239183
	speed: 0.1513s/iter; left time: 1855.1749s
Epoch: 4 cost time: 76.483895778656
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969696 --> -0.970268).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0427555
	speed: 0.7773s/iter; left time: 9401.5917s
	iters: 200, epoch: 5 | loss: 0.0352599
	speed: 0.1795s/iter; left time: 2153.1782s
	iters: 300, epoch: 5 | loss: 0.0037334
	speed: 0.1658s/iter; left time: 1972.3922s
	iters: 400, epoch: 5 | loss: 0.0053247
	speed: 0.1548s/iter; left time: 1826.4066s
Epoch: 5 cost time: 79.00515246391296
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.970268 --> -0.971983).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0075806
	speed: 0.8067s/iter; left time: 9378.1703s
	iters: 200, epoch: 6 | loss: 0.0010724
	speed: 0.1621s/iter; left time: 1868.7591s
	iters: 300, epoch: 6 | loss: 0.0013414
	speed: 0.1589s/iter; left time: 1815.5992s
	iters: 400, epoch: 6 | loss: 0.0006870
	speed: 0.1601s/iter; left time: 1812.9985s
Epoch: 6 cost time: 71.65459752082825
Epoch: 6, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
Validation loss decreased (-0.971983 --> -0.978844).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0018062
	speed: 0.7359s/iter; left time: 8210.2122s
	iters: 200, epoch: 7 | loss: 0.0004084
	speed: 0.1533s/iter; left time: 1694.6033s
	iters: 300, epoch: 7 | loss: 0.0117626
	speed: 0.1849s/iter; left time: 2025.8784s
	iters: 400, epoch: 7 | loss: 0.0005701
	speed: 0.1708s/iter; left time: 1853.8901s
Epoch: 7 cost time: 79.44130516052246
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0004942
	speed: 0.8077s/iter; left time: 8632.2893s
	iters: 200, epoch: 8 | loss: 0.0403482
	speed: 0.1731s/iter; left time: 1833.3009s
	iters: 300, epoch: 8 | loss: 0.0028283
	speed: 0.1625s/iter; left time: 1704.0941s
	iters: 400, epoch: 8 | loss: 0.0410057
	speed: 0.1733s/iter; left time: 1800.1692s
Epoch: 8 cost time: 81.33940291404724
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5220606
	speed: 0.7507s/iter; left time: 7671.2409s
	iters: 200, epoch: 9 | loss: 0.0048348
	speed: 0.1343s/iter; left time: 1358.7747s
	iters: 300, epoch: 9 | loss: 0.0007684
	speed: 0.1500s/iter; left time: 1502.6142s
	iters: 400, epoch: 9 | loss: 0.0041559
	speed: 0.1650s/iter; left time: 1636.2820s
Epoch: 9 cost time: 70.9068853855133
Epoch: 9, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0004949
	speed: 0.7195s/iter; left time: 7015.3211s
	iters: 200, epoch: 10 | loss: 0.0072823
	speed: 0.1512s/iter; left time: 1458.7783s
	iters: 300, epoch: 10 | loss: 0.0042551
	speed: 0.1631s/iter; left time: 1557.8228s
	iters: 400, epoch: 10 | loss: 0.0370837
	speed: 0.1481s/iter; left time: 1399.1524s
Epoch: 10 cost time: 71.84838938713074
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0003870
	speed: 0.8242s/iter; left time: 7649.0243s
	iters: 200, epoch: 11 | loss: 0.0012533
	speed: 0.1983s/iter; left time: 1820.2266s
	iters: 300, epoch: 11 | loss: 0.0022005
	speed: 0.2093s/iter; left time: 1901.0784s
	iters: 400, epoch: 11 | loss: 0.0067447
	speed: 0.2029s/iter; left time: 1822.1941s
Epoch: 11 cost time: 95.43728637695312
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0001799
	speed: 0.9221s/iter; left time: 8125.1370s
	iters: 200, epoch: 12 | loss: 0.0004254
	speed: 0.1993s/iter; left time: 1736.6909s
	iters: 300, epoch: 12 | loss: 0.1630608
	speed: 0.2061s/iter; left time: 1774.7587s
	iters: 400, epoch: 12 | loss: 0.0012192
	speed: 0.2024s/iter; left time: 1723.0998s
Epoch: 12 cost time: 95.34248375892639
Epoch: 12, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0001704
	speed: 0.9167s/iter; left time: 7647.7415s
	iters: 200, epoch: 13 | loss: 0.0094235
	speed: 0.1729s/iter; left time: 1425.2445s
	iters: 300, epoch: 13 | loss: 0.0011640
	speed: 0.1914s/iter; left time: 1558.5316s
	iters: 400, epoch: 13 | loss: 0.0002914
	speed: 0.1862s/iter; left time: 1497.5147s
Epoch: 13 cost time: 87.60363626480103
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0120544
	speed: 0.7687s/iter; left time: 6052.7711s
	iters: 200, epoch: 14 | loss: 0.0245374
	speed: 0.1786s/iter; left time: 1388.4099s
	iters: 300, epoch: 14 | loss: 0.0003679
	speed: 0.1742s/iter; left time: 1336.5786s
	iters: 400, epoch: 14 | loss: 0.0006262
	speed: 0.1828s/iter; left time: 1384.3352s
Epoch: 14 cost time: 83.29325366020203
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0003926
	speed: 0.8320s/iter; left time: 6160.9343s
	iters: 200, epoch: 15 | loss: 0.0001466
	speed: 0.1792s/iter; left time: 1309.3769s
	iters: 300, epoch: 15 | loss: 0.0012563
	speed: 0.1938s/iter; left time: 1396.5552s
	iters: 400, epoch: 15 | loss: 0.0005992
	speed: 0.1991s/iter; left time: 1414.9185s
Epoch: 15 cost time: 87.55138182640076
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0015769
	speed: 0.9091s/iter; left time: 6305.7292s
	iters: 200, epoch: 16 | loss: 0.0005576
	speed: 0.1819s/iter; left time: 1243.1674s
	iters: 300, epoch: 16 | loss: 0.0003400
	speed: 0.1830s/iter; left time: 1232.6202s
	iters: 400, epoch: 16 | loss: 0.0017735
	speed: 0.1987s/iter; left time: 1318.7168s
Epoch: 16 cost time: 88.61748027801514
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0002207
	speed: 0.8928s/iter; left time: 5773.5215s
	iters: 200, epoch: 17 | loss: 0.0010343
	speed: 0.1437s/iter; left time: 915.1345s
	iters: 300, epoch: 17 | loss: 0.0035181
	speed: 0.1621s/iter; left time: 1015.9566s
	iters: 400, epoch: 17 | loss: 0.0003497
	speed: 0.1682s/iter; left time: 1037.2543s
Epoch: 17 cost time: 77.19084191322327
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000936
	speed: 0.8216s/iter; left time: 4928.1888s
	iters: 200, epoch: 18 | loss: 0.0113833
	speed: 0.1521s/iter; left time: 896.8726s
	iters: 300, epoch: 18 | loss: 1.2890393
	speed: 0.1669s/iter; left time: 967.7693s
	iters: 400, epoch: 18 | loss: 0.0010642
	speed: 0.1629s/iter; left time: 928.2447s
Epoch: 18 cost time: 77.45699572563171
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0010521
	speed: 0.8849s/iter; left time: 4892.3583s
	iters: 200, epoch: 19 | loss: 0.0638804
	speed: 0.1836s/iter; left time: 996.6940s
	iters: 300, epoch: 19 | loss: 0.0002924
	speed: 0.1779s/iter; left time: 947.8074s
	iters: 400, epoch: 19 | loss: 0.0007122
	speed: 0.1780s/iter; left time: 930.8901s
Epoch: 19 cost time: 85.31333374977112
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000468
	speed: 0.8889s/iter; left time: 4497.9657s
	iters: 200, epoch: 20 | loss: 0.0008680
	speed: 0.1359s/iter; left time: 673.9538s
	iters: 300, epoch: 20 | loss: 0.0001923
	speed: 0.1638s/iter; left time: 796.0633s
	iters: 400, epoch: 20 | loss: 0.0044000
	speed: 0.1804s/iter; left time: 858.7427s
Epoch: 20 cost time: 78.02883458137512
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0004535
	speed: 0.8567s/iter; left time: 3933.0913s
	iters: 200, epoch: 21 | loss: 0.0001839
	speed: 0.1840s/iter; left time: 826.1497s
	iters: 300, epoch: 21 | loss: 0.0007654
	speed: 0.1674s/iter; left time: 735.1456s
	iters: 400, epoch: 21 | loss: 0.0000526
	speed: 0.1551s/iter; left time: 665.3345s
Epoch: 21 cost time: 80.77427268028259
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0004174
	speed: 0.8281s/iter; left time: 3413.3770s
	iters: 200, epoch: 22 | loss: 0.0001179
	speed: 0.1977s/iter; left time: 795.0143s
	iters: 300, epoch: 22 | loss: 0.0029209
	speed: 0.1943s/iter; left time: 762.0145s
	iters: 400, epoch: 22 | loss: 0.0244554
	speed: 0.1801s/iter; left time: 688.1999s
Epoch: 22 cost time: 87.82217788696289
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0013847
	speed: 0.8672s/iter; left time: 3167.9041s
	iters: 200, epoch: 23 | loss: 0.0000349
	speed: 0.1969s/iter; left time: 699.5793s
	iters: 300, epoch: 23 | loss: 0.0246769
	speed: 0.1977s/iter; left time: 682.7562s
	iters: 400, epoch: 23 | loss: 0.0012406
	speed: 0.1946s/iter; left time: 652.3787s
Epoch: 23 cost time: 91.89217066764832
Epoch: 23, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0053268
	speed: 0.8762s/iter; left time: 2789.6897s
	iters: 200, epoch: 24 | loss: 0.0106259
	speed: 0.1948s/iter; left time: 600.8647s
	iters: 300, epoch: 24 | loss: 0.0282389
	speed: 0.1924s/iter; left time: 574.0326s
	iters: 400, epoch: 24 | loss: 0.4085234
	speed: 0.1935s/iter; left time: 557.9760s
Epoch: 24 cost time: 90.77746438980103
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 2760458
model size : 11.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0332404
	speed: 0.6432s/iter; left time: 8985.8399s
	iters: 200, epoch: 1 | loss: 0.3050104
	speed: 0.6175s/iter; left time: 8565.9250s
	iters: 300, epoch: 1 | loss: 0.1176945
	speed: 0.6706s/iter; left time: 9234.7453s
	iters: 400, epoch: 1 | loss: 0.0438195
	speed: 0.6415s/iter; left time: 8769.8817s
Epoch: 1 cost time: 302.5514991283417
Epoch: 1, Steps: 469 | Train Loss: 0.591 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
Validation loss decreased (inf --> -0.945681).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0357114
	speed: 1.9234s/iter; left time: 25969.5692s
	iters: 200, epoch: 2 | loss: 0.0085918
	speed: 0.5871s/iter; left time: 7868.0179s
	iters: 300, epoch: 2 | loss: 0.0390730
	speed: 0.6070s/iter; left time: 8074.4243s
	iters: 400, epoch: 2 | loss: 0.0129600
	speed: 0.6175s/iter; left time: 8151.5862s
Epoch: 2 cost time: 287.44189453125
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.945681 --> -0.969696).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0807064
	speed: 1.9046s/iter; left time: 24823.1428s
	iters: 200, epoch: 3 | loss: 0.0383013
	speed: 0.5986s/iter; left time: 7741.2421s
	iters: 300, epoch: 3 | loss: 0.0101882
	speed: 0.6466s/iter; left time: 8298.0313s
	iters: 400, epoch: 3 | loss: 0.0445916
	speed: 0.6298s/iter; left time: 8019.3687s
Epoch: 3 cost time: 295.37699341773987
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0037895
	speed: 2.0384s/iter; left time: 25610.0125s
	iters: 200, epoch: 4 | loss: 0.0371117
	speed: 0.6186s/iter; left time: 7710.0973s
	iters: 300, epoch: 4 | loss: 0.0062929
	speed: 0.6242s/iter; left time: 7717.7003s
	iters: 400, epoch: 4 | loss: 0.0078951
	speed: 0.6170s/iter; left time: 7567.1758s
Epoch: 4 cost time: 295.54629278182983
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.969696 --> -0.975414).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0025402
	speed: 1.9184s/iter; left time: 23203.6406s
	iters: 200, epoch: 5 | loss: 0.0819445
	speed: 0.6245s/iter; left time: 7490.7773s
	iters: 300, epoch: 5 | loss: 0.0031419
	speed: 0.6248s/iter; left time: 7432.4734s
	iters: 400, epoch: 5 | loss: 0.0058019
	speed: 0.5732s/iter; left time: 6760.5683s
Epoch: 5 cost time: 283.04272723197937
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.975414 --> -0.980274).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0023624
	speed: 1.7013s/iter; left time: 19779.0137s
	iters: 200, epoch: 6 | loss: 0.0106529
	speed: 0.5391s/iter; left time: 6213.4364s
	iters: 300, epoch: 6 | loss: 0.0049102
	speed: 0.6013s/iter; left time: 6870.7300s
	iters: 400, epoch: 6 | loss: 0.1387850
	speed: 0.5945s/iter; left time: 6733.5018s
Epoch: 6 cost time: 264.1305465698242
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0458384
	speed: 1.7643s/iter; left time: 19684.3797s
	iters: 200, epoch: 7 | loss: 0.0052037
	speed: 0.4423s/iter; left time: 4890.3882s
	iters: 300, epoch: 7 | loss: 0.0016253
	speed: 0.5746s/iter; left time: 6295.4632s
	iters: 400, epoch: 7 | loss: 0.0131796
	speed: 0.6330s/iter; left time: 6872.9288s
Epoch: 7 cost time: 262.42819380760193
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0009072
	speed: 1.9067s/iter; left time: 20378.9344s
	iters: 200, epoch: 8 | loss: 0.0261780
	speed: 0.5965s/iter; left time: 6315.7362s
	iters: 300, epoch: 8 | loss: 0.2850246
	speed: 0.5846s/iter; left time: 6131.7451s
	iters: 400, epoch: 8 | loss: 0.0500322
	speed: 0.5994s/iter; left time: 6227.0442s
Epoch: 8 cost time: 283.7667546272278
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0011578
	speed: 1.6328s/iter; left time: 16686.0922s
	iters: 200, epoch: 9 | loss: 0.0009036
	speed: 0.5822s/iter; left time: 5890.8419s
	iters: 300, epoch: 9 | loss: 0.0875510
	speed: 0.5842s/iter; left time: 5853.3127s
	iters: 400, epoch: 9 | loss: 0.0042565
	speed: 0.4630s/iter; left time: 4592.6091s
Epoch: 9 cost time: 254.13580536842346
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0035599
	speed: 1.6375s/iter; left time: 15966.0632s
	iters: 200, epoch: 10 | loss: 0.0007650
	speed: 0.5464s/iter; left time: 5272.4665s
	iters: 300, epoch: 10 | loss: 0.0011508
	speed: 0.5417s/iter; left time: 5173.3770s
	iters: 400, epoch: 10 | loss: 0.0020622
	speed: 0.5401s/iter; left time: 5104.3746s
Epoch: 10 cost time: 260.76060938835144
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0334703
	speed: 1.7090s/iter; left time: 15861.1420s
	iters: 200, epoch: 11 | loss: 0.0113610
	speed: 0.5007s/iter; left time: 4596.4728s
	iters: 300, epoch: 11 | loss: 0.0007768
	speed: 0.5386s/iter; left time: 4891.1912s
	iters: 400, epoch: 11 | loss: 0.5243757
	speed: 0.5301s/iter; left time: 4760.5758s
Epoch: 11 cost time: 254.01609230041504
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.958 Test Loss: 0.193 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0045789
	speed: 1.8103s/iter; left time: 15952.0130s
	iters: 200, epoch: 12 | loss: 0.0006489
	speed: 0.5668s/iter; left time: 4938.1157s
	iters: 300, epoch: 12 | loss: 0.0005975
	speed: 0.6073s/iter; left time: 5229.8201s
	iters: 400, epoch: 12 | loss: 0.0037740
	speed: 0.5650s/iter; left time: 4808.9526s
Epoch: 12 cost time: 281.80098819732666
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0081851
	speed: 2.1725s/iter; left time: 18124.7670s
	iters: 200, epoch: 13 | loss: 0.0012088
	speed: 0.7343s/iter; left time: 6052.5798s
	iters: 300, epoch: 13 | loss: 0.0118878
	speed: 0.7440s/iter; left time: 6058.3984s
	iters: 400, epoch: 13 | loss: 0.0032132
	speed: 0.6910s/iter; left time: 5557.4708s
Epoch: 13 cost time: 343.7160415649414
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0120002
	speed: 2.2225s/iter; left time: 17500.0165s
	iters: 200, epoch: 14 | loss: 0.0011092
	speed: 0.6288s/iter; left time: 4888.3886s
	iters: 300, epoch: 14 | loss: 0.0035774
	speed: 0.6494s/iter; left time: 4983.2688s
	iters: 400, epoch: 14 | loss: 0.0005298
	speed: 0.6914s/iter; left time: 5236.8413s
Epoch: 14 cost time: 317.7543087005615
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.982275).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0057681
	speed: 1.9903s/iter; left time: 14738.4006s
	iters: 200, epoch: 15 | loss: 0.0004815
	speed: 0.6811s/iter; left time: 4975.1805s
	iters: 300, epoch: 15 | loss: 0.0044309
	speed: 0.7657s/iter; left time: 5516.5867s
	iters: 400, epoch: 15 | loss: 0.0180457
	speed: 0.7760s/iter; left time: 5513.2728s
Epoch: 15 cost time: 331.21605801582336
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002143
	speed: 1.8451s/iter; left time: 12797.3696s
	iters: 200, epoch: 16 | loss: 0.0033319
	speed: 0.6480s/iter; left time: 4429.7864s
	iters: 300, epoch: 16 | loss: 0.0941961
	speed: 0.6757s/iter; left time: 4551.5274s
	iters: 400, epoch: 16 | loss: 0.0004389
	speed: 0.6530s/iter; left time: 4332.9847s
Epoch: 16 cost time: 309.25949120521545
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1152747
	speed: 2.0383s/iter; left time: 13181.4268s
	iters: 200, epoch: 17 | loss: 0.0469144
	speed: 0.6099s/iter; left time: 3883.1485s
	iters: 300, epoch: 17 | loss: 0.0015939
	speed: 0.5778s/iter; left time: 3621.0881s
	iters: 400, epoch: 17 | loss: 0.0005145
	speed: 0.6530s/iter; left time: 4026.8556s
Epoch: 17 cost time: 298.08438324928284
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0014133
	speed: 2.0985s/iter; left time: 12586.8835s
	iters: 200, epoch: 18 | loss: 0.0026454
	speed: 0.5515s/iter; left time: 3253.0306s
	iters: 300, epoch: 18 | loss: 0.0024403
	speed: 0.6050s/iter; left time: 3507.7266s
	iters: 400, epoch: 18 | loss: 0.0130983
	speed: 0.6523s/iter; left time: 3716.7285s
Epoch: 18 cost time: 293.8920464515686
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0006122
	speed: 1.8853s/iter; left time: 10423.6641s
	iters: 200, epoch: 19 | loss: 0.0005186
	speed: 0.6439s/iter; left time: 3495.4979s
	iters: 300, epoch: 19 | loss: 0.0047034
	speed: 0.6053s/iter; left time: 3225.6272s
	iters: 400, epoch: 19 | loss: 0.0003888
	speed: 0.5962s/iter; left time: 3117.7214s
Epoch: 19 cost time: 288.37541484832764
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0005119
	speed: 1.8204s/iter; left time: 9211.2353s
	iters: 200, epoch: 20 | loss: 0.0005803
	speed: 0.6175s/iter; left time: 3062.5966s
	iters: 300, epoch: 20 | loss: 0.0026441
	speed: 0.5506s/iter; left time: 2675.9907s
	iters: 400, epoch: 20 | loss: 0.0003987
	speed: 0.5240s/iter; left time: 2494.4690s
Epoch: 20 cost time: 275.00955629348755
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0260739
	speed: 1.9622s/iter; left time: 9008.3944s
	iters: 200, epoch: 21 | loss: 0.0009299
	speed: 0.6922s/iter; left time: 3108.8248s
	iters: 300, epoch: 21 | loss: 0.0007996
	speed: 0.7120s/iter; left time: 3126.5029s
	iters: 400, epoch: 21 | loss: 0.0005938
	speed: 0.6780s/iter; left time: 2909.1836s
Epoch: 21 cost time: 316.20736813545227
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0021085
	speed: 1.7271s/iter; left time: 7118.9331s
	iters: 200, epoch: 22 | loss: 0.0027999
	speed: 0.6085s/iter; left time: 2447.2732s
	iters: 300, epoch: 22 | loss: 0.0409763
	speed: 0.6327s/iter; left time: 2481.5582s
	iters: 400, epoch: 22 | loss: 0.0003386
	speed: 0.6505s/iter; left time: 2486.1958s
Epoch: 22 cost time: 292.88365030288696
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0003262
	speed: 1.8753s/iter; left time: 6850.4259s
	iters: 200, epoch: 23 | loss: 0.0123715
	speed: 0.4519s/iter; left time: 1605.6916s
	iters: 300, epoch: 23 | loss: 0.0005770
	speed: 0.5562s/iter; left time: 1920.6812s
	iters: 400, epoch: 23 | loss: 0.0036196
	speed: 0.5686s/iter; left time: 1906.5687s
Epoch: 23 cost time: 254.9106526374817
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0039005
	speed: 1.8352s/iter; left time: 5843.2996s
	iters: 200, epoch: 24 | loss: 0.0004154
	speed: 0.5229s/iter; left time: 1612.6521s
	iters: 300, epoch: 24 | loss: 0.0018486
	speed: 0.5040s/iter; left time: 1503.9423s
	iters: 400, epoch: 24 | loss: 0.0001333
	speed: 0.5263s/iter; left time: 1517.7432s
Epoch: 24 cost time: 251.3324739933014
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 9378442
model size : 36.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9305151
	speed: 0.3440s/iter; left time: 4806.3391s
	iters: 200, epoch: 1 | loss: 0.2524485
	speed: 0.3436s/iter; left time: 4766.0159s
	iters: 300, epoch: 1 | loss: 0.3468114
	speed: 0.3883s/iter; left time: 5346.6368s
	iters: 400, epoch: 1 | loss: 0.0384618
	speed: 0.3473s/iter; left time: 4747.3989s
Epoch: 1 cost time: 168.2466700077057
Epoch: 1, Steps: 469 | Train Loss: 0.593 Vali Loss: 0.293 Vali Acc: 0.908 Test Loss: 0.293 Test Acc: 0.908
Validation loss decreased (inf --> -0.908230).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0752909
	speed: 1.1053s/iter; left time: 14924.3056s
	iters: 200, epoch: 2 | loss: 0.0168211
	speed: 0.3449s/iter; left time: 4621.9794s
	iters: 300, epoch: 2 | loss: 0.0245027
	speed: 0.3802s/iter; left time: 5057.7406s
	iters: 400, epoch: 2 | loss: 0.0166401
	speed: 0.3738s/iter; left time: 4935.3951s
Epoch: 2 cost time: 172.9484100341797
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
Validation loss decreased (-0.908230 --> -0.952543).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0465469
	speed: 1.2433s/iter; left time: 16204.4324s
	iters: 200, epoch: 3 | loss: 0.2777205
	speed: 0.3056s/iter; left time: 3952.2172s
	iters: 300, epoch: 3 | loss: 0.0647355
	speed: 0.3413s/iter; left time: 4380.0994s
	iters: 400, epoch: 3 | loss: 0.1353631
	speed: 0.3219s/iter; left time: 4099.3009s
Epoch: 3 cost time: 157.00060653686523
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.952543 --> -0.978844).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0162087
	speed: 1.0890s/iter; left time: 13682.0702s
	iters: 200, epoch: 4 | loss: 0.0077384
	speed: 0.3668s/iter; left time: 4571.6048s
	iters: 300, epoch: 4 | loss: 0.0059351
	speed: 0.3777s/iter; left time: 4670.3607s
	iters: 400, epoch: 4 | loss: 0.0086555
	speed: 0.3753s/iter; left time: 4602.3741s
Epoch: 4 cost time: 171.29634380340576
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0593517
	speed: 1.0906s/iter; left time: 13190.9706s
	iters: 200, epoch: 5 | loss: 0.0059510
	speed: 0.3381s/iter; left time: 4056.0935s
	iters: 300, epoch: 5 | loss: 0.0260361
	speed: 0.3478s/iter; left time: 4136.6242s
	iters: 400, epoch: 5 | loss: 0.0074456
	speed: 0.3376s/iter; left time: 3981.4124s
Epoch: 5 cost time: 159.93706846237183
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0044043
	speed: 0.9186s/iter; left time: 10680.0963s
	iters: 200, epoch: 6 | loss: 0.0851285
	speed: 0.3273s/iter; left time: 3772.3973s
	iters: 300, epoch: 6 | loss: 0.0192436
	speed: 0.3119s/iter; left time: 3564.0969s
	iters: 400, epoch: 6 | loss: 0.0007599
	speed: 0.2932s/iter; left time: 3320.5756s
Epoch: 6 cost time: 147.3391351699829
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0012831
	speed: 1.0407s/iter; left time: 11611.1329s
	iters: 200, epoch: 7 | loss: 0.0010664
	speed: 0.2842s/iter; left time: 3142.4001s
	iters: 300, epoch: 7 | loss: 0.0055710
	speed: 0.2951s/iter; left time: 3233.1810s
	iters: 400, epoch: 7 | loss: 0.0072496
	speed: 0.2914s/iter; left time: 3163.8143s
Epoch: 7 cost time: 138.31866002082825
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0380027
	speed: 0.9322s/iter; left time: 9963.7576s
	iters: 200, epoch: 8 | loss: 0.0009768
	speed: 0.3070s/iter; left time: 3250.9502s
	iters: 300, epoch: 8 | loss: 0.0028889
	speed: 0.3121s/iter; left time: 3272.8463s
	iters: 400, epoch: 8 | loss: 0.0061395
	speed: 0.3008s/iter; left time: 3124.4925s
Epoch: 8 cost time: 146.2667419910431
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0031659
	speed: 1.0911s/iter; left time: 11150.3972s
	iters: 200, epoch: 9 | loss: 0.0059390
	speed: 0.3316s/iter; left time: 3355.6102s
	iters: 300, epoch: 9 | loss: 0.0018826
	speed: 0.3294s/iter; left time: 3300.6797s
	iters: 400, epoch: 9 | loss: 0.0025361
	speed: 0.3141s/iter; left time: 3115.5104s
Epoch: 9 cost time: 154.9334261417389
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0025584
	speed: 0.9797s/iter; left time: 9551.6418s
	iters: 200, epoch: 10 | loss: 0.2660418
	speed: 0.3245s/iter; left time: 3131.8532s
	iters: 300, epoch: 10 | loss: 0.0011459
	speed: 0.3850s/iter; left time: 3676.4125s
	iters: 400, epoch: 10 | loss: 0.0009157
	speed: 0.4128s/iter; left time: 3901.0340s
Epoch: 10 cost time: 171.21277689933777
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979988).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0042946
	speed: 1.2430s/iter; left time: 11536.2755s
	iters: 200, epoch: 11 | loss: 0.0316461
	speed: 0.3867s/iter; left time: 3550.1056s
	iters: 300, epoch: 11 | loss: 0.0096794
	speed: 0.3530s/iter; left time: 3205.6539s
	iters: 400, epoch: 11 | loss: 0.0089821
	speed: 0.3367s/iter; left time: 3024.0994s
Epoch: 11 cost time: 171.9406497478485
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0040761
	speed: 1.1027s/iter; left time: 9717.3180s
	iters: 200, epoch: 12 | loss: 0.0026446
	speed: 0.3636s/iter; left time: 3167.6958s
	iters: 300, epoch: 12 | loss: 0.0003431
	speed: 0.3559s/iter; left time: 3065.3389s
	iters: 400, epoch: 12 | loss: 0.0008154
	speed: 0.3952s/iter; left time: 3364.2626s
Epoch: 12 cost time: 171.4810106754303
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0016441
	speed: 1.1370s/iter; left time: 9486.1205s
	iters: 200, epoch: 13 | loss: 0.0862017
	speed: 0.3430s/iter; left time: 2827.6770s
	iters: 300, epoch: 13 | loss: 0.0808872
	speed: 0.3430s/iter; left time: 2792.6518s
	iters: 400, epoch: 13 | loss: 0.0028031
	speed: 0.3379s/iter; left time: 2718.0226s
Epoch: 13 cost time: 156.89940857887268
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002485
	speed: 1.1469s/iter; left time: 9030.3759s
	iters: 200, epoch: 14 | loss: 0.0002757
	speed: 0.3998s/iter; left time: 3107.7757s
	iters: 300, epoch: 14 | loss: 0.0438189
	speed: 0.3287s/iter; left time: 2522.0716s
	iters: 400, epoch: 14 | loss: 0.0112195
	speed: 0.3187s/iter; left time: 2413.7695s
Epoch: 14 cost time: 171.52155375480652
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0043918
	speed: 1.1774s/iter; left time: 8718.8807s
	iters: 200, epoch: 15 | loss: 0.0057454
	speed: 0.3228s/iter; left time: 2358.4083s
	iters: 300, epoch: 15 | loss: 0.0006797
	speed: 0.3617s/iter; left time: 2606.2823s
	iters: 400, epoch: 15 | loss: 0.0004225
	speed: 0.3735s/iter; left time: 2654.0613s
Epoch: 15 cost time: 166.6102364063263
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.961 Test Loss: 0.223 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0033605
	speed: 1.1586s/iter; left time: 8035.8605s
	iters: 200, epoch: 16 | loss: 0.0023487
	speed: 0.3824s/iter; left time: 2614.1090s
	iters: 300, epoch: 16 | loss: 0.0002952
	speed: 0.3828s/iter; left time: 2578.7895s
	iters: 400, epoch: 16 | loss: 0.1374966
	speed: 0.3491s/iter; left time: 2316.9419s
Epoch: 16 cost time: 172.1909580230713
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980559).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0003912
	speed: 1.1546s/iter; left time: 7466.9760s
	iters: 200, epoch: 17 | loss: 0.0004660
	speed: 0.3455s/iter; left time: 2199.8786s
	iters: 300, epoch: 17 | loss: 0.0030085
	speed: 0.3415s/iter; left time: 2140.2448s
	iters: 400, epoch: 17 | loss: 0.0060164
	speed: 0.3556s/iter; left time: 2192.8644s
Epoch: 17 cost time: 166.08563828468323
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0184007
	speed: 1.0412s/iter; left time: 6245.1346s
	iters: 200, epoch: 18 | loss: 0.0030621
	speed: 0.3396s/iter; left time: 2003.0441s
	iters: 300, epoch: 18 | loss: 0.0020145
	speed: 0.3608s/iter; left time: 2091.7799s
	iters: 400, epoch: 18 | loss: 0.0022099
	speed: 0.3675s/iter; left time: 2094.1076s
Epoch: 18 cost time: 164.33464884757996
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0002961
	speed: 1.0968s/iter; left time: 6064.0089s
	iters: 200, epoch: 19 | loss: 0.0001044
	speed: 0.3589s/iter; left time: 1948.5581s
	iters: 300, epoch: 19 | loss: 0.0063657
	speed: 0.3311s/iter; left time: 1764.4194s
	iters: 400, epoch: 19 | loss: 0.0180966
	speed: 0.3171s/iter; left time: 1658.3020s
Epoch: 19 cost time: 159.93605613708496
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0008100
	speed: 1.0530s/iter; left time: 5328.0794s
	iters: 200, epoch: 20 | loss: 0.3162979
	speed: 0.3296s/iter; left time: 1634.5703s
	iters: 300, epoch: 20 | loss: 0.0146675
	speed: 0.3489s/iter; left time: 1695.8949s
	iters: 400, epoch: 20 | loss: 0.0006555
	speed: 0.3693s/iter; left time: 1757.6840s
Epoch: 20 cost time: 166.46881771087646
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0001209
	speed: 1.1305s/iter; left time: 5189.9645s
	iters: 200, epoch: 21 | loss: 0.0003442
	speed: 0.3587s/iter; left time: 1610.7076s
	iters: 300, epoch: 21 | loss: 0.0001266
	speed: 0.3594s/iter; left time: 1578.1254s
	iters: 400, epoch: 21 | loss: 0.0072039
	speed: 0.3147s/iter; left time: 1350.2016s
Epoch: 21 cost time: 159.0597424507141
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0229056
	speed: 1.0057s/iter; left time: 4145.2994s
	iters: 200, epoch: 22 | loss: 0.0010165
	speed: 0.3074s/iter; left time: 1236.1668s
	iters: 300, epoch: 22 | loss: 0.0036094
	speed: 0.2046s/iter; left time: 802.5775s
	iters: 400, epoch: 22 | loss: 0.0106778
	speed: 0.3199s/iter; left time: 1222.6095s
Epoch: 22 cost time: 135.34519624710083
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0031380
	speed: 1.0031s/iter; left time: 3664.2012s
	iters: 200, epoch: 23 | loss: 0.0165517
	speed: 0.2776s/iter; left time: 986.2808s
	iters: 300, epoch: 23 | loss: 0.0001599
	speed: 0.3001s/iter; left time: 1036.4069s
	iters: 400, epoch: 23 | loss: 0.0000975
	speed: 0.2903s/iter; left time: 973.4947s
Epoch: 23 cost time: 137.17536211013794
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.980559 --> -0.983990).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0015462
	speed: 1.0111s/iter; left time: 3219.4934s
	iters: 200, epoch: 24 | loss: 0.0003538
	speed: 0.3202s/iter; left time: 987.3978s
	iters: 300, epoch: 24 | loss: 0.0011909
	speed: 0.3469s/iter; left time: 1035.0853s
	iters: 400, epoch: 24 | loss: 0.0026283
	speed: 0.3471s/iter; left time: 1001.0504s
Epoch: 24 cost time: 158.58849716186523
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4485507
	speed: 1.1244s/iter; left time: 3052.7904s
	iters: 200, epoch: 25 | loss: 0.0025401
	speed: 0.3062s/iter; left time: 800.6730s
	iters: 300, epoch: 25 | loss: 0.0006182
	speed: 0.3321s/iter; left time: 835.2216s
	iters: 400, epoch: 25 | loss: 0.0013250
	speed: 0.3597s/iter; left time: 868.6488s
Epoch: 25 cost time: 156.63707518577576
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0006944
	speed: 1.0383s/iter; left time: 2332.0445s
	iters: 200, epoch: 26 | loss: 0.0003843
	speed: 0.3405s/iter; left time: 730.6453s
	iters: 300, epoch: 26 | loss: 0.0024423
	speed: 0.3624s/iter; left time: 741.3922s
	iters: 400, epoch: 26 | loss: 0.0178667
	speed: 0.3481s/iter; left time: 677.3191s
Epoch: 26 cost time: 160.1500871181488
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0001230
	speed: 1.0611s/iter; left time: 1885.5143s
	iters: 200, epoch: 27 | loss: 0.0030585
	speed: 0.3080s/iter; left time: 516.5521s
	iters: 300, epoch: 27 | loss: 0.0012862
	speed: 0.3256s/iter; left time: 513.4910s
	iters: 400, epoch: 27 | loss: 0.0071256
	speed: 0.3344s/iter; left time: 493.8368s
Epoch: 27 cost time: 154.21493554115295
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0013302
	speed: 1.0521s/iter; left time: 1376.0859s
	iters: 200, epoch: 28 | loss: 0.0004055
	speed: 0.2176s/iter; left time: 262.9008s
	iters: 300, epoch: 28 | loss: 0.0004776
	speed: 0.3410s/iter; left time: 377.8616s
	iters: 400, epoch: 28 | loss: 0.0018756
	speed: 0.3417s/iter; left time: 344.4698s
Epoch: 28 cost time: 142.58253931999207
Epoch: 28, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000536
	speed: 0.9879s/iter; left time: 828.8369s
	iters: 200, epoch: 29 | loss: 0.0004464
	speed: 0.3141s/iter; left time: 232.1092s
	iters: 300, epoch: 29 | loss: 0.0000799
	speed: 0.3187s/iter; left time: 203.6666s
	iters: 400, epoch: 29 | loss: 0.0000536
	speed: 0.3159s/iter; left time: 170.2463s
Epoch: 29 cost time: 149.41377234458923
Epoch: 29, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.984276).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.3256066
	speed: 1.0162s/iter; left time: 375.9879s
	iters: 200, epoch: 30 | loss: 0.0000972
	speed: 0.2780s/iter; left time: 75.0723s
	iters: 300, epoch: 30 | loss: 0.0002775
	speed: 0.2805s/iter; left time: 47.6812s
	iters: 400, epoch: 30 | loss: 0.0006214
	speed: 0.3445s/iter; left time: 24.1124s
Epoch: 30 cost time: 144.94185376167297
Epoch: 30, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 2758026
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0329841
	speed: 0.4088s/iter; left time: 5711.3703s
	iters: 200, epoch: 1 | loss: 0.2972847
	speed: 0.3988s/iter; left time: 5531.3549s
	iters: 300, epoch: 1 | loss: 0.1110957
	speed: 0.3867s/iter; left time: 5324.8252s
	iters: 400, epoch: 1 | loss: 0.0395651
	speed: 0.3573s/iter; left time: 4884.2572s
Epoch: 1 cost time: 174.69449520111084
Epoch: 1, Steps: 469 | Train Loss: 0.602 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (inf --> -0.948254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0240618
	speed: 1.1401s/iter; left time: 15394.2717s
	iters: 200, epoch: 2 | loss: 0.0072924
	speed: 0.3948s/iter; left time: 5291.6259s
	iters: 300, epoch: 2 | loss: 0.0325633
	speed: 0.3293s/iter; left time: 4380.0804s
	iters: 400, epoch: 2 | loss: 0.0204365
	speed: 0.3591s/iter; left time: 4740.2151s
Epoch: 2 cost time: 166.42736339569092
Epoch: 2, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.948254 --> -0.976271).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1502262
	speed: 1.1549s/iter; left time: 15051.8486s
	iters: 200, epoch: 3 | loss: 0.1420298
	speed: 0.3700s/iter; left time: 4784.9232s
	iters: 300, epoch: 3 | loss: 0.0193565
	speed: 0.3181s/iter; left time: 4082.2828s
	iters: 400, epoch: 3 | loss: 0.0708006
	speed: 0.2470s/iter; left time: 3144.8810s
Epoch: 3 cost time: 153.48887491226196
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0029739
	speed: 1.1343s/iter; left time: 14251.1183s
	iters: 200, epoch: 4 | loss: 0.0037066
	speed: 0.2912s/iter; left time: 3629.3750s
	iters: 300, epoch: 4 | loss: 0.0043753
	speed: 0.3330s/iter; left time: 4117.7727s
	iters: 400, epoch: 4 | loss: 0.0041431
	speed: 0.3391s/iter; left time: 4158.8478s
Epoch: 4 cost time: 155.32322311401367
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0021528
	speed: 1.1089s/iter; left time: 13412.7404s
	iters: 200, epoch: 5 | loss: 0.0252099
	speed: 0.2661s/iter; left time: 3192.4600s
	iters: 300, epoch: 5 | loss: 0.0027686
	speed: 0.3580s/iter; left time: 4258.3913s
	iters: 400, epoch: 5 | loss: 0.0519385
	speed: 0.2524s/iter; left time: 2977.5505s
Epoch: 5 cost time: 145.81655621528625
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.976271 --> -0.977701).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0032638
	speed: 1.2453s/iter; left time: 14478.1459s
	iters: 200, epoch: 6 | loss: 0.0031676
	speed: 0.3225s/iter; left time: 3717.3921s
	iters: 300, epoch: 6 | loss: 0.0064987
	speed: 0.3419s/iter; left time: 3906.6964s
	iters: 400, epoch: 6 | loss: 0.3344354
	speed: 0.3410s/iter; left time: 3862.5447s
Epoch: 6 cost time: 161.33865809440613
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1968358
	speed: 1.2117s/iter; left time: 13518.5406s
	iters: 200, epoch: 7 | loss: 0.0029822
	speed: 0.3254s/iter; left time: 3598.1238s
	iters: 300, epoch: 7 | loss: 0.0011308
	speed: 0.2904s/iter; left time: 3181.5765s
	iters: 400, epoch: 7 | loss: 0.0013292
	speed: 0.3553s/iter; left time: 3857.4614s
Epoch: 7 cost time: 155.19296431541443
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0006091
	speed: 1.0539s/iter; left time: 11264.1925s
	iters: 200, epoch: 8 | loss: 0.0041561
	speed: 0.3761s/iter; left time: 3982.4661s
	iters: 300, epoch: 8 | loss: 0.0556223
	speed: 0.2634s/iter; left time: 2762.1251s
	iters: 400, epoch: 8 | loss: 0.0006282
	speed: 0.2870s/iter; left time: 2981.3460s
Epoch: 8 cost time: 146.3022379875183
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0028096
	speed: 1.2057s/iter; left time: 12320.6491s
	iters: 200, epoch: 9 | loss: 0.0040809
	speed: 0.4130s/iter; left time: 4179.3761s
	iters: 300, epoch: 9 | loss: 0.0009311
	speed: 0.3858s/iter; left time: 3864.8672s
	iters: 400, epoch: 9 | loss: 0.1271192
	speed: 0.3556s/iter; left time: 3526.7778s
Epoch: 9 cost time: 181.33475136756897
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0344812
	speed: 1.3052s/iter; left time: 12726.0572s
	iters: 200, epoch: 10 | loss: 0.0112081
	speed: 0.4288s/iter; left time: 4137.4770s
	iters: 300, epoch: 10 | loss: 0.0039205
	speed: 0.3871s/iter; left time: 3697.2705s
	iters: 400, epoch: 10 | loss: 0.0005482
	speed: 0.4117s/iter; left time: 3890.8831s
Epoch: 10 cost time: 191.280179977417
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1071270
	speed: 1.2491s/iter; left time: 11592.8587s
	iters: 200, epoch: 11 | loss: 0.0114134
	speed: 0.3984s/iter; left time: 3657.4059s
	iters: 300, epoch: 11 | loss: 0.0090462
	speed: 0.4294s/iter; left time: 3899.5651s
	iters: 400, epoch: 11 | loss: 0.4248120
	speed: 0.4153s/iter; left time: 3729.6176s
Epoch: 11 cost time: 188.19412207603455
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.977701 --> -0.983132).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0009145
	speed: 1.2264s/iter; left time: 10806.9696s
	iters: 200, epoch: 12 | loss: 0.0322459
	speed: 0.4094s/iter; left time: 3567.0875s
	iters: 300, epoch: 12 | loss: 0.0009264
	speed: 0.4086s/iter; left time: 3519.1081s
	iters: 400, epoch: 12 | loss: 0.0053849
	speed: 0.3007s/iter; left time: 2559.3449s
Epoch: 12 cost time: 174.78129029273987
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0018737
	speed: 1.1712s/iter; left time: 9771.6178s
	iters: 200, epoch: 13 | loss: 0.0009476
	speed: 0.4087s/iter; left time: 3368.9709s
	iters: 300, epoch: 13 | loss: 0.0073656
	speed: 0.3807s/iter; left time: 3099.6538s
	iters: 400, epoch: 13 | loss: 0.0437526
	speed: 0.4025s/iter; left time: 3237.1644s
Epoch: 13 cost time: 182.89577174186707
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0032897
	speed: 1.1691s/iter; left time: 9205.2170s
	iters: 200, epoch: 14 | loss: 0.0003506
	speed: 0.4015s/iter; left time: 3121.1027s
	iters: 300, epoch: 14 | loss: 0.0030112
	speed: 0.3927s/iter; left time: 3013.8318s
	iters: 400, epoch: 14 | loss: 0.0006078
	speed: 0.4282s/iter; left time: 3243.5569s
Epoch: 14 cost time: 182.7327003479004
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0280779
	speed: 1.2506s/iter; left time: 9260.3393s
	iters: 200, epoch: 15 | loss: 0.0003668
	speed: 0.3880s/iter; left time: 2834.5571s
	iters: 300, epoch: 15 | loss: 0.0006441
	speed: 0.4136s/iter; left time: 2980.3041s
	iters: 400, epoch: 15 | loss: 0.3693488
	speed: 0.4036s/iter; left time: 2867.3247s
Epoch: 15 cost time: 185.7543478012085
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0204399
	speed: 1.2030s/iter; left time: 8344.1139s
	iters: 200, epoch: 16 | loss: 0.0003510
	speed: 0.4036s/iter; left time: 2759.2586s
	iters: 300, epoch: 16 | loss: 0.0023676
	speed: 0.4176s/iter; left time: 2813.0159s
	iters: 400, epoch: 16 | loss: 0.0004592
	speed: 0.3809s/iter; left time: 2527.5577s
Epoch: 16 cost time: 180.4116826057434
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0021545
	speed: 1.1735s/iter; left time: 7589.2950s
	iters: 200, epoch: 17 | loss: 0.0015209
	speed: 0.3463s/iter; left time: 2204.6514s
	iters: 300, epoch: 17 | loss: 0.0026939
	speed: 0.3959s/iter; left time: 2480.9824s
	iters: 400, epoch: 17 | loss: 0.0001120
	speed: 0.3885s/iter; left time: 2395.5871s
Epoch: 17 cost time: 175.55116200447083
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0029134
	speed: 1.1603s/iter; left time: 6959.5330s
	iters: 200, epoch: 18 | loss: 0.0155021
	speed: 0.3495s/iter; left time: 2061.5845s
	iters: 300, epoch: 18 | loss: 0.0018803
	speed: 0.2858s/iter; left time: 1656.8665s
	iters: 400, epoch: 18 | loss: 0.0103336
	speed: 0.3554s/iter; left time: 2025.0569s
Epoch: 18 cost time: 154.00106382369995
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0005850
	speed: 1.1099s/iter; left time: 6136.9075s
	iters: 200, epoch: 19 | loss: 0.0008247
	speed: 0.3443s/iter; left time: 1869.1229s
	iters: 300, epoch: 19 | loss: 0.0032054
	speed: 0.3826s/iter; left time: 2038.7455s
	iters: 400, epoch: 19 | loss: 0.0006888
	speed: 0.3282s/iter; left time: 1716.0069s
Epoch: 19 cost time: 165.6837191581726
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0001501
	speed: 1.0716s/iter; left time: 5422.3846s
	iters: 200, epoch: 20 | loss: 0.0001048
	speed: 0.3667s/iter; left time: 1818.8138s
	iters: 300, epoch: 20 | loss: 0.0030230
	speed: 0.3459s/iter; left time: 1681.2484s
	iters: 400, epoch: 20 | loss: 0.0005186
	speed: 0.2608s/iter; left time: 1241.2955s
Epoch: 20 cost time: 147.45508646965027
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0018391
	speed: 0.9938s/iter; left time: 4562.4017s
	iters: 200, epoch: 21 | loss: 0.0038887
	speed: 0.3501s/iter; left time: 1572.4164s
	iters: 300, epoch: 21 | loss: 0.0012021
	speed: 0.4264s/iter; left time: 1872.2165s
	iters: 400, epoch: 21 | loss: 0.0005844
	speed: 0.3545s/iter; left time: 1520.9690s
Epoch: 21 cost time: 175.22328233718872
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 9378442
model size : 36.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9468558
	speed: 0.2754s/iter; left time: 3847.7987s
	iters: 200, epoch: 1 | loss: 0.2682815
	speed: 0.2654s/iter; left time: 3681.5666s
	iters: 300, epoch: 1 | loss: 0.3466087
	speed: 0.2588s/iter; left time: 3563.7855s
	iters: 400, epoch: 1 | loss: 0.0448605
	speed: 0.2706s/iter; left time: 3699.3295s
Epoch: 1 cost time: 122.36569118499756
Epoch: 1, Steps: 469 | Train Loss: 0.607 Vali Loss: 0.352 Vali Acc: 0.893 Test Loss: 0.352 Test Acc: 0.893
Validation loss decreased (inf --> -0.892792).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0502231
	speed: 0.8664s/iter; left time: 11698.6927s
	iters: 200, epoch: 2 | loss: 0.0151395
	speed: 0.2577s/iter; left time: 3454.1655s
	iters: 300, epoch: 2 | loss: 0.0162032
	speed: 0.2604s/iter; left time: 3463.9083s
	iters: 400, epoch: 2 | loss: 0.0208265
	speed: 0.2218s/iter; left time: 2928.3290s
Epoch: 2 cost time: 113.0571677684784
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.183 Vali Acc: 0.939 Test Loss: 0.183 Test Acc: 0.939
Validation loss decreased (-0.892792 --> -0.939106).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0213942
	speed: 0.8944s/iter; left time: 11657.1011s
	iters: 200, epoch: 3 | loss: 0.2548102
	speed: 0.2191s/iter; left time: 2833.4249s
	iters: 300, epoch: 3 | loss: 0.1093422
	speed: 0.2461s/iter; left time: 3158.2023s
	iters: 400, epoch: 3 | loss: 0.1675799
	speed: 0.2526s/iter; left time: 3216.6736s
Epoch: 3 cost time: 113.38626527786255
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.939106 --> -0.977701).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0066723
	speed: 0.9129s/iter; left time: 11469.6961s
	iters: 200, epoch: 4 | loss: 0.0053092
	speed: 0.2656s/iter; left time: 3309.9210s
	iters: 300, epoch: 4 | loss: 0.0037597
	speed: 0.2123s/iter; left time: 2625.3228s
	iters: 400, epoch: 4 | loss: 0.0063915
	speed: 0.2315s/iter; left time: 2839.0562s
Epoch: 4 cost time: 115.88597512245178
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0104706
	speed: 0.8915s/iter; left time: 10782.1115s
	iters: 200, epoch: 5 | loss: 0.0023037
	speed: 0.2060s/iter; left time: 2470.4357s
	iters: 300, epoch: 5 | loss: 0.2683111
	speed: 0.2594s/iter; left time: 3085.2670s
	iters: 400, epoch: 5 | loss: 0.0238960
	speed: 0.2504s/iter; left time: 2953.0708s
Epoch: 5 cost time: 111.30866837501526
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.977701 --> -0.979988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0893092
	speed: 0.8402s/iter; left time: 9767.8014s
	iters: 200, epoch: 6 | loss: 0.0039774
	speed: 0.2956s/iter; left time: 3407.0897s
	iters: 300, epoch: 6 | loss: 0.0355856
	speed: 0.2583s/iter; left time: 2951.2948s
	iters: 400, epoch: 6 | loss: 0.0065772
	speed: 0.2617s/iter; left time: 2964.3776s
Epoch: 6 cost time: 120.2985200881958
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0012283
	speed: 0.7582s/iter; left time: 8459.6312s
	iters: 200, epoch: 7 | loss: 0.0013018
	speed: 0.2071s/iter; left time: 2289.4645s
	iters: 300, epoch: 7 | loss: 0.0030442
	speed: 0.1963s/iter; left time: 2150.5800s
	iters: 400, epoch: 7 | loss: 0.1811309
	speed: 0.1986s/iter; left time: 2156.6490s
Epoch: 7 cost time: 95.03423285484314
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0048798
	speed: 0.8717s/iter; left time: 9316.6132s
	iters: 200, epoch: 8 | loss: 0.0257161
	speed: 0.1766s/iter; left time: 1869.5950s
	iters: 300, epoch: 8 | loss: 0.0076319
	speed: 0.2187s/iter; left time: 2294.1585s
	iters: 400, epoch: 8 | loss: 0.0017023
	speed: 0.2651s/iter; left time: 2753.7939s
Epoch: 8 cost time: 108.53186225891113
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.983418).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0011796
	speed: 0.8279s/iter; left time: 8459.9728s
	iters: 200, epoch: 9 | loss: 0.0217707
	speed: 0.2088s/iter; left time: 2113.1114s
	iters: 300, epoch: 9 | loss: 0.7344974
	speed: 0.2275s/iter; left time: 2279.6738s
	iters: 400, epoch: 9 | loss: 0.0077998
	speed: 0.2105s/iter; left time: 2088.3892s
Epoch: 9 cost time: 99.20814633369446
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0007810
	speed: 0.7489s/iter; left time: 7301.4222s
	iters: 200, epoch: 10 | loss: 0.4290882
	speed: 0.2137s/iter; left time: 2061.8240s
	iters: 300, epoch: 10 | loss: 0.0021000
	speed: 0.2031s/iter; left time: 1940.0045s
	iters: 400, epoch: 10 | loss: 0.0086476
	speed: 0.1105s/iter; left time: 1044.3394s
Epoch: 10 cost time: 81.82093930244446
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2609407
	speed: 0.5880s/iter; left time: 5457.2111s
	iters: 200, epoch: 11 | loss: 0.0005117
	speed: 0.1816s/iter; left time: 1667.3971s
	iters: 300, epoch: 11 | loss: 0.0002328
	speed: 0.1620s/iter; left time: 1471.1406s
	iters: 400, epoch: 11 | loss: 0.0801493
	speed: 0.1928s/iter; left time: 1731.1454s
Epoch: 11 cost time: 81.62438440322876
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0026843
	speed: 0.7344s/iter; left time: 6471.1769s
	iters: 200, epoch: 12 | loss: 0.2544035
	speed: 0.2303s/iter; left time: 2006.1533s
	iters: 300, epoch: 12 | loss: 0.0008744
	speed: 0.2257s/iter; left time: 1943.7765s
	iters: 400, epoch: 12 | loss: 0.0006969
	speed: 0.2263s/iter; left time: 1926.5185s
Epoch: 12 cost time: 104.97192096710205
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.983418 --> -0.985706).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0010157
	speed: 0.8266s/iter; left time: 6896.7059s
	iters: 200, epoch: 13 | loss: 0.0081790
	speed: 0.2343s/iter; left time: 1931.5945s
	iters: 300, epoch: 13 | loss: 0.0292033
	speed: 0.2502s/iter; left time: 2037.2680s
	iters: 400, epoch: 13 | loss: 0.0005764
	speed: 0.2425s/iter; left time: 1950.0328s
Epoch: 13 cost time: 114.45011878013611
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0011052
	speed: 0.8644s/iter; left time: 6806.5396s
	iters: 200, epoch: 14 | loss: 0.0008207
	speed: 0.2818s/iter; left time: 2190.4611s
	iters: 300, epoch: 14 | loss: 0.1434107
	speed: 0.2194s/iter; left time: 1683.9947s
	iters: 400, epoch: 14 | loss: 0.0302923
	speed: 0.2373s/iter; left time: 1797.3015s
Epoch: 14 cost time: 111.9016695022583
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0887887
	speed: 0.8340s/iter; left time: 6175.5846s
	iters: 200, epoch: 15 | loss: 0.0002933
	speed: 0.2051s/iter; left time: 1498.1275s
	iters: 300, epoch: 15 | loss: 0.0141486
	speed: 0.2089s/iter; left time: 1505.4569s
	iters: 400, epoch: 15 | loss: 0.0008442
	speed: 0.1260s/iter; left time: 895.1203s
Epoch: 15 cost time: 88.01909637451172
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0060907
	speed: 0.8021s/iter; left time: 5563.0937s
	iters: 200, epoch: 16 | loss: 0.0078253
	speed: 0.2460s/iter; left time: 1681.6622s
	iters: 300, epoch: 16 | loss: 0.1809498
	speed: 0.2653s/iter; left time: 1787.1919s
	iters: 400, epoch: 16 | loss: 0.3131169
	speed: 0.2662s/iter; left time: 1766.3212s
Epoch: 16 cost time: 121.76584458351135
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0010134
	speed: 0.9604s/iter; left time: 6210.9326s
	iters: 200, epoch: 17 | loss: 0.0043665
	speed: 0.1958s/iter; left time: 1246.9038s
	iters: 300, epoch: 17 | loss: 0.0018547
	speed: 0.2504s/iter; left time: 1569.3692s
	iters: 400, epoch: 17 | loss: 0.0005233
	speed: 0.2568s/iter; left time: 1583.7500s
Epoch: 17 cost time: 111.60989022254944
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0007995
	speed: 0.7786s/iter; left time: 4669.8678s
	iters: 200, epoch: 18 | loss: 0.0040490
	speed: 0.2286s/iter; left time: 1348.0822s
	iters: 300, epoch: 18 | loss: 0.0009682
	speed: 0.1955s/iter; left time: 1133.4819s
	iters: 400, epoch: 18 | loss: 0.0030480
	speed: 0.2542s/iter; left time: 1448.5076s
Epoch: 18 cost time: 110.5041081905365
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0008882
	speed: 0.9251s/iter; left time: 5114.8418s
	iters: 200, epoch: 19 | loss: 0.0002512
	speed: 0.2423s/iter; left time: 1315.2082s
	iters: 300, epoch: 19 | loss: 0.2208120
	speed: 0.2637s/iter; left time: 1405.0965s
	iters: 400, epoch: 19 | loss: 0.0007855
	speed: 0.2212s/iter; left time: 1156.8618s
Epoch: 19 cost time: 109.16335487365723
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0006237
	speed: 0.8315s/iter; left time: 4207.4236s
	iters: 200, epoch: 20 | loss: 0.0000635
	speed: 0.2388s/iter; left time: 1184.6421s
	iters: 300, epoch: 20 | loss: 0.1807159
	speed: 0.2441s/iter; left time: 1186.2489s
	iters: 400, epoch: 20 | loss: 0.0002303
	speed: 0.2910s/iter; left time: 1385.2816s
Epoch: 20 cost time: 119.10090446472168
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000747
	speed: 0.8661s/iter; left time: 3976.2233s
	iters: 200, epoch: 21 | loss: 0.0020108
	speed: 0.2529s/iter; left time: 1135.6553s
	iters: 300, epoch: 21 | loss: 0.0001502
	speed: 0.2278s/iter; left time: 1000.3790s
	iters: 400, epoch: 21 | loss: 0.0004631
	speed: 0.2148s/iter; left time: 921.5746s
Epoch: 21 cost time: 107.72175908088684
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0253398
	speed: 0.8660s/iter; left time: 3569.7744s
	iters: 200, epoch: 22 | loss: 0.0004979
	speed: 0.2617s/iter; left time: 1052.3854s
	iters: 300, epoch: 22 | loss: 0.0014725
	speed: 0.2751s/iter; left time: 1078.7597s
	iters: 400, epoch: 22 | loss: 0.0001910
	speed: 0.2905s/iter; left time: 1110.2613s
Epoch: 22 cost time: 125.66459512710571
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 2758026
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2761074
	speed: 0.2549s/iter; left time: 3560.8517s
	iters: 200, epoch: 1 | loss: 0.5249377
	speed: 0.2567s/iter; left time: 3561.3158s
	iters: 300, epoch: 1 | loss: 0.1951983
	speed: 0.2701s/iter; left time: 3719.8186s
	iters: 400, epoch: 1 | loss: 0.0601666
	speed: 0.2531s/iter; left time: 3460.0204s
Epoch: 1 cost time: 119.88371515274048
Epoch: 1, Steps: 469 | Train Loss: 0.700 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (inf --> -0.937105).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0314155
	speed: 0.8778s/iter; left time: 11851.6558s
	iters: 200, epoch: 2 | loss: 0.0187664
	speed: 0.2232s/iter; left time: 2990.6749s
	iters: 300, epoch: 2 | loss: 0.0264469
	speed: 0.2100s/iter; left time: 2793.0374s
	iters: 400, epoch: 2 | loss: 0.0190032
	speed: 0.2385s/iter; left time: 3149.1558s
Epoch: 2 cost time: 108.50780200958252
Epoch: 2, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
Validation loss decreased (-0.937105 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1013786
	speed: 0.9162s/iter; left time: 11941.4664s
	iters: 200, epoch: 3 | loss: 0.0247103
	speed: 0.2634s/iter; left time: 3406.1922s
	iters: 300, epoch: 3 | loss: 0.0316376
	speed: 0.2746s/iter; left time: 3523.4891s
	iters: 400, epoch: 3 | loss: 0.1222784
	speed: 0.2452s/iter; left time: 3121.8011s
Epoch: 3 cost time: 112.52035307884216
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0036929
	speed: 0.8392s/iter; left time: 10543.6892s
	iters: 200, epoch: 4 | loss: 0.0084931
	speed: 0.1997s/iter; left time: 2489.5281s
	iters: 300, epoch: 4 | loss: 0.0264709
	speed: 0.2023s/iter; left time: 2500.7307s
	iters: 400, epoch: 4 | loss: 0.0062609
	speed: 0.2322s/iter; left time: 2847.8017s
Epoch: 4 cost time: 103.70774435997009
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.963978 --> -0.968267).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0018464
	speed: 0.8875s/iter; left time: 10734.7056s
	iters: 200, epoch: 5 | loss: 0.0792178
	speed: 0.2587s/iter; left time: 3103.3094s
	iters: 300, epoch: 5 | loss: 0.0018649
	speed: 0.2601s/iter; left time: 3093.9086s
	iters: 400, epoch: 5 | loss: 0.0463247
	speed: 0.2355s/iter; left time: 2778.2630s
Epoch: 5 cost time: 116.7134358882904
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.968267 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0066427
	speed: 0.8938s/iter; left time: 10391.2402s
	iters: 200, epoch: 6 | loss: 0.0066317
	speed: 0.2190s/iter; left time: 2524.1595s
	iters: 300, epoch: 6 | loss: 0.0052172
	speed: 0.2218s/iter; left time: 2533.8829s
	iters: 400, epoch: 6 | loss: 0.2300957
	speed: 0.2374s/iter; left time: 2688.8456s
Epoch: 6 cost time: 106.86045932769775
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0055580
	speed: 0.8555s/iter; left time: 9544.4278s
	iters: 200, epoch: 7 | loss: 0.0028750
	speed: 0.2468s/iter; left time: 2728.9620s
	iters: 300, epoch: 7 | loss: 0.0021067
	speed: 0.2340s/iter; left time: 2564.3768s
	iters: 400, epoch: 7 | loss: 0.0031704
	speed: 0.2084s/iter; left time: 2262.5609s
Epoch: 7 cost time: 107.49122643470764
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.946 Test Loss: 0.158 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0015696
	speed: 0.9135s/iter; left time: 9763.0784s
	iters: 200, epoch: 8 | loss: 0.0201803
	speed: 0.2242s/iter; left time: 2373.6259s
	iters: 300, epoch: 8 | loss: 0.3311664
	speed: 0.2377s/iter; left time: 2493.2769s
	iters: 400, epoch: 8 | loss: 0.0068648
	speed: 0.2417s/iter; left time: 2511.1549s
Epoch: 8 cost time: 109.89349460601807
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0014698
	speed: 0.8060s/iter; left time: 8236.1660s
	iters: 200, epoch: 9 | loss: 0.0011796
	speed: 0.2190s/iter; left time: 2216.2166s
	iters: 300, epoch: 9 | loss: 0.0025978
	speed: 0.2273s/iter; left time: 2277.5839s
	iters: 400, epoch: 9 | loss: 0.0156641
	speed: 0.2169s/iter; left time: 2151.4516s
Epoch: 9 cost time: 105.29650259017944
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0131017
	speed: 0.9376s/iter; left time: 9141.9678s
	iters: 200, epoch: 10 | loss: 0.0023021
	speed: 0.2437s/iter; left time: 2351.4407s
	iters: 300, epoch: 10 | loss: 0.0006924
	speed: 0.2432s/iter; left time: 2322.1803s
	iters: 400, epoch: 10 | loss: 0.0007677
	speed: 0.2257s/iter; left time: 2133.1116s
Epoch: 10 cost time: 110.42073583602905
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.976843 --> -0.980274).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1014934
	speed: 0.7718s/iter; left time: 7163.2870s
	iters: 200, epoch: 11 | loss: 0.0042546
	speed: 0.1964s/iter; left time: 1802.8697s
	iters: 300, epoch: 11 | loss: 0.0069893
	speed: 0.1913s/iter; left time: 1737.0259s
	iters: 400, epoch: 11 | loss: 0.5682499
	speed: 0.2159s/iter; left time: 1938.9405s
Epoch: 11 cost time: 96.4767804145813
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0005468
	speed: 0.8328s/iter; left time: 7338.5588s
	iters: 200, epoch: 12 | loss: 0.0005499
	speed: 0.2053s/iter; left time: 1788.9062s
	iters: 300, epoch: 12 | loss: 0.0003212
	speed: 0.2243s/iter; left time: 1931.7665s
	iters: 400, epoch: 12 | loss: 0.0008988
	speed: 0.2258s/iter; left time: 1922.1657s
Epoch: 12 cost time: 101.26520156860352
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0051114
	speed: 0.8364s/iter; left time: 6978.0414s
	iters: 200, epoch: 13 | loss: 0.0010832
	speed: 0.2243s/iter; left time: 1849.1857s
	iters: 300, epoch: 13 | loss: 0.0381917
	speed: 0.2286s/iter; left time: 1861.6881s
	iters: 400, epoch: 13 | loss: 0.0010029
	speed: 0.2561s/iter; left time: 2060.0795s
Epoch: 13 cost time: 113.00833868980408
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0016217
	speed: 0.9090s/iter; left time: 7157.1359s
	iters: 200, epoch: 14 | loss: 0.0017832
	speed: 0.2027s/iter; left time: 1575.5487s
	iters: 300, epoch: 14 | loss: 0.0010872
	speed: 0.1958s/iter; left time: 1502.6193s
	iters: 400, epoch: 14 | loss: 0.0090351
	speed: 0.2372s/iter; left time: 1796.3705s
Epoch: 14 cost time: 100.0780098438263
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0029326
	speed: 0.6758s/iter; left time: 5004.0262s
	iters: 200, epoch: 15 | loss: 0.0014452
	speed: 0.1947s/iter; left time: 1422.0054s
	iters: 300, epoch: 15 | loss: 0.0044378
	speed: 0.2165s/iter; left time: 1560.0488s
	iters: 400, epoch: 15 | loss: 0.0098331
	speed: 0.1758s/iter; left time: 1248.7926s
Epoch: 15 cost time: 89.77762269973755
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0004792
	speed: 0.7869s/iter; left time: 5457.8052s
	iters: 200, epoch: 16 | loss: 0.0004152
	speed: 0.2200s/iter; left time: 1504.1501s
	iters: 300, epoch: 16 | loss: 0.0006426
	speed: 0.1714s/iter; left time: 1154.6464s
	iters: 400, epoch: 16 | loss: 0.0004705
	speed: 0.1708s/iter; left time: 1133.2654s
Epoch: 16 cost time: 92.7332615852356
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0027776
	speed: 0.7871s/iter; left time: 5090.4082s
	iters: 200, epoch: 17 | loss: 0.0003064
	speed: 0.1752s/iter; left time: 1115.3491s
	iters: 300, epoch: 17 | loss: 0.0028685
	speed: 0.2001s/iter; left time: 1253.9309s
	iters: 400, epoch: 17 | loss: 0.0012134
	speed: 0.2066s/iter; left time: 1274.1818s
Epoch: 17 cost time: 91.74277400970459
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0003435
	speed: 0.7470s/iter; left time: 4480.5871s
	iters: 200, epoch: 18 | loss: 0.0057486
	speed: 0.2161s/iter; left time: 1274.3318s
	iters: 300, epoch: 18 | loss: 0.0009880
	speed: 0.2153s/iter; left time: 1248.1123s
	iters: 400, epoch: 18 | loss: 0.1713962
	speed: 0.1435s/iter; left time: 817.4647s
Epoch: 18 cost time: 90.82104325294495
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0061205
	speed: 0.7592s/iter; left time: 4197.5095s
	iters: 200, epoch: 19 | loss: 0.0058674
	speed: 0.1842s/iter; left time: 999.9774s
	iters: 300, epoch: 19 | loss: 0.0013257
	speed: 0.1610s/iter; left time: 857.8867s
	iters: 400, epoch: 19 | loss: 0.0128692
	speed: 0.1826s/iter; left time: 954.9797s
Epoch: 19 cost time: 87.1807279586792
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0003155
	speed: 0.6415s/iter; left time: 3245.9218s
	iters: 200, epoch: 20 | loss: 0.0003176
	speed: 0.1607s/iter; left time: 796.8599s
	iters: 300, epoch: 20 | loss: 0.0006134
	speed: 0.1899s/iter; left time: 922.9816s
	iters: 400, epoch: 20 | loss: 0.0016765
	speed: 0.1877s/iter; left time: 893.3895s
Epoch: 20 cost time: 81.34404993057251
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 9378442
model size : 36.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1558768
	speed: 0.1746s/iter; left time: 2439.1728s
	iters: 200, epoch: 1 | loss: 0.5408633
	speed: 0.1167s/iter; left time: 1618.5096s
	iters: 300, epoch: 1 | loss: 0.5921552
	speed: 0.0783s/iter; left time: 1077.7994s
	iters: 400, epoch: 1 | loss: 0.1315961
	speed: 0.0869s/iter; left time: 1187.5115s
Epoch: 1 cost time: 53.4900324344635
Epoch: 1, Steps: 469 | Train Loss: 0.742 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
Validation loss decreased (inf --> -0.919380).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1453361
	speed: 0.4851s/iter; left time: 6549.9890s
	iters: 200, epoch: 2 | loss: 0.0303880
	speed: 0.1164s/iter; left time: 1559.6889s
	iters: 300, epoch: 2 | loss: 0.0405894
	speed: 0.1085s/iter; left time: 1443.1725s
	iters: 400, epoch: 2 | loss: 0.0811124
	speed: 0.1266s/iter; left time: 1670.7987s
Epoch: 2 cost time: 56.997254848480225
Epoch: 2, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
Validation loss decreased (-0.919380 --> -0.938535).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0623158
	speed: 0.4578s/iter; left time: 5966.1760s
	iters: 200, epoch: 3 | loss: 0.4305744
	speed: 0.1133s/iter; left time: 1465.3662s
	iters: 300, epoch: 3 | loss: 0.0248508
	speed: 0.1075s/iter; left time: 1379.9222s
	iters: 400, epoch: 3 | loss: 0.0482397
	speed: 0.1173s/iter; left time: 1493.8688s
Epoch: 3 cost time: 55.10074043273926
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
Validation loss decreased (-0.938535 --> -0.973984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0106929
	speed: 0.6092s/iter; left time: 7654.4825s
	iters: 200, epoch: 4 | loss: 0.0477242
	speed: 0.1431s/iter; left time: 1784.1210s
	iters: 300, epoch: 4 | loss: 0.0109605
	speed: 0.1260s/iter; left time: 1558.4030s
	iters: 400, epoch: 4 | loss: 0.0410171
	speed: 0.1246s/iter; left time: 1527.5491s
Epoch: 4 cost time: 64.90399765968323
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.973984 --> -0.984276).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0229572
	speed: 0.5748s/iter; left time: 6951.7924s
	iters: 200, epoch: 5 | loss: 0.0027855
	speed: 0.1368s/iter; left time: 1640.7425s
	iters: 300, epoch: 5 | loss: 0.2697767
	speed: 0.0891s/iter; left time: 1059.4910s
	iters: 400, epoch: 5 | loss: 0.0031872
	speed: 0.0816s/iter; left time: 962.3424s
Epoch: 5 cost time: 54.5867874622345
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0249238
	speed: 0.5449s/iter; left time: 6335.5364s
	iters: 200, epoch: 6 | loss: 0.0521204
	speed: 0.1169s/iter; left time: 1347.3699s
	iters: 300, epoch: 6 | loss: 0.2175227
	speed: 0.0861s/iter; left time: 984.2115s
	iters: 400, epoch: 6 | loss: 0.0129772
	speed: 0.0857s/iter; left time: 970.6282s
Epoch: 6 cost time: 47.709234952926636
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0025334
	speed: 0.4807s/iter; left time: 5363.2841s
	iters: 200, epoch: 7 | loss: 0.0014200
	speed: 0.1452s/iter; left time: 1605.9059s
	iters: 300, epoch: 7 | loss: 0.0020855
	speed: 0.1165s/iter; left time: 1276.4662s
	iters: 400, epoch: 7 | loss: 0.0012813
	speed: 0.0976s/iter; left time: 1059.6485s
Epoch: 7 cost time: 60.846057176589966
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0067699
	speed: 0.5723s/iter; left time: 6117.1212s
	iters: 200, epoch: 8 | loss: 0.0315699
	speed: 0.1377s/iter; left time: 1457.4489s
	iters: 300, epoch: 8 | loss: 0.0026744
	speed: 0.1376s/iter; left time: 1443.6635s
	iters: 400, epoch: 8 | loss: 0.0016592
	speed: 0.1399s/iter; left time: 1453.4235s
Epoch: 8 cost time: 62.183106422424316
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0110318
	speed: 0.6597s/iter; left time: 6741.2932s
	iters: 200, epoch: 9 | loss: 0.0147625
	speed: 0.1183s/iter; left time: 1196.6891s
	iters: 300, epoch: 9 | loss: 0.1211818
	speed: 0.0981s/iter; left time: 982.4526s
	iters: 400, epoch: 9 | loss: 0.0035191
	speed: 0.1100s/iter; left time: 1090.8144s
Epoch: 9 cost time: 55.59384846687317
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0026888
	speed: 0.5665s/iter; left time: 5523.5584s
	iters: 200, epoch: 10 | loss: 0.0142435
	speed: 0.1399s/iter; left time: 1350.3832s
	iters: 300, epoch: 10 | loss: 0.3755558
	speed: 0.1291s/iter; left time: 1232.6581s
	iters: 400, epoch: 10 | loss: 0.0016875
	speed: 0.1195s/iter; left time: 1129.7147s
Epoch: 10 cost time: 64.3572678565979
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0005439
	speed: 0.4897s/iter; left time: 4545.0252s
	iters: 200, epoch: 11 | loss: 0.0005496
	speed: 0.1096s/iter; left time: 1006.3370s
	iters: 300, epoch: 11 | loss: 0.0014908
	speed: 0.1198s/iter; left time: 1087.8876s
	iters: 400, epoch: 11 | loss: 0.0004322
	speed: 0.1186s/iter; left time: 1065.1754s
Epoch: 11 cost time: 51.531681299209595
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0058812
	speed: 0.6071s/iter; left time: 5349.6552s
	iters: 200, epoch: 12 | loss: 0.0129637
	speed: 0.1112s/iter; left time: 968.8782s
	iters: 300, epoch: 12 | loss: 0.0006080
	speed: 0.1262s/iter; left time: 1087.1618s
	iters: 400, epoch: 12 | loss: 0.0010051
	speed: 0.1340s/iter; left time: 1141.0246s
Epoch: 12 cost time: 57.69399690628052
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0896955
	speed: 0.4802s/iter; left time: 4006.3077s
	iters: 200, epoch: 13 | loss: 0.0013840
	speed: 0.1159s/iter; left time: 955.2055s
	iters: 300, epoch: 13 | loss: 0.0083740
	speed: 0.1138s/iter; left time: 926.5816s
	iters: 400, epoch: 13 | loss: 0.0178640
	speed: 0.1299s/iter; left time: 1044.5848s
Epoch: 13 cost time: 59.33086442947388
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0151127
	speed: 0.5004s/iter; left time: 3939.7718s
	iters: 200, epoch: 14 | loss: 0.0015529
	speed: 0.0951s/iter; left time: 739.2213s
	iters: 300, epoch: 14 | loss: 0.1622004
	speed: 0.1297s/iter; left time: 995.0245s
	iters: 400, epoch: 14 | loss: 0.0696074
	speed: 0.1341s/iter; left time: 1015.8355s
Epoch: 14 cost time: 56.73692965507507
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 2758026
model size : 11.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1382563
	speed: 0.4271s/iter; left time: 5966.8227s
	iters: 200, epoch: 1 | loss: 0.3250589
	speed: 0.3864s/iter; left time: 5359.5213s
	iters: 300, epoch: 1 | loss: 0.3240408
	speed: 0.4267s/iter; left time: 5875.5371s
	iters: 400, epoch: 1 | loss: 0.0637065
	speed: 0.4709s/iter; left time: 6438.0952s
Epoch: 1 cost time: 196.1998610496521
Epoch: 1, Steps: 469 | Train Loss: 0.642 Vali Loss: 0.207 Vali Acc: 0.938 Test Loss: 0.207 Test Acc: 0.938
Validation loss decreased (inf --> -0.937962).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0691316
	speed: 1.1301s/iter; left time: 15257.9514s
	iters: 200, epoch: 2 | loss: 0.0707557
	speed: 0.3861s/iter; left time: 5174.3429s
	iters: 300, epoch: 2 | loss: 0.0290706
	speed: 0.3787s/iter; left time: 5037.5718s
	iters: 400, epoch: 2 | loss: 0.1309900
	speed: 0.2809s/iter; left time: 3708.9423s
Epoch: 2 cost time: 163.58756613731384
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.937962 --> -0.975985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0078022
	speed: 1.1577s/iter; left time: 15087.8128s
	iters: 200, epoch: 3 | loss: 0.0092639
	speed: 0.3884s/iter; left time: 5023.7135s
	iters: 300, epoch: 3 | loss: 0.0083336
	speed: 0.3550s/iter; left time: 4555.1457s
	iters: 400, epoch: 3 | loss: 0.0105229
	speed: 0.4475s/iter; left time: 5698.0677s
Epoch: 3 cost time: 186.68090271949768
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4321655
	speed: 0.8858s/iter; left time: 11129.5704s
	iters: 200, epoch: 4 | loss: 0.0856735
	speed: 0.2609s/iter; left time: 3252.2443s
	iters: 300, epoch: 4 | loss: 0.0110207
	speed: 0.3095s/iter; left time: 3826.8024s
	iters: 400, epoch: 4 | loss: 0.0041223
	speed: 0.3104s/iter; left time: 3806.4219s
Epoch: 4 cost time: 122.98398470878601
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.977701).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0048112
	speed: 0.9193s/iter; left time: 11118.8787s
	iters: 200, epoch: 5 | loss: 0.0019061
	speed: 0.3412s/iter; left time: 4092.4077s
	iters: 300, epoch: 5 | loss: 0.0654582
	speed: 0.2868s/iter; left time: 3410.9408s
	iters: 400, epoch: 5 | loss: 0.0957227
	speed: 0.2126s/iter; left time: 2507.3239s
Epoch: 5 cost time: 137.08849930763245
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0010726
	speed: 0.9082s/iter; left time: 10558.1697s
	iters: 200, epoch: 6 | loss: 0.5430883
	speed: 0.2122s/iter; left time: 2446.1263s
	iters: 300, epoch: 6 | loss: 0.0127567
	speed: 0.2499s/iter; left time: 2854.8697s
	iters: 400, epoch: 6 | loss: 0.0041433
	speed: 0.3259s/iter; left time: 3690.8492s
Epoch: 6 cost time: 134.513662815094
Epoch: 6, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.979130).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0026717
	speed: 0.9308s/iter; left time: 10385.4684s
	iters: 200, epoch: 7 | loss: 0.0024554
	speed: 0.2600s/iter; left time: 2874.9784s
	iters: 300, epoch: 7 | loss: 0.0019949
	speed: 0.3420s/iter; left time: 3747.4540s
	iters: 400, epoch: 7 | loss: 0.0004984
	speed: 0.3404s/iter; left time: 3695.6677s
Epoch: 7 cost time: 133.45993304252625
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0036910
	speed: 0.9120s/iter; left time: 9747.3554s
	iters: 200, epoch: 8 | loss: 0.0037822
	speed: 0.3618s/iter; left time: 3830.8960s
	iters: 300, epoch: 8 | loss: 0.0008893
	speed: 0.2806s/iter; left time: 2942.8972s
	iters: 400, epoch: 8 | loss: 0.0026274
	speed: 0.2259s/iter; left time: 2346.6896s
Epoch: 8 cost time: 136.49313926696777
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980559).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0035513
	speed: 0.7393s/iter; left time: 7555.0214s
	iters: 200, epoch: 9 | loss: 0.0016682
	speed: 0.3548s/iter; left time: 3590.1007s
	iters: 300, epoch: 9 | loss: 0.0007125
	speed: 0.4064s/iter; left time: 4071.5456s
	iters: 400, epoch: 9 | loss: 0.0038606
	speed: 0.3723s/iter; left time: 3692.8530s
Epoch: 9 cost time: 152.8416531085968
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0019719
	speed: 0.9736s/iter; left time: 9492.5408s
	iters: 200, epoch: 10 | loss: 0.0068739
	speed: 0.3457s/iter; left time: 3335.8502s
	iters: 300, epoch: 10 | loss: 0.2897211
	speed: 0.3237s/iter; left time: 3091.1490s
	iters: 400, epoch: 10 | loss: 0.0059234
	speed: 0.3094s/iter; left time: 2923.3948s
Epoch: 10 cost time: 147.77098059654236
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0005437
	speed: 0.9561s/iter; left time: 8873.6904s
	iters: 200, epoch: 11 | loss: 0.0181967
	speed: 0.3666s/iter; left time: 3366.1129s
	iters: 300, epoch: 11 | loss: 0.0007297
	speed: 0.3048s/iter; left time: 2767.8313s
	iters: 400, epoch: 11 | loss: 0.0163483
	speed: 0.2664s/iter; left time: 2392.9861s
Epoch: 11 cost time: 143.62977170944214
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0917945
	speed: 0.8801s/iter; left time: 7755.0933s
	iters: 200, epoch: 12 | loss: 0.0032257
	speed: 0.2887s/iter; left time: 2514.7793s
	iters: 300, epoch: 12 | loss: 0.0012496
	speed: 0.3042s/iter; left time: 2619.8651s
	iters: 400, epoch: 12 | loss: 0.0177982
	speed: 0.2793s/iter; left time: 2377.3534s
Epoch: 12 cost time: 137.92831921577454
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0072514
	speed: 0.9758s/iter; left time: 8141.0851s
	iters: 200, epoch: 13 | loss: 0.1524895
	speed: 0.2995s/iter; left time: 2468.6824s
	iters: 300, epoch: 13 | loss: 0.0005872
	speed: 0.2657s/iter; left time: 2163.8362s
	iters: 400, epoch: 13 | loss: 0.0016181
	speed: 0.2409s/iter; left time: 1937.5174s
Epoch: 13 cost time: 127.26621627807617
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0117449
	speed: 0.9589s/iter; left time: 7550.3621s
	iters: 200, epoch: 14 | loss: 0.0021013
	speed: 0.3815s/iter; left time: 2965.6961s
	iters: 300, epoch: 14 | loss: 0.0002963
	speed: 0.3438s/iter; left time: 2638.6524s
	iters: 400, epoch: 14 | loss: 0.0291821
	speed: 0.2284s/iter; left time: 1729.7033s
Epoch: 14 cost time: 154.91494369506836
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0005861
	speed: 1.0246s/iter; left time: 7587.0499s
	iters: 200, epoch: 15 | loss: 0.0192780
	speed: 0.5050s/iter; left time: 3688.8426s
	iters: 300, epoch: 15 | loss: 0.0011687
	speed: 0.4334s/iter; left time: 3122.7627s
	iters: 400, epoch: 15 | loss: 0.0024557
	speed: 0.4755s/iter; left time: 3378.4772s
Epoch: 15 cost time: 205.68673872947693
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0010064
	speed: 1.4288s/iter; left time: 9910.0818s
	iters: 200, epoch: 16 | loss: 0.0005317
	speed: 0.4615s/iter; left time: 3154.5530s
	iters: 300, epoch: 16 | loss: 0.0016605
	speed: 0.4834s/iter; left time: 3255.8606s
	iters: 400, epoch: 16 | loss: 0.0008256
	speed: 0.4815s/iter; left time: 3195.5120s
Epoch: 16 cost time: 227.53592467308044
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.980559 --> -0.982847).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0002840
	speed: 1.4639s/iter; left time: 9467.1197s
	iters: 200, epoch: 17 | loss: 0.0048545
	speed: 0.4558s/iter; left time: 2902.3456s
	iters: 300, epoch: 17 | loss: 0.0004560
	speed: 0.4718s/iter; left time: 2956.4767s
	iters: 400, epoch: 17 | loss: 0.0006405
	speed: 0.4870s/iter; left time: 3003.0466s
Epoch: 17 cost time: 224.77479457855225
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0006368
	speed: 1.4405s/iter; left time: 8640.2920s
	iters: 200, epoch: 18 | loss: 0.0002180
	speed: 0.4707s/iter; left time: 2776.0349s
	iters: 300, epoch: 18 | loss: 0.0003278
	speed: 0.4623s/iter; left time: 2680.4099s
	iters: 400, epoch: 18 | loss: 0.0346721
	speed: 0.4820s/iter; left time: 2746.6718s
Epoch: 18 cost time: 221.65465140342712
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0008479
	speed: 1.3135s/iter; left time: 7262.3761s
	iters: 200, epoch: 19 | loss: 0.0014867
	speed: 0.4562s/iter; left time: 2476.8883s
	iters: 300, epoch: 19 | loss: 0.0005005
	speed: 0.4635s/iter; left time: 2469.8207s
	iters: 400, epoch: 19 | loss: 0.3912397
	speed: 0.4931s/iter; left time: 2578.6569s
Epoch: 19 cost time: 212.00622391700745
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0164527
	speed: 1.2125s/iter; left time: 6135.1740s
	iters: 200, epoch: 20 | loss: 0.0137840
	speed: 0.4289s/iter; left time: 2127.5235s
	iters: 300, epoch: 20 | loss: 0.0001785
	speed: 0.4326s/iter; left time: 2102.5634s
	iters: 400, epoch: 20 | loss: 0.0011100
	speed: 0.4475s/iter; left time: 2130.0204s
Epoch: 20 cost time: 198.1216390132904
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0011125
	speed: 1.2131s/iter; left time: 5569.1335s
	iters: 200, epoch: 21 | loss: 0.0007265
	speed: 0.4344s/iter; left time: 1950.7442s
	iters: 300, epoch: 21 | loss: 0.0003253
	speed: 0.4465s/iter; left time: 1960.5941s
	iters: 400, epoch: 21 | loss: 0.0003671
	speed: 0.3230s/iter; left time: 1386.0501s
Epoch: 21 cost time: 190.52726292610168
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0012057
	speed: 1.2539s/iter; left time: 5168.4002s
	iters: 200, epoch: 22 | loss: 0.0005254
	speed: 0.4498s/iter; left time: 1809.0683s
	iters: 300, epoch: 22 | loss: 0.0013159
	speed: 0.4598s/iter; left time: 1803.2503s
	iters: 400, epoch: 22 | loss: 0.0167853
	speed: 0.4120s/iter; left time: 1574.7928s
Epoch: 22 cost time: 201.54779434204102
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983418).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0003569
	speed: 1.2132s/iter; left time: 4431.7711s
	iters: 200, epoch: 23 | loss: 0.0055422
	speed: 0.3529s/iter; left time: 1253.8607s
	iters: 300, epoch: 23 | loss: 0.0009155
	speed: 0.4165s/iter; left time: 1438.0902s
	iters: 400, epoch: 23 | loss: 0.0003490
	speed: 0.3740s/iter; left time: 1253.9310s
Epoch: 23 cost time: 182.4251627922058
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0004375
	speed: 1.1733s/iter; left time: 3735.8265s
	iters: 200, epoch: 24 | loss: 0.0011387
	speed: 0.3677s/iter; left time: 1133.9203s
	iters: 300, epoch: 24 | loss: 0.0012678
	speed: 0.4155s/iter; left time: 1239.8980s
	iters: 400, epoch: 24 | loss: 0.0003631
	speed: 0.3093s/iter; left time: 891.9680s
Epoch: 24 cost time: 160.14611268043518
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0009933
	speed: 1.0034s/iter; left time: 2724.3459s
	iters: 200, epoch: 25 | loss: 0.0028107
	speed: 0.3441s/iter; left time: 899.8644s
	iters: 300, epoch: 25 | loss: 0.0010237
	speed: 0.3608s/iter; left time: 907.5283s
	iters: 400, epoch: 25 | loss: 0.0001654
	speed: 0.3830s/iter; left time: 924.8321s
Epoch: 25 cost time: 168.66523098945618
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0004757
	speed: 1.1531s/iter; left time: 2589.8301s
	iters: 200, epoch: 26 | loss: 0.0003005
	speed: 0.3825s/iter; left time: 820.8771s
	iters: 300, epoch: 26 | loss: 0.0045912
	speed: 0.3798s/iter; left time: 777.1642s
	iters: 400, epoch: 26 | loss: 0.0003111
	speed: 0.4162s/iter; left time: 809.8470s
Epoch: 26 cost time: 188.87905621528625
Epoch: 26, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983704).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0001053
	speed: 1.1554s/iter; left time: 2053.2161s
	iters: 200, epoch: 27 | loss: 0.0006879
	speed: 0.3877s/iter; left time: 650.1397s
	iters: 300, epoch: 27 | loss: 0.0001640
	speed: 0.3457s/iter; left time: 545.2430s
	iters: 400, epoch: 27 | loss: 0.0005960
	speed: 0.4130s/iter; left time: 610.0133s
Epoch: 27 cost time: 189.42276000976562
Epoch: 27, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0020282
	speed: 1.2213s/iter; left time: 1597.4438s
	iters: 200, epoch: 28 | loss: 0.0205992
	speed: 0.4177s/iter; left time: 504.6080s
	iters: 300, epoch: 28 | loss: 0.0009544
	speed: 0.3870s/iter; left time: 428.7873s
	iters: 400, epoch: 28 | loss: 0.0020495
	speed: 0.4245s/iter; left time: 427.8752s
Epoch: 28 cost time: 192.38699316978455
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0002162
	speed: 1.0556s/iter; left time: 885.6217s
	iters: 200, epoch: 29 | loss: 0.0001758
	speed: 0.4053s/iter; left time: 299.5279s
	iters: 300, epoch: 29 | loss: 0.0010424
	speed: 0.3598s/iter; left time: 229.9293s
	iters: 400, epoch: 29 | loss: 0.4246780
	speed: 0.3518s/iter; left time: 189.6195s
Epoch: 29 cost time: 177.32469391822815
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0012800
	speed: 1.1925s/iter; left time: 441.2428s
	iters: 200, epoch: 30 | loss: 0.0005780
	speed: 0.2801s/iter; left time: 75.6214s
	iters: 300, epoch: 30 | loss: 0.0006407
	speed: 0.3609s/iter; left time: 61.3484s
	iters: 400, epoch: 30 | loss: 0.0003695
	speed: 0.3399s/iter; left time: 23.7915s
Epoch: 30 cost time: 158.0133454799652
Epoch: 30, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 4691082
model size : 18.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1411300
	speed: 0.2879s/iter; left time: 4022.0325s
	iters: 200, epoch: 1 | loss: 0.5508687
	speed: 0.2353s/iter; left time: 3264.1849s
	iters: 300, epoch: 1 | loss: 0.1080911
	speed: 0.2563s/iter; left time: 3529.1834s
	iters: 400, epoch: 1 | loss: 0.1540361
	speed: 0.2507s/iter; left time: 3427.4139s
Epoch: 1 cost time: 121.46217060089111
Epoch: 1, Steps: 469 | Train Loss: 0.661 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (inf --> -0.962835).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3309658
	speed: 0.8739s/iter; left time: 11799.7897s
	iters: 200, epoch: 2 | loss: 0.0807359
	speed: 0.2389s/iter; left time: 3201.4867s
	iters: 300, epoch: 2 | loss: 0.0370194
	speed: 0.2436s/iter; left time: 3241.0022s
	iters: 400, epoch: 2 | loss: 0.0438286
	speed: 0.2752s/iter; left time: 3632.9619s
Epoch: 2 cost time: 121.08365106582642
Epoch: 2, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
Validation loss decreased (-0.962835 --> -0.968838).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0180815
	speed: 0.8535s/iter; left time: 11123.9996s
	iters: 200, epoch: 3 | loss: 0.0756459
	speed: 0.2577s/iter; left time: 3332.5337s
	iters: 300, epoch: 3 | loss: 0.0188766
	speed: 0.2233s/iter; left time: 2865.5058s
	iters: 400, epoch: 3 | loss: 0.0215102
	speed: 0.2044s/iter; left time: 2602.9720s
Epoch: 3 cost time: 111.09099125862122
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0026291
	speed: 0.8032s/iter; left time: 10092.0039s
	iters: 200, epoch: 4 | loss: 0.5720084
	speed: 0.2676s/iter; left time: 3335.8662s
	iters: 300, epoch: 4 | loss: 0.0026556
	speed: 0.2715s/iter; left time: 3356.6696s
	iters: 400, epoch: 4 | loss: 0.0211452
	speed: 0.2253s/iter; left time: 2762.8571s
Epoch: 4 cost time: 115.96369576454163
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.968838 --> -0.974270).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0228202
	speed: 0.7996s/iter; left time: 9670.9481s
	iters: 200, epoch: 5 | loss: 0.0207215
	speed: 0.2656s/iter; left time: 3185.7958s
	iters: 300, epoch: 5 | loss: 0.0027126
	speed: 0.2024s/iter; left time: 2407.2326s
	iters: 400, epoch: 5 | loss: 0.0083102
	speed: 0.2361s/iter; left time: 2784.5246s
Epoch: 5 cost time: 112.53504991531372
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.974270 --> -0.981703).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0024040
	speed: 0.8352s/iter; left time: 9709.9282s
	iters: 200, epoch: 6 | loss: 0.0012979
	speed: 0.2341s/iter; left time: 2698.6905s
	iters: 300, epoch: 6 | loss: 0.0132569
	speed: 0.2325s/iter; left time: 2656.4397s
	iters: 400, epoch: 6 | loss: 0.0008939
	speed: 0.2287s/iter; left time: 2589.8662s
Epoch: 6 cost time: 106.39908456802368
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0015978
	speed: 0.7606s/iter; left time: 8485.6427s
	iters: 200, epoch: 7 | loss: 0.0050374
	speed: 0.2332s/iter; left time: 2578.0527s
	iters: 300, epoch: 7 | loss: 0.0053215
	speed: 0.2584s/iter; left time: 2830.8239s
	iters: 400, epoch: 7 | loss: 0.0024995
	speed: 0.2764s/iter; left time: 3001.1574s
Epoch: 7 cost time: 118.08499336242676
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0216736
	speed: 0.8112s/iter; left time: 8670.5482s
	iters: 200, epoch: 8 | loss: 0.0015406
	speed: 0.2516s/iter; left time: 2664.4026s
	iters: 300, epoch: 8 | loss: 0.0035726
	speed: 0.2572s/iter; left time: 2697.4791s
	iters: 400, epoch: 8 | loss: 0.0047527
	speed: 0.2334s/iter; left time: 2424.3221s
Epoch: 8 cost time: 114.86068367958069
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0010930
	speed: 0.7879s/iter; left time: 8051.0470s
	iters: 200, epoch: 9 | loss: 0.0010746
	speed: 0.2562s/iter; left time: 2592.4896s
	iters: 300, epoch: 9 | loss: 0.0017123
	speed: 0.2133s/iter; left time: 2137.1861s
	iters: 400, epoch: 9 | loss: 0.0008590
	speed: 0.1838s/iter; left time: 1822.6502s
Epoch: 9 cost time: 97.83266353607178
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0880747
	speed: 0.6302s/iter; left time: 6144.6542s
	iters: 200, epoch: 10 | loss: 0.0049856
	speed: 0.2003s/iter; left time: 1933.0169s
	iters: 300, epoch: 10 | loss: 0.0143596
	speed: 0.1983s/iter; left time: 1893.5196s
	iters: 400, epoch: 10 | loss: 0.0086451
	speed: 0.2203s/iter; left time: 2081.8760s
Epoch: 10 cost time: 100.3835244178772
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0007291
	speed: 0.7325s/iter; left time: 6798.2780s
	iters: 200, epoch: 11 | loss: 0.0040556
	speed: 0.1973s/iter; left time: 1811.3353s
	iters: 300, epoch: 11 | loss: 0.0012101
	speed: 0.2184s/iter; left time: 1983.6229s
	iters: 400, epoch: 11 | loss: 0.0032353
	speed: 0.2294s/iter; left time: 2060.1221s
Epoch: 11 cost time: 97.98386406898499
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0055246
	speed: 0.6702s/iter; left time: 5905.8034s
	iters: 200, epoch: 12 | loss: 0.0060687
	speed: 0.1985s/iter; left time: 1729.2575s
	iters: 300, epoch: 12 | loss: 0.0112721
	speed: 0.1122s/iter; left time: 966.3853s
	iters: 400, epoch: 12 | loss: 0.0023711
	speed: 0.1140s/iter; left time: 970.6127s
Epoch: 12 cost time: 73.85566639900208
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0080680
	speed: 0.7550s/iter; left time: 6298.5991s
	iters: 200, epoch: 13 | loss: 0.0438596
	speed: 0.2622s/iter; left time: 2161.5144s
	iters: 300, epoch: 13 | loss: 0.0003167
	speed: 0.2777s/iter; left time: 2260.9927s
	iters: 400, epoch: 13 | loss: 0.0865284
	speed: 0.2340s/iter; left time: 1881.7901s
Epoch: 13 cost time: 121.55365514755249
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0013253
	speed: 0.8647s/iter; left time: 6808.5288s
	iters: 200, epoch: 14 | loss: 0.0005549
	speed: 0.2889s/iter; left time: 2246.0984s
	iters: 300, epoch: 14 | loss: 0.0018578
	speed: 0.2712s/iter; left time: 2081.0780s
	iters: 400, epoch: 14 | loss: 0.0001627
	speed: 0.1147s/iter; left time: 869.0201s
Epoch: 14 cost time: 104.15212965011597
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2365878
	speed: 0.7524s/iter; left time: 5571.1652s
	iters: 200, epoch: 15 | loss: 0.0410660
	speed: 0.2496s/iter; left time: 1823.4898s
	iters: 300, epoch: 15 | loss: 0.0010051
	speed: 0.2477s/iter; left time: 1784.9840s
	iters: 400, epoch: 15 | loss: 0.0003435
	speed: 0.2385s/iter; left time: 1694.7555s
Epoch: 15 cost time: 112.07553291320801
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.981703 --> -0.984276).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0144565
	speed: 0.8271s/iter; left time: 5737.0195s
	iters: 200, epoch: 16 | loss: 0.3011085
	speed: 0.2317s/iter; left time: 1583.9861s
	iters: 300, epoch: 16 | loss: 0.0018597
	speed: 0.1983s/iter; left time: 1336.0453s
	iters: 400, epoch: 16 | loss: 0.0150241
	speed: 0.2037s/iter; left time: 1352.0396s
Epoch: 16 cost time: 111.73087000846863
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0008792
	speed: 0.8897s/iter; left time: 5753.8203s
	iters: 200, epoch: 17 | loss: 0.0005527
	speed: 0.2726s/iter; left time: 1735.5898s
	iters: 300, epoch: 17 | loss: 0.0004577
	speed: 0.2410s/iter; left time: 1510.0801s
	iters: 400, epoch: 17 | loss: 0.0004574
	speed: 0.2827s/iter; left time: 1743.7153s
Epoch: 17 cost time: 126.82520937919617
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001236
	speed: 0.8827s/iter; left time: 5294.5405s
	iters: 200, epoch: 18 | loss: 0.0001016
	speed: 0.2700s/iter; left time: 1592.6106s
	iters: 300, epoch: 18 | loss: 0.0000945
	speed: 0.2919s/iter; left time: 1692.2792s
	iters: 400, epoch: 18 | loss: 0.0068313
	speed: 0.2590s/iter; left time: 1476.0004s
Epoch: 18 cost time: 127.40421628952026
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0004564
	speed: 0.8646s/iter; left time: 4780.2547s
	iters: 200, epoch: 19 | loss: 0.0002367
	speed: 0.2748s/iter; left time: 1491.9062s
	iters: 300, epoch: 19 | loss: 0.0009741
	speed: 0.2873s/iter; left time: 1531.2211s
	iters: 400, epoch: 19 | loss: 0.0013554
	speed: 0.2191s/iter; left time: 1145.7898s
Epoch: 19 cost time: 120.04449391365051
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0015967
	speed: 0.8755s/iter; left time: 4430.2396s
	iters: 200, epoch: 20 | loss: 0.0008577
	speed: 0.2721s/iter; left time: 1349.6800s
	iters: 300, epoch: 20 | loss: 0.0002886
	speed: 0.2670s/iter; left time: 1297.6580s
	iters: 400, epoch: 20 | loss: 0.0006202
	speed: 0.2695s/iter; left time: 1282.6041s
Epoch: 20 cost time: 124.06819891929626
Epoch: 20, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0023281
	speed: 0.8693s/iter; left time: 3990.7780s
	iters: 200, epoch: 21 | loss: 0.0028863
	speed: 0.2416s/iter; left time: 1085.1225s
	iters: 300, epoch: 21 | loss: 0.1536825
	speed: 0.2591s/iter; left time: 1137.8103s
	iters: 400, epoch: 21 | loss: 0.0001728
	speed: 0.2796s/iter; left time: 1199.6846s
Epoch: 21 cost time: 123.67408299446106
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0139146
	speed: 0.8781s/iter; left time: 3619.6321s
	iters: 200, epoch: 22 | loss: 0.0004244
	speed: 0.2508s/iter; left time: 1008.5943s
	iters: 300, epoch: 22 | loss: 0.0001142
	speed: 0.2484s/iter; left time: 974.3691s
	iters: 400, epoch: 22 | loss: 0.0002184
	speed: 0.3052s/iter; left time: 1166.6441s
Epoch: 22 cost time: 125.41136479377747
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.984276 --> -0.984276).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0017849
	speed: 0.8459s/iter; left time: 3089.9504s
	iters: 200, epoch: 23 | loss: 0.0003034
	speed: 0.2232s/iter; left time: 792.9774s
	iters: 300, epoch: 23 | loss: 0.0000908
	speed: 0.2741s/iter; left time: 946.6094s
	iters: 400, epoch: 23 | loss: 0.0029630
	speed: 0.2570s/iter; left time: 861.5579s
Epoch: 23 cost time: 122.94692492485046
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0002360
	speed: 0.8462s/iter; left time: 2694.4041s
	iters: 200, epoch: 24 | loss: 0.0025707
	speed: 0.2827s/iter; left time: 871.7131s
	iters: 300, epoch: 24 | loss: 0.3104818
	speed: 0.2556s/iter; left time: 762.6610s
	iters: 400, epoch: 24 | loss: 0.0032503
	speed: 0.2532s/iter; left time: 730.2841s
Epoch: 24 cost time: 122.56430983543396
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0007767
	speed: 0.7100s/iter; left time: 1927.5365s
	iters: 200, epoch: 25 | loss: 0.0001553
	speed: 0.2671s/iter; left time: 698.5499s
	iters: 300, epoch: 25 | loss: 0.0012441
	speed: 0.2438s/iter; left time: 613.1895s
	iters: 400, epoch: 25 | loss: 0.0000431
	speed: 0.2103s/iter; left time: 507.9090s
Epoch: 25 cost time: 100.02243566513062
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0087960
	speed: 0.7400s/iter; left time: 1662.0587s
	iters: 200, epoch: 26 | loss: 0.0379986
	speed: 0.2458s/iter; left time: 527.3887s
	iters: 300, epoch: 26 | loss: 0.0027731
	speed: 0.2334s/iter; left time: 477.6039s
	iters: 400, epoch: 26 | loss: 0.0000720
	speed: 0.2193s/iter; left time: 426.6923s
Epoch: 26 cost time: 106.46441459655762
Epoch: 26, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.984276 --> -0.984562).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0006548
	speed: 0.7680s/iter; left time: 1364.8096s
	iters: 200, epoch: 27 | loss: 0.0021318
	speed: 0.2294s/iter; left time: 384.7535s
	iters: 300, epoch: 27 | loss: 0.0004168
	speed: 0.2348s/iter; left time: 370.3102s
	iters: 400, epoch: 27 | loss: 0.0001794
	speed: 0.2196s/iter; left time: 324.3889s
Epoch: 27 cost time: 105.64859962463379
Epoch: 27, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000729
	speed: 0.7269s/iter; left time: 950.8369s
	iters: 200, epoch: 28 | loss: 0.0000855
	speed: 0.2978s/iter; left time: 359.7508s
	iters: 300, epoch: 28 | loss: 0.0004312
	speed: 0.2953s/iter; left time: 327.1543s
	iters: 400, epoch: 28 | loss: 0.0000897
	speed: 0.2902s/iter; left time: 292.5050s
Epoch: 28 cost time: 125.24755907058716
Epoch: 28, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0002320
	speed: 0.9111s/iter; left time: 764.4237s
	iters: 200, epoch: 29 | loss: 0.0001585
	speed: 0.2708s/iter; left time: 200.1271s
	iters: 300, epoch: 29 | loss: 0.5145623
	speed: 0.2756s/iter; left time: 176.1177s
	iters: 400, epoch: 29 | loss: 0.0007318
	speed: 0.2851s/iter; left time: 153.6688s
Epoch: 29 cost time: 134.6004717350006
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0001219
	speed: 0.9468s/iter; left time: 350.3253s
	iters: 200, epoch: 30 | loss: 0.0025547
	speed: 0.3108s/iter; left time: 83.9213s
	iters: 300, epoch: 30 | loss: 0.0000597
	speed: 0.3049s/iter; left time: 51.8349s
	iters: 400, epoch: 30 | loss: 0.0020946
	speed: 0.3116s/iter; left time: 21.8097s
Epoch: 30 cost time: 143.29430627822876
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 1380746
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1504620
	speed: 0.3566s/iter; left time: 4982.5572s
	iters: 200, epoch: 1 | loss: 0.3516996
	speed: 0.3043s/iter; left time: 4220.9194s
	iters: 300, epoch: 1 | loss: 0.3642510
	speed: 0.3377s/iter; left time: 4650.5566s
	iters: 400, epoch: 1 | loss: 0.1113430
	speed: 0.3419s/iter; left time: 4674.3938s
Epoch: 1 cost time: 158.25983476638794
Epoch: 1, Steps: 469 | Train Loss: 0.653 Vali Loss: 0.179 Vali Acc: 0.947 Test Loss: 0.179 Test Acc: 0.947
Validation loss decreased (inf --> -0.947397).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0479392
	speed: 1.1578s/iter; left time: 15632.4720s
	iters: 200, epoch: 2 | loss: 0.0475042
	speed: 0.3441s/iter; left time: 4612.0970s
	iters: 300, epoch: 2 | loss: 0.0129922
	speed: 0.3016s/iter; left time: 4012.5117s
	iters: 400, epoch: 2 | loss: 0.1638874
	speed: 0.3370s/iter; left time: 4449.4577s
Epoch: 2 cost time: 155.1346459388733
Epoch: 2, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.947397 --> -0.975128).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0192299
	speed: 1.1169s/iter; left time: 14556.6978s
	iters: 200, epoch: 3 | loss: 0.1082924
	speed: 0.3580s/iter; left time: 4630.2280s
	iters: 300, epoch: 3 | loss: 0.0131110
	speed: 0.3698s/iter; left time: 4745.9536s
	iters: 400, epoch: 3 | loss: 0.0214886
	speed: 0.3543s/iter; left time: 4510.7003s
Epoch: 3 cost time: 169.32955646514893
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.976557).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0988261
	speed: 1.1872s/iter; left time: 14915.6891s
	iters: 200, epoch: 4 | loss: 0.0240934
	speed: 0.3155s/iter; left time: 3932.4716s
	iters: 300, epoch: 4 | loss: 0.0078721
	speed: 0.3586s/iter; left time: 4433.8305s
	iters: 400, epoch: 4 | loss: 0.0057215
	speed: 0.3163s/iter; left time: 3878.5175s
Epoch: 4 cost time: 157.59685850143433
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1329126
	speed: 1.1124s/iter; left time: 13454.2564s
	iters: 200, epoch: 5 | loss: 0.0025097
	speed: 0.3605s/iter; left time: 4324.7645s
	iters: 300, epoch: 5 | loss: 0.0076424
	speed: 0.3572s/iter; left time: 4248.5358s
	iters: 400, epoch: 5 | loss: 0.0748921
	speed: 0.3599s/iter; left time: 4244.5720s
Epoch: 5 cost time: 165.25213098526
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.978273).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0045118
	speed: 1.0851s/iter; left time: 12615.2365s
	iters: 200, epoch: 6 | loss: 0.6993517
	speed: 0.3447s/iter; left time: 3973.2104s
	iters: 300, epoch: 6 | loss: 0.0027135
	speed: 0.3306s/iter; left time: 3777.6405s
	iters: 400, epoch: 6 | loss: 0.0031851
	speed: 0.3709s/iter; left time: 4200.6672s
Epoch: 6 cost time: 158.52296447753906
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0012719
	speed: 1.1748s/iter; left time: 13107.6189s
	iters: 200, epoch: 7 | loss: 0.0166340
	speed: 0.2890s/iter; left time: 3195.6782s
	iters: 300, epoch: 7 | loss: 0.0172622
	speed: 0.3317s/iter; left time: 3634.9547s
	iters: 400, epoch: 7 | loss: 0.0006706
	speed: 0.3240s/iter; left time: 3517.7769s
Epoch: 7 cost time: 153.31667518615723
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0011450
	speed: 1.1489s/iter; left time: 12279.8977s
	iters: 200, epoch: 8 | loss: 0.0006175
	speed: 0.3458s/iter; left time: 3661.1066s
	iters: 300, epoch: 8 | loss: 0.0305914
	speed: 0.3711s/iter; left time: 3891.6443s
	iters: 400, epoch: 8 | loss: 0.2391040
	speed: 0.3323s/iter; left time: 3451.7260s
Epoch: 8 cost time: 169.20606184005737
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0040364
	speed: 1.1698s/iter; left time: 11954.1447s
	iters: 200, epoch: 9 | loss: 0.0045701
	speed: 0.3177s/iter; left time: 3214.4727s
	iters: 300, epoch: 9 | loss: 0.0006981
	speed: 0.3371s/iter; left time: 3377.0196s
	iters: 400, epoch: 9 | loss: 0.0061961
	speed: 0.2998s/iter; left time: 2973.8207s
Epoch: 9 cost time: 149.7837691307068
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.978273 --> -0.979702).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0005426
	speed: 1.0639s/iter; left time: 10373.0085s
	iters: 200, epoch: 10 | loss: 0.0010974
	speed: 0.3394s/iter; left time: 3275.5055s
	iters: 300, epoch: 10 | loss: 0.1445399
	speed: 0.3487s/iter; left time: 3330.4166s
	iters: 400, epoch: 10 | loss: 0.0576770
	speed: 0.3191s/iter; left time: 3015.3311s
Epoch: 10 cost time: 153.54044437408447
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0005627
	speed: 0.9130s/iter; left time: 8473.7101s
	iters: 200, epoch: 11 | loss: 0.0028830
	speed: 0.2871s/iter; left time: 2635.5501s
	iters: 300, epoch: 11 | loss: 0.0001394
	speed: 0.3097s/iter; left time: 2812.8256s
	iters: 400, epoch: 11 | loss: 0.0151411
	speed: 0.3039s/iter; left time: 2729.3955s
Epoch: 11 cost time: 143.2564857006073
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0028837
	speed: 1.0652s/iter; left time: 9386.5856s
	iters: 200, epoch: 12 | loss: 0.0047168
	speed: 0.3070s/iter; left time: 2674.4302s
	iters: 300, epoch: 12 | loss: 0.0053075
	speed: 0.2881s/iter; left time: 2481.2948s
	iters: 400, epoch: 12 | loss: 0.0033413
	speed: 0.2366s/iter; left time: 2013.8230s
Epoch: 12 cost time: 137.6988513469696
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3337085
	speed: 1.0579s/iter; left time: 8826.4424s
	iters: 200, epoch: 13 | loss: 0.0293377
	speed: 0.3316s/iter; left time: 2733.6934s
	iters: 300, epoch: 13 | loss: 0.0007286
	speed: 0.3476s/iter; left time: 2830.6749s
	iters: 400, epoch: 13 | loss: 0.0017383
	speed: 0.3470s/iter; left time: 2791.2318s
Epoch: 13 cost time: 156.66795778274536
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0089855
	speed: 1.0524s/iter; left time: 8286.7798s
	iters: 200, epoch: 14 | loss: 0.0010040
	speed: 0.3048s/iter; left time: 2369.8281s
	iters: 300, epoch: 14 | loss: 0.0013345
	speed: 0.3169s/iter; left time: 2431.6705s
	iters: 400, epoch: 14 | loss: 0.0032147
	speed: 0.3170s/iter; left time: 2401.1445s
Epoch: 14 cost time: 144.74889993667603
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0026981
	speed: 1.0874s/iter; left time: 8052.2346s
	iters: 200, epoch: 15 | loss: 0.0017530
	speed: 0.3415s/iter; left time: 2494.3123s
	iters: 300, epoch: 15 | loss: 0.0003147
	speed: 0.3438s/iter; left time: 2477.3213s
	iters: 400, epoch: 15 | loss: 0.0006702
	speed: 0.3389s/iter; left time: 2407.8968s
Epoch: 15 cost time: 157.61480355262756
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0003029
	speed: 0.9392s/iter; left time: 6514.4093s
	iters: 200, epoch: 16 | loss: 0.0007573
	speed: 0.2987s/iter; left time: 2041.6784s
	iters: 300, epoch: 16 | loss: 0.0004192
	speed: 0.3018s/iter; left time: 2033.1130s
	iters: 400, epoch: 16 | loss: 0.0025491
	speed: 0.3148s/iter; left time: 2088.8576s
Epoch: 16 cost time: 145.32287120819092
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0106457
	speed: 1.0700s/iter; left time: 6919.5813s
	iters: 200, epoch: 17 | loss: 0.0010729
	speed: 0.3234s/iter; left time: 2058.8293s
	iters: 300, epoch: 17 | loss: 0.0003819
	speed: 0.2797s/iter; left time: 1753.0880s
	iters: 400, epoch: 17 | loss: 0.0005131
	speed: 0.2624s/iter; left time: 1618.0652s
Epoch: 17 cost time: 136.38920998573303
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0003499
	speed: 0.8863s/iter; left time: 5316.2706s
	iters: 200, epoch: 18 | loss: 0.0005134
	speed: 0.3151s/iter; left time: 1858.3182s
	iters: 300, epoch: 18 | loss: 0.0004131
	speed: 0.3201s/iter; left time: 1856.0989s
	iters: 400, epoch: 18 | loss: 0.0017414
	speed: 0.3119s/iter; left time: 1777.0768s
Epoch: 18 cost time: 147.28059005737305
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.979702 --> -0.983418).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0483366
	speed: 1.0081s/iter; left time: 5573.5141s
	iters: 200, epoch: 19 | loss: 0.0797954
	speed: 0.2816s/iter; left time: 1528.9897s
	iters: 300, epoch: 19 | loss: 0.0001178
	speed: 0.2992s/iter; left time: 1594.3017s
	iters: 400, epoch: 19 | loss: 0.1174833
	speed: 0.2933s/iter; left time: 1533.5403s
Epoch: 19 cost time: 137.0274429321289
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0068650
	speed: 1.0429s/iter; left time: 5277.2208s
	iters: 200, epoch: 20 | loss: 0.0002873
	speed: 0.3163s/iter; left time: 1568.8594s
	iters: 300, epoch: 20 | loss: 0.0002804
	speed: 0.2683s/iter; left time: 1303.8117s
	iters: 400, epoch: 20 | loss: 0.0010456
	speed: 0.2611s/iter; left time: 1243.0455s
Epoch: 20 cost time: 135.0638782978058
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0001921
	speed: 0.8986s/iter; left time: 4125.6781s
	iters: 200, epoch: 21 | loss: 0.0002200
	speed: 0.2608s/iter; left time: 1171.0417s
	iters: 300, epoch: 21 | loss: 0.0008384
	speed: 0.2776s/iter; left time: 1219.0560s
	iters: 400, epoch: 21 | loss: 0.0007001
	speed: 0.3036s/iter; left time: 1302.8113s
Epoch: 21 cost time: 131.8529953956604
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0130672
	speed: 0.9622s/iter; left time: 3966.2903s
	iters: 200, epoch: 22 | loss: 0.0007941
	speed: 0.2509s/iter; left time: 1008.9253s
	iters: 300, epoch: 22 | loss: 0.0016882
	speed: 0.2922s/iter; left time: 1145.8207s
	iters: 400, epoch: 22 | loss: 0.0055532
	speed: 0.2593s/iter; left time: 991.1462s
Epoch: 22 cost time: 126.9632670879364
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0005241
	speed: 1.0372s/iter; left time: 3788.9618s
	iters: 200, epoch: 23 | loss: 0.0005945
	speed: 0.3496s/iter; left time: 1241.9734s
	iters: 300, epoch: 23 | loss: 0.0003317
	speed: 0.3583s/iter; left time: 1237.3548s
	iters: 400, epoch: 23 | loss: 0.0002016
	speed: 0.3568s/iter; left time: 1196.3807s
Epoch: 23 cost time: 163.35564661026
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0030137
	speed: 1.0259s/iter; left time: 3266.4892s
	iters: 200, epoch: 24 | loss: 0.0013738
	speed: 0.3035s/iter; left time: 936.0926s
	iters: 300, epoch: 24 | loss: 0.0496681
	speed: 0.2832s/iter; left time: 844.9893s
	iters: 400, epoch: 24 | loss: 0.1516795
	speed: 0.3006s/iter; left time: 866.8707s
Epoch: 24 cost time: 137.5093629360199
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0067850
	speed: 0.9349s/iter; left time: 2538.2762s
	iters: 200, epoch: 25 | loss: 0.0003433
	speed: 0.2114s/iter; left time: 552.7559s
	iters: 300, epoch: 25 | loss: 0.0286815
	speed: 0.3526s/iter; left time: 886.7240s
	iters: 400, epoch: 25 | loss: 0.0011398
	speed: 0.3288s/iter; left time: 794.0245s
Epoch: 25 cost time: 141.31977796554565
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0011678
	speed: 1.0382s/iter; left time: 2331.7159s
	iters: 200, epoch: 26 | loss: 0.0012230
	speed: 0.3060s/iter; left time: 656.6154s
	iters: 300, epoch: 26 | loss: 0.0001783
	speed: 0.3088s/iter; left time: 631.8262s
	iters: 400, epoch: 26 | loss: 0.0005773
	speed: 0.3573s/iter; left time: 695.3260s
Epoch: 26 cost time: 146.49035167694092
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000951
	speed: 1.0482s/iter; left time: 1862.5927s
	iters: 200, epoch: 27 | loss: 0.0007563
	speed: 0.2704s/iter; left time: 453.4281s
	iters: 300, epoch: 27 | loss: 0.0000556
	speed: 0.3156s/iter; left time: 497.6952s
	iters: 400, epoch: 27 | loss: 0.0002937
	speed: 0.3263s/iter; left time: 481.8908s
Epoch: 27 cost time: 144.73146629333496
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0008289
	speed: 0.9628s/iter; left time: 1259.3069s
	iters: 200, epoch: 28 | loss: 0.0003068
	speed: 0.2603s/iter; left time: 314.4414s
	iters: 300, epoch: 28 | loss: 0.0001503
	speed: 0.2900s/iter; left time: 321.3528s
	iters: 400, epoch: 28 | loss: 0.0009516
	speed: 0.3307s/iter; left time: 333.3524s
Epoch: 28 cost time: 135.13226413726807
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 4691082
model size : 18.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1619058
	speed: 0.1904s/iter; left time: 2659.7826s
	iters: 200, epoch: 1 | loss: 0.5563283
	speed: 0.1539s/iter; left time: 2134.4799s
	iters: 300, epoch: 1 | loss: 0.1034257
	speed: 0.1503s/iter; left time: 2070.1510s
	iters: 400, epoch: 1 | loss: 0.1537003
	speed: 0.2086s/iter; left time: 2851.8863s
Epoch: 1 cost time: 85.03697800636292
Epoch: 1, Steps: 469 | Train Loss: 0.672 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (inf --> -0.957689).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1996617
	speed: 0.8126s/iter; left time: 10971.8576s
	iters: 200, epoch: 2 | loss: 0.0464019
	speed: 0.2034s/iter; left time: 2725.5502s
	iters: 300, epoch: 2 | loss: 0.2565704
	speed: 0.1824s/iter; left time: 2425.6624s
	iters: 400, epoch: 2 | loss: 0.0956218
	speed: 0.1920s/iter; left time: 2535.0732s
Epoch: 2 cost time: 94.86587071418762
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.957689 --> -0.957689).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0151925
	speed: 0.7746s/iter; left time: 10095.3462s
	iters: 200, epoch: 3 | loss: 0.0524275
	speed: 0.2114s/iter; left time: 2733.8600s
	iters: 300, epoch: 3 | loss: 0.0268472
	speed: 0.2360s/iter; left time: 3028.0284s
	iters: 400, epoch: 3 | loss: 0.0086199
	speed: 0.2107s/iter; left time: 2682.5607s
Epoch: 3 cost time: 100.0277853012085
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.957689 --> -0.977987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0050782
	speed: 0.5901s/iter; left time: 7414.6226s
	iters: 200, epoch: 4 | loss: 0.5981108
	speed: 0.1794s/iter; left time: 2235.6252s
	iters: 300, epoch: 4 | loss: 0.0038581
	speed: 0.2021s/iter; left time: 2498.5688s
	iters: 400, epoch: 4 | loss: 0.0231349
	speed: 0.2003s/iter; left time: 2456.1849s
Epoch: 4 cost time: 88.25886392593384
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.977987 --> -0.981131).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0148356
	speed: 0.6024s/iter; left time: 7285.6658s
	iters: 200, epoch: 5 | loss: 0.0038716
	speed: 0.1652s/iter; left time: 1981.9943s
	iters: 300, epoch: 5 | loss: 0.0107171
	speed: 0.1376s/iter; left time: 1637.2255s
	iters: 400, epoch: 5 | loss: 0.0025099
	speed: 0.1607s/iter; left time: 1894.9214s
Epoch: 5 cost time: 71.77302408218384
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0070685
	speed: 0.6629s/iter; left time: 7706.4267s
	iters: 200, epoch: 6 | loss: 0.0019757
	speed: 0.1842s/iter; left time: 2123.3720s
	iters: 300, epoch: 6 | loss: 0.0219022
	speed: 0.1840s/iter; left time: 2102.0999s
	iters: 400, epoch: 6 | loss: 0.0040604
	speed: 0.1251s/iter; left time: 1416.5646s
Epoch: 6 cost time: 73.01778602600098
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0085952
	speed: 0.4989s/iter; left time: 5565.8721s
	iters: 200, epoch: 7 | loss: 0.2106411
	speed: 0.1846s/iter; left time: 2041.1418s
	iters: 300, epoch: 7 | loss: 0.1235760
	speed: 0.2065s/iter; left time: 2263.0037s
	iters: 400, epoch: 7 | loss: 0.0035492
	speed: 0.1976s/iter; left time: 2144.9638s
Epoch: 7 cost time: 89.02444767951965
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0084229
	speed: 0.6598s/iter; left time: 7051.6926s
	iters: 200, epoch: 8 | loss: 0.0011567
	speed: 0.1363s/iter; left time: 1443.3114s
	iters: 300, epoch: 8 | loss: 0.0043296
	speed: 0.1667s/iter; left time: 1748.1377s
	iters: 400, epoch: 8 | loss: 0.0331861
	speed: 0.1574s/iter; left time: 1634.8827s
Epoch: 8 cost time: 77.73223042488098
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0008900
	speed: 0.6500s/iter; left time: 6642.7056s
	iters: 200, epoch: 9 | loss: 0.0009107
	speed: 0.1803s/iter; left time: 1824.2767s
	iters: 300, epoch: 9 | loss: 0.0027460
	speed: 0.1228s/iter; left time: 1230.7392s
	iters: 400, epoch: 9 | loss: 0.0009608
	speed: 0.1316s/iter; left time: 1305.4167s
Epoch: 9 cost time: 68.29120349884033
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3249701
	speed: 0.5625s/iter; left time: 5484.5517s
	iters: 200, epoch: 10 | loss: 0.0028124
	speed: 0.1861s/iter; left time: 1795.4602s
	iters: 300, epoch: 10 | loss: 0.0107354
	speed: 0.1400s/iter; left time: 1337.3285s
	iters: 400, epoch: 10 | loss: 0.0028776
	speed: 0.2174s/iter; left time: 2054.1807s
Epoch: 10 cost time: 86.13426041603088
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.057 Vali Acc: 0.989 Test Loss: 0.057 Test Acc: 0.989
Validation loss decreased (-0.981417 --> -0.988564).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0007871
	speed: 0.7081s/iter; left time: 6571.8576s
	iters: 200, epoch: 11 | loss: 0.0007055
	speed: 0.1840s/iter; left time: 1689.3561s
	iters: 300, epoch: 11 | loss: 0.0004471
	speed: 0.2208s/iter; left time: 2005.4590s
	iters: 400, epoch: 11 | loss: 0.0016029
	speed: 0.2217s/iter; left time: 1991.3968s
Epoch: 11 cost time: 96.8944981098175
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0272653
	speed: 0.7614s/iter; left time: 6709.8433s
	iters: 200, epoch: 12 | loss: 0.0181279
	speed: 0.1725s/iter; left time: 1503.0504s
	iters: 300, epoch: 12 | loss: 0.0094187
	speed: 0.1849s/iter; left time: 1591.9627s
	iters: 400, epoch: 12 | loss: 0.0062658
	speed: 0.1833s/iter; left time: 1559.9429s
Epoch: 12 cost time: 85.84097409248352
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0041500
	speed: 0.7731s/iter; left time: 6450.1746s
	iters: 200, epoch: 13 | loss: 0.0021299
	speed: 0.2147s/iter; left time: 1770.1470s
	iters: 300, epoch: 13 | loss: 0.0003674
	speed: 0.1755s/iter; left time: 1429.3584s
	iters: 400, epoch: 13 | loss: 0.0411938
	speed: 0.1630s/iter; left time: 1311.2928s
Epoch: 13 cost time: 90.38262033462524
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0018426
	speed: 0.6487s/iter; left time: 5107.9649s
	iters: 200, epoch: 14 | loss: 0.0003409
	speed: 0.1885s/iter; left time: 1465.7389s
	iters: 300, epoch: 14 | loss: 0.0010008
	speed: 0.2122s/iter; left time: 1628.7387s
	iters: 400, epoch: 14 | loss: 0.0004077
	speed: 0.1953s/iter; left time: 1479.3509s
Epoch: 14 cost time: 92.94073271751404
Epoch: 14, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0045574
	speed: 0.7121s/iter; left time: 5273.0968s
	iters: 200, epoch: 15 | loss: 0.0008294
	speed: 0.1521s/iter; left time: 1111.1598s
	iters: 300, epoch: 15 | loss: 0.0024336
	speed: 0.1813s/iter; left time: 1306.2546s
	iters: 400, epoch: 15 | loss: 0.0001886
	speed: 0.1301s/iter; left time: 924.4038s
Epoch: 15 cost time: 75.6222825050354
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0006380
	speed: 0.7588s/iter; left time: 5262.8088s
	iters: 200, epoch: 16 | loss: 0.0024149
	speed: 0.2159s/iter; left time: 1476.1404s
	iters: 300, epoch: 16 | loss: 0.0004501
	speed: 0.2056s/iter; left time: 1385.0734s
	iters: 400, epoch: 16 | loss: 0.0014804
	speed: 0.1783s/iter; left time: 1183.3827s
Epoch: 16 cost time: 96.77810788154602
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0037951
	speed: 0.7207s/iter; left time: 4660.7369s
	iters: 200, epoch: 17 | loss: 0.0003135
	speed: 0.2052s/iter; left time: 1306.3276s
	iters: 300, epoch: 17 | loss: 0.0006336
	speed: 0.1805s/iter; left time: 1131.1736s
	iters: 400, epoch: 17 | loss: 0.0067863
	speed: 0.1980s/iter; left time: 1221.2070s
Epoch: 17 cost time: 93.03275609016418
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0004277
	speed: 0.5865s/iter; left time: 3517.5727s
	iters: 200, epoch: 18 | loss: 0.0002755
	speed: 0.0990s/iter; left time: 584.0349s
	iters: 300, epoch: 18 | loss: 0.0000893
	speed: 0.1539s/iter; left time: 892.1839s
	iters: 400, epoch: 18 | loss: 0.0217594
	speed: 0.1861s/iter; left time: 1060.1520s
Epoch: 18 cost time: 66.94890022277832
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0002894
	speed: 0.6824s/iter; left time: 3773.1190s
	iters: 200, epoch: 19 | loss: 0.0001538
	speed: 0.1529s/iter; left time: 830.0445s
	iters: 300, epoch: 19 | loss: 0.0674981
	speed: 0.1540s/iter; left time: 820.5937s
	iters: 400, epoch: 19 | loss: 0.0009890
	speed: 0.1276s/iter; left time: 667.3672s
Epoch: 19 cost time: 73.72822618484497
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0591804
	speed: 0.5822s/iter; left time: 2946.1485s
	iters: 200, epoch: 20 | loss: 0.0023935
	speed: 0.1510s/iter; left time: 748.7781s
	iters: 300, epoch: 20 | loss: 0.0051248
	speed: 0.1806s/iter; left time: 877.7658s
	iters: 400, epoch: 20 | loss: 0.0126821
	speed: 0.1850s/iter; left time: 880.5027s
Epoch: 20 cost time: 76.8129894733429
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9885648942252716
model parameter : 1380746
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3199352
	speed: 0.1873s/iter; left time: 2616.2644s
	iters: 200, epoch: 1 | loss: 0.5538357
	speed: 0.1746s/iter; left time: 2422.5529s
	iters: 300, epoch: 1 | loss: 0.3833655
	speed: 0.1672s/iter; left time: 2302.0166s
	iters: 400, epoch: 1 | loss: 0.1653597
	speed: 0.1771s/iter; left time: 2421.2779s
Epoch: 1 cost time: 82.255526304245
Epoch: 1, Steps: 469 | Train Loss: 0.747 Vali Loss: 0.223 Vali Acc: 0.927 Test Loss: 0.223 Test Acc: 0.927
Validation loss decreased (inf --> -0.926813).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1095755
	speed: 0.4698s/iter; left time: 6343.7172s
	iters: 200, epoch: 2 | loss: 0.0339103
	speed: 0.1100s/iter; left time: 1474.3265s
	iters: 300, epoch: 2 | loss: 0.0592033
	speed: 0.1285s/iter; left time: 1709.8519s
	iters: 400, epoch: 2 | loss: 0.0604905
	speed: 0.1198s/iter; left time: 1581.2333s
Epoch: 2 cost time: 56.15710759162903
Epoch: 2, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.136 Vali Acc: 0.955 Test Loss: 0.136 Test Acc: 0.955
Validation loss decreased (-0.926813 --> -0.955116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0140118
	speed: 0.4056s/iter; left time: 5286.7852s
	iters: 200, epoch: 3 | loss: 0.0382443
	speed: 0.1398s/iter; left time: 1808.3429s
	iters: 300, epoch: 3 | loss: 0.0315367
	speed: 0.1516s/iter; left time: 1945.1719s
	iters: 400, epoch: 3 | loss: 0.0177162
	speed: 0.1248s/iter; left time: 1588.8225s
Epoch: 3 cost time: 59.37110209465027
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.955116 --> -0.973127).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2493983
	speed: 0.6797s/iter; left time: 8539.8803s
	iters: 200, epoch: 4 | loss: 0.0708668
	speed: 0.1574s/iter; left time: 1962.2565s
	iters: 300, epoch: 4 | loss: 0.0640673
	speed: 0.1603s/iter; left time: 1981.9034s
	iters: 400, epoch: 4 | loss: 0.0121596
	speed: 0.1655s/iter; left time: 2030.0506s
Epoch: 4 cost time: 78.98211169242859
Epoch: 4, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.973127 --> -0.974842).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0058117
	speed: 0.6583s/iter; left time: 7962.2820s
	iters: 200, epoch: 5 | loss: 0.0034318
	speed: 0.1842s/iter; left time: 2208.9138s
	iters: 300, epoch: 5 | loss: 0.0106471
	speed: 0.1886s/iter; left time: 2242.9628s
	iters: 400, epoch: 5 | loss: 0.0339504
	speed: 0.1808s/iter; left time: 2132.3580s
Epoch: 5 cost time: 88.06545066833496
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0014582
	speed: 0.5983s/iter; left time: 6955.4010s
	iters: 200, epoch: 6 | loss: 0.1644850
	speed: 0.1464s/iter; left time: 1687.2586s
	iters: 300, epoch: 6 | loss: 0.0550548
	speed: 0.1287s/iter; left time: 1470.4284s
	iters: 400, epoch: 6 | loss: 0.0019396
	speed: 0.1496s/iter; left time: 1694.7839s
Epoch: 6 cost time: 65.60718274116516
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0013044
	speed: 0.5445s/iter; left time: 6075.4499s
	iters: 200, epoch: 7 | loss: 0.0120128
	speed: 0.1608s/iter; left time: 1777.7467s
	iters: 300, epoch: 7 | loss: 0.0077795
	speed: 0.1535s/iter; left time: 1681.7341s
	iters: 400, epoch: 7 | loss: 0.0010162
	speed: 0.1544s/iter; left time: 1676.3829s
Epoch: 7 cost time: 70.52139663696289
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0016643
	speed: 0.5617s/iter; left time: 6003.4664s
	iters: 200, epoch: 8 | loss: 0.0020628
	speed: 0.1461s/iter; left time: 1547.1120s
	iters: 300, epoch: 8 | loss: 0.0016264
	speed: 0.1465s/iter; left time: 1536.0269s
	iters: 400, epoch: 8 | loss: 0.0108308
	speed: 0.1428s/iter; left time: 1483.9111s
Epoch: 8 cost time: 69.83555841445923
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.975414).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0104991
	speed: 0.6434s/iter; left time: 6575.2912s
	iters: 200, epoch: 9 | loss: 0.2112642
	speed: 0.1704s/iter; left time: 1724.4778s
	iters: 300, epoch: 9 | loss: 0.0043613
	speed: 0.1733s/iter; left time: 1736.4153s
	iters: 400, epoch: 9 | loss: 0.0071979
	speed: 0.1756s/iter; left time: 1742.1534s
Epoch: 9 cost time: 80.91683316230774
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0011005
	speed: 0.5004s/iter; left time: 4878.7313s
	iters: 200, epoch: 10 | loss: 0.0006556
	speed: 0.1315s/iter; left time: 1268.6231s
	iters: 300, epoch: 10 | loss: 0.0066182
	speed: 0.1237s/iter; left time: 1181.6846s
	iters: 400, epoch: 10 | loss: 0.0034998
	speed: 0.1345s/iter; left time: 1270.9635s
Epoch: 10 cost time: 61.05044984817505
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0030439
	speed: 0.5773s/iter; left time: 5357.9000s
	iters: 200, epoch: 11 | loss: 0.1764423
	speed: 0.1565s/iter; left time: 1436.4005s
	iters: 300, epoch: 11 | loss: 0.0010817
	speed: 0.1109s/iter; left time: 1007.3156s
	iters: 400, epoch: 11 | loss: 0.0028565
	speed: 0.1567s/iter; left time: 1406.9940s
Epoch: 11 cost time: 68.8012146949768
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0314272
	speed: 0.5701s/iter; left time: 5023.9126s
	iters: 200, epoch: 12 | loss: 0.0015274
	speed: 0.1344s/iter; left time: 1170.6315s
	iters: 300, epoch: 12 | loss: 0.0747609
	speed: 0.1423s/iter; left time: 1225.2865s
	iters: 400, epoch: 12 | loss: 0.0185744
	speed: 0.1495s/iter; left time: 1272.7567s
Epoch: 12 cost time: 68.46151733398438
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975414 --> -0.975985).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0107973
	speed: 0.5738s/iter; left time: 4787.4479s
	iters: 200, epoch: 13 | loss: 0.0071003
	speed: 0.1659s/iter; left time: 1367.7065s
	iters: 300, epoch: 13 | loss: 0.0004519
	speed: 0.1552s/iter; left time: 1263.9144s
	iters: 400, epoch: 13 | loss: 0.0009006
	speed: 0.1631s/iter; left time: 1312.0720s
Epoch: 13 cost time: 75.71295738220215
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0016927
	speed: 0.5414s/iter; left time: 4262.6921s
	iters: 200, epoch: 14 | loss: 0.0102778
	speed: 0.1052s/iter; left time: 817.5455s
	iters: 300, epoch: 14 | loss: 0.0018916
	speed: 0.2005s/iter; left time: 1538.5038s
	iters: 400, epoch: 14 | loss: 0.0023251
	speed: 0.1880s/iter; left time: 1424.0742s
Epoch: 14 cost time: 73.99627590179443
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0027967
	speed: 0.7439s/iter; left time: 5508.4812s
	iters: 200, epoch: 15 | loss: 0.0011023
	speed: 0.2080s/iter; left time: 1519.5602s
	iters: 300, epoch: 15 | loss: 0.2110714
	speed: 0.1657s/iter; left time: 1193.7660s
	iters: 400, epoch: 15 | loss: 0.0028489
	speed: 0.1729s/iter; left time: 1228.2190s
Epoch: 15 cost time: 87.13464975357056
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.975985 --> -0.980274).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0015688
	speed: 0.6685s/iter; left time: 4636.8352s
	iters: 200, epoch: 16 | loss: 0.0002872
	speed: 0.1576s/iter; left time: 1077.5187s
	iters: 300, epoch: 16 | loss: 0.0027685
	speed: 0.1443s/iter; left time: 972.0646s
	iters: 400, epoch: 16 | loss: 0.0056651
	speed: 0.1690s/iter; left time: 1121.6124s
Epoch: 16 cost time: 76.30434894561768
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.980274 --> -0.983132).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0062683
	speed: 0.6647s/iter; left time: 4298.3242s
	iters: 200, epoch: 17 | loss: 0.0008816
	speed: 0.1738s/iter; left time: 1106.7637s
	iters: 300, epoch: 17 | loss: 0.0005578
	speed: 0.1235s/iter; left time: 773.9842s
	iters: 400, epoch: 17 | loss: 0.0014504
	speed: 0.1557s/iter; left time: 959.9473s
Epoch: 17 cost time: 74.50325751304626
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0002492
	speed: 0.6836s/iter; left time: 4100.0292s
	iters: 200, epoch: 18 | loss: 0.0006569
	speed: 0.1646s/iter; left time: 970.9665s
	iters: 300, epoch: 18 | loss: 0.0533336
	speed: 0.1887s/iter; left time: 1094.1818s
	iters: 400, epoch: 18 | loss: 0.0061647
	speed: 0.2019s/iter; left time: 1150.3843s
Epoch: 18 cost time: 86.61597418785095
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0109829
	speed: 0.6667s/iter; left time: 3686.4318s
	iters: 200, epoch: 19 | loss: 0.0032844
	speed: 0.1384s/iter; left time: 751.5390s
	iters: 300, epoch: 19 | loss: 0.0024148
	speed: 0.1547s/iter; left time: 824.2065s
	iters: 400, epoch: 19 | loss: 0.0994226
	speed: 0.1358s/iter; left time: 709.9867s
Epoch: 19 cost time: 67.06896185874939
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1478327
	speed: 0.5412s/iter; left time: 2738.2881s
	iters: 200, epoch: 20 | loss: 0.0285370
	speed: 0.1883s/iter; left time: 934.0092s
	iters: 300, epoch: 20 | loss: 0.0004657
	speed: 0.1664s/iter; left time: 808.6684s
	iters: 400, epoch: 20 | loss: 0.0004521
	speed: 0.1852s/iter; left time: 881.3978s
Epoch: 20 cost time: 79.82886362075806
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0002772
	speed: 0.6889s/iter; left time: 3162.7856s
	iters: 200, epoch: 21 | loss: 0.0090608
	speed: 0.1452s/iter; left time: 652.2186s
	iters: 300, epoch: 21 | loss: 0.0012938
	speed: 0.1181s/iter; left time: 518.3836s
	iters: 400, epoch: 21 | loss: 0.0130422
	speed: 0.0754s/iter; left time: 323.4320s
Epoch: 21 cost time: 58.55983853340149
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0011537
	speed: 0.4964s/iter; left time: 2046.0541s
	iters: 200, epoch: 22 | loss: 0.0003390
	speed: 0.1185s/iter; left time: 476.7631s
	iters: 300, epoch: 22 | loss: 0.0004638
	speed: 0.1603s/iter; left time: 628.7312s
	iters: 400, epoch: 22 | loss: 0.0165551
	speed: 0.1756s/iter; left time: 671.1199s
Epoch: 22 cost time: 73.62232875823975
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0009213
	speed: 0.6853s/iter; left time: 2503.2784s
	iters: 200, epoch: 23 | loss: 0.0006073
	speed: 0.1577s/iter; left time: 560.2463s
	iters: 300, epoch: 23 | loss: 0.0005612
	speed: 0.1706s/iter; left time: 589.2328s
	iters: 400, epoch: 23 | loss: 0.0016768
	speed: 0.1523s/iter; left time: 510.6496s
Epoch: 23 cost time: 77.41688323020935
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0010491
	speed: 0.6666s/iter; left time: 2122.4367s
	iters: 200, epoch: 24 | loss: 0.0009488
	speed: 0.1894s/iter; left time: 584.0395s
	iters: 300, epoch: 24 | loss: 0.0003224
	speed: 0.1800s/iter; left time: 537.0294s
	iters: 400, epoch: 24 | loss: 0.0113458
	speed: 0.1844s/iter; left time: 531.9113s
Epoch: 24 cost time: 87.22078537940979
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0016516
	speed: 0.5746s/iter; left time: 1559.9744s
	iters: 200, epoch: 25 | loss: 0.0021452
	speed: 0.1569s/iter; left time: 410.2019s
	iters: 300, epoch: 25 | loss: 0.3307049
	speed: 0.1320s/iter; left time: 331.8895s
	iters: 400, epoch: 25 | loss: 0.0031843
	speed: 0.1448s/iter; left time: 349.7629s
Epoch: 25 cost time: 66.32837915420532
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0007103
	speed: 0.5496s/iter; left time: 1234.4868s
	iters: 200, epoch: 26 | loss: 0.0008456
	speed: 0.1697s/iter; left time: 364.1604s
	iters: 300, epoch: 26 | loss: 0.0000492
	speed: 0.1684s/iter; left time: 344.4740s
	iters: 400, epoch: 26 | loss: 0.0002331
	speed: 0.1869s/iter; left time: 363.7680s
Epoch: 26 cost time: 76.49153971672058
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 4691082
model size : 18.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2950805
	speed: 0.1313s/iter; left time: 1834.8313s
	iters: 200, epoch: 1 | loss: 0.7363984
	speed: 0.1282s/iter; left time: 1777.7335s
	iters: 300, epoch: 1 | loss: 0.2184892
	speed: 0.1180s/iter; left time: 1625.4554s
	iters: 400, epoch: 1 | loss: 0.1413159
	speed: 0.1206s/iter; left time: 1648.1388s
Epoch: 1 cost time: 60.125948667526245
Epoch: 1, Steps: 469 | Train Loss: 0.791 Vali Loss: 0.209 Vali Acc: 0.940 Test Loss: 0.209 Test Acc: 0.940
Validation loss decreased (inf --> -0.940249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2318904
	speed: 0.5886s/iter; left time: 7946.6977s
	iters: 200, epoch: 2 | loss: 0.0664226
	speed: 0.0829s/iter; left time: 1110.3720s
	iters: 300, epoch: 2 | loss: 0.1348278
	speed: 0.1203s/iter; left time: 1600.2896s
	iters: 400, epoch: 2 | loss: 0.0245523
	speed: 0.1187s/iter; left time: 1566.6754s
Epoch: 2 cost time: 51.7580783367157
Epoch: 2, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
Validation loss decreased (-0.940249 --> -0.957403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0403691
	speed: 0.4814s/iter; left time: 6274.2755s
	iters: 200, epoch: 3 | loss: 0.0857075
	speed: 0.1033s/iter; left time: 1336.6074s
	iters: 300, epoch: 3 | loss: 0.0536505
	speed: 0.0746s/iter; left time: 957.8149s
	iters: 400, epoch: 3 | loss: 0.0259730
	speed: 0.0793s/iter; left time: 1009.1126s
Epoch: 3 cost time: 44.213513135910034
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
Validation loss decreased (-0.957403 --> -0.964264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0112820
	speed: 0.5411s/iter; left time: 6798.9533s
	iters: 200, epoch: 4 | loss: 0.6887599
	speed: 0.1335s/iter; left time: 1663.4075s
	iters: 300, epoch: 4 | loss: 0.0898030
	speed: 0.1285s/iter; left time: 1588.2205s
	iters: 400, epoch: 4 | loss: 0.0231736
	speed: 0.1247s/iter; left time: 1529.6258s
Epoch: 4 cost time: 60.22839546203613
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.964264 --> -0.976557).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0638663
	speed: 0.5386s/iter; left time: 6513.8315s
	iters: 200, epoch: 5 | loss: 0.0046372
	speed: 0.1063s/iter; left time: 1274.9246s
	iters: 300, epoch: 5 | loss: 0.0043204
	speed: 0.0752s/iter; left time: 894.4402s
	iters: 400, epoch: 5 | loss: 0.0055259
	speed: 0.0870s/iter; left time: 1025.7918s
Epoch: 5 cost time: 45.03295278549194
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0126292
	speed: 0.4480s/iter; left time: 5208.7081s
	iters: 200, epoch: 6 | loss: 0.0073875
	speed: 0.1192s/iter; left time: 1374.1759s
	iters: 300, epoch: 6 | loss: 0.0020900
	speed: 0.0993s/iter; left time: 1135.1495s
	iters: 400, epoch: 6 | loss: 0.0102725
	speed: 0.1082s/iter; left time: 1225.6734s
Epoch: 6 cost time: 55.38302993774414
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0507997
	speed: 0.5943s/iter; left time: 6630.5991s
	iters: 200, epoch: 7 | loss: 0.0029303
	speed: 0.1264s/iter; left time: 1397.7537s
	iters: 300, epoch: 7 | loss: 0.0520202
	speed: 0.1340s/iter; left time: 1468.1555s
	iters: 400, epoch: 7 | loss: 0.0034156
	speed: 0.1148s/iter; left time: 1246.1935s
Epoch: 7 cost time: 57.560144901275635
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0029510
	speed: 0.5799s/iter; left time: 6198.0112s
	iters: 200, epoch: 8 | loss: 0.0008012
	speed: 0.1374s/iter; left time: 1455.2065s
	iters: 300, epoch: 8 | loss: 0.0336150
	speed: 0.1343s/iter; left time: 1408.1661s
	iters: 400, epoch: 8 | loss: 0.0233629
	speed: 0.1559s/iter; left time: 1619.0822s
Epoch: 8 cost time: 67.03170776367188
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.977129 --> -0.983133).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0004295
	speed: 0.5266s/iter; left time: 5381.6254s
	iters: 200, epoch: 9 | loss: 0.0020355
	speed: 0.1078s/iter; left time: 1090.6652s
	iters: 300, epoch: 9 | loss: 0.0130247
	speed: 0.1204s/iter; left time: 1205.9072s
	iters: 400, epoch: 9 | loss: 0.0011478
	speed: 0.0977s/iter; left time: 969.3529s
Epoch: 9 cost time: 52.29475474357605
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.983133 --> -0.985420).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5939319
	speed: 0.4980s/iter; left time: 4855.0134s
	iters: 200, epoch: 10 | loss: 0.0028942
	speed: 0.1089s/iter; left time: 1051.2958s
	iters: 300, epoch: 10 | loss: 0.0018368
	speed: 0.1028s/iter; left time: 981.5324s
	iters: 400, epoch: 10 | loss: 0.0494511
	speed: 0.1034s/iter; left time: 977.2881s
Epoch: 10 cost time: 53.54720139503479
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0097512
	speed: 0.5798s/iter; left time: 5380.6818s
	iters: 200, epoch: 11 | loss: 0.0018516
	speed: 0.1284s/iter; left time: 1178.6603s
	iters: 300, epoch: 11 | loss: 0.0004824
	speed: 0.1454s/iter; left time: 1320.5490s
	iters: 400, epoch: 11 | loss: 0.0051227
	speed: 0.1081s/iter; left time: 970.7282s
Epoch: 11 cost time: 58.83546710014343
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0063808
	speed: 0.5392s/iter; left time: 4751.3913s
	iters: 200, epoch: 12 | loss: 0.1319178
	speed: 0.0878s/iter; left time: 764.7276s
	iters: 300, epoch: 12 | loss: 0.0049567
	speed: 0.0756s/iter; left time: 650.8960s
	iters: 400, epoch: 12 | loss: 0.0101785
	speed: 0.1111s/iter; left time: 945.4748s
Epoch: 12 cost time: 49.75108027458191
Epoch: 12, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0065553
	speed: 0.5458s/iter; left time: 4553.4190s
	iters: 200, epoch: 13 | loss: 0.0006830
	speed: 0.1127s/iter; left time: 928.9718s
	iters: 300, epoch: 13 | loss: 0.0001818
	speed: 0.1295s/iter; left time: 1054.2084s
	iters: 400, epoch: 13 | loss: 0.0038614
	speed: 0.1156s/iter; left time: 929.9704s
Epoch: 13 cost time: 55.41356635093689
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0031910
	speed: 0.4420s/iter; left time: 3480.0540s
	iters: 200, epoch: 14 | loss: 0.0005034
	speed: 0.0902s/iter; left time: 700.9353s
	iters: 300, epoch: 14 | loss: 0.0056989
	speed: 0.0820s/iter; left time: 629.2544s
	iters: 400, epoch: 14 | loss: 0.0000994
	speed: 0.1093s/iter; left time: 827.6334s
Epoch: 14 cost time: 45.7751739025116
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0259517
	speed: 0.4906s/iter; left time: 3632.8569s
	iters: 200, epoch: 15 | loss: 0.0130047
	speed: 0.0874s/iter; left time: 638.2586s
	iters: 300, epoch: 15 | loss: 0.0023480
	speed: 0.0929s/iter; left time: 669.3388s
	iters: 400, epoch: 15 | loss: 0.0005350
	speed: 0.1097s/iter; left time: 779.6742s
Epoch: 15 cost time: 48.25710868835449
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0003264
	speed: 0.4370s/iter; left time: 3030.9763s
	iters: 200, epoch: 16 | loss: 0.0255670
	speed: 0.0832s/iter; left time: 569.0953s
	iters: 300, epoch: 16 | loss: 0.0018213
	speed: 0.0826s/iter; left time: 556.5471s
	iters: 400, epoch: 16 | loss: 0.0041084
	speed: 0.0677s/iter; left time: 449.2251s
Epoch: 16 cost time: 39.96864581108093
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0002237
	speed: 0.4785s/iter; left time: 3094.5844s
	iters: 200, epoch: 17 | loss: 0.0010845
	speed: 0.1117s/iter; left time: 711.0116s
	iters: 300, epoch: 17 | loss: 0.0005596
	speed: 0.1160s/iter; left time: 727.0583s
	iters: 400, epoch: 17 | loss: 0.0018834
	speed: 0.0568s/iter; left time: 350.3215s
Epoch: 17 cost time: 44.42365479469299
Epoch: 17, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0003269
	speed: 0.4093s/iter; left time: 2454.8382s
	iters: 200, epoch: 18 | loss: 0.0000912
	speed: 0.1148s/iter; left time: 676.8890s
	iters: 300, epoch: 18 | loss: 0.0051610
	speed: 0.1116s/iter; left time: 647.3182s
	iters: 400, epoch: 18 | loss: 0.2532558
	speed: 0.0996s/iter; left time: 567.3363s
Epoch: 18 cost time: 49.31594204902649
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0005392
	speed: 0.3026s/iter; left time: 1672.8959s
	iters: 200, epoch: 19 | loss: 0.0005318
	speed: 0.1018s/iter; left time: 552.4055s
	iters: 300, epoch: 19 | loss: 0.0005715
	speed: 0.0962s/iter; left time: 512.6848s
	iters: 400, epoch: 19 | loss: 0.0007826
	speed: 0.1080s/iter; left time: 564.9325s
Epoch: 19 cost time: 46.15195417404175
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 1380746
model size : 5.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3163718
	speed: 0.4084s/iter; left time: 5705.1775s
	iters: 200, epoch: 1 | loss: 0.3632205
	speed: 0.3334s/iter; left time: 4624.2876s
	iters: 300, epoch: 1 | loss: 0.3082767
	speed: 0.2948s/iter; left time: 4059.3669s
	iters: 400, epoch: 1 | loss: 0.2088572
	speed: 0.3999s/iter; left time: 5466.8351s
Epoch: 1 cost time: 161.3881139755249
Epoch: 1, Steps: 469 | Train Loss: 0.730 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
Validation loss decreased (inf --> -0.945682).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0355243
	speed: 0.8148s/iter; left time: 11001.7090s
	iters: 200, epoch: 2 | loss: 0.0564126
	speed: 0.2328s/iter; left time: 3119.4349s
	iters: 300, epoch: 2 | loss: 0.0849615
	speed: 0.2391s/iter; left time: 3180.3458s
	iters: 400, epoch: 2 | loss: 0.1992282
	speed: 0.3187s/iter; left time: 4207.5060s
Epoch: 2 cost time: 140.23307967185974
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.118 Vali Acc: 0.961 Test Loss: 0.118 Test Acc: 0.961
Validation loss decreased (-0.945682 --> -0.961405).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0083075
	speed: 0.8454s/iter; left time: 11018.1498s
	iters: 200, epoch: 3 | loss: 0.0310959
	speed: 0.3064s/iter; left time: 3962.1520s
	iters: 300, epoch: 3 | loss: 0.0062910
	speed: 0.2115s/iter; left time: 2714.7953s
	iters: 400, epoch: 3 | loss: 0.0065207
	speed: 0.4153s/iter; left time: 5288.3512s
Epoch: 3 cost time: 157.73870491981506
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.961405 --> -0.970839).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0815993
	speed: 1.1286s/iter; left time: 14180.1873s
	iters: 200, epoch: 4 | loss: 0.0112966
	speed: 0.3950s/iter; left time: 4923.2862s
	iters: 300, epoch: 4 | loss: 0.3660536
	speed: 0.2423s/iter; left time: 2995.7216s
	iters: 400, epoch: 4 | loss: 0.0051370
	speed: 0.3513s/iter; left time: 4308.7727s
Epoch: 4 cost time: 170.4494490623474
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.970839 --> -0.978844).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0672282
	speed: 0.8277s/iter; left time: 10011.3921s
	iters: 200, epoch: 5 | loss: 0.1015829
	speed: 0.4190s/iter; left time: 5025.3179s
	iters: 300, epoch: 5 | loss: 0.0014882
	speed: 0.2670s/iter; left time: 3175.4463s
	iters: 400, epoch: 5 | loss: 0.0932938
	speed: 0.3585s/iter; left time: 4228.4383s
Epoch: 5 cost time: 154.94170260429382
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0115015
	speed: 0.8604s/iter; left time: 10003.1123s
	iters: 200, epoch: 6 | loss: 0.1421957
	speed: 0.3416s/iter; left time: 3936.8365s
	iters: 300, epoch: 6 | loss: 0.0358240
	speed: 0.2393s/iter; left time: 2733.7533s
	iters: 400, epoch: 6 | loss: 0.0441754
	speed: 0.2497s/iter; left time: 2827.7673s
Epoch: 6 cost time: 137.33003664016724
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0008059
	speed: 0.8656s/iter; left time: 9657.6462s
	iters: 200, epoch: 7 | loss: 0.0069288
	speed: 0.3044s/iter; left time: 3365.7125s
	iters: 300, epoch: 7 | loss: 0.0010128
	speed: 0.1789s/iter; left time: 1959.9836s
	iters: 400, epoch: 7 | loss: 0.0002308
	speed: 0.2293s/iter; left time: 2489.3935s
Epoch: 7 cost time: 121.72018933296204
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0025897
	speed: 0.8094s/iter; left time: 8650.7588s
	iters: 200, epoch: 8 | loss: 0.0013123
	speed: 0.4086s/iter; left time: 4326.6527s
	iters: 300, epoch: 8 | loss: 0.0172177
	speed: 0.2937s/iter; left time: 3080.3529s
	iters: 400, epoch: 8 | loss: 0.0006995
	speed: 0.3658s/iter; left time: 3800.3654s
Epoch: 8 cost time: 169.53274130821228
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.980274).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0178622
	speed: 1.0322s/iter; left time: 10548.3354s
	iters: 200, epoch: 9 | loss: 0.0024228
	speed: 0.2901s/iter; left time: 2935.1206s
	iters: 300, epoch: 9 | loss: 0.0030129
	speed: 0.4546s/iter; left time: 4554.3257s
	iters: 400, epoch: 9 | loss: 0.0013872
	speed: 0.4840s/iter; left time: 4800.8625s
Epoch: 9 cost time: 175.20342659950256
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0015538
	speed: 1.0814s/iter; left time: 10543.5320s
	iters: 200, epoch: 10 | loss: 0.0003960
	speed: 0.3585s/iter; left time: 3459.2146s
	iters: 300, epoch: 10 | loss: 0.0604944
	speed: 0.4696s/iter; left time: 4484.4587s
	iters: 400, epoch: 10 | loss: 0.0122823
	speed: 0.4187s/iter; left time: 3956.2478s
Epoch: 10 cost time: 188.55233025550842
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.980274 --> -0.983132).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0025535
	speed: 1.0071s/iter; left time: 9346.7578s
	iters: 200, epoch: 11 | loss: 0.0115781
	speed: 0.3909s/iter; left time: 3589.2411s
	iters: 300, epoch: 11 | loss: 0.0500164
	speed: 0.5224s/iter; left time: 4743.4619s
	iters: 400, epoch: 11 | loss: 0.0061358
	speed: 0.3529s/iter; left time: 3169.5003s
Epoch: 11 cost time: 194.0355908870697
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0240979
	speed: 1.1155s/iter; left time: 9830.0811s
	iters: 200, epoch: 12 | loss: 0.0005816
	speed: 0.3881s/iter; left time: 3381.1027s
	iters: 300, epoch: 12 | loss: 0.0009517
	speed: 0.4244s/iter; left time: 3655.0025s
	iters: 400, epoch: 12 | loss: 0.0056943
	speed: 0.3658s/iter; left time: 3113.5547s
Epoch: 12 cost time: 185.40754222869873
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0097660
	speed: 1.0241s/iter; left time: 8543.7880s
	iters: 200, epoch: 13 | loss: 0.0156612
	speed: 0.3461s/iter; left time: 2852.7729s
	iters: 300, epoch: 13 | loss: 0.0004418
	speed: 0.4061s/iter; left time: 3307.2752s
	iters: 400, epoch: 13 | loss: 0.0026536
	speed: 0.2802s/iter; left time: 2254.0066s
Epoch: 13 cost time: 153.34061074256897
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0003012
	speed: 0.8530s/iter; left time: 6716.7670s
	iters: 200, epoch: 14 | loss: 0.0030090
	speed: 0.3238s/iter; left time: 2516.9191s
	iters: 300, epoch: 14 | loss: 0.0015345
	speed: 0.3528s/iter; left time: 2707.6401s
	iters: 400, epoch: 14 | loss: 0.0007869
	speed: 0.2691s/iter; left time: 2038.3830s
Epoch: 14 cost time: 150.35310101509094
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0004639
	speed: 0.7492s/iter; left time: 5548.1014s
	iters: 200, epoch: 15 | loss: 0.0005884
	speed: 0.2899s/iter; left time: 2117.5122s
	iters: 300, epoch: 15 | loss: 0.0001981
	speed: 0.2356s/iter; left time: 1697.8552s
	iters: 400, epoch: 15 | loss: 0.0004337
	speed: 0.2263s/iter; left time: 1608.0315s
Epoch: 15 cost time: 118.52291297912598
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0005348
	speed: 0.7566s/iter; left time: 5247.6976s
	iters: 200, epoch: 16 | loss: 0.0003228
	speed: 0.2955s/iter; left time: 2020.2135s
	iters: 300, epoch: 16 | loss: 0.0011787
	speed: 0.2277s/iter; left time: 1533.9791s
	iters: 400, epoch: 16 | loss: 0.0010331
	speed: 0.2515s/iter; left time: 1668.7188s
Epoch: 16 cost time: 123.50938415527344
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0010800
	speed: 0.7480s/iter; left time: 4837.3004s
	iters: 200, epoch: 17 | loss: 0.0004123
	speed: 0.2634s/iter; left time: 1676.8169s
	iters: 300, epoch: 17 | loss: 0.0009505
	speed: 0.2113s/iter; left time: 1323.9204s
	iters: 400, epoch: 17 | loss: 0.0053861
	speed: 0.2780s/iter; left time: 1714.3059s
Epoch: 17 cost time: 120.28899097442627
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0002434
	speed: 0.7727s/iter; left time: 4634.4323s
	iters: 200, epoch: 18 | loss: 0.3817405
	speed: 0.2473s/iter; left time: 1458.6658s
	iters: 300, epoch: 18 | loss: 0.0005512
	speed: 0.2288s/iter; left time: 1326.3341s
	iters: 400, epoch: 18 | loss: 0.0017615
	speed: 0.3004s/iter; left time: 1711.8501s
Epoch: 18 cost time: 120.70638465881348
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0176692
	speed: 0.7236s/iter; left time: 4001.0466s
	iters: 200, epoch: 19 | loss: 0.0016106
	speed: 0.2096s/iter; left time: 1137.9292s
	iters: 300, epoch: 19 | loss: 0.0003146
	speed: 0.2424s/iter; left time: 1291.8483s
	iters: 400, epoch: 19 | loss: 0.0487083
	speed: 0.2825s/iter; left time: 1476.9390s
Epoch: 19 cost time: 116.19787168502808
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0010375
	speed: 0.7017s/iter; left time: 3550.7622s
	iters: 200, epoch: 20 | loss: 0.0003868
	speed: 0.1444s/iter; left time: 716.3784s
	iters: 300, epoch: 20 | loss: 0.0007932
	speed: 0.2947s/iter; left time: 1432.3208s
	iters: 400, epoch: 20 | loss: 0.0032839
	speed: 0.2888s/iter; left time: 1374.9257s
Epoch: 20 cost time: 115.57814598083496
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 2347402
model size : 9.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3884978
	speed: 0.1652s/iter; left time: 2307.5849s
	iters: 200, epoch: 1 | loss: 0.4230491
	speed: 0.1388s/iter; left time: 1925.0916s
	iters: 300, epoch: 1 | loss: 0.1707174
	speed: 0.1720s/iter; left time: 2368.7469s
	iters: 400, epoch: 1 | loss: 0.2034050
	speed: 0.0668s/iter; left time: 913.7041s
Epoch: 1 cost time: 60.59347319602966
Epoch: 1, Steps: 469 | Train Loss: 0.752 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
Validation loss decreased (inf --> -0.949398).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1743936
	speed: 0.4679s/iter; left time: 6317.5608s
	iters: 200, epoch: 2 | loss: 0.1694933
	speed: 0.1523s/iter; left time: 2041.4117s
	iters: 300, epoch: 2 | loss: 0.0747885
	speed: 0.1700s/iter; left time: 2261.8141s
	iters: 400, epoch: 2 | loss: 0.0044215
	speed: 0.1575s/iter; left time: 2079.1012s
Epoch: 2 cost time: 69.5042781829834
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.949398 --> -0.970554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0171428
	speed: 0.5005s/iter; left time: 6522.6798s
	iters: 200, epoch: 3 | loss: 0.0447239
	speed: 0.1061s/iter; left time: 1372.0170s
	iters: 300, epoch: 3 | loss: 0.0066774
	speed: 0.1863s/iter; left time: 2390.2822s
	iters: 400, epoch: 3 | loss: 0.1084320
	speed: 0.1433s/iter; left time: 1825.1012s
Epoch: 3 cost time: 69.22756218910217
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.970554 --> -0.974556).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0124557
	speed: 0.4809s/iter; left time: 6041.6384s
	iters: 200, epoch: 4 | loss: 0.0174342
	speed: 0.1373s/iter; left time: 1710.9599s
	iters: 300, epoch: 4 | loss: 0.0155372
	speed: 0.1349s/iter; left time: 1668.1793s
	iters: 400, epoch: 4 | loss: 0.3113585
	speed: 0.1740s/iter; left time: 2134.4071s
Epoch: 4 cost time: 67.12579727172852
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0158194
	speed: 0.5049s/iter; left time: 6107.0949s
	iters: 200, epoch: 5 | loss: 0.0078750
	speed: 0.1249s/iter; left time: 1498.0119s
	iters: 300, epoch: 5 | loss: 0.0069281
	speed: 0.1390s/iter; left time: 1653.6302s
	iters: 400, epoch: 5 | loss: 0.0338709
	speed: 0.1930s/iter; left time: 2276.1421s
Epoch: 5 cost time: 71.43304347991943
Epoch: 5, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0240772
	speed: 0.4957s/iter; left time: 5763.4609s
	iters: 200, epoch: 6 | loss: 0.0014092
	speed: 0.1148s/iter; left time: 1323.6891s
	iters: 300, epoch: 6 | loss: 0.0027291
	speed: 0.1583s/iter; left time: 1809.2806s
	iters: 400, epoch: 6 | loss: 0.3588500
	speed: 0.1463s/iter; left time: 1657.3177s
Epoch: 6 cost time: 65.53593230247498
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.974556 --> -0.984562).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0064984
	speed: 0.3898s/iter; left time: 4349.5546s
	iters: 200, epoch: 7 | loss: 0.0010817
	speed: 0.0945s/iter; left time: 1044.8900s
	iters: 300, epoch: 7 | loss: 0.0014354
	speed: 0.1325s/iter; left time: 1452.1174s
	iters: 400, epoch: 7 | loss: 0.0006151
	speed: 0.1401s/iter; left time: 1520.7523s
Epoch: 7 cost time: 55.548479318618774
Epoch: 7, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0073051
	speed: 0.4127s/iter; left time: 4411.2822s
	iters: 200, epoch: 8 | loss: 0.0092752
	speed: 0.1101s/iter; left time: 1166.1533s
	iters: 300, epoch: 8 | loss: 0.0009610
	speed: 0.1278s/iter; left time: 1340.6083s
	iters: 400, epoch: 8 | loss: 0.0015362
	speed: 0.1227s/iter; left time: 1274.6636s
Epoch: 8 cost time: 57.065460205078125
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0022965
	speed: 0.4238s/iter; left time: 4330.7064s
	iters: 200, epoch: 9 | loss: 0.0042453
	speed: 0.0917s/iter; left time: 927.9157s
	iters: 300, epoch: 9 | loss: 0.0122081
	speed: 0.1472s/iter; left time: 1475.1499s
	iters: 400, epoch: 9 | loss: 0.0006468
	speed: 0.1296s/iter; left time: 1285.6485s
Epoch: 9 cost time: 54.71926140785217
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0062905
	speed: 0.3969s/iter; left time: 3869.6878s
	iters: 200, epoch: 10 | loss: 0.0018892
	speed: 0.1060s/iter; left time: 1022.9913s
	iters: 300, epoch: 10 | loss: 0.0069262
	speed: 0.1380s/iter; left time: 1318.1094s
	iters: 400, epoch: 10 | loss: 0.0003149
	speed: 0.1059s/iter; left time: 1001.1116s
Epoch: 10 cost time: 53.91147327423096
Epoch: 10, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0014067
	speed: 0.4002s/iter; left time: 3714.1590s
	iters: 200, epoch: 11 | loss: 0.0007353
	speed: 0.0926s/iter; left time: 850.0116s
	iters: 300, epoch: 11 | loss: 0.0036295
	speed: 0.1487s/iter; left time: 1350.1115s
	iters: 400, epoch: 11 | loss: 0.0001626
	speed: 0.1090s/iter; left time: 978.8732s
Epoch: 11 cost time: 50.398529291152954
Epoch: 11, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0018261
	speed: 0.3605s/iter; left time: 3177.0643s
	iters: 200, epoch: 12 | loss: 0.0023470
	speed: 0.0812s/iter; left time: 707.2822s
	iters: 300, epoch: 12 | loss: 0.0001268
	speed: 0.1543s/iter; left time: 1329.0533s
	iters: 400, epoch: 12 | loss: 0.0016044
	speed: 0.1098s/iter; left time: 934.9844s
Epoch: 12 cost time: 49.74914050102234
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0025024
	speed: 0.3953s/iter; left time: 3297.7783s
	iters: 200, epoch: 13 | loss: 0.0023010
	speed: 0.1045s/iter; left time: 861.3232s
	iters: 300, epoch: 13 | loss: 0.0006356
	speed: 0.0895s/iter; left time: 728.6198s
	iters: 400, epoch: 13 | loss: 0.0005185
	speed: 0.0741s/iter; left time: 596.2967s
Epoch: 13 cost time: 44.529563903808594
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0068641
	speed: 0.5260s/iter; left time: 4141.9841s
	iters: 200, epoch: 14 | loss: 0.0004462
	speed: 0.1754s/iter; left time: 1363.4676s
	iters: 300, epoch: 14 | loss: 0.0014076
	speed: 0.1366s/iter; left time: 1048.6199s
	iters: 400, epoch: 14 | loss: 0.0005254
	speed: 0.1376s/iter; left time: 1042.4006s
Epoch: 14 cost time: 71.74934029579163
Epoch: 14, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0002154
	speed: 0.5132s/iter; left time: 3800.3709s
	iters: 200, epoch: 15 | loss: 0.0002266
	speed: 0.1847s/iter; left time: 1349.1307s
	iters: 300, epoch: 15 | loss: 0.0306040
	speed: 0.1856s/iter; left time: 1337.1115s
	iters: 400, epoch: 15 | loss: 0.0010696
	speed: 0.1470s/iter; left time: 1044.5528s
Epoch: 15 cost time: 81.11966371536255
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0036209
	speed: 0.4939s/iter; left time: 3425.5032s
	iters: 200, epoch: 16 | loss: 0.0003789
	speed: 0.1895s/iter; left time: 1295.4857s
	iters: 300, epoch: 16 | loss: 0.0385741
	speed: 0.1919s/iter; left time: 1292.5049s
	iters: 400, epoch: 16 | loss: 0.0002964
	speed: 0.1918s/iter; left time: 1272.6033s
Epoch: 16 cost time: 82.9767005443573
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 692106
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3157861
	speed: 0.2176s/iter; left time: 3040.0476s
	iters: 200, epoch: 1 | loss: 0.3712287
	speed: 0.2167s/iter; left time: 3005.3028s
	iters: 300, epoch: 1 | loss: 0.3145520
	speed: 0.2174s/iter; left time: 2993.9727s
	iters: 400, epoch: 1 | loss: 0.1924901
	speed: 0.1729s/iter; left time: 2363.9652s
Epoch: 1 cost time: 92.56532573699951
Epoch: 1, Steps: 469 | Train Loss: 0.742 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (inf --> -0.949970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0381671
	speed: 0.4673s/iter; left time: 6309.8554s
	iters: 200, epoch: 2 | loss: 0.0490974
	speed: 0.2004s/iter; left time: 2685.8387s
	iters: 300, epoch: 2 | loss: 0.0458926
	speed: 0.2001s/iter; left time: 2661.3428s
	iters: 400, epoch: 2 | loss: 0.2506347
	speed: 0.1706s/iter; left time: 2252.7408s
Epoch: 2 cost time: 84.41079092025757
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.949970 --> -0.957117).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0079443
	speed: 0.4651s/iter; left time: 6062.1662s
	iters: 200, epoch: 3 | loss: 0.0678803
	speed: 0.1976s/iter; left time: 2555.6288s
	iters: 300, epoch: 3 | loss: 0.0062364
	speed: 0.1925s/iter; left time: 2470.9371s
	iters: 400, epoch: 3 | loss: 0.0156600
	speed: 0.1811s/iter; left time: 2306.4773s
Epoch: 3 cost time: 82.98903894424438
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.957117 --> -0.972555).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0388636
	speed: 0.4516s/iter; left time: 5673.9452s
	iters: 200, epoch: 4 | loss: 0.0139125
	speed: 0.1813s/iter; left time: 2260.1870s
	iters: 300, epoch: 4 | loss: 0.3422962
	speed: 0.1915s/iter; left time: 2367.1158s
	iters: 400, epoch: 4 | loss: 0.0064119
	speed: 0.2036s/iter; left time: 2496.6233s
Epoch: 4 cost time: 82.92990326881409
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.972555 --> -0.980560).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0239451
	speed: 0.4737s/iter; left time: 5728.9101s
	iters: 200, epoch: 5 | loss: 0.0401782
	speed: 0.1645s/iter; left time: 1973.5477s
	iters: 300, epoch: 5 | loss: 0.0011697
	speed: 0.2121s/iter; left time: 2522.4147s
	iters: 400, epoch: 5 | loss: 0.0428142
	speed: 0.1999s/iter; left time: 2357.5889s
Epoch: 5 cost time: 85.6018123626709
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0166586
	speed: 0.4748s/iter; left time: 5519.7517s
	iters: 200, epoch: 6 | loss: 0.0263665
	speed: 0.1325s/iter; left time: 1526.9076s
	iters: 300, epoch: 6 | loss: 0.0408821
	speed: 0.1834s/iter; left time: 2095.3271s
	iters: 400, epoch: 6 | loss: 0.0951688
	speed: 0.1947s/iter; left time: 2204.6841s
Epoch: 6 cost time: 76.28379654884338
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0082207
	speed: 0.5145s/iter; left time: 5740.3422s
	iters: 200, epoch: 7 | loss: 0.0040638
	speed: 0.1914s/iter; left time: 2116.1119s
	iters: 300, epoch: 7 | loss: 0.0011334
	speed: 0.1861s/iter; left time: 2038.8797s
	iters: 400, epoch: 7 | loss: 0.0121668
	speed: 0.2415s/iter; left time: 2622.2094s
Epoch: 7 cost time: 95.60737538337708
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0036109
	speed: 0.6413s/iter; left time: 6854.7454s
	iters: 200, epoch: 8 | loss: 0.0028542
	speed: 0.1939s/iter; left time: 2052.6181s
	iters: 300, epoch: 8 | loss: 0.0016568
	speed: 0.1650s/iter; left time: 1730.5664s
	iters: 400, epoch: 8 | loss: 0.0090148
	speed: 0.2452s/iter; left time: 2546.9524s
Epoch: 8 cost time: 96.50380730628967
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0075759
	speed: 0.6307s/iter; left time: 6444.7189s
	iters: 200, epoch: 9 | loss: 0.0101151
	speed: 0.1778s/iter; left time: 1799.0142s
	iters: 300, epoch: 9 | loss: 0.0015246
	speed: 0.1600s/iter; left time: 1603.1547s
	iters: 400, epoch: 9 | loss: 0.0007298
	speed: 0.2192s/iter; left time: 2174.0617s
Epoch: 9 cost time: 89.65532565116882
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0088904
	speed: 0.6774s/iter; left time: 6605.1143s
	iters: 200, epoch: 10 | loss: 0.0045783
	speed: 0.1841s/iter; left time: 1776.2120s
	iters: 300, epoch: 10 | loss: 0.2387387
	speed: 0.1716s/iter; left time: 1638.3182s
	iters: 400, epoch: 10 | loss: 0.0017504
	speed: 0.2003s/iter; left time: 1893.0122s
Epoch: 10 cost time: 94.20701003074646
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0014453
	speed: 0.6999s/iter; left time: 6495.9750s
	iters: 200, epoch: 11 | loss: 0.0023457
	speed: 0.1669s/iter; left time: 1532.6672s
	iters: 300, epoch: 11 | loss: 0.1720375
	speed: 0.1695s/iter; left time: 1539.2689s
	iters: 400, epoch: 11 | loss: 0.0028423
	speed: 0.1941s/iter; left time: 1743.2914s
Epoch: 11 cost time: 89.38998436927795
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0578029
	speed: 0.6554s/iter; left time: 5775.5225s
	iters: 200, epoch: 12 | loss: 0.0012034
	speed: 0.2017s/iter; left time: 1757.4990s
	iters: 300, epoch: 12 | loss: 0.0022098
	speed: 0.1913s/iter; left time: 1647.1311s
	iters: 400, epoch: 12 | loss: 0.0013026
	speed: 0.1939s/iter; left time: 1650.0919s
Epoch: 12 cost time: 95.34110856056213
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.980560 --> -0.986849).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0392480
	speed: 0.6461s/iter; left time: 5390.1554s
	iters: 200, epoch: 13 | loss: 0.0256332
	speed: 0.2303s/iter; left time: 1898.2985s
	iters: 300, epoch: 13 | loss: 0.0356443
	speed: 0.1877s/iter; left time: 1528.5623s
	iters: 400, epoch: 13 | loss: 0.0022001
	speed: 0.1742s/iter; left time: 1401.1516s
Epoch: 13 cost time: 96.10877990722656
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0020456
	speed: 0.6234s/iter; left time: 4908.8684s
	iters: 200, epoch: 14 | loss: 0.0003152
	speed: 0.2269s/iter; left time: 1763.7849s
	iters: 300, epoch: 14 | loss: 0.0007259
	speed: 0.2159s/iter; left time: 1657.0408s
	iters: 400, epoch: 14 | loss: 0.0005190
	speed: 0.1582s/iter; left time: 1198.3138s
Epoch: 14 cost time: 91.48785471916199
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0004796
	speed: 0.4754s/iter; left time: 3520.0930s
	iters: 200, epoch: 15 | loss: 0.0004438
	speed: 0.0898s/iter; left time: 655.6882s
	iters: 300, epoch: 15 | loss: 0.0001187
	speed: 0.0588s/iter; left time: 423.8118s
	iters: 400, epoch: 15 | loss: 0.0015472
	speed: 0.1204s/iter; left time: 855.6345s
Epoch: 15 cost time: 55.83940386772156
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0033505
	speed: 0.4257s/iter; left time: 2952.9380s
	iters: 200, epoch: 16 | loss: 0.0204762
	speed: 0.1135s/iter; left time: 775.8502s
	iters: 300, epoch: 16 | loss: 0.0019916
	speed: 0.1647s/iter; left time: 1109.3828s
	iters: 400, epoch: 16 | loss: 0.0003898
	speed: 0.1585s/iter; left time: 1051.8870s
Epoch: 16 cost time: 62.0416944026947
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0596400
	speed: 0.4091s/iter; left time: 2645.5615s
	iters: 200, epoch: 17 | loss: 0.0017180
	speed: 0.1508s/iter; left time: 960.1685s
	iters: 300, epoch: 17 | loss: 0.0044564
	speed: 0.1205s/iter; left time: 755.3213s
	iters: 400, epoch: 17 | loss: 0.0019412
	speed: 0.1088s/iter; left time: 671.1582s
Epoch: 17 cost time: 59.41216850280762
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0006217
	speed: 0.4520s/iter; left time: 2711.2107s
	iters: 200, epoch: 18 | loss: 0.3967159
	speed: 0.1133s/iter; left time: 667.9955s
	iters: 300, epoch: 18 | loss: 0.0001950
	speed: 0.0930s/iter; left time: 538.9398s
	iters: 400, epoch: 18 | loss: 0.0016321
	speed: 0.1434s/iter; left time: 817.1935s
Epoch: 18 cost time: 64.23028206825256
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0115277
	speed: 0.4364s/iter; left time: 2412.6421s
	iters: 200, epoch: 19 | loss: 0.0409542
	speed: 0.1245s/iter; left time: 676.0610s
	iters: 300, epoch: 19 | loss: 0.0002584
	speed: 0.1798s/iter; left time: 958.1857s
	iters: 400, epoch: 19 | loss: 0.3417878
	speed: 0.1607s/iter; left time: 840.2016s
Epoch: 19 cost time: 64.17042112350464
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0007980
	speed: 0.4384s/iter; left time: 2218.4596s
	iters: 200, epoch: 20 | loss: 0.0007212
	speed: 0.1738s/iter; left time: 861.9434s
	iters: 300, epoch: 20 | loss: 0.0026911
	speed: 0.0939s/iter; left time: 456.3427s
	iters: 400, epoch: 20 | loss: 0.1112188
	speed: 0.1091s/iter; left time: 519.1822s
Epoch: 20 cost time: 61.76209831237793
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0016822
	speed: 0.4356s/iter; left time: 1999.6679s
	iters: 200, epoch: 21 | loss: 0.0000631
	speed: 0.1100s/iter; left time: 493.8504s
	iters: 300, epoch: 21 | loss: 0.0005776
	speed: 0.0941s/iter; left time: 413.3015s
	iters: 400, epoch: 21 | loss: 0.0002618
	speed: 0.1394s/iter; left time: 598.3335s
Epoch: 21 cost time: 58.97127556800842
Epoch: 21, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0215575
	speed: 0.4281s/iter; left time: 1764.7445s
	iters: 200, epoch: 22 | loss: 0.0013914
	speed: 0.1438s/iter; left time: 578.5518s
	iters: 300, epoch: 22 | loss: 0.0008249
	speed: 0.1947s/iter; left time: 763.5892s
	iters: 400, epoch: 22 | loss: 0.0003949
	speed: 0.1683s/iter; left time: 643.3773s
Epoch: 22 cost time: 70.87093710899353
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9868496283590623
model parameter : 2347402
model size : 9.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3908972
	speed: 0.1323s/iter; left time: 1847.7039s
	iters: 200, epoch: 1 | loss: 0.4204160
	speed: 0.0736s/iter; left time: 1021.3973s
	iters: 300, epoch: 1 | loss: 0.1777263
	speed: 0.0894s/iter; left time: 1231.3552s
	iters: 400, epoch: 1 | loss: 0.1735006
	speed: 0.0723s/iter; left time: 988.0948s
Epoch: 1 cost time: 42.89695358276367
Epoch: 1, Steps: 469 | Train Loss: 0.757 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (inf --> -0.952543).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1243802
	speed: 0.4072s/iter; left time: 5498.2601s
	iters: 200, epoch: 2 | loss: 0.1505023
	speed: 0.0680s/iter; left time: 910.9826s
	iters: 300, epoch: 2 | loss: 0.0294244
	speed: 0.0908s/iter; left time: 1208.4091s
	iters: 400, epoch: 2 | loss: 0.0041138
	speed: 0.0696s/iter; left time: 918.2625s
Epoch: 2 cost time: 41.24907445907593
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.952543 --> -0.974842).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0141650
	speed: 0.4028s/iter; left time: 5249.3248s
	iters: 200, epoch: 3 | loss: 0.0245217
	speed: 0.0788s/iter; left time: 1019.3439s
	iters: 300, epoch: 3 | loss: 0.0082884
	speed: 0.0949s/iter; left time: 1218.2543s
	iters: 400, epoch: 3 | loss: 0.0823900
	speed: 0.0709s/iter; left time: 902.2120s
Epoch: 3 cost time: 43.378575563430786
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102186
	speed: 0.2770s/iter; left time: 3479.6016s
	iters: 200, epoch: 4 | loss: 0.0749161
	speed: 0.0453s/iter; left time: 564.1006s
	iters: 300, epoch: 4 | loss: 0.0114465
	speed: 0.1155s/iter; left time: 1427.8611s
	iters: 400, epoch: 4 | loss: 0.3387137
	speed: 0.1273s/iter; left time: 1561.2072s
Epoch: 4 cost time: 44.5244414806366
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0454155
	speed: 0.4287s/iter; left time: 5184.5320s
	iters: 200, epoch: 5 | loss: 0.0409869
	speed: 0.1095s/iter; left time: 1313.5860s
	iters: 300, epoch: 5 | loss: 0.0130930
	speed: 0.0924s/iter; left time: 1099.4796s
	iters: 400, epoch: 5 | loss: 0.0191289
	speed: 0.1400s/iter; left time: 1651.7208s
Epoch: 5 cost time: 53.032177686691284
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978273).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0444802
	speed: 0.4425s/iter; left time: 5144.6086s
	iters: 200, epoch: 6 | loss: 0.0053270
	speed: 0.1010s/iter; left time: 1164.6220s
	iters: 300, epoch: 6 | loss: 0.0025443
	speed: 0.0920s/iter; left time: 1051.1025s
	iters: 400, epoch: 6 | loss: 0.0948968
	speed: 0.1046s/iter; left time: 1184.5606s
Epoch: 6 cost time: 47.62885856628418
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.978273 --> -0.984848).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0182429
	speed: 0.4874s/iter; left time: 5437.6724s
	iters: 200, epoch: 7 | loss: 0.0013622
	speed: 0.0856s/iter; left time: 946.0744s
	iters: 300, epoch: 7 | loss: 0.0019100
	speed: 0.1109s/iter; left time: 1214.6667s
	iters: 400, epoch: 7 | loss: 0.0005182
	speed: 0.0934s/iter; left time: 1014.5213s
Epoch: 7 cost time: 51.51672124862671
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0164901
	speed: 0.4203s/iter; left time: 4492.0424s
	iters: 200, epoch: 8 | loss: 0.0533320
	speed: 0.1159s/iter; left time: 1226.9190s
	iters: 300, epoch: 8 | loss: 0.0118598
	speed: 0.0831s/iter; left time: 871.2388s
	iters: 400, epoch: 8 | loss: 0.0061313
	speed: 0.0908s/iter; left time: 943.7178s
Epoch: 8 cost time: 45.360389709472656
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0023815
	speed: 0.3982s/iter; left time: 4069.6978s
	iters: 200, epoch: 9 | loss: 0.0034778
	speed: 0.1237s/iter; left time: 1251.4543s
	iters: 300, epoch: 9 | loss: 0.0006908
	speed: 0.1041s/iter; left time: 1043.4196s
	iters: 400, epoch: 9 | loss: 0.0007461
	speed: 0.0962s/iter; left time: 954.3013s
Epoch: 9 cost time: 51.22213888168335
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0007693
	speed: 0.3817s/iter; left time: 3721.2869s
	iters: 200, epoch: 10 | loss: 0.0165780
	speed: 0.1197s/iter; left time: 1155.1376s
	iters: 300, epoch: 10 | loss: 0.0021557
	speed: 0.1241s/iter; left time: 1185.2289s
	iters: 400, epoch: 10 | loss: 0.0011237
	speed: 0.0958s/iter; left time: 905.4105s
Epoch: 10 cost time: 53.258646965026855
Epoch: 10, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0003821
	speed: 0.3688s/iter; left time: 3422.4756s
	iters: 200, epoch: 11 | loss: 0.0008281
	speed: 0.1206s/iter; left time: 1107.5066s
	iters: 300, epoch: 11 | loss: 0.0020715
	speed: 0.1245s/iter; left time: 1130.8939s
	iters: 400, epoch: 11 | loss: 0.0001667
	speed: 0.1128s/iter; left time: 1012.6616s
Epoch: 11 cost time: 54.2348518371582
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0157137
	speed: 0.3564s/iter; left time: 3140.2613s
	iters: 200, epoch: 12 | loss: 0.0021818
	speed: 0.1204s/iter; left time: 1049.2771s
	iters: 300, epoch: 12 | loss: 0.0002592
	speed: 0.1321s/iter; left time: 1137.3467s
	iters: 400, epoch: 12 | loss: 0.0007171
	speed: 0.1278s/iter; left time: 1088.1998s
Epoch: 12 cost time: 54.636266469955444
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1072302
	speed: 0.3481s/iter; left time: 2903.9388s
	iters: 200, epoch: 13 | loss: 0.0002041
	speed: 0.1054s/iter; left time: 868.7958s
	iters: 300, epoch: 13 | loss: 0.0005019
	speed: 0.1314s/iter; left time: 1069.6796s
	iters: 400, epoch: 13 | loss: 0.0010284
	speed: 0.1234s/iter; left time: 992.2064s
Epoch: 13 cost time: 54.49062204360962
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0733176
	speed: 0.3647s/iter; left time: 2871.7390s
	iters: 200, epoch: 14 | loss: 0.0012641
	speed: 0.0889s/iter; left time: 691.3254s
	iters: 300, epoch: 14 | loss: 0.0107519
	speed: 0.1271s/iter; left time: 975.2878s
	iters: 400, epoch: 14 | loss: 0.0006202
	speed: 0.1193s/iter; left time: 903.4086s
Epoch: 14 cost time: 52.00506901741028
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0004112
	speed: 0.3686s/iter; left time: 2729.3352s
	iters: 200, epoch: 15 | loss: 0.0007342
	speed: 0.0905s/iter; left time: 661.1008s
	iters: 300, epoch: 15 | loss: 0.0147060
	speed: 0.1076s/iter; left time: 775.0119s
	iters: 400, epoch: 15 | loss: 0.0008628
	speed: 0.1203s/iter; left time: 854.6276s
Epoch: 15 cost time: 49.82714009284973
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0026669
	speed: 0.3694s/iter; left time: 2562.3842s
	iters: 200, epoch: 16 | loss: 0.0002443
	speed: 0.0930s/iter; left time: 635.8025s
	iters: 300, epoch: 16 | loss: 0.0006022
	speed: 0.0968s/iter; left time: 651.9254s
	iters: 400, epoch: 16 | loss: 0.0001436
	speed: 0.1082s/iter; left time: 718.0020s
Epoch: 16 cost time: 47.25922250747681
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 692106
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3941120
	speed: 0.1094s/iter; left time: 1528.3421s
	iters: 200, epoch: 1 | loss: 0.5768028
	speed: 0.0884s/iter; left time: 1226.2887s
	iters: 300, epoch: 1 | loss: 0.4446031
	speed: 0.1079s/iter; left time: 1485.3765s
	iters: 400, epoch: 1 | loss: 0.2812670
	speed: 0.1268s/iter; left time: 1733.1091s
Epoch: 1 cost time: 51.28137540817261
Epoch: 1, Steps: 469 | Train Loss: 0.828 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (inf --> -0.928242).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0700674
	speed: 0.3765s/iter; left time: 5083.2682s
	iters: 200, epoch: 2 | loss: 0.1534098
	speed: 0.0904s/iter; left time: 1212.1269s
	iters: 300, epoch: 2 | loss: 0.0365373
	speed: 0.0823s/iter; left time: 1094.2487s
	iters: 400, epoch: 2 | loss: 0.2457824
	speed: 0.1105s/iter; left time: 1459.1566s
Epoch: 2 cost time: 45.55098271369934
Epoch: 2, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.928242 --> -0.969982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0244273
	speed: 0.4011s/iter; left time: 5227.1609s
	iters: 200, epoch: 3 | loss: 0.0070519
	speed: 0.0997s/iter; left time: 1289.7337s
	iters: 300, epoch: 3 | loss: 0.0138442
	speed: 0.0846s/iter; left time: 1085.1320s
	iters: 400, epoch: 3 | loss: 0.0106094
	speed: 0.0943s/iter; left time: 1201.3376s
Epoch: 3 cost time: 43.16873550415039
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.969982 --> -0.975700).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0226301
	speed: 0.4096s/iter; left time: 5146.6194s
	iters: 200, epoch: 4 | loss: 0.0558111
	speed: 0.1066s/iter; left time: 1328.3484s
	iters: 300, epoch: 4 | loss: 0.0771258
	speed: 0.0845s/iter; left time: 1044.7075s
	iters: 400, epoch: 4 | loss: 0.0269260
	speed: 0.0661s/iter; left time: 810.3305s
Epoch: 4 cost time: 43.0579559803009
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1610356
	speed: 0.3536s/iter; left time: 4277.3317s
	iters: 200, epoch: 5 | loss: 0.1151125
	speed: 0.1167s/iter; left time: 1400.3364s
	iters: 300, epoch: 5 | loss: 0.0039195
	speed: 0.0981s/iter; left time: 1166.4591s
	iters: 400, epoch: 5 | loss: 0.0030378
	speed: 0.0784s/iter; left time: 924.3652s
Epoch: 5 cost time: 46.61165237426758
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.975700 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0654665
	speed: 0.3431s/iter; left time: 3988.8090s
	iters: 200, epoch: 6 | loss: 0.0073483
	speed: 0.1102s/iter; left time: 1270.6790s
	iters: 300, epoch: 6 | loss: 0.0066953
	speed: 0.1120s/iter; left time: 1280.1663s
	iters: 400, epoch: 6 | loss: 0.2920081
	speed: 0.0910s/iter; left time: 1031.0270s
Epoch: 6 cost time: 48.36743426322937
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0060369
	speed: 0.3050s/iter; left time: 3403.3771s
	iters: 200, epoch: 7 | loss: 0.0099511
	speed: 0.1175s/iter; left time: 1298.9953s
	iters: 300, epoch: 7 | loss: 0.0033646
	speed: 0.1189s/iter; left time: 1302.3116s
	iters: 400, epoch: 7 | loss: 0.0003906
	speed: 0.1158s/iter; left time: 1257.6461s
Epoch: 7 cost time: 50.147268295288086
Epoch: 7, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.938 Test Loss: 0.159 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0121845
	speed: 0.3203s/iter; left time: 3423.5179s
	iters: 200, epoch: 8 | loss: 0.0018908
	speed: 0.0724s/iter; left time: 767.0095s
	iters: 300, epoch: 8 | loss: 0.0060534
	speed: 0.0964s/iter; left time: 1011.4142s
	iters: 400, epoch: 8 | loss: 0.0007865
	speed: 0.0605s/iter; left time: 628.8650s
Epoch: 8 cost time: 34.50764346122742
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.980846).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0136639
	speed: 0.1687s/iter; left time: 1724.0535s
	iters: 200, epoch: 9 | loss: 0.0219961
	speed: 0.0919s/iter; left time: 929.5802s
	iters: 300, epoch: 9 | loss: 0.0012103
	speed: 0.0742s/iter; left time: 743.1450s
	iters: 400, epoch: 9 | loss: 0.0035399
	speed: 0.0649s/iter; left time: 644.1851s
Epoch: 9 cost time: 33.901336669921875
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1138293
	speed: 0.2696s/iter; left time: 2628.1684s
	iters: 200, epoch: 10 | loss: 0.0005980
	speed: 0.0659s/iter; left time: 635.4672s
	iters: 300, epoch: 10 | loss: 0.0501125
	speed: 0.0535s/iter; left time: 511.1206s
	iters: 400, epoch: 10 | loss: 0.0045172
	speed: 0.0581s/iter; left time: 549.5106s
Epoch: 10 cost time: 30.154362678527832
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0008240
	speed: 0.2769s/iter; left time: 2570.0582s
	iters: 200, epoch: 11 | loss: 0.0736414
	speed: 0.0579s/iter; left time: 531.2030s
	iters: 300, epoch: 11 | loss: 0.0035603
	speed: 0.0542s/iter; left time: 491.9269s
	iters: 400, epoch: 11 | loss: 0.0016473
	speed: 0.0688s/iter; left time: 618.2786s
Epoch: 11 cost time: 30.502331733703613
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0076895
	speed: 0.2906s/iter; left time: 2561.0278s
	iters: 200, epoch: 12 | loss: 0.0004785
	speed: 0.0698s/iter; left time: 608.3491s
	iters: 300, epoch: 12 | loss: 0.0447395
	speed: 0.1057s/iter; left time: 910.1176s
	iters: 400, epoch: 12 | loss: 0.0006490
	speed: 0.1245s/iter; left time: 1059.3300s
Epoch: 12 cost time: 45.86924743652344
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.980846 --> -0.982275).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0070487
	speed: 0.3258s/iter; left time: 2717.9224s
	iters: 200, epoch: 13 | loss: 0.1310551
	speed: 0.1187s/iter; left time: 978.5645s
	iters: 300, epoch: 13 | loss: 0.0002948
	speed: 0.1128s/iter; left time: 918.8321s
	iters: 400, epoch: 13 | loss: 0.0044946
	speed: 0.0872s/iter; left time: 701.3307s
Epoch: 13 cost time: 46.1496148109436
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0004622
	speed: 0.3615s/iter; left time: 2846.4597s
	iters: 200, epoch: 14 | loss: 0.0055013
	speed: 0.1021s/iter; left time: 793.7770s
	iters: 300, epoch: 14 | loss: 0.0633823
	speed: 0.0704s/iter; left time: 540.6046s
	iters: 400, epoch: 14 | loss: 0.0035393
	speed: 0.1020s/iter; left time: 772.2892s
Epoch: 14 cost time: 46.52186822891235
Epoch: 14, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0013816
	speed: 0.3537s/iter; left time: 2618.9202s
	iters: 200, epoch: 15 | loss: 0.0002243
	speed: 0.0846s/iter; left time: 617.8065s
	iters: 300, epoch: 15 | loss: 0.0000758
	speed: 0.0874s/iter; left time: 629.5262s
	iters: 400, epoch: 15 | loss: 0.0009885
	speed: 0.1154s/iter; left time: 819.8302s
Epoch: 15 cost time: 45.233123779296875
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002641
	speed: 0.3406s/iter; left time: 2362.6087s
	iters: 200, epoch: 16 | loss: 0.0005453
	speed: 0.1057s/iter; left time: 722.6120s
	iters: 300, epoch: 16 | loss: 0.0006713
	speed: 0.1263s/iter; left time: 850.4946s
	iters: 400, epoch: 16 | loss: 0.0007814
	speed: 0.0806s/iter; left time: 535.0944s
Epoch: 16 cost time: 46.83862519264221
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0012182
	speed: 0.3812s/iter; left time: 2465.3461s
	iters: 200, epoch: 17 | loss: 0.0004130
	speed: 0.0958s/iter; left time: 610.0969s
	iters: 300, epoch: 17 | loss: 0.0038666
	speed: 0.1015s/iter; left time: 636.0485s
	iters: 400, epoch: 17 | loss: 0.0004715
	speed: 0.0693s/iter; left time: 427.6088s
Epoch: 17 cost time: 46.01791024208069
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0027809
	speed: 0.3869s/iter; left time: 2320.4351s
	iters: 200, epoch: 18 | loss: 0.4481038
	speed: 0.0668s/iter; left time: 393.7938s
	iters: 300, epoch: 18 | loss: 0.0006508
	speed: 0.0846s/iter; left time: 490.4964s
	iters: 400, epoch: 18 | loss: 0.0130919
	speed: 0.1216s/iter; left time: 693.1093s
Epoch: 18 cost time: 46.01499700546265
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.982847).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0563578
	speed: 0.3518s/iter; left time: 1944.9254s
	iters: 200, epoch: 19 | loss: 0.0380590
	speed: 0.1042s/iter; left time: 565.6840s
	iters: 300, epoch: 19 | loss: 0.0001919
	speed: 0.1094s/iter; left time: 583.2310s
	iters: 400, epoch: 19 | loss: 0.0284402
	speed: 0.1096s/iter; left time: 573.1126s
Epoch: 19 cost time: 46.13382363319397
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0015352
	speed: 0.3231s/iter; left time: 1634.9969s
	iters: 200, epoch: 20 | loss: 0.0066536
	speed: 0.1348s/iter; left time: 668.4042s
	iters: 300, epoch: 20 | loss: 0.0009375
	speed: 0.0649s/iter; left time: 315.2012s
	iters: 400, epoch: 20 | loss: 0.0032355
	speed: 0.0789s/iter; left time: 375.7264s
Epoch: 20 cost time: 45.48139452934265
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0004768
	speed: 0.2584s/iter; left time: 1186.0885s
	iters: 200, epoch: 21 | loss: 0.0012019
	speed: 0.0370s/iter; left time: 166.3647s
	iters: 300, epoch: 21 | loss: 0.0020140
	speed: 0.0904s/iter; left time: 396.8173s
	iters: 400, epoch: 21 | loss: 0.0008282
	speed: 0.1294s/iter; left time: 555.1528s
Epoch: 21 cost time: 39.36798024177551
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0024419
	speed: 0.3881s/iter; left time: 1599.5468s
	iters: 200, epoch: 22 | loss: 0.0036870
	speed: 0.1277s/iter; left time: 513.4328s
	iters: 300, epoch: 22 | loss: 0.0137896
	speed: 0.1294s/iter; left time: 507.4233s
	iters: 400, epoch: 22 | loss: 0.0032441
	speed: 0.0982s/iter; left time: 375.2088s
Epoch: 22 cost time: 52.460012674331665
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002707
	speed: 0.3412s/iter; left time: 1246.4525s
	iters: 200, epoch: 23 | loss: 0.0012192
	speed: 0.0841s/iter; left time: 298.9518s
	iters: 300, epoch: 23 | loss: 0.0004921
	speed: 0.0862s/iter; left time: 297.7947s
	iters: 400, epoch: 23 | loss: 0.0019002
	speed: 0.0699s/iter; left time: 234.3045s
Epoch: 23 cost time: 41.67330551147461
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0076909
	speed: 0.3455s/iter; left time: 1099.9992s
	iters: 200, epoch: 24 | loss: 0.2467942
	speed: 0.0677s/iter; left time: 208.8708s
	iters: 300, epoch: 24 | loss: 0.0234117
	speed: 0.0863s/iter; left time: 257.6143s
	iters: 400, epoch: 24 | loss: 0.0003261
	speed: 0.0876s/iter; left time: 252.6740s
Epoch: 24 cost time: 41.55624961853027
Epoch: 24, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000927
	speed: 0.3400s/iter; left time: 923.1575s
	iters: 200, epoch: 25 | loss: 0.0000977
	speed: 0.0690s/iter; left time: 180.4154s
	iters: 300, epoch: 25 | loss: 0.0970835
	speed: 0.1191s/iter; left time: 299.5561s
	iters: 400, epoch: 25 | loss: 0.0007993
	speed: 0.1090s/iter; left time: 263.2780s
Epoch: 25 cost time: 43.04051685333252
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0002089
	speed: 0.3229s/iter; left time: 725.1613s
	iters: 200, epoch: 26 | loss: 0.0003976
	speed: 0.1229s/iter; left time: 263.7006s
	iters: 300, epoch: 26 | loss: 0.0005366
	speed: 0.0740s/iter; left time: 151.4353s
	iters: 400, epoch: 26 | loss: 0.0001857
	speed: 0.0779s/iter; left time: 151.6133s
Epoch: 26 cost time: 43.16913318634033
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0022001
	speed: 0.3313s/iter; left time: 588.7170s
	iters: 200, epoch: 27 | loss: 0.0240126
	speed: 0.0850s/iter; left time: 142.5955s
	iters: 300, epoch: 27 | loss: 0.0001159
	speed: 0.0642s/iter; left time: 101.1880s
	iters: 400, epoch: 27 | loss: 0.0005038
	speed: 0.0777s/iter; left time: 114.7242s
Epoch: 27 cost time: 39.5113091468811
Epoch: 27, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0001598
	speed: 0.3280s/iter; left time: 429.0653s
	iters: 200, epoch: 28 | loss: 0.0003284
	speed: 0.0870s/iter; left time: 105.1543s
	iters: 300, epoch: 28 | loss: 0.0860513
	speed: 0.0852s/iter; left time: 94.4152s
	iters: 400, epoch: 28 | loss: 0.0001427
	speed: 0.1165s/iter; left time: 117.4263s
Epoch: 28 cost time: 41.33421611785889
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 2347402
model size : 9.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4995253
	speed: 0.0817s/iter; left time: 1141.1824s
	iters: 200, epoch: 1 | loss: 0.5803232
	speed: 0.0573s/iter; left time: 794.3171s
	iters: 300, epoch: 1 | loss: 0.2944348
	speed: 0.0508s/iter; left time: 699.9491s
	iters: 400, epoch: 1 | loss: 0.3351390
	speed: 0.0487s/iter; left time: 666.1663s
Epoch: 1 cost time: 28.132007598876953
Epoch: 1, Steps: 469 | Train Loss: 0.870 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
Validation loss decreased (inf --> -0.915092).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2339113
	speed: 0.2936s/iter; left time: 3964.7349s
	iters: 200, epoch: 2 | loss: 0.1076081
	speed: 0.0523s/iter; left time: 701.4048s
	iters: 300, epoch: 2 | loss: 0.0394790
	speed: 0.0471s/iter; left time: 626.7875s
	iters: 400, epoch: 2 | loss: 0.0092935
	speed: 0.0639s/iter; left time: 843.3594s
Epoch: 2 cost time: 27.54721164703369
Epoch: 2, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.915092 --> -0.970839).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0194465
	speed: 0.2804s/iter; left time: 3654.9177s
	iters: 200, epoch: 3 | loss: 0.0338769
	speed: 0.0509s/iter; left time: 657.6561s
	iters: 300, epoch: 3 | loss: 0.0157989
	speed: 0.0598s/iter; left time: 767.2714s
	iters: 400, epoch: 3 | loss: 0.1805009
	speed: 0.0466s/iter; left time: 593.7857s
Epoch: 3 cost time: 24.789209604263306
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
Validation loss decreased (-0.970839 --> -0.971411).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0150295
	speed: 0.1601s/iter; left time: 2011.4459s
	iters: 200, epoch: 4 | loss: 0.0614740
	speed: 0.0266s/iter; left time: 332.1580s
	iters: 300, epoch: 4 | loss: 0.0127758
	speed: 0.0287s/iter; left time: 354.8909s
	iters: 400, epoch: 4 | loss: 0.2730517
	speed: 0.0542s/iter; left time: 664.1914s
Epoch: 4 cost time: 17.97088098526001
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0250212
	speed: 0.2061s/iter; left time: 2492.9278s
	iters: 200, epoch: 5 | loss: 0.0133873
	speed: 0.0753s/iter; left time: 903.3215s
	iters: 300, epoch: 5 | loss: 0.0110663
	speed: 0.0550s/iter; left time: 654.2877s
	iters: 400, epoch: 5 | loss: 0.0036414
	speed: 0.0410s/iter; left time: 483.1927s
Epoch: 5 cost time: 24.349802017211914
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2103037
	speed: 0.2051s/iter; left time: 2384.6049s
	iters: 200, epoch: 6 | loss: 0.0023399
	speed: 0.0503s/iter; left time: 579.8657s
	iters: 300, epoch: 6 | loss: 0.0041083
	speed: 0.0378s/iter; left time: 432.2504s
	iters: 400, epoch: 6 | loss: 0.0142246
	speed: 0.0599s/iter; left time: 678.0214s
Epoch: 6 cost time: 26.594143629074097
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.971411 --> -0.985420).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0103673
	speed: 0.2343s/iter; left time: 2613.5862s
	iters: 200, epoch: 7 | loss: 0.0016790
	speed: 0.0517s/iter; left time: 571.4691s
	iters: 300, epoch: 7 | loss: 0.0027824
	speed: 0.0760s/iter; left time: 833.0068s
	iters: 400, epoch: 7 | loss: 0.0006491
	speed: 0.0490s/iter; left time: 532.1370s
Epoch: 7 cost time: 25.614125967025757
Epoch: 7, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0025326
	speed: 0.2215s/iter; left time: 2366.9016s
	iters: 200, epoch: 8 | loss: 0.0604222
	speed: 0.0601s/iter; left time: 635.8503s
	iters: 300, epoch: 8 | loss: 0.0063498
	speed: 0.0425s/iter; left time: 445.7592s
	iters: 400, epoch: 8 | loss: 0.0040767
	speed: 0.0418s/iter; left time: 433.7123s
Epoch: 8 cost time: 24.5567524433136
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0135111
	speed: 0.2384s/iter; left time: 2436.2477s
	iters: 200, epoch: 9 | loss: 0.0073410
	speed: 0.0423s/iter; left time: 427.9327s
	iters: 300, epoch: 9 | loss: 0.0016585
	speed: 0.0555s/iter; left time: 556.4800s
	iters: 400, epoch: 9 | loss: 0.0006011
	speed: 0.0737s/iter; left time: 730.7544s
Epoch: 9 cost time: 25.628267765045166
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0029721
	speed: 0.2091s/iter; left time: 2039.1502s
	iters: 200, epoch: 10 | loss: 0.0277379
	speed: 0.0665s/iter; left time: 642.0124s
	iters: 300, epoch: 10 | loss: 0.0013403
	speed: 0.0490s/iter; left time: 468.3376s
	iters: 400, epoch: 10 | loss: 0.0012319
	speed: 0.0429s/iter; left time: 405.7576s
Epoch: 10 cost time: 24.96461057662964
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0005899
	speed: 0.2375s/iter; left time: 2204.5698s
	iters: 200, epoch: 11 | loss: 0.0016397
	speed: 0.0510s/iter; left time: 468.5953s
	iters: 300, epoch: 11 | loss: 0.0330342
	speed: 0.0482s/iter; left time: 438.0844s
	iters: 400, epoch: 11 | loss: 0.0011298
	speed: 0.0701s/iter; left time: 629.3696s
Epoch: 11 cost time: 26.232338905334473
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0046895
	speed: 0.2275s/iter; left time: 2005.0306s
	iters: 200, epoch: 12 | loss: 0.0055420
	speed: 0.0609s/iter; left time: 530.6881s
	iters: 300, epoch: 12 | loss: 0.0007954
	speed: 0.0513s/iter; left time: 441.5088s
	iters: 400, epoch: 12 | loss: 0.0005601
	speed: 0.0420s/iter; left time: 357.6164s
Epoch: 12 cost time: 25.04555654525757
Epoch: 12, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0679418
	speed: 0.2306s/iter; left time: 1923.9310s
	iters: 200, epoch: 13 | loss: 0.0014005
	speed: 0.0520s/iter; left time: 428.3707s
	iters: 300, epoch: 13 | loss: 0.0025164
	speed: 0.0421s/iter; left time: 342.5424s
	iters: 400, epoch: 13 | loss: 0.0009907
	speed: 0.0636s/iter; left time: 511.2719s
Epoch: 13 cost time: 25.93553614616394
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0210294
	speed: 0.2318s/iter; left time: 1824.8372s
	iters: 200, epoch: 14 | loss: 0.0029649
	speed: 0.0564s/iter; left time: 438.7209s
	iters: 300, epoch: 14 | loss: 0.0012158
	speed: 0.0473s/iter; left time: 362.8103s
	iters: 400, epoch: 14 | loss: 0.0003874
	speed: 0.0503s/iter; left time: 380.6504s
Epoch: 14 cost time: 24.752269744873047
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0003488
	speed: 0.2009s/iter; left time: 1487.5343s
	iters: 200, epoch: 15 | loss: 0.0014149
	speed: 0.0330s/iter; left time: 241.1152s
	iters: 300, epoch: 15 | loss: 0.1113746
	speed: 0.0432s/iter; left time: 311.5424s
	iters: 400, epoch: 15 | loss: 0.0006021
	speed: 0.0594s/iter; left time: 422.1979s
Epoch: 15 cost time: 21.145132303237915
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0004957
	speed: 0.2066s/iter; left time: 1433.2399s
	iters: 200, epoch: 16 | loss: 0.0154319
	speed: 0.0531s/iter; left time: 363.2146s
	iters: 300, epoch: 16 | loss: 0.0039441
	speed: 0.0364s/iter; left time: 245.0516s
	iters: 400, epoch: 16 | loss: 0.0015192
	speed: 0.0406s/iter; left time: 269.0928s
Epoch: 16 cost time: 21.814610481262207
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 692106
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5722952
	speed: 0.1149s/iter; left time: 1605.2259s
	iters: 200, epoch: 1 | loss: 0.5643225
	speed: 0.0893s/iter; left time: 1238.1345s
	iters: 300, epoch: 1 | loss: 0.6387846
	speed: 0.0910s/iter; left time: 1252.8155s
	iters: 400, epoch: 1 | loss: 0.2052688
	speed: 0.0969s/iter; left time: 1324.0962s
Epoch: 1 cost time: 45.32143521308899
Epoch: 1, Steps: 469 | Train Loss: 0.871 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (inf --> -0.944252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2999342
	speed: 0.3542s/iter; left time: 4781.7753s
	iters: 200, epoch: 2 | loss: 0.0915069
	speed: 0.0958s/iter; left time: 1283.8550s
	iters: 300, epoch: 2 | loss: 0.0504964
	speed: 0.0906s/iter; left time: 1205.2548s
	iters: 400, epoch: 2 | loss: 0.0352379
	speed: 0.0848s/iter; left time: 1118.9991s
Epoch: 2 cost time: 42.933340311050415
Epoch: 2, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
Validation loss decreased (-0.944252 --> -0.963692).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0121827
	speed: 0.3575s/iter; left time: 4659.1722s
	iters: 200, epoch: 3 | loss: 0.0487167
	speed: 0.0935s/iter; left time: 1209.0075s
	iters: 300, epoch: 3 | loss: 0.0361764
	speed: 0.0862s/iter; left time: 1106.5742s
	iters: 400, epoch: 3 | loss: 0.0276494
	speed: 0.0998s/iter; left time: 1270.4322s
Epoch: 3 cost time: 44.64895057678223
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.963692 --> -0.974556).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0113483
	speed: 0.3590s/iter; left time: 4510.4408s
	iters: 200, epoch: 4 | loss: 0.0246315
	speed: 0.0870s/iter; left time: 1083.8943s
	iters: 300, epoch: 4 | loss: 0.0200914
	speed: 0.0996s/iter; left time: 1231.8862s
	iters: 400, epoch: 4 | loss: 0.0538846
	speed: 0.0885s/iter; left time: 1085.9554s
Epoch: 4 cost time: 43.1019172668457
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0408863
	speed: 0.3499s/iter; left time: 4232.3405s
	iters: 200, epoch: 5 | loss: 0.0090538
	speed: 0.0950s/iter; left time: 1139.6459s
	iters: 300, epoch: 5 | loss: 0.0132543
	speed: 0.0872s/iter; left time: 1037.0353s
	iters: 400, epoch: 5 | loss: 0.0046026
	speed: 0.0822s/iter; left time: 969.2905s
Epoch: 5 cost time: 40.90394949913025
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0033471
	speed: 0.3214s/iter; left time: 3736.7586s
	iters: 200, epoch: 6 | loss: 0.0028602
	speed: 0.1207s/iter; left time: 1391.3673s
	iters: 300, epoch: 6 | loss: 0.0061545
	speed: 0.1119s/iter; left time: 1278.7646s
	iters: 400, epoch: 6 | loss: 0.1093829
	speed: 0.1011s/iter; left time: 1145.1809s
Epoch: 6 cost time: 51.80897116661072
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975699).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0013217
	speed: 0.3866s/iter; left time: 4313.7512s
	iters: 200, epoch: 7 | loss: 0.0065233
	speed: 0.1180s/iter; left time: 1305.1209s
	iters: 300, epoch: 7 | loss: 0.0671408
	speed: 0.1194s/iter; left time: 1308.5530s
	iters: 400, epoch: 7 | loss: 0.0052307
	speed: 0.1079s/iter; left time: 1171.5675s
Epoch: 7 cost time: 52.87489652633667
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.979130).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0395148
	speed: 0.3876s/iter; left time: 4142.9196s
	iters: 200, epoch: 8 | loss: 0.0014112
	speed: 0.1173s/iter; left time: 1241.9219s
	iters: 300, epoch: 8 | loss: 0.0109355
	speed: 0.1171s/iter; left time: 1227.6367s
	iters: 400, epoch: 8 | loss: 0.0041391
	speed: 0.1202s/iter; left time: 1248.8129s
Epoch: 8 cost time: 52.99681997299194
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.470 Vali Acc: 0.915 Test Loss: 0.470 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0023366
	speed: 0.3822s/iter; left time: 3905.6815s
	iters: 200, epoch: 9 | loss: 0.0036491
	speed: 0.1125s/iter; left time: 1137.9581s
	iters: 300, epoch: 9 | loss: 0.0028163
	speed: 0.1197s/iter; left time: 1199.4298s
	iters: 400, epoch: 9 | loss: 0.0198822
	speed: 0.1155s/iter; left time: 1146.0659s
Epoch: 9 cost time: 53.04175329208374
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.979130 --> -0.981703).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0011570
	speed: 0.3955s/iter; left time: 3856.4030s
	iters: 200, epoch: 10 | loss: 0.0099565
	speed: 0.0994s/iter; left time: 958.8641s
	iters: 300, epoch: 10 | loss: 0.0034049
	speed: 0.1173s/iter; left time: 1119.8520s
	iters: 400, epoch: 10 | loss: 0.0022430
	speed: 0.1221s/iter; left time: 1154.0697s
Epoch: 10 cost time: 51.97734069824219
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0018309
	speed: 0.3715s/iter; left time: 3448.0030s
	iters: 200, epoch: 11 | loss: 0.0157924
	speed: 0.0916s/iter; left time: 840.7366s
	iters: 300, epoch: 11 | loss: 0.0026062
	speed: 0.1116s/iter; left time: 1013.4461s
	iters: 400, epoch: 11 | loss: 0.0186696
	speed: 0.1081s/iter; left time: 971.1652s
Epoch: 11 cost time: 47.555471658706665
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0033774
	speed: 0.3812s/iter; left time: 3359.0889s
	iters: 200, epoch: 12 | loss: 0.0039236
	speed: 0.0920s/iter; left time: 801.7628s
	iters: 300, epoch: 12 | loss: 0.0054658
	speed: 0.1054s/iter; left time: 907.7049s
	iters: 400, epoch: 12 | loss: 0.0051911
	speed: 0.1112s/iter; left time: 946.6331s
Epoch: 12 cost time: 48.1855673789978
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0857610
	speed: 0.3848s/iter; left time: 3210.6314s
	iters: 200, epoch: 13 | loss: 0.0005358
	speed: 0.0912s/iter; left time: 752.1725s
	iters: 300, epoch: 13 | loss: 0.0010209
	speed: 0.1038s/iter; left time: 844.9873s
	iters: 400, epoch: 13 | loss: 0.0004629
	speed: 0.1114s/iter; left time: 895.6429s
Epoch: 13 cost time: 47.90685200691223
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0020138
	speed: 0.3802s/iter; left time: 2993.8116s
	iters: 200, epoch: 14 | loss: 0.0617760
	speed: 0.0871s/iter; left time: 677.2213s
	iters: 300, epoch: 14 | loss: 0.0007540
	speed: 0.0950s/iter; left time: 729.4056s
	iters: 400, epoch: 14 | loss: 0.0010202
	speed: 0.1083s/iter; left time: 820.0584s
Epoch: 14 cost time: 45.86862874031067
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0012924
	speed: 0.3921s/iter; left time: 2903.2806s
	iters: 200, epoch: 15 | loss: 0.0790479
	speed: 0.0961s/iter; left time: 702.0596s
	iters: 300, epoch: 15 | loss: 0.0030270
	speed: 0.0920s/iter; left time: 662.5903s
	iters: 400, epoch: 15 | loss: 0.2650036
	speed: 0.1102s/iter; left time: 783.2722s
Epoch: 15 cost time: 47.56390976905823
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0070095
	speed: 0.4018s/iter; left time: 2786.9978s
	iters: 200, epoch: 16 | loss: 0.0011031
	speed: 0.0971s/iter; left time: 663.9431s
	iters: 300, epoch: 16 | loss: 0.5857369
	speed: 0.1697s/iter; left time: 1143.1325s
	iters: 400, epoch: 16 | loss: 0.0003965
	speed: 0.1853s/iter; left time: 1229.7962s
Epoch: 16 cost time: 67.74354124069214
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0005692
	speed: 0.7154s/iter; left time: 4626.5115s
	iters: 200, epoch: 17 | loss: 0.0007069
	speed: 0.1655s/iter; left time: 1053.4870s
	iters: 300, epoch: 17 | loss: 0.0039027
	speed: 0.1675s/iter; left time: 1049.6051s
	iters: 400, epoch: 17 | loss: 0.0025129
	speed: 0.1605s/iter; left time: 989.9153s
Epoch: 17 cost time: 78.60610914230347
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0032585
	speed: 0.7109s/iter; left time: 4264.2222s
	iters: 200, epoch: 18 | loss: 0.0030155
	speed: 0.1627s/iter; left time: 959.5339s
	iters: 300, epoch: 18 | loss: 0.0008904
	speed: 0.1577s/iter; left time: 914.2549s
	iters: 400, epoch: 18 | loss: 0.0018016
	speed: 0.1677s/iter; left time: 955.5391s
Epoch: 18 cost time: 77.87236666679382
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0005183
	speed: 0.7312s/iter; left time: 4042.8051s
	iters: 200, epoch: 19 | loss: 0.0002381
	speed: 0.1714s/iter; left time: 930.6217s
	iters: 300, epoch: 19 | loss: 0.0013182
	speed: 0.1691s/iter; left time: 901.1985s
	iters: 400, epoch: 19 | loss: 0.0008354
	speed: 0.1617s/iter; left time: 845.2803s
Epoch: 19 cost time: 80.29615950584412
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 2346314
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6052283
	speed: 0.1407s/iter; left time: 1965.7856s
	iters: 200, epoch: 1 | loss: 0.8128566
	speed: 0.1221s/iter; left time: 1693.8954s
	iters: 300, epoch: 1 | loss: 0.3068640
	speed: 0.1255s/iter; left time: 1727.8092s
	iters: 400, epoch: 1 | loss: 0.2342253
	speed: 0.1211s/iter; left time: 1655.4753s
Epoch: 1 cost time: 59.80606746673584
Epoch: 1, Steps: 469 | Train Loss: 0.917 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
Validation loss decreased (inf --> -0.948826).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1030234
	speed: 0.5432s/iter; left time: 7334.7910s
	iters: 200, epoch: 2 | loss: 0.1327851
	speed: 0.1324s/iter; left time: 1774.6856s
	iters: 300, epoch: 2 | loss: 0.0818868
	speed: 0.1326s/iter; left time: 1763.6876s
	iters: 400, epoch: 2 | loss: 0.1515288
	speed: 0.1305s/iter; left time: 1722.4535s
Epoch: 2 cost time: 61.59556007385254
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.948826 --> -0.974556).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1055172
	speed: 0.5111s/iter; left time: 6661.5159s
	iters: 200, epoch: 3 | loss: 0.2392421
	speed: 0.1160s/iter; left time: 1499.7571s
	iters: 300, epoch: 3 | loss: 0.0252792
	speed: 0.1324s/iter; left time: 1698.8555s
	iters: 400, epoch: 3 | loss: 0.0287941
	speed: 0.1322s/iter; left time: 1683.6597s
Epoch: 3 cost time: 59.41547966003418
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0033896
	speed: 0.5443s/iter; left time: 6838.4194s
	iters: 200, epoch: 4 | loss: 0.0050314
	speed: 0.1213s/iter; left time: 1511.7950s
	iters: 300, epoch: 4 | loss: 0.0214979
	speed: 0.1190s/iter; left time: 1471.8959s
	iters: 400, epoch: 4 | loss: 0.0210387
	speed: 0.1261s/iter; left time: 1547.0963s
Epoch: 4 cost time: 58.06061768531799
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.974556 --> -0.977701).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0532966
	speed: 0.5615s/iter; left time: 6791.4500s
	iters: 200, epoch: 5 | loss: 0.0044856
	speed: 0.1355s/iter; left time: 1624.9634s
	iters: 300, epoch: 5 | loss: 0.0033138
	speed: 0.1243s/iter; left time: 1479.0900s
	iters: 400, epoch: 5 | loss: 0.0137144
	speed: 0.1215s/iter; left time: 1432.7903s
Epoch: 5 cost time: 60.077208042144775
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0043995
	speed: 0.5041s/iter; left time: 5860.6985s
	iters: 200, epoch: 6 | loss: 0.0021114
	speed: 0.1321s/iter; left time: 1522.8768s
	iters: 300, epoch: 6 | loss: 0.0017767
	speed: 0.1283s/iter; left time: 1465.5984s
	iters: 400, epoch: 6 | loss: 0.0091397
	speed: 0.1318s/iter; left time: 1492.8420s
Epoch: 6 cost time: 61.188650369644165
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0030645
	speed: 0.5375s/iter; left time: 5997.2793s
	iters: 200, epoch: 7 | loss: 0.0023896
	speed: 0.1285s/iter; left time: 1421.1669s
	iters: 300, epoch: 7 | loss: 0.0158275
	speed: 0.1244s/iter; left time: 1363.5145s
	iters: 400, epoch: 7 | loss: 0.0643138
	speed: 0.1272s/iter; left time: 1380.4895s
Epoch: 7 cost time: 60.25387167930603
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0043179
	speed: 0.5685s/iter; left time: 6076.0492s
	iters: 200, epoch: 8 | loss: 0.0029688
	speed: 0.1242s/iter; left time: 1315.0383s
	iters: 300, epoch: 8 | loss: 0.0025429
	speed: 0.1240s/iter; left time: 1300.4114s
	iters: 400, epoch: 8 | loss: 0.0017450
	speed: 0.1192s/iter; left time: 1237.8829s
Epoch: 8 cost time: 58.645631074905396
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.977701 --> -0.980560).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0043496
	speed: 0.5262s/iter; left time: 5377.3005s
	iters: 200, epoch: 9 | loss: 0.0022797
	speed: 0.1355s/iter; left time: 1371.3902s
	iters: 300, epoch: 9 | loss: 0.0085373
	speed: 0.1342s/iter; left time: 1344.2125s
	iters: 400, epoch: 9 | loss: 0.0382809
	speed: 0.1354s/iter; left time: 1342.8863s
Epoch: 9 cost time: 63.179463624954224
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1439278
	speed: 0.5278s/iter; left time: 5145.9465s
	iters: 200, epoch: 10 | loss: 0.0023932
	speed: 0.1261s/iter; left time: 1216.5568s
	iters: 300, epoch: 10 | loss: 0.1110407
	speed: 0.1338s/iter; left time: 1277.3337s
	iters: 400, epoch: 10 | loss: 0.0028095
	speed: 0.1296s/iter; left time: 1224.3165s
Epoch: 10 cost time: 60.95061421394348
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0808907
	speed: 0.5434s/iter; left time: 5043.4513s
	iters: 200, epoch: 11 | loss: 0.0007816
	speed: 0.1215s/iter; left time: 1115.2750s
	iters: 300, epoch: 11 | loss: 0.0016111
	speed: 0.1212s/iter; left time: 1100.1781s
	iters: 400, epoch: 11 | loss: 0.0007632
	speed: 0.1282s/iter; left time: 1151.0381s
Epoch: 11 cost time: 56.417938232421875
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.980560 --> -0.984848).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0047553
	speed: 0.5330s/iter; left time: 4696.7933s
	iters: 200, epoch: 12 | loss: 0.0008631
	speed: 0.1329s/iter; left time: 1157.9330s
	iters: 300, epoch: 12 | loss: 0.0036110
	speed: 0.1341s/iter; left time: 1154.8021s
	iters: 400, epoch: 12 | loss: 0.0130496
	speed: 0.1250s/iter; left time: 1063.6310s
Epoch: 12 cost time: 61.84311890602112
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0016141
	speed: 0.5237s/iter; left time: 4369.3500s
	iters: 200, epoch: 13 | loss: 0.0011960
	speed: 0.1253s/iter; left time: 1033.0414s
	iters: 300, epoch: 13 | loss: 0.0352211
	speed: 0.1331s/iter; left time: 1083.9926s
	iters: 400, epoch: 13 | loss: 0.0073122
	speed: 0.1320s/iter; left time: 1061.4959s
Epoch: 13 cost time: 60.739705085754395
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0007914
	speed: 0.5353s/iter; left time: 4214.8204s
	iters: 200, epoch: 14 | loss: 0.0008438
	speed: 0.1188s/iter; left time: 923.6413s
	iters: 300, epoch: 14 | loss: 0.0025066
	speed: 0.1247s/iter; left time: 957.0255s
	iters: 400, epoch: 14 | loss: 0.0035031
	speed: 0.1266s/iter; left time: 958.7531s
Epoch: 14 cost time: 58.14529061317444
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0010264
	speed: 0.4845s/iter; left time: 3587.8959s
	iters: 200, epoch: 15 | loss: 0.0008234
	speed: 0.1281s/iter; left time: 935.6457s
	iters: 300, epoch: 15 | loss: 0.0087466
	speed: 0.1283s/iter; left time: 924.1580s
	iters: 400, epoch: 15 | loss: 0.0018604
	speed: 0.1254s/iter; left time: 890.9767s
Epoch: 15 cost time: 56.891061782836914
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0288288
	speed: 0.4893s/iter; left time: 3393.9216s
	iters: 200, epoch: 16 | loss: 0.0005137
	speed: 0.1226s/iter; left time: 838.1330s
	iters: 300, epoch: 16 | loss: 0.0005316
	speed: 0.1169s/iter; left time: 787.5149s
	iters: 400, epoch: 16 | loss: 0.0012021
	speed: 0.1114s/iter; left time: 739.3005s
Epoch: 16 cost time: 55.694636821746826
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0004603
	speed: 0.4910s/iter; left time: 3175.6036s
	iters: 200, epoch: 17 | loss: 0.0016681
	speed: 0.1274s/iter; left time: 810.9449s
	iters: 300, epoch: 17 | loss: 0.0004028
	speed: 0.1159s/iter; left time: 726.3751s
	iters: 400, epoch: 17 | loss: 0.0010081
	speed: 0.1124s/iter; left time: 693.2711s
Epoch: 17 cost time: 56.84877896308899
Epoch: 17, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0007915
	speed: 0.5185s/iter; left time: 3110.0018s
	iters: 200, epoch: 18 | loss: 0.0001624
	speed: 0.1121s/iter; left time: 661.3208s
	iters: 300, epoch: 18 | loss: 0.0007607
	speed: 0.1163s/iter; left time: 674.3678s
	iters: 400, epoch: 18 | loss: 0.0019368
	speed: 0.1151s/iter; left time: 655.9466s
Epoch: 18 cost time: 55.25714731216431
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0006714
	speed: 0.5046s/iter; left time: 2790.0778s
	iters: 200, epoch: 19 | loss: 0.0006168
	speed: 0.1154s/iter; left time: 626.6088s
	iters: 300, epoch: 19 | loss: 0.0007906
	speed: 0.1156s/iter; left time: 616.1811s
	iters: 400, epoch: 19 | loss: 0.0015138
	speed: 0.1297s/iter; left time: 678.0425s
Epoch: 19 cost time: 56.54126691818237
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0011263
	speed: 0.5000s/iter; left time: 2529.8324s
	iters: 200, epoch: 20 | loss: 0.0117259
	speed: 0.1161s/iter; left time: 575.7638s
	iters: 300, epoch: 20 | loss: 0.0017683
	speed: 0.1298s/iter; left time: 630.6483s
	iters: 400, epoch: 20 | loss: 0.0017243
	speed: 0.1267s/iter; left time: 602.8587s
Epoch: 20 cost time: 57.630090951919556
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0023187
	speed: 0.4744s/iter; left time: 2178.0310s
	iters: 200, epoch: 21 | loss: 0.1325288
	speed: 0.1252s/iter; left time: 562.4167s
	iters: 300, epoch: 21 | loss: 0.0013795
	speed: 0.1253s/iter; left time: 550.0753s
	iters: 400, epoch: 21 | loss: 0.0006898
	speed: 0.1164s/iter; left time: 499.6111s
Epoch: 21 cost time: 56.01141905784607
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 690890
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5789999
	speed: 0.1541s/iter; left time: 2152.6405s
	iters: 200, epoch: 1 | loss: 0.5754642
	speed: 0.1275s/iter; left time: 1767.9669s
	iters: 300, epoch: 1 | loss: 0.6927478
	speed: 0.1254s/iter; left time: 1726.5779s
	iters: 400, epoch: 1 | loss: 0.2172543
	speed: 0.1318s/iter; left time: 1801.9621s
Epoch: 1 cost time: 63.695128202438354
Epoch: 1, Steps: 469 | Train Loss: 0.883 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
Validation loss decreased (inf --> -0.937676).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1810323
	speed: 0.5214s/iter; left time: 7040.4472s
	iters: 200, epoch: 2 | loss: 0.2237686
	speed: 0.1181s/iter; left time: 1583.3687s
	iters: 300, epoch: 2 | loss: 0.0805016
	speed: 0.1301s/iter; left time: 1729.9425s
	iters: 400, epoch: 2 | loss: 0.0344715
	speed: 0.1403s/iter; left time: 1852.8507s
Epoch: 2 cost time: 60.718361377716064
Epoch: 2, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (-0.937676 --> -0.963692).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0091114
	speed: 0.4916s/iter; left time: 6407.2501s
	iters: 200, epoch: 3 | loss: 0.0161048
	speed: 0.1339s/iter; left time: 1732.1462s
	iters: 300, epoch: 3 | loss: 0.0410703
	speed: 0.1454s/iter; left time: 1865.6060s
	iters: 400, epoch: 3 | loss: 0.0264260
	speed: 0.1418s/iter; left time: 1805.6025s
Epoch: 3 cost time: 63.57377886772156
Epoch: 3, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
Validation loss decreased (-0.963692 --> -0.969124).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0106975
	speed: 0.5002s/iter; left time: 6283.9545s
	iters: 200, epoch: 4 | loss: 0.0246620
	speed: 0.1393s/iter; left time: 1735.9684s
	iters: 300, epoch: 4 | loss: 0.0969776
	speed: 0.1390s/iter; left time: 1718.5656s
	iters: 400, epoch: 4 | loss: 0.0206130
	speed: 0.1248s/iter; left time: 1530.4239s
Epoch: 4 cost time: 62.08428072929382
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0172007
	speed: 0.5127s/iter; left time: 6201.2615s
	iters: 200, epoch: 5 | loss: 0.0509712
	speed: 0.1380s/iter; left time: 1655.0004s
	iters: 300, epoch: 5 | loss: 0.0140230
	speed: 0.1288s/iter; left time: 1532.0085s
	iters: 400, epoch: 5 | loss: 0.0094348
	speed: 0.1262s/iter; left time: 1488.8031s
Epoch: 5 cost time: 62.68712615966797
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0027698
	speed: 0.5437s/iter; left time: 6321.2153s
	iters: 200, epoch: 6 | loss: 0.0043557
	speed: 0.1305s/iter; left time: 1504.2580s
	iters: 300, epoch: 6 | loss: 0.0066663
	speed: 0.1242s/iter; left time: 1419.6323s
	iters: 400, epoch: 6 | loss: 0.0185499
	speed: 0.1228s/iter; left time: 1390.9671s
Epoch: 6 cost time: 60.45869493484497
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0116511
	speed: 0.4799s/iter; left time: 5354.3461s
	iters: 200, epoch: 7 | loss: 0.0036628
	speed: 0.1464s/iter; left time: 1618.2390s
	iters: 300, epoch: 7 | loss: 0.0658838
	speed: 0.1468s/iter; left time: 1608.4426s
	iters: 400, epoch: 7 | loss: 0.0122124
	speed: 0.1132s/iter; left time: 1228.8733s
Epoch: 7 cost time: 65.10741424560547
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.969124 --> -0.982847).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0357449
	speed: 0.5546s/iter; left time: 5927.9557s
	iters: 200, epoch: 8 | loss: 0.0026452
	speed: 0.1522s/iter; left time: 1611.6022s
	iters: 300, epoch: 8 | loss: 0.0086906
	speed: 0.1511s/iter; left time: 1585.1707s
	iters: 400, epoch: 8 | loss: 0.0055820
	speed: 0.1377s/iter; left time: 1430.0257s
Epoch: 8 cost time: 69.25432252883911
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0012585
	speed: 0.5387s/iter; left time: 5505.1631s
	iters: 200, epoch: 9 | loss: 0.0025914
	speed: 0.1485s/iter; left time: 1502.5977s
	iters: 300, epoch: 9 | loss: 0.0016420
	speed: 0.1453s/iter; left time: 1455.4448s
	iters: 400, epoch: 9 | loss: 0.0036953
	speed: 0.1355s/iter; left time: 1344.4632s
Epoch: 9 cost time: 66.69080638885498
Epoch: 9, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0008421
	speed: 0.5212s/iter; left time: 5081.9479s
	iters: 200, epoch: 10 | loss: 0.0122876
	speed: 0.1487s/iter; left time: 1434.5675s
	iters: 300, epoch: 10 | loss: 0.1811808
	speed: 0.1506s/iter; left time: 1438.3267s
	iters: 400, epoch: 10 | loss: 0.0073643
	speed: 0.1479s/iter; left time: 1398.0440s
Epoch: 10 cost time: 68.6727123260498
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0030655
	speed: 0.5428s/iter; left time: 5037.5588s
	iters: 200, epoch: 11 | loss: 0.0514007
	speed: 0.1516s/iter; left time: 1391.7943s
	iters: 300, epoch: 11 | loss: 0.0023125
	speed: 0.1506s/iter; left time: 1367.4748s
	iters: 400, epoch: 11 | loss: 0.0459244
	speed: 0.1460s/iter; left time: 1311.0977s
Epoch: 11 cost time: 68.79390215873718
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0017977
	speed: 0.5156s/iter; left time: 4543.6239s
	iters: 200, epoch: 12 | loss: 0.0012376
	speed: 0.1471s/iter; left time: 1281.7855s
	iters: 300, epoch: 12 | loss: 0.1639634
	speed: 0.1457s/iter; left time: 1254.4886s
	iters: 400, epoch: 12 | loss: 0.0044751
	speed: 0.1495s/iter; left time: 1272.1235s
Epoch: 12 cost time: 67.67582392692566
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0004098
	speed: 0.5367s/iter; left time: 4477.4555s
	iters: 200, epoch: 13 | loss: 0.0008345
	speed: 0.1510s/iter; left time: 1244.8066s
	iters: 300, epoch: 13 | loss: 0.0035380
	speed: 0.1497s/iter; left time: 1219.3410s
	iters: 400, epoch: 13 | loss: 0.0039502
	speed: 0.1517s/iter; left time: 1220.0589s
Epoch: 13 cost time: 69.4082043170929
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0005309
	speed: 0.5290s/iter; left time: 4165.2711s
	iters: 200, epoch: 14 | loss: 0.5155021
	speed: 0.1454s/iter; left time: 1130.6604s
	iters: 300, epoch: 14 | loss: 0.0027711
	speed: 0.1423s/iter; left time: 1091.9293s
	iters: 400, epoch: 14 | loss: 0.0007633
	speed: 0.1479s/iter; left time: 1120.2596s
Epoch: 14 cost time: 67.21315908432007
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1209082
	speed: 0.5329s/iter; left time: 3946.1615s
	iters: 200, epoch: 15 | loss: 0.0145636
	speed: 0.1414s/iter; left time: 1032.7860s
	iters: 300, epoch: 15 | loss: 0.0040188
	speed: 0.1489s/iter; left time: 1072.8996s
	iters: 400, epoch: 15 | loss: 0.0064493
	speed: 0.1502s/iter; left time: 1067.4696s
Epoch: 15 cost time: 67.92974495887756
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.982847 --> -0.983704).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0096349
	speed: 0.5413s/iter; left time: 3754.3386s
	iters: 200, epoch: 16 | loss: 0.0008346
	speed: 0.1344s/iter; left time: 918.9689s
	iters: 300, epoch: 16 | loss: 0.0016630
	speed: 0.1473s/iter; left time: 992.1696s
	iters: 400, epoch: 16 | loss: 0.0003755
	speed: 0.1497s/iter; left time: 993.1707s
Epoch: 16 cost time: 67.30949330329895
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0171045
	speed: 0.5360s/iter; left time: 3466.0845s
	iters: 200, epoch: 17 | loss: 0.0017045
	speed: 0.1322s/iter; left time: 841.8740s
	iters: 300, epoch: 17 | loss: 0.0026974
	speed: 0.1549s/iter; left time: 970.4517s
	iters: 400, epoch: 17 | loss: 0.0056469
	speed: 0.1561s/iter; left time: 962.5153s
Epoch: 17 cost time: 68.57762336730957
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0046951
	speed: 0.5597s/iter; left time: 3357.0003s
	iters: 200, epoch: 18 | loss: 0.0965618
	speed: 0.1371s/iter; left time: 808.5273s
	iters: 300, epoch: 18 | loss: 0.0003518
	speed: 0.1426s/iter; left time: 827.0182s
	iters: 400, epoch: 18 | loss: 0.0011055
	speed: 0.1510s/iter; left time: 860.6702s
Epoch: 18 cost time: 67.54220604896545
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0015661
	speed: 0.5393s/iter; left time: 2981.6541s
	iters: 200, epoch: 19 | loss: 0.0008334
	speed: 0.1336s/iter; left time: 725.3366s
	iters: 300, epoch: 19 | loss: 0.0982135
	speed: 0.1352s/iter; left time: 720.5527s
	iters: 400, epoch: 19 | loss: 0.0006181
	speed: 0.1499s/iter; left time: 783.8220s
Epoch: 19 cost time: 64.94887065887451
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0220988
	speed: 0.5655s/iter; left time: 2861.2268s
	iters: 200, epoch: 20 | loss: 0.0003476
	speed: 0.1333s/iter; left time: 661.0272s
	iters: 300, epoch: 20 | loss: 0.0003516
	speed: 0.1387s/iter; left time: 674.1189s
	iters: 400, epoch: 20 | loss: 0.0009752
	speed: 0.1475s/iter; left time: 702.2679s
Epoch: 20 cost time: 66.51138758659363
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0007310
	speed: 0.5755s/iter; left time: 2642.0310s
	iters: 200, epoch: 21 | loss: 0.0051248
	speed: 0.1299s/iter; left time: 583.3077s
	iters: 300, epoch: 21 | loss: 0.1551098
	speed: 0.1330s/iter; left time: 584.0045s
	iters: 400, epoch: 21 | loss: 0.0010253
	speed: 0.1260s/iter; left time: 540.7990s
Epoch: 21 cost time: 61.79943251609802
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0003127
	speed: 0.4724s/iter; left time: 1947.1326s
	iters: 200, epoch: 22 | loss: 0.0009562
	speed: 0.1300s/iter; left time: 522.7365s
	iters: 300, epoch: 22 | loss: 0.0005997
	speed: 0.1258s/iter; left time: 493.2381s
	iters: 400, epoch: 22 | loss: 0.0010667
	speed: 0.1207s/iter; left time: 461.2659s
Epoch: 22 cost time: 59.84877061843872
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0005844
	speed: 0.5102s/iter; left time: 1863.7232s
	iters: 200, epoch: 23 | loss: 0.0028144
	speed: 0.1259s/iter; left time: 447.3550s
	iters: 300, epoch: 23 | loss: 0.0005838
	speed: 0.1338s/iter; left time: 461.9396s
	iters: 400, epoch: 23 | loss: 0.0003838
	speed: 0.1325s/iter; left time: 444.3388s
Epoch: 23 cost time: 60.23709774017334
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0044105
	speed: 0.4835s/iter; left time: 1539.4964s
	iters: 200, epoch: 24 | loss: 0.0065637
	speed: 0.1243s/iter; left time: 383.3183s
	iters: 300, epoch: 24 | loss: 0.0017440
	speed: 0.1204s/iter; left time: 359.2857s
	iters: 400, epoch: 24 | loss: 0.0003835
	speed: 0.1238s/iter; left time: 357.1735s
Epoch: 24 cost time: 59.552000522613525
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
Validation loss decreased (-0.983704 --> -0.988278).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0008284
	speed: 0.5099s/iter; left time: 1384.3173s
	iters: 200, epoch: 25 | loss: 0.0049137
	speed: 0.1241s/iter; left time: 324.4487s
	iters: 300, epoch: 25 | loss: 0.0004396
	speed: 0.1376s/iter; left time: 346.1124s
	iters: 400, epoch: 25 | loss: 0.0225017
	speed: 0.1372s/iter; left time: 331.4453s
Epoch: 25 cost time: 60.95836853981018
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0157314
	speed: 0.4860s/iter; left time: 1091.6393s
	iters: 200, epoch: 26 | loss: 0.0006689
	speed: 0.1237s/iter; left time: 265.4844s
	iters: 300, epoch: 26 | loss: 0.0008520
	speed: 0.1201s/iter; left time: 245.7789s
	iters: 400, epoch: 26 | loss: 0.0006192
	speed: 0.1170s/iter; left time: 227.7772s
Epoch: 26 cost time: 57.40631318092346
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0539261
	speed: 0.5017s/iter; left time: 891.5761s
	iters: 200, epoch: 27 | loss: 0.0016709
	speed: 0.1237s/iter; left time: 207.4606s
	iters: 300, epoch: 27 | loss: 0.0028656
	speed: 0.1380s/iter; left time: 217.5590s
	iters: 400, epoch: 27 | loss: 0.0005687
	speed: 0.1359s/iter; left time: 200.7093s
Epoch: 27 cost time: 61.08457112312317
Epoch: 27, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0006761
	speed: 0.4938s/iter; left time: 645.9106s
	iters: 200, epoch: 28 | loss: 0.0272923
	speed: 0.1289s/iter; left time: 155.7113s
	iters: 300, epoch: 28 | loss: 0.0018857
	speed: 0.1209s/iter; left time: 133.9381s
	iters: 400, epoch: 28 | loss: 0.0006630
	speed: 0.1171s/iter; left time: 118.0027s
Epoch: 28 cost time: 58.95820713043213
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0005935
	speed: 0.4988s/iter; left time: 418.5344s
	iters: 200, epoch: 29 | loss: 0.0063396
	speed: 0.1271s/iter; left time: 93.9127s
	iters: 300, epoch: 29 | loss: 0.0334728
	speed: 0.1361s/iter; left time: 86.9995s
	iters: 400, epoch: 29 | loss: 0.3586726
	speed: 0.1379s/iter; left time: 74.3365s
Epoch: 29 cost time: 61.78100657463074
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0014235
	speed: 0.5069s/iter; left time: 187.5382s
	iters: 200, epoch: 30 | loss: 0.0004039
	speed: 0.1354s/iter; left time: 36.5648s
	iters: 300, epoch: 30 | loss: 0.0002312
	speed: 0.1223s/iter; left time: 20.7934s
	iters: 400, epoch: 30 | loss: 0.0030145
	speed: 0.1188s/iter; left time: 8.3153s
Epoch: 30 cost time: 60.49881911277771
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9882790165809033
model parameter : 2346314
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5984893
	speed: 0.1061s/iter; left time: 1481.8845s
	iters: 200, epoch: 1 | loss: 0.8519242
	speed: 0.0903s/iter; left time: 1252.7277s
	iters: 300, epoch: 1 | loss: 0.3163571
	speed: 0.0860s/iter; left time: 1184.3446s
	iters: 400, epoch: 1 | loss: 0.3747684
	speed: 0.1132s/iter; left time: 1547.2662s
Epoch: 1 cost time: 45.30900025367737
Epoch: 1, Steps: 469 | Train Loss: 0.927 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (inf --> -0.937390).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1331521
	speed: 0.3482s/iter; left time: 4701.2972s
	iters: 200, epoch: 2 | loss: 0.1138158
	speed: 0.1147s/iter; left time: 1536.5902s
	iters: 300, epoch: 2 | loss: 0.1266478
	speed: 0.1133s/iter; left time: 1506.8103s
	iters: 400, epoch: 2 | loss: 0.1585959
	speed: 0.0964s/iter; left time: 1272.6793s
Epoch: 2 cost time: 49.24551844596863
Epoch: 2, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
Validation loss decreased (-0.937390 --> -0.971983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1600458
	speed: 0.4281s/iter; left time: 5579.9131s
	iters: 200, epoch: 3 | loss: 0.0543604
	speed: 0.1137s/iter; left time: 1469.9638s
	iters: 300, epoch: 3 | loss: 0.0311641
	speed: 0.1014s/iter; left time: 1301.2933s
	iters: 400, epoch: 3 | loss: 0.0381065
	speed: 0.0941s/iter; left time: 1197.6553s
Epoch: 3 cost time: 49.11682057380676
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.973698).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0042295
	speed: 0.4395s/iter; left time: 5521.5091s
	iters: 200, epoch: 4 | loss: 0.0087310
	speed: 0.1003s/iter; left time: 1249.6865s
	iters: 300, epoch: 4 | loss: 0.0567645
	speed: 0.1036s/iter; left time: 1281.1057s
	iters: 400, epoch: 4 | loss: 0.0121401
	speed: 0.0991s/iter; left time: 1215.2033s
Epoch: 4 cost time: 48.6248242855072
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2603174
	speed: 0.4390s/iter; left time: 5309.6927s
	iters: 200, epoch: 5 | loss: 0.0028481
	speed: 0.0967s/iter; left time: 1159.3910s
	iters: 300, epoch: 5 | loss: 0.0030650
	speed: 0.0981s/iter; left time: 1167.3103s
	iters: 400, epoch: 5 | loss: 0.0275208
	speed: 0.1102s/iter; left time: 1299.6386s
Epoch: 5 cost time: 48.21544027328491
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.973698 --> -0.977701).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0050370
	speed: 0.4185s/iter; left time: 4865.5791s
	iters: 200, epoch: 6 | loss: 0.0094054
	speed: 0.1067s/iter; left time: 1230.1090s
	iters: 300, epoch: 6 | loss: 0.0027242
	speed: 0.1127s/iter; left time: 1287.4663s
	iters: 400, epoch: 6 | loss: 0.0062704
	speed: 0.1108s/iter; left time: 1254.7866s
Epoch: 6 cost time: 49.32951903343201
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0041862
	speed: 0.4146s/iter; left time: 4625.8498s
	iters: 200, epoch: 7 | loss: 0.0037302
	speed: 0.1067s/iter; left time: 1180.1382s
	iters: 300, epoch: 7 | loss: 0.0038124
	speed: 0.1019s/iter; left time: 1116.7815s
	iters: 400, epoch: 7 | loss: 0.0238727
	speed: 0.0964s/iter; left time: 1046.1694s
Epoch: 7 cost time: 48.04615926742554
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0054507
	speed: 0.4328s/iter; left time: 4625.7888s
	iters: 200, epoch: 8 | loss: 0.0024406
	speed: 0.0916s/iter; left time: 969.5600s
	iters: 300, epoch: 8 | loss: 0.0500326
	speed: 0.0979s/iter; left time: 1027.0693s
	iters: 400, epoch: 8 | loss: 0.0082263
	speed: 0.0986s/iter; left time: 1024.2120s
Epoch: 8 cost time: 46.94061470031738
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.977701 --> -0.984848).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0142551
	speed: 0.4352s/iter; left time: 4446.9569s
	iters: 200, epoch: 9 | loss: 0.0004304
	speed: 0.0924s/iter; left time: 935.4632s
	iters: 300, epoch: 9 | loss: 0.0183922
	speed: 0.1048s/iter; left time: 1050.2222s
	iters: 400, epoch: 9 | loss: 0.0456810
	speed: 0.1106s/iter; left time: 1097.3642s
Epoch: 9 cost time: 47.61546087265015
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2320249
	speed: 0.4119s/iter; left time: 4015.9253s
	iters: 200, epoch: 10 | loss: 0.0028295
	speed: 0.1054s/iter; left time: 1017.2740s
	iters: 300, epoch: 10 | loss: 0.1960929
	speed: 0.1055s/iter; left time: 1007.3234s
	iters: 400, epoch: 10 | loss: 0.0053656
	speed: 0.0954s/iter; left time: 901.7397s
Epoch: 10 cost time: 47.30117917060852
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0008910
	speed: 0.4378s/iter; left time: 4063.0944s
	iters: 200, epoch: 11 | loss: 0.0006890
	speed: 0.0938s/iter; left time: 860.7261s
	iters: 300, epoch: 11 | loss: 0.0043718
	speed: 0.0891s/iter; left time: 809.1393s
	iters: 400, epoch: 11 | loss: 0.0008495
	speed: 0.0945s/iter; left time: 848.8121s
Epoch: 11 cost time: 45.18024039268494
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0008712
	speed: 0.4413s/iter; left time: 3888.4954s
	iters: 200, epoch: 12 | loss: 0.0009068
	speed: 0.0864s/iter; left time: 752.9682s
	iters: 300, epoch: 12 | loss: 0.0006911
	speed: 0.0924s/iter; left time: 795.7015s
	iters: 400, epoch: 12 | loss: 0.0161475
	speed: 0.1053s/iter; left time: 896.5637s
Epoch: 12 cost time: 45.368515968322754
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0015349
	speed: 0.4249s/iter; left time: 3545.1915s
	iters: 200, epoch: 13 | loss: 0.0004665
	speed: 0.0988s/iter; left time: 814.0913s
	iters: 300, epoch: 13 | loss: 0.0543156
	speed: 0.1003s/iter; left time: 816.6680s
	iters: 400, epoch: 13 | loss: 0.0023304
	speed: 0.0954s/iter; left time: 767.1043s
Epoch: 13 cost time: 45.720667362213135
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0021664
	speed: 0.4308s/iter; left time: 3391.8811s
	iters: 200, epoch: 14 | loss: 0.0011190
	speed: 0.1039s/iter; left time: 807.4833s
	iters: 300, epoch: 14 | loss: 0.0073186
	speed: 0.0861s/iter; left time: 660.8319s
	iters: 400, epoch: 14 | loss: 0.0078433
	speed: 0.0915s/iter; left time: 693.3446s
Epoch: 14 cost time: 45.056936502456665
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0070416
	speed: 0.3094s/iter; left time: 2291.4028s
	iters: 200, epoch: 15 | loss: 0.0006804
	speed: 0.1046s/iter; left time: 764.0202s
	iters: 300, epoch: 15 | loss: 0.0040429
	speed: 0.1040s/iter; left time: 749.6747s
	iters: 400, epoch: 15 | loss: 0.0021230
	speed: 0.1127s/iter; left time: 800.7259s
Epoch: 15 cost time: 46.68853735923767
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0107106
	speed: 0.4450s/iter; left time: 3086.4108s
	iters: 200, epoch: 16 | loss: 0.0006117
	speed: 0.0999s/iter; left time: 683.0153s
	iters: 300, epoch: 16 | loss: 0.0005910
	speed: 0.1054s/iter; left time: 709.9036s
	iters: 400, epoch: 16 | loss: 0.0012138
	speed: 0.1075s/iter; left time: 713.2255s
Epoch: 16 cost time: 47.88018321990967
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0006547
	speed: 0.4121s/iter; left time: 2665.0573s
	iters: 200, epoch: 17 | loss: 0.0006121
	speed: 0.1088s/iter; left time: 692.6385s
	iters: 300, epoch: 17 | loss: 0.0003956
	speed: 0.1039s/iter; left time: 651.1739s
	iters: 400, epoch: 17 | loss: 0.0011499
	speed: 0.0977s/iter; left time: 602.2273s
Epoch: 17 cost time: 49.159217834472656
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0003088
	speed: 0.4566s/iter; left time: 2738.5943s
	iters: 200, epoch: 18 | loss: 0.0001757
	speed: 0.0979s/iter; left time: 577.3535s
	iters: 300, epoch: 18 | loss: 0.0005104
	speed: 0.0953s/iter; left time: 552.4743s
	iters: 400, epoch: 18 | loss: 0.0023553
	speed: 0.0944s/iter; left time: 537.8892s
Epoch: 18 cost time: 47.188501834869385
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 690890
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6743129
	speed: 0.1545s/iter; left time: 2157.9106s
	iters: 200, epoch: 1 | loss: 0.8171852
	speed: 0.1378s/iter; left time: 1910.7413s
	iters: 300, epoch: 1 | loss: 0.7597175
	speed: 0.1220s/iter; left time: 1679.7309s
	iters: 400, epoch: 1 | loss: 0.3460741
	speed: 0.1194s/iter; left time: 1632.6528s
Epoch: 1 cost time: 61.42896628379822
Epoch: 1, Steps: 469 | Train Loss: 1.009 Vali Loss: 0.319 Vali Acc: 0.916 Test Loss: 0.319 Test Acc: 0.916
Validation loss decreased (inf --> -0.916235).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3380603
	speed: 0.4570s/iter; left time: 6170.1299s
	iters: 200, epoch: 2 | loss: 0.2517586
	speed: 0.1080s/iter; left time: 1446.7964s
	iters: 300, epoch: 2 | loss: 0.0970411
	speed: 0.1193s/iter; left time: 1586.8077s
	iters: 400, epoch: 2 | loss: 0.0561984
	speed: 0.1369s/iter; left time: 1807.1293s
Epoch: 2 cost time: 56.80336904525757
Epoch: 2, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.916235 --> -0.965122).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0137825
	speed: 0.4804s/iter; left time: 6260.4362s
	iters: 200, epoch: 3 | loss: 0.0312834
	speed: 0.1408s/iter; left time: 1820.3917s
	iters: 300, epoch: 3 | loss: 0.0815562
	speed: 0.1141s/iter; left time: 1463.6671s
	iters: 400, epoch: 3 | loss: 0.0153031
	speed: 0.1118s/iter; left time: 1424.0220s
Epoch: 3 cost time: 57.84357786178589
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0080773
	speed: 0.4666s/iter; left time: 5862.4442s
	iters: 200, epoch: 4 | loss: 0.0691682
	speed: 0.1226s/iter; left time: 1527.6924s
	iters: 300, epoch: 4 | loss: 0.1909582
	speed: 0.1204s/iter; left time: 1488.0209s
	iters: 400, epoch: 4 | loss: 0.0304863
	speed: 0.1166s/iter; left time: 1429.6880s
Epoch: 4 cost time: 54.76312708854675
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
Validation loss decreased (-0.965122 --> -0.966837).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0118667
	speed: 0.4282s/iter; left time: 5179.6583s
	iters: 200, epoch: 5 | loss: 0.1111203
	speed: 0.1038s/iter; left time: 1245.4322s
	iters: 300, epoch: 5 | loss: 0.0140378
	speed: 0.1115s/iter; left time: 1325.9874s
	iters: 400, epoch: 5 | loss: 0.0117487
	speed: 0.1186s/iter; left time: 1399.0459s
Epoch: 5 cost time: 50.715606689453125
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0029747
	speed: 0.4208s/iter; left time: 4892.3877s
	iters: 200, epoch: 6 | loss: 0.0075194
	speed: 0.1141s/iter; left time: 1314.8198s
	iters: 300, epoch: 6 | loss: 0.0087664
	speed: 0.1135s/iter; left time: 1296.6894s
	iters: 400, epoch: 6 | loss: 0.0585826
	speed: 0.1270s/iter; left time: 1437.9260s
Epoch: 6 cost time: 57.81985378265381
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0058806
	speed: 0.4327s/iter; left time: 4827.6786s
	iters: 200, epoch: 7 | loss: 0.0040424
	speed: 0.1232s/iter; left time: 1362.2095s
	iters: 300, epoch: 7 | loss: 0.0040385
	speed: 0.0943s/iter; left time: 1032.7041s
	iters: 400, epoch: 7 | loss: 0.0159019
	speed: 0.0973s/iter; left time: 1056.2229s
Epoch: 7 cost time: 51.473750829696655
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.054 Vali Acc: 0.984 Test Loss: 0.054 Test Acc: 0.984
Validation loss decreased (-0.969124 --> -0.984276).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1587667
	speed: 0.4496s/iter; left time: 4805.7129s
	iters: 200, epoch: 8 | loss: 0.0024463
	speed: 0.1214s/iter; left time: 1285.4716s
	iters: 300, epoch: 8 | loss: 0.0036282
	speed: 0.1270s/iter; left time: 1331.8137s
	iters: 400, epoch: 8 | loss: 0.0126684
	speed: 0.1018s/iter; left time: 1057.2299s
Epoch: 8 cost time: 53.3372642993927
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0011673
	speed: 0.4084s/iter; left time: 4173.7457s
	iters: 200, epoch: 9 | loss: 0.0047877
	speed: 0.1041s/iter; left time: 1053.6007s
	iters: 300, epoch: 9 | loss: 0.0023992
	speed: 0.1175s/iter; left time: 1176.9671s
	iters: 400, epoch: 9 | loss: 0.0042430
	speed: 0.1279s/iter; left time: 1268.8447s
Epoch: 9 cost time: 53.36508226394653
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0030758
	speed: 0.4429s/iter; left time: 4318.3336s
	iters: 200, epoch: 10 | loss: 0.0053610
	speed: 0.1024s/iter; left time: 988.1690s
	iters: 300, epoch: 10 | loss: 0.0036742
	speed: 0.1037s/iter; left time: 989.9638s
	iters: 400, epoch: 10 | loss: 0.0036035
	speed: 0.1080s/iter; left time: 1020.2416s
Epoch: 10 cost time: 52.53207325935364
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3385935
	speed: 0.4316s/iter; left time: 4005.4388s
	iters: 200, epoch: 11 | loss: 0.0022379
	speed: 0.1245s/iter; left time: 1142.7083s
	iters: 300, epoch: 11 | loss: 0.0018140
	speed: 0.1108s/iter; left time: 1005.7692s
	iters: 400, epoch: 11 | loss: 0.0030272
	speed: 0.1102s/iter; left time: 989.3375s
Epoch: 11 cost time: 55.22932052612305
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0011910
	speed: 0.4182s/iter; left time: 3685.4407s
	iters: 200, epoch: 12 | loss: 0.0475144
	speed: 0.1092s/iter; left time: 951.2839s
	iters: 300, epoch: 12 | loss: 0.0127739
	speed: 0.1189s/iter; left time: 1023.5862s
	iters: 400, epoch: 12 | loss: 0.0024745
	speed: 0.1031s/iter; left time: 877.1821s
Epoch: 12 cost time: 50.758246421813965
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0006518
	speed: 0.4471s/iter; left time: 3729.7395s
	iters: 200, epoch: 13 | loss: 0.0008045
	speed: 0.1124s/iter; left time: 926.6640s
	iters: 300, epoch: 13 | loss: 0.0126466
	speed: 0.1114s/iter; left time: 906.7947s
	iters: 400, epoch: 13 | loss: 0.0006090
	speed: 0.1017s/iter; left time: 818.1298s
Epoch: 13 cost time: 50.426939487457275
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0588485
	speed: 0.5211s/iter; left time: 4103.1692s
	iters: 200, epoch: 14 | loss: 0.2988964
	speed: 0.1600s/iter; left time: 1243.5068s
	iters: 300, epoch: 14 | loss: 0.0068316
	speed: 0.1590s/iter; left time: 1219.7984s
	iters: 400, epoch: 14 | loss: 0.0010974
	speed: 0.1406s/iter; left time: 1065.0488s
Epoch: 14 cost time: 71.67624425888062
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0894514
	speed: 0.5376s/iter; left time: 3981.1444s
	iters: 200, epoch: 15 | loss: 0.0215162
	speed: 0.1518s/iter; left time: 1108.9232s
	iters: 300, epoch: 15 | loss: 0.1158119
	speed: 0.1528s/iter; left time: 1100.6302s
	iters: 400, epoch: 15 | loss: 0.0008561
	speed: 0.1492s/iter; left time: 1060.1192s
Epoch: 15 cost time: 71.33528208732605
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0051794
	speed: 0.5445s/iter; left time: 3776.7538s
	iters: 200, epoch: 16 | loss: 0.0018953
	speed: 0.1450s/iter; left time: 991.5125s
	iters: 300, epoch: 16 | loss: 0.0119338
	speed: 0.1480s/iter; left time: 996.7552s
	iters: 400, epoch: 16 | loss: 0.0001657
	speed: 0.1641s/iter; left time: 1088.6726s
Epoch: 16 cost time: 71.64051079750061
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0035561
	speed: 0.5908s/iter; left time: 3820.4772s
	iters: 200, epoch: 17 | loss: 0.0071570
	speed: 0.1277s/iter; left time: 812.7871s
	iters: 300, epoch: 17 | loss: 0.0037172
	speed: 0.1291s/iter; left time: 808.7670s
	iters: 400, epoch: 17 | loss: 0.0011877
	speed: 0.1284s/iter; left time: 791.9488s
Epoch: 17 cost time: 63.19453477859497
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 2346314
model size : 9.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7126858
	speed: 0.1413s/iter; left time: 1973.6310s
	iters: 200, epoch: 1 | loss: 1.0038601
	speed: 0.1248s/iter; left time: 1730.4714s
	iters: 300, epoch: 1 | loss: 0.7055748
	speed: 0.1086s/iter; left time: 1496.0752s
	iters: 400, epoch: 1 | loss: 0.3699253
	speed: 0.1059s/iter; left time: 1447.3891s
Epoch: 1 cost time: 55.395999908447266
Epoch: 1, Steps: 469 | Train Loss: 1.108 Vali Loss: 0.382 Vali Acc: 0.892 Test Loss: 0.382 Test Acc: 0.892
Validation loss decreased (inf --> -0.891934).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2469673
	speed: 0.4643s/iter; left time: 6268.5481s
	iters: 200, epoch: 2 | loss: 0.1653006
	speed: 0.1202s/iter; left time: 1610.7290s
	iters: 300, epoch: 2 | loss: 0.1589849
	speed: 0.1269s/iter; left time: 1687.3920s
	iters: 400, epoch: 2 | loss: 0.1939592
	speed: 0.1272s/iter; left time: 1678.9700s
Epoch: 2 cost time: 58.288748264312744
Epoch: 2, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.891934 --> -0.963120).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3384085
	speed: 0.5065s/iter; left time: 6600.8549s
	iters: 200, epoch: 3 | loss: 0.2262154
	speed: 0.1076s/iter; left time: 1391.8011s
	iters: 300, epoch: 3 | loss: 0.0566430
	speed: 0.1069s/iter; left time: 1371.3224s
	iters: 400, epoch: 3 | loss: 0.0271090
	speed: 0.1035s/iter; left time: 1317.7207s
Epoch: 3 cost time: 50.483392000198364
Epoch: 3, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.963120 --> -0.971411).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0051143
	speed: 0.5013s/iter; left time: 6297.7661s
	iters: 200, epoch: 4 | loss: 0.0076545
	speed: 0.1013s/iter; left time: 1263.0114s
	iters: 300, epoch: 4 | loss: 0.0974975
	speed: 0.1256s/iter; left time: 1553.0299s
	iters: 400, epoch: 4 | loss: 0.0253928
	speed: 0.1103s/iter; left time: 1352.3653s
Epoch: 4 cost time: 53.62384295463562
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.971411 --> -0.973698).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0390958
	speed: 0.4771s/iter; left time: 5770.9013s
	iters: 200, epoch: 5 | loss: 0.0050628
	speed: 0.1226s/iter; left time: 1470.8037s
	iters: 300, epoch: 5 | loss: 0.0101299
	speed: 0.1265s/iter; left time: 1504.6251s
	iters: 400, epoch: 5 | loss: 0.0393542
	speed: 0.1216s/iter; left time: 1434.0918s
Epoch: 5 cost time: 56.92424726486206
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0041569
	speed: 0.5018s/iter; left time: 5833.6279s
	iters: 200, epoch: 6 | loss: 0.0037332
	speed: 0.0928s/iter; left time: 1069.0901s
	iters: 300, epoch: 6 | loss: 0.0046291
	speed: 0.0968s/iter; left time: 1105.7128s
	iters: 400, epoch: 6 | loss: 0.0090850
	speed: 0.1090s/iter; left time: 1234.3387s
Epoch: 6 cost time: 48.20618271827698
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0162268
	speed: 0.5134s/iter; left time: 5728.1088s
	iters: 200, epoch: 7 | loss: 0.0024583
	speed: 0.1248s/iter; left time: 1380.3682s
	iters: 300, epoch: 7 | loss: 0.0071401
	speed: 0.1249s/iter; left time: 1368.2904s
	iters: 400, epoch: 7 | loss: 0.0384357
	speed: 0.1189s/iter; left time: 1291.3635s
Epoch: 7 cost time: 57.229464292526245
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975128).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0069032
	speed: 0.4552s/iter; left time: 4865.2172s
	iters: 200, epoch: 8 | loss: 0.0055272
	speed: 0.1071s/iter; left time: 1134.1663s
	iters: 300, epoch: 8 | loss: 0.0281544
	speed: 0.1127s/iter; left time: 1182.0115s
	iters: 400, epoch: 8 | loss: 0.0024469
	speed: 0.1274s/iter; left time: 1323.5382s
Epoch: 8 cost time: 54.36822462081909
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.975128 --> -0.980274).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0183736
	speed: 0.5472s/iter; left time: 5591.5023s
	iters: 200, epoch: 9 | loss: 0.0010440
	speed: 0.1139s/iter; left time: 1152.9173s
	iters: 300, epoch: 9 | loss: 0.0095105
	speed: 0.1118s/iter; left time: 1120.1444s
	iters: 400, epoch: 9 | loss: 0.0036695
	speed: 0.1036s/iter; left time: 1028.0802s
Epoch: 9 cost time: 52.9403510093689
Epoch: 9, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0401903
	speed: 0.4622s/iter; left time: 4506.1353s
	iters: 200, epoch: 10 | loss: 0.0447827
	speed: 0.1189s/iter; left time: 1146.9140s
	iters: 300, epoch: 10 | loss: 0.2592056
	speed: 0.1218s/iter; left time: 1163.3934s
	iters: 400, epoch: 10 | loss: 0.0987231
	speed: 0.1249s/iter; left time: 1180.2548s
Epoch: 10 cost time: 57.35890746116638
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0011512
	speed: 0.5044s/iter; left time: 4681.4023s
	iters: 200, epoch: 11 | loss: 0.0003793
	speed: 0.1103s/iter; left time: 1012.9093s
	iters: 300, epoch: 11 | loss: 0.0038935
	speed: 0.1132s/iter; left time: 1028.1822s
	iters: 400, epoch: 11 | loss: 0.0018968
	speed: 0.1085s/iter; left time: 974.0750s
Epoch: 11 cost time: 52.859275579452515
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0011154
	speed: 0.5174s/iter; left time: 4559.0037s
	iters: 200, epoch: 12 | loss: 0.0034391
	speed: 0.1223s/iter; left time: 1065.4348s
	iters: 300, epoch: 12 | loss: 0.0012121
	speed: 0.1236s/iter; left time: 1064.4095s
	iters: 400, epoch: 12 | loss: 0.0217174
	speed: 0.1095s/iter; left time: 931.6437s
Epoch: 12 cost time: 55.618690967559814
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0010257
	speed: 0.4738s/iter; left time: 3953.3130s
	iters: 200, epoch: 13 | loss: 0.0012077
	speed: 0.1177s/iter; left time: 970.4060s
	iters: 300, epoch: 13 | loss: 0.0032290
	speed: 0.1248s/iter; left time: 1016.0516s
	iters: 400, epoch: 13 | loss: 0.0097954
	speed: 0.1184s/iter; left time: 952.0069s
Epoch: 13 cost time: 55.673051595687866
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0192933
	speed: 0.4969s/iter; left time: 3912.3961s
	iters: 200, epoch: 14 | loss: 0.0032918
	speed: 0.1066s/iter; left time: 828.7827s
	iters: 300, epoch: 14 | loss: 0.0015850
	speed: 0.1057s/iter; left time: 811.4376s
	iters: 400, epoch: 14 | loss: 0.0162327
	speed: 0.1120s/iter; left time: 848.5217s
Epoch: 14 cost time: 50.99178600311279
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0620496
	speed: 0.5189s/iter; left time: 3842.3636s
	iters: 200, epoch: 15 | loss: 0.0007197
	speed: 0.1277s/iter; left time: 932.5438s
	iters: 300, epoch: 15 | loss: 0.0162228
	speed: 0.1272s/iter; left time: 916.2456s
	iters: 400, epoch: 15 | loss: 0.0113564
	speed: 0.1215s/iter; left time: 862.9590s
Epoch: 15 cost time: 58.46002006530762
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0974631
	speed: 0.4544s/iter; left time: 3151.8391s
	iters: 200, epoch: 16 | loss: 0.0022164
	speed: 0.1015s/iter; left time: 694.1002s
	iters: 300, epoch: 16 | loss: 0.0007597
	speed: 0.1087s/iter; left time: 732.0619s
	iters: 400, epoch: 16 | loss: 0.0004681
	speed: 0.1239s/iter; left time: 822.4505s
Epoch: 16 cost time: 52.5535352230072
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0002713
	speed: 0.5384s/iter; left time: 3481.6735s
	iters: 200, epoch: 17 | loss: 0.3245624
	speed: 0.1214s/iter; left time: 772.8028s
	iters: 300, epoch: 17 | loss: 0.0007490
	speed: 0.1123s/iter; left time: 703.7386s
	iters: 400, epoch: 17 | loss: 0.0014319
	speed: 0.1060s/iter; left time: 653.7570s
Epoch: 17 cost time: 54.03314542770386
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0036668
	speed: 0.4667s/iter; left time: 2799.3077s
	iters: 200, epoch: 18 | loss: 0.0005791
	speed: 0.1214s/iter; left time: 715.7301s
	iters: 300, epoch: 18 | loss: 0.0002292
	speed: 0.1066s/iter; left time: 618.1286s
	iters: 400, epoch: 18 | loss: 0.0021678
	speed: 0.1263s/iter; left time: 719.6902s
Epoch: 18 cost time: 56.30726194381714
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981989).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0022505
	speed: 0.5111s/iter; left time: 2825.9890s
	iters: 200, epoch: 19 | loss: 0.0007745
	speed: 0.1069s/iter; left time: 580.4835s
	iters: 300, epoch: 19 | loss: 0.0031622
	speed: 0.1091s/iter; left time: 581.6307s
	iters: 400, epoch: 19 | loss: 0.0013972
	speed: 0.1042s/iter; left time: 544.8790s
Epoch: 19 cost time: 50.42661142349243
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0004605
	speed: 0.4973s/iter; left time: 2516.4369s
	iters: 200, epoch: 20 | loss: 0.0040216
	speed: 0.1197s/iter; left time: 593.5954s
	iters: 300, epoch: 20 | loss: 0.0026082
	speed: 0.1198s/iter; left time: 582.1160s
	iters: 400, epoch: 20 | loss: 0.0004094
	speed: 0.1173s/iter; left time: 558.2766s
Epoch: 20 cost time: 55.57513070106506
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0007713
	speed: 0.4812s/iter; left time: 2209.2195s
	iters: 200, epoch: 21 | loss: 0.0160350
	speed: 0.1117s/iter; left time: 501.5966s
	iters: 300, epoch: 21 | loss: 0.0005281
	speed: 0.1241s/iter; left time: 545.1001s
	iters: 400, epoch: 21 | loss: 0.0010884
	speed: 0.1224s/iter; left time: 525.0901s
Epoch: 21 cost time: 55.729931354522705
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.981989 --> -0.981989).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0071378
	speed: 0.5193s/iter; left time: 2140.5046s
	iters: 200, epoch: 22 | loss: 0.0023237
	speed: 0.1055s/iter; left time: 424.4323s
	iters: 300, epoch: 22 | loss: 0.0383162
	speed: 0.1024s/iter; left time: 401.4574s
	iters: 400, epoch: 22 | loss: 0.0090533
	speed: 0.1079s/iter; left time: 412.3854s
Epoch: 22 cost time: 51.51604342460632
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0055772
	speed: 0.4967s/iter; left time: 1814.5939s
	iters: 200, epoch: 23 | loss: 0.0012798
	speed: 0.1241s/iter; left time: 441.1029s
	iters: 300, epoch: 23 | loss: 0.0081884
	speed: 0.1255s/iter; left time: 433.2609s
	iters: 400, epoch: 23 | loss: 0.0072089
	speed: 0.1194s/iter; left time: 400.3089s
Epoch: 23 cost time: 57.83053255081177
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000642
	speed: 0.4790s/iter; left time: 1525.1406s
	iters: 200, epoch: 24 | loss: 0.0003897
	speed: 0.1041s/iter; left time: 321.1882s
	iters: 300, epoch: 24 | loss: 0.0812639
	speed: 0.0892s/iter; left time: 266.0547s
	iters: 400, epoch: 24 | loss: 0.0008019
	speed: 0.1129s/iter; left time: 325.6348s
Epoch: 24 cost time: 50.05066633224487
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0017570
	speed: 0.5436s/iter; left time: 1475.9104s
	iters: 200, epoch: 25 | loss: 0.0230263
	speed: 0.1281s/iter; left time: 335.0623s
	iters: 300, epoch: 25 | loss: 0.0032358
	speed: 0.1255s/iter; left time: 315.6771s
	iters: 400, epoch: 25 | loss: 0.0027455
	speed: 0.1080s/iter; left time: 260.9105s
Epoch: 25 cost time: 56.41770815849304
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0003600
	speed: 0.4462s/iter; left time: 1002.1045s
	iters: 200, epoch: 26 | loss: 0.0016060
	speed: 0.1072s/iter; left time: 230.0916s
	iters: 300, epoch: 26 | loss: 0.0015163
	speed: 0.1165s/iter; left time: 238.2993s
	iters: 400, epoch: 26 | loss: 0.0038752
	speed: 0.1236s/iter; left time: 240.6114s
Epoch: 26 cost time: 54.05089831352234
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0013199
	speed: 0.5317s/iter; left time: 944.8012s
	iters: 200, epoch: 27 | loss: 0.0263583
	speed: 0.1122s/iter; left time: 188.2357s
	iters: 300, epoch: 27 | loss: 0.0044016
	speed: 0.1115s/iter; left time: 175.8811s
	iters: 400, epoch: 27 | loss: 0.0007388
	speed: 0.1068s/iter; left time: 157.7596s
Epoch: 27 cost time: 52.35910248756409
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0005902
	speed: 0.4878s/iter; left time: 637.9827s
	iters: 200, epoch: 28 | loss: 0.0022479
	speed: 0.1210s/iter; left time: 146.1929s
	iters: 300, epoch: 28 | loss: 0.0011100
	speed: 0.1057s/iter; left time: 117.1170s
	iters: 400, epoch: 28 | loss: 0.0007396
	speed: 0.1222s/iter; left time: 123.1545s
Epoch: 28 cost time: 55.978636026382446
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0013338
	speed: 0.4915s/iter; left time: 412.3405s
	iters: 200, epoch: 29 | loss: 0.0006785
	speed: 0.1114s/iter; left time: 82.2915s
	iters: 300, epoch: 29 | loss: 0.0020249
	speed: 0.1105s/iter; left time: 70.6221s
	iters: 400, epoch: 29 | loss: 0.0008671
	speed: 0.1123s/iter; left time: 60.5171s
Epoch: 29 cost time: 52.786112785339355
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0002828
	speed: 0.5153s/iter; left time: 190.6744s
	iters: 200, epoch: 30 | loss: 0.0108700
	speed: 0.1187s/iter; left time: 32.0356s
	iters: 300, epoch: 30 | loss: 0.0003626
	speed: 0.1139s/iter; left time: 19.3599s
	iters: 400, epoch: 30 | loss: 0.0001774
	speed: 0.0909s/iter; left time: 6.3623s
Epoch: 30 cost time: 52.51255512237549
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 690890
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7810611
	speed: 0.5055s/iter; left time: 7062.1811s
	iters: 200, epoch: 1 | loss: 0.8554822
	speed: 0.4228s/iter; left time: 5864.2034s
	iters: 300, epoch: 1 | loss: 0.3197143
	speed: 0.4182s/iter; left time: 5759.2906s
	iters: 400, epoch: 1 | loss: 0.1365415
	speed: 0.4999s/iter; left time: 6834.5471s
Epoch: 1 cost time: 217.11576056480408
Epoch: 1, Steps: 469 | Train Loss: 1.013 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (inf --> -0.932530).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1572440
	speed: 1.1452s/iter; left time: 15462.3381s
	iters: 200, epoch: 2 | loss: 0.0850378
	speed: 0.5107s/iter; left time: 6844.9280s
	iters: 300, epoch: 2 | loss: 0.0436077
	speed: 0.4226s/iter; left time: 5621.4152s
	iters: 400, epoch: 2 | loss: 0.0376966
	speed: 0.4233s/iter; left time: 5588.4344s
Epoch: 2 cost time: 213.44540452957153
Epoch: 2, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.932530 --> -0.949684).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0117836
	speed: 1.0158s/iter; left time: 13239.4861s
	iters: 200, epoch: 3 | loss: 0.0158094
	speed: 0.4291s/iter; left time: 5549.4211s
	iters: 300, epoch: 3 | loss: 0.0210985
	speed: 0.4310s/iter; left time: 5530.9245s
	iters: 400, epoch: 3 | loss: 0.0594089
	speed: 0.3898s/iter; left time: 4962.7567s
Epoch: 3 cost time: 191.98737359046936
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
Validation loss decreased (-0.949684 --> -0.954830).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0059307
	speed: 1.0354s/iter; left time: 13008.3905s
	iters: 200, epoch: 4 | loss: 0.0270389
	speed: 0.4003s/iter; left time: 4989.3442s
	iters: 300, epoch: 4 | loss: 0.0074537
	speed: 0.3377s/iter; left time: 4174.8595s
	iters: 400, epoch: 4 | loss: 0.0205819
	speed: 0.3630s/iter; left time: 4451.2267s
Epoch: 4 cost time: 171.88430047035217
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.954830 --> -0.967981).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0069463
	speed: 0.9200s/iter; left time: 11127.8444s
	iters: 200, epoch: 5 | loss: 0.1162289
	speed: 0.2873s/iter; left time: 3445.6629s
	iters: 300, epoch: 5 | loss: 0.0066841
	speed: 0.4115s/iter; left time: 4894.8159s
	iters: 400, epoch: 5 | loss: 0.0671205
	speed: 0.2883s/iter; left time: 3400.5175s
Epoch: 5 cost time: 164.8901388645172
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.967981 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0064101
	speed: 0.9750s/iter; left time: 11335.5026s
	iters: 200, epoch: 6 | loss: 0.0033104
	speed: 0.3596s/iter; left time: 4144.7963s
	iters: 300, epoch: 6 | loss: 0.0035943
	speed: 0.3147s/iter; left time: 3595.4420s
	iters: 400, epoch: 6 | loss: 0.0319149
	speed: 0.3994s/iter; left time: 4524.1619s
Epoch: 6 cost time: 163.2140941619873
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0032492
	speed: 0.8723s/iter; left time: 9732.3354s
	iters: 200, epoch: 7 | loss: 0.0069740
	speed: 0.3643s/iter; left time: 4027.6837s
	iters: 300, epoch: 7 | loss: 0.0084420
	speed: 0.3614s/iter; left time: 3959.7061s
	iters: 400, epoch: 7 | loss: 0.0007576
	speed: 0.3546s/iter; left time: 3849.9152s
Epoch: 7 cost time: 169.69659757614136
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.968552 --> -0.975414).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0011445
	speed: 0.9278s/iter; left time: 9915.8861s
	iters: 200, epoch: 8 | loss: 0.0055077
	speed: 0.3445s/iter; left time: 3647.4060s
	iters: 300, epoch: 8 | loss: 0.0010408
	speed: 0.3703s/iter; left time: 3883.9705s
	iters: 400, epoch: 8 | loss: 0.0529147
	speed: 0.3543s/iter; left time: 3680.4710s
Epoch: 8 cost time: 167.51207542419434
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.975414 --> -0.979988).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0022326
	speed: 0.9435s/iter; left time: 9642.0243s
	iters: 200, epoch: 9 | loss: 0.0216913
	speed: 0.3350s/iter; left time: 3389.5462s
	iters: 300, epoch: 9 | loss: 0.0062866
	speed: 0.3514s/iter; left time: 3520.9370s
	iters: 400, epoch: 9 | loss: 0.0013296
	speed: 0.3358s/iter; left time: 3330.3541s
Epoch: 9 cost time: 165.1338279247284
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0202961
	speed: 0.9711s/iter; left time: 9468.6326s
	iters: 200, epoch: 10 | loss: 0.0007435
	speed: 0.3574s/iter; left time: 3448.6957s
	iters: 300, epoch: 10 | loss: 0.0007995
	speed: 0.2701s/iter; left time: 2579.8800s
	iters: 400, epoch: 10 | loss: 0.0148740
	speed: 0.3590s/iter; left time: 3392.0938s
Epoch: 10 cost time: 164.49557495117188
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0686128
	speed: 1.0108s/iter; left time: 9380.7727s
	iters: 200, epoch: 11 | loss: 0.0070544
	speed: 0.4076s/iter; left time: 3742.5961s
	iters: 300, epoch: 11 | loss: 0.0052739
	speed: 0.3971s/iter; left time: 3605.7114s
	iters: 400, epoch: 11 | loss: 0.0027336
	speed: 0.4102s/iter; left time: 3684.3701s
Epoch: 11 cost time: 188.519300699234
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0088792
	speed: 0.8964s/iter; left time: 7898.7104s
	iters: 200, epoch: 12 | loss: 0.0010989
	speed: 0.3167s/iter; left time: 2758.9874s
	iters: 300, epoch: 12 | loss: 0.0062098
	speed: 0.4393s/iter; left time: 3783.6383s
	iters: 400, epoch: 12 | loss: 0.0013136
	speed: 0.3985s/iter; left time: 3391.7282s
Epoch: 12 cost time: 172.71727442741394
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0004784
	speed: 1.0488s/iter; left time: 8750.4014s
	iters: 200, epoch: 13 | loss: 0.1427560
	speed: 0.3574s/iter; left time: 2946.1918s
	iters: 300, epoch: 13 | loss: 0.0009594
	speed: 0.4324s/iter; left time: 3521.3107s
	iters: 400, epoch: 13 | loss: 0.0055844
	speed: 0.3198s/iter; left time: 2572.1874s
Epoch: 13 cost time: 182.01559972763062
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0004001
	speed: 1.0007s/iter; left time: 7879.2397s
	iters: 200, epoch: 14 | loss: 0.0020509
	speed: 0.4659s/iter; left time: 3621.9235s
	iters: 300, epoch: 14 | loss: 0.0025132
	speed: 0.3382s/iter; left time: 2595.0156s
	iters: 400, epoch: 14 | loss: 0.0194079
	speed: 0.4563s/iter; left time: 3456.1623s
Epoch: 14 cost time: 186.13945269584656
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980845).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1193750
	speed: 1.0438s/iter; left time: 7729.5986s
	iters: 200, epoch: 15 | loss: 0.0004090
	speed: 0.3916s/iter; left time: 2860.6884s
	iters: 300, epoch: 15 | loss: 0.0005280
	speed: 0.4117s/iter; left time: 2966.1490s
	iters: 400, epoch: 15 | loss: 0.0003698
	speed: 0.4124s/iter; left time: 2930.2322s
Epoch: 15 cost time: 192.75089812278748
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0005745
	speed: 1.0271s/iter; left time: 7124.0495s
	iters: 200, epoch: 16 | loss: 0.0021916
	speed: 0.3698s/iter; left time: 2527.8848s
	iters: 300, epoch: 16 | loss: 0.0108440
	speed: 0.4626s/iter; left time: 3115.8200s
	iters: 400, epoch: 16 | loss: 0.0038693
	speed: 0.3529s/iter; left time: 2341.5265s
Epoch: 16 cost time: 188.3067216873169
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.980845).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0615218
	speed: 0.8814s/iter; left time: 5700.1156s
	iters: 200, epoch: 17 | loss: 0.0004368
	speed: 0.3666s/iter; left time: 2333.9134s
	iters: 300, epoch: 17 | loss: 0.3221998
	speed: 0.2849s/iter; left time: 1785.2818s
	iters: 400, epoch: 17 | loss: 0.0008086
	speed: 0.3869s/iter; left time: 2385.9072s
Epoch: 17 cost time: 154.32840156555176
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0020528
	speed: 0.6798s/iter; left time: 4077.1544s
	iters: 200, epoch: 18 | loss: 0.0009613
	speed: 0.3138s/iter; left time: 1850.6457s
	iters: 300, epoch: 18 | loss: 0.0025695
	speed: 0.2427s/iter; left time: 1406.9379s
	iters: 400, epoch: 18 | loss: 0.0013875
	speed: 0.2885s/iter; left time: 1643.9908s
Epoch: 18 cost time: 125.47238540649414
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0073847
	speed: 0.7743s/iter; left time: 4280.9172s
	iters: 200, epoch: 19 | loss: 0.0003867
	speed: 0.3029s/iter; left time: 1644.6266s
	iters: 300, epoch: 19 | loss: 0.0020990
	speed: 0.2727s/iter; left time: 1453.4487s
	iters: 400, epoch: 19 | loss: 0.0001645
	speed: 0.3260s/iter; left time: 1704.4449s
Epoch: 19 cost time: 139.02863454818726
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0024977
	speed: 0.7757s/iter; left time: 3925.0735s
	iters: 200, epoch: 20 | loss: 0.0008085
	speed: 0.2968s/iter; left time: 1472.0885s
	iters: 300, epoch: 20 | loss: 0.0004186
	speed: 0.2728s/iter; left time: 1325.9124s
	iters: 400, epoch: 20 | loss: 0.0005110
	speed: 0.3165s/iter; left time: 1506.4701s
Epoch: 20 cost time: 136.92661333084106
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0009431
	speed: 0.7975s/iter; left time: 3661.2414s
	iters: 200, epoch: 21 | loss: 0.0010370
	speed: 0.2343s/iter; left time: 1052.2845s
	iters: 300, epoch: 21 | loss: 0.0003032
	speed: 0.2459s/iter; left time: 1079.5845s
	iters: 400, epoch: 21 | loss: 0.0008810
	speed: 0.3999s/iter; left time: 1716.0060s
Epoch: 21 cost time: 140.53626608848572
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0011586
	speed: 0.9132s/iter; left time: 3764.3425s
	iters: 200, epoch: 22 | loss: 0.0131645
	speed: 0.4008s/iter; left time: 1611.9025s
	iters: 300, epoch: 22 | loss: 0.0017102
	speed: 0.3148s/iter; left time: 1234.8188s
	iters: 400, epoch: 22 | loss: 0.0001968
	speed: 0.3716s/iter; left time: 1420.1866s
Epoch: 22 cost time: 171.86935663223267
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0004044
	speed: 0.8938s/iter; left time: 3265.0239s
	iters: 200, epoch: 23 | loss: 0.0035759
	speed: 0.4088s/iter; left time: 1452.3204s
	iters: 300, epoch: 23 | loss: 0.0111789
	speed: 0.3389s/iter; left time: 1170.2436s
	iters: 400, epoch: 23 | loss: 0.0063899
	speed: 0.2821s/iter; left time: 945.8155s
Epoch: 23 cost time: 166.26445150375366
Epoch: 23, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0017981
	speed: 1.0713s/iter; left time: 3410.9852s
	iters: 200, epoch: 24 | loss: 0.0004964
	speed: 0.3696s/iter; left time: 1139.7112s
	iters: 300, epoch: 24 | loss: 0.0002535
	speed: 0.4298s/iter; left time: 1282.5250s
	iters: 400, epoch: 24 | loss: 0.0003056
	speed: 0.3668s/iter; left time: 1057.9005s
Epoch: 24 cost time: 184.08403849601746
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0007149
	speed: 1.0316s/iter; left time: 2800.9228s
	iters: 200, epoch: 25 | loss: 0.0002205
	speed: 0.3806s/iter; left time: 995.2420s
	iters: 300, epoch: 25 | loss: 0.0003853
	speed: 0.3884s/iter; left time: 976.7063s
	iters: 400, epoch: 25 | loss: 0.0002753
	speed: 0.4185s/iter; left time: 1010.6787s
Epoch: 25 cost time: 181.76478695869446
Epoch: 25, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0042263
	speed: 0.9672s/iter; left time: 2172.4308s
	iters: 200, epoch: 26 | loss: 0.1641701
	speed: 0.3978s/iter; left time: 853.7363s
	iters: 300, epoch: 26 | loss: 0.1599749
	speed: 0.3580s/iter; left time: 732.3925s
	iters: 400, epoch: 26 | loss: 0.0005768
	speed: 0.4041s/iter; left time: 786.4117s
Epoch: 26 cost time: 182.45290422439575
Epoch: 26, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 1174090
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8594943
	speed: 0.2620s/iter; left time: 3660.5223s
	iters: 200, epoch: 1 | loss: 1.4358324
	speed: 0.2184s/iter; left time: 3029.6856s
	iters: 300, epoch: 1 | loss: 0.5667553
	speed: 0.2182s/iter; left time: 3005.3710s
	iters: 400, epoch: 1 | loss: 0.4148909
	speed: 0.2194s/iter; left time: 2999.1743s
Epoch: 1 cost time: 103.67229676246643
Epoch: 1, Steps: 469 | Train Loss: 1.113 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (inf --> -0.932816).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1412767
	speed: 0.6614s/iter; left time: 8930.6012s
	iters: 200, epoch: 2 | loss: 0.3196128
	speed: 0.2008s/iter; left time: 2691.1189s
	iters: 300, epoch: 2 | loss: 0.0686920
	speed: 0.2193s/iter; left time: 2917.5550s
	iters: 400, epoch: 2 | loss: 0.0578220
	speed: 0.2078s/iter; left time: 2743.2516s
Epoch: 2 cost time: 102.0358476638794
Epoch: 2, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.932816 --> -0.964836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0421099
	speed: 0.6758s/iter; left time: 8807.6284s
	iters: 200, epoch: 3 | loss: 0.0378797
	speed: 0.1953s/iter; left time: 2526.3207s
	iters: 300, epoch: 3 | loss: 0.0405846
	speed: 0.2338s/iter; left time: 3000.3103s
	iters: 400, epoch: 3 | loss: 0.0405260
	speed: 0.2200s/iter; left time: 2801.2115s
Epoch: 3 cost time: 102.42343163490295
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0994456
	speed: 0.6593s/iter; left time: 8283.4383s
	iters: 200, epoch: 4 | loss: 0.0058153
	speed: 0.1967s/iter; left time: 2451.2873s
	iters: 300, epoch: 4 | loss: 0.0186238
	speed: 0.2339s/iter; left time: 2891.6842s
	iters: 400, epoch: 4 | loss: 0.0071598
	speed: 0.2164s/iter; left time: 2653.4098s
Epoch: 4 cost time: 100.3074803352356
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.964836 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2546231
	speed: 0.6382s/iter; left time: 7718.9309s
	iters: 200, epoch: 5 | loss: 0.0592957
	speed: 0.2182s/iter; left time: 2616.9855s
	iters: 300, epoch: 5 | loss: 0.4862720
	speed: 0.2381s/iter; left time: 2832.0130s
	iters: 400, epoch: 5 | loss: 0.0938646
	speed: 0.2160s/iter; left time: 2548.1081s
Epoch: 5 cost time: 102.4431984424591
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0029461
	speed: 0.6259s/iter; left time: 7276.4606s
	iters: 200, epoch: 6 | loss: 0.0014494
	speed: 0.2370s/iter; left time: 2731.6863s
	iters: 300, epoch: 6 | loss: 0.1049070
	speed: 0.2263s/iter; left time: 2585.5565s
	iters: 400, epoch: 6 | loss: 0.0026995
	speed: 0.2077s/iter; left time: 2352.2371s
Epoch: 6 cost time: 99.43275570869446
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.971125 --> -0.980560).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0035042
	speed: 0.5835s/iter; left time: 6510.4733s
	iters: 200, epoch: 7 | loss: 0.3464252
	speed: 0.2087s/iter; left time: 2307.9246s
	iters: 300, epoch: 7 | loss: 0.0041053
	speed: 0.2221s/iter; left time: 2433.4767s
	iters: 400, epoch: 7 | loss: 0.0019018
	speed: 0.1848s/iter; left time: 2006.3903s
Epoch: 7 cost time: 95.9440906047821
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0080635
	speed: 0.6266s/iter; left time: 6696.8707s
	iters: 200, epoch: 8 | loss: 0.0143419
	speed: 0.2103s/iter; left time: 2226.8711s
	iters: 300, epoch: 8 | loss: 0.0079366
	speed: 0.1970s/iter; left time: 2065.9687s
	iters: 400, epoch: 8 | loss: 0.0013802
	speed: 0.1929s/iter; left time: 2003.5698s
Epoch: 8 cost time: 94.13205814361572
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0182494
	speed: 0.5947s/iter; left time: 6076.8010s
	iters: 200, epoch: 9 | loss: 0.0007823
	speed: 0.2107s/iter; left time: 2131.9276s
	iters: 300, epoch: 9 | loss: 0.1354561
	speed: 0.1836s/iter; left time: 1839.7738s
	iters: 400, epoch: 9 | loss: 0.0279226
	speed: 0.1719s/iter; left time: 1705.2607s
Epoch: 9 cost time: 92.43198895454407
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1979097
	speed: 0.6500s/iter; left time: 6337.0922s
	iters: 200, epoch: 10 | loss: 0.0127721
	speed: 0.1800s/iter; left time: 1737.0185s
	iters: 300, epoch: 10 | loss: 0.0059004
	speed: 0.1958s/iter; left time: 1870.2568s
	iters: 400, epoch: 10 | loss: 0.0086876
	speed: 0.1664s/iter; left time: 1572.6634s
Epoch: 10 cost time: 91.2488112449646
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0020627
	speed: 0.5956s/iter; left time: 5527.6916s
	iters: 200, epoch: 11 | loss: 0.0056368
	speed: 0.1978s/iter; left time: 1816.1483s
	iters: 300, epoch: 11 | loss: 0.0272831
	speed: 0.1755s/iter; left time: 1593.6258s
	iters: 400, epoch: 11 | loss: 0.0008446
	speed: 0.2139s/iter; left time: 1920.9253s
Epoch: 11 cost time: 91.74653434753418
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.980560 --> -0.987421).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006765
	speed: 0.6064s/iter; left time: 5343.4079s
	iters: 200, epoch: 12 | loss: 0.0076169
	speed: 0.1773s/iter; left time: 1544.7514s
	iters: 300, epoch: 12 | loss: 0.0072176
	speed: 0.2279s/iter; left time: 1962.7960s
	iters: 400, epoch: 12 | loss: 0.0151614
	speed: 0.2004s/iter; left time: 1706.2286s
Epoch: 12 cost time: 93.95319199562073
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0003407
	speed: 0.6248s/iter; left time: 5212.5261s
	iters: 200, epoch: 13 | loss: 0.0018124
	speed: 0.2454s/iter; left time: 2022.7524s
	iters: 300, epoch: 13 | loss: 0.0028858
	speed: 0.2307s/iter; left time: 1878.3249s
	iters: 400, epoch: 13 | loss: 0.0113400
	speed: 0.2471s/iter; left time: 1987.4367s
Epoch: 13 cost time: 113.98487591743469
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0024205
	speed: 0.6871s/iter; left time: 5409.8952s
	iters: 200, epoch: 14 | loss: 0.0010567
	speed: 0.2600s/iter; left time: 2021.2008s
	iters: 300, epoch: 14 | loss: 0.0003694
	speed: 0.2722s/iter; left time: 2088.6141s
	iters: 400, epoch: 14 | loss: 0.0012386
	speed: 0.2178s/iter; left time: 1649.4334s
Epoch: 14 cost time: 111.17350172996521
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4767226
	speed: 0.7086s/iter; left time: 5247.0585s
	iters: 200, epoch: 15 | loss: 0.0224993
	speed: 0.2299s/iter; left time: 1679.2828s
	iters: 300, epoch: 15 | loss: 0.0018452
	speed: 0.2163s/iter; left time: 1558.3498s
	iters: 400, epoch: 15 | loss: 0.0005355
	speed: 0.2408s/iter; left time: 1710.6580s
Epoch: 15 cost time: 111.7686517238617
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0009784
	speed: 0.7019s/iter; left time: 4868.5426s
	iters: 200, epoch: 16 | loss: 0.0072859
	speed: 0.2655s/iter; left time: 1814.8703s
	iters: 300, epoch: 16 | loss: 0.0005958
	speed: 0.2254s/iter; left time: 1518.1689s
	iters: 400, epoch: 16 | loss: 0.0497810
	speed: 0.2075s/iter; left time: 1376.8392s
Epoch: 16 cost time: 111.15324759483337
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0009590
	speed: 0.7424s/iter; left time: 4800.9143s
	iters: 200, epoch: 17 | loss: 0.0008694
	speed: 0.2056s/iter; left time: 1308.7980s
	iters: 300, epoch: 17 | loss: 0.0026323
	speed: 0.2155s/iter; left time: 1350.7840s
	iters: 400, epoch: 17 | loss: 0.0036223
	speed: 0.2558s/iter; left time: 1577.5486s
Epoch: 17 cost time: 109.48868250846863
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0067877
	speed: 0.7088s/iter; left time: 4251.5049s
	iters: 200, epoch: 18 | loss: 0.1273181
	speed: 0.2480s/iter; left time: 1462.5337s
	iters: 300, epoch: 18 | loss: 0.0004652
	speed: 0.2114s/iter; left time: 1225.7549s
	iters: 400, epoch: 18 | loss: 0.0014956
	speed: 0.1736s/iter; left time: 988.9069s
Epoch: 18 cost time: 92.60975289344788
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0151025
	speed: 0.5146s/iter; left time: 2845.4798s
	iters: 200, epoch: 19 | loss: 0.0095886
	speed: 0.1747s/iter; left time: 948.6712s
	iters: 300, epoch: 19 | loss: 0.0022197
	speed: 0.2079s/iter; left time: 1107.9475s
	iters: 400, epoch: 19 | loss: 0.0012883
	speed: 0.1906s/iter; left time: 996.7424s
Epoch: 19 cost time: 91.9555253982544
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0001912
	speed: 0.6224s/iter; left time: 3149.1667s
	iters: 200, epoch: 20 | loss: 0.0007712
	speed: 0.2312s/iter; left time: 1146.8585s
	iters: 300, epoch: 20 | loss: 0.0017123
	speed: 0.1943s/iter; left time: 944.1492s
	iters: 400, epoch: 20 | loss: 0.0005167
	speed: 0.2086s/iter; left time: 993.1274s
Epoch: 20 cost time: 94.64128708839417
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.3963754
	speed: 0.6189s/iter; left time: 2841.4006s
	iters: 200, epoch: 21 | loss: 0.0008539
	speed: 0.1737s/iter; left time: 780.0209s
	iters: 300, epoch: 21 | loss: 0.0003153
	speed: 0.2158s/iter; left time: 947.6723s
	iters: 400, epoch: 21 | loss: 0.0167054
	speed: 0.2076s/iter; left time: 891.0240s
Epoch: 21 cost time: 96.88011312484741
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9874213836477987
model parameter : 346314
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7737620
	speed: 0.2861s/iter; left time: 3997.6359s
	iters: 200, epoch: 1 | loss: 0.8650414
	speed: 0.2450s/iter; left time: 3398.8282s
	iters: 300, epoch: 1 | loss: 0.3175174
	speed: 0.2192s/iter; left time: 3018.0556s
	iters: 400, epoch: 1 | loss: 0.1362757
	speed: 0.2277s/iter; left time: 3113.1308s
Epoch: 1 cost time: 109.83336424827576
Epoch: 1, Steps: 469 | Train Loss: 1.020 Vali Loss: 0.255 Vali Acc: 0.932 Test Loss: 0.255 Test Acc: 0.932
Validation loss decreased (inf --> -0.932244).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1621189
	speed: 0.5858s/iter; left time: 7909.5180s
	iters: 200, epoch: 2 | loss: 0.1284080
	speed: 0.2073s/iter; left time: 2778.3034s
	iters: 300, epoch: 2 | loss: 0.0642391
	speed: 0.2144s/iter; left time: 2852.3361s
	iters: 400, epoch: 2 | loss: 0.0428500
	speed: 0.1688s/iter; left time: 2228.0490s
Epoch: 2 cost time: 97.60443139076233
Epoch: 2, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
Validation loss decreased (-0.932244 --> -0.953114).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0196267
	speed: 0.6242s/iter; left time: 8135.0407s
	iters: 200, epoch: 3 | loss: 0.0230400
	speed: 0.2076s/iter; left time: 2685.2442s
	iters: 300, epoch: 3 | loss: 0.0146317
	speed: 0.2122s/iter; left time: 2723.7357s
	iters: 400, epoch: 3 | loss: 0.0701536
	speed: 0.1939s/iter; left time: 2468.4546s
Epoch: 3 cost time: 101.54163384437561
Epoch: 3, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.953114 --> -0.973698).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0048982
	speed: 0.6554s/iter; left time: 8234.5587s
	iters: 200, epoch: 4 | loss: 0.0193346
	speed: 0.1786s/iter; left time: 2226.0379s
	iters: 300, epoch: 4 | loss: 0.0048952
	speed: 0.2194s/iter; left time: 2712.8333s
	iters: 400, epoch: 4 | loss: 0.0512616
	speed: 0.1980s/iter; left time: 2428.4956s
Epoch: 4 cost time: 99.96389174461365
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.973698 --> -0.975985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0075224
	speed: 0.6177s/iter; left time: 7471.4093s
	iters: 200, epoch: 5 | loss: 0.1249772
	speed: 0.1444s/iter; left time: 1732.4105s
	iters: 300, epoch: 5 | loss: 0.0049641
	speed: 0.2338s/iter; left time: 2780.8654s
	iters: 400, epoch: 5 | loss: 0.0167450
	speed: 0.1788s/iter; left time: 2109.3922s
Epoch: 5 cost time: 93.64062690734863
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0055199
	speed: 0.6095s/iter; left time: 7085.7586s
	iters: 200, epoch: 6 | loss: 0.0097824
	speed: 0.1596s/iter; left time: 1839.2823s
	iters: 300, epoch: 6 | loss: 0.0137023
	speed: 0.2442s/iter; left time: 2790.3362s
	iters: 400, epoch: 6 | loss: 0.0598870
	speed: 0.1527s/iter; left time: 1729.7520s
Epoch: 6 cost time: 90.71608805656433
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.975985).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0054185
	speed: 0.5620s/iter; left time: 6270.1983s
	iters: 200, epoch: 7 | loss: 0.0374071
	speed: 0.1884s/iter; left time: 2083.6857s
	iters: 300, epoch: 7 | loss: 0.0027061
	speed: 0.2139s/iter; left time: 2343.6139s
	iters: 400, epoch: 7 | loss: 0.0011393
	speed: 0.1866s/iter; left time: 2025.9374s
Epoch: 7 cost time: 87.03964829444885
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.975985 --> -0.980274).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0013803
	speed: 0.5268s/iter; left time: 5630.7496s
	iters: 200, epoch: 8 | loss: 0.0054118
	speed: 0.2389s/iter; left time: 2529.0303s
	iters: 300, epoch: 8 | loss: 0.0017567
	speed: 0.1841s/iter; left time: 1930.4529s
	iters: 400, epoch: 8 | loss: 0.0320594
	speed: 0.1004s/iter; left time: 1042.9462s
Epoch: 8 cost time: 72.98290348052979
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980274 --> -0.981417).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0145751
	speed: 0.5351s/iter; left time: 5468.3451s
	iters: 200, epoch: 9 | loss: 0.0170861
	speed: 0.2176s/iter; left time: 2202.3915s
	iters: 300, epoch: 9 | loss: 0.0450485
	speed: 0.2346s/iter; left time: 2350.5091s
	iters: 400, epoch: 9 | loss: 0.0025677
	speed: 0.2393s/iter; left time: 2373.3905s
Epoch: 9 cost time: 107.47391295433044
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0617139
	speed: 0.6438s/iter; left time: 6277.5123s
	iters: 200, epoch: 10 | loss: 0.0012773
	speed: 0.2437s/iter; left time: 2351.6911s
	iters: 300, epoch: 10 | loss: 0.0011400
	speed: 0.1871s/iter; left time: 1786.5151s
	iters: 400, epoch: 10 | loss: 0.2952428
	speed: 0.2548s/iter; left time: 2408.2663s
Epoch: 10 cost time: 111.64962673187256
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1114739
	speed: 0.6345s/iter; left time: 5888.6584s
	iters: 200, epoch: 11 | loss: 0.0015576
	speed: 0.2423s/iter; left time: 2224.8206s
	iters: 300, epoch: 11 | loss: 0.0017821
	speed: 0.2277s/iter; left time: 2068.1310s
	iters: 400, epoch: 11 | loss: 0.0007168
	speed: 0.2061s/iter; left time: 1851.2205s
Epoch: 11 cost time: 105.75836396217346
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0088281
	speed: 0.6452s/iter; left time: 5685.4727s
	iters: 200, epoch: 12 | loss: 0.0005883
	speed: 0.2135s/iter; left time: 1859.6011s
	iters: 300, epoch: 12 | loss: 0.0045617
	speed: 0.2883s/iter; left time: 2482.4764s
	iters: 400, epoch: 12 | loss: 0.0011031
	speed: 0.2184s/iter; left time: 1859.0358s
Epoch: 12 cost time: 106.2394368648529
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.982847).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0165303
	speed: 0.6703s/iter; left time: 5591.9463s
	iters: 200, epoch: 13 | loss: 0.0043642
	speed: 0.2328s/iter; left time: 1919.2326s
	iters: 300, epoch: 13 | loss: 0.0009899
	speed: 0.2521s/iter; left time: 2052.9444s
	iters: 400, epoch: 13 | loss: 0.0227039
	speed: 0.3090s/iter; left time: 2485.2323s
Epoch: 13 cost time: 127.25799751281738
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0004718
	speed: 0.7508s/iter; left time: 5912.1784s
	iters: 200, epoch: 14 | loss: 0.0013762
	speed: 0.2650s/iter; left time: 2059.7673s
	iters: 300, epoch: 14 | loss: 0.0042626
	speed: 0.2741s/iter; left time: 2103.2213s
	iters: 400, epoch: 14 | loss: 0.0174455
	speed: 0.2812s/iter; left time: 2130.1875s
Epoch: 14 cost time: 131.9498631954193
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3013982
	speed: 0.7402s/iter; left time: 5480.9295s
	iters: 200, epoch: 15 | loss: 0.0014536
	speed: 0.2796s/iter; left time: 2042.3008s
	iters: 300, epoch: 15 | loss: 0.0007864
	speed: 0.2963s/iter; left time: 2134.6209s
	iters: 400, epoch: 15 | loss: 0.0005026
	speed: 0.2276s/iter; left time: 1616.8004s
Epoch: 15 cost time: 123.43093633651733
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0006742
	speed: 0.7454s/iter; left time: 5170.1371s
	iters: 200, epoch: 16 | loss: 0.0047256
	speed: 0.2713s/iter; left time: 1854.8036s
	iters: 300, epoch: 16 | loss: 0.0018188
	speed: 0.3033s/iter; left time: 2043.3607s
	iters: 400, epoch: 16 | loss: 0.0040641
	speed: 0.2554s/iter; left time: 1694.7551s
Epoch: 16 cost time: 126.19288516044617
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0650764
	speed: 0.7492s/iter; left time: 4844.9353s
	iters: 200, epoch: 17 | loss: 0.0050952
	speed: 0.2841s/iter; left time: 1808.9990s
	iters: 300, epoch: 17 | loss: 0.5273298
	speed: 0.2068s/iter; left time: 1296.2504s
	iters: 400, epoch: 17 | loss: 0.0010486
	speed: 0.2956s/iter; left time: 1823.2344s
Epoch: 17 cost time: 128.27783155441284
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983418).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0037447
	speed: 0.7524s/iter; left time: 4512.6696s
	iters: 200, epoch: 18 | loss: 0.0006511
	speed: 0.3048s/iter; left time: 1797.8026s
	iters: 300, epoch: 18 | loss: 0.0015453
	speed: 0.2365s/iter; left time: 1371.3924s
	iters: 400, epoch: 18 | loss: 0.0006132
	speed: 0.2796s/iter; left time: 1593.3616s
Epoch: 18 cost time: 127.95864200592041
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0034200
	speed: 0.7673s/iter; left time: 4242.6003s
	iters: 200, epoch: 19 | loss: 0.0003795
	speed: 0.2707s/iter; left time: 1469.4141s
	iters: 300, epoch: 19 | loss: 0.0171048
	speed: 0.2983s/iter; left time: 1589.8035s
	iters: 400, epoch: 19 | loss: 0.0004332
	speed: 0.2665s/iter; left time: 1393.7078s
Epoch: 19 cost time: 127.96339058876038
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0023620
	speed: 0.6520s/iter; left time: 3299.2303s
	iters: 200, epoch: 20 | loss: 0.0006526
	speed: 0.2218s/iter; left time: 1099.8869s
	iters: 300, epoch: 20 | loss: 0.0007994
	speed: 0.2182s/iter; left time: 1060.4308s
	iters: 400, epoch: 20 | loss: 0.0017914
	speed: 0.2665s/iter; left time: 1268.3816s
Epoch: 20 cost time: 104.5995500087738
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0008366
	speed: 0.6354s/iter; left time: 2916.9514s
	iters: 200, epoch: 21 | loss: 0.0005772
	speed: 0.2496s/iter; left time: 1120.9882s
	iters: 300, epoch: 21 | loss: 0.0005315
	speed: 0.2048s/iter; left time: 899.1208s
	iters: 400, epoch: 21 | loss: 0.0013448
	speed: 0.2455s/iter; left time: 1053.4885s
Epoch: 21 cost time: 112.67808318138123
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0005187
	speed: 0.6179s/iter; left time: 2546.8302s
	iters: 200, epoch: 22 | loss: 0.0015934
	speed: 0.2433s/iter; left time: 978.3957s
	iters: 300, epoch: 22 | loss: 0.0002635
	speed: 0.2454s/iter; left time: 962.3122s
	iters: 400, epoch: 22 | loss: 0.0002381
	speed: 0.1851s/iter; left time: 707.3294s
Epoch: 22 cost time: 103.32677793502808
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0003897
	speed: 0.6624s/iter; left time: 2419.8083s
	iters: 200, epoch: 23 | loss: 0.0008436
	speed: 0.2019s/iter; left time: 717.3401s
	iters: 300, epoch: 23 | loss: 0.0044695
	speed: 0.2654s/iter; left time: 916.4588s
	iters: 400, epoch: 23 | loss: 0.0160344
	speed: 0.2301s/iter; left time: 771.3723s
Epoch: 23 cost time: 108.07914161682129
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0115890
	speed: 0.6558s/iter; left time: 2088.2176s
	iters: 200, epoch: 24 | loss: 0.0026234
	speed: 0.2202s/iter; left time: 679.1931s
	iters: 300, epoch: 24 | loss: 0.0009400
	speed: 0.2014s/iter; left time: 601.0376s
	iters: 400, epoch: 24 | loss: 0.0003058
	speed: 0.2636s/iter; left time: 760.1915s
Epoch: 24 cost time: 109.15549349784851
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0027341
	speed: 0.6361s/iter; left time: 1727.1012s
	iters: 200, epoch: 25 | loss: 0.0005341
	speed: 0.2704s/iter; left time: 707.1767s
	iters: 300, epoch: 25 | loss: 0.0010428
	speed: 0.1915s/iter; left time: 481.6887s
	iters: 400, epoch: 25 | loss: 0.0065730
	speed: 0.2192s/iter; left time: 529.4418s
Epoch: 25 cost time: 106.89650106430054
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0006509
	speed: 0.6476s/iter; left time: 1454.5372s
	iters: 200, epoch: 26 | loss: 0.0046878
	speed: 0.2081s/iter; left time: 446.6833s
	iters: 300, epoch: 26 | loss: 0.0021843
	speed: 0.0628s/iter; left time: 128.4746s
	iters: 400, epoch: 26 | loss: 0.0004664
	speed: 0.1027s/iter; left time: 199.9128s
Epoch: 26 cost time: 70.71390676498413
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0084465
	speed: 0.5023s/iter; left time: 892.6105s
	iters: 200, epoch: 27 | loss: 0.0005239
	speed: 0.2062s/iter; left time: 345.7574s
	iters: 300, epoch: 27 | loss: 0.0011187
	speed: 0.1279s/iter; left time: 201.7263s
	iters: 400, epoch: 27 | loss: 0.0004828
	speed: 0.1824s/iter; left time: 269.3381s
Epoch: 27 cost time: 73.6737744808197
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 1174090
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8611656
	speed: 0.1503s/iter; left time: 2099.5084s
	iters: 200, epoch: 1 | loss: 1.4625912
	speed: 0.1347s/iter; left time: 1869.0564s
	iters: 300, epoch: 1 | loss: 0.6417363
	speed: 0.1408s/iter; left time: 1938.7210s
	iters: 400, epoch: 1 | loss: 0.4379548
	speed: 0.1024s/iter; left time: 1400.5741s
Epoch: 1 cost time: 62.67206048965454
Epoch: 1, Steps: 469 | Train Loss: 1.130 Vali Loss: 0.301 Vali Acc: 0.932 Test Loss: 0.301 Test Acc: 0.932
Validation loss decreased (inf --> -0.931958).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1122230
	speed: 0.4638s/iter; left time: 6262.5381s
	iters: 200, epoch: 2 | loss: 0.3314410
	speed: 0.1644s/iter; left time: 2203.4201s
	iters: 300, epoch: 2 | loss: 0.0850316
	speed: 0.1164s/iter; left time: 1548.5066s
	iters: 400, epoch: 2 | loss: 0.0664726
	speed: 0.1267s/iter; left time: 1672.0585s
Epoch: 2 cost time: 63.05862545967102
Epoch: 2, Steps: 469 | Train Loss: 0.149 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.931958 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0342639
	speed: 0.4596s/iter; left time: 5989.9108s
	iters: 200, epoch: 3 | loss: 0.0492441
	speed: 0.1130s/iter; left time: 1461.4007s
	iters: 300, epoch: 3 | loss: 0.0716753
	speed: 0.1557s/iter; left time: 1998.5339s
	iters: 400, epoch: 3 | loss: 0.0282022
	speed: 0.1119s/iter; left time: 1425.1021s
Epoch: 3 cost time: 58.07052516937256
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.963978 --> -0.967981).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0782821
	speed: 0.2998s/iter; left time: 3767.2077s
	iters: 200, epoch: 4 | loss: 0.0092038
	speed: 0.1374s/iter; left time: 1712.7863s
	iters: 300, epoch: 4 | loss: 0.0098223
	speed: 0.1565s/iter; left time: 1935.3834s
	iters: 400, epoch: 4 | loss: 0.0090093
	speed: 0.1189s/iter; left time: 1458.6907s
Epoch: 4 cost time: 55.37804412841797
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.967981 --> -0.972555).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3431745
	speed: 0.4684s/iter; left time: 5665.9008s
	iters: 200, epoch: 5 | loss: 0.1252750
	speed: 0.1268s/iter; left time: 1520.8248s
	iters: 300, epoch: 5 | loss: 0.1898308
	speed: 0.1531s/iter; left time: 1821.4890s
	iters: 400, epoch: 5 | loss: 0.1147684
	speed: 0.1386s/iter; left time: 1634.4597s
Epoch: 5 cost time: 63.39629936218262
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0100934
	speed: 0.4701s/iter; left time: 5465.1130s
	iters: 200, epoch: 6 | loss: 0.0014162
	speed: 0.1334s/iter; left time: 1538.0371s
	iters: 300, epoch: 6 | loss: 0.0498593
	speed: 0.1285s/iter; left time: 1468.6614s
	iters: 400, epoch: 6 | loss: 0.0104408
	speed: 0.1339s/iter; left time: 1517.0519s
Epoch: 6 cost time: 62.49671530723572
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.972555 --> -0.978558).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0023070
	speed: 0.4498s/iter; left time: 5017.9046s
	iters: 200, epoch: 7 | loss: 0.0114531
	speed: 0.1440s/iter; left time: 1592.4540s
	iters: 300, epoch: 7 | loss: 0.0034854
	speed: 0.1147s/iter; left time: 1257.1603s
	iters: 400, epoch: 7 | loss: 0.0038501
	speed: 0.1144s/iter; left time: 1241.9017s
Epoch: 7 cost time: 61.317726373672485
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0088284
	speed: 0.4469s/iter; left time: 4776.4611s
	iters: 200, epoch: 8 | loss: 0.0032875
	speed: 0.1587s/iter; left time: 1680.5023s
	iters: 300, epoch: 8 | loss: 0.0174905
	speed: 0.1145s/iter; left time: 1200.4936s
	iters: 400, epoch: 8 | loss: 0.0063532
	speed: 0.0933s/iter; left time: 969.3382s
Epoch: 8 cost time: 59.975417375564575
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0381143
	speed: 0.4690s/iter; left time: 4793.0235s
	iters: 200, epoch: 9 | loss: 0.0012727
	speed: 0.1575s/iter; left time: 1594.1466s
	iters: 300, epoch: 9 | loss: 0.1360442
	speed: 0.1022s/iter; left time: 1024.0481s
	iters: 400, epoch: 9 | loss: 0.0047723
	speed: 0.1006s/iter; left time: 998.2334s
Epoch: 9 cost time: 59.54918646812439
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2625203
	speed: 0.4589s/iter; left time: 4474.5120s
	iters: 200, epoch: 10 | loss: 0.0033448
	speed: 0.1437s/iter; left time: 1386.5795s
	iters: 300, epoch: 10 | loss: 0.0022357
	speed: 0.1075s/iter; left time: 1026.9695s
	iters: 400, epoch: 10 | loss: 0.0014488
	speed: 0.1243s/iter; left time: 1174.8766s
Epoch: 10 cost time: 59.978238582611084
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979988).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0014264
	speed: 0.4580s/iter; left time: 4250.7752s
	iters: 200, epoch: 11 | loss: 0.0577426
	speed: 0.1266s/iter; left time: 1162.4256s
	iters: 300, epoch: 11 | loss: 0.0778304
	speed: 0.1346s/iter; left time: 1222.6756s
	iters: 400, epoch: 11 | loss: 0.0125254
	speed: 0.1373s/iter; left time: 1232.8182s
Epoch: 11 cost time: 60.97162938117981
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0013839
	speed: 0.4013s/iter; left time: 3536.2159s
	iters: 200, epoch: 12 | loss: 0.0024539
	speed: 0.0981s/iter; left time: 854.9327s
	iters: 300, epoch: 12 | loss: 0.0009514
	speed: 0.1158s/iter; left time: 997.2144s
	iters: 400, epoch: 12 | loss: 0.0085918
	speed: 0.1384s/iter; left time: 1178.3055s
Epoch: 12 cost time: 54.63540983200073
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0018961
	speed: 0.3733s/iter; left time: 3114.1068s
	iters: 200, epoch: 13 | loss: 0.0071728
	speed: 0.0876s/iter; left time: 721.8188s
	iters: 300, epoch: 13 | loss: 0.0007300
	speed: 0.1307s/iter; left time: 1064.6441s
	iters: 400, epoch: 13 | loss: 0.0017691
	speed: 0.1161s/iter; left time: 933.4521s
Epoch: 13 cost time: 50.60698223114014
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0347074
	speed: 0.3798s/iter; left time: 2990.8109s
	iters: 200, epoch: 14 | loss: 0.0008779
	speed: 0.1009s/iter; left time: 784.6218s
	iters: 300, epoch: 14 | loss: 0.0002293
	speed: 0.1346s/iter; left time: 1033.2376s
	iters: 400, epoch: 14 | loss: 0.0111524
	speed: 0.1078s/iter; left time: 816.2330s
Epoch: 14 cost time: 50.85343670845032
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0062198
	speed: 0.3878s/iter; left time: 2871.8020s
	iters: 200, epoch: 15 | loss: 0.0020630
	speed: 0.1144s/iter; left time: 835.5937s
	iters: 300, epoch: 15 | loss: 0.0027575
	speed: 0.1263s/iter; left time: 910.2724s
	iters: 400, epoch: 15 | loss: 0.0036057
	speed: 0.1100s/iter; left time: 781.7329s
Epoch: 15 cost time: 53.00544619560242
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.982847).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0009343
	speed: 0.3952s/iter; left time: 2741.4366s
	iters: 200, epoch: 16 | loss: 0.0106291
	speed: 0.1121s/iter; left time: 766.5759s
	iters: 300, epoch: 16 | loss: 0.0006355
	speed: 0.1247s/iter; left time: 840.1684s
	iters: 400, epoch: 16 | loss: 0.0318617
	speed: 0.0994s/iter; left time: 659.4232s
Epoch: 16 cost time: 51.36891317367554
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.982847 --> -0.985420).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0010714
	speed: 0.3803s/iter; left time: 2459.2175s
	iters: 200, epoch: 17 | loss: 0.0055219
	speed: 0.1010s/iter; left time: 643.0515s
	iters: 300, epoch: 17 | loss: 0.0049617
	speed: 0.1228s/iter; left time: 769.6256s
	iters: 400, epoch: 17 | loss: 0.0011829
	speed: 0.0987s/iter; left time: 608.7827s
Epoch: 17 cost time: 48.9107027053833
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0010510
	speed: 0.2287s/iter; left time: 1371.4956s
	iters: 200, epoch: 18 | loss: 0.3059523
	speed: 0.0884s/iter; left time: 521.2620s
	iters: 300, epoch: 18 | loss: 0.0011269
	speed: 0.0646s/iter; left time: 374.7006s
	iters: 400, epoch: 18 | loss: 0.0159239
	speed: 0.1008s/iter; left time: 574.3158s
Epoch: 18 cost time: 35.469759464263916
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.985420 --> -0.985420).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0023469
	speed: 0.3074s/iter; left time: 1699.8193s
	iters: 200, epoch: 19 | loss: 0.0101436
	speed: 0.0810s/iter; left time: 439.7236s
	iters: 300, epoch: 19 | loss: 0.1218211
	speed: 0.0744s/iter; left time: 396.4988s
	iters: 400, epoch: 19 | loss: 0.0003222
	speed: 0.1050s/iter; left time: 548.8491s
Epoch: 19 cost time: 40.17513871192932
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0004247
	speed: 0.3095s/iter; left time: 1566.2084s
	iters: 200, epoch: 20 | loss: 0.0005859
	speed: 0.0670s/iter; left time: 332.3291s
	iters: 300, epoch: 20 | loss: 0.0033883
	speed: 0.0967s/iter; left time: 469.7736s
	iters: 400, epoch: 20 | loss: 0.0009405
	speed: 0.0831s/iter; left time: 395.5721s
Epoch: 20 cost time: 40.04670858383179
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.985420 --> -0.986563).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0159584
	speed: 0.3021s/iter; left time: 1386.8261s
	iters: 200, epoch: 21 | loss: 0.0012194
	speed: 0.0766s/iter; left time: 343.8992s
	iters: 300, epoch: 21 | loss: 0.0003015
	speed: 0.0830s/iter; left time: 364.4894s
	iters: 400, epoch: 21 | loss: 0.0013645
	speed: 0.0846s/iter; left time: 362.9766s
Epoch: 21 cost time: 37.66715884208679
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0027212
	speed: 0.2615s/iter; left time: 1078.0532s
	iters: 200, epoch: 22 | loss: 0.0002890
	speed: 0.0464s/iter; left time: 186.4555s
	iters: 300, epoch: 22 | loss: 0.0018578
	speed: 0.1146s/iter; left time: 449.3016s
	iters: 400, epoch: 22 | loss: 0.0013029
	speed: 0.1365s/iter; left time: 521.8734s
Epoch: 22 cost time: 44.18464255332947
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0010067
	speed: 0.4542s/iter; left time: 1659.2475s
	iters: 200, epoch: 23 | loss: 0.0037678
	speed: 0.1342s/iter; left time: 476.7119s
	iters: 300, epoch: 23 | loss: 0.0040791
	speed: 0.1226s/iter; left time: 423.4910s
	iters: 400, epoch: 23 | loss: 0.0007947
	speed: 0.1113s/iter; left time: 373.2799s
Epoch: 23 cost time: 58.626282691955566
Epoch: 23, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0025266
	speed: 0.5094s/iter; left time: 1622.0142s
	iters: 200, epoch: 24 | loss: 0.0002394
	speed: 0.1922s/iter; left time: 592.7599s
	iters: 300, epoch: 24 | loss: 0.0015686
	speed: 0.1504s/iter; left time: 448.8372s
	iters: 400, epoch: 24 | loss: 0.0017176
	speed: 0.1381s/iter; left time: 398.1874s
Epoch: 24 cost time: 77.41643190383911
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0005736
	speed: 0.5538s/iter; left time: 1503.4876s
	iters: 200, epoch: 25 | loss: 0.0194210
	speed: 0.1642s/iter; left time: 429.3933s
	iters: 300, epoch: 25 | loss: 0.0007014
	speed: 0.1623s/iter; left time: 408.1733s
	iters: 400, epoch: 25 | loss: 0.0010381
	speed: 0.1750s/iter; left time: 422.6454s
Epoch: 25 cost time: 81.01744198799133
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0592775
	speed: 0.5210s/iter; left time: 1170.1756s
	iters: 200, epoch: 26 | loss: 0.0008087
	speed: 0.1668s/iter; left time: 357.8939s
	iters: 300, epoch: 26 | loss: 0.0003355
	speed: 0.1906s/iter; left time: 389.9412s
	iters: 400, epoch: 26 | loss: 0.0130354
	speed: 0.1937s/iter; left time: 376.8495s
Epoch: 26 cost time: 80.06477737426758
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0007632
	speed: 0.5341s/iter; left time: 949.1002s
	iters: 200, epoch: 27 | loss: 0.0014641
	speed: 0.1756s/iter; left time: 294.5647s
	iters: 300, epoch: 27 | loss: 0.0031713
	speed: 0.1609s/iter; left time: 253.7036s
	iters: 400, epoch: 27 | loss: 0.0002440
	speed: 0.1631s/iter; left time: 240.9504s
Epoch: 27 cost time: 76.62599325180054
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0321527
	speed: 0.5823s/iter; left time: 761.6241s
	iters: 200, epoch: 28 | loss: 0.0128995
	speed: 0.1664s/iter; left time: 201.0573s
	iters: 300, epoch: 28 | loss: 0.0002897
	speed: 0.1433s/iter; left time: 158.7235s
	iters: 400, epoch: 28 | loss: 0.0177826
	speed: 0.1525s/iter; left time: 153.6742s
Epoch: 28 cost time: 76.40954160690308
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0092531
	speed: 0.5949s/iter; left time: 499.1273s
	iters: 200, epoch: 29 | loss: 0.0141449
	speed: 0.1664s/iter; left time: 122.9890s
	iters: 300, epoch: 29 | loss: 0.0001547
	speed: 0.1579s/iter; left time: 100.9118s
	iters: 400, epoch: 29 | loss: 0.0004617
	speed: 0.1804s/iter; left time: 97.2288s
Epoch: 29 cost time: 79.87440276145935
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0001501
	speed: 0.5393s/iter; left time: 199.5557s
	iters: 200, epoch: 30 | loss: 0.0377820
	speed: 0.1720s/iter; left time: 46.4439s
	iters: 300, epoch: 30 | loss: 0.0000686
	speed: 0.1915s/iter; left time: 32.5505s
	iters: 400, epoch: 30 | loss: 0.0004360
	speed: 0.1850s/iter; left time: 12.9522s
Epoch: 30 cost time: 81.8227231502533
Epoch: 30, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 346314
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8622539
	speed: 0.2077s/iter; left time: 2901.1108s
	iters: 200, epoch: 1 | loss: 1.0480274
	speed: 0.1660s/iter; left time: 2302.9730s
	iters: 300, epoch: 1 | loss: 0.4838860
	speed: 0.1645s/iter; left time: 2265.3245s
	iters: 400, epoch: 1 | loss: 0.2528079
	speed: 0.1712s/iter; left time: 2340.8390s
Epoch: 1 cost time: 83.83591556549072
Epoch: 1, Steps: 469 | Train Loss: 1.148 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
Validation loss decreased (inf --> -0.894222).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2123476
	speed: 0.5438s/iter; left time: 7342.7778s
	iters: 200, epoch: 2 | loss: 0.2098695
	speed: 0.1461s/iter; left time: 1957.9609s
	iters: 300, epoch: 2 | loss: 0.2507933
	speed: 0.1726s/iter; left time: 2296.5581s
	iters: 400, epoch: 2 | loss: 0.0705414
	speed: 0.1886s/iter; left time: 2489.5417s
Epoch: 2 cost time: 78.27505803108215
Epoch: 2, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.164 Vali Acc: 0.947 Test Loss: 0.164 Test Acc: 0.947
Validation loss decreased (-0.894222 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0378881
	speed: 0.5386s/iter; left time: 7020.1689s
	iters: 200, epoch: 3 | loss: 0.0244260
	speed: 0.1635s/iter; left time: 2115.1473s
	iters: 300, epoch: 3 | loss: 0.0337972
	speed: 0.1746s/iter; left time: 2240.7963s
	iters: 400, epoch: 3 | loss: 0.1256804
	speed: 0.1738s/iter; left time: 2212.5901s
Epoch: 3 cost time: 77.72514367103577
Epoch: 3, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.946825 --> -0.969410).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0095685
	speed: 0.5766s/iter; left time: 7244.1333s
	iters: 200, epoch: 4 | loss: 0.0251305
	speed: 0.1828s/iter; left time: 2278.1911s
	iters: 300, epoch: 4 | loss: 0.0179481
	speed: 0.1365s/iter; left time: 1687.4764s
	iters: 400, epoch: 4 | loss: 0.0472463
	speed: 0.1407s/iter; left time: 1726.0421s
Epoch: 4 cost time: 75.64308786392212
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.969410 --> -0.975128).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0618630
	speed: 0.4781s/iter; left time: 5783.2077s
	iters: 200, epoch: 5 | loss: 0.2109372
	speed: 0.1694s/iter; left time: 2032.5472s
	iters: 300, epoch: 5 | loss: 0.0075840
	speed: 0.1554s/iter; left time: 1848.9999s
	iters: 400, epoch: 5 | loss: 0.0088050
	speed: 0.1267s/iter; left time: 1494.6286s
Epoch: 5 cost time: 67.12467551231384
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0347188
	speed: 0.4741s/iter; left time: 5512.4620s
	iters: 200, epoch: 6 | loss: 0.0190177
	speed: 0.1487s/iter; left time: 1714.1337s
	iters: 300, epoch: 6 | loss: 0.0059447
	speed: 0.1588s/iter; left time: 1814.2277s
	iters: 400, epoch: 6 | loss: 0.0893398
	speed: 0.1708s/iter; left time: 1934.0265s
Epoch: 6 cost time: 72.141685962677
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.975128 --> -0.979130).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0129024
	speed: 0.4755s/iter; left time: 5305.0983s
	iters: 200, epoch: 7 | loss: 0.0317270
	speed: 0.1417s/iter; left time: 1566.8840s
	iters: 300, epoch: 7 | loss: 0.0043389
	speed: 0.1440s/iter; left time: 1577.6436s
	iters: 400, epoch: 7 | loss: 0.0142351
	speed: 0.1452s/iter; left time: 1576.7056s
Epoch: 7 cost time: 68.94331955909729
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0930601
	speed: 0.4985s/iter; left time: 5327.9664s
	iters: 200, epoch: 8 | loss: 0.0065597
	speed: 0.1182s/iter; left time: 1251.0572s
	iters: 300, epoch: 8 | loss: 0.0019809
	speed: 0.1512s/iter; left time: 1586.2974s
	iters: 400, epoch: 8 | loss: 0.1133964
	speed: 0.1407s/iter; left time: 1461.2512s
Epoch: 8 cost time: 64.08216118812561
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0110878
	speed: 0.5141s/iter; left time: 5253.5576s
	iters: 200, epoch: 9 | loss: 0.0684860
	speed: 0.1417s/iter; left time: 1433.7695s
	iters: 300, epoch: 9 | loss: 0.0887979
	speed: 0.1264s/iter; left time: 1266.8335s
	iters: 400, epoch: 9 | loss: 0.0040608
	speed: 0.1317s/iter; left time: 1306.0406s
Epoch: 9 cost time: 67.74025106430054
Epoch: 9, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0292610
	speed: 0.4866s/iter; left time: 4744.6475s
	iters: 200, epoch: 10 | loss: 0.0017584
	speed: 0.1621s/iter; left time: 1564.2892s
	iters: 300, epoch: 10 | loss: 0.0007623
	speed: 0.1605s/iter; left time: 1532.7405s
	iters: 400, epoch: 10 | loss: 0.0019820
	speed: 0.1268s/iter; left time: 1198.3034s
Epoch: 10 cost time: 68.18771648406982
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0474309
	speed: 0.4399s/iter; left time: 4082.8446s
	iters: 200, epoch: 11 | loss: 0.0060912
	speed: 0.1441s/iter; left time: 1322.6228s
	iters: 300, epoch: 11 | loss: 0.0028565
	speed: 0.1492s/iter; left time: 1354.7784s
	iters: 400, epoch: 11 | loss: 0.0037944
	speed: 0.1684s/iter; left time: 1512.6362s
Epoch: 11 cost time: 69.60198259353638
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0028490
	speed: 0.4710s/iter; left time: 4150.1336s
	iters: 200, epoch: 12 | loss: 0.0006999
	speed: 0.1569s/iter; left time: 1366.8724s
	iters: 300, epoch: 12 | loss: 0.0013141
	speed: 0.1380s/iter; left time: 1188.3454s
	iters: 400, epoch: 12 | loss: 0.0010570
	speed: 0.1474s/iter; left time: 1255.0487s
Epoch: 12 cost time: 67.93282413482666
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0036826
	speed: 0.5053s/iter; left time: 4215.8033s
	iters: 200, epoch: 13 | loss: 0.0458350
	speed: 0.1265s/iter; left time: 1042.5211s
	iters: 300, epoch: 13 | loss: 0.0772530
	speed: 0.1335s/iter; left time: 1087.3172s
	iters: 400, epoch: 13 | loss: 0.0076483
	speed: 0.1456s/iter; left time: 1170.6650s
Epoch: 13 cost time: 63.204888582229614
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0003015
	speed: 0.4994s/iter; left time: 3932.0591s
	iters: 200, epoch: 14 | loss: 0.0011573
	speed: 0.1607s/iter; left time: 1249.4408s
	iters: 300, epoch: 14 | loss: 0.0004211
	speed: 0.1354s/iter; left time: 1038.8194s
	iters: 400, epoch: 14 | loss: 0.1041721
	speed: 0.1279s/iter; left time: 968.4180s
Epoch: 14 cost time: 69.8617889881134
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1817219
	speed: 0.4849s/iter; left time: 3590.5868s
	iters: 200, epoch: 15 | loss: 0.0001787
	speed: 0.1558s/iter; left time: 1138.3557s
	iters: 300, epoch: 15 | loss: 0.0046856
	speed: 0.1718s/iter; left time: 1238.1339s
	iters: 400, epoch: 15 | loss: 0.0009540
	speed: 0.1525s/iter; left time: 1083.8220s
Epoch: 15 cost time: 71.57411932945251
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0011497
	speed: 0.4652s/iter; left time: 3226.5037s
	iters: 200, epoch: 16 | loss: 0.0054610
	speed: 0.1320s/iter; left time: 902.1741s
	iters: 300, epoch: 16 | loss: 0.0038831
	speed: 0.1432s/iter; left time: 964.4112s
	iters: 400, epoch: 16 | loss: 0.0044435
	speed: 0.1610s/iter; left time: 1068.1562s
Epoch: 16 cost time: 70.39637804031372
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979416).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0597845
	speed: 0.4856s/iter; left time: 3140.0707s
	iters: 200, epoch: 17 | loss: 0.0014760
	speed: 0.1481s/iter; left time: 942.6607s
	iters: 300, epoch: 17 | loss: 0.2639568
	speed: 0.1445s/iter; left time: 905.8753s
	iters: 400, epoch: 17 | loss: 0.0004391
	speed: 0.1463s/iter; left time: 902.1655s
Epoch: 17 cost time: 67.62636184692383
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0010890
	speed: 0.4852s/iter; left time: 2910.3479s
	iters: 200, epoch: 18 | loss: 0.0056712
	speed: 0.1753s/iter; left time: 1033.7929s
	iters: 300, epoch: 18 | loss: 0.0002186
	speed: 0.1401s/iter; left time: 812.4034s
	iters: 400, epoch: 18 | loss: 0.0001691
	speed: 0.1354s/iter; left time: 771.7071s
Epoch: 18 cost time: 69.61609888076782
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0048298
	speed: 0.5477s/iter; left time: 3028.2549s
	iters: 200, epoch: 19 | loss: 0.0006941
	speed: 0.1562s/iter; left time: 848.1014s
	iters: 300, epoch: 19 | loss: 0.0030311
	speed: 0.1608s/iter; left time: 857.1496s
	iters: 400, epoch: 19 | loss: 0.0025659
	speed: 0.1691s/iter; left time: 884.2989s
Epoch: 19 cost time: 76.37409234046936
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0020616
	speed: 0.5166s/iter; left time: 2614.2294s
	iters: 200, epoch: 20 | loss: 0.0010824
	speed: 0.1887s/iter; left time: 936.1293s
	iters: 300, epoch: 20 | loss: 0.0005766
	speed: 0.1702s/iter; left time: 827.3664s
	iters: 400, epoch: 20 | loss: 0.0001491
	speed: 0.1598s/iter; left time: 760.5584s
Epoch: 20 cost time: 79.80163073539734
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979416 --> -0.983418).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0002268
	speed: 0.5237s/iter; left time: 2404.4078s
	iters: 200, epoch: 21 | loss: 0.0034778
	speed: 0.1325s/iter; left time: 595.2424s
	iters: 300, epoch: 21 | loss: 0.0006381
	speed: 0.1658s/iter; left time: 728.0403s
	iters: 400, epoch: 21 | loss: 0.0012087
	speed: 0.1840s/iter; left time: 789.5676s
Epoch: 21 cost time: 74.3980450630188
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0001707
	speed: 0.5309s/iter; left time: 2188.5585s
	iters: 200, epoch: 22 | loss: 0.0018577
	speed: 0.1654s/iter; left time: 665.1727s
	iters: 300, epoch: 22 | loss: 0.0003084
	speed: 0.1512s/iter; left time: 593.1903s
	iters: 400, epoch: 22 | loss: 0.0007274
	speed: 0.1430s/iter; left time: 546.6629s
Epoch: 22 cost time: 72.75813484191895
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0013384
	speed: 0.5775s/iter; left time: 2109.4623s
	iters: 200, epoch: 23 | loss: 0.0023066
	speed: 0.1566s/iter; left time: 556.4646s
	iters: 300, epoch: 23 | loss: 0.0021926
	speed: 0.1580s/iter; left time: 545.6037s
	iters: 400, epoch: 23 | loss: 0.0036018
	speed: 0.1631s/iter; left time: 547.0205s
Epoch: 23 cost time: 74.86031103134155
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0009535
	speed: 0.4425s/iter; left time: 1408.8262s
	iters: 200, epoch: 24 | loss: 0.0013113
	speed: 0.0510s/iter; left time: 157.3866s
	iters: 300, epoch: 24 | loss: 0.0001181
	speed: 0.0936s/iter; left time: 279.4256s
	iters: 400, epoch: 24 | loss: 0.0005691
	speed: 0.1457s/iter; left time: 420.0968s
Epoch: 24 cost time: 48.64282441139221
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0012142
	speed: 0.4795s/iter; left time: 1301.9584s
	iters: 200, epoch: 25 | loss: 0.0005181
	speed: 0.1436s/iter; left time: 375.5557s
	iters: 300, epoch: 25 | loss: 0.0008117
	speed: 0.1121s/iter; left time: 281.9112s
	iters: 400, epoch: 25 | loss: 0.0398390
	speed: 0.1314s/iter; left time: 317.3342s
Epoch: 25 cost time: 67.86545872688293
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0027860
	speed: 0.4775s/iter; left time: 1072.4772s
	iters: 200, epoch: 26 | loss: 0.3130583
	speed: 0.1468s/iter; left time: 315.1301s
	iters: 300, epoch: 26 | loss: 0.2239567
	speed: 0.1778s/iter; left time: 363.8077s
	iters: 400, epoch: 26 | loss: 0.0004159
	speed: 0.1256s/iter; left time: 244.4532s
Epoch: 26 cost time: 63.98892402648926
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0901840
	speed: 0.4748s/iter; left time: 843.6826s
	iters: 200, epoch: 27 | loss: 0.0006131
	speed: 0.1134s/iter; left time: 190.2080s
	iters: 300, epoch: 27 | loss: 0.0012698
	speed: 0.1153s/iter; left time: 181.7524s
	iters: 400, epoch: 27 | loss: 0.0000741
	speed: 0.1438s/iter; left time: 212.4246s
Epoch: 27 cost time: 62.54152822494507
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0003985
	speed: 0.4088s/iter; left time: 534.6638s
	iters: 200, epoch: 28 | loss: 0.0007652
	speed: 0.1267s/iter; left time: 153.0862s
	iters: 300, epoch: 28 | loss: 0.0016247
	speed: 0.0926s/iter; left time: 102.6066s
	iters: 400, epoch: 28 | loss: 0.0049447
	speed: 0.1073s/iter; left time: 108.1180s
Epoch: 28 cost time: 58.47837996482849
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0021464
	speed: 0.4110s/iter; left time: 344.8031s
	iters: 200, epoch: 29 | loss: 0.0131395
	speed: 0.1495s/iter; left time: 110.4847s
	iters: 300, epoch: 29 | loss: 0.0670254
	speed: 0.1229s/iter; left time: 78.5163s
	iters: 400, epoch: 29 | loss: 0.0126635
	speed: 0.0970s/iter; left time: 52.2892s
Epoch: 29 cost time: 54.37174105644226
Epoch: 29, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0073065
	speed: 0.4092s/iter; left time: 151.4099s
	iters: 200, epoch: 30 | loss: 0.0013017
	speed: 0.0980s/iter; left time: 26.4666s
	iters: 300, epoch: 30 | loss: 0.0005023
	speed: 0.1374s/iter; left time: 23.3572s
	iters: 400, epoch: 30 | loss: 0.0131073
	speed: 0.1268s/iter; left time: 8.8732s
Epoch: 30 cost time: 53.11577796936035
Epoch: 30, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 1174090
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9089959
	speed: 0.0902s/iter; left time: 1260.8137s
	iters: 200, epoch: 1 | loss: 1.5693361
	speed: 0.0867s/iter; left time: 1202.9277s
	iters: 300, epoch: 1 | loss: 0.7432101
	speed: 0.0877s/iter; left time: 1207.9029s
	iters: 400, epoch: 1 | loss: 0.5993410
	speed: 0.0903s/iter; left time: 1234.9072s
Epoch: 1 cost time: 41.67877388000488
Epoch: 1, Steps: 469 | Train Loss: 1.224 Vali Loss: 0.434 Vali Acc: 0.895 Test Loss: 0.434 Test Acc: 0.895
Validation loss decreased (inf --> -0.894507).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2443437
	speed: 0.3355s/iter; left time: 4529.8885s
	iters: 200, epoch: 2 | loss: 0.3848332
	speed: 0.0904s/iter; left time: 1211.2958s
	iters: 300, epoch: 2 | loss: 0.1681817
	speed: 0.0886s/iter; left time: 1178.3199s
	iters: 400, epoch: 2 | loss: 0.1469373
	speed: 0.0736s/iter; left time: 972.1342s
Epoch: 2 cost time: 39.754016160964966
Epoch: 2, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.894507 --> -0.957403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1890681
	speed: 0.3555s/iter; left time: 4633.5962s
	iters: 200, epoch: 3 | loss: 0.0766894
	speed: 0.0765s/iter; left time: 989.5380s
	iters: 300, epoch: 3 | loss: 0.0826629
	speed: 0.0872s/iter; left time: 1118.4492s
	iters: 400, epoch: 3 | loss: 0.0435893
	speed: 0.0822s/iter; left time: 1047.1747s
Epoch: 3 cost time: 39.15512681007385
Epoch: 3, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
Validation loss decreased (-0.957403 --> -0.962835).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0900430
	speed: 0.1648s/iter; left time: 2069.9737s
	iters: 200, epoch: 4 | loss: 0.0082390
	speed: 0.0554s/iter; left time: 689.9087s
	iters: 300, epoch: 4 | loss: 0.0150951
	speed: 0.1032s/iter; left time: 1275.9920s
	iters: 400, epoch: 4 | loss: 0.0073360
	speed: 0.0926s/iter; left time: 1135.3203s
Epoch: 4 cost time: 34.79171133041382
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.962835 --> -0.969410).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3795922
	speed: 0.3761s/iter; left time: 4549.4573s
	iters: 200, epoch: 5 | loss: 0.0725969
	speed: 0.0739s/iter; left time: 885.8894s
	iters: 300, epoch: 5 | loss: 0.1233681
	speed: 0.0781s/iter; left time: 928.5975s
	iters: 400, epoch: 5 | loss: 0.1445286
	speed: 0.0867s/iter; left time: 1023.1493s
Epoch: 5 cost time: 40.69441604614258
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.973126).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0168588
	speed: 0.3999s/iter; left time: 4649.1851s
	iters: 200, epoch: 6 | loss: 0.0042429
	speed: 0.0858s/iter; left time: 988.5568s
	iters: 300, epoch: 6 | loss: 0.0390022
	speed: 0.0922s/iter; left time: 1053.4863s
	iters: 400, epoch: 6 | loss: 0.0032785
	speed: 0.0975s/iter; left time: 1104.4681s
Epoch: 6 cost time: 41.549434185028076
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973126 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0109975
	speed: 0.3822s/iter; left time: 4264.2169s
	iters: 200, epoch: 7 | loss: 0.0940384
	speed: 0.1035s/iter; left time: 1144.2281s
	iters: 300, epoch: 7 | loss: 0.0058209
	speed: 0.0892s/iter; left time: 977.5704s
	iters: 400, epoch: 7 | loss: 0.0092643
	speed: 0.0865s/iter; left time: 938.6689s
Epoch: 7 cost time: 44.48654007911682
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.973412 --> -0.981703).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0140071
	speed: 0.3472s/iter; left time: 3711.0206s
	iters: 200, epoch: 8 | loss: 0.0019523
	speed: 0.0945s/iter; left time: 1000.4797s
	iters: 300, epoch: 8 | loss: 0.0141291
	speed: 0.0955s/iter; left time: 1001.2470s
	iters: 400, epoch: 8 | loss: 0.0051360
	speed: 0.1064s/iter; left time: 1104.8035s
Epoch: 8 cost time: 46.35868191719055
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0255252
	speed: 0.3475s/iter; left time: 3551.1478s
	iters: 200, epoch: 9 | loss: 0.0012766
	speed: 0.0904s/iter; left time: 914.4575s
	iters: 300, epoch: 9 | loss: 0.0466136
	speed: 0.1044s/iter; left time: 1045.7161s
	iters: 400, epoch: 9 | loss: 0.0682965
	speed: 0.0923s/iter; left time: 915.8417s
Epoch: 9 cost time: 43.14574670791626
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2171285
	speed: 0.3752s/iter; left time: 3658.5691s
	iters: 200, epoch: 10 | loss: 0.0063477
	speed: 0.0857s/iter; left time: 826.9838s
	iters: 300, epoch: 10 | loss: 0.0020773
	speed: 0.0797s/iter; left time: 761.3742s
	iters: 400, epoch: 10 | loss: 0.0026004
	speed: 0.0960s/iter; left time: 906.9744s
Epoch: 10 cost time: 42.73992562294006
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0012356
	speed: 0.4015s/iter; left time: 3726.0773s
	iters: 200, epoch: 11 | loss: 0.1188372
	speed: 0.0881s/iter; left time: 808.6339s
	iters: 300, epoch: 11 | loss: 0.0078640
	speed: 0.0923s/iter; left time: 837.9879s
	iters: 400, epoch: 11 | loss: 0.0014486
	speed: 0.0969s/iter; left time: 870.3858s
Epoch: 11 cost time: 42.280638694763184
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982561).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008126
	speed: 0.3954s/iter; left time: 3484.1618s
	iters: 200, epoch: 12 | loss: 0.0216504
	speed: 0.0996s/iter; left time: 867.9117s
	iters: 300, epoch: 12 | loss: 0.0005912
	speed: 0.0856s/iter; left time: 736.8075s
	iters: 400, epoch: 12 | loss: 0.0279752
	speed: 0.0772s/iter; left time: 657.1381s
Epoch: 12 cost time: 43.20897650718689
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0003578
	speed: 0.3837s/iter; left time: 3201.2086s
	iters: 200, epoch: 13 | loss: 0.0068638
	speed: 0.0919s/iter; left time: 757.2623s
	iters: 300, epoch: 13 | loss: 0.0035977
	speed: 0.0974s/iter; left time: 792.8962s
	iters: 400, epoch: 13 | loss: 0.0138639
	speed: 0.1033s/iter; left time: 830.8683s
Epoch: 13 cost time: 45.62327742576599
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0326123
	speed: 0.3495s/iter; left time: 2751.7096s
	iters: 200, epoch: 14 | loss: 0.0052021
	speed: 0.0955s/iter; left time: 742.5175s
	iters: 300, epoch: 14 | loss: 0.0002935
	speed: 0.0808s/iter; left time: 620.3773s
	iters: 400, epoch: 14 | loss: 0.1141617
	speed: 0.1034s/iter; left time: 783.0685s
Epoch: 14 cost time: 44.95633411407471
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0019200
	speed: 0.4073s/iter; left time: 3015.6994s
	iters: 200, epoch: 15 | loss: 0.1263998
	speed: 0.1038s/iter; left time: 758.2605s
	iters: 300, epoch: 15 | loss: 0.0016258
	speed: 0.1183s/iter; left time: 852.0041s
	iters: 400, epoch: 15 | loss: 0.0014611
	speed: 0.1034s/iter; left time: 734.8062s
Epoch: 15 cost time: 49.24152874946594
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0016681
	speed: 0.4308s/iter; left time: 2987.9507s
	iters: 200, epoch: 16 | loss: 0.0906938
	speed: 0.0856s/iter; left time: 584.8904s
	iters: 300, epoch: 16 | loss: 0.0014712
	speed: 0.0907s/iter; left time: 611.2672s
	iters: 400, epoch: 16 | loss: 0.0235498
	speed: 0.0953s/iter; left time: 632.3413s
Epoch: 16 cost time: 45.829646825790405
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0002493
	speed: 0.4322s/iter; left time: 2794.9153s
	iters: 200, epoch: 17 | loss: 0.0020262
	speed: 0.1032s/iter; left time: 657.2798s
	iters: 300, epoch: 17 | loss: 0.0015725
	speed: 0.1069s/iter; left time: 669.9540s
	iters: 400, epoch: 17 | loss: 0.0026766
	speed: 0.0883s/iter; left time: 544.5440s
Epoch: 17 cost time: 46.42343592643738
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0164969
	speed: 0.4257s/iter; left time: 2553.4518s
	iters: 200, epoch: 18 | loss: 0.0538969
	speed: 0.1011s/iter; left time: 596.4293s
	iters: 300, epoch: 18 | loss: 0.0049283
	speed: 0.0976s/iter; left time: 565.8538s
	iters: 400, epoch: 18 | loss: 0.0910928
	speed: 0.0952s/iter; left time: 542.6200s
Epoch: 18 cost time: 49.07509732246399
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982847).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0087302
	speed: 0.3983s/iter; left time: 2201.9663s
	iters: 200, epoch: 19 | loss: 0.0110902
	speed: 0.1102s/iter; left time: 598.4678s
	iters: 300, epoch: 19 | loss: 0.0019998
	speed: 0.1183s/iter; left time: 630.5420s
	iters: 400, epoch: 19 | loss: 0.0092929
	speed: 0.1061s/iter; left time: 555.0508s
Epoch: 19 cost time: 50.400922775268555
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
Validation loss decreased (-0.982847 --> -0.984562).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0014877
	speed: 0.3955s/iter; left time: 2001.0367s
	iters: 200, epoch: 20 | loss: 0.0024942
	speed: 0.0893s/iter; left time: 442.9800s
	iters: 300, epoch: 20 | loss: 0.0164113
	speed: 0.0975s/iter; left time: 473.6225s
	iters: 400, epoch: 20 | loss: 0.0020216
	speed: 0.0995s/iter; left time: 473.4355s
Epoch: 20 cost time: 47.38566064834595
Epoch: 20, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3977517
	speed: 0.4067s/iter; left time: 1867.2226s
	iters: 200, epoch: 21 | loss: 0.0229088
	speed: 0.0956s/iter; left time: 429.3781s
	iters: 300, epoch: 21 | loss: 0.0004376
	speed: 0.0972s/iter; left time: 426.7365s
	iters: 400, epoch: 21 | loss: 0.0048851
	speed: 0.0979s/iter; left time: 420.0150s
Epoch: 21 cost time: 43.561660051345825
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1872887
	speed: 0.1862s/iter; left time: 767.3947s
	iters: 200, epoch: 22 | loss: 0.0031657
	speed: 0.0988s/iter; left time: 397.3404s
	iters: 300, epoch: 22 | loss: 0.0001642
	speed: 0.0805s/iter; left time: 315.8877s
	iters: 400, epoch: 22 | loss: 0.0004503
	speed: 0.0643s/iter; left time: 245.6861s
Epoch: 22 cost time: 34.03900504112244
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0002575
	speed: 0.3415s/iter; left time: 1247.4918s
	iters: 200, epoch: 23 | loss: 0.0117520
	speed: 0.0701s/iter; left time: 249.1818s
	iters: 300, epoch: 23 | loss: 0.0007040
	speed: 0.0948s/iter; left time: 327.3899s
	iters: 400, epoch: 23 | loss: 0.0004273
	speed: 0.1057s/iter; left time: 354.3354s
Epoch: 23 cost time: 39.40998649597168
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0021338
	speed: 0.3401s/iter; left time: 1082.9731s
	iters: 200, epoch: 24 | loss: 0.0020715
	speed: 0.0887s/iter; left time: 273.6864s
	iters: 300, epoch: 24 | loss: 0.0095513
	speed: 0.0670s/iter; left time: 199.8246s
	iters: 400, epoch: 24 | loss: 0.0015406
	speed: 0.0828s/iter; left time: 238.8044s
Epoch: 24 cost time: 40.77560591697693
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0035505
	speed: 0.3525s/iter; left time: 957.0746s
	iters: 200, epoch: 25 | loss: 0.0051173
	speed: 0.0895s/iter; left time: 234.1176s
	iters: 300, epoch: 25 | loss: 0.0003592
	speed: 0.0733s/iter; left time: 184.3266s
	iters: 400, epoch: 25 | loss: 0.0014056
	speed: 0.0742s/iter; left time: 179.0990s
Epoch: 25 cost time: 36.65151047706604
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0005319
	speed: 0.3035s/iter; left time: 681.7203s
	iters: 200, epoch: 26 | loss: 0.0008272
	speed: 0.0721s/iter; left time: 154.6715s
	iters: 300, epoch: 26 | loss: 0.0003363
	speed: 0.0872s/iter; left time: 178.3880s
	iters: 400, epoch: 26 | loss: 0.0275542
	speed: 0.0796s/iter; left time: 154.9555s
Epoch: 26 cost time: 35.86207723617554
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0054012
	speed: 0.3170s/iter; left time: 563.3959s
	iters: 200, epoch: 27 | loss: 0.0194282
	speed: 0.0648s/iter; left time: 108.7049s
	iters: 300, epoch: 27 | loss: 0.0065038
	speed: 0.0715s/iter; left time: 112.7521s
	iters: 400, epoch: 27 | loss: 0.0003694
	speed: 0.0890s/iter; left time: 131.4786s
Epoch: 27 cost time: 37.11457347869873
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1033732
	speed: 0.3253s/iter; left time: 425.4422s
	iters: 200, epoch: 28 | loss: 0.0270100
	speed: 0.0883s/iter; left time: 106.7117s
	iters: 300, epoch: 28 | loss: 0.0002558
	speed: 0.0673s/iter; left time: 74.5482s
	iters: 400, epoch: 28 | loss: 0.1255759
	speed: 0.0662s/iter; left time: 66.7184s
Epoch: 28 cost time: 38.00245404243469
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0010692
	speed: 0.3224s/iter; left time: 270.4536s
	iters: 200, epoch: 29 | loss: 0.0042068
	speed: 0.0954s/iter; left time: 70.4891s
	iters: 300, epoch: 29 | loss: 0.0002208
	speed: 0.0871s/iter; left time: 55.6714s
	iters: 400, epoch: 29 | loss: 0.0002425
	speed: 0.0664s/iter; left time: 35.8072s
Epoch: 29 cost time: 36.592642068862915
Epoch: 29, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 346314
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7683723
	speed: 0.2406s/iter; left time: 3361.9224s
	iters: 200, epoch: 1 | loss: 1.0542146
	speed: 0.2461s/iter; left time: 3413.8538s
	iters: 300, epoch: 1 | loss: 0.6293664
	speed: 0.2051s/iter; left time: 2824.4462s
	iters: 400, epoch: 1 | loss: 0.2124502
	speed: 0.2033s/iter; left time: 2779.6725s
Epoch: 1 cost time: 101.23384547233582
Epoch: 1, Steps: 469 | Train Loss: 1.063 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (inf --> -0.910517).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1853661
	speed: 0.5387s/iter; left time: 7273.8462s
	iters: 200, epoch: 2 | loss: 0.1372653
	speed: 0.2485s/iter; left time: 3329.8154s
	iters: 300, epoch: 2 | loss: 0.0441871
	speed: 0.2086s/iter; left time: 2775.2321s
	iters: 400, epoch: 2 | loss: 0.0235705
	speed: 0.3191s/iter; left time: 4213.2436s
Epoch: 2 cost time: 128.5931921005249
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
Validation loss decreased (-0.910517 --> -0.953400).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3114972
	speed: 0.8587s/iter; left time: 11191.4563s
	iters: 200, epoch: 3 | loss: 0.0299010
	speed: 0.3839s/iter; left time: 4964.6206s
	iters: 300, epoch: 3 | loss: 0.0820058
	speed: 0.3413s/iter; left time: 4380.5248s
	iters: 400, epoch: 3 | loss: 0.1873197
	speed: 0.3476s/iter; left time: 4425.6636s
Epoch: 3 cost time: 167.50437307357788
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
Validation loss decreased (-0.953400 --> -0.962549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0449030
	speed: 0.9169s/iter; left time: 11519.6779s
	iters: 200, epoch: 4 | loss: 0.0051026
	speed: 0.4275s/iter; left time: 5327.9102s
	iters: 300, epoch: 4 | loss: 0.0107315
	speed: 0.2878s/iter; left time: 3558.3462s
	iters: 400, epoch: 4 | loss: 0.1241421
	speed: 0.3693s/iter; left time: 4529.4589s
Epoch: 4 cost time: 170.97906732559204
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.962549 --> -0.976557).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1812993
	speed: 0.9581s/iter; left time: 11588.8167s
	iters: 200, epoch: 5 | loss: 0.0163854
	speed: 0.3942s/iter; left time: 4728.2981s
	iters: 300, epoch: 5 | loss: 0.0057143
	speed: 0.3139s/iter; left time: 3734.1953s
	iters: 400, epoch: 5 | loss: 0.2475021
	speed: 0.3964s/iter; left time: 4675.8651s
Epoch: 5 cost time: 174.75001740455627
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977987).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0225243
	speed: 0.8817s/iter; left time: 10250.9875s
	iters: 200, epoch: 6 | loss: 0.0079946
	speed: 0.4215s/iter; left time: 4858.1410s
	iters: 300, epoch: 6 | loss: 0.0017756
	speed: 0.3614s/iter; left time: 4129.6389s
	iters: 400, epoch: 6 | loss: 0.2334433
	speed: 0.3497s/iter; left time: 3961.0607s
Epoch: 6 cost time: 174.73899126052856
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1801939
	speed: 0.9402s/iter; left time: 10489.5610s
	iters: 200, epoch: 7 | loss: 0.0206338
	speed: 0.4274s/iter; left time: 4725.3357s
	iters: 300, epoch: 7 | loss: 0.0154939
	speed: 0.3060s/iter; left time: 3353.3050s
	iters: 400, epoch: 7 | loss: 0.0047984
	speed: 0.3580s/iter; left time: 3886.8735s
Epoch: 7 cost time: 172.04359698295593
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2185572
	speed: 0.8237s/iter; left time: 8804.2357s
	iters: 200, epoch: 8 | loss: 0.0043701
	speed: 0.2672s/iter; left time: 2829.1094s
	iters: 300, epoch: 8 | loss: 0.1587369
	speed: 0.3070s/iter; left time: 3219.6726s
	iters: 400, epoch: 8 | loss: 0.0225923
	speed: 0.2229s/iter; left time: 2315.1389s
Epoch: 8 cost time: 120.8640079498291
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0028699
	speed: 0.7511s/iter; left time: 7675.6977s
	iters: 200, epoch: 9 | loss: 0.0035244
	speed: 0.2357s/iter; left time: 2384.8951s
	iters: 300, epoch: 9 | loss: 0.0570331
	speed: 0.3503s/iter; left time: 3509.5348s
	iters: 400, epoch: 9 | loss: 0.0036459
	speed: 0.2782s/iter; left time: 2759.8122s
Epoch: 9 cost time: 130.54985070228577
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.977987 --> -0.979130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0010128
	speed: 0.7926s/iter; left time: 7727.8249s
	iters: 200, epoch: 10 | loss: 0.1044861
	speed: 0.2374s/iter; left time: 2291.1526s
	iters: 300, epoch: 10 | loss: 0.0012438
	speed: 0.1526s/iter; left time: 1457.5340s
	iters: 400, epoch: 10 | loss: 0.0063960
	speed: 0.4555s/iter; left time: 4304.5169s
Epoch: 10 cost time: 139.6290247440338
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0233405
	speed: 0.9664s/iter; left time: 8968.9277s
	iters: 200, epoch: 11 | loss: 0.0011018
	speed: 0.3455s/iter; left time: 3172.1602s
	iters: 300, epoch: 11 | loss: 0.0184312
	speed: 0.4076s/iter; left time: 3701.5847s
	iters: 400, epoch: 11 | loss: 0.0014216
	speed: 0.4125s/iter; left time: 3704.9643s
Epoch: 11 cost time: 188.34184575080872
Epoch: 11, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0005353
	speed: 0.8304s/iter; left time: 7317.3806s
	iters: 200, epoch: 12 | loss: 0.0116991
	speed: 0.3852s/iter; left time: 3356.1829s
	iters: 300, epoch: 12 | loss: 0.0004894
	speed: 0.2587s/iter; left time: 2227.7720s
	iters: 400, epoch: 12 | loss: 0.0246147
	speed: 0.3978s/iter; left time: 3386.3610s
Epoch: 12 cost time: 150.29559588432312
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002174
	speed: 0.8366s/iter; left time: 6980.0801s
	iters: 200, epoch: 13 | loss: 0.0113813
	speed: 0.2759s/iter; left time: 2274.0411s
	iters: 300, epoch: 13 | loss: 0.0040791
	speed: 0.3659s/iter; left time: 2979.9131s
	iters: 400, epoch: 13 | loss: 0.0044189
	speed: 0.2520s/iter; left time: 2027.0467s
Epoch: 13 cost time: 153.1956331729889
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0014212
	speed: 0.8926s/iter; left time: 7028.2526s
	iters: 200, epoch: 14 | loss: 0.0021114
	speed: 0.3546s/iter; left time: 2756.3893s
	iters: 300, epoch: 14 | loss: 0.0014619
	speed: 0.3266s/iter; left time: 2506.0116s
	iters: 400, epoch: 14 | loss: 0.0032060
	speed: 0.3544s/iter; left time: 2683.9484s
Epoch: 14 cost time: 156.086332321167
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.979988).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0047184
	speed: 0.8168s/iter; left time: 6048.2570s
	iters: 200, epoch: 15 | loss: 0.0004277
	speed: 0.3606s/iter; left time: 2633.9433s
	iters: 300, epoch: 15 | loss: 0.0005491
	speed: 0.3189s/iter; left time: 2297.5859s
	iters: 400, epoch: 15 | loss: 0.0002583
	speed: 0.3519s/iter; left time: 2500.2221s
Epoch: 15 cost time: 157.4910168647766
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980845).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0047802
	speed: 0.8699s/iter; left time: 6033.4793s
	iters: 200, epoch: 16 | loss: 0.0006974
	speed: 0.3273s/iter; left time: 2237.2162s
	iters: 300, epoch: 16 | loss: 0.0001757
	speed: 0.3183s/iter; left time: 2143.8200s
	iters: 400, epoch: 16 | loss: 0.0015864
	speed: 0.3412s/iter; left time: 2264.1528s
Epoch: 16 cost time: 157.4264838695526
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0003972
	speed: 0.8925s/iter; left time: 5771.7214s
	iters: 200, epoch: 17 | loss: 0.0005854
	speed: 0.3128s/iter; left time: 1991.8750s
	iters: 300, epoch: 17 | loss: 0.0012471
	speed: 0.3697s/iter; left time: 2316.7028s
	iters: 400, epoch: 17 | loss: 0.0005556
	speed: 0.2991s/iter; left time: 1844.4153s
Epoch: 17 cost time: 161.1457715034485
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0052986
	speed: 0.8879s/iter; left time: 5325.8262s
	iters: 200, epoch: 18 | loss: 0.0071077
	speed: 0.3385s/iter; left time: 1996.2200s
	iters: 300, epoch: 18 | loss: 0.0002398
	speed: 0.3295s/iter; left time: 1910.5284s
	iters: 400, epoch: 18 | loss: 0.0006874
	speed: 0.3526s/iter; left time: 2008.9581s
Epoch: 18 cost time: 155.95397996902466
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0013884
	speed: 0.8086s/iter; left time: 4470.5010s
	iters: 200, epoch: 19 | loss: 0.0030402
	speed: 0.3285s/iter; left time: 1783.6050s
	iters: 300, epoch: 19 | loss: 0.0005288
	speed: 0.3171s/iter; left time: 1689.9831s
	iters: 400, epoch: 19 | loss: 0.0004640
	speed: 0.3099s/iter; left time: 1620.3882s
Epoch: 19 cost time: 152.56564474105835
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0007061
	speed: 0.8093s/iter; left time: 4094.9094s
	iters: 200, epoch: 20 | loss: 0.0008524
	speed: 0.3893s/iter; left time: 1930.9296s
	iters: 300, epoch: 20 | loss: 0.0002167
	speed: 0.3358s/iter; left time: 1632.0099s
	iters: 400, epoch: 20 | loss: 0.0002192
	speed: 0.3856s/iter; left time: 1835.5057s
Epoch: 20 cost time: 161.17892169952393
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0005064
	speed: 0.9090s/iter; left time: 4173.1694s
	iters: 200, epoch: 21 | loss: 0.0019830
	speed: 0.3451s/iter; left time: 1549.8317s
	iters: 300, epoch: 21 | loss: 0.0002759
	speed: 0.4088s/iter; left time: 1795.2164s
	iters: 400, epoch: 21 | loss: 0.0159237
	speed: 0.3422s/iter; left time: 1468.2722s
Epoch: 21 cost time: 176.80868673324585
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0002887
	speed: 0.9609s/iter; left time: 3960.8536s
	iters: 200, epoch: 22 | loss: 0.0017742
	speed: 0.3771s/iter; left time: 1516.5481s
	iters: 300, epoch: 22 | loss: 0.0003888
	speed: 0.2076s/iter; left time: 814.0835s
	iters: 400, epoch: 22 | loss: 0.0039321
	speed: 0.2486s/iter; left time: 950.3239s
Epoch: 22 cost time: 140.29817938804626
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0005007
	speed: 0.8237s/iter; left time: 3008.9093s
	iters: 200, epoch: 23 | loss: 0.2259530
	speed: 0.2680s/iter; left time: 952.3164s
	iters: 300, epoch: 23 | loss: 0.0029949
	speed: 0.2994s/iter; left time: 1033.8113s
	iters: 400, epoch: 23 | loss: 0.0002312
	speed: 0.2824s/iter; left time: 946.9323s
Epoch: 23 cost time: 140.89278411865234
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0009706
	speed: 0.7685s/iter; left time: 2446.8552s
	iters: 200, epoch: 24 | loss: 0.0211669
	speed: 0.2990s/iter; left time: 922.0652s
	iters: 300, epoch: 24 | loss: 0.0007927
	speed: 0.3334s/iter; left time: 994.8824s
	iters: 400, epoch: 24 | loss: 0.0006516
	speed: 0.2874s/iter; left time: 828.9658s
Epoch: 24 cost time: 144.18046832084656
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0010386
	speed: 0.8483s/iter; left time: 2303.1610s
	iters: 200, epoch: 25 | loss: 0.0001511
	speed: 0.3193s/iter; left time: 834.9773s
	iters: 300, epoch: 25 | loss: 0.0005805
	speed: 0.2761s/iter; left time: 694.4972s
	iters: 400, epoch: 25 | loss: 0.0047981
	speed: 0.2530s/iter; left time: 611.0251s
Epoch: 25 cost time: 129.80637311935425
Epoch: 25, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 587978
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9856988
	speed: 0.2436s/iter; left time: 3402.8210s
	iters: 200, epoch: 1 | loss: 1.5896010
	speed: 0.1686s/iter; left time: 2339.1571s
	iters: 300, epoch: 1 | loss: 0.5004201
	speed: 0.2033s/iter; left time: 2800.1583s
	iters: 400, epoch: 1 | loss: 0.4450385
	speed: 0.2497s/iter; left time: 3413.2906s
Epoch: 1 cost time: 99.5249981880188
Epoch: 1, Steps: 469 | Train Loss: 1.166 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
Validation loss decreased (inf --> -0.894222).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2832954
	speed: 0.6243s/iter; left time: 8429.9393s
	iters: 200, epoch: 2 | loss: 0.0828509
	speed: 0.2134s/iter; left time: 2859.7424s
	iters: 300, epoch: 2 | loss: 0.1279936
	speed: 0.2053s/iter; left time: 2730.8760s
	iters: 400, epoch: 2 | loss: 0.2098078
	speed: 0.1689s/iter; left time: 2229.4539s
Epoch: 2 cost time: 96.56689095497131
Epoch: 2, Steps: 469 | Train Loss: 0.180 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
Validation loss decreased (-0.894222 --> -0.952829).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1457412
	speed: 0.6171s/iter; left time: 8042.1046s
	iters: 200, epoch: 3 | loss: 0.2101181
	speed: 0.2032s/iter; left time: 2628.3799s
	iters: 300, epoch: 3 | loss: 0.1258859
	speed: 0.2468s/iter; left time: 3167.1554s
	iters: 400, epoch: 3 | loss: 0.0134396
	speed: 0.2003s/iter; left time: 2550.6826s
Epoch: 3 cost time: 95.0528256893158
Epoch: 3, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.952829 --> -0.966551).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0181658
	speed: 0.6360s/iter; left time: 7990.5609s
	iters: 200, epoch: 4 | loss: 0.0177722
	speed: 0.2219s/iter; left time: 2766.0254s
	iters: 300, epoch: 4 | loss: 0.0251340
	speed: 0.1656s/iter; left time: 2047.2196s
	iters: 400, epoch: 4 | loss: 0.0209520
	speed: 0.2066s/iter; left time: 2533.1686s
Epoch: 4 cost time: 98.73805093765259
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.966551 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0138620
	speed: 0.6397s/iter; left time: 7737.5450s
	iters: 200, epoch: 5 | loss: 0.0056655
	speed: 0.2457s/iter; left time: 2946.6399s
	iters: 300, epoch: 5 | loss: 0.1733952
	speed: 0.2108s/iter; left time: 2507.4543s
	iters: 400, epoch: 5 | loss: 0.0786730
	speed: 0.2105s/iter; left time: 2482.6661s
Epoch: 5 cost time: 100.01115655899048
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1109763
	speed: 0.6587s/iter; left time: 7658.0958s
	iters: 200, epoch: 6 | loss: 0.0040650
	speed: 0.1676s/iter; left time: 1932.0426s
	iters: 300, epoch: 6 | loss: 0.0164905
	speed: 0.2012s/iter; left time: 2299.2201s
	iters: 400, epoch: 6 | loss: 0.1352524
	speed: 0.2480s/iter; left time: 2808.9519s
Epoch: 6 cost time: 97.94012141227722
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.976557).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0060051
	speed: 0.6319s/iter; left time: 7049.9330s
	iters: 200, epoch: 7 | loss: 0.0039313
	speed: 0.2176s/iter; left time: 2405.8076s
	iters: 300, epoch: 7 | loss: 0.0032250
	speed: 0.1270s/iter; left time: 1391.4713s
	iters: 400, epoch: 7 | loss: 0.0098773
	speed: 0.0719s/iter; left time: 780.8929s
Epoch: 7 cost time: 80.9489061832428
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.979702).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0489988
	speed: 0.5558s/iter; left time: 5940.6778s
	iters: 200, epoch: 8 | loss: 0.0907199
	speed: 0.1743s/iter; left time: 1845.7456s
	iters: 300, epoch: 8 | loss: 0.1029193
	speed: 0.1968s/iter; left time: 2063.7182s
	iters: 400, epoch: 8 | loss: 0.0097923
	speed: 0.1720s/iter; left time: 1787.1893s
Epoch: 8 cost time: 78.93313145637512
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0026485
	speed: 0.5512s/iter; left time: 5632.9844s
	iters: 200, epoch: 9 | loss: 0.0143369
	speed: 0.1822s/iter; left time: 1843.4814s
	iters: 300, epoch: 9 | loss: 0.0116677
	speed: 0.1306s/iter; left time: 1308.4281s
	iters: 400, epoch: 9 | loss: 0.0243494
	speed: 0.1885s/iter; left time: 1869.8507s
Epoch: 9 cost time: 82.93536019325256
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0719121
	speed: 0.5585s/iter; left time: 5445.2756s
	iters: 200, epoch: 10 | loss: 0.0657378
	speed: 0.1544s/iter; left time: 1489.8918s
	iters: 300, epoch: 10 | loss: 0.0014010
	speed: 0.0989s/iter; left time: 944.3369s
	iters: 400, epoch: 10 | loss: 0.0082983
	speed: 0.1489s/iter; left time: 1406.9547s
Epoch: 10 cost time: 68.08700394630432
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0017039
	speed: 0.4862s/iter; left time: 4512.0126s
	iters: 200, epoch: 11 | loss: 0.0546762
	speed: 0.1327s/iter; left time: 1218.7394s
	iters: 300, epoch: 11 | loss: 0.1169431
	speed: 0.1247s/iter; left time: 1131.9728s
	iters: 400, epoch: 11 | loss: 0.0035217
	speed: 0.1494s/iter; left time: 1341.5470s
Epoch: 11 cost time: 69.3526086807251
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
Validation loss decreased (-0.979702 --> -0.986277).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0010322
	speed: 0.4971s/iter; left time: 4380.4178s
	iters: 200, epoch: 12 | loss: 0.0074817
	speed: 0.1271s/iter; left time: 1107.0765s
	iters: 300, epoch: 12 | loss: 0.0034189
	speed: 0.1367s/iter; left time: 1177.2793s
	iters: 400, epoch: 12 | loss: 0.0028602
	speed: 0.1633s/iter; left time: 1390.0060s
Epoch: 12 cost time: 71.42084217071533
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0105450
	speed: 0.4842s/iter; left time: 4039.4402s
	iters: 200, epoch: 13 | loss: 0.0006446
	speed: 0.1289s/iter; left time: 1062.1389s
	iters: 300, epoch: 13 | loss: 0.0127132
	speed: 0.1537s/iter; left time: 1251.5052s
	iters: 400, epoch: 13 | loss: 0.0011108
	speed: 0.1531s/iter; left time: 1231.7320s
Epoch: 13 cost time: 71.14992570877075
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0006456
	speed: 0.4692s/iter; left time: 3694.3233s
	iters: 200, epoch: 14 | loss: 0.0038719
	speed: 0.0800s/iter; left time: 621.7435s
	iters: 300, epoch: 14 | loss: 0.0008590
	speed: 0.0674s/iter; left time: 517.3362s
	iters: 400, epoch: 14 | loss: 0.0113263
	speed: 0.1783s/iter; left time: 1350.4819s
Epoch: 14 cost time: 53.27481198310852
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0021533
	speed: 0.4690s/iter; left time: 3472.8909s
	iters: 200, epoch: 15 | loss: 0.0009995
	speed: 0.1134s/iter; left time: 828.7009s
	iters: 300, epoch: 15 | loss: 0.0296574
	speed: 0.1582s/iter; left time: 1139.6370s
	iters: 400, epoch: 15 | loss: 0.0003586
	speed: 0.1636s/iter; left time: 1162.7197s
Epoch: 15 cost time: 70.72727560997009
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0004395
	speed: 0.4788s/iter; left time: 3321.2474s
	iters: 200, epoch: 16 | loss: 0.0198859
	speed: 0.1455s/iter; left time: 994.3013s
	iters: 300, epoch: 16 | loss: 0.0004105
	speed: 0.1574s/iter; left time: 1060.2740s
	iters: 400, epoch: 16 | loss: 0.0006337
	speed: 0.1625s/iter; left time: 1078.4530s
Epoch: 16 cost time: 69.02562093734741
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0009067
	speed: 0.4768s/iter; left time: 3083.7838s
	iters: 200, epoch: 17 | loss: 0.0012833
	speed: 0.1127s/iter; left time: 717.3090s
	iters: 300, epoch: 17 | loss: 0.0074772
	speed: 0.1700s/iter; left time: 1065.3498s
	iters: 400, epoch: 17 | loss: 0.0003341
	speed: 0.1547s/iter; left time: 954.1069s
Epoch: 17 cost time: 68.46545720100403
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0133491
	speed: 0.3929s/iter; left time: 2356.5391s
	iters: 200, epoch: 18 | loss: 0.0006095
	speed: 0.1530s/iter; left time: 902.3398s
	iters: 300, epoch: 18 | loss: 0.0171351
	speed: 0.1729s/iter; left time: 1002.3455s
	iters: 400, epoch: 18 | loss: 0.0008812
	speed: 0.1299s/iter; left time: 740.3247s
Epoch: 18 cost time: 66.9354236125946
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0042289
	speed: 0.5152s/iter; left time: 2848.5698s
	iters: 200, epoch: 19 | loss: 0.0010424
	speed: 0.1872s/iter; left time: 1016.4191s
	iters: 300, epoch: 19 | loss: 0.0001536
	speed: 0.1316s/iter; left time: 701.2395s
	iters: 400, epoch: 19 | loss: 0.0005346
	speed: 0.1571s/iter; left time: 821.6250s
Epoch: 19 cost time: 75.11651802062988
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0043856
	speed: 0.5353s/iter; left time: 2708.3809s
	iters: 200, epoch: 20 | loss: 0.0049074
	speed: 0.1369s/iter; left time: 678.8773s
	iters: 300, epoch: 20 | loss: 0.0007568
	speed: 0.1488s/iter; left time: 723.4080s
	iters: 400, epoch: 20 | loss: 0.0003234
	speed: 0.1674s/iter; left time: 796.7781s
Epoch: 20 cost time: 74.77545714378357
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0003204
	speed: 0.5123s/iter; left time: 2351.9389s
	iters: 200, epoch: 21 | loss: 0.0004243
	speed: 0.1486s/iter; left time: 667.2019s
	iters: 300, epoch: 21 | loss: 0.0144622
	speed: 0.1692s/iter; left time: 743.1023s
	iters: 400, epoch: 21 | loss: 0.0325775
	speed: 0.1736s/iter; left time: 744.7172s
Epoch: 21 cost time: 73.97795701026917
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 174026
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7615715
	speed: 0.1902s/iter; left time: 2657.0754s
	iters: 200, epoch: 1 | loss: 1.0477444
	speed: 0.0700s/iter; left time: 970.4939s
	iters: 300, epoch: 1 | loss: 0.6177053
	speed: 0.1122s/iter; left time: 1545.6017s
	iters: 400, epoch: 1 | loss: 0.2048471
	speed: 0.1620s/iter; left time: 2214.9362s
Epoch: 1 cost time: 59.7978310585022
Epoch: 1, Steps: 469 | Train Loss: 1.066 Vali Loss: 0.327 Vali Acc: 0.902 Test Loss: 0.327 Test Acc: 0.902
Validation loss decreased (inf --> -0.901941).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1643310
	speed: 0.4186s/iter; left time: 5652.4422s
	iters: 200, epoch: 2 | loss: 0.1532994
	speed: 0.0996s/iter; left time: 1334.7216s
	iters: 300, epoch: 2 | loss: 0.0475252
	speed: 0.1725s/iter; left time: 2295.2459s
	iters: 400, epoch: 2 | loss: 0.0348545
	speed: 0.1179s/iter; left time: 1556.8989s
Epoch: 2 cost time: 62.33914375305176
Epoch: 2, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.162 Vali Acc: 0.947 Test Loss: 0.162 Test Acc: 0.947
Validation loss decreased (-0.901941 --> -0.947397).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3414226
	speed: 0.4291s/iter; left time: 5592.3376s
	iters: 200, epoch: 3 | loss: 0.0204744
	speed: 0.1755s/iter; left time: 2269.2432s
	iters: 300, epoch: 3 | loss: 0.0593714
	speed: 0.1229s/iter; left time: 1577.1001s
	iters: 400, epoch: 3 | loss: 0.1118855
	speed: 0.1505s/iter; left time: 1916.1826s
Epoch: 3 cost time: 69.81497550010681
Epoch: 3, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.947397 --> -0.963692).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0595501
	speed: 0.4782s/iter; left time: 6008.0638s
	iters: 200, epoch: 4 | loss: 0.0055134
	speed: 0.1197s/iter; left time: 1491.9719s
	iters: 300, epoch: 4 | loss: 0.0079793
	speed: 0.1530s/iter; left time: 1891.1569s
	iters: 400, epoch: 4 | loss: 0.0767039
	speed: 0.1371s/iter; left time: 1681.0081s
Epoch: 4 cost time: 66.52279376983643
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.963692 --> -0.969410).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1666459
	speed: 0.4083s/iter; left time: 4938.7305s
	iters: 200, epoch: 5 | loss: 0.0180004
	speed: 0.1407s/iter; left time: 1687.8795s
	iters: 300, epoch: 5 | loss: 0.0079018
	speed: 0.1331s/iter; left time: 1583.2831s
	iters: 400, epoch: 5 | loss: 0.4706409
	speed: 0.1079s/iter; left time: 1273.2371s
Epoch: 5 cost time: 59.65449500083923
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.969410 --> -0.976557).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0734766
	speed: 0.3576s/iter; left time: 4157.6738s
	iters: 200, epoch: 6 | loss: 0.0081382
	speed: 0.1199s/iter; left time: 1381.4806s
	iters: 300, epoch: 6 | loss: 0.0022929
	speed: 0.2088s/iter; left time: 2385.4504s
	iters: 400, epoch: 6 | loss: 0.0771846
	speed: 0.1410s/iter; left time: 1597.3984s
Epoch: 6 cost time: 70.82290148735046
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0113932
	speed: 0.5857s/iter; left time: 6534.6995s
	iters: 200, epoch: 7 | loss: 0.0229930
	speed: 0.1562s/iter; left time: 1727.0408s
	iters: 300, epoch: 7 | loss: 0.0113292
	speed: 0.1985s/iter; left time: 2174.8393s
	iters: 400, epoch: 7 | loss: 0.0031631
	speed: 0.1800s/iter; left time: 1954.7267s
Epoch: 7 cost time: 86.60691046714783
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1614227
	speed: 0.5235s/iter; left time: 5595.6524s
	iters: 200, epoch: 8 | loss: 0.0055101
	speed: 0.1571s/iter; left time: 1663.0650s
	iters: 300, epoch: 8 | loss: 0.1463083
	speed: 0.2094s/iter; left time: 2196.0543s
	iters: 400, epoch: 8 | loss: 0.0362821
	speed: 0.1390s/iter; left time: 1444.0739s
Epoch: 8 cost time: 84.9515221118927
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0209638
	speed: 0.5854s/iter; left time: 5982.3531s
	iters: 200, epoch: 9 | loss: 0.0080601
	speed: 0.1817s/iter; left time: 1838.4188s
	iters: 300, epoch: 9 | loss: 0.0615735
	speed: 0.1839s/iter; left time: 1842.2865s
	iters: 400, epoch: 9 | loss: 0.0160452
	speed: 0.1986s/iter; left time: 1970.1996s
Epoch: 9 cost time: 88.72265815734863
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.977987 --> -0.984562).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0009172
	speed: 0.5217s/iter; left time: 5086.1678s
	iters: 200, epoch: 10 | loss: 0.0129677
	speed: 0.1541s/iter; left time: 1486.6731s
	iters: 300, epoch: 10 | loss: 0.0023052
	speed: 0.2015s/iter; left time: 1924.1626s
	iters: 400, epoch: 10 | loss: 0.0045235
	speed: 0.1380s/iter; left time: 1303.6832s
Epoch: 10 cost time: 81.4747998714447
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0151518
	speed: 0.5675s/iter; left time: 5267.1491s
	iters: 200, epoch: 11 | loss: 0.0034289
	speed: 0.1803s/iter; left time: 1655.2155s
	iters: 300, epoch: 11 | loss: 0.0203241
	speed: 0.1574s/iter; left time: 1429.5189s
	iters: 400, epoch: 11 | loss: 0.0210448
	speed: 0.1976s/iter; left time: 1774.4989s
Epoch: 11 cost time: 81.84768962860107
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0039288
	speed: 0.5857s/iter; left time: 5161.1713s
	iters: 200, epoch: 12 | loss: 0.0051504
	speed: 0.1926s/iter; left time: 1677.6942s
	iters: 300, epoch: 12 | loss: 0.0119448
	speed: 0.2261s/iter; left time: 1947.3995s
	iters: 400, epoch: 12 | loss: 0.1018144
	speed: 0.2327s/iter; left time: 1981.1580s
Epoch: 12 cost time: 107.37231063842773
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0001719
	speed: 0.6612s/iter; left time: 5516.6831s
	iters: 200, epoch: 13 | loss: 0.0087089
	speed: 0.2228s/iter; left time: 1836.3829s
	iters: 300, epoch: 13 | loss: 0.0047530
	speed: 0.2013s/iter; left time: 1639.2652s
	iters: 400, epoch: 13 | loss: 0.0010269
	speed: 0.2415s/iter; left time: 1942.3994s
Epoch: 13 cost time: 107.96185994148254
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0014118
	speed: 0.6028s/iter; left time: 4746.7385s
	iters: 200, epoch: 14 | loss: 0.0041759
	speed: 0.2738s/iter; left time: 2128.1749s
	iters: 300, epoch: 14 | loss: 0.0088128
	speed: 0.2021s/iter; left time: 1551.0557s
	iters: 400, epoch: 14 | loss: 0.0020271
	speed: 0.1949s/iter; left time: 1475.9555s
Epoch: 14 cost time: 101.09965634346008
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0013858
	speed: 0.6671s/iter; left time: 4939.9159s
	iters: 200, epoch: 15 | loss: 0.0006903
	speed: 0.1716s/iter; left time: 1253.5240s
	iters: 300, epoch: 15 | loss: 0.0273715
	speed: 0.1800s/iter; left time: 1296.8591s
	iters: 400, epoch: 15 | loss: 0.0016120
	speed: 0.1236s/iter; left time: 878.2715s
Epoch: 15 cost time: 81.96578812599182
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0190221
	speed: 0.5469s/iter; left time: 3793.1022s
	iters: 200, epoch: 16 | loss: 0.0020898
	speed: 0.1646s/iter; left time: 1125.0628s
	iters: 300, epoch: 16 | loss: 0.0002580
	speed: 0.1508s/iter; left time: 1016.0561s
	iters: 400, epoch: 16 | loss: 0.0017218
	speed: 0.1907s/iter; left time: 1265.7052s
Epoch: 16 cost time: 86.05609202384949
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0004010
	speed: 0.5102s/iter; left time: 3299.7709s
	iters: 200, epoch: 17 | loss: 0.0006568
	speed: 0.1873s/iter; left time: 1192.5030s
	iters: 300, epoch: 17 | loss: 0.0027907
	speed: 0.1733s/iter; left time: 1086.0350s
	iters: 400, epoch: 17 | loss: 0.0009190
	speed: 0.1505s/iter; left time: 928.3042s
Epoch: 17 cost time: 76.13070583343506
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0008943
	speed: 0.5281s/iter; left time: 3167.6796s
	iters: 200, epoch: 18 | loss: 0.2542577
	speed: 0.1644s/iter; left time: 969.6146s
	iters: 300, epoch: 18 | loss: 0.0020226
	speed: 0.1503s/iter; left time: 871.3773s
	iters: 400, epoch: 18 | loss: 0.0005787
	speed: 0.2069s/iter; left time: 1178.6473s
Epoch: 18 cost time: 86.82389855384827
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0012015
	speed: 0.5440s/iter; left time: 3008.0168s
	iters: 200, epoch: 19 | loss: 0.0050185
	speed: 0.2019s/iter; left time: 1096.3800s
	iters: 300, epoch: 19 | loss: 0.0006107
	speed: 0.0862s/iter; left time: 459.1910s
	iters: 400, epoch: 19 | loss: 0.0029054
	speed: 0.0597s/iter; left time: 312.3498s
Epoch: 19 cost time: 65.2417242527008
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 587978
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9863175
	speed: 0.1109s/iter; left time: 1549.7007s
	iters: 200, epoch: 1 | loss: 1.5947921
	speed: 0.1395s/iter; left time: 1935.6139s
	iters: 300, epoch: 1 | loss: 0.5089113
	speed: 0.1504s/iter; left time: 2070.5861s
	iters: 400, epoch: 1 | loss: 0.4607797
	speed: 0.1399s/iter; left time: 1912.4809s
Epoch: 1 cost time: 64.38597130775452
Epoch: 1, Steps: 469 | Train Loss: 1.166 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (inf --> -0.888790).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3365543
	speed: 0.4704s/iter; left time: 6351.2147s
	iters: 200, epoch: 2 | loss: 0.0946297
	speed: 0.1417s/iter; left time: 1898.9655s
	iters: 300, epoch: 2 | loss: 0.1419747
	speed: 0.1503s/iter; left time: 1999.1307s
	iters: 400, epoch: 2 | loss: 0.2121550
	speed: 0.1327s/iter; left time: 1751.9248s
Epoch: 2 cost time: 65.53581094741821
Epoch: 2, Steps: 469 | Train Loss: 0.190 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.888790 --> -0.950256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1141761
	speed: 0.3889s/iter; left time: 5068.0784s
	iters: 200, epoch: 3 | loss: 0.2251487
	speed: 0.0949s/iter; left time: 1227.3492s
	iters: 300, epoch: 3 | loss: 0.0796777
	speed: 0.1309s/iter; left time: 1679.7281s
	iters: 400, epoch: 3 | loss: 0.0202192
	speed: 0.1059s/iter; left time: 1348.0196s
Epoch: 3 cost time: 50.75466823577881
Epoch: 3, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.950256 --> -0.963406).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0212702
	speed: 0.4164s/iter; left time: 5231.3766s
	iters: 200, epoch: 4 | loss: 0.0392569
	speed: 0.1182s/iter; left time: 1472.9863s
	iters: 300, epoch: 4 | loss: 0.0240934
	speed: 0.0870s/iter; left time: 1076.1144s
	iters: 400, epoch: 4 | loss: 0.0177093
	speed: 0.1232s/iter; left time: 1510.6203s
Epoch: 4 cost time: 54.637458086013794
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.968838).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0141644
	speed: 0.4025s/iter; left time: 4868.2045s
	iters: 200, epoch: 5 | loss: 0.0046314
	speed: 0.0902s/iter; left time: 1082.2049s
	iters: 300, epoch: 5 | loss: 0.1904608
	speed: 0.1398s/iter; left time: 1663.2930s
	iters: 400, epoch: 5 | loss: 0.0241684
	speed: 0.1152s/iter; left time: 1358.4561s
Epoch: 5 cost time: 51.84846830368042
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0973509
	speed: 0.3687s/iter; left time: 4286.1048s
	iters: 200, epoch: 6 | loss: 0.0331023
	speed: 0.1496s/iter; left time: 1724.8573s
	iters: 300, epoch: 6 | loss: 0.0117801
	speed: 0.1020s/iter; left time: 1165.4684s
	iters: 400, epoch: 6 | loss: 0.0619149
	speed: 0.0999s/iter; left time: 1131.8697s
Epoch: 6 cost time: 53.908663749694824
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.968838 --> -0.974842).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0065276
	speed: 0.4327s/iter; left time: 4827.6596s
	iters: 200, epoch: 7 | loss: 0.0048907
	speed: 0.0857s/iter; left time: 947.8841s
	iters: 300, epoch: 7 | loss: 0.0032597
	speed: 0.1001s/iter; left time: 1096.4754s
	iters: 400, epoch: 7 | loss: 0.0046778
	speed: 0.1379s/iter; left time: 1496.9400s
Epoch: 7 cost time: 52.662029504776
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.974842 --> -0.978273).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0142590
	speed: 0.3655s/iter; left time: 3906.1153s
	iters: 200, epoch: 8 | loss: 0.0930607
	speed: 0.1105s/iter; left time: 1170.3943s
	iters: 300, epoch: 8 | loss: 0.1032825
	speed: 0.1466s/iter; left time: 1537.2846s
	iters: 400, epoch: 8 | loss: 0.0156106
	speed: 0.0871s/iter; left time: 904.6655s
Epoch: 8 cost time: 49.80667448043823
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0031816
	speed: 0.3849s/iter; left time: 3933.6979s
	iters: 200, epoch: 9 | loss: 0.0115986
	speed: 0.1296s/iter; left time: 1311.3593s
	iters: 300, epoch: 9 | loss: 0.0868862
	speed: 0.0875s/iter; left time: 876.2470s
	iters: 400, epoch: 9 | loss: 0.0158490
	speed: 0.1117s/iter; left time: 1108.1271s
Epoch: 9 cost time: 54.81308460235596
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0625822
	speed: 0.4256s/iter; left time: 4149.5035s
	iters: 200, epoch: 10 | loss: 0.1212855
	speed: 0.0990s/iter; left time: 955.1404s
	iters: 300, epoch: 10 | loss: 0.0018091
	speed: 0.1338s/iter; left time: 1277.3320s
	iters: 400, epoch: 10 | loss: 0.0035641
	speed: 0.1215s/iter; left time: 1148.4344s
Epoch: 10 cost time: 54.001543045043945
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.978273 --> -0.982561).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0023481
	speed: 0.3776s/iter; left time: 3504.6020s
	iters: 200, epoch: 11 | loss: 0.0320520
	speed: 0.1281s/iter; left time: 1176.1843s
	iters: 300, epoch: 11 | loss: 0.1691959
	speed: 0.1070s/iter; left time: 971.4540s
	iters: 400, epoch: 11 | loss: 0.0082305
	speed: 0.0871s/iter; left time: 781.9236s
Epoch: 11 cost time: 51.75494074821472
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.982561 --> -0.983990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0049077
	speed: 0.4119s/iter; left time: 3629.2871s
	iters: 200, epoch: 12 | loss: 0.0008321
	speed: 0.1038s/iter; left time: 904.0124s
	iters: 300, epoch: 12 | loss: 0.0029139
	speed: 0.0964s/iter; left time: 830.4959s
	iters: 400, epoch: 12 | loss: 0.0322483
	speed: 0.0913s/iter; left time: 776.7678s
Epoch: 12 cost time: 44.0053915977478
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0104906
	speed: 0.2224s/iter; left time: 1855.8674s
	iters: 200, epoch: 13 | loss: 0.0038277
	speed: 0.1015s/iter; left time: 836.9530s
	iters: 300, epoch: 13 | loss: 0.0015138
	speed: 0.0879s/iter; left time: 715.7698s
	iters: 400, epoch: 13 | loss: 0.1123116
	speed: 0.0945s/iter; left time: 759.7859s
Epoch: 13 cost time: 41.22634696960449
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0006076
	speed: 0.3270s/iter; left time: 2574.5083s
	iters: 200, epoch: 14 | loss: 0.0057024
	speed: 0.0984s/iter; left time: 764.9471s
	iters: 300, epoch: 14 | loss: 0.0028975
	speed: 0.0691s/iter; left time: 530.0410s
	iters: 400, epoch: 14 | loss: 0.0007455
	speed: 0.0864s/iter; left time: 654.1716s
Epoch: 14 cost time: 39.921178340911865
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0069801
	speed: 0.2880s/iter; left time: 2132.6811s
	iters: 200, epoch: 15 | loss: 0.0020033
	speed: 0.1284s/iter; left time: 937.6105s
	iters: 300, epoch: 15 | loss: 0.0172646
	speed: 0.1008s/iter; left time: 726.1154s
	iters: 400, epoch: 15 | loss: 0.0029666
	speed: 0.0956s/iter; left time: 679.4122s
Epoch: 15 cost time: 45.5147168636322
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984848).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0004396
	speed: 0.3681s/iter; left time: 2553.3230s
	iters: 200, epoch: 16 | loss: 0.0008227
	speed: 0.0950s/iter; left time: 649.5642s
	iters: 300, epoch: 16 | loss: 0.0003140
	speed: 0.0752s/iter; left time: 506.4674s
	iters: 400, epoch: 16 | loss: 0.0004498
	speed: 0.1076s/iter; left time: 714.2109s
Epoch: 16 cost time: 46.70103621482849
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0057542
	speed: 0.3308s/iter; left time: 2138.9729s
	iters: 200, epoch: 17 | loss: 0.0093017
	speed: 0.0560s/iter; left time: 356.4188s
	iters: 300, epoch: 17 | loss: 0.0110993
	speed: 0.1211s/iter; left time: 759.2390s
	iters: 400, epoch: 17 | loss: 0.0002508
	speed: 0.1005s/iter; left time: 619.5726s
Epoch: 17 cost time: 40.800615072250366
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0046544
	speed: 0.3829s/iter; left time: 2296.8184s
	iters: 200, epoch: 18 | loss: 0.0006792
	speed: 0.1152s/iter; left time: 679.2804s
	iters: 300, epoch: 18 | loss: 0.0534959
	speed: 0.0773s/iter; left time: 448.1864s
	iters: 400, epoch: 18 | loss: 0.0008679
	speed: 0.1048s/iter; left time: 597.2240s
Epoch: 18 cost time: 48.72113823890686
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0548475
	speed: 0.3927s/iter; left time: 2171.3065s
	iters: 200, epoch: 19 | loss: 0.0035196
	speed: 0.0796s/iter; left time: 432.3690s
	iters: 300, epoch: 19 | loss: 0.0003102
	speed: 0.1257s/iter; left time: 669.9053s
	iters: 400, epoch: 19 | loss: 0.0007703
	speed: 0.1145s/iter; left time: 598.8463s
Epoch: 19 cost time: 49.489925384521484
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0003627
	speed: 0.3589s/iter; left time: 1816.0977s
	iters: 200, epoch: 20 | loss: 0.0104742
	speed: 0.1253s/iter; left time: 621.4365s
	iters: 300, epoch: 20 | loss: 0.0003762
	speed: 0.0745s/iter; left time: 362.2282s
	iters: 400, epoch: 20 | loss: 0.0010199
	speed: 0.0957s/iter; left time: 455.3628s
Epoch: 20 cost time: 45.750144720077515
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0005205
	speed: 0.3838s/iter; left time: 1761.9618s
	iters: 200, epoch: 21 | loss: 0.0011492
	speed: 0.0766s/iter; left time: 344.0091s
	iters: 300, epoch: 21 | loss: 0.0429159
	speed: 0.1103s/iter; left time: 484.4948s
	iters: 400, epoch: 21 | loss: 0.0077385
	speed: 0.1123s/iter; left time: 481.8621s
Epoch: 21 cost time: 50.2844512462616
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0002468
	speed: 0.3822s/iter; left time: 1575.5538s
	iters: 200, epoch: 22 | loss: 0.0001097
	speed: 0.1302s/iter; left time: 523.8100s
	iters: 300, epoch: 22 | loss: 0.0002481
	speed: 0.1109s/iter; left time: 434.8231s
	iters: 400, epoch: 22 | loss: 0.0067256
	speed: 0.0939s/iter; left time: 358.8388s
Epoch: 22 cost time: 48.96104073524475
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2042294
	speed: 0.3904s/iter; left time: 1426.1343s
	iters: 200, epoch: 23 | loss: 0.0013110
	speed: 0.0869s/iter; left time: 308.6478s
	iters: 300, epoch: 23 | loss: 0.0009175
	speed: 0.0911s/iter; left time: 314.4423s
	iters: 400, epoch: 23 | loss: 0.0127353
	speed: 0.0937s/iter; left time: 314.2248s
Epoch: 23 cost time: 43.468416929244995
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0004639
	speed: 0.2570s/iter; left time: 818.2456s
	iters: 200, epoch: 24 | loss: 0.0001367
	speed: 0.0700s/iter; left time: 215.7625s
	iters: 300, epoch: 24 | loss: 0.0016353
	speed: 0.0931s/iter; left time: 277.7903s
	iters: 400, epoch: 24 | loss: 0.0002453
	speed: 0.0955s/iter; left time: 275.3638s
Epoch: 24 cost time: 37.47968649864197
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0001812
	speed: 0.2908s/iter; left time: 789.5334s
	iters: 200, epoch: 25 | loss: 0.0006456
	speed: 0.0862s/iter; left time: 225.3189s
	iters: 300, epoch: 25 | loss: 0.0003859
	speed: 0.0691s/iter; left time: 173.7999s
	iters: 400, epoch: 25 | loss: 0.0007569
	speed: 0.0696s/iter; left time: 168.1473s
Epoch: 25 cost time: 36.880942821502686
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 174026
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8450364
	speed: 0.0859s/iter; left time: 1200.1248s
	iters: 200, epoch: 1 | loss: 1.2235603
	speed: 0.0833s/iter; left time: 1155.5673s
	iters: 300, epoch: 1 | loss: 0.7583579
	speed: 0.0960s/iter; left time: 1321.8660s
	iters: 400, epoch: 1 | loss: 0.3405500
	speed: 0.0709s/iter; left time: 969.0729s
Epoch: 1 cost time: 37.53646445274353
Epoch: 1, Steps: 469 | Train Loss: 1.177 Vali Loss: 0.435 Vali Acc: 0.878 Test Loss: 0.435 Test Acc: 0.878
Validation loss decreased (inf --> -0.878212).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2153028
	speed: 0.2907s/iter; left time: 3924.8427s
	iters: 200, epoch: 2 | loss: 0.2054728
	speed: 0.0753s/iter; left time: 1008.6682s
	iters: 300, epoch: 2 | loss: 0.0484226
	speed: 0.0514s/iter; left time: 684.3830s
	iters: 400, epoch: 2 | loss: 0.0544116
	speed: 0.0424s/iter; left time: 560.1708s
Epoch: 2 cost time: 28.91136336326599
Epoch: 2, Steps: 469 | Train Loss: 0.214 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.878212 --> -0.951399).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3069728
	speed: 0.4073s/iter; left time: 5307.6957s
	iters: 200, epoch: 3 | loss: 0.0387817
	speed: 0.0936s/iter; left time: 1210.6459s
	iters: 300, epoch: 3 | loss: 0.0739466
	speed: 0.1141s/iter; left time: 1464.1334s
	iters: 400, epoch: 3 | loss: 0.0790393
	speed: 0.1673s/iter; left time: 2130.5040s
Epoch: 3 cost time: 61.530439615249634
Epoch: 3, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.951399 --> -0.969696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0785721
	speed: 0.4484s/iter; left time: 5633.9137s
	iters: 200, epoch: 4 | loss: 0.0089986
	speed: 0.1617s/iter; left time: 2015.9879s
	iters: 300, epoch: 4 | loss: 0.0272924
	speed: 0.1279s/iter; left time: 1581.0917s
	iters: 400, epoch: 4 | loss: 0.1258956
	speed: 0.1052s/iter; left time: 1290.2982s
Epoch: 4 cost time: 63.913936138153076
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0545905
	speed: 0.4822s/iter; left time: 5831.6191s
	iters: 200, epoch: 5 | loss: 0.0228452
	speed: 0.1249s/iter; left time: 1497.7885s
	iters: 300, epoch: 5 | loss: 0.0090713
	speed: 0.1424s/iter; left time: 1694.0304s
	iters: 400, epoch: 5 | loss: 0.4223984
	speed: 0.1388s/iter; left time: 1636.8759s
Epoch: 5 cost time: 63.127493381500244
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.972269).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0988862
	speed: 0.4621s/iter; left time: 5372.7873s
	iters: 200, epoch: 6 | loss: 0.0226226
	speed: 0.1194s/iter; left time: 1376.2966s
	iters: 300, epoch: 6 | loss: 0.0031418
	speed: 0.1464s/iter; left time: 1672.7309s
	iters: 400, epoch: 6 | loss: 0.1384770
	speed: 0.1500s/iter; left time: 1698.5393s
Epoch: 6 cost time: 63.12699508666992
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.972269 --> -0.975128).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0118475
	speed: 0.4640s/iter; left time: 5176.4587s
	iters: 200, epoch: 7 | loss: 0.2013248
	speed: 0.1400s/iter; left time: 1548.2076s
	iters: 300, epoch: 7 | loss: 0.0458321
	speed: 0.0968s/iter; left time: 1060.2910s
	iters: 400, epoch: 7 | loss: 0.0074515
	speed: 0.1088s/iter; left time: 1181.6705s
Epoch: 7 cost time: 63.4250123500824
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.975128 --> -0.979416).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1680484
	speed: 0.4750s/iter; left time: 5077.1432s
	iters: 200, epoch: 8 | loss: 0.0059190
	speed: 0.1279s/iter; left time: 1354.3809s
	iters: 300, epoch: 8 | loss: 0.1605673
	speed: 0.1403s/iter; left time: 1471.8676s
	iters: 400, epoch: 8 | loss: 0.0116528
	speed: 0.0885s/iter; left time: 919.8450s
Epoch: 8 cost time: 50.85723829269409
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0038220
	speed: 0.3954s/iter; left time: 4040.3584s
	iters: 200, epoch: 9 | loss: 0.0095390
	speed: 0.0840s/iter; left time: 849.6631s
	iters: 300, epoch: 9 | loss: 0.0443746
	speed: 0.0986s/iter; left time: 987.6939s
	iters: 400, epoch: 9 | loss: 0.0277958
	speed: 0.1431s/iter; left time: 1419.0274s
Epoch: 9 cost time: 53.30452013015747
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.982275).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0010721
	speed: 0.3904s/iter; left time: 3806.4447s
	iters: 200, epoch: 10 | loss: 0.0158247
	speed: 0.1314s/iter; left time: 1267.7657s
	iters: 300, epoch: 10 | loss: 0.0315082
	speed: 0.0946s/iter; left time: 903.1545s
	iters: 400, epoch: 10 | loss: 0.0069133
	speed: 0.0878s/iter; left time: 829.5857s
Epoch: 10 cost time: 50.96719741821289
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0010481
	speed: 0.3869s/iter; left time: 3590.6098s
	iters: 200, epoch: 11 | loss: 0.0012153
	speed: 0.0963s/iter; left time: 884.4658s
	iters: 300, epoch: 11 | loss: 0.0683677
	speed: 0.1371s/iter; left time: 1245.2153s
	iters: 400, epoch: 11 | loss: 0.0012567
	speed: 0.1285s/iter; left time: 1153.6333s
Epoch: 11 cost time: 52.00192093849182
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0098687
	speed: 0.3986s/iter; left time: 3512.7982s
	iters: 200, epoch: 12 | loss: 0.0083428
	speed: 0.1048s/iter; left time: 913.3648s
	iters: 300, epoch: 12 | loss: 0.0025946
	speed: 0.0887s/iter; left time: 763.6457s
	iters: 400, epoch: 12 | loss: 0.0666113
	speed: 0.1216s/iter; left time: 1035.0055s
Epoch: 12 cost time: 55.150946617126465
Epoch: 12, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0005968
	speed: 0.3869s/iter; left time: 3227.8494s
	iters: 200, epoch: 13 | loss: 0.0105931
	speed: 0.1434s/iter; left time: 1181.9015s
	iters: 300, epoch: 13 | loss: 0.0040769
	speed: 0.1200s/iter; left time: 977.2445s
	iters: 400, epoch: 13 | loss: 0.0075685
	speed: 0.0801s/iter; left time: 644.5793s
Epoch: 13 cost time: 50.555856466293335
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.982561).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0172414
	speed: 0.3908s/iter; left time: 3076.8734s
	iters: 200, epoch: 14 | loss: 0.0007405
	speed: 0.0839s/iter; left time: 652.5699s
	iters: 300, epoch: 14 | loss: 0.0037515
	speed: 0.1118s/iter; left time: 858.0444s
	iters: 400, epoch: 14 | loss: 0.0098377
	speed: 0.1405s/iter; left time: 1063.9917s
Epoch: 14 cost time: 53.01589560508728
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0006147
	speed: 0.4138s/iter; left time: 3064.4034s
	iters: 200, epoch: 15 | loss: 0.0012885
	speed: 0.1239s/iter; left time: 905.1504s
	iters: 300, epoch: 15 | loss: 0.0023408
	speed: 0.0864s/iter; left time: 622.8339s
	iters: 400, epoch: 15 | loss: 0.0089867
	speed: 0.1046s/iter; left time: 743.5029s
Epoch: 15 cost time: 56.52740430831909
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0053839
	speed: 0.4092s/iter; left time: 2838.0910s
	iters: 200, epoch: 16 | loss: 0.0054526
	speed: 0.1291s/iter; left time: 882.8480s
	iters: 300, epoch: 16 | loss: 0.0001996
	speed: 0.1308s/iter; left time: 881.1881s
	iters: 400, epoch: 16 | loss: 0.0015431
	speed: 0.0944s/iter; left time: 626.7557s
Epoch: 16 cost time: 51.670063495635986
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0004728
	speed: 0.2683s/iter; left time: 1735.2486s
	iters: 200, epoch: 17 | loss: 0.0005638
	speed: 0.0413s/iter; left time: 263.0574s
	iters: 300, epoch: 17 | loss: 0.0121540
	speed: 0.0984s/iter; left time: 616.7661s
	iters: 400, epoch: 17 | loss: 0.0005529
	speed: 0.0977s/iter; left time: 602.6243s
Epoch: 17 cost time: 32.4418306350708
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0009619
	speed: 0.3083s/iter; left time: 1849.0940s
	iters: 200, epoch: 18 | loss: 0.0091493
	speed: 0.1155s/iter; left time: 680.9987s
	iters: 300, epoch: 18 | loss: 0.0016272
	speed: 0.0662s/iter; left time: 383.9507s
	iters: 400, epoch: 18 | loss: 0.0014548
	speed: 0.1144s/iter; left time: 652.0771s
Epoch: 18 cost time: 43.81287717819214
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0015999
	speed: 0.2957s/iter; left time: 1635.0002s
	iters: 200, epoch: 19 | loss: 0.0008787
	speed: 0.1190s/iter; left time: 645.9348s
	iters: 300, epoch: 19 | loss: 0.0003311
	speed: 0.0826s/iter; left time: 439.9340s
	iters: 400, epoch: 19 | loss: 0.0006396
	speed: 0.0928s/iter; left time: 485.4883s
Epoch: 19 cost time: 46.65052843093872
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0012601
	speed: 0.3622s/iter; left time: 1832.5871s
	iters: 200, epoch: 20 | loss: 0.0004744
	speed: 0.0973s/iter; left time: 482.4343s
	iters: 300, epoch: 20 | loss: 0.0012542
	speed: 0.1212s/iter; left time: 588.9441s
	iters: 400, epoch: 20 | loss: 0.0010125
	speed: 0.0708s/iter; left time: 337.0947s
Epoch: 20 cost time: 45.3234338760376
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
Validation loss decreased (-0.982561 --> -0.985706).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0005378
	speed: 0.3794s/iter; left time: 1741.9909s
	iters: 200, epoch: 21 | loss: 0.0008754
	speed: 0.0686s/iter; left time: 308.1652s
	iters: 300, epoch: 21 | loss: 0.0105357
	speed: 0.1215s/iter; left time: 533.4458s
	iters: 400, epoch: 21 | loss: 0.0025914
	speed: 0.1019s/iter; left time: 437.2326s
Epoch: 21 cost time: 45.74899744987488
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002271
	speed: 0.3528s/iter; left time: 1454.2607s
	iters: 200, epoch: 22 | loss: 0.0071487
	speed: 0.1002s/iter; left time: 403.1169s
	iters: 300, epoch: 22 | loss: 0.0159945
	speed: 0.0777s/iter; left time: 304.8139s
	iters: 400, epoch: 22 | loss: 0.0021943
	speed: 0.1438s/iter; left time: 549.7687s
Epoch: 22 cost time: 49.29213261604309
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0581050
	speed: 0.3411s/iter; left time: 1246.0409s
	iters: 200, epoch: 23 | loss: 0.0001563
	speed: 0.1312s/iter; left time: 466.2673s
	iters: 300, epoch: 23 | loss: 0.0020971
	speed: 0.0732s/iter; left time: 252.8950s
	iters: 400, epoch: 23 | loss: 0.0004871
	speed: 0.1121s/iter; left time: 375.9683s
Epoch: 23 cost time: 49.91321063041687
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0016367
	speed: 0.3585s/iter; left time: 1141.5061s
	iters: 200, epoch: 24 | loss: 0.0076934
	speed: 0.1217s/iter; left time: 375.3214s
	iters: 300, epoch: 24 | loss: 0.0034246
	speed: 0.1006s/iter; left time: 300.1913s
	iters: 400, epoch: 24 | loss: 0.0015611
	speed: 0.0661s/iter; left time: 190.7528s
Epoch: 24 cost time: 46.26017618179321
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0006154
	speed: 0.3836s/iter; left time: 1041.5290s
	iters: 200, epoch: 25 | loss: 0.0006330
	speed: 0.0766s/iter; left time: 200.4348s
	iters: 300, epoch: 25 | loss: 0.0018674
	speed: 0.1268s/iter; left time: 318.9281s
	iters: 400, epoch: 25 | loss: 0.0021111
	speed: 0.0880s/iter; left time: 212.5986s
Epoch: 25 cost time: 44.80407404899597
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0006550
	speed: 0.1949s/iter; left time: 437.7570s
	iters: 200, epoch: 26 | loss: 0.0015558
	speed: 0.1215s/iter; left time: 260.6891s
	iters: 300, epoch: 26 | loss: 0.1582540
	speed: 0.1021s/iter; left time: 208.9700s
	iters: 400, epoch: 26 | loss: 0.0000574
	speed: 0.1023s/iter; left time: 199.0137s
Epoch: 26 cost time: 46.43149781227112
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0003094
	speed: 0.3825s/iter; left time: 679.6715s
	iters: 200, epoch: 27 | loss: 0.0196288
	speed: 0.1405s/iter; left time: 235.5725s
	iters: 300, epoch: 27 | loss: 0.0006272
	speed: 0.0845s/iter; left time: 133.3141s
	iters: 400, epoch: 27 | loss: 0.0026142
	speed: 0.0937s/iter; left time: 138.4503s
Epoch: 27 cost time: 52.815938234329224
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0007766
	speed: 0.4139s/iter; left time: 541.3835s
	iters: 200, epoch: 28 | loss: 0.0012526
	speed: 0.1327s/iter; left time: 160.3428s
	iters: 300, epoch: 28 | loss: 0.0008132
	speed: 0.0926s/iter; left time: 102.5656s
	iters: 400, epoch: 28 | loss: 0.2156273
	speed: 0.1093s/iter; left time: 110.1722s
Epoch: 28 cost time: 54.133904457092285
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0004188
	speed: 0.3995s/iter; left time: 335.2151s
	iters: 200, epoch: 29 | loss: 0.0003839
	speed: 0.0939s/iter; left time: 69.3993s
	iters: 300, epoch: 29 | loss: 0.0136815
	speed: 0.0953s/iter; left time: 60.9093s
	iters: 400, epoch: 29 | loss: 0.0006893
	speed: 0.1282s/iter; left time: 69.0795s
Epoch: 29 cost time: 51.07400727272034
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0038349
	speed: 0.3925s/iter; left time: 145.2360s
	iters: 200, epoch: 30 | loss: 0.0110734
	speed: 0.0839s/iter; left time: 22.6570s
	iters: 300, epoch: 30 | loss: 0.0007146
	speed: 0.0987s/iter; left time: 16.7725s
	iters: 400, epoch: 30 | loss: 0.0000968
	speed: 0.1146s/iter; left time: 8.0232s
Epoch: 30 cost time: 48.16510319709778
Epoch: 30, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 587978
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0159380
	speed: 0.0932s/iter; left time: 1302.6892s
	iters: 200, epoch: 1 | loss: 1.6950284
	speed: 0.0831s/iter; left time: 1152.1325s
	iters: 300, epoch: 1 | loss: 0.6299227
	speed: 0.0632s/iter; left time: 870.1202s
	iters: 400, epoch: 1 | loss: 0.7358861
	speed: 0.0584s/iter; left time: 798.3859s
Epoch: 1 cost time: 34.86872434616089
Epoch: 1, Steps: 469 | Train Loss: 1.261 Vali Loss: 0.504 Vali Acc: 0.866 Test Loss: 0.504 Test Acc: 0.866
Validation loss decreased (inf --> -0.866204).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4542893
	speed: 0.3040s/iter; left time: 4105.2449s
	iters: 200, epoch: 2 | loss: 0.1538672
	speed: 0.0721s/iter; left time: 965.9344s
	iters: 300, epoch: 2 | loss: 0.1365491
	speed: 0.0895s/iter; left time: 1190.6949s
	iters: 400, epoch: 2 | loss: 0.3067065
	speed: 0.0705s/iter; left time: 931.2371s
Epoch: 2 cost time: 33.68825912475586
Epoch: 2, Steps: 469 | Train Loss: 0.263 Vali Loss: 0.223 Vali Acc: 0.938 Test Loss: 0.223 Test Acc: 0.938
Validation loss decreased (-0.866204 --> -0.937962).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1279809
	speed: 0.3023s/iter; left time: 3939.9828s
	iters: 200, epoch: 3 | loss: 0.2829210
	speed: 0.0585s/iter; left time: 756.8403s
	iters: 300, epoch: 3 | loss: 0.1498877
	speed: 0.0611s/iter; left time: 784.5016s
	iters: 400, epoch: 3 | loss: 0.0249722
	speed: 0.0884s/iter; left time: 1125.8424s
Epoch: 3 cost time: 34.64050054550171
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.937962 --> -0.951971).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0343866
	speed: 0.3021s/iter; left time: 3795.0810s
	iters: 200, epoch: 4 | loss: 0.0108972
	speed: 0.0906s/iter; left time: 1129.6429s
	iters: 300, epoch: 4 | loss: 0.0190561
	speed: 0.0619s/iter; left time: 765.3102s
	iters: 400, epoch: 4 | loss: 0.0269266
	speed: 0.0598s/iter; left time: 732.9412s
Epoch: 4 cost time: 34.96034836769104
Epoch: 4, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.951971 --> -0.972841).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0486958
	speed: 0.3011s/iter; left time: 3642.1594s
	iters: 200, epoch: 5 | loss: 0.0071820
	speed: 0.0634s/iter; left time: 760.4290s
	iters: 300, epoch: 5 | loss: 0.1506200
	speed: 0.0297s/iter; left time: 353.5626s
	iters: 400, epoch: 5 | loss: 0.0191153
	speed: 0.0344s/iter; left time: 406.1596s
Epoch: 5 cost time: 21.70257329940796
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0272352
	speed: 0.2295s/iter; left time: 2668.7285s
	iters: 200, epoch: 6 | loss: 0.0114275
	speed: 0.0736s/iter; left time: 848.3303s
	iters: 300, epoch: 6 | loss: 0.0311328
	speed: 0.0459s/iter; left time: 524.4210s
	iters: 400, epoch: 6 | loss: 0.0951516
	speed: 0.0655s/iter; left time: 742.3983s
Epoch: 6 cost time: 29.69982600212097
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.972841 --> -0.979130).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0571914
	speed: 0.2451s/iter; left time: 2735.0202s
	iters: 200, epoch: 7 | loss: 0.0090902
	speed: 0.0725s/iter; left time: 801.4788s
	iters: 300, epoch: 7 | loss: 0.0421511
	speed: 0.0591s/iter; left time: 647.6389s
	iters: 400, epoch: 7 | loss: 0.0063393
	speed: 0.0596s/iter; left time: 647.3645s
Epoch: 7 cost time: 29.355884790420532
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0140752
	speed: 0.2544s/iter; left time: 2718.7437s
	iters: 200, epoch: 8 | loss: 0.0889416
	speed: 0.0649s/iter; left time: 686.9516s
	iters: 300, epoch: 8 | loss: 0.0518538
	speed: 0.0551s/iter; left time: 577.4615s
	iters: 400, epoch: 8 | loss: 0.0091800
	speed: 0.0568s/iter; left time: 589.7109s
Epoch: 8 cost time: 28.618385791778564
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0026972
	speed: 0.2486s/iter; left time: 2540.3130s
	iters: 200, epoch: 9 | loss: 0.0032622
	speed: 0.0669s/iter; left time: 677.3295s
	iters: 300, epoch: 9 | loss: 0.0127159
	speed: 0.0648s/iter; left time: 649.4159s
	iters: 400, epoch: 9 | loss: 0.0545695
	speed: 0.0443s/iter; left time: 439.1859s
Epoch: 9 cost time: 27.80380129814148
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0788516
	speed: 0.2621s/iter; left time: 2555.3286s
	iters: 200, epoch: 10 | loss: 0.0184068
	speed: 0.0481s/iter; left time: 464.5293s
	iters: 300, epoch: 10 | loss: 0.0276810
	speed: 0.0772s/iter; left time: 737.1050s
	iters: 400, epoch: 10 | loss: 0.1135211
	speed: 0.0511s/iter; left time: 482.8635s
Epoch: 10 cost time: 28.07838273048401
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0023744
	speed: 0.2527s/iter; left time: 2345.2262s
	iters: 200, epoch: 11 | loss: 0.0070141
	speed: 0.0479s/iter; left time: 439.9947s
	iters: 300, epoch: 11 | loss: 0.2015947
	speed: 0.0675s/iter; left time: 612.8827s
	iters: 400, epoch: 11 | loss: 0.0081058
	speed: 0.0642s/iter; left time: 576.7608s
Epoch: 11 cost time: 30.653164386749268
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0369483
	speed: 0.3252s/iter; left time: 2866.0947s
	iters: 200, epoch: 12 | loss: 0.0024813
	speed: 0.0537s/iter; left time: 467.6252s
	iters: 300, epoch: 12 | loss: 0.0186478
	speed: 0.0746s/iter; left time: 642.1395s
	iters: 400, epoch: 12 | loss: 0.0013067
	speed: 0.0694s/iter; left time: 590.4038s
Epoch: 12 cost time: 32.867393493652344
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0051174
	speed: 0.3414s/iter; left time: 2848.2559s
	iters: 200, epoch: 13 | loss: 0.0021719
	speed: 0.0549s/iter; left time: 452.6735s
	iters: 300, epoch: 13 | loss: 0.0179004
	speed: 0.0669s/iter; left time: 544.6331s
	iters: 400, epoch: 13 | loss: 0.0053852
	speed: 0.0714s/iter; left time: 574.0207s
Epoch: 13 cost time: 32.410821199417114
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0005335
	speed: 0.3281s/iter; left time: 2583.6100s
	iters: 200, epoch: 14 | loss: 0.0123914
	speed: 0.0661s/iter; left time: 513.8732s
	iters: 300, epoch: 14 | loss: 0.0070659
	speed: 0.0515s/iter; left time: 395.5265s
	iters: 400, epoch: 14 | loss: 0.0037770
	speed: 0.0829s/iter; left time: 627.5186s
Epoch: 14 cost time: 32.49606466293335
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.979702 --> -0.983704).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0069608
	speed: 0.3241s/iter; left time: 2399.9854s
	iters: 200, epoch: 15 | loss: 0.0061913
	speed: 0.0712s/iter; left time: 519.9267s
	iters: 300, epoch: 15 | loss: 0.0724989
	speed: 0.0570s/iter; left time: 411.0379s
	iters: 400, epoch: 15 | loss: 0.0008018
	speed: 0.0782s/iter; left time: 555.3837s
Epoch: 15 cost time: 33.2901725769043
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0010243
	speed: 0.2133s/iter; left time: 1479.7801s
	iters: 200, epoch: 16 | loss: 0.0018086
	speed: 0.0406s/iter; left time: 277.2196s
	iters: 300, epoch: 16 | loss: 0.0010880
	speed: 0.0911s/iter; left time: 613.7269s
	iters: 400, epoch: 16 | loss: 0.0014241
	speed: 0.0601s/iter; left time: 399.1386s
Epoch: 16 cost time: 27.378654718399048
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0010668
	speed: 0.3188s/iter; left time: 2061.9151s
	iters: 200, epoch: 17 | loss: 0.0024323
	speed: 0.0772s/iter; left time: 491.7823s
	iters: 300, epoch: 17 | loss: 0.0101122
	speed: 0.0704s/iter; left time: 441.3900s
	iters: 400, epoch: 17 | loss: 0.0009400
	speed: 0.0762s/iter; left time: 469.7675s
Epoch: 17 cost time: 36.45839190483093
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0031670
	speed: 0.2784s/iter; left time: 1669.9692s
	iters: 200, epoch: 18 | loss: 0.0005973
	speed: 0.0995s/iter; left time: 586.7945s
	iters: 300, epoch: 18 | loss: 0.0011618
	speed: 0.0672s/iter; left time: 389.5412s
	iters: 400, epoch: 18 | loss: 0.0003927
	speed: 0.0664s/iter; left time: 378.4811s
Epoch: 18 cost time: 36.75789785385132
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0032632
	speed: 0.2991s/iter; left time: 1653.8054s
	iters: 200, epoch: 19 | loss: 0.0008627
	speed: 0.0847s/iter; left time: 459.6522s
	iters: 300, epoch: 19 | loss: 0.0015109
	speed: 0.0845s/iter; left time: 450.1702s
	iters: 400, epoch: 19 | loss: 0.0009376
	speed: 0.0597s/iter; left time: 312.1831s
Epoch: 19 cost time: 35.47388410568237
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0007118
	speed: 0.2998s/iter; left time: 1516.7714s
	iters: 200, epoch: 20 | loss: 0.0144555
	speed: 0.0718s/iter; left time: 356.2271s
	iters: 300, epoch: 20 | loss: 0.0004741
	speed: 0.0959s/iter; left time: 466.2654s
	iters: 400, epoch: 20 | loss: 0.0128784
	speed: 0.0789s/iter; left time: 375.5540s
Epoch: 20 cost time: 36.92633128166199
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0004551
	speed: 0.2957s/iter; left time: 1357.4525s
	iters: 200, epoch: 21 | loss: 0.0022167
	speed: 0.0863s/iter; left time: 387.6888s
	iters: 300, epoch: 21 | loss: 0.0088172
	speed: 0.0787s/iter; left time: 345.5776s
	iters: 400, epoch: 21 | loss: 0.0031606
	speed: 0.1028s/iter; left time: 441.1439s
Epoch: 21 cost time: 39.180129051208496
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0025434
	speed: 0.1807s/iter; left time: 744.9042s
	iters: 200, epoch: 22 | loss: 0.0009174
	speed: 0.0341s/iter; left time: 137.0274s
	iters: 300, epoch: 22 | loss: 0.0026663
	speed: 0.0674s/iter; left time: 264.5081s
	iters: 400, epoch: 22 | loss: 0.0003251
	speed: 0.0622s/iter; left time: 237.6617s
Epoch: 22 cost time: 25.05391812324524
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0040645
	speed: 0.2441s/iter; left time: 891.6881s
	iters: 200, epoch: 23 | loss: 0.0008928
	speed: 0.0612s/iter; left time: 217.4409s
	iters: 300, epoch: 23 | loss: 0.0021255
	speed: 0.0512s/iter; left time: 176.8103s
	iters: 400, epoch: 23 | loss: 0.0053474
	speed: 0.0750s/iter; left time: 251.3483s
Epoch: 23 cost time: 27.400623559951782
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0102138
	speed: 0.2431s/iter; left time: 773.9007s
	iters: 200, epoch: 24 | loss: 0.0003200
	speed: 0.0593s/iter; left time: 183.0030s
	iters: 300, epoch: 24 | loss: 0.0023430
	speed: 0.0452s/iter; left time: 134.9828s
	iters: 400, epoch: 24 | loss: 0.0010964
	speed: 0.0622s/iter; left time: 179.4483s
Epoch: 24 cost time: 25.0502769947052
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 174026
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9409754
	speed: 0.1192s/iter; left time: 1665.6428s
	iters: 200, epoch: 1 | loss: 1.3587065
	speed: 0.1185s/iter; left time: 1644.3466s
	iters: 300, epoch: 1 | loss: 0.8951155
	speed: 0.1264s/iter; left time: 1740.8771s
	iters: 400, epoch: 1 | loss: 0.6062952
	speed: 0.1149s/iter; left time: 1570.9846s
Epoch: 1 cost time: 54.3235969543457
Epoch: 1, Steps: 469 | Train Loss: 1.270 Vali Loss: 0.489 Vali Acc: 0.859 Test Loss: 0.489 Test Acc: 0.859
Validation loss decreased (inf --> -0.859343).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2087461
	speed: 0.4075s/iter; left time: 5501.4534s
	iters: 200, epoch: 2 | loss: 0.1291663
	speed: 0.1170s/iter; left time: 1567.3819s
	iters: 300, epoch: 2 | loss: 0.2538917
	speed: 0.1018s/iter; left time: 1354.7319s
	iters: 400, epoch: 2 | loss: 0.1582664
	speed: 0.0983s/iter; left time: 1298.1197s
Epoch: 2 cost time: 51.94415044784546
Epoch: 2, Steps: 469 | Train Loss: 0.258 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.859343 --> -0.941107).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0777132
	speed: 0.3939s/iter; left time: 5133.6306s
	iters: 200, epoch: 3 | loss: 0.0476135
	speed: 0.0841s/iter; left time: 1088.0935s
	iters: 300, epoch: 3 | loss: 0.1093108
	speed: 0.1615s/iter; left time: 2072.6480s
	iters: 400, epoch: 3 | loss: 0.3043645
	speed: 0.1435s/iter; left time: 1827.1691s
Epoch: 3 cost time: 55.84634208679199
Epoch: 3, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.941107 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0415085
	speed: 0.4872s/iter; left time: 6120.8623s
	iters: 200, epoch: 4 | loss: 0.0796264
	speed: 0.1598s/iter; left time: 1991.9280s
	iters: 300, epoch: 4 | loss: 0.0504596
	speed: 0.1226s/iter; left time: 1516.4027s
	iters: 400, epoch: 4 | loss: 0.0118201
	speed: 0.1242s/iter; left time: 1523.3728s
Epoch: 4 cost time: 64.38071036338806
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.955973 --> -0.966551).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0238901
	speed: 0.5258s/iter; left time: 6359.0234s
	iters: 200, epoch: 5 | loss: 0.0163103
	speed: 0.1140s/iter; left time: 1367.7607s
	iters: 300, epoch: 5 | loss: 0.0165358
	speed: 0.1279s/iter; left time: 1521.4295s
	iters: 400, epoch: 5 | loss: 0.0105054
	speed: 0.1312s/iter; left time: 1547.1244s
Epoch: 5 cost time: 61.55423831939697
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.966551 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0427416
	speed: 0.4352s/iter; left time: 5059.6452s
	iters: 200, epoch: 6 | loss: 0.0196416
	speed: 0.1316s/iter; left time: 1516.8524s
	iters: 300, epoch: 6 | loss: 0.0182786
	speed: 0.1145s/iter; left time: 1307.9105s
	iters: 400, epoch: 6 | loss: 0.0040402
	speed: 0.1043s/iter; left time: 1181.6922s
Epoch: 6 cost time: 56.880104780197144
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.971983).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0478700
	speed: 0.4783s/iter; left time: 5336.3724s
	iters: 200, epoch: 7 | loss: 0.4757771
	speed: 0.1139s/iter; left time: 1259.5243s
	iters: 300, epoch: 7 | loss: 0.0104088
	speed: 0.1228s/iter; left time: 1345.7842s
	iters: 400, epoch: 7 | loss: 0.0082916
	speed: 0.1364s/iter; left time: 1480.8432s
Epoch: 7 cost time: 58.018635272979736
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1200706
	speed: 0.4409s/iter; left time: 4712.7429s
	iters: 200, epoch: 8 | loss: 0.0041679
	speed: 0.1190s/iter; left time: 1259.7227s
	iters: 300, epoch: 8 | loss: 0.0215678
	speed: 0.1247s/iter; left time: 1307.9424s
	iters: 400, epoch: 8 | loss: 0.0111675
	speed: 0.1066s/iter; left time: 1106.9087s
Epoch: 8 cost time: 55.337029457092285
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0091643
	speed: 0.4608s/iter; left time: 4708.9476s
	iters: 200, epoch: 9 | loss: 0.0089755
	speed: 0.1311s/iter; left time: 1326.5749s
	iters: 300, epoch: 9 | loss: 0.0104283
	speed: 0.1152s/iter; left time: 1154.0742s
	iters: 400, epoch: 9 | loss: 0.0050278
	speed: 0.1256s/iter; left time: 1245.5430s
Epoch: 9 cost time: 58.42064428329468
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.973698).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0087108
	speed: 0.4594s/iter; left time: 4479.4926s
	iters: 200, epoch: 10 | loss: 0.0970994
	speed: 0.1105s/iter; left time: 1066.5012s
	iters: 300, epoch: 10 | loss: 0.0106294
	speed: 0.1331s/iter; left time: 1270.6815s
	iters: 400, epoch: 10 | loss: 0.0047231
	speed: 0.1134s/iter; left time: 1072.0624s
Epoch: 10 cost time: 56.409603118896484
Epoch: 10, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0108454
	speed: 0.4564s/iter; left time: 4235.5390s
	iters: 200, epoch: 11 | loss: 0.0690088
	speed: 0.1367s/iter; left time: 1255.5003s
	iters: 300, epoch: 11 | loss: 0.0015654
	speed: 0.1104s/iter; left time: 1002.7686s
	iters: 400, epoch: 11 | loss: 0.0680317
	speed: 0.1250s/iter; left time: 1122.3702s
Epoch: 11 cost time: 58.49557161331177
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.973698 --> -0.978844).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0026333
	speed: 0.3773s/iter; left time: 3324.3473s
	iters: 200, epoch: 12 | loss: 0.0017291
	speed: 0.0985s/iter; left time: 858.0228s
	iters: 300, epoch: 12 | loss: 0.0020438
	speed: 0.0999s/iter; left time: 860.3487s
	iters: 400, epoch: 12 | loss: 0.0122907
	speed: 0.1210s/iter; left time: 1030.0340s
Epoch: 12 cost time: 45.81065630912781
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0222062
	speed: 0.3961s/iter; left time: 3304.2500s
	iters: 200, epoch: 13 | loss: 0.0040412
	speed: 0.1031s/iter; left time: 849.7418s
	iters: 300, epoch: 13 | loss: 0.2094887
	speed: 0.0995s/iter; left time: 809.9844s
	iters: 400, epoch: 13 | loss: 0.0025893
	speed: 0.1030s/iter; left time: 828.7643s
Epoch: 13 cost time: 49.100499868392944
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0365613
	speed: 0.4003s/iter; left time: 3151.9444s
	iters: 200, epoch: 14 | loss: 0.0013872
	speed: 0.0964s/iter; left time: 749.6139s
	iters: 300, epoch: 14 | loss: 0.0086716
	speed: 0.1190s/iter; left time: 912.8250s
	iters: 400, epoch: 14 | loss: 0.0078628
	speed: 0.1025s/iter; left time: 776.3506s
Epoch: 14 cost time: 50.1829252243042
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0022798
	speed: 0.4065s/iter; left time: 3010.1953s
	iters: 200, epoch: 15 | loss: 0.0034815
	speed: 0.0944s/iter; left time: 689.8997s
	iters: 300, epoch: 15 | loss: 0.0006073
	speed: 0.1074s/iter; left time: 773.9794s
	iters: 400, epoch: 15 | loss: 0.0036980
	speed: 0.1001s/iter; left time: 710.8596s
Epoch: 15 cost time: 50.952452659606934
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0020584
	speed: 0.4136s/iter; left time: 2868.5095s
	iters: 200, epoch: 16 | loss: 0.0016088
	speed: 0.0958s/iter; left time: 655.2164s
	iters: 300, epoch: 16 | loss: 0.0107205
	speed: 0.1219s/iter; left time: 820.9302s
	iters: 400, epoch: 16 | loss: 0.0011314
	speed: 0.1013s/iter; left time: 671.9925s
Epoch: 16 cost time: 50.79776310920715
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979702).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0010802
	speed: 0.4219s/iter; left time: 2728.4797s
	iters: 200, epoch: 17 | loss: 0.0176404
	speed: 0.0931s/iter; left time: 592.9622s
	iters: 300, epoch: 17 | loss: 0.0012598
	speed: 0.1061s/iter; left time: 665.1123s
	iters: 400, epoch: 17 | loss: 0.0174144
	speed: 0.0957s/iter; left time: 590.1747s
Epoch: 17 cost time: 46.857972860336304
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0294614
	speed: 0.3449s/iter; left time: 2068.4906s
	iters: 200, epoch: 18 | loss: 0.0073594
	speed: 0.1324s/iter; left time: 780.8701s
	iters: 300, epoch: 18 | loss: 0.0020512
	speed: 0.1114s/iter; left time: 645.8532s
	iters: 400, epoch: 18 | loss: 0.0063265
	speed: 0.1234s/iter; left time: 703.3503s
Epoch: 18 cost time: 54.20617485046387
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0022604
	speed: 0.4395s/iter; left time: 2429.9982s
	iters: 200, epoch: 19 | loss: 0.0997907
	speed: 0.1037s/iter; left time: 563.0334s
	iters: 300, epoch: 19 | loss: 0.0032889
	speed: 0.1226s/iter; left time: 653.3060s
	iters: 400, epoch: 19 | loss: 0.2258536
	speed: 0.1153s/iter; left time: 602.7022s
Epoch: 19 cost time: 55.948455810546875
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0027642
	speed: 0.4393s/iter; left time: 2223.1091s
	iters: 200, epoch: 20 | loss: 0.0014112
	speed: 0.1230s/iter; left time: 610.1756s
	iters: 300, epoch: 20 | loss: 0.0039902
	speed: 0.1169s/iter; left time: 567.9548s
	iters: 400, epoch: 20 | loss: 0.0034379
	speed: 0.1085s/iter; left time: 516.5380s
Epoch: 20 cost time: 55.42993402481079
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0181301
	speed: 0.4233s/iter; left time: 1943.2304s
	iters: 200, epoch: 21 | loss: 0.0012328
	speed: 0.1376s/iter; left time: 617.8626s
	iters: 300, epoch: 21 | loss: 0.0020235
	speed: 0.1110s/iter; left time: 487.2779s
	iters: 400, epoch: 21 | loss: 0.0010899
	speed: 0.1324s/iter; left time: 568.0937s
Epoch: 21 cost time: 58.084552526474
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.982275).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0030318
	speed: 0.4661s/iter; left time: 1921.0601s
	iters: 200, epoch: 22 | loss: 0.0029319
	speed: 0.1147s/iter; left time: 461.4972s
	iters: 300, epoch: 22 | loss: 0.0016586
	speed: 0.1292s/iter; left time: 506.8686s
	iters: 400, epoch: 22 | loss: 0.0006061
	speed: 0.1328s/iter; left time: 507.5474s
Epoch: 22 cost time: 57.74177861213684
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0761190
	speed: 0.4688s/iter; left time: 1712.4372s
	iters: 200, epoch: 23 | loss: 0.0159803
	speed: 0.1100s/iter; left time: 390.9970s
	iters: 300, epoch: 23 | loss: 0.0022368
	speed: 0.1263s/iter; left time: 436.1220s
	iters: 400, epoch: 23 | loss: 0.0029399
	speed: 0.1148s/iter; left time: 384.8772s
Epoch: 23 cost time: 59.16694974899292
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0554852
	speed: 0.4729s/iter; left time: 1505.5628s
	iters: 200, epoch: 24 | loss: 0.1425772
	speed: 0.1192s/iter; left time: 367.6556s
	iters: 300, epoch: 24 | loss: 0.0008134
	speed: 0.0817s/iter; left time: 243.8744s
	iters: 400, epoch: 24 | loss: 0.0009496
	speed: 0.0881s/iter; left time: 254.0837s
Epoch: 24 cost time: 47.879902839660645
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.982275 --> -0.984848).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0032522
	speed: 0.4006s/iter; left time: 1087.6396s
	iters: 200, epoch: 25 | loss: 0.0011112
	speed: 0.1021s/iter; left time: 267.0192s
	iters: 300, epoch: 25 | loss: 0.0060019
	speed: 0.1175s/iter; left time: 295.4569s
	iters: 400, epoch: 25 | loss: 0.0039586
	speed: 0.1061s/iter; left time: 256.3369s
Epoch: 25 cost time: 49.70681810379028
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0004975
	speed: 0.4002s/iter; left time: 898.9159s
	iters: 200, epoch: 26 | loss: 0.0016981
	speed: 0.1062s/iter; left time: 227.8462s
	iters: 300, epoch: 26 | loss: 0.0331979
	speed: 0.1022s/iter; left time: 209.0354s
	iters: 400, epoch: 26 | loss: 0.0005755
	speed: 0.0994s/iter; left time: 193.4478s
Epoch: 26 cost time: 50.090099811553955
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0013918
	speed: 0.3952s/iter; left time: 702.3060s
	iters: 200, epoch: 27 | loss: 0.0020297
	speed: 0.1172s/iter; left time: 196.5142s
	iters: 300, epoch: 27 | loss: 0.0036989
	speed: 0.0996s/iter; left time: 157.1245s
	iters: 400, epoch: 27 | loss: 0.0615071
	speed: 0.0996s/iter; left time: 147.0521s
Epoch: 27 cost time: 49.52047538757324
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0006311
	speed: 0.4129s/iter; left time: 540.0521s
	iters: 200, epoch: 28 | loss: 0.0039036
	speed: 0.0884s/iter; left time: 106.7307s
	iters: 300, epoch: 28 | loss: 0.0286160
	speed: 0.0796s/iter; left time: 88.1561s
	iters: 400, epoch: 28 | loss: 0.0011525
	speed: 0.1185s/iter; left time: 119.4162s
Epoch: 28 cost time: 45.50415253639221
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0015196
	speed: 0.3947s/iter; left time: 331.1158s
	iters: 200, epoch: 29 | loss: 0.0058197
	speed: 0.0980s/iter; left time: 72.4451s
	iters: 300, epoch: 29 | loss: 0.0009988
	speed: 0.1006s/iter; left time: 64.3084s
	iters: 400, epoch: 29 | loss: 0.0059674
	speed: 0.1086s/iter; left time: 58.5158s
Epoch: 29 cost time: 49.81468439102173
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0004942
	speed: 0.4067s/iter; left time: 150.4740s
	iters: 200, epoch: 30 | loss: 0.0003677
	speed: 0.1017s/iter; left time: 27.4680s
	iters: 300, epoch: 30 | loss: 0.0010652
	speed: 0.1165s/iter; left time: 19.7994s
	iters: 400, epoch: 30 | loss: 0.0755675
	speed: 0.1042s/iter; left time: 7.2909s
Epoch: 30 cost time: 49.54373812675476
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 1173930
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8602030
	speed: 0.1101s/iter; left time: 1537.8054s
	iters: 200, epoch: 1 | loss: 1.4962065
	speed: 0.1031s/iter; left time: 1429.5509s
	iters: 300, epoch: 1 | loss: 1.0205513
	speed: 0.0713s/iter; left time: 981.6676s
	iters: 400, epoch: 1 | loss: 0.9218830
	speed: 0.0635s/iter; left time: 868.0678s
Epoch: 1 cost time: 39.361679553985596
Epoch: 1, Steps: 469 | Train Loss: 1.348 Vali Loss: 0.444 Vali Acc: 0.903 Test Loss: 0.444 Test Acc: 0.903
Validation loss decreased (inf --> -0.902797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3814139
	speed: 0.2857s/iter; left time: 3858.0791s
	iters: 200, epoch: 2 | loss: 0.5037324
	speed: 0.0720s/iter; left time: 964.5925s
	iters: 300, epoch: 2 | loss: 0.5736428
	speed: 0.0814s/iter; left time: 1082.3892s
	iters: 400, epoch: 2 | loss: 0.0688887
	speed: 0.0810s/iter; left time: 1069.2784s
Epoch: 2 cost time: 35.437225341796875
Epoch: 2, Steps: 469 | Train Loss: 0.261 Vali Loss: 0.216 Vali Acc: 0.936 Test Loss: 0.216 Test Acc: 0.936
Validation loss decreased (-0.902797 --> -0.935961).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1462234
	speed: 0.2923s/iter; left time: 3809.4498s
	iters: 200, epoch: 3 | loss: 0.0874908
	speed: 0.0761s/iter; left time: 983.8980s
	iters: 300, epoch: 3 | loss: 0.1484994
	speed: 0.0701s/iter; left time: 899.2421s
	iters: 400, epoch: 3 | loss: 0.0248105
	speed: 0.0732s/iter; left time: 931.7949s
Epoch: 3 cost time: 36.71141743659973
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
Validation loss decreased (-0.935961 --> -0.959690).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0358271
	speed: 0.2938s/iter; left time: 3691.4634s
	iters: 200, epoch: 4 | loss: 0.0972253
	speed: 0.0780s/iter; left time: 972.3097s
	iters: 300, epoch: 4 | loss: 0.0421375
	speed: 0.0797s/iter; left time: 984.9347s
	iters: 400, epoch: 4 | loss: 0.0156953
	speed: 0.0778s/iter; left time: 954.3511s
Epoch: 4 cost time: 35.64375329017639
Epoch: 4, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.959690 --> -0.977415).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1477752
	speed: 0.2887s/iter; left time: 3492.1608s
	iters: 200, epoch: 5 | loss: 0.0086589
	speed: 0.0707s/iter; left time: 847.9358s
	iters: 300, epoch: 5 | loss: 0.0275201
	speed: 0.0707s/iter; left time: 841.0529s
	iters: 400, epoch: 5 | loss: 0.0055485
	speed: 0.0701s/iter; left time: 827.3942s
Epoch: 5 cost time: 33.9877495765686
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0129442
	speed: 0.2329s/iter; left time: 2707.6251s
	iters: 200, epoch: 6 | loss: 0.0052888
	speed: 0.0907s/iter; left time: 1045.3067s
	iters: 300, epoch: 6 | loss: 0.0389400
	speed: 0.0841s/iter; left time: 960.4565s
	iters: 400, epoch: 6 | loss: 0.0053097
	speed: 0.0928s/iter; left time: 1051.2590s
Epoch: 6 cost time: 41.522563457489014
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0147319
	speed: 0.3382s/iter; left time: 3773.4692s
	iters: 200, epoch: 7 | loss: 0.0045998
	speed: 0.0851s/iter; left time: 941.1507s
	iters: 300, epoch: 7 | loss: 0.0076426
	speed: 0.0842s/iter; left time: 922.2291s
	iters: 400, epoch: 7 | loss: 0.0120435
	speed: 0.0932s/iter; left time: 1011.3886s
Epoch: 7 cost time: 40.550522565841675
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0723380
	speed: 0.3301s/iter; left time: 3528.1369s
	iters: 200, epoch: 8 | loss: 0.0084305
	speed: 0.0918s/iter; left time: 971.8199s
	iters: 300, epoch: 8 | loss: 0.1653471
	speed: 0.0790s/iter; left time: 828.7013s
	iters: 400, epoch: 8 | loss: 0.0015578
	speed: 0.1032s/iter; left time: 1072.5449s
Epoch: 8 cost time: 42.391074657440186
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0081179
	speed: 0.3338s/iter; left time: 3410.8419s
	iters: 200, epoch: 9 | loss: 0.0582763
	speed: 0.1020s/iter; left time: 1032.0237s
	iters: 300, epoch: 9 | loss: 0.0047705
	speed: 0.0803s/iter; left time: 804.3427s
	iters: 400, epoch: 9 | loss: 0.0536318
	speed: 0.0899s/iter; left time: 891.3957s
Epoch: 9 cost time: 42.28583097457886
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.977415 --> -0.982561).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0030608
	speed: 0.3358s/iter; left time: 3273.6258s
	iters: 200, epoch: 10 | loss: 0.0029583
	speed: 0.1025s/iter; left time: 988.9750s
	iters: 300, epoch: 10 | loss: 0.0026619
	speed: 0.0827s/iter; left time: 789.6901s
	iters: 400, epoch: 10 | loss: 0.0023867
	speed: 0.0936s/iter; left time: 884.3641s
Epoch: 10 cost time: 41.91436314582825
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0036336
	speed: 0.3390s/iter; left time: 3145.9681s
	iters: 200, epoch: 11 | loss: 0.0901092
	speed: 0.0948s/iter; left time: 870.1739s
	iters: 300, epoch: 11 | loss: 0.0008461
	speed: 0.0771s/iter; left time: 699.7397s
	iters: 400, epoch: 11 | loss: 0.0183099
	speed: 0.0915s/iter; left time: 821.5080s
Epoch: 11 cost time: 41.53322887420654
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0285510
	speed: 0.3401s/iter; left time: 2997.1551s
	iters: 200, epoch: 12 | loss: 0.0022871
	speed: 0.0972s/iter; left time: 846.6807s
	iters: 300, epoch: 12 | loss: 0.0231714
	speed: 0.0863s/iter; left time: 743.3636s
	iters: 400, epoch: 12 | loss: 0.0058426
	speed: 0.0786s/iter; left time: 668.9944s
Epoch: 12 cost time: 39.267470359802246
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1647388
	speed: 0.2181s/iter; left time: 1819.7818s
	iters: 200, epoch: 13 | loss: 0.0257104
	speed: 0.0722s/iter; left time: 595.1674s
	iters: 300, epoch: 13 | loss: 0.0039938
	speed: 0.0728s/iter; left time: 592.7486s
	iters: 400, epoch: 13 | loss: 0.0195071
	speed: 0.0792s/iter; left time: 636.6510s
Epoch: 13 cost time: 33.72317814826965
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0020589
	speed: 0.2737s/iter; left time: 2155.0124s
	iters: 200, epoch: 14 | loss: 0.0025335
	speed: 0.0681s/iter; left time: 529.2089s
	iters: 300, epoch: 14 | loss: 0.0054662
	speed: 0.0704s/iter; left time: 539.9313s
	iters: 400, epoch: 14 | loss: 0.0566065
	speed: 0.0688s/iter; left time: 520.8053s
Epoch: 14 cost time: 32.859604358673096
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0129208
	speed: 0.2699s/iter; left time: 1998.5822s
	iters: 200, epoch: 15 | loss: 0.0268534
	speed: 0.0742s/iter; left time: 542.3626s
	iters: 300, epoch: 15 | loss: 0.0021963
	speed: 0.0678s/iter; left time: 488.1648s
	iters: 400, epoch: 15 | loss: 0.0229101
	speed: 0.0684s/iter; left time: 486.2728s
Epoch: 15 cost time: 32.83828663825989
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0244723
	speed: 0.2802s/iter; left time: 1943.3453s
	iters: 200, epoch: 16 | loss: 0.1306114
	speed: 0.0716s/iter; left time: 489.4132s
	iters: 300, epoch: 16 | loss: 0.0021117
	speed: 0.0760s/iter; left time: 511.8128s
	iters: 400, epoch: 16 | loss: 0.0068630
	speed: 0.0686s/iter; left time: 454.9625s
Epoch: 16 cost time: 33.063427448272705
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0210611
	speed: 0.2445s/iter; left time: 1581.0826s
	iters: 200, epoch: 17 | loss: 0.0021307
	speed: 0.0802s/iter; left time: 510.4143s
	iters: 300, epoch: 17 | loss: 0.0015690
	speed: 0.0814s/iter; left time: 510.2594s
	iters: 400, epoch: 17 | loss: 0.0012085
	speed: 0.0887s/iter; left time: 547.2681s
Epoch: 17 cost time: 39.73224091529846
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0083921
	speed: 0.3219s/iter; left time: 1930.9433s
	iters: 200, epoch: 18 | loss: 0.0016949
	speed: 0.0793s/iter; left time: 467.4524s
	iters: 300, epoch: 18 | loss: 0.0101128
	speed: 0.0868s/iter; left time: 503.5464s
	iters: 400, epoch: 18 | loss: 0.0130002
	speed: 0.0733s/iter; left time: 417.5585s
Epoch: 18 cost time: 38.91428804397583
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0325954
	speed: 0.3190s/iter; left time: 1763.8491s
	iters: 200, epoch: 19 | loss: 0.0094106
	speed: 0.0805s/iter; left time: 437.1820s
	iters: 300, epoch: 19 | loss: 0.0011416
	speed: 0.0843s/iter; left time: 449.4221s
	iters: 400, epoch: 19 | loss: 0.0013906
	speed: 0.0841s/iter; left time: 439.9858s
Epoch: 19 cost time: 38.32901215553284
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 345962
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9642771
	speed: 0.1034s/iter; left time: 1444.1435s
	iters: 200, epoch: 1 | loss: 1.3576875
	speed: 0.0831s/iter; left time: 1152.2143s
	iters: 300, epoch: 1 | loss: 0.9301266
	speed: 0.0958s/iter; left time: 1319.0960s
	iters: 400, epoch: 1 | loss: 0.6953950
	speed: 0.0826s/iter; left time: 1128.8017s
Epoch: 1 cost time: 41.5401828289032
Epoch: 1, Steps: 469 | Train Loss: 1.282 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
Validation loss decreased (inf --> -0.867062).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2077487
	speed: 0.2331s/iter; left time: 3147.9426s
	iters: 200, epoch: 2 | loss: 0.1176917
	speed: 0.0682s/iter; left time: 914.0244s
	iters: 300, epoch: 2 | loss: 0.3338707
	speed: 0.0669s/iter; left time: 889.6424s
	iters: 400, epoch: 2 | loss: 0.0944364
	speed: 0.0658s/iter; left time: 868.1740s
Epoch: 2 cost time: 31.79499125480652
Epoch: 2, Steps: 469 | Train Loss: 0.268 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
Validation loss decreased (-0.867062 --> -0.939392).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1030526
	speed: 0.2602s/iter; left time: 3390.6222s
	iters: 200, epoch: 3 | loss: 0.0524312
	speed: 0.0701s/iter; left time: 906.5780s
	iters: 300, epoch: 3 | loss: 0.1617612
	speed: 0.0654s/iter; left time: 838.8823s
	iters: 400, epoch: 3 | loss: 0.4299078
	speed: 0.0729s/iter; left time: 928.5946s
Epoch: 3 cost time: 33.22536849975586
Epoch: 3, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.939392 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0630665
	speed: 0.2674s/iter; left time: 3359.5943s
	iters: 200, epoch: 4 | loss: 0.1298964
	speed: 0.0636s/iter; left time: 793.2440s
	iters: 300, epoch: 4 | loss: 0.1940612
	speed: 0.0746s/iter; left time: 922.5227s
	iters: 400, epoch: 4 | loss: 0.0208096
	speed: 0.0812s/iter; left time: 995.8537s
Epoch: 4 cost time: 34.06659293174744
Epoch: 4, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.957117 --> -0.964550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0344248
	speed: 0.2756s/iter; left time: 3333.0305s
	iters: 200, epoch: 5 | loss: 0.0229492
	speed: 0.0692s/iter; left time: 829.6300s
	iters: 300, epoch: 5 | loss: 0.0359171
	speed: 0.0815s/iter; left time: 969.6431s
	iters: 400, epoch: 5 | loss: 0.0146182
	speed: 0.0756s/iter; left time: 891.5828s
Epoch: 5 cost time: 34.58574032783508
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0374343
	speed: 0.2602s/iter; left time: 3024.9298s
	iters: 200, epoch: 6 | loss: 0.0133978
	speed: 0.0701s/iter; left time: 807.8843s
	iters: 300, epoch: 6 | loss: 0.0113710
	speed: 0.0800s/iter; left time: 914.3582s
	iters: 400, epoch: 6 | loss: 0.0110844
	speed: 0.0776s/iter; left time: 879.2891s
Epoch: 6 cost time: 33.97089958190918
Epoch: 6, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.964550 --> -0.967981).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0238713
	speed: 0.2904s/iter; left time: 3239.9471s
	iters: 200, epoch: 7 | loss: 0.5261282
	speed: 0.0767s/iter; left time: 848.1004s
	iters: 300, epoch: 7 | loss: 0.0452598
	speed: 0.0847s/iter; left time: 927.5402s
	iters: 400, epoch: 7 | loss: 0.0104916
	speed: 0.0724s/iter; left time: 786.2181s
Epoch: 7 cost time: 36.34605836868286
Epoch: 7, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.967981 --> -0.970267).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0321242
	speed: 0.2907s/iter; left time: 3106.6125s
	iters: 200, epoch: 8 | loss: 0.0104110
	speed: 0.0779s/iter; left time: 824.3076s
	iters: 300, epoch: 8 | loss: 0.0060833
	speed: 0.0832s/iter; left time: 872.1772s
	iters: 400, epoch: 8 | loss: 0.0729088
	speed: 0.0740s/iter; left time: 769.0096s
Epoch: 8 cost time: 35.83976984024048
Epoch: 8, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0654543
	speed: 0.2876s/iter; left time: 2939.2310s
	iters: 200, epoch: 9 | loss: 0.0127501
	speed: 0.0748s/iter; left time: 756.7078s
	iters: 300, epoch: 9 | loss: 0.0348759
	speed: 0.0872s/iter; left time: 873.4320s
	iters: 400, epoch: 9 | loss: 0.0105397
	speed: 0.0749s/iter; left time: 742.7408s
Epoch: 9 cost time: 36.00785732269287
Epoch: 9, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.970267 --> -0.977415).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0081763
	speed: 0.2565s/iter; left time: 2501.2301s
	iters: 200, epoch: 10 | loss: 0.2054763
	speed: 0.0744s/iter; left time: 717.7661s
	iters: 300, epoch: 10 | loss: 0.0188918
	speed: 0.0692s/iter; left time: 660.5151s
	iters: 400, epoch: 10 | loss: 0.0401836
	speed: 0.0680s/iter; left time: 642.5302s
Epoch: 10 cost time: 33.66935181617737
Epoch: 10, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0145163
	speed: 0.2595s/iter; left time: 2408.8570s
	iters: 200, epoch: 11 | loss: 0.0323181
	speed: 0.0654s/iter; left time: 600.4557s
	iters: 300, epoch: 11 | loss: 0.0026319
	speed: 0.0609s/iter; left time: 553.2332s
	iters: 400, epoch: 11 | loss: 0.0346068
	speed: 0.0632s/iter; left time: 567.4452s
Epoch: 11 cost time: 29.71235156059265
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0027984
	speed: 0.2404s/iter; left time: 2118.5887s
	iters: 200, epoch: 12 | loss: 0.0063048
	speed: 0.0628s/iter; left time: 546.8460s
	iters: 300, epoch: 12 | loss: 0.0033892
	speed: 0.0678s/iter; left time: 583.6115s
	iters: 400, epoch: 12 | loss: 0.1101964
	speed: 0.0634s/iter; left time: 539.9678s
Epoch: 12 cost time: 31.04845380783081
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0054702
	speed: 0.2347s/iter; left time: 1958.3329s
	iters: 200, epoch: 13 | loss: 0.0038996
	speed: 0.0673s/iter; left time: 554.4587s
	iters: 300, epoch: 13 | loss: 0.1419845
	speed: 0.0645s/iter; left time: 525.3632s
	iters: 400, epoch: 13 | loss: 0.0017028
	speed: 0.0662s/iter; left time: 532.6538s
Epoch: 13 cost time: 31.16145086288452
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1154152
	speed: 0.2384s/iter; left time: 1877.5535s
	iters: 200, epoch: 14 | loss: 0.0126924
	speed: 0.0647s/iter; left time: 502.5931s
	iters: 300, epoch: 14 | loss: 0.0168218
	speed: 0.0693s/iter; left time: 531.4274s
	iters: 400, epoch: 14 | loss: 0.0137133
	speed: 0.0597s/iter; left time: 451.9325s
Epoch: 14 cost time: 30.61660146713257
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0016095
	speed: 0.2161s/iter; left time: 1600.2349s
	iters: 200, epoch: 15 | loss: 0.0090420
	speed: 0.1107s/iter; left time: 808.3103s
	iters: 300, epoch: 15 | loss: 0.0028734
	speed: 0.0826s/iter; left time: 594.9743s
	iters: 400, epoch: 15 | loss: 0.0038248
	speed: 0.0933s/iter; left time: 663.0063s
Epoch: 15 cost time: 43.47407364845276
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1048390
	speed: 0.3648s/iter; left time: 2530.2206s
	iters: 200, epoch: 16 | loss: 0.0026468
	speed: 0.0951s/iter; left time: 650.1611s
	iters: 300, epoch: 16 | loss: 0.0057527
	speed: 0.1089s/iter; left time: 733.7499s
	iters: 400, epoch: 16 | loss: 0.1770070
	speed: 0.0837s/iter; left time: 555.1876s
Epoch: 16 cost time: 46.10052967071533
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0090985
	speed: 0.3842s/iter; left time: 2484.3117s
	iters: 200, epoch: 17 | loss: 0.0212369
	speed: 0.0899s/iter; left time: 572.0925s
	iters: 300, epoch: 17 | loss: 0.0022352
	speed: 0.0927s/iter; left time: 580.8430s
	iters: 400, epoch: 17 | loss: 0.0507525
	speed: 0.1009s/iter; left time: 622.2979s
Epoch: 17 cost time: 46.5000741481781
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0992520
	speed: 0.3663s/iter; left time: 2196.8450s
	iters: 200, epoch: 18 | loss: 0.2800695
	speed: 0.1091s/iter; left time: 643.6842s
	iters: 300, epoch: 18 | loss: 0.0073362
	speed: 0.0837s/iter; left time: 485.2289s
	iters: 400, epoch: 18 | loss: 0.0021436
	speed: 0.1056s/iter; left time: 601.6988s
Epoch: 18 cost time: 46.9349308013916
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0008090
	speed: 0.3597s/iter; left time: 1988.7396s
	iters: 200, epoch: 19 | loss: 0.0063709
	speed: 0.0951s/iter; left time: 516.0961s
	iters: 300, epoch: 19 | loss: 0.0048261
	speed: 0.1050s/iter; left time: 559.7460s
	iters: 400, epoch: 19 | loss: 0.0417976
	speed: 0.0912s/iter; left time: 477.0324s
Epoch: 19 cost time: 46.84038972854614
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 1173930
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8581057
	speed: 0.1061s/iter; left time: 1482.8788s
	iters: 200, epoch: 1 | loss: 1.4982362
	speed: 0.0697s/iter; left time: 966.9084s
	iters: 300, epoch: 1 | loss: 1.0750278
	speed: 0.0580s/iter; left time: 798.3913s
	iters: 400, epoch: 1 | loss: 0.9806396
	speed: 0.0856s/iter; left time: 1170.3344s
Epoch: 1 cost time: 37.40779423713684
Epoch: 1, Steps: 469 | Train Loss: 1.379 Vali Loss: 0.492 Vali Acc: 0.885 Test Loss: 0.492 Test Acc: 0.885
Validation loss decreased (inf --> -0.885358).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3580515
	speed: 0.2947s/iter; left time: 3978.9423s
	iters: 200, epoch: 2 | loss: 0.4261563
	speed: 0.0723s/iter; left time: 969.0950s
	iters: 300, epoch: 2 | loss: 0.3478047
	speed: 0.0803s/iter; left time: 1068.2488s
	iters: 400, epoch: 2 | loss: 0.1180651
	speed: 0.0715s/iter; left time: 944.5489s
Epoch: 2 cost time: 34.012407064437866
Epoch: 2, Steps: 469 | Train Loss: 0.280 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
Validation loss decreased (-0.885358 --> -0.925384).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2604067
	speed: 0.2923s/iter; left time: 3809.3297s
	iters: 200, epoch: 3 | loss: 0.0652906
	speed: 0.0712s/iter; left time: 921.3529s
	iters: 300, epoch: 3 | loss: 0.3079638
	speed: 0.0938s/iter; left time: 1203.6900s
	iters: 400, epoch: 3 | loss: 0.0602910
	speed: 0.0651s/iter; left time: 828.4664s
Epoch: 3 cost time: 34.21677112579346
Epoch: 3, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.925384 --> -0.954258).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0484931
	speed: 0.2847s/iter; left time: 3577.1887s
	iters: 200, epoch: 4 | loss: 0.2165335
	speed: 0.0997s/iter; left time: 1242.5428s
	iters: 300, epoch: 4 | loss: 0.1278489
	speed: 0.1313s/iter; left time: 1623.0096s
	iters: 400, epoch: 4 | loss: 0.0187748
	speed: 0.1256s/iter; left time: 1540.9214s
Epoch: 4 cost time: 51.74244475364685
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.954258 --> -0.968552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0398172
	speed: 0.5304s/iter; left time: 6414.9619s
	iters: 200, epoch: 5 | loss: 0.0119126
	speed: 0.1429s/iter; left time: 1713.5197s
	iters: 300, epoch: 5 | loss: 0.1483684
	speed: 0.1327s/iter; left time: 1578.2065s
	iters: 400, epoch: 5 | loss: 0.0163455
	speed: 0.1205s/iter; left time: 1421.8074s
Epoch: 5 cost time: 61.58148956298828
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.968552 --> -0.972555).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2284525
	speed: 0.5280s/iter; left time: 6138.6578s
	iters: 200, epoch: 6 | loss: 0.0103461
	speed: 0.1451s/iter; left time: 1672.2489s
	iters: 300, epoch: 6 | loss: 0.0170221
	speed: 0.1345s/iter; left time: 1537.0401s
	iters: 400, epoch: 6 | loss: 0.0074158
	speed: 0.1216s/iter; left time: 1376.8122s
Epoch: 6 cost time: 61.750298738479614
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0035362
	speed: 0.5261s/iter; left time: 5869.5709s
	iters: 200, epoch: 7 | loss: 0.0096042
	speed: 0.1421s/iter; left time: 1571.6364s
	iters: 300, epoch: 7 | loss: 0.0081605
	speed: 0.1371s/iter; left time: 1502.3242s
	iters: 400, epoch: 7 | loss: 0.0172469
	speed: 0.1256s/iter; left time: 1363.2271s
Epoch: 7 cost time: 61.54143810272217
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0822817
	speed: 0.5210s/iter; left time: 5568.6465s
	iters: 200, epoch: 8 | loss: 0.0030969
	speed: 0.1358s/iter; left time: 1437.5232s
	iters: 300, epoch: 8 | loss: 0.0552126
	speed: 0.1334s/iter; left time: 1399.4483s
	iters: 400, epoch: 8 | loss: 0.0039434
	speed: 0.1189s/iter; left time: 1235.5031s
Epoch: 8 cost time: 59.41185188293457
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.974270).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0143433
	speed: 0.4425s/iter; left time: 4522.3011s
	iters: 200, epoch: 9 | loss: 0.0421455
	speed: 0.1072s/iter; left time: 1085.1479s
	iters: 300, epoch: 9 | loss: 0.0067913
	speed: 0.1291s/iter; left time: 1293.4346s
	iters: 400, epoch: 9 | loss: 0.0121986
	speed: 0.1123s/iter; left time: 1113.4994s
Epoch: 9 cost time: 55.39817428588867
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.979130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0108787
	speed: 0.4785s/iter; left time: 4665.2636s
	iters: 200, epoch: 10 | loss: 0.0289791
	speed: 0.1113s/iter; left time: 1074.0006s
	iters: 300, epoch: 10 | loss: 0.0013805
	speed: 0.1247s/iter; left time: 1190.8211s
	iters: 400, epoch: 10 | loss: 0.0040663
	speed: 0.1066s/iter; left time: 1006.9971s
Epoch: 10 cost time: 55.518707275390625
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0107310
	speed: 0.4886s/iter; left time: 4534.3840s
	iters: 200, epoch: 11 | loss: 0.0117973
	speed: 0.1147s/iter; left time: 1052.9826s
	iters: 300, epoch: 11 | loss: 0.0015948
	speed: 0.1311s/iter; left time: 1190.3342s
	iters: 400, epoch: 11 | loss: 0.0065995
	speed: 0.1164s/iter; left time: 1045.5415s
Epoch: 11 cost time: 57.36890268325806
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0019761
	speed: 0.4834s/iter; left time: 4259.8660s
	iters: 200, epoch: 12 | loss: 0.0039625
	speed: 0.1108s/iter; left time: 965.5353s
	iters: 300, epoch: 12 | loss: 0.0063080
	speed: 0.1215s/iter; left time: 1046.4381s
	iters: 400, epoch: 12 | loss: 0.0158918
	speed: 0.1213s/iter; left time: 1032.7273s
Epoch: 12 cost time: 56.17024850845337
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0097802
	speed: 0.4852s/iter; left time: 4048.2324s
	iters: 200, epoch: 13 | loss: 0.0894638
	speed: 0.1191s/iter; left time: 981.9987s
	iters: 300, epoch: 13 | loss: 0.0442099
	speed: 0.1213s/iter; left time: 987.7199s
	iters: 400, epoch: 13 | loss: 0.0022177
	speed: 0.1289s/iter; left time: 1036.9567s
Epoch: 13 cost time: 57.820268392562866
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0118107
	speed: 0.4875s/iter; left time: 3838.8386s
	iters: 200, epoch: 14 | loss: 0.0450312
	speed: 0.1236s/iter; left time: 960.5046s
	iters: 300, epoch: 14 | loss: 0.0091233
	speed: 0.1137s/iter; left time: 872.1720s
	iters: 400, epoch: 14 | loss: 0.1309288
	speed: 0.1245s/iter; left time: 943.0628s
Epoch: 14 cost time: 56.624611616134644
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0116624
	speed: 0.4698s/iter; left time: 3479.0851s
	iters: 200, epoch: 15 | loss: 0.0218398
	speed: 0.1214s/iter; left time: 886.6633s
	iters: 300, epoch: 15 | loss: 0.0286962
	speed: 0.1110s/iter; left time: 800.0829s
	iters: 400, epoch: 15 | loss: 0.0346294
	speed: 0.1281s/iter; left time: 909.9730s
Epoch: 15 cost time: 55.36756777763367
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1028866
	speed: 0.4701s/iter; left time: 3260.8785s
	iters: 200, epoch: 16 | loss: 0.0552193
	speed: 0.1235s/iter; left time: 844.5376s
	iters: 300, epoch: 16 | loss: 0.0199353
	speed: 0.1125s/iter; left time: 757.5958s
	iters: 400, epoch: 16 | loss: 0.0128154
	speed: 0.1009s/iter; left time: 669.4026s
Epoch: 16 cost time: 53.11651611328125
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0057053
	speed: 0.4656s/iter; left time: 3010.7969s
	iters: 200, epoch: 17 | loss: 0.0018818
	speed: 0.1265s/iter; left time: 805.6734s
	iters: 300, epoch: 17 | loss: 0.0188355
	speed: 0.1217s/iter; left time: 762.6678s
	iters: 400, epoch: 17 | loss: 0.0010616
	speed: 0.1406s/iter; left time: 867.3295s
Epoch: 17 cost time: 62.175129413604736
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.979130 --> -0.984276).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0565098
	speed: 0.5054s/iter; left time: 3031.2725s
	iters: 200, epoch: 18 | loss: 0.0029000
	speed: 0.1293s/iter; left time: 762.5118s
	iters: 300, epoch: 18 | loss: 0.1698662
	speed: 0.1326s/iter; left time: 768.8833s
	iters: 400, epoch: 18 | loss: 0.0073736
	speed: 0.1186s/iter; left time: 675.5452s
Epoch: 18 cost time: 59.95105528831482
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2503857
	speed: 0.5300s/iter; left time: 2930.2675s
	iters: 200, epoch: 19 | loss: 0.0827892
	speed: 0.1222s/iter; left time: 663.1601s
	iters: 300, epoch: 19 | loss: 0.0116786
	speed: 0.1372s/iter; left time: 731.1276s
	iters: 400, epoch: 19 | loss: 0.0537367
	speed: 0.1333s/iter; left time: 696.9201s
Epoch: 19 cost time: 61.899298906326294
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0012687
	speed: 0.5193s/iter; left time: 2627.7835s
	iters: 200, epoch: 20 | loss: 0.0152042
	speed: 0.1309s/iter; left time: 649.2319s
	iters: 300, epoch: 20 | loss: 0.0015674
	speed: 0.1227s/iter; left time: 596.4958s
	iters: 400, epoch: 20 | loss: 0.0069400
	speed: 0.1376s/iter; left time: 654.8454s
Epoch: 20 cost time: 61.630232095718384
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005642
	speed: 0.5110s/iter; left time: 2345.9354s
	iters: 200, epoch: 21 | loss: 0.0035031
	speed: 0.1274s/iter; left time: 572.2318s
	iters: 300, epoch: 21 | loss: 0.0024768
	speed: 0.1257s/iter; left time: 551.8606s
	iters: 400, epoch: 21 | loss: 0.0024178
	speed: 0.1215s/iter; left time: 521.1618s
Epoch: 21 cost time: 59.04208421707153
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0007218
	speed: 0.5183s/iter; left time: 2136.5335s
	iters: 200, epoch: 22 | loss: 0.0554268
	speed: 0.1166s/iter; left time: 468.8227s
	iters: 300, epoch: 22 | loss: 0.0028264
	speed: 0.1294s/iter; left time: 507.3918s
	iters: 400, epoch: 22 | loss: 0.0004656
	speed: 0.1259s/iter; left time: 481.2608s
Epoch: 22 cost time: 59.26604342460632
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0003138
	speed: 0.5126s/iter; left time: 1872.6855s
	iters: 200, epoch: 23 | loss: 0.0002909
	speed: 0.1322s/iter; left time: 469.7941s
	iters: 300, epoch: 23 | loss: 0.0006574
	speed: 0.1168s/iter; left time: 403.2500s
	iters: 400, epoch: 23 | loss: 0.3057384
	speed: 0.1305s/iter; left time: 437.5222s
Epoch: 23 cost time: 57.50216555595398
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0731793
	speed: 0.4854s/iter; left time: 1545.6309s
	iters: 200, epoch: 24 | loss: 0.0024048
	speed: 0.1300s/iter; left time: 400.8412s
	iters: 300, epoch: 24 | loss: 0.0912352
	speed: 0.1287s/iter; left time: 384.0863s
	iters: 400, epoch: 24 | loss: 0.0040420
	speed: 0.1207s/iter; left time: 348.0172s
Epoch: 24 cost time: 58.920825719833374
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0411621
	speed: 0.4540s/iter; left time: 1232.6796s
	iters: 200, epoch: 25 | loss: 0.0005975
	speed: 0.1231s/iter; left time: 321.8859s
	iters: 300, epoch: 25 | loss: 0.0066798
	speed: 0.1134s/iter; left time: 285.0994s
	iters: 400, epoch: 25 | loss: 0.0117661
	speed: 0.1266s/iter; left time: 305.7564s
Epoch: 25 cost time: 55.882524251937866
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0826732
	speed: 0.4730s/iter; left time: 1062.4124s
	iters: 200, epoch: 26 | loss: 0.0008569
	speed: 0.1158s/iter; left time: 248.5574s
	iters: 300, epoch: 26 | loss: 0.0054947
	speed: 0.1223s/iter; left time: 250.1660s
	iters: 400, epoch: 26 | loss: 0.0016900
	speed: 0.1166s/iter; left time: 226.8761s
Epoch: 26 cost time: 56.70302367210388
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0105038
	speed: 0.4711s/iter; left time: 837.0764s
	iters: 200, epoch: 27 | loss: 0.0028111
	speed: 0.1191s/iter; left time: 199.7801s
	iters: 300, epoch: 27 | loss: 0.0012445
	speed: 0.1127s/iter; left time: 177.7940s
	iters: 400, epoch: 27 | loss: 0.0024944
	speed: 0.1115s/iter; left time: 164.7092s
Epoch: 27 cost time: 53.788044452667236
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 345962
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0366902
	speed: 0.1608s/iter; left time: 2246.3151s
	iters: 200, epoch: 1 | loss: 1.6038146
	speed: 0.1584s/iter; left time: 2197.1797s
	iters: 300, epoch: 1 | loss: 1.1998051
	speed: 0.1529s/iter; left time: 2105.2014s
	iters: 400, epoch: 1 | loss: 0.8065647
	speed: 0.1501s/iter; left time: 2052.5119s
Epoch: 1 cost time: 72.1144471168518
Epoch: 1, Steps: 469 | Train Loss: 1.458 Vali Loss: 0.633 Vali Acc: 0.818 Test Loss: 0.633 Test Acc: 0.818
Validation loss decreased (inf --> -0.817604).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2776684
	speed: 0.4873s/iter; left time: 6579.2819s
	iters: 200, epoch: 2 | loss: 0.3134017
	speed: 0.1705s/iter; left time: 2285.3473s
	iters: 300, epoch: 2 | loss: 0.3804822
	speed: 0.1538s/iter; left time: 2045.7586s
	iters: 400, epoch: 2 | loss: 0.2593918
	speed: 0.1006s/iter; left time: 1327.6446s
Epoch: 2 cost time: 71.78422999382019
Epoch: 2, Steps: 469 | Train Loss: 0.363 Vali Loss: 0.257 Vali Acc: 0.912 Test Loss: 0.257 Test Acc: 0.912
Validation loss decreased (-0.817604 --> -0.912233).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2027900
	speed: 0.5629s/iter; left time: 7335.9571s
	iters: 200, epoch: 3 | loss: 0.0468590
	speed: 0.1612s/iter; left time: 2084.9045s
	iters: 300, epoch: 3 | loss: 0.1812170
	speed: 0.1719s/iter; left time: 2206.3726s
	iters: 400, epoch: 3 | loss: 0.2453820
	speed: 0.1726s/iter; left time: 2197.9656s
Epoch: 3 cost time: 78.11196660995483
Epoch: 3, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.912233 --> -0.949970).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0484586
	speed: 0.5413s/iter; left time: 6800.9963s
	iters: 200, epoch: 4 | loss: 0.1224846
	speed: 0.1721s/iter; left time: 2145.4413s
	iters: 300, epoch: 4 | loss: 0.2113329
	speed: 0.1738s/iter; left time: 2149.2162s
	iters: 400, epoch: 4 | loss: 0.0617178
	speed: 0.1643s/iter; left time: 2015.2550s
Epoch: 4 cost time: 79.70924377441406
Epoch: 4, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
Validation loss decreased (-0.949970 --> -0.955116).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0230379
	speed: 0.5666s/iter; left time: 6852.5212s
	iters: 200, epoch: 5 | loss: 0.0895247
	speed: 0.1723s/iter; left time: 2067.1663s
	iters: 300, epoch: 5 | loss: 0.1374439
	speed: 0.1635s/iter; left time: 1944.7848s
	iters: 400, epoch: 5 | loss: 0.0150449
	speed: 0.1608s/iter; left time: 1896.5459s
Epoch: 5 cost time: 79.50760173797607
Epoch: 5, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.120 Vali Acc: 0.961 Test Loss: 0.120 Test Acc: 0.961
Validation loss decreased (-0.955116 --> -0.961119).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0885909
	speed: 0.5292s/iter; left time: 6151.9638s
	iters: 200, epoch: 6 | loss: 0.0354662
	speed: 0.1181s/iter; left time: 1361.2391s
	iters: 300, epoch: 6 | loss: 0.0183455
	speed: 0.1401s/iter; left time: 1601.2258s
	iters: 400, epoch: 6 | loss: 0.0092478
	speed: 0.1401s/iter; left time: 1586.9756s
Epoch: 6 cost time: 63.12867879867554
Epoch: 6, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (-0.961119 --> -0.963121).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0247291
	speed: 0.4571s/iter; left time: 5099.8752s
	iters: 200, epoch: 7 | loss: 0.5370272
	speed: 0.1442s/iter; left time: 1594.9240s
	iters: 300, epoch: 7 | loss: 0.0142941
	speed: 0.1428s/iter; left time: 1564.9477s
	iters: 400, epoch: 7 | loss: 0.0196405
	speed: 0.1449s/iter; left time: 1573.0585s
Epoch: 7 cost time: 67.60556173324585
Epoch: 7, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.963121 --> -0.967980).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0362442
	speed: 0.4192s/iter; left time: 4480.6619s
	iters: 200, epoch: 8 | loss: 0.0350614
	speed: 0.1515s/iter; left time: 1604.4808s
	iters: 300, epoch: 8 | loss: 0.0063692
	speed: 0.1518s/iter; left time: 1592.4500s
	iters: 400, epoch: 8 | loss: 0.0103989
	speed: 0.1515s/iter; left time: 1573.6957s
Epoch: 8 cost time: 70.81909489631653
Epoch: 8, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.967980 --> -0.971411).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0175132
	speed: 0.4942s/iter; left time: 5050.7252s
	iters: 200, epoch: 9 | loss: 0.0096812
	speed: 0.1482s/iter; left time: 1499.7736s
	iters: 300, epoch: 9 | loss: 0.0814941
	speed: 0.1484s/iter; left time: 1486.6165s
	iters: 400, epoch: 9 | loss: 0.0308693
	speed: 0.1475s/iter; left time: 1463.0938s
Epoch: 9 cost time: 69.20169520378113
Epoch: 9, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.971411 --> -0.975128).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0734821
	speed: 0.4938s/iter; left time: 4814.5683s
	iters: 200, epoch: 10 | loss: 0.1446774
	speed: 0.1506s/iter; left time: 1453.4690s
	iters: 300, epoch: 10 | loss: 0.0296672
	speed: 0.1509s/iter; left time: 1440.9277s
	iters: 400, epoch: 10 | loss: 0.0109316
	speed: 0.1433s/iter; left time: 1354.5610s
Epoch: 10 cost time: 68.4694492816925
Epoch: 10, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1602175
	speed: 0.5547s/iter; left time: 5148.2615s
	iters: 200, epoch: 11 | loss: 0.0095102
	speed: 0.1694s/iter; left time: 1555.4662s
	iters: 300, epoch: 11 | loss: 0.0052018
	speed: 0.1891s/iter; left time: 1717.1250s
	iters: 400, epoch: 11 | loss: 0.1095612
	speed: 0.1640s/iter; left time: 1472.9389s
Epoch: 11 cost time: 83.62579798698425
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.975128 --> -0.978272).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0027112
	speed: 0.5639s/iter; left time: 4968.7743s
	iters: 200, epoch: 12 | loss: 0.0056320
	speed: 0.1749s/iter; left time: 1524.1567s
	iters: 300, epoch: 12 | loss: 0.0246283
	speed: 0.1678s/iter; left time: 1444.7574s
	iters: 400, epoch: 12 | loss: 0.0036544
	speed: 0.1806s/iter; left time: 1536.9874s
Epoch: 12 cost time: 81.73000168800354
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0055466
	speed: 0.5100s/iter; left time: 4255.1370s
	iters: 200, epoch: 13 | loss: 0.0046925
	speed: 0.1909s/iter; left time: 1573.2648s
	iters: 300, epoch: 13 | loss: 0.1019543
	speed: 0.1808s/iter; left time: 1471.9072s
	iters: 400, epoch: 13 | loss: 0.0083829
	speed: 0.1872s/iter; left time: 1505.8658s
Epoch: 13 cost time: 78.90953183174133
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0233298
	speed: 0.6073s/iter; left time: 4781.7211s
	iters: 200, epoch: 14 | loss: 0.0051346
	speed: 0.1731s/iter; left time: 1345.3343s
	iters: 300, epoch: 14 | loss: 0.0175736
	speed: 0.1865s/iter; left time: 1430.8317s
	iters: 400, epoch: 14 | loss: 0.0112938
	speed: 0.1762s/iter; left time: 1334.8020s
Epoch: 14 cost time: 85.8911406993866
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.980560).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0007127
	speed: 0.5935s/iter; left time: 4394.5986s
	iters: 200, epoch: 15 | loss: 0.1909856
	speed: 0.1947s/iter; left time: 1422.2400s
	iters: 300, epoch: 15 | loss: 0.0007417
	speed: 0.1774s/iter; left time: 1278.2403s
	iters: 400, epoch: 15 | loss: 0.2374400
	speed: 0.1898s/iter; left time: 1348.2067s
Epoch: 15 cost time: 85.6876769065857
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0143896
	speed: 0.6028s/iter; left time: 4181.1802s
	iters: 200, epoch: 16 | loss: 0.0004076
	speed: 0.1646s/iter; left time: 1125.4470s
	iters: 300, epoch: 16 | loss: 0.0394401
	speed: 0.1833s/iter; left time: 1234.7398s
	iters: 400, epoch: 16 | loss: 0.0386751
	speed: 0.1677s/iter; left time: 1112.8228s
Epoch: 16 cost time: 83.5487847328186
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0049604
	speed: 0.5779s/iter; left time: 3737.3694s
	iters: 200, epoch: 17 | loss: 0.0089945
	speed: 0.1693s/iter; left time: 1078.0191s
	iters: 300, epoch: 17 | loss: 0.0008097
	speed: 0.1615s/iter; left time: 1012.1424s
	iters: 400, epoch: 17 | loss: 0.0775711
	speed: 0.1900s/iter; left time: 1171.4692s
Epoch: 17 cost time: 80.09118628501892
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0431460
	speed: 0.5836s/iter; left time: 3500.5633s
	iters: 200, epoch: 18 | loss: 0.0037604
	speed: 0.1575s/iter; left time: 928.9954s
	iters: 300, epoch: 18 | loss: 0.0023088
	speed: 0.1955s/iter; left time: 1133.7977s
	iters: 400, epoch: 18 | loss: 0.0123438
	speed: 0.1728s/iter; left time: 984.6428s
Epoch: 18 cost time: 84.74554586410522
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0992134
	speed: 0.6002s/iter; left time: 3318.6067s
	iters: 200, epoch: 19 | loss: 0.0013368
	speed: 0.1910s/iter; left time: 1036.7141s
	iters: 300, epoch: 19 | loss: 0.0044350
	speed: 0.1693s/iter; left time: 901.9981s
	iters: 400, epoch: 19 | loss: 0.0171009
	speed: 0.1427s/iter; left time: 746.1637s
Epoch: 19 cost time: 78.6570372581482
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0201969
	speed: 0.5270s/iter; left time: 2666.8622s
	iters: 200, epoch: 20 | loss: 0.0008735
	speed: 0.1577s/iter; left time: 782.0490s
	iters: 300, epoch: 20 | loss: 0.0039422
	speed: 0.1676s/iter; left time: 814.4007s
	iters: 400, epoch: 20 | loss: 0.0541912
	speed: 0.1674s/iter; left time: 796.7804s
Epoch: 20 cost time: 75.85378789901733
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0144000
	speed: 0.5283s/iter; left time: 2425.3507s
	iters: 200, epoch: 21 | loss: 0.0035612
	speed: 0.1533s/iter; left time: 688.3782s
	iters: 300, epoch: 21 | loss: 0.0017776
	speed: 0.1495s/iter; left time: 656.2537s
	iters: 400, epoch: 21 | loss: 0.0015706
	speed: 0.1487s/iter; left time: 638.2113s
Epoch: 21 cost time: 72.97044801712036
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0010624
	speed: 0.5136s/iter; left time: 2117.1089s
	iters: 200, epoch: 22 | loss: 0.0281953
	speed: 0.1458s/iter; left time: 586.2267s
	iters: 300, epoch: 22 | loss: 0.0564596
	speed: 0.1401s/iter; left time: 549.6479s
	iters: 400, epoch: 22 | loss: 0.0028329
	speed: 0.1570s/iter; left time: 600.1679s
Epoch: 22 cost time: 69.83259177207947
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2388243
	speed: 0.5054s/iter; left time: 1846.1595s
	iters: 200, epoch: 23 | loss: 0.0127707
	speed: 0.1578s/iter; left time: 560.6777s
	iters: 300, epoch: 23 | loss: 0.0025503
	speed: 0.1404s/iter; left time: 484.7734s
	iters: 400, epoch: 23 | loss: 0.0006574
	speed: 0.1566s/iter; left time: 525.0284s
Epoch: 23 cost time: 72.95180487632751
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0025029
	speed: 0.5370s/iter; left time: 1709.8153s
	iters: 200, epoch: 24 | loss: 0.0076094
	speed: 0.1511s/iter; left time: 466.0000s
	iters: 300, epoch: 24 | loss: 0.0009673
	speed: 0.1569s/iter; left time: 468.2373s
	iters: 400, epoch: 24 | loss: 0.0016353
	speed: 0.1611s/iter; left time: 464.5105s
Epoch: 24 cost time: 73.56693410873413
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 1173930
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9862908
	speed: 0.1428s/iter; left time: 1994.6129s
	iters: 200, epoch: 1 | loss: 1.7197011
	speed: 0.1169s/iter; left time: 1621.1747s
	iters: 300, epoch: 1 | loss: 1.2556512
	speed: 0.1185s/iter; left time: 1631.3777s
	iters: 400, epoch: 1 | loss: 1.0527327
	speed: 0.1437s/iter; left time: 1963.9471s
Epoch: 1 cost time: 61.805383920669556
Epoch: 1, Steps: 469 | Train Loss: 1.531 Vali Loss: 0.707 Vali Acc: 0.823 Test Loss: 0.707 Test Acc: 0.823
Validation loss decreased (inf --> -0.822749).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5279590
	speed: 0.5055s/iter; left time: 6825.0150s
	iters: 200, epoch: 2 | loss: 0.5446684
	speed: 0.1406s/iter; left time: 1883.7023s
	iters: 300, epoch: 2 | loss: 0.3931557
	speed: 0.1301s/iter; left time: 1730.0426s
	iters: 400, epoch: 2 | loss: 0.1619445
	speed: 0.1439s/iter; left time: 1899.7513s
Epoch: 2 cost time: 64.44698572158813
Epoch: 2, Steps: 469 | Train Loss: 0.413 Vali Loss: 0.269 Vali Acc: 0.916 Test Loss: 0.269 Test Acc: 0.916
Validation loss decreased (-0.822749 --> -0.916235).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3768356
	speed: 0.4849s/iter; left time: 6319.7464s
	iters: 200, epoch: 3 | loss: 0.2844620
	speed: 0.1245s/iter; left time: 1609.5555s
	iters: 300, epoch: 3 | loss: 0.1851649
	speed: 0.1340s/iter; left time: 1719.2353s
	iters: 400, epoch: 3 | loss: 0.0589081
	speed: 0.1180s/iter; left time: 1502.0383s
Epoch: 3 cost time: 61.031349182128906
Epoch: 3, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.194 Vali Acc: 0.942 Test Loss: 0.194 Test Acc: 0.942
Validation loss decreased (-0.916235 --> -0.941965).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1160808
	speed: 0.4861s/iter; left time: 6106.8317s
	iters: 200, epoch: 4 | loss: 0.1051800
	speed: 0.1297s/iter; left time: 1616.9888s
	iters: 300, epoch: 4 | loss: 0.0397337
	speed: 0.1428s/iter; left time: 1765.7045s
	iters: 400, epoch: 4 | loss: 0.0927125
	speed: 0.1244s/iter; left time: 1525.9694s
Epoch: 4 cost time: 63.68573570251465
Epoch: 4, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.941965 --> -0.967123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1438823
	speed: 0.4891s/iter; left time: 5915.4597s
	iters: 200, epoch: 5 | loss: 0.0643963
	speed: 0.1480s/iter; left time: 1774.6812s
	iters: 300, epoch: 5 | loss: 0.0724221
	speed: 0.1397s/iter; left time: 1661.3282s
	iters: 400, epoch: 5 | loss: 0.0645661
	speed: 0.1411s/iter; left time: 1664.6515s
Epoch: 5 cost time: 66.294917345047
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1706478
	speed: 0.5036s/iter; left time: 5854.7830s
	iters: 200, epoch: 6 | loss: 0.0273972
	speed: 0.1467s/iter; left time: 1690.4364s
	iters: 300, epoch: 6 | loss: 0.0124596
	speed: 0.1295s/iter; left time: 1479.3104s
	iters: 400, epoch: 6 | loss: 0.0175258
	speed: 0.1458s/iter; left time: 1650.7760s
Epoch: 6 cost time: 64.9897210597992
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
Validation loss decreased (-0.967123 --> -0.967409).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0108856
	speed: 0.5078s/iter; left time: 5665.3131s
	iters: 200, epoch: 7 | loss: 0.0030747
	speed: 0.1417s/iter; left time: 1566.7388s
	iters: 300, epoch: 7 | loss: 0.0114627
	speed: 0.1402s/iter; left time: 1536.4615s
	iters: 400, epoch: 7 | loss: 0.0154242
	speed: 0.1502s/iter; left time: 1630.2285s
Epoch: 7 cost time: 67.47348165512085
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.967409 --> -0.970554).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0560818
	speed: 0.5087s/iter; left time: 5437.5039s
	iters: 200, epoch: 8 | loss: 0.0260865
	speed: 0.1319s/iter; left time: 1396.8021s
	iters: 300, epoch: 8 | loss: 0.0295814
	speed: 0.1451s/iter; left time: 1521.8299s
	iters: 400, epoch: 8 | loss: 0.0082930
	speed: 0.1273s/iter; left time: 1322.5776s
Epoch: 8 cost time: 61.90240979194641
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2125574
	speed: 0.4167s/iter; left time: 4258.7408s
	iters: 200, epoch: 9 | loss: 0.0070041
	speed: 0.1188s/iter; left time: 1201.7508s
	iters: 300, epoch: 9 | loss: 0.0090114
	speed: 0.1005s/iter; left time: 1006.6529s
	iters: 400, epoch: 9 | loss: 0.0122040
	speed: 0.1202s/iter; left time: 1191.9850s
Epoch: 9 cost time: 53.90457582473755
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.970554 --> -0.970840).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0029129
	speed: 0.4320s/iter; left time: 4211.8300s
	iters: 200, epoch: 10 | loss: 0.1200650
	speed: 0.1240s/iter; left time: 1197.0227s
	iters: 300, epoch: 10 | loss: 0.0013895
	speed: 0.1232s/iter; left time: 1176.4287s
	iters: 400, epoch: 10 | loss: 0.0203065
	speed: 0.1129s/iter; left time: 1067.0778s
Epoch: 10 cost time: 55.76815485954285
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.970840 --> -0.974842).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0018028
	speed: 0.4540s/iter; left time: 4213.4162s
	iters: 200, epoch: 11 | loss: 0.0109782
	speed: 0.1250s/iter; left time: 1147.5028s
	iters: 300, epoch: 11 | loss: 0.0014817
	speed: 0.1276s/iter; left time: 1158.9636s
	iters: 400, epoch: 11 | loss: 0.0406448
	speed: 0.1307s/iter; left time: 1174.0093s
Epoch: 11 cost time: 60.100056409835815
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975985).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0013359
	speed: 0.4516s/iter; left time: 3979.5072s
	iters: 200, epoch: 12 | loss: 0.0016724
	speed: 0.1277s/iter; left time: 1112.6453s
	iters: 300, epoch: 12 | loss: 0.0240660
	speed: 0.1293s/iter; left time: 1113.6763s
	iters: 400, epoch: 12 | loss: 0.0014745
	speed: 0.1198s/iter; left time: 1019.6291s
Epoch: 12 cost time: 58.82452893257141
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1216641
	speed: 0.4600s/iter; left time: 3837.4353s
	iters: 200, epoch: 13 | loss: 0.0092132
	speed: 0.1268s/iter; left time: 1045.4291s
	iters: 300, epoch: 13 | loss: 0.0105582
	speed: 0.1235s/iter; left time: 1005.4598s
	iters: 400, epoch: 13 | loss: 0.2245975
	speed: 0.1327s/iter; left time: 1066.9573s
Epoch: 13 cost time: 60.32616066932678
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977129).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1414019
	speed: 0.4497s/iter; left time: 3541.2126s
	iters: 200, epoch: 14 | loss: 0.0911202
	speed: 0.1187s/iter; left time: 922.8110s
	iters: 300, epoch: 14 | loss: 0.0097226
	speed: 0.1248s/iter; left time: 957.8955s
	iters: 400, epoch: 14 | loss: 0.1087031
	speed: 0.1143s/iter; left time: 866.0530s
Epoch: 14 cost time: 54.94999051094055
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0029290
	speed: 0.4206s/iter; left time: 3114.5911s
	iters: 200, epoch: 15 | loss: 0.0231825
	speed: 0.1086s/iter; left time: 793.5307s
	iters: 300, epoch: 15 | loss: 0.0434313
	speed: 0.1198s/iter; left time: 862.8881s
	iters: 400, epoch: 15 | loss: 0.0223473
	speed: 0.1143s/iter; left time: 812.3084s
Epoch: 15 cost time: 55.008054971694946
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979702).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0431556
	speed: 0.4367s/iter; left time: 3028.7814s
	iters: 200, epoch: 16 | loss: 0.0159431
	speed: 0.1179s/iter; left time: 805.6226s
	iters: 300, epoch: 16 | loss: 0.0101674
	speed: 0.1118s/iter; left time: 752.9636s
	iters: 400, epoch: 16 | loss: 0.0374359
	speed: 0.1137s/iter; left time: 754.5387s
Epoch: 16 cost time: 55.62536263465881
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0014605
	speed: 0.4608s/iter; left time: 2979.8457s
	iters: 200, epoch: 17 | loss: 0.0066248
	speed: 0.1224s/iter; left time: 779.0904s
	iters: 300, epoch: 17 | loss: 0.0287026
	speed: 0.1267s/iter; left time: 793.7655s
	iters: 400, epoch: 17 | loss: 0.0015284
	speed: 0.1301s/iter; left time: 802.0620s
Epoch: 17 cost time: 59.747275590896606
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0115126
	speed: 0.4643s/iter; left time: 2784.7956s
	iters: 200, epoch: 18 | loss: 0.0041484
	speed: 0.1227s/iter; left time: 723.6179s
	iters: 300, epoch: 18 | loss: 0.1551161
	speed: 0.1296s/iter; left time: 751.5403s
	iters: 400, epoch: 18 | loss: 0.0029510
	speed: 0.1291s/iter; left time: 735.4551s
Epoch: 18 cost time: 59.58489537239075
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0160733
	speed: 0.4536s/iter; left time: 2508.1649s
	iters: 200, epoch: 19 | loss: 0.0157296
	speed: 0.1244s/iter; left time: 675.3267s
	iters: 300, epoch: 19 | loss: 0.0025147
	speed: 0.1109s/iter; left time: 590.8903s
	iters: 400, epoch: 19 | loss: 0.0008052
	speed: 0.1113s/iter; left time: 581.9750s
Epoch: 19 cost time: 54.72259259223938
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0467136
	speed: 0.4184s/iter; left time: 2116.9243s
	iters: 200, epoch: 20 | loss: 0.1617298
	speed: 0.1121s/iter; left time: 555.8955s
	iters: 300, epoch: 20 | loss: 0.0014303
	speed: 0.1083s/iter; left time: 526.2785s
	iters: 400, epoch: 20 | loss: 0.0555864
	speed: 0.1096s/iter; left time: 521.6328s
Epoch: 20 cost time: 52.63173151016235
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0006728
	speed: 0.3941s/iter; left time: 1809.3780s
	iters: 200, epoch: 21 | loss: 0.0118926
	speed: 0.1128s/iter; left time: 506.7046s
	iters: 300, epoch: 21 | loss: 0.0056914
	speed: 0.1111s/iter; left time: 487.7269s
	iters: 400, epoch: 21 | loss: 0.0013704
	speed: 0.1109s/iter; left time: 475.8589s
Epoch: 21 cost time: 50.683271169662476
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0234878
	speed: 0.4062s/iter; left time: 1674.3012s
	iters: 200, epoch: 22 | loss: 0.0026525
	speed: 0.1064s/iter; left time: 427.8963s
	iters: 300, epoch: 22 | loss: 0.0022655
	speed: 0.1016s/iter; left time: 398.5412s
	iters: 400, epoch: 22 | loss: 0.0684532
	speed: 0.1159s/iter; left time: 442.9815s
Epoch: 22 cost time: 51.43782329559326
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003381
	speed: 0.4196s/iter; left time: 1532.8416s
	iters: 200, epoch: 23 | loss: 0.0005496
	speed: 0.1159s/iter; left time: 411.9628s
	iters: 300, epoch: 23 | loss: 0.0008345
	speed: 0.1134s/iter; left time: 391.4452s
	iters: 400, epoch: 23 | loss: 0.3310539
	speed: 0.1150s/iter; left time: 385.5948s
Epoch: 23 cost time: 54.744887828826904
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0312479
	speed: 0.4267s/iter; left time: 1358.6603s
	iters: 200, epoch: 24 | loss: 0.0046785
	speed: 0.1192s/iter; left time: 367.6609s
	iters: 300, epoch: 24 | loss: 0.0008577
	speed: 0.1183s/iter; left time: 353.0795s
	iters: 400, epoch: 24 | loss: 0.0014048
	speed: 0.1173s/iter; left time: 338.2600s
Epoch: 24 cost time: 55.44136953353882
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0024882
	speed: 0.4185s/iter; left time: 1136.3239s
	iters: 200, epoch: 25 | loss: 0.0009214
	speed: 0.1156s/iter; left time: 302.4200s
	iters: 300, epoch: 25 | loss: 0.0029157
	speed: 0.1501s/iter; left time: 377.3863s
	iters: 400, epoch: 25 | loss: 0.0124239
	speed: 0.1353s/iter; left time: 326.6614s
Epoch: 25 cost time: 61.08728289604187
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0063374
	speed: 0.4885s/iter; left time: 1097.1436s
	iters: 200, epoch: 26 | loss: 0.0003515
	speed: 0.1375s/iter; left time: 295.0110s
	iters: 300, epoch: 26 | loss: 0.0015667
	speed: 0.1302s/iter; left time: 266.3687s
	iters: 400, epoch: 26 | loss: 0.0011258
	speed: 0.1348s/iter; left time: 262.2787s
Epoch: 26 cost time: 63.083776235580444
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0020066
	speed: 0.4811s/iter; left time: 854.8339s
	iters: 200, epoch: 27 | loss: 0.0001403
	speed: 0.1483s/iter; left time: 248.7359s
	iters: 300, epoch: 27 | loss: 0.1854330
	speed: 0.1269s/iter; left time: 200.1746s
	iters: 400, epoch: 27 | loss: 0.0013216
	speed: 0.1465s/iter; left time: 216.3169s
Epoch: 27 cost time: 64.72475409507751
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0090748
	speed: 0.4781s/iter; left time: 625.3303s
	iters: 200, epoch: 28 | loss: 0.0015619
	speed: 0.1520s/iter; left time: 183.5679s
	iters: 300, epoch: 28 | loss: 0.0093458
	speed: 0.1358s/iter; left time: 150.5080s
	iters: 400, epoch: 28 | loss: 0.0094800
	speed: 0.1513s/iter; left time: 152.5041s
Epoch: 28 cost time: 64.93042635917664
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0011571
	speed: 0.5125s/iter; left time: 430.0052s
	iters: 200, epoch: 29 | loss: 0.2851513
	speed: 0.1404s/iter; left time: 103.7275s
	iters: 300, epoch: 29 | loss: 0.0037248
	speed: 0.1448s/iter; left time: 92.5003s
	iters: 400, epoch: 29 | loss: 0.0089257
	speed: 0.1417s/iter; left time: 76.3845s
Epoch: 29 cost time: 66.95762753486633
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0007116
	speed: 0.5279s/iter; left time: 195.3167s
	iters: 200, epoch: 30 | loss: 0.0108114
	speed: 0.1363s/iter; left time: 36.8109s
	iters: 300, epoch: 30 | loss: 0.0022830
	speed: 0.1562s/iter; left time: 26.5553s
	iters: 400, epoch: 30 | loss: 0.0005550
	speed: 0.1358s/iter; left time: 9.5059s
Epoch: 30 cost time: 69.35983562469482
Epoch: 30, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.981703 --> -0.982275).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 345962
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1581762
	speed: 0.4705s/iter; left time: 6572.9985s
	iters: 200, epoch: 1 | loss: 1.7250085
	speed: 0.4358s/iter; left time: 6045.2931s
	iters: 300, epoch: 1 | loss: 1.1492379
	speed: 0.4478s/iter; left time: 6166.2528s
	iters: 400, epoch: 1 | loss: 0.8563903
	speed: 0.4600s/iter; left time: 6289.2066s
Epoch: 1 cost time: 213.90446138381958
Epoch: 1, Steps: 469 | Train Loss: 1.437 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
Validation loss decreased (inf --> -0.867061).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3821093
	speed: 1.0955s/iter; left time: 14791.9195s
	iters: 200, epoch: 2 | loss: 0.2302075
	speed: 0.4563s/iter; left time: 6114.7661s
	iters: 300, epoch: 2 | loss: 0.1289912
	speed: 0.4239s/iter; left time: 5639.1129s
	iters: 400, epoch: 2 | loss: 0.1692222
	speed: 0.4398s/iter; left time: 5805.8899s
Epoch: 2 cost time: 208.50929808616638
Epoch: 2, Steps: 469 | Train Loss: 0.309 Vali Loss: 0.230 Vali Acc: 0.929 Test Loss: 0.230 Test Acc: 0.929
Validation loss decreased (-0.867061 --> -0.929100).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0900010
	speed: 1.0536s/iter; left time: 13731.9067s
	iters: 200, epoch: 3 | loss: 0.0606697
	speed: 0.3857s/iter; left time: 4988.1417s
	iters: 300, epoch: 3 | loss: 0.1780297
	speed: 0.3960s/iter; left time: 5081.3809s
	iters: 400, epoch: 3 | loss: 0.1824461
	speed: 0.3735s/iter; left time: 4755.9133s
Epoch: 3 cost time: 187.60952305793762
Epoch: 3, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.929100 --> -0.962263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0430688
	speed: 0.9775s/iter; left time: 12281.7421s
	iters: 200, epoch: 4 | loss: 0.0083405
	speed: 0.4318s/iter; left time: 5382.1704s
	iters: 300, epoch: 4 | loss: 0.0652114
	speed: 0.4402s/iter; left time: 5442.3834s
	iters: 400, epoch: 4 | loss: 0.0142789
	speed: 0.4338s/iter; left time: 5319.6480s
Epoch: 4 cost time: 200.1279013156891
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.962263 --> -0.965693).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0590099
	speed: 1.0125s/iter; left time: 12245.9640s
	iters: 200, epoch: 5 | loss: 0.1843898
	speed: 0.4596s/iter; left time: 5513.1260s
	iters: 300, epoch: 5 | loss: 0.0180311
	speed: 0.4230s/iter; left time: 5032.1555s
	iters: 400, epoch: 5 | loss: 0.0100093
	speed: 0.4117s/iter; left time: 4856.3723s
Epoch: 5 cost time: 200.1583001613617
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4375770
	speed: 1.0214s/iter; left time: 11875.2458s
	iters: 200, epoch: 6 | loss: 0.0072601
	speed: 0.3897s/iter; left time: 4491.6182s
	iters: 300, epoch: 6 | loss: 0.4818947
	speed: 0.4526s/iter; left time: 5171.1806s
	iters: 400, epoch: 6 | loss: 0.0057881
	speed: 0.4477s/iter; left time: 5070.6306s
Epoch: 6 cost time: 189.25199055671692
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.965693 --> -0.974556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0394954
	speed: 0.8032s/iter; left time: 8960.8451s
	iters: 200, epoch: 7 | loss: 0.0288890
	speed: 0.4315s/iter; left time: 4771.1975s
	iters: 300, epoch: 7 | loss: 0.0157429
	speed: 0.3581s/iter; left time: 3923.9514s
	iters: 400, epoch: 7 | loss: 0.1707054
	speed: 0.3601s/iter; left time: 3909.4378s
Epoch: 7 cost time: 182.28563618659973
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0168174
	speed: 0.9475s/iter; left time: 10126.7060s
	iters: 200, epoch: 8 | loss: 0.1154661
	speed: 0.3402s/iter; left time: 3601.7037s
	iters: 300, epoch: 8 | loss: 0.0628014
	speed: 0.2988s/iter; left time: 3134.0909s
	iters: 400, epoch: 8 | loss: 0.0142822
	speed: 0.3140s/iter; left time: 3261.8272s
Epoch: 8 cost time: 155.1778450012207
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0038955
	speed: 0.8858s/iter; left time: 9051.6482s
	iters: 200, epoch: 9 | loss: 0.0021119
	speed: 0.3416s/iter; left time: 3457.0709s
	iters: 300, epoch: 9 | loss: 0.0026041
	speed: 0.2983s/iter; left time: 2988.9579s
	iters: 400, epoch: 9 | loss: 0.0028162
	speed: 0.2739s/iter; left time: 2716.3427s
Epoch: 9 cost time: 157.24022245407104
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.974556 --> -0.979130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1675852
	speed: 0.9495s/iter; left time: 9258.0245s
	iters: 200, epoch: 10 | loss: 0.0593048
	speed: 0.3178s/iter; left time: 3066.8203s
	iters: 300, epoch: 10 | loss: 0.0048710
	speed: 0.3104s/iter; left time: 2964.1401s
	iters: 400, epoch: 10 | loss: 0.0115671
	speed: 0.3239s/iter; left time: 3060.6808s
Epoch: 10 cost time: 161.34619212150574
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0302222
	speed: 0.8970s/iter; left time: 8325.1583s
	iters: 200, epoch: 11 | loss: 0.0282768
	speed: 0.3005s/iter; left time: 2758.5096s
	iters: 300, epoch: 11 | loss: 0.0029894
	speed: 0.3103s/iter; left time: 2818.0306s
	iters: 400, epoch: 11 | loss: 0.0021834
	speed: 0.3638s/iter; left time: 3266.9678s
Epoch: 11 cost time: 160.02660131454468
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0174562
	speed: 0.8998s/iter; left time: 7929.1491s
	iters: 200, epoch: 12 | loss: 0.0211544
	speed: 0.3279s/iter; left time: 2856.7763s
	iters: 300, epoch: 12 | loss: 0.0754735
	speed: 0.2507s/iter; left time: 2158.9276s
	iters: 400, epoch: 12 | loss: 0.1035725
	speed: 0.3687s/iter; left time: 3138.7699s
Epoch: 12 cost time: 154.84909772872925
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0018840
	speed: 0.8283s/iter; left time: 6910.7230s
	iters: 200, epoch: 13 | loss: 0.0045673
	speed: 0.3027s/iter; left time: 2495.0945s
	iters: 300, epoch: 13 | loss: 0.0011612
	speed: 0.3208s/iter; left time: 2612.6260s
	iters: 400, epoch: 13 | loss: 0.0110145
	speed: 0.3797s/iter; left time: 3054.3289s
Epoch: 13 cost time: 156.6103138923645
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0023202
	speed: 0.7941s/iter; left time: 6252.6255s
	iters: 200, epoch: 14 | loss: 0.0264605
	speed: 0.2765s/iter; left time: 2149.6038s
	iters: 300, epoch: 14 | loss: 0.1433821
	speed: 0.3352s/iter; left time: 2571.9491s
	iters: 400, epoch: 14 | loss: 0.0116549
	speed: 0.3667s/iter; left time: 2777.3258s
Epoch: 14 cost time: 151.8574800491333
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.979130 --> -0.984276).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0034248
	speed: 1.0068s/iter; left time: 7455.3968s
	iters: 200, epoch: 15 | loss: 0.0011859
	speed: 0.4386s/iter; left time: 3203.8219s
	iters: 300, epoch: 15 | loss: 0.0020694
	speed: 0.4839s/iter; left time: 3486.5394s
	iters: 400, epoch: 15 | loss: 0.0226265
	speed: 0.4619s/iter; left time: 3281.8621s
Epoch: 15 cost time: 210.89874696731567
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0078343
	speed: 1.0376s/iter; left time: 7196.7539s
	iters: 200, epoch: 16 | loss: 0.0653826
	speed: 0.4873s/iter; left time: 3331.4133s
	iters: 300, epoch: 16 | loss: 0.0006804
	speed: 0.4781s/iter; left time: 3220.4854s
	iters: 400, epoch: 16 | loss: 0.0035159
	speed: 0.3934s/iter; left time: 2610.5567s
Epoch: 16 cost time: 207.25549387931824
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0059542
	speed: 1.0634s/iter; left time: 6877.0827s
	iters: 200, epoch: 17 | loss: 0.0020067
	speed: 0.5048s/iter; left time: 3213.7799s
	iters: 300, epoch: 17 | loss: 0.0747864
	speed: 0.4395s/iter; left time: 2754.4524s
	iters: 400, epoch: 17 | loss: 0.0035599
	speed: 0.3828s/iter; left time: 2360.4814s
Epoch: 17 cost time: 208.78725004196167
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0027116
	speed: 1.1029s/iter; left time: 6615.1676s
	iters: 200, epoch: 18 | loss: 0.0096122
	speed: 0.4569s/iter; left time: 2694.7498s
	iters: 300, epoch: 18 | loss: 0.0013141
	speed: 0.3139s/iter; left time: 1820.2395s
	iters: 400, epoch: 18 | loss: 0.0017865
	speed: 0.3582s/iter; left time: 2041.2151s
Epoch: 18 cost time: 186.51407265663147
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0009958
	speed: 0.9801s/iter; left time: 5419.0823s
	iters: 200, epoch: 19 | loss: 0.0014379
	speed: 0.3788s/iter; left time: 2056.6487s
	iters: 300, epoch: 19 | loss: 0.0101427
	speed: 0.3351s/iter; left time: 1785.9333s
	iters: 400, epoch: 19 | loss: 0.0011262
	speed: 0.3313s/iter; left time: 1732.5688s
Epoch: 19 cost time: 174.27091598510742
Epoch: 19, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0030716
	speed: 0.6883s/iter; left time: 3482.9720s
	iters: 200, epoch: 20 | loss: 0.0012306
	speed: 0.4505s/iter; left time: 2234.7168s
	iters: 300, epoch: 20 | loss: 0.0007706
	speed: 0.4439s/iter; left time: 2157.1424s
	iters: 400, epoch: 20 | loss: 0.0010551
	speed: 0.4406s/iter; left time: 2097.1913s
Epoch: 20 cost time: 185.1071765422821
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0017923
	speed: 1.0224s/iter; left time: 4693.7782s
	iters: 200, epoch: 21 | loss: 0.0163188
	speed: 0.3781s/iter; left time: 1698.1392s
	iters: 300, epoch: 21 | loss: 0.0020038
	speed: 0.4103s/iter; left time: 1801.4699s
	iters: 400, epoch: 21 | loss: 0.0010006
	speed: 0.3504s/iter; left time: 1503.7040s
Epoch: 21 cost time: 186.36949706077576
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0201377
	speed: 1.1140s/iter; left time: 4591.9218s
	iters: 200, epoch: 22 | loss: 0.0330933
	speed: 0.4788s/iter; left time: 1925.6217s
	iters: 300, epoch: 22 | loss: 0.0025968
	speed: 0.4750s/iter; left time: 1862.9979s
	iters: 400, epoch: 22 | loss: 0.0005885
	speed: 0.4561s/iter; left time: 1743.0399s
Epoch: 22 cost time: 219.40599942207336
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0009896
	speed: 1.0405s/iter; left time: 3800.9921s
	iters: 200, epoch: 23 | loss: 0.0052926
	speed: 0.3470s/iter; left time: 1232.8268s
	iters: 300, epoch: 23 | loss: 0.0103085
	speed: 0.4833s/iter; left time: 1668.9033s
	iters: 400, epoch: 23 | loss: 0.0009787
	speed: 0.4885s/iter; left time: 1637.9066s
Epoch: 23 cost time: 208.4355344772339
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0002384
	speed: 1.1253s/iter; left time: 3582.9106s
	iters: 200, epoch: 24 | loss: 0.0269798
	speed: 0.4402s/iter; left time: 1357.5279s
	iters: 300, epoch: 24 | loss: 0.0014337
	speed: 0.4320s/iter; left time: 1289.1871s
	iters: 400, epoch: 24 | loss: 0.0069575
	speed: 0.4382s/iter; left time: 1263.8594s
Epoch: 24 cost time: 209.63298964500427
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 587434
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0973437
	speed: 0.2727s/iter; left time: 3809.2044s
	iters: 200, epoch: 1 | loss: 1.5291655
	speed: 0.2833s/iter; left time: 3929.7141s
	iters: 300, epoch: 1 | loss: 1.1780396
	speed: 0.2711s/iter; left time: 3733.0458s
	iters: 400, epoch: 1 | loss: 0.8952174
	speed: 0.2785s/iter; left time: 3807.9157s
Epoch: 1 cost time: 129.47476053237915
Epoch: 1, Steps: 469 | Train Loss: 1.423 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (inf --> -0.856484).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5575058
	speed: 0.7410s/iter; left time: 10004.4832s
	iters: 200, epoch: 2 | loss: 0.1733498
	speed: 0.2399s/iter; left time: 3214.6461s
	iters: 300, epoch: 2 | loss: 0.2170457
	speed: 0.2613s/iter; left time: 3476.3435s
	iters: 400, epoch: 2 | loss: 0.2148018
	speed: 0.2467s/iter; left time: 3257.0739s
Epoch: 2 cost time: 118.7550368309021
Epoch: 2, Steps: 469 | Train Loss: 0.329 Vali Loss: 0.222 Vali Acc: 0.932 Test Loss: 0.222 Test Acc: 0.932
Validation loss decreased (-0.856484 --> -0.931959).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1119629
	speed: 0.6748s/iter; left time: 8794.5841s
	iters: 200, epoch: 3 | loss: 0.1328414
	speed: 0.1957s/iter; left time: 2531.5608s
	iters: 300, epoch: 3 | loss: 0.2793252
	speed: 0.2668s/iter; left time: 3424.1998s
	iters: 400, epoch: 3 | loss: 0.0155051
	speed: 0.2755s/iter; left time: 3508.1805s
Epoch: 3 cost time: 117.82572817802429
Epoch: 3, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.931959 --> -0.964264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0752977
	speed: 0.7346s/iter; left time: 9229.8168s
	iters: 200, epoch: 4 | loss: 0.0115015
	speed: 0.2830s/iter; left time: 3527.7208s
	iters: 300, epoch: 4 | loss: 0.1945394
	speed: 0.2841s/iter; left time: 3513.0318s
	iters: 400, epoch: 4 | loss: 0.0204244
	speed: 0.2503s/iter; left time: 3069.4424s
Epoch: 4 cost time: 126.85014629364014
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
Validation loss decreased (-0.964264 --> -0.968838).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0476644
	speed: 0.6625s/iter; left time: 8012.5365s
	iters: 200, epoch: 5 | loss: 0.0438967
	speed: 0.2313s/iter; left time: 2774.1693s
	iters: 300, epoch: 5 | loss: 0.0159616
	speed: 0.2546s/iter; left time: 3029.0180s
	iters: 400, epoch: 5 | loss: 0.0383951
	speed: 0.1918s/iter; left time: 2262.2575s
Epoch: 5 cost time: 108.90628099441528
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.968838 --> -0.976271).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0541439
	speed: 0.7495s/iter; left time: 8713.2099s
	iters: 200, epoch: 6 | loss: 0.0752484
	speed: 0.2815s/iter; left time: 3244.1757s
	iters: 300, epoch: 6 | loss: 0.2292092
	speed: 0.2859s/iter; left time: 3267.1223s
	iters: 400, epoch: 6 | loss: 0.0426101
	speed: 0.2861s/iter; left time: 3240.5473s
Epoch: 6 cost time: 133.94338750839233
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1168065
	speed: 0.7234s/iter; left time: 8070.7404s
	iters: 200, epoch: 7 | loss: 0.0301778
	speed: 0.2375s/iter; left time: 2625.5406s
	iters: 300, epoch: 7 | loss: 0.0531534
	speed: 0.2420s/iter; left time: 2651.6685s
	iters: 400, epoch: 7 | loss: 0.0067114
	speed: 0.2423s/iter; left time: 2630.8071s
Epoch: 7 cost time: 115.96724581718445
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977129).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2041133
	speed: 0.6844s/iter; left time: 7314.3902s
	iters: 200, epoch: 8 | loss: 0.1241276
	speed: 0.2543s/iter; left time: 2692.6661s
	iters: 300, epoch: 8 | loss: 0.0195187
	speed: 0.2627s/iter; left time: 2755.0480s
	iters: 400, epoch: 8 | loss: 0.0028064
	speed: 0.2641s/iter; left time: 2742.9884s
Epoch: 8 cost time: 119.29789710044861
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.979416).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0092209
	speed: 0.6952s/iter; left time: 7104.3979s
	iters: 200, epoch: 9 | loss: 0.0012725
	speed: 0.2600s/iter; left time: 2630.5559s
	iters: 300, epoch: 9 | loss: 0.1735012
	speed: 0.2265s/iter; left time: 2269.2487s
	iters: 400, epoch: 9 | loss: 0.0035356
	speed: 0.2411s/iter; left time: 2391.3568s
Epoch: 9 cost time: 114.36476635932922
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0348236
	speed: 0.6369s/iter; left time: 6210.0883s
	iters: 200, epoch: 10 | loss: 0.0915529
	speed: 0.2328s/iter; left time: 2246.3719s
	iters: 300, epoch: 10 | loss: 0.0140609
	speed: 0.2240s/iter; left time: 2139.4711s
	iters: 400, epoch: 10 | loss: 0.0029734
	speed: 0.2604s/iter; left time: 2460.9864s
Epoch: 10 cost time: 113.0868718624115
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0048713
	speed: 0.7037s/iter; left time: 6530.8688s
	iters: 200, epoch: 11 | loss: 0.0045884
	speed: 0.3034s/iter; left time: 2785.6311s
	iters: 300, epoch: 11 | loss: 0.0143395
	speed: 0.3064s/iter; left time: 2782.6952s
	iters: 400, epoch: 11 | loss: 0.0019627
	speed: 0.3096s/iter; left time: 2780.9032s
Epoch: 11 cost time: 140.9173505306244
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0175454
	speed: 0.7805s/iter; left time: 6877.5243s
	iters: 200, epoch: 12 | loss: 0.0057911
	speed: 0.2787s/iter; left time: 2428.0438s
	iters: 300, epoch: 12 | loss: 0.2521949
	speed: 0.2802s/iter; left time: 2413.1087s
	iters: 400, epoch: 12 | loss: 0.0041678
	speed: 0.2674s/iter; left time: 2275.7069s
Epoch: 12 cost time: 129.4227638244629
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0049617
	speed: 0.7564s/iter; left time: 6310.4846s
	iters: 200, epoch: 13 | loss: 0.0577834
	speed: 0.3095s/iter; left time: 2551.1704s
	iters: 300, epoch: 13 | loss: 0.0651318
	speed: 0.3071s/iter; left time: 2500.9772s
	iters: 400, epoch: 13 | loss: 0.0126412
	speed: 0.3079s/iter; left time: 2476.2178s
Epoch: 13 cost time: 145.07064127922058
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.979416 --> -0.983133).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0080160
	speed: 0.8042s/iter; left time: 6332.4334s
	iters: 200, epoch: 14 | loss: 0.0030237
	speed: 0.2738s/iter; left time: 2128.6245s
	iters: 300, epoch: 14 | loss: 0.0107149
	speed: 0.2780s/iter; left time: 2133.1706s
	iters: 400, epoch: 14 | loss: 0.0010497
	speed: 0.2722s/iter; left time: 2061.9476s
Epoch: 14 cost time: 131.20496892929077
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0336649
	speed: 0.7628s/iter; left time: 5648.5284s
	iters: 200, epoch: 15 | loss: 0.0086357
	speed: 0.2853s/iter; left time: 2084.4433s
	iters: 300, epoch: 15 | loss: 0.0129293
	speed: 0.3113s/iter; left time: 2242.8828s
	iters: 400, epoch: 15 | loss: 0.0306060
	speed: 0.3092s/iter; left time: 2196.7079s
Epoch: 15 cost time: 141.52677273750305
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0030033
	speed: 0.7684s/iter; left time: 5329.7986s
	iters: 200, epoch: 16 | loss: 0.0056685
	speed: 0.2714s/iter; left time: 1855.4667s
	iters: 300, epoch: 16 | loss: 0.0033976
	speed: 0.2686s/iter; left time: 1809.4091s
	iters: 400, epoch: 16 | loss: 0.0019451
	speed: 0.2357s/iter; left time: 1563.9137s
Epoch: 16 cost time: 120.70148491859436
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.983133 --> -0.983990).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0013401
	speed: 0.6663s/iter; left time: 4309.1017s
	iters: 200, epoch: 17 | loss: 0.0019277
	speed: 0.2524s/iter; left time: 1607.2494s
	iters: 300, epoch: 17 | loss: 0.0165252
	speed: 0.2432s/iter; left time: 1524.3452s
	iters: 400, epoch: 17 | loss: 0.0015642
	speed: 0.2470s/iter; left time: 1523.2342s
Epoch: 17 cost time: 116.54003357887268
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0153123
	speed: 0.7323s/iter; left time: 4392.4870s
	iters: 200, epoch: 18 | loss: 0.0032131
	speed: 0.2675s/iter; left time: 1577.7467s
	iters: 300, epoch: 18 | loss: 0.0002620
	speed: 0.2623s/iter; left time: 1520.6242s
	iters: 400, epoch: 18 | loss: 0.0015244
	speed: 0.2802s/iter; left time: 1596.5706s
Epoch: 18 cost time: 127.23555016517639
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0113609
	speed: 0.6799s/iter; left time: 3758.8954s
	iters: 200, epoch: 19 | loss: 0.0008190
	speed: 0.2504s/iter; left time: 1359.3600s
	iters: 300, epoch: 19 | loss: 0.0062940
	speed: 0.2353s/iter; left time: 1254.1528s
	iters: 400, epoch: 19 | loss: 0.0029421
	speed: 0.2194s/iter; left time: 1147.3454s
Epoch: 19 cost time: 110.65820956230164
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0050683
	speed: 0.7142s/iter; left time: 3613.6760s
	iters: 200, epoch: 20 | loss: 0.0024883
	speed: 0.2914s/iter; left time: 1445.1076s
	iters: 300, epoch: 20 | loss: 0.0093554
	speed: 0.3011s/iter; left time: 1463.4794s
	iters: 400, epoch: 20 | loss: 0.0524858
	speed: 0.2909s/iter; left time: 1384.7321s
Epoch: 20 cost time: 137.82280659675598
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984848).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0286670
	speed: 0.7773s/iter; left time: 3568.4475s
	iters: 200, epoch: 21 | loss: 0.0060343
	speed: 0.2587s/iter; left time: 1161.7848s
	iters: 300, epoch: 21 | loss: 0.2085500
	speed: 0.2573s/iter; left time: 1129.7021s
	iters: 400, epoch: 21 | loss: 0.0008331
	speed: 0.2534s/iter; left time: 1087.1802s
Epoch: 21 cost time: 123.70958113670349
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0034864
	speed: 0.7184s/iter; left time: 2961.1954s
	iters: 200, epoch: 22 | loss: 0.0015268
	speed: 0.2671s/iter; left time: 1074.1754s
	iters: 300, epoch: 22 | loss: 0.2445818
	speed: 0.2913s/iter; left time: 1142.2960s
	iters: 400, epoch: 22 | loss: 0.0025084
	speed: 0.2896s/iter; left time: 1106.8123s
Epoch: 22 cost time: 133.19394516944885
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0032209
	speed: 0.7135s/iter; left time: 2606.4526s
	iters: 200, epoch: 23 | loss: 0.0013890
	speed: 0.2616s/iter; left time: 929.4217s
	iters: 300, epoch: 23 | loss: 0.0022870
	speed: 0.2555s/iter; left time: 882.2442s
	iters: 400, epoch: 23 | loss: 0.0018995
	speed: 0.2287s/iter; left time: 766.9878s
Epoch: 23 cost time: 116.40315961837769
Epoch: 23, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0010825
	speed: 0.6355s/iter; left time: 2023.4844s
	iters: 200, epoch: 24 | loss: 0.0306589
	speed: 0.2378s/iter; left time: 733.3212s
	iters: 300, epoch: 24 | loss: 0.0004926
	speed: 0.2401s/iter; left time: 716.4094s
	iters: 400, epoch: 24 | loss: 0.0004062
	speed: 0.2282s/iter; left time: 657.9896s
Epoch: 24 cost time: 111.01965689659119
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0338209
	speed: 0.6911s/iter; left time: 1876.4506s
	iters: 200, epoch: 25 | loss: 0.0046481
	speed: 0.2589s/iter; left time: 677.1402s
	iters: 300, epoch: 25 | loss: 0.0014599
	speed: 0.2558s/iter; left time: 643.3811s
	iters: 400, epoch: 25 | loss: 0.0011508
	speed: 0.2604s/iter; left time: 628.8118s
Epoch: 25 cost time: 121.25210905075073
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0022576
	speed: 0.6705s/iter; left time: 1505.9249s
	iters: 200, epoch: 26 | loss: 0.0087337
	speed: 0.2390s/iter; left time: 512.8023s
	iters: 300, epoch: 26 | loss: 0.0153718
	speed: 0.2204s/iter; left time: 450.9308s
	iters: 400, epoch: 26 | loss: 0.0012104
	speed: 0.2359s/iter; left time: 459.1494s
Epoch: 26 cost time: 109.10272288322449
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0223603
	speed: 0.6710s/iter; left time: 1192.2896s
	iters: 200, epoch: 27 | loss: 0.0010748
	speed: 0.2619s/iter; left time: 439.2064s
	iters: 300, epoch: 27 | loss: 0.0006337
	speed: 0.2634s/iter; left time: 415.4487s
	iters: 400, epoch: 27 | loss: 0.0835347
	speed: 0.2691s/iter; left time: 397.4836s
Epoch: 27 cost time: 124.83560061454773
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0005636
	speed: 0.7116s/iter; left time: 930.7612s
	iters: 200, epoch: 28 | loss: 0.0014093
	speed: 0.2413s/iter; left time: 291.5069s
	iters: 300, epoch: 28 | loss: 0.0007782
	speed: 0.2419s/iter; left time: 267.9953s
	iters: 400, epoch: 28 | loss: 0.0015901
	speed: 0.2439s/iter; left time: 245.8445s
Epoch: 28 cost time: 114.09705400466919
Epoch: 28, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0007917
	speed: 0.6313s/iter; left time: 529.6880s
	iters: 200, epoch: 29 | loss: 0.0039493
	speed: 0.2053s/iter; left time: 151.6906s
	iters: 300, epoch: 29 | loss: 0.0588986
	speed: 0.2442s/iter; left time: 156.0288s
	iters: 400, epoch: 29 | loss: 0.0032198
	speed: 0.2488s/iter; left time: 134.1238s
Epoch: 29 cost time: 110.68789219856262
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1184733
	speed: 0.6695s/iter; left time: 247.7033s
	iters: 200, epoch: 30 | loss: 0.5414619
	speed: 0.2484s/iter; left time: 67.0748s
	iters: 300, epoch: 30 | loss: 0.0036543
	speed: 0.2437s/iter; left time: 41.4349s
	iters: 400, epoch: 30 | loss: 0.0003452
	speed: 0.2194s/iter; left time: 15.3613s
Epoch: 30 cost time: 111.20671081542969
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 173418
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1564839
	speed: 0.2465s/iter; left time: 3444.3412s
	iters: 200, epoch: 1 | loss: 1.7323631
	speed: 0.2246s/iter; left time: 3115.6109s
	iters: 300, epoch: 1 | loss: 1.1658013
	speed: 0.2559s/iter; left time: 3524.6698s
	iters: 400, epoch: 1 | loss: 0.8446925
	speed: 0.3130s/iter; left time: 4278.4480s
Epoch: 1 cost time: 126.48553705215454
Epoch: 1, Steps: 469 | Train Loss: 1.450 Vali Loss: 0.594 Vali Acc: 0.864 Test Loss: 0.594 Test Acc: 0.864
Validation loss decreased (inf --> -0.864488).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4267153
	speed: 0.8221s/iter; left time: 11100.1459s
	iters: 200, epoch: 2 | loss: 0.2516179
	speed: 0.3219s/iter; left time: 4314.1206s
	iters: 300, epoch: 2 | loss: 0.1429027
	speed: 0.3081s/iter; left time: 4098.2282s
	iters: 400, epoch: 2 | loss: 0.2564356
	speed: 0.2784s/iter; left time: 3675.4459s
Epoch: 2 cost time: 142.975195646286
Epoch: 2, Steps: 469 | Train Loss: 0.328 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.864488 --> -0.936819).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1367020
	speed: 0.7345s/iter; left time: 9572.3334s
	iters: 200, epoch: 3 | loss: 0.0775038
	speed: 0.2980s/iter; left time: 3854.5965s
	iters: 300, epoch: 3 | loss: 0.0972069
	speed: 0.2953s/iter; left time: 3790.0019s
	iters: 400, epoch: 3 | loss: 0.0880949
	speed: 0.2847s/iter; left time: 3625.4589s
Epoch: 3 cost time: 136.6628646850586
Epoch: 3, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.936819 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1383600
	speed: 0.8022s/iter; left time: 10079.3700s
	iters: 200, epoch: 4 | loss: 0.0125062
	speed: 0.3110s/iter; left time: 3876.6211s
	iters: 300, epoch: 4 | loss: 0.0613608
	speed: 0.3177s/iter; left time: 3928.1080s
	iters: 400, epoch: 4 | loss: 0.0807392
	speed: 0.3107s/iter; left time: 3810.3060s
Epoch: 4 cost time: 146.83901357650757
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.955973 --> -0.969410).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0199494
	speed: 0.7658s/iter; left time: 9261.8769s
	iters: 200, epoch: 5 | loss: 0.1306437
	speed: 0.2628s/iter; left time: 3152.3338s
	iters: 300, epoch: 5 | loss: 0.0540068
	speed: 0.2932s/iter; left time: 3487.2759s
	iters: 400, epoch: 5 | loss: 0.0101154
	speed: 0.2950s/iter; left time: 3479.5973s
Epoch: 5 cost time: 129.85353827476501
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3195798
	speed: 0.6598s/iter; left time: 7670.5970s
	iters: 200, epoch: 6 | loss: 0.0127978
	speed: 0.2024s/iter; left time: 2332.7745s
	iters: 300, epoch: 6 | loss: 0.4978510
	speed: 0.0577s/iter; left time: 659.3893s
	iters: 400, epoch: 6 | loss: 0.0501264
	speed: 0.0579s/iter; left time: 656.0870s
Epoch: 6 cost time: 71.59855580329895
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.969410 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1548565
	speed: 0.6393s/iter; left time: 7132.7893s
	iters: 200, epoch: 7 | loss: 0.0238379
	speed: 0.2028s/iter; left time: 2242.5073s
	iters: 300, epoch: 7 | loss: 0.0061211
	speed: 0.1992s/iter; left time: 2183.1471s
	iters: 400, epoch: 7 | loss: 0.0471838
	speed: 0.1958s/iter; left time: 2126.1405s
Epoch: 7 cost time: 103.6254231929779
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0071590
	speed: 0.6710s/iter; left time: 7172.0453s
	iters: 200, epoch: 8 | loss: 0.2218507
	speed: 0.1855s/iter; left time: 1963.9319s
	iters: 300, epoch: 8 | loss: 0.1877666
	speed: 0.1929s/iter; left time: 2023.5991s
	iters: 400, epoch: 8 | loss: 0.0086721
	speed: 0.1743s/iter; left time: 1810.6531s
Epoch: 8 cost time: 97.87475371360779
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0021886
	speed: 0.6782s/iter; left time: 6930.8087s
	iters: 200, epoch: 9 | loss: 0.0018792
	speed: 0.1961s/iter; left time: 1984.4313s
	iters: 300, epoch: 9 | loss: 0.0073877
	speed: 0.2087s/iter; left time: 2090.4887s
	iters: 400, epoch: 9 | loss: 0.0032012
	speed: 0.1837s/iter; left time: 1822.4733s
Epoch: 9 cost time: 102.46855282783508
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.974270 --> -0.974270).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1701973
	speed: 0.6534s/iter; left time: 6370.1841s
	iters: 200, epoch: 10 | loss: 0.0835060
	speed: 0.2155s/iter; left time: 2079.6293s
	iters: 300, epoch: 10 | loss: 0.0080047
	speed: 0.1771s/iter; left time: 1691.0437s
	iters: 400, epoch: 10 | loss: 0.0027007
	speed: 0.1818s/iter; left time: 1718.1630s
Epoch: 10 cost time: 99.64675784111023
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.978844).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0018854
	speed: 0.6995s/iter; left time: 6492.3288s
	iters: 200, epoch: 11 | loss: 0.0924224
	speed: 0.2009s/iter; left time: 1844.4060s
	iters: 300, epoch: 11 | loss: 0.0043313
	speed: 0.2120s/iter; left time: 1924.8986s
	iters: 400, epoch: 11 | loss: 0.0603444
	speed: 0.2231s/iter; left time: 2003.6846s
Epoch: 11 cost time: 108.28986620903015
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.978844).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0575837
	speed: 0.7046s/iter; left time: 6209.1484s
	iters: 200, epoch: 12 | loss: 0.0459091
	speed: 0.2265s/iter; left time: 1973.6440s
	iters: 300, epoch: 12 | loss: 0.0248892
	speed: 0.2110s/iter; left time: 1817.2896s
	iters: 400, epoch: 12 | loss: 0.1500410
	speed: 0.2265s/iter; left time: 1928.3727s
Epoch: 12 cost time: 110.6545057296753
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.978844).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0297252
	speed: 0.6898s/iter; left time: 5754.7725s
	iters: 200, epoch: 13 | loss: 0.0072083
	speed: 0.2117s/iter; left time: 1744.9482s
	iters: 300, epoch: 13 | loss: 0.0007544
	speed: 0.2028s/iter; left time: 1651.1312s
	iters: 400, epoch: 13 | loss: 0.0049749
	speed: 0.2291s/iter; left time: 1842.8377s
Epoch: 13 cost time: 108.19051480293274
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.978844 --> -0.982847).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0071546
	speed: 0.7040s/iter; left time: 5543.5752s
	iters: 200, epoch: 14 | loss: 0.0030267
	speed: 0.2222s/iter; left time: 1727.2487s
	iters: 300, epoch: 14 | loss: 0.0774433
	speed: 0.2114s/iter; left time: 1622.1369s
	iters: 400, epoch: 14 | loss: 0.4330865
	speed: 0.2400s/iter; left time: 1817.3937s
Epoch: 14 cost time: 111.43340229988098
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0497250
	speed: 0.6431s/iter; left time: 4761.8046s
	iters: 200, epoch: 15 | loss: 0.0011134
	speed: 0.2057s/iter; left time: 1502.5312s
	iters: 300, epoch: 15 | loss: 0.0619623
	speed: 0.1871s/iter; left time: 1347.7563s
	iters: 400, epoch: 15 | loss: 0.3971176
	speed: 0.2035s/iter; left time: 1446.0358s
Epoch: 15 cost time: 99.43335747718811
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0380870
	speed: 0.6507s/iter; left time: 4513.5328s
	iters: 200, epoch: 16 | loss: 0.0175005
	speed: 0.2142s/iter; left time: 1464.3394s
	iters: 300, epoch: 16 | loss: 0.0013236
	speed: 0.2000s/iter; left time: 1347.5059s
	iters: 400, epoch: 16 | loss: 0.0006159
	speed: 0.2122s/iter; left time: 1408.3761s
Epoch: 16 cost time: 103.80394148826599
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0076266
	speed: 0.6411s/iter; left time: 4146.1672s
	iters: 200, epoch: 17 | loss: 0.0024756
	speed: 0.1987s/iter; left time: 1265.0375s
	iters: 300, epoch: 17 | loss: 0.0118915
	speed: 0.1834s/iter; left time: 1149.3874s
	iters: 400, epoch: 17 | loss: 0.0044306
	speed: 0.1965s/iter; left time: 1211.9297s
Epoch: 17 cost time: 97.2379400730133
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983132).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0009016
	speed: 0.6480s/iter; left time: 3886.6720s
	iters: 200, epoch: 18 | loss: 0.0108756
	speed: 0.2060s/iter; left time: 1215.0559s
	iters: 300, epoch: 18 | loss: 0.0021617
	speed: 0.1997s/iter; left time: 1157.9510s
	iters: 400, epoch: 18 | loss: 0.0007464
	speed: 0.2058s/iter; left time: 1172.4738s
Epoch: 18 cost time: 100.09851551055908
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0011405
	speed: 0.6276s/iter; left time: 3470.2667s
	iters: 200, epoch: 19 | loss: 0.0017571
	speed: 0.1952s/iter; left time: 1060.0062s
	iters: 300, epoch: 19 | loss: 0.0018969
	speed: 0.1833s/iter; left time: 977.0081s
	iters: 400, epoch: 19 | loss: 0.0011678
	speed: 0.1952s/iter; left time: 1020.6020s
Epoch: 19 cost time: 98.40723824501038
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0033524
	speed: 0.6625s/iter; left time: 3352.0470s
	iters: 200, epoch: 20 | loss: 0.0228813
	speed: 0.2033s/iter; left time: 1008.3350s
	iters: 300, epoch: 20 | loss: 0.0015677
	speed: 0.1955s/iter; left time: 950.3308s
	iters: 400, epoch: 20 | loss: 0.0025433
	speed: 0.1899s/iter; left time: 903.8888s
Epoch: 20 cost time: 98.53139805793762
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.983132 --> -0.983990).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0148892
	speed: 0.3594s/iter; left time: 1650.0983s
	iters: 200, epoch: 21 | loss: 0.0085929
	speed: 0.2609s/iter; left time: 1171.5911s
	iters: 300, epoch: 21 | loss: 0.0017433
	speed: 0.2713s/iter; left time: 1191.3413s
	iters: 400, epoch: 21 | loss: 0.0012226
	speed: 0.2669s/iter; left time: 1145.1498s
Epoch: 21 cost time: 105.23055148124695
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0015226
	speed: 0.6317s/iter; left time: 2603.9581s
	iters: 200, epoch: 22 | loss: 0.0080962
	speed: 0.1955s/iter; left time: 786.2447s
	iters: 300, epoch: 22 | loss: 0.0021080
	speed: 0.1823s/iter; left time: 715.1631s
	iters: 400, epoch: 22 | loss: 0.0005424
	speed: 0.2059s/iter; left time: 786.8300s
Epoch: 22 cost time: 96.6014986038208
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0009870
	speed: 0.6346s/iter; left time: 2318.0352s
	iters: 200, epoch: 23 | loss: 0.0021210
	speed: 0.2259s/iter; left time: 802.5846s
	iters: 300, epoch: 23 | loss: 0.0028850
	speed: 0.2117s/iter; left time: 731.1630s
	iters: 400, epoch: 23 | loss: 0.1537032
	speed: 0.1969s/iter; left time: 660.1175s
Epoch: 23 cost time: 101.10725212097168
Epoch: 23, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0004007
	speed: 0.5831s/iter; left time: 1856.5517s
	iters: 200, epoch: 24 | loss: 0.2335740
	speed: 0.2541s/iter; left time: 783.5709s
	iters: 300, epoch: 24 | loss: 0.0014435
	speed: 0.2533s/iter; left time: 755.8477s
	iters: 400, epoch: 24 | loss: 0.0057671
	speed: 0.2528s/iter; left time: 729.0204s
Epoch: 24 cost time: 114.83591747283936
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1671641
	speed: 0.5487s/iter; left time: 1489.7378s
	iters: 200, epoch: 25 | loss: 0.0035479
	speed: 0.1983s/iter; left time: 518.4723s
	iters: 300, epoch: 25 | loss: 0.0832084
	speed: 0.4216s/iter; left time: 1060.4164s
	iters: 400, epoch: 25 | loss: 0.0010749
	speed: 0.4558s/iter; left time: 1100.6846s
Epoch: 25 cost time: 157.44927263259888
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0009760
	speed: 1.0836s/iter; left time: 2433.7205s
	iters: 200, epoch: 26 | loss: 0.0090330
	speed: 0.4185s/iter; left time: 898.0284s
	iters: 300, epoch: 26 | loss: 0.0482968
	speed: 0.4246s/iter; left time: 868.7706s
	iters: 400, epoch: 26 | loss: 0.0024156
	speed: 0.4018s/iter; left time: 781.8607s
Epoch: 26 cost time: 193.13757610321045
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0319561
	speed: 1.0734s/iter; left time: 1907.4915s
	iters: 200, epoch: 27 | loss: 0.0008632
	speed: 0.4378s/iter; left time: 734.2204s
	iters: 300, epoch: 27 | loss: 0.0284490
	speed: 0.4221s/iter; left time: 665.6832s
	iters: 400, epoch: 27 | loss: 0.0021167
	speed: 0.4118s/iter; left time: 608.2581s
Epoch: 27 cost time: 201.26372361183167
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0098951
	speed: 1.0609s/iter; left time: 1387.7121s
	iters: 200, epoch: 28 | loss: 0.1464779
	speed: 0.4176s/iter; left time: 504.5000s
	iters: 300, epoch: 28 | loss: 0.0013859
	speed: 0.4367s/iter; left time: 483.8510s
	iters: 400, epoch: 28 | loss: 0.1676887
	speed: 0.4428s/iter; left time: 446.3619s
Epoch: 28 cost time: 201.8533079624176
Epoch: 28, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984562).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0070984
	speed: 1.0576s/iter; left time: 887.2887s
	iters: 200, epoch: 29 | loss: 0.0021216
	speed: 0.4287s/iter; left time: 316.7791s
	iters: 300, epoch: 29 | loss: 0.0085908
	speed: 0.4270s/iter; left time: 272.8234s
	iters: 400, epoch: 29 | loss: 0.0009299
	speed: 0.4204s/iter; left time: 226.5884s
Epoch: 29 cost time: 197.1990225315094
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0029065
	speed: 1.0997s/iter; left time: 406.9051s
	iters: 200, epoch: 30 | loss: 0.0100854
	speed: 0.4118s/iter; left time: 111.1905s
	iters: 300, epoch: 30 | loss: 0.0007503
	speed: 0.3896s/iter; left time: 66.2251s
	iters: 400, epoch: 30 | loss: 0.0227794
	speed: 0.4063s/iter; left time: 28.4409s
Epoch: 30 cost time: 195.6371500492096
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.068 Vali Acc: 0.986 Test Loss: 0.068 Test Acc: 0.986
Validation loss decreased (-0.984562 --> -0.986277).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 587434
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0991368
	speed: 0.3016s/iter; left time: 4213.5416s
	iters: 200, epoch: 1 | loss: 1.5335342
	speed: 0.2875s/iter; left time: 3987.9820s
	iters: 300, epoch: 1 | loss: 1.1757655
	speed: 0.2874s/iter; left time: 3957.7779s
	iters: 400, epoch: 1 | loss: 0.8651265
	speed: 0.2877s/iter; left time: 3932.6099s
Epoch: 1 cost time: 135.97020292282104
Epoch: 1, Steps: 469 | Train Loss: 1.428 Vali Loss: 0.584 Vali Acc: 0.852 Test Loss: 0.584 Test Acc: 0.852
Validation loss decreased (inf --> -0.852195).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5517571
	speed: 0.7917s/iter; left time: 10689.0126s
	iters: 200, epoch: 2 | loss: 0.1639921
	speed: 0.2790s/iter; left time: 3738.4993s
	iters: 300, epoch: 2 | loss: 0.1986091
	speed: 0.2907s/iter; left time: 3867.4334s
	iters: 400, epoch: 2 | loss: 0.2261348
	speed: 0.2966s/iter; left time: 3915.9920s
Epoch: 2 cost time: 133.60324382781982
Epoch: 2, Steps: 469 | Train Loss: 0.340 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.852195 --> -0.929672).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1218927
	speed: 0.8432s/iter; left time: 10989.0419s
	iters: 200, epoch: 3 | loss: 0.1250482
	speed: 0.2703s/iter; left time: 3495.9590s
	iters: 300, epoch: 3 | loss: 0.1476218
	speed: 0.2816s/iter; left time: 3613.3901s
	iters: 400, epoch: 3 | loss: 0.0139737
	speed: 0.2796s/iter; left time: 3560.6211s
Epoch: 3 cost time: 130.87726831436157
Epoch: 3, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.929672 --> -0.949398).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0487999
	speed: 0.8016s/iter; left time: 10071.5005s
	iters: 200, epoch: 4 | loss: 0.0144085
	speed: 0.2799s/iter; left time: 3488.5024s
	iters: 300, epoch: 4 | loss: 0.1636016
	speed: 0.2873s/iter; left time: 3552.7938s
	iters: 400, epoch: 4 | loss: 0.0248359
	speed: 0.3028s/iter; left time: 3713.7146s
Epoch: 4 cost time: 136.30646276474
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.949398 --> -0.969982).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0452725
	speed: 0.8262s/iter; left time: 9992.6953s
	iters: 200, epoch: 5 | loss: 0.0480909
	speed: 0.2629s/iter; left time: 3153.6998s
	iters: 300, epoch: 5 | loss: 0.0347323
	speed: 0.2639s/iter; left time: 3138.9264s
	iters: 400, epoch: 5 | loss: 0.1061823
	speed: 0.2794s/iter; left time: 3295.9495s
Epoch: 5 cost time: 125.89279055595398
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.969982 --> -0.971983).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0393800
	speed: 0.8276s/iter; left time: 9621.7353s
	iters: 200, epoch: 6 | loss: 0.0681056
	speed: 0.2860s/iter; left time: 3296.2854s
	iters: 300, epoch: 6 | loss: 0.1613881
	speed: 0.2869s/iter; left time: 3277.6348s
	iters: 400, epoch: 6 | loss: 0.1693536
	speed: 0.2967s/iter; left time: 3360.8477s
Epoch: 6 cost time: 135.79758977890015
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.971983 --> -0.978844).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1745098
	speed: 0.8020s/iter; left time: 8947.8783s
	iters: 200, epoch: 7 | loss: 0.0379066
	speed: 0.2590s/iter; left time: 2864.3129s
	iters: 300, epoch: 7 | loss: 0.0437864
	speed: 0.2497s/iter; left time: 2736.4418s
	iters: 400, epoch: 7 | loss: 0.0050013
	speed: 0.2821s/iter; left time: 3062.4432s
Epoch: 7 cost time: 122.41076493263245
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0184651
	speed: 0.7436s/iter; left time: 7947.5350s
	iters: 200, epoch: 8 | loss: 0.0699263
	speed: 0.2612s/iter; left time: 2766.0465s
	iters: 300, epoch: 8 | loss: 0.0201598
	speed: 0.2724s/iter; left time: 2857.0370s
	iters: 400, epoch: 8 | loss: 0.0031619
	speed: 0.2405s/iter; left time: 2498.1836s
Epoch: 8 cost time: 121.38688802719116
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.978844 --> -0.982561).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0215355
	speed: 0.7047s/iter; left time: 7201.2365s
	iters: 200, epoch: 9 | loss: 0.0031527
	speed: 0.2811s/iter; left time: 2844.6417s
	iters: 300, epoch: 9 | loss: 0.2464519
	speed: 0.2690s/iter; left time: 2694.7356s
	iters: 400, epoch: 9 | loss: 0.0192421
	speed: 0.2625s/iter; left time: 2603.8860s
Epoch: 9 cost time: 123.75480842590332
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0104918
	speed: 0.7986s/iter; left time: 7786.0777s
	iters: 200, epoch: 10 | loss: 0.0486248
	speed: 0.2572s/iter; left time: 2481.9088s
	iters: 300, epoch: 10 | loss: 0.0065085
	speed: 0.2341s/iter; left time: 2235.7515s
	iters: 400, epoch: 10 | loss: 0.0053017
	speed: 0.2685s/iter; left time: 2537.5952s
Epoch: 10 cost time: 119.6202757358551
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0076330
	speed: 0.7662s/iter; left time: 7111.0951s
	iters: 200, epoch: 11 | loss: 0.0057133
	speed: 0.2572s/iter; left time: 2361.5384s
	iters: 300, epoch: 11 | loss: 0.0165635
	speed: 0.2865s/iter; left time: 2601.2996s
	iters: 400, epoch: 11 | loss: 0.0030688
	speed: 0.2739s/iter; left time: 2459.8429s
Epoch: 11 cost time: 127.2573459148407
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1490237
	speed: 0.7338s/iter; left time: 6465.8124s
	iters: 200, epoch: 12 | loss: 0.0012546
	speed: 0.2541s/iter; left time: 2214.0848s
	iters: 300, epoch: 12 | loss: 0.0066774
	speed: 0.2467s/iter; left time: 2124.3799s
	iters: 400, epoch: 12 | loss: 0.0168719
	speed: 0.2165s/iter; left time: 1842.5014s
Epoch: 12 cost time: 114.85479068756104
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0038477
	speed: 0.7919s/iter; left time: 6606.9034s
	iters: 200, epoch: 13 | loss: 0.2606977
	speed: 0.2889s/iter; left time: 2381.1070s
	iters: 300, epoch: 13 | loss: 0.0495625
	speed: 0.2549s/iter; left time: 2075.4169s
	iters: 400, epoch: 13 | loss: 0.0199704
	speed: 0.2652s/iter; left time: 2133.1296s
Epoch: 13 cost time: 125.87740540504456
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0094747
	speed: 0.7525s/iter; left time: 5925.3301s
	iters: 200, epoch: 14 | loss: 0.0040069
	speed: 0.2433s/iter; left time: 1891.2034s
	iters: 300, epoch: 14 | loss: 0.0621064
	speed: 0.2702s/iter; left time: 2073.8188s
	iters: 400, epoch: 14 | loss: 0.0022991
	speed: 0.2765s/iter; left time: 2094.2671s
Epoch: 14 cost time: 123.55646300315857
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0256444
	speed: 0.7756s/iter; left time: 5743.2366s
	iters: 200, epoch: 15 | loss: 0.0176912
	speed: 0.2531s/iter; left time: 1848.9884s
	iters: 300, epoch: 15 | loss: 0.0452020
	speed: 0.2647s/iter; left time: 1907.4825s
	iters: 400, epoch: 15 | loss: 0.0166386
	speed: 0.2365s/iter; left time: 1680.1945s
Epoch: 15 cost time: 119.6096842288971
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982847).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0070747
	speed: 0.7510s/iter; left time: 5209.2581s
	iters: 200, epoch: 16 | loss: 0.0031672
	speed: 0.2854s/iter; left time: 1950.9815s
	iters: 300, epoch: 16 | loss: 0.0016205
	speed: 0.2569s/iter; left time: 1730.2529s
	iters: 400, epoch: 16 | loss: 0.0019028
	speed: 0.2730s/iter; left time: 1811.5371s
Epoch: 16 cost time: 127.52733016014099
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0022972
	speed: 0.7720s/iter; left time: 4992.5344s
	iters: 200, epoch: 17 | loss: 0.0025755
	speed: 0.2406s/iter; left time: 1531.6152s
	iters: 300, epoch: 17 | loss: 0.0028260
	speed: 0.2480s/iter; left time: 1554.2978s
	iters: 400, epoch: 17 | loss: 0.0073247
	speed: 0.2753s/iter; left time: 1697.9617s
Epoch: 17 cost time: 121.27096438407898
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0008026
	speed: 0.7822s/iter; left time: 4691.8437s
	iters: 200, epoch: 18 | loss: 0.0020212
	speed: 0.2615s/iter; left time: 1542.1304s
	iters: 300, epoch: 18 | loss: 0.0006520
	speed: 0.2801s/iter; left time: 1624.0392s
	iters: 400, epoch: 18 | loss: 0.0004973
	speed: 0.2409s/iter; left time: 1372.8069s
Epoch: 18 cost time: 122.34740495681763
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0155841
	speed: 0.6845s/iter; left time: 3784.7377s
	iters: 200, epoch: 19 | loss: 0.0004252
	speed: 0.2898s/iter; left time: 1573.5953s
	iters: 300, epoch: 19 | loss: 0.0090878
	speed: 0.2836s/iter; left time: 1511.1201s
	iters: 400, epoch: 19 | loss: 0.0074276
	speed: 0.2748s/iter; left time: 1436.9033s
Epoch: 19 cost time: 132.61650347709656
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0029741
	speed: 0.8297s/iter; left time: 4198.3582s
	iters: 200, epoch: 20 | loss: 0.0023784
	speed: 0.2549s/iter; left time: 1264.1680s
	iters: 300, epoch: 20 | loss: 0.0013301
	speed: 0.2608s/iter; left time: 1267.4815s
	iters: 400, epoch: 20 | loss: 0.0080227
	speed: 0.2799s/iter; left time: 1332.1451s
Epoch: 20 cost time: 127.50995111465454
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0056784
	speed: 0.8142s/iter; left time: 3737.8614s
	iters: 200, epoch: 21 | loss: 0.0045242
	speed: 0.2751s/iter; left time: 1235.6584s
	iters: 300, epoch: 21 | loss: 0.0990113
	speed: 0.2929s/iter; left time: 1286.1358s
	iters: 400, epoch: 21 | loss: 0.0071078
	speed: 0.2910s/iter; left time: 1248.5266s
Epoch: 21 cost time: 132.05154275894165
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0246695
	speed: 0.7664s/iter; left time: 3159.0131s
	iters: 200, epoch: 22 | loss: 0.0022080
	speed: 0.2742s/iter; left time: 1102.9723s
	iters: 300, epoch: 22 | loss: 0.0438480
	speed: 0.2701s/iter; left time: 1059.2410s
	iters: 400, epoch: 22 | loss: 0.0198764
	speed: 0.2803s/iter; left time: 1071.2098s
Epoch: 22 cost time: 130.19319653511047
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0007932
	speed: 0.8416s/iter; left time: 3074.2653s
	iters: 200, epoch: 23 | loss: 0.0025396
	speed: 0.2727s/iter; left time: 968.8359s
	iters: 300, epoch: 23 | loss: 0.0048241
	speed: 0.2449s/iter; left time: 845.5236s
	iters: 400, epoch: 23 | loss: 0.0166851
	speed: 0.2764s/iter; left time: 926.9170s
Epoch: 23 cost time: 127.8638162612915
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0008256
	speed: 0.7719s/iter; left time: 2457.8445s
	iters: 200, epoch: 24 | loss: 0.0886098
	speed: 0.2875s/iter; left time: 886.6638s
	iters: 300, epoch: 24 | loss: 0.0010251
	speed: 0.2979s/iter; left time: 889.0072s
	iters: 400, epoch: 24 | loss: 0.0011147
	speed: 0.2927s/iter; left time: 844.1779s
Epoch: 24 cost time: 132.29940128326416
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0250706
	speed: 0.7782s/iter; left time: 2112.7446s
	iters: 200, epoch: 25 | loss: 0.0011366
	speed: 0.2720s/iter; left time: 711.3877s
	iters: 300, epoch: 25 | loss: 0.0016555
	speed: 0.2721s/iter; left time: 684.2106s
	iters: 400, epoch: 25 | loss: 0.0003391
	speed: 0.2510s/iter; left time: 606.2512s
Epoch: 25 cost time: 125.26592373847961
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 173418
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1697176
	speed: 0.2618s/iter; left time: 3658.1892s
	iters: 200, epoch: 1 | loss: 1.8108958
	speed: 0.2395s/iter; left time: 3321.6273s
	iters: 300, epoch: 1 | loss: 1.2811726
	speed: 0.2407s/iter; left time: 3314.0568s
	iters: 400, epoch: 1 | loss: 1.0823112
	speed: 0.2393s/iter; left time: 3271.5711s
Epoch: 1 cost time: 114.66555905342102
Epoch: 1, Steps: 469 | Train Loss: 1.561 Vali Loss: 0.763 Vali Acc: 0.824 Test Loss: 0.763 Test Acc: 0.824
Validation loss decreased (inf --> -0.823606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5193981
	speed: 0.7117s/iter; left time: 9609.2432s
	iters: 200, epoch: 2 | loss: 0.4684396
	speed: 0.2305s/iter; left time: 3088.6236s
	iters: 300, epoch: 2 | loss: 0.2689980
	speed: 0.2630s/iter; left time: 3498.0913s
	iters: 400, epoch: 2 | loss: 0.2947780
	speed: 0.2631s/iter; left time: 3473.0539s
Epoch: 2 cost time: 116.31570863723755
Epoch: 2, Steps: 469 | Train Loss: 0.431 Vali Loss: 0.285 Vali Acc: 0.912 Test Loss: 0.285 Test Acc: 0.912
Validation loss decreased (-0.823606 --> -0.911661).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1860080
	speed: 0.7424s/iter; left time: 9675.3730s
	iters: 200, epoch: 3 | loss: 0.1629660
	speed: 0.2471s/iter; left time: 3195.7892s
	iters: 300, epoch: 3 | loss: 0.0771341
	speed: 0.2388s/iter; left time: 3064.9021s
	iters: 400, epoch: 3 | loss: 0.0654445
	speed: 0.2300s/iter; left time: 2928.7029s
Epoch: 3 cost time: 110.0997986793518
Epoch: 3, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.911661 --> -0.941393).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2775475
	speed: 0.7027s/iter; left time: 8828.4915s
	iters: 200, epoch: 4 | loss: 0.0124485
	speed: 0.2640s/iter; left time: 3291.1013s
	iters: 300, epoch: 4 | loss: 0.1360082
	speed: 0.2625s/iter; left time: 3245.5441s
	iters: 400, epoch: 4 | loss: 0.0398803
	speed: 0.2473s/iter; left time: 3032.9616s
Epoch: 4 cost time: 117.35494494438171
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
Validation loss decreased (-0.941393 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0157217
	speed: 0.7534s/iter; left time: 9111.7925s
	iters: 200, epoch: 5 | loss: 0.0507955
	speed: 0.2364s/iter; left time: 2836.1681s
	iters: 300, epoch: 5 | loss: 0.0417282
	speed: 0.2187s/iter; left time: 2601.8891s
	iters: 400, epoch: 5 | loss: 0.0177318
	speed: 0.2143s/iter; left time: 2527.5967s
Epoch: 5 cost time: 105.34188914299011
Epoch: 5, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
Validation loss decreased (-0.963120 --> -0.963121).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0417235
	speed: 0.7465s/iter; left time: 8678.3421s
	iters: 200, epoch: 6 | loss: 0.0112543
	speed: 0.2500s/iter; left time: 2881.3176s
	iters: 300, epoch: 6 | loss: 0.4717730
	speed: 0.2444s/iter; left time: 2792.8418s
	iters: 400, epoch: 6 | loss: 0.0394303
	speed: 0.2394s/iter; left time: 2711.4019s
Epoch: 6 cost time: 117.54372429847717
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1312017
	speed: 0.7404s/iter; left time: 8260.6278s
	iters: 200, epoch: 7 | loss: 0.0292326
	speed: 0.2084s/iter; left time: 2304.6040s
	iters: 300, epoch: 7 | loss: 0.0056894
	speed: 0.2197s/iter; left time: 2406.8864s
	iters: 400, epoch: 7 | loss: 0.0998821
	speed: 0.2433s/iter; left time: 2641.6668s
Epoch: 7 cost time: 107.8107340335846
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.138 Vali Acc: 0.961 Test Loss: 0.138 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0073811
	speed: 0.7762s/iter; left time: 8295.6859s
	iters: 200, epoch: 8 | loss: 0.0523504
	speed: 0.2458s/iter; left time: 2602.3591s
	iters: 300, epoch: 8 | loss: 0.0416005
	speed: 0.2628s/iter; left time: 2755.8453s
	iters: 400, epoch: 8 | loss: 0.0211958
	speed: 0.2520s/iter; left time: 2618.1010s
Epoch: 8 cost time: 117.54482889175415
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.963121 --> -0.971125).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0061479
	speed: 0.6941s/iter; left time: 7093.3781s
	iters: 200, epoch: 9 | loss: 0.0062324
	speed: 0.2381s/iter; left time: 2409.1904s
	iters: 300, epoch: 9 | loss: 0.0031692
	speed: 0.2424s/iter; left time: 2428.4404s
	iters: 400, epoch: 9 | loss: 0.0411569
	speed: 0.2597s/iter; left time: 2575.4687s
Epoch: 9 cost time: 112.92756676673889
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.973984).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0789990
	speed: 0.7595s/iter; left time: 7404.9346s
	iters: 200, epoch: 10 | loss: 0.0081229
	speed: 0.2626s/iter; left time: 2534.3965s
	iters: 300, epoch: 10 | loss: 0.0045028
	speed: 0.2461s/iter; left time: 2349.9558s
	iters: 400, epoch: 10 | loss: 0.0076357
	speed: 0.2265s/iter; left time: 2140.0619s
Epoch: 10 cost time: 113.95052313804626
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.976557).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0563496
	speed: 0.7015s/iter; left time: 6510.4410s
	iters: 200, epoch: 11 | loss: 0.3398147
	speed: 0.2453s/iter; left time: 2252.1362s
	iters: 300, epoch: 11 | loss: 0.0053840
	speed: 0.2507s/iter; left time: 2276.3088s
	iters: 400, epoch: 11 | loss: 0.0385870
	speed: 0.2453s/iter; left time: 2203.3966s
Epoch: 11 cost time: 115.57116913795471
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0151866
	speed: 0.7894s/iter; left time: 6956.3631s
	iters: 200, epoch: 12 | loss: 0.0111247
	speed: 0.2345s/iter; left time: 2042.8054s
	iters: 300, epoch: 12 | loss: 0.0179667
	speed: 0.2167s/iter; left time: 1866.6085s
	iters: 400, epoch: 12 | loss: 0.0847753
	speed: 0.2208s/iter; left time: 1879.0357s
Epoch: 12 cost time: 110.11969542503357
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0272342
	speed: 0.7337s/iter; left time: 6121.0217s
	iters: 200, epoch: 13 | loss: 0.0290793
	speed: 0.2450s/iter; left time: 2019.3474s
	iters: 300, epoch: 13 | loss: 0.0018728
	speed: 0.2482s/iter; left time: 2021.1470s
	iters: 400, epoch: 13 | loss: 0.0302866
	speed: 0.2612s/iter; left time: 2100.7398s
Epoch: 13 cost time: 117.57032704353333
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979702).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0051374
	speed: 0.7477s/iter; left time: 5887.6706s
	iters: 200, epoch: 14 | loss: 0.0271056
	speed: 0.2238s/iter; left time: 1739.8480s
	iters: 300, epoch: 14 | loss: 0.1252608
	speed: 0.2356s/iter; left time: 1808.1135s
	iters: 400, epoch: 14 | loss: 0.1209486
	speed: 0.2384s/iter; left time: 1805.4572s
Epoch: 14 cost time: 108.14734101295471
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0138799
	speed: 0.6983s/iter; left time: 5171.0005s
	iters: 200, epoch: 15 | loss: 0.0080397
	speed: 0.1565s/iter; left time: 1143.2881s
	iters: 300, epoch: 15 | loss: 0.0109748
	speed: 0.2405s/iter; left time: 1732.6251s
	iters: 400, epoch: 15 | loss: 0.0240105
	speed: 0.2483s/iter; left time: 1764.3962s
Epoch: 15 cost time: 104.0098648071289
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.2206113
	speed: 0.6861s/iter; left time: 4758.6020s
	iters: 200, epoch: 16 | loss: 0.0076397
	speed: 0.2293s/iter; left time: 1567.3416s
	iters: 300, epoch: 16 | loss: 0.0076817
	speed: 0.2460s/iter; left time: 1657.0609s
	iters: 400, epoch: 16 | loss: 0.0052916
	speed: 0.2284s/iter; left time: 1515.7126s
Epoch: 16 cost time: 108.80719184875488
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1365744
	speed: 0.6868s/iter; left time: 4441.5651s
	iters: 200, epoch: 17 | loss: 0.0170120
	speed: 0.2375s/iter; left time: 1512.0327s
	iters: 300, epoch: 17 | loss: 0.1417942
	speed: 0.2401s/iter; left time: 1504.7273s
	iters: 400, epoch: 17 | loss: 0.0053368
	speed: 0.2353s/iter; left time: 1451.3693s
Epoch: 17 cost time: 110.0352418422699
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981703).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0009050
	speed: 0.7034s/iter; left time: 4218.8486s
	iters: 200, epoch: 18 | loss: 0.0066172
	speed: 0.2187s/iter; left time: 1290.0416s
	iters: 300, epoch: 18 | loss: 0.0014709
	speed: 0.2276s/iter; left time: 1319.8211s
	iters: 400, epoch: 18 | loss: 0.0007144
	speed: 0.2294s/iter; left time: 1307.4015s
Epoch: 18 cost time: 103.26635909080505
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0004492
	speed: 0.5188s/iter; left time: 2868.5243s
	iters: 200, epoch: 19 | loss: 0.0033252
	speed: 0.1863s/iter; left time: 1011.1897s
	iters: 300, epoch: 19 | loss: 0.0018894
	speed: 0.2375s/iter; left time: 1265.4174s
	iters: 400, epoch: 19 | loss: 0.0004130
	speed: 0.2077s/iter; left time: 1086.0763s
Epoch: 19 cost time: 93.50647187232971
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0024260
	speed: 0.5885s/iter; left time: 2977.9108s
	iters: 200, epoch: 20 | loss: 0.0042033
	speed: 0.2204s/iter; left time: 1093.2342s
	iters: 300, epoch: 20 | loss: 0.0015148
	speed: 0.2174s/iter; left time: 1056.7625s
	iters: 400, epoch: 20 | loss: 0.0036710
	speed: 0.2005s/iter; left time: 954.2310s
Epoch: 20 cost time: 94.43299531936646
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0039672
	speed: 0.5621s/iter; left time: 2580.5934s
	iters: 200, epoch: 21 | loss: 0.0009486
	speed: 0.2263s/iter; left time: 1016.4243s
	iters: 300, epoch: 21 | loss: 0.0026074
	speed: 0.2060s/iter; left time: 904.5211s
	iters: 400, epoch: 21 | loss: 0.0017414
	speed: 0.1909s/iter; left time: 819.1922s
Epoch: 21 cost time: 92.84093379974365
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0014852
	speed: 0.6285s/iter; left time: 2590.8437s
	iters: 200, epoch: 22 | loss: 0.0044500
	speed: 0.2043s/iter; left time: 821.6389s
	iters: 300, epoch: 22 | loss: 0.0015132
	speed: 0.2227s/iter; left time: 873.5051s
	iters: 400, epoch: 22 | loss: 0.0012187
	speed: 0.1659s/iter; left time: 634.0769s
Epoch: 22 cost time: 95.24763441085815
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0012106
	speed: 0.6237s/iter; left time: 2278.4077s
	iters: 200, epoch: 23 | loss: 0.0047339
	speed: 0.2106s/iter; left time: 748.4174s
	iters: 300, epoch: 23 | loss: 0.0178141
	speed: 0.1543s/iter; left time: 532.7281s
	iters: 400, epoch: 23 | loss: 0.0061666
	speed: 0.1982s/iter; left time: 664.5325s
Epoch: 23 cost time: 88.47912383079529
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0125216
	speed: 0.5374s/iter; left time: 1711.1972s
	iters: 200, epoch: 24 | loss: 0.1722933
	speed: 0.2046s/iter; left time: 631.0461s
	iters: 300, epoch: 24 | loss: 0.0046059
	speed: 0.1709s/iter; left time: 510.0778s
	iters: 400, epoch: 24 | loss: 0.0027359
	speed: 0.1839s/iter; left time: 530.2822s
Epoch: 24 cost time: 88.85157680511475
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0345285
	speed: 0.6484s/iter; left time: 1760.4878s
	iters: 200, epoch: 25 | loss: 0.0333851
	speed: 0.1888s/iter; left time: 493.7497s
	iters: 300, epoch: 25 | loss: 0.0037095
	speed: 0.1523s/iter; left time: 383.0239s
	iters: 400, epoch: 25 | loss: 0.0009166
	speed: 0.2163s/iter; left time: 522.3250s
Epoch: 25 cost time: 89.41494703292847
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0008908
	speed: 0.6102s/iter; left time: 1370.4166s
	iters: 200, epoch: 26 | loss: 0.0008842
	speed: 0.2025s/iter; left time: 434.5119s
	iters: 300, epoch: 26 | loss: 0.0253206
	speed: 0.2054s/iter; left time: 420.1774s
	iters: 400, epoch: 26 | loss: 0.0026648
	speed: 0.2230s/iter; left time: 434.0418s
Epoch: 26 cost time: 94.82637095451355
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0707516
	speed: 0.6195s/iter; left time: 1100.8771s
	iters: 200, epoch: 27 | loss: 0.0023674
	speed: 0.2126s/iter; left time: 356.4643s
	iters: 300, epoch: 27 | loss: 0.1331865
	speed: 0.2071s/iter; left time: 326.5924s
	iters: 400, epoch: 27 | loss: 0.0010439
	speed: 0.1990s/iter; left time: 293.8647s
Epoch: 27 cost time: 95.1306095123291
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 587434
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1248808
	speed: 0.1449s/iter; left time: 2023.7024s
	iters: 200, epoch: 1 | loss: 1.6946172
	speed: 0.1235s/iter; left time: 1712.4301s
	iters: 300, epoch: 1 | loss: 1.2179649
	speed: 0.1446s/iter; left time: 1991.0654s
	iters: 400, epoch: 1 | loss: 1.0705154
	speed: 0.1340s/iter; left time: 1832.5546s
Epoch: 1 cost time: 64.15665292739868
Epoch: 1, Steps: 469 | Train Loss: 1.561 Vali Loss: 0.781 Vali Acc: 0.792 Test Loss: 0.781 Test Acc: 0.792
Validation loss decreased (inf --> -0.792159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6652839
	speed: 0.5519s/iter; left time: 7451.2730s
	iters: 200, epoch: 2 | loss: 0.3101978
	speed: 0.1219s/iter; left time: 1633.8264s
	iters: 300, epoch: 2 | loss: 0.3379831
	speed: 0.1310s/iter; left time: 1742.9257s
	iters: 400, epoch: 2 | loss: 0.2143922
	speed: 0.1500s/iter; left time: 1980.1162s
Epoch: 2 cost time: 65.05162477493286
Epoch: 2, Steps: 469 | Train Loss: 0.483 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
Validation loss decreased (-0.792159 --> -0.903656).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1236183
	speed: 0.4156s/iter; left time: 5416.7209s
	iters: 200, epoch: 3 | loss: 0.2465877
	speed: 0.1754s/iter; left time: 2268.8564s
	iters: 300, epoch: 3 | loss: 0.2738713
	speed: 0.1612s/iter; left time: 2068.6546s
	iters: 400, epoch: 3 | loss: 0.0266991
	speed: 0.1688s/iter; left time: 2149.2161s
Epoch: 3 cost time: 72.82093811035156
Epoch: 3, Steps: 469 | Train Loss: 0.235 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
Validation loss decreased (-0.903656 --> -0.939392).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0499492
	speed: 0.6097s/iter; left time: 7660.2076s
	iters: 200, epoch: 4 | loss: 0.0278264
	speed: 0.1809s/iter; left time: 2255.1619s
	iters: 300, epoch: 4 | loss: 0.3001322
	speed: 0.1776s/iter; left time: 2195.7492s
	iters: 400, epoch: 4 | loss: 0.0579144
	speed: 0.1642s/iter; left time: 2013.9633s
Epoch: 4 cost time: 81.14723587036133
Epoch: 4, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.939392 --> -0.959690).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0227312
	speed: 0.5982s/iter; left time: 7235.0954s
	iters: 200, epoch: 5 | loss: 0.0720059
	speed: 0.1573s/iter; left time: 1886.8084s
	iters: 300, epoch: 5 | loss: 0.0177324
	speed: 0.1747s/iter; left time: 2078.5386s
	iters: 400, epoch: 5 | loss: 0.2091741
	speed: 0.1675s/iter; left time: 1975.5508s
Epoch: 5 cost time: 74.30837678909302
Epoch: 5, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0778931
	speed: 0.5661s/iter; left time: 6581.9512s
	iters: 200, epoch: 6 | loss: 0.2978934
	speed: 0.1453s/iter; left time: 1674.3791s
	iters: 300, epoch: 6 | loss: 0.0890796
	speed: 0.1477s/iter; left time: 1687.1963s
	iters: 400, epoch: 6 | loss: 0.0292880
	speed: 0.1800s/iter; left time: 2038.3425s
Epoch: 6 cost time: 76.87187242507935
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.959690 --> -0.971697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0698355
	speed: 0.5799s/iter; left time: 6469.8168s
	iters: 200, epoch: 7 | loss: 0.0722216
	speed: 0.1035s/iter; left time: 1144.4908s
	iters: 300, epoch: 7 | loss: 0.0481657
	speed: 0.1582s/iter; left time: 1733.1633s
	iters: 400, epoch: 7 | loss: 0.0185790
	speed: 0.1324s/iter; left time: 1436.9255s
Epoch: 7 cost time: 66.60223126411438
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.974270).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0871786
	speed: 0.5483s/iter; left time: 5860.3532s
	iters: 200, epoch: 8 | loss: 0.0880995
	speed: 0.1525s/iter; left time: 1615.0677s
	iters: 300, epoch: 8 | loss: 0.0607443
	speed: 0.1233s/iter; left time: 1293.6027s
	iters: 400, epoch: 8 | loss: 0.0392115
	speed: 0.1521s/iter; left time: 1579.6165s
Epoch: 8 cost time: 65.51993799209595
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.977415).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0064659
	speed: 0.5006s/iter; left time: 5115.4107s
	iters: 200, epoch: 9 | loss: 0.0191587
	speed: 0.1347s/iter; left time: 1363.1267s
	iters: 300, epoch: 9 | loss: 0.0547494
	speed: 0.1473s/iter; left time: 1475.5271s
	iters: 400, epoch: 9 | loss: 0.0065750
	speed: 0.1289s/iter; left time: 1278.9067s
Epoch: 9 cost time: 64.9514741897583
Epoch: 9, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.979416).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0330439
	speed: 0.5156s/iter; left time: 5027.5694s
	iters: 200, epoch: 10 | loss: 0.0399337
	speed: 0.1514s/iter; left time: 1461.0805s
	iters: 300, epoch: 10 | loss: 0.0084019
	speed: 0.1451s/iter; left time: 1385.5708s
	iters: 400, epoch: 10 | loss: 0.0308957
	speed: 0.1538s/iter; left time: 1453.6296s
Epoch: 10 cost time: 70.40524649620056
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0135138
	speed: 0.5444s/iter; left time: 5052.7047s
	iters: 200, epoch: 11 | loss: 0.0120541
	speed: 0.1525s/iter; left time: 1399.6772s
	iters: 300, epoch: 11 | loss: 0.0141367
	speed: 0.1558s/iter; left time: 1414.9245s
	iters: 400, epoch: 11 | loss: 0.0027326
	speed: 0.1504s/iter; left time: 1350.4916s
Epoch: 11 cost time: 71.23572707176208
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.980274).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2295350
	speed: 0.5231s/iter; left time: 4609.2852s
	iters: 200, epoch: 12 | loss: 0.0061628
	speed: 0.1394s/iter; left time: 1214.1286s
	iters: 300, epoch: 12 | loss: 0.0501229
	speed: 0.1443s/iter; left time: 1242.6972s
	iters: 400, epoch: 12 | loss: 0.0108827
	speed: 0.1334s/iter; left time: 1135.1404s
Epoch: 12 cost time: 65.93652749061584
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0028164
	speed: 0.5001s/iter; left time: 4172.0735s
	iters: 200, epoch: 13 | loss: 0.2249513
	speed: 0.1137s/iter; left time: 937.1010s
	iters: 300, epoch: 13 | loss: 0.0594184
	speed: 0.1467s/iter; left time: 1194.1932s
	iters: 400, epoch: 13 | loss: 0.0472147
	speed: 0.1542s/iter; left time: 1240.5237s
Epoch: 13 cost time: 64.77725791931152
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0265674
	speed: 0.5510s/iter; left time: 4338.3380s
	iters: 200, epoch: 14 | loss: 0.0040512
	speed: 0.1508s/iter; left time: 1171.9890s
	iters: 300, epoch: 14 | loss: 0.0934977
	speed: 0.1548s/iter; left time: 1187.7610s
	iters: 400, epoch: 14 | loss: 0.0035840
	speed: 0.1412s/iter; left time: 1069.1401s
Epoch: 14 cost time: 67.58483791351318
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0244358
	speed: 0.5807s/iter; left time: 4299.8882s
	iters: 200, epoch: 15 | loss: 0.0045774
	speed: 0.1721s/iter; left time: 1257.3846s
	iters: 300, epoch: 15 | loss: 0.0064040
	speed: 0.1582s/iter; left time: 1140.1449s
	iters: 400, epoch: 15 | loss: 0.2635640
	speed: 0.1598s/iter; left time: 1135.0989s
Epoch: 15 cost time: 79.08883857727051
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0238686
	speed: 0.6088s/iter; left time: 4222.9831s
	iters: 200, epoch: 16 | loss: 0.0225675
	speed: 0.1599s/iter; left time: 1093.1260s
	iters: 300, epoch: 16 | loss: 0.0032022
	speed: 0.1553s/iter; left time: 1046.2799s
	iters: 400, epoch: 16 | loss: 0.0036464
	speed: 0.1650s/iter; left time: 1095.0235s
Epoch: 16 cost time: 76.81528973579407
Epoch: 16, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0049073
	speed: 0.6389s/iter; left time: 4131.7137s
	iters: 200, epoch: 17 | loss: 0.0016388
	speed: 0.1719s/iter; left time: 1094.4823s
	iters: 300, epoch: 17 | loss: 0.0017101
	speed: 0.1708s/iter; left time: 1070.1319s
	iters: 400, epoch: 17 | loss: 0.0082751
	speed: 0.1877s/iter; left time: 1157.3581s
Epoch: 17 cost time: 83.71183609962463
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0810509
	speed: 0.6408s/iter; left time: 3843.2822s
	iters: 200, epoch: 18 | loss: 0.0041125
	speed: 0.1703s/iter; left time: 1004.4189s
	iters: 300, epoch: 18 | loss: 0.0012382
	speed: 0.1843s/iter; left time: 1068.6687s
	iters: 400, epoch: 18 | loss: 0.0028140
	speed: 0.1838s/iter; left time: 1047.3217s
Epoch: 18 cost time: 83.12734723091125
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0223565
	speed: 0.5953s/iter; left time: 3291.2950s
	iters: 200, epoch: 19 | loss: 0.0035110
	speed: 0.1732s/iter; left time: 940.2438s
	iters: 300, epoch: 19 | loss: 0.0002729
	speed: 0.1739s/iter; left time: 926.9626s
	iters: 400, epoch: 19 | loss: 0.0019944
	speed: 0.1782s/iter; left time: 931.9501s
Epoch: 19 cost time: 80.67618584632874
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.980274 --> -0.981131).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0052841
	speed: 0.5897s/iter; left time: 2983.6609s
	iters: 200, epoch: 20 | loss: 0.0442480
	speed: 0.1845s/iter; left time: 915.2537s
	iters: 300, epoch: 20 | loss: 0.0123274
	speed: 0.1877s/iter; left time: 912.0010s
	iters: 400, epoch: 20 | loss: 0.0264970
	speed: 0.1779s/iter; left time: 846.7791s
Epoch: 20 cost time: 82.95651745796204
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0203398
	speed: 0.6283s/iter; left time: 2884.3712s
	iters: 200, epoch: 21 | loss: 0.0022063
	speed: 0.1846s/iter; left time: 828.8781s
	iters: 300, epoch: 21 | loss: 0.1994152
	speed: 0.1779s/iter; left time: 780.9577s
	iters: 400, epoch: 21 | loss: 0.0014984
	speed: 0.1682s/iter; left time: 721.7581s
Epoch: 21 cost time: 83.69082164764404
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0307096
	speed: 0.6433s/iter; left time: 2651.7105s
	iters: 200, epoch: 22 | loss: 0.0416043
	speed: 0.1742s/iter; left time: 700.7453s
	iters: 300, epoch: 22 | loss: 0.0170319
	speed: 0.1631s/iter; left time: 639.5976s
	iters: 400, epoch: 22 | loss: 0.0695733
	speed: 0.1619s/iter; left time: 618.5936s
Epoch: 22 cost time: 79.831796169281
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0063716
	speed: 0.6214s/iter; left time: 2269.9584s
	iters: 200, epoch: 23 | loss: 0.0104557
	speed: 0.1596s/iter; left time: 567.2210s
	iters: 300, epoch: 23 | loss: 0.0035537
	speed: 0.1560s/iter; left time: 538.7368s
	iters: 400, epoch: 23 | loss: 0.0013429
	speed: 0.1589s/iter; left time: 532.6557s
Epoch: 23 cost time: 77.21967840194702
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0023463
	speed: 0.6377s/iter; left time: 2030.3783s
	iters: 200, epoch: 24 | loss: 0.0175725
	speed: 0.1683s/iter; left time: 519.0858s
	iters: 300, epoch: 24 | loss: 0.0029921
	speed: 0.1749s/iter; left time: 522.0103s
	iters: 400, epoch: 24 | loss: 0.0023109
	speed: 0.1880s/iter; left time: 542.1279s
Epoch: 24 cost time: 83.68810772895813
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981417 --> -0.981417).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0194557
	speed: 0.6449s/iter; left time: 1750.7845s
	iters: 200, epoch: 25 | loss: 0.0028467
	speed: 0.1721s/iter; left time: 450.0676s
	iters: 300, epoch: 25 | loss: 0.0619583
	speed: 0.1871s/iter; left time: 470.5784s
	iters: 400, epoch: 25 | loss: 0.0009291
	speed: 0.1827s/iter; left time: 441.2514s
Epoch: 25 cost time: 83.91598868370056
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.982275).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0027167
	speed: 0.5939s/iter; left time: 1333.9563s
	iters: 200, epoch: 26 | loss: 0.0015050
	speed: 0.1630s/iter; left time: 349.8111s
	iters: 300, epoch: 26 | loss: 0.1530922
	speed: 0.1700s/iter; left time: 347.7895s
	iters: 400, epoch: 26 | loss: 0.0030165
	speed: 0.1739s/iter; left time: 338.4982s
Epoch: 26 cost time: 78.45788335800171
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983418).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0082658
	speed: 0.5891s/iter; left time: 1046.9088s
	iters: 200, epoch: 27 | loss: 0.0011243
	speed: 0.1877s/iter; left time: 314.8324s
	iters: 300, epoch: 27 | loss: 0.0004317
	speed: 0.1873s/iter; left time: 295.3829s
	iters: 400, epoch: 27 | loss: 0.0163803
	speed: 0.1810s/iter; left time: 267.3129s
Epoch: 27 cost time: 84.41099739074707
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0093750
	speed: 0.6402s/iter; left time: 837.3663s
	iters: 200, epoch: 28 | loss: 0.0008332
	speed: 0.1868s/iter; left time: 225.6244s
	iters: 300, epoch: 28 | loss: 0.0025457
	speed: 0.1783s/iter; left time: 197.5252s
	iters: 400, epoch: 28 | loss: 0.0035056
	speed: 0.1691s/iter; left time: 170.4231s
Epoch: 28 cost time: 84.30327868461609
Epoch: 28, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0007501
	speed: 0.6287s/iter; left time: 527.4773s
	iters: 200, epoch: 29 | loss: 0.0701230
	speed: 0.1709s/iter; left time: 126.2674s
	iters: 300, epoch: 29 | loss: 0.0006306
	speed: 0.1622s/iter; left time: 103.6254s
	iters: 400, epoch: 29 | loss: 0.0040680
	speed: 0.1611s/iter; left time: 86.8316s
Epoch: 29 cost time: 78.50193548202515
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0207791
	speed: 0.6236s/iter; left time: 230.7157s
	iters: 200, epoch: 30 | loss: 0.0074201
	speed: 0.1642s/iter; left time: 44.3207s
	iters: 300, epoch: 30 | loss: 0.0146741
	speed: 0.1611s/iter; left time: 27.3788s
	iters: 400, epoch: 30 | loss: 0.0035680
	speed: 0.1637s/iter; left time: 11.4614s
Epoch: 30 cost time: 79.8054871559143
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983990).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 173418
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9229177
	speed: 0.6180s/iter; left time: 8633.9039s
	iters: 200, epoch: 1 | loss: 1.5830230
	speed: 0.5947s/iter; left time: 8249.2439s
	iters: 300, epoch: 1 | loss: 0.9260821
	speed: 0.6027s/iter; left time: 8299.2502s
	iters: 400, epoch: 1 | loss: 0.8263459
	speed: 0.5407s/iter; left time: 7391.3493s
Epoch: 1 cost time: 276.48352885246277
Epoch: 1, Steps: 469 | Train Loss: 1.393 Vali Loss: 0.495 Vali Acc: 0.881 Test Loss: 0.495 Test Acc: 0.881
Validation loss decreased (inf --> -0.880784).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3450553
	speed: 1.3327s/iter; left time: 17994.6501s
	iters: 200, epoch: 2 | loss: 0.4819914
	speed: 0.5933s/iter; left time: 7950.9790s
	iters: 300, epoch: 2 | loss: 0.1603069
	speed: 0.6281s/iter; left time: 8355.1606s
	iters: 400, epoch: 2 | loss: 0.1154053
	speed: 0.5942s/iter; left time: 7844.6268s
Epoch: 2 cost time: 278.3270025253296
Epoch: 2, Steps: 469 | Train Loss: 0.276 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.880784 --> -0.951685).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0821082
	speed: 1.3356s/iter; left time: 17407.0548s
	iters: 200, epoch: 3 | loss: 0.0650381
	speed: 0.5568s/iter; left time: 7200.4836s
	iters: 300, epoch: 3 | loss: 0.0489041
	speed: 0.6201s/iter; left time: 7957.2856s
	iters: 400, epoch: 3 | loss: 0.0301234
	speed: 0.5987s/iter; left time: 7622.7380s
Epoch: 3 cost time: 277.41837096214294
Epoch: 3, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
Validation loss decreased (-0.951685 --> -0.967409).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0121771
	speed: 1.3797s/iter; left time: 17334.6699s
	iters: 200, epoch: 4 | loss: 0.0262641
	speed: 0.5549s/iter; left time: 6915.9222s
	iters: 300, epoch: 4 | loss: 0.0287036
	speed: 0.5731s/iter; left time: 7085.8168s
	iters: 400, epoch: 4 | loss: 0.0200556
	speed: 0.4839s/iter; left time: 5934.5671s
Epoch: 4 cost time: 255.98530054092407
Epoch: 4, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
Validation loss decreased (-0.967409 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0705054
	speed: 1.2392s/iter; left time: 14987.5984s
	iters: 200, epoch: 5 | loss: 0.0174823
	speed: 0.4901s/iter; left time: 5878.7072s
	iters: 300, epoch: 5 | loss: 0.0041822
	speed: 0.4503s/iter; left time: 5356.8491s
	iters: 400, epoch: 5 | loss: 0.0158507
	speed: 0.4613s/iter; left time: 5440.5966s
Epoch: 5 cost time: 223.38434553146362
Epoch: 5, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0347681
	speed: 1.1451s/iter; left time: 13312.8347s
	iters: 200, epoch: 6 | loss: 0.1200309
	speed: 0.5215s/iter; left time: 6011.0566s
	iters: 300, epoch: 6 | loss: 0.0044464
	speed: 0.5056s/iter; left time: 5776.6551s
	iters: 400, epoch: 6 | loss: 0.0500749
	speed: 0.4694s/iter; left time: 5316.6446s
Epoch: 6 cost time: 222.14383554458618
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.971983 --> -0.978558).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0021252
	speed: 1.0462s/iter; left time: 11672.8052s
	iters: 200, epoch: 7 | loss: 0.0059725
	speed: 0.5258s/iter; left time: 5813.6491s
	iters: 300, epoch: 7 | loss: 0.0096701
	speed: 0.5646s/iter; left time: 6186.7838s
	iters: 400, epoch: 7 | loss: 0.0049922
	speed: 0.5541s/iter; left time: 6015.8720s
Epoch: 7 cost time: 250.6959867477417
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0179123
	speed: 1.2213s/iter; left time: 13053.4898s
	iters: 200, epoch: 8 | loss: 0.0099765
	speed: 0.5020s/iter; left time: 5315.4496s
	iters: 300, epoch: 8 | loss: 0.0033309
	speed: 0.5284s/iter; left time: 5542.0049s
	iters: 400, epoch: 8 | loss: 0.0034200
	speed: 0.5182s/iter; left time: 5383.2540s
Epoch: 8 cost time: 242.22392964363098
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0023852
	speed: 1.2773s/iter; left time: 13052.3683s
	iters: 200, epoch: 9 | loss: 0.0366316
	speed: 0.5469s/iter; left time: 5534.2696s
	iters: 300, epoch: 9 | loss: 0.0126659
	speed: 0.5345s/iter; left time: 5354.8567s
	iters: 400, epoch: 9 | loss: 0.0337487
	speed: 0.5058s/iter; left time: 5017.1197s
Epoch: 9 cost time: 247.54218983650208
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0314367
	speed: 1.2227s/iter; left time: 11921.5420s
	iters: 200, epoch: 10 | loss: 0.0038425
	speed: 0.4291s/iter; left time: 4141.1379s
	iters: 300, epoch: 10 | loss: 0.0052627
	speed: 0.4941s/iter; left time: 4718.9675s
	iters: 400, epoch: 10 | loss: 0.0047542
	speed: 0.4403s/iter; left time: 4160.7937s
Epoch: 10 cost time: 220.6307656764984
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0025293
	speed: 1.0500s/iter; left time: 9745.3240s
	iters: 200, epoch: 11 | loss: 0.0047246
	speed: 0.4475s/iter; left time: 4108.3654s
	iters: 300, epoch: 11 | loss: 0.0021457
	speed: 0.4881s/iter; left time: 4432.7661s
	iters: 400, epoch: 11 | loss: 0.0214242
	speed: 0.4919s/iter; left time: 4417.6364s
Epoch: 11 cost time: 219.98737263679504
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0027898
	speed: 1.0799s/iter; left time: 9516.3522s
	iters: 200, epoch: 12 | loss: 0.0032933
	speed: 0.3959s/iter; left time: 3449.2772s
	iters: 300, epoch: 12 | loss: 0.0073394
	speed: 0.3774s/iter; left time: 3250.2316s
	iters: 400, epoch: 12 | loss: 0.0046539
	speed: 0.4619s/iter; left time: 3931.5264s
Epoch: 12 cost time: 200.37149786949158
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.961 Test Loss: 0.126 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0010197
	speed: 1.1992s/iter; left time: 10004.7743s
	iters: 200, epoch: 13 | loss: 0.0023879
	speed: 0.5216s/iter; left time: 4299.2361s
	iters: 300, epoch: 13 | loss: 0.0088167
	speed: 0.4766s/iter; left time: 3880.9609s
	iters: 400, epoch: 13 | loss: 0.0078554
	speed: 0.4546s/iter; left time: 3656.2515s
Epoch: 13 cost time: 229.0138337612152
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0168343
	speed: 1.1598s/iter; left time: 9132.1091s
	iters: 200, epoch: 14 | loss: 0.0022067
	speed: 0.4101s/iter; left time: 3187.7320s
	iters: 300, epoch: 14 | loss: 0.0153057
	speed: 0.4240s/iter; left time: 3253.9485s
	iters: 400, epoch: 14 | loss: 0.0193769
	speed: 0.4087s/iter; left time: 3095.8440s
Epoch: 14 cost time: 200.25667643547058
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0035869
	speed: 0.8942s/iter; left time: 6621.3742s
	iters: 200, epoch: 15 | loss: 0.0078695
	speed: 0.3617s/iter; left time: 2642.3874s
	iters: 300, epoch: 15 | loss: 0.3648036
	speed: 0.4341s/iter; left time: 3127.9498s
	iters: 400, epoch: 15 | loss: 0.0029208
	speed: 0.4284s/iter; left time: 3044.0742s
Epoch: 15 cost time: 188.2863802909851
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979416).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0031056
	speed: 0.9963s/iter; left time: 6910.1245s
	iters: 200, epoch: 16 | loss: 0.0011229
	speed: 0.2988s/iter; left time: 2042.3686s
	iters: 300, epoch: 16 | loss: 0.0033289
	speed: 0.5550s/iter; left time: 3738.4946s
	iters: 400, epoch: 16 | loss: 0.1589265
	speed: 0.5062s/iter; left time: 3359.0883s
Epoch: 16 cost time: 215.63607382774353
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0057732
	speed: 1.3124s/iter; left time: 8487.5312s
	iters: 200, epoch: 17 | loss: 0.0027575
	speed: 0.5785s/iter; left time: 3683.3205s
	iters: 300, epoch: 17 | loss: 0.0490174
	speed: 0.5223s/iter; left time: 3273.2831s
	iters: 400, epoch: 17 | loss: 0.0024751
	speed: 0.5365s/iter; left time: 3308.6537s
Epoch: 17 cost time: 253.1412341594696
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0017644
	speed: 1.2354s/iter; left time: 7410.0541s
	iters: 200, epoch: 18 | loss: 0.0025706
	speed: 0.5797s/iter; left time: 3418.9769s
	iters: 300, epoch: 18 | loss: 0.0004748
	speed: 0.5597s/iter; left time: 3245.2892s
	iters: 400, epoch: 18 | loss: 0.0050172
	speed: 0.5794s/iter; left time: 3301.4745s
Epoch: 18 cost time: 262.7786762714386
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.981703).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0033443
	speed: 1.2478s/iter; left time: 6899.1281s
	iters: 200, epoch: 19 | loss: 0.0466432
	speed: 0.5195s/iter; left time: 2820.1612s
	iters: 300, epoch: 19 | loss: 0.0034584
	speed: 0.5835s/iter; left time: 3109.5094s
	iters: 400, epoch: 19 | loss: 0.0343657
	speed: 0.5589s/iter; left time: 2922.6029s
Epoch: 19 cost time: 261.7543330192566
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.2332667
	speed: 1.3070s/iter; left time: 6613.3381s
	iters: 200, epoch: 20 | loss: 0.0019624
	speed: 0.5180s/iter; left time: 2569.1362s
	iters: 300, epoch: 20 | loss: 0.0017204
	speed: 0.5427s/iter; left time: 2637.4183s
	iters: 400, epoch: 20 | loss: 0.0015530
	speed: 0.5426s/iter; left time: 2582.8208s
Epoch: 20 cost time: 255.33596301078796
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0340503
	speed: 1.3064s/iter; left time: 5997.7206s
	iters: 200, epoch: 21 | loss: 0.0157193
	speed: 0.5899s/iter; left time: 2649.0476s
	iters: 300, epoch: 21 | loss: 0.0484295
	speed: 0.5011s/iter; left time: 2200.2881s
	iters: 400, epoch: 21 | loss: 0.0021654
	speed: 0.3696s/iter; left time: 1586.1225s
Epoch: 21 cost time: 231.7713713645935
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0014125
	speed: 1.1585s/iter; left time: 4775.5325s
	iters: 200, epoch: 22 | loss: 0.0067923
	speed: 0.5196s/iter; left time: 2089.7576s
	iters: 300, epoch: 22 | loss: 0.0297340
	speed: 0.5221s/iter; left time: 2047.6112s
	iters: 400, epoch: 22 | loss: 0.0017787
	speed: 0.5072s/iter; left time: 1938.4424s
Epoch: 22 cost time: 240.14307975769043
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0049686
	speed: 1.1372s/iter; left time: 4154.1484s
	iters: 200, epoch: 23 | loss: 0.0046358
	speed: 0.4821s/iter; left time: 1712.8853s
	iters: 300, epoch: 23 | loss: 0.0042574
	speed: 0.5252s/iter; left time: 1813.3885s
	iters: 400, epoch: 23 | loss: 0.0011723
	speed: 0.5224s/iter; left time: 1751.4582s
Epoch: 23 cost time: 236.94037127494812
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0029023
	speed: 1.1833s/iter; left time: 3767.7572s
	iters: 200, epoch: 24 | loss: 0.0004830
	speed: 0.4758s/iter; left time: 1467.4368s
	iters: 300, epoch: 24 | loss: 0.0006179
	speed: 0.4862s/iter; left time: 1450.7007s
	iters: 400, epoch: 24 | loss: 0.0012320
	speed: 0.4905s/iter; left time: 1414.5491s
Epoch: 24 cost time: 228.92128014564514
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0188915
	speed: 1.1460s/iter; left time: 3111.2795s
	iters: 200, epoch: 25 | loss: 0.0025856
	speed: 0.5424s/iter; left time: 1418.2905s
	iters: 300, epoch: 25 | loss: 0.0027627
	speed: 0.5356s/iter; left time: 1347.1115s
	iters: 400, epoch: 25 | loss: 0.0007429
	speed: 0.4595s/iter; left time: 1109.7795s
Epoch: 25 cost time: 235.19238567352295
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.981703 --> -0.985706).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0027541
	speed: 1.2191s/iter; left time: 2738.0204s
	iters: 200, epoch: 26 | loss: 0.0230639
	speed: 0.4180s/iter; left time: 896.9552s
	iters: 300, epoch: 26 | loss: 0.0081468
	speed: 0.5012s/iter; left time: 1025.4431s
	iters: 400, epoch: 26 | loss: 0.0013292
	speed: 0.4521s/iter; left time: 879.8160s
Epoch: 26 cost time: 220.25293254852295
Epoch: 26, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0027207
	speed: 1.1589s/iter; left time: 2059.3556s
	iters: 200, epoch: 27 | loss: 0.0013845
	speed: 0.4139s/iter; left time: 694.1370s
	iters: 300, epoch: 27 | loss: 0.0017619
	speed: 0.4980s/iter; left time: 785.3429s
	iters: 400, epoch: 27 | loss: 0.0008174
	speed: 0.5226s/iter; left time: 771.8875s
Epoch: 27 cost time: 225.4933955669403
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0026040
	speed: 1.1024s/iter; left time: 1441.9041s
	iters: 200, epoch: 28 | loss: 0.0682113
	speed: 0.5313s/iter; left time: 641.8452s
	iters: 300, epoch: 28 | loss: 0.0019365
	speed: 0.4288s/iter; left time: 475.1065s
	iters: 400, epoch: 28 | loss: 0.0002326
	speed: 0.4944s/iter; left time: 498.3654s
Epoch: 28 cost time: 223.220853805542
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0005376
	speed: 0.9004s/iter; left time: 755.4559s
	iters: 200, epoch: 29 | loss: 0.0023356
	speed: 0.4148s/iter; left time: 306.5513s
	iters: 300, epoch: 29 | loss: 0.0004222
	speed: 0.4619s/iter; left time: 295.1439s
	iters: 400, epoch: 29 | loss: 0.0076561
	speed: 0.3395s/iter; left time: 182.9849s
Epoch: 29 cost time: 180.51251029968262
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0434671
	speed: 1.0213s/iter; left time: 377.8759s
	iters: 200, epoch: 30 | loss: 0.0072150
	speed: 0.3534s/iter; left time: 95.4167s
	iters: 300, epoch: 30 | loss: 0.0771844
	speed: 0.3905s/iter; left time: 66.3806s
	iters: 400, epoch: 30 | loss: 0.0161063
	speed: 0.4697s/iter; left time: 32.8810s
Epoch: 30 cost time: 196.08336663246155
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 294186
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0331342
	speed: 0.3177s/iter; left time: 4439.1443s
	iters: 200, epoch: 1 | loss: 1.7196007
	speed: 0.2941s/iter; left time: 4078.9177s
	iters: 300, epoch: 1 | loss: 1.3301198
	speed: 0.1331s/iter; left time: 1832.9480s
	iters: 400, epoch: 1 | loss: 1.1701472
	speed: 0.2662s/iter; left time: 3639.3719s
Epoch: 1 cost time: 117.31814122200012
Epoch: 1, Steps: 469 | Train Loss: 1.531 Vali Loss: 0.675 Vali Acc: 0.824 Test Loss: 0.675 Test Acc: 0.824
Validation loss decreased (inf --> -0.824464).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3709002
	speed: 0.7743s/iter; left time: 10454.7065s
	iters: 200, epoch: 2 | loss: 0.3384446
	speed: 0.3017s/iter; left time: 4042.9729s
	iters: 300, epoch: 2 | loss: 0.2269642
	speed: 0.2251s/iter; left time: 2993.8856s
	iters: 400, epoch: 2 | loss: 0.2246873
	speed: 0.2762s/iter; left time: 3646.6509s
Epoch: 2 cost time: 130.63738465309143
Epoch: 2, Steps: 469 | Train Loss: 0.374 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
Validation loss decreased (-0.824464 --> -0.927671).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4311282
	speed: 0.8097s/iter; left time: 10553.1944s
	iters: 200, epoch: 3 | loss: 0.1320191
	speed: 0.2766s/iter; left time: 3577.6245s
	iters: 300, epoch: 3 | loss: 0.0983027
	speed: 0.2364s/iter; left time: 3033.2059s
	iters: 400, epoch: 3 | loss: 0.0576697
	speed: 0.2832s/iter; left time: 3606.5189s
Epoch: 3 cost time: 135.56368398666382
Epoch: 3, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.927671 --> -0.968552).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0888199
	speed: 0.7848s/iter; left time: 9860.3678s
	iters: 200, epoch: 4 | loss: 0.0744263
	speed: 0.2634s/iter; left time: 3282.5735s
	iters: 300, epoch: 4 | loss: 0.0504340
	speed: 0.2597s/iter; left time: 3211.0324s
	iters: 400, epoch: 4 | loss: 0.0401082
	speed: 0.3055s/iter; left time: 3747.2383s
Epoch: 4 cost time: 131.21083092689514
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.969982).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1230332
	speed: 0.7433s/iter; left time: 8989.7086s
	iters: 200, epoch: 5 | loss: 0.0098995
	speed: 0.1225s/iter; left time: 1469.2276s
	iters: 300, epoch: 5 | loss: 0.0298429
	speed: 0.2439s/iter; left time: 2901.5263s
	iters: 400, epoch: 5 | loss: 0.0158178
	speed: 0.2634s/iter; left time: 3106.9384s
Epoch: 5 cost time: 103.57537412643433
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.969982 --> -0.975985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0082073
	speed: 0.6365s/iter; left time: 7399.5952s
	iters: 200, epoch: 6 | loss: 0.0187822
	speed: 0.2200s/iter; left time: 2535.5389s
	iters: 300, epoch: 6 | loss: 0.0496132
	speed: 0.2522s/iter; left time: 2881.2445s
	iters: 400, epoch: 6 | loss: 0.0332888
	speed: 0.2626s/iter; left time: 2974.5765s
Epoch: 6 cost time: 108.52304363250732
Epoch: 6, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1101791
	speed: 0.5932s/iter; left time: 6618.7120s
	iters: 200, epoch: 7 | loss: 0.0187615
	speed: 0.2560s/iter; left time: 2830.5031s
	iters: 300, epoch: 7 | loss: 0.3319312
	speed: 0.2714s/iter; left time: 2973.6913s
	iters: 400, epoch: 7 | loss: 0.0070726
	speed: 0.2173s/iter; left time: 2358.9954s
Epoch: 7 cost time: 107.72773241996765
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0706915
	speed: 0.6137s/iter; left time: 6559.2619s
	iters: 200, epoch: 8 | loss: 0.1325908
	speed: 0.2749s/iter; left time: 2910.8093s
	iters: 300, epoch: 8 | loss: 0.1656957
	speed: 0.2316s/iter; left time: 2429.0273s
	iters: 400, epoch: 8 | loss: 0.1854355
	speed: 0.1463s/iter; left time: 1519.8712s
Epoch: 8 cost time: 101.40718030929565
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978272).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0042897
	speed: 0.7393s/iter; left time: 7554.5031s
	iters: 200, epoch: 9 | loss: 0.0083260
	speed: 0.3417s/iter; left time: 3458.1498s
	iters: 300, epoch: 9 | loss: 0.0034615
	speed: 0.2777s/iter; left time: 2782.6145s
	iters: 400, epoch: 9 | loss: 0.0061476
	speed: 0.2854s/iter; left time: 2830.6117s
Epoch: 9 cost time: 138.1907889842987
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.978272 --> -0.982275).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0278590
	speed: 0.7909s/iter; left time: 7711.3536s
	iters: 200, epoch: 10 | loss: 0.0018203
	speed: 0.3326s/iter; left time: 3209.9772s
	iters: 300, epoch: 10 | loss: 0.1157917
	speed: 0.2351s/iter; left time: 2244.9681s
	iters: 400, epoch: 10 | loss: 0.0089562
	speed: 0.3064s/iter; left time: 2895.0203s
Epoch: 10 cost time: 140.1982457637787
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0662637
	speed: 0.8320s/iter; left time: 7722.1660s
	iters: 200, epoch: 11 | loss: 0.0506888
	speed: 0.2867s/iter; left time: 2631.9709s
	iters: 300, epoch: 11 | loss: 0.0083222
	speed: 0.2627s/iter; left time: 2385.8506s
	iters: 400, epoch: 11 | loss: 0.0314704
	speed: 0.3240s/iter; left time: 2910.1544s
Epoch: 11 cost time: 140.19574666023254
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0060507
	speed: 0.8228s/iter; left time: 7250.3463s
	iters: 200, epoch: 12 | loss: 0.0053356
	speed: 0.2813s/iter; left time: 2450.9272s
	iters: 300, epoch: 12 | loss: 0.0151956
	speed: 0.3115s/iter; left time: 2682.4923s
	iters: 400, epoch: 12 | loss: 0.0109869
	speed: 0.3390s/iter; left time: 2885.2565s
Epoch: 12 cost time: 144.56031680107117
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0015540
	speed: 0.8084s/iter; left time: 6744.1726s
	iters: 200, epoch: 13 | loss: 0.0058247
	speed: 0.2915s/iter; left time: 2402.7030s
	iters: 300, epoch: 13 | loss: 0.0246919
	speed: 0.3327s/iter; left time: 2709.2576s
	iters: 400, epoch: 13 | loss: 0.0211705
	speed: 0.3270s/iter; left time: 2630.4028s
Epoch: 13 cost time: 144.36841535568237
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0036049
	speed: 0.6197s/iter; left time: 4879.7587s
	iters: 200, epoch: 14 | loss: 0.0644564
	speed: 0.2865s/iter; left time: 2227.5781s
	iters: 300, epoch: 14 | loss: 0.0094522
	speed: 0.2881s/iter; left time: 2210.5733s
	iters: 400, epoch: 14 | loss: 0.0117693
	speed: 0.2371s/iter; left time: 1795.4302s
Epoch: 14 cost time: 110.6962788105011
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0165868
	speed: 0.7155s/iter; left time: 5298.4535s
	iters: 200, epoch: 15 | loss: 0.0226569
	speed: 0.2895s/iter; left time: 2115.1585s
	iters: 300, epoch: 15 | loss: 0.0012135
	speed: 0.2568s/iter; left time: 1850.3726s
	iters: 400, epoch: 15 | loss: 0.0035444
	speed: 0.2167s/iter; left time: 1539.7898s
Epoch: 15 cost time: 119.93699955940247
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0072418
	speed: 0.5740s/iter; left time: 3981.2308s
	iters: 200, epoch: 16 | loss: 0.0095100
	speed: 0.1445s/iter; left time: 987.7977s
	iters: 300, epoch: 16 | loss: 0.0017924
	speed: 0.3083s/iter; left time: 2076.7266s
	iters: 400, epoch: 16 | loss: 0.0011773
	speed: 0.3066s/iter; left time: 2034.5220s
Epoch: 16 cost time: 112.47896981239319
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0193675
	speed: 0.7594s/iter; left time: 4911.1444s
	iters: 200, epoch: 17 | loss: 0.0034918
	speed: 0.2708s/iter; left time: 1723.8900s
	iters: 300, epoch: 17 | loss: 0.0184612
	speed: 0.2644s/iter; left time: 1656.9634s
	iters: 400, epoch: 17 | loss: 0.0019989
	speed: 0.2687s/iter; left time: 1656.8501s
Epoch: 17 cost time: 126.67850255966187
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0005773
	speed: 0.8151s/iter; left time: 4888.6742s
	iters: 200, epoch: 18 | loss: 0.0081773
	speed: 0.3134s/iter; left time: 1848.4978s
	iters: 300, epoch: 18 | loss: 0.0098966
	speed: 0.2991s/iter; left time: 1734.2656s
	iters: 400, epoch: 18 | loss: 0.0686026
	speed: 0.2286s/iter; left time: 1302.6009s
Epoch: 18 cost time: 128.38152623176575
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0306347
	speed: 0.7370s/iter; left time: 4074.9893s
	iters: 200, epoch: 19 | loss: 0.0013565
	speed: 0.3277s/iter; left time: 1778.8865s
	iters: 300, epoch: 19 | loss: 0.0013972
	speed: 0.3449s/iter; left time: 1838.2377s
	iters: 400, epoch: 19 | loss: 0.0046752
	speed: 0.3485s/iter; left time: 1822.1965s
Epoch: 19 cost time: 154.78590393066406
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 87146
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9232628
	speed: 0.3353s/iter; left time: 4685.0122s
	iters: 200, epoch: 1 | loss: 1.5802335
	speed: 0.3474s/iter; left time: 4819.4532s
	iters: 300, epoch: 1 | loss: 0.9521926
	speed: 0.3067s/iter; left time: 4222.9008s
	iters: 400, epoch: 1 | loss: 0.8518314
	speed: 0.3625s/iter; left time: 4956.0511s
Epoch: 1 cost time: 162.26133489608765
Epoch: 1, Steps: 469 | Train Loss: 1.399 Vali Loss: 0.510 Vali Acc: 0.880 Test Loss: 0.510 Test Acc: 0.880
Validation loss decreased (inf --> -0.879926).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3581006
	speed: 0.9521s/iter; left time: 12855.5924s
	iters: 200, epoch: 2 | loss: 0.5293437
	speed: 0.3477s/iter; left time: 4659.3750s
	iters: 300, epoch: 2 | loss: 0.1947925
	speed: 0.3360s/iter; left time: 4468.9680s
	iters: 400, epoch: 2 | loss: 0.1533125
	speed: 0.3180s/iter; left time: 4198.7366s
Epoch: 2 cost time: 160.72441697120667
Epoch: 2, Steps: 469 | Train Loss: 0.289 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.879926 --> -0.947683).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0820585
	speed: 0.9127s/iter; left time: 11894.7204s
	iters: 200, epoch: 3 | loss: 0.1083259
	speed: 0.3806s/iter; left time: 4922.6296s
	iters: 300, epoch: 3 | loss: 0.0337884
	speed: 0.3789s/iter; left time: 4862.4390s
	iters: 400, epoch: 3 | loss: 0.0323598
	speed: 0.3250s/iter; left time: 4138.3187s
Epoch: 3 cost time: 167.75810265541077
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.947683 --> -0.968266).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0137457
	speed: 0.8546s/iter; left time: 10736.5663s
	iters: 200, epoch: 4 | loss: 0.0209884
	speed: 0.3486s/iter; left time: 4344.9317s
	iters: 300, epoch: 4 | loss: 0.0237251
	speed: 0.3785s/iter; left time: 4679.8052s
	iters: 400, epoch: 4 | loss: 0.0222906
	speed: 0.3682s/iter; left time: 4516.2046s
Epoch: 4 cost time: 166.43730187416077
Epoch: 4, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
Validation loss decreased (-0.968266 --> -0.968838).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0867913
	speed: 0.8865s/iter; left time: 10721.6319s
	iters: 200, epoch: 5 | loss: 0.0107265
	speed: 0.3232s/iter; left time: 3876.3001s
	iters: 300, epoch: 5 | loss: 0.0093636
	speed: 0.3477s/iter; left time: 4135.3176s
	iters: 400, epoch: 5 | loss: 0.0124064
	speed: 0.3229s/iter; left time: 3808.9232s
Epoch: 5 cost time: 155.77358603477478
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.143 Vali Acc: 0.953 Test Loss: 0.143 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0477881
	speed: 0.9159s/iter; left time: 10648.7283s
	iters: 200, epoch: 6 | loss: 0.1269255
	speed: 0.2688s/iter; left time: 3098.0637s
	iters: 300, epoch: 6 | loss: 0.0081705
	speed: 0.2647s/iter; left time: 3024.0388s
	iters: 400, epoch: 6 | loss: 0.0376679
	speed: 0.2577s/iter; left time: 2918.5139s
Epoch: 6 cost time: 132.39117217063904
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.968838 --> -0.977415).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0025524
	speed: 0.7789s/iter; left time: 8689.7283s
	iters: 200, epoch: 7 | loss: 0.0053904
	speed: 0.3168s/iter; left time: 3502.8690s
	iters: 300, epoch: 7 | loss: 0.0068416
	speed: 0.3108s/iter; left time: 3405.9168s
	iters: 400, epoch: 7 | loss: 0.0065668
	speed: 0.3289s/iter; left time: 3571.1543s
Epoch: 7 cost time: 145.662912607193
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0067996
	speed: 0.7193s/iter; left time: 7688.2233s
	iters: 200, epoch: 8 | loss: 0.0116838
	speed: 0.2586s/iter; left time: 2737.8547s
	iters: 300, epoch: 8 | loss: 0.0032425
	speed: 0.2785s/iter; left time: 2920.8669s
	iters: 400, epoch: 8 | loss: 0.0033265
	speed: 0.2585s/iter; left time: 2685.5714s
Epoch: 8 cost time: 128.74972796440125
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0017409
	speed: 0.8697s/iter; left time: 8887.2325s
	iters: 200, epoch: 9 | loss: 0.0166266
	speed: 0.2996s/iter; left time: 3031.1818s
	iters: 300, epoch: 9 | loss: 0.0205158
	speed: 0.2979s/iter; left time: 2984.9121s
	iters: 400, epoch: 9 | loss: 0.0417572
	speed: 0.3068s/iter; left time: 3042.7758s
Epoch: 9 cost time: 144.38578534126282
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.977987).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0218140
	speed: 0.8521s/iter; left time: 8308.4258s
	iters: 200, epoch: 10 | loss: 0.0033346
	speed: 0.3472s/iter; left time: 3350.6457s
	iters: 300, epoch: 10 | loss: 0.0055720
	speed: 0.3492s/iter; left time: 3334.5019s
	iters: 400, epoch: 10 | loss: 0.0125476
	speed: 0.3079s/iter; left time: 2910.0281s
Epoch: 10 cost time: 154.01164555549622
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0039417
	speed: 0.6408s/iter; left time: 5946.9202s
	iters: 200, epoch: 11 | loss: 0.0071058
	speed: 0.2536s/iter; left time: 2328.6111s
	iters: 300, epoch: 11 | loss: 0.0012557
	speed: 0.2842s/iter; left time: 2581.2044s
	iters: 400, epoch: 11 | loss: 0.0185762
	speed: 0.2832s/iter; left time: 2543.4253s
Epoch: 11 cost time: 123.8088026046753
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0033754
	speed: 0.6778s/iter; left time: 5973.0506s
	iters: 200, epoch: 12 | loss: 0.0061256
	speed: 0.2296s/iter; left time: 2000.0175s
	iters: 300, epoch: 12 | loss: 0.0049072
	speed: 0.1710s/iter; left time: 1473.0648s
	iters: 400, epoch: 12 | loss: 0.0431169
	speed: 0.2980s/iter; left time: 2536.3709s
Epoch: 12 cost time: 115.69304203987122
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0012633
	speed: 0.9092s/iter; left time: 7585.5479s
	iters: 200, epoch: 13 | loss: 0.0674639
	speed: 0.3610s/iter; left time: 2975.7027s
	iters: 300, epoch: 13 | loss: 0.0115158
	speed: 0.3322s/iter; left time: 2705.1020s
	iters: 400, epoch: 13 | loss: 0.0361574
	speed: 0.3157s/iter; left time: 2539.4639s
Epoch: 13 cost time: 161.51837611198425
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0079811
	speed: 0.8515s/iter; left time: 6704.6914s
	iters: 200, epoch: 14 | loss: 0.0110115
	speed: 0.3662s/iter; left time: 2847.1814s
	iters: 300, epoch: 14 | loss: 0.0967473
	speed: 0.3691s/iter; left time: 2832.3139s
	iters: 400, epoch: 14 | loss: 0.0167260
	speed: 0.3621s/iter; left time: 2742.7489s
Epoch: 14 cost time: 165.4288763999939
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0067707
	speed: 0.8545s/iter; left time: 6327.7486s
	iters: 200, epoch: 15 | loss: 0.0172436
	speed: 0.3088s/iter; left time: 2255.7583s
	iters: 300, epoch: 15 | loss: 0.3134198
	speed: 0.2807s/iter; left time: 2022.3753s
	iters: 400, epoch: 15 | loss: 0.0015147
	speed: 0.2665s/iter; left time: 1893.5263s
Epoch: 15 cost time: 138.57103562355042
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0057295
	speed: 0.8245s/iter; left time: 5718.4412s
	iters: 200, epoch: 16 | loss: 0.0014483
	speed: 0.2832s/iter; left time: 1935.9367s
	iters: 300, epoch: 16 | loss: 0.0023637
	speed: 0.2642s/iter; left time: 1779.8013s
	iters: 400, epoch: 16 | loss: 0.0259151
	speed: 0.2588s/iter; left time: 1717.5634s
Epoch: 16 cost time: 130.53390622138977
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.977987 --> -0.979130).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0012837
	speed: 0.7712s/iter; left time: 4987.2472s
	iters: 200, epoch: 17 | loss: 0.0010056
	speed: 0.3127s/iter; left time: 1991.1537s
	iters: 300, epoch: 17 | loss: 0.0568361
	speed: 0.3258s/iter; left time: 2042.0798s
	iters: 400, epoch: 17 | loss: 0.0014824
	speed: 0.2897s/iter; left time: 1786.8692s
Epoch: 17 cost time: 143.56292629241943
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0021747
	speed: 0.7095s/iter; left time: 4255.6166s
	iters: 200, epoch: 18 | loss: 0.0065300
	speed: 0.2582s/iter; left time: 1522.8108s
	iters: 300, epoch: 18 | loss: 0.0013156
	speed: 0.2001s/iter; left time: 1159.9532s
	iters: 400, epoch: 18 | loss: 0.0074946
	speed: 0.3459s/iter; left time: 1970.7374s
Epoch: 18 cost time: 128.00891876220703
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
Validation loss decreased (-0.979130 --> -0.983704).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0086677
	speed: 0.8595s/iter; left time: 4752.4061s
	iters: 200, epoch: 19 | loss: 0.0143255
	speed: 0.2950s/iter; left time: 1601.5500s
	iters: 300, epoch: 19 | loss: 0.0452103
	speed: 0.2813s/iter; left time: 1499.0206s
	iters: 400, epoch: 19 | loss: 0.0005157
	speed: 0.2986s/iter; left time: 1561.1467s
Epoch: 19 cost time: 139.75203919410706
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1305579
	speed: 0.8385s/iter; left time: 4242.5649s
	iters: 200, epoch: 20 | loss: 0.0009920
	speed: 0.3481s/iter; left time: 1726.7478s
	iters: 300, epoch: 20 | loss: 0.0032332
	speed: 0.3449s/iter; left time: 1676.0483s
	iters: 400, epoch: 20 | loss: 0.0122748
	speed: 0.3079s/iter; left time: 1465.6635s
Epoch: 20 cost time: 156.86527967453003
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0939626
	speed: 0.7140s/iter; left time: 3277.8041s
	iters: 200, epoch: 21 | loss: 0.0623451
	speed: 0.2544s/iter; left time: 1142.5922s
	iters: 300, epoch: 21 | loss: 0.0211834
	speed: 0.3043s/iter; left time: 1335.9667s
	iters: 400, epoch: 21 | loss: 0.0087460
	speed: 0.2966s/iter; left time: 1272.8339s
Epoch: 21 cost time: 132.75660800933838
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0039843
	speed: 0.7307s/iter; left time: 3012.0287s
	iters: 200, epoch: 22 | loss: 0.0018448
	speed: 0.2564s/iter; left time: 1031.3863s
	iters: 300, epoch: 22 | loss: 0.0090032
	speed: 0.2389s/iter; left time: 937.1599s
	iters: 400, epoch: 22 | loss: 0.0041367
	speed: 0.2298s/iter; left time: 878.3025s
Epoch: 22 cost time: 114.05117273330688
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0047747
	speed: 0.7506s/iter; left time: 2742.0701s
	iters: 200, epoch: 23 | loss: 0.0057514
	speed: 0.3046s/iter; left time: 1082.1373s
	iters: 300, epoch: 23 | loss: 0.0007335
	speed: 0.2732s/iter; left time: 943.2372s
	iters: 400, epoch: 23 | loss: 0.0052518
	speed: 0.2714s/iter; left time: 910.0805s
Epoch: 23 cost time: 131.60261297225952
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0006653
	speed: 0.6854s/iter; left time: 2182.2812s
	iters: 200, epoch: 24 | loss: 0.0005414
	speed: 0.3142s/iter; left time: 968.8499s
	iters: 300, epoch: 24 | loss: 0.0007631
	speed: 0.2967s/iter; left time: 885.2398s
	iters: 400, epoch: 24 | loss: 0.0026225
	speed: 0.3135s/iter; left time: 904.2269s
Epoch: 24 cost time: 138.907799243927
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0017176
	speed: 0.7166s/iter; left time: 1945.6599s
	iters: 200, epoch: 25 | loss: 0.0036717
	speed: 0.1732s/iter; left time: 452.8067s
	iters: 300, epoch: 25 | loss: 0.0061546
	speed: 0.2101s/iter; left time: 528.3396s
	iters: 400, epoch: 25 | loss: 0.0009022
	speed: 0.2242s/iter; left time: 541.5281s
Epoch: 25 cost time: 104.88118886947632
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.983704 --> -0.986277).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0024240
	speed: 0.7179s/iter; left time: 1612.2951s
	iters: 200, epoch: 26 | loss: 0.0031609
	speed: 0.2672s/iter; left time: 573.4781s
	iters: 300, epoch: 26 | loss: 0.0139290
	speed: 0.2000s/iter; left time: 409.2530s
	iters: 400, epoch: 26 | loss: 0.0075060
	speed: 0.2150s/iter; left time: 418.4524s
Epoch: 26 cost time: 108.45056653022766
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0520458
	speed: 0.7191s/iter; left time: 1277.7846s
	iters: 200, epoch: 27 | loss: 0.0022623
	speed: 0.3746s/iter; left time: 628.2179s
	iters: 300, epoch: 27 | loss: 0.0008636
	speed: 0.3620s/iter; left time: 570.8354s
	iters: 400, epoch: 27 | loss: 0.0034136
	speed: 0.3559s/iter; left time: 525.6594s
Epoch: 27 cost time: 169.8390257358551
Epoch: 27, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0016117
	speed: 0.8645s/iter; left time: 1130.8130s
	iters: 200, epoch: 28 | loss: 0.2302060
	speed: 0.3441s/iter; left time: 415.6519s
	iters: 300, epoch: 28 | loss: 0.0010836
	speed: 0.3321s/iter; left time: 368.0139s
	iters: 400, epoch: 28 | loss: 0.0003948
	speed: 0.3545s/iter; left time: 357.3765s
Epoch: 28 cost time: 161.1223020553589
Epoch: 28, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0009068
	speed: 0.9276s/iter; left time: 778.2811s
	iters: 200, epoch: 29 | loss: 0.0014731
	speed: 0.3375s/iter; left time: 249.3938s
	iters: 300, epoch: 29 | loss: 0.0002290
	speed: 0.3410s/iter; left time: 217.9203s
	iters: 400, epoch: 29 | loss: 0.0116928
	speed: 0.3197s/iter; left time: 172.3426s
Epoch: 29 cost time: 158.5352759361267
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0225178
	speed: 0.8958s/iter; left time: 331.4426s
	iters: 200, epoch: 30 | loss: 0.0582569
	speed: 0.3664s/iter; left time: 98.9201s
	iters: 300, epoch: 30 | loss: 0.0084171
	speed: 0.3762s/iter; left time: 63.9588s
	iters: 400, epoch: 30 | loss: 0.0018990
	speed: 0.3248s/iter; left time: 22.7385s
Epoch: 30 cost time: 163.26581120491028
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 294186
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0333612
	speed: 0.2615s/iter; left time: 3652.8565s
	iters: 200, epoch: 1 | loss: 1.7251962
	speed: 0.2289s/iter; left time: 3175.1336s
	iters: 300, epoch: 1 | loss: 1.3442062
	speed: 0.2616s/iter; left time: 3602.6557s
	iters: 400, epoch: 1 | loss: 1.1744865
	speed: 0.2288s/iter; left time: 3128.3312s
Epoch: 1 cost time: 116.57397317886353
Epoch: 1, Steps: 469 | Train Loss: 1.534 Vali Loss: 0.673 Vali Acc: 0.830 Test Loss: 0.673 Test Acc: 0.830
Validation loss decreased (inf --> -0.829896).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3675855
	speed: 0.6213s/iter; left time: 8388.8758s
	iters: 200, epoch: 2 | loss: 0.3446234
	speed: 0.2034s/iter; left time: 2725.6744s
	iters: 300, epoch: 2 | loss: 0.2086453
	speed: 0.2035s/iter; left time: 2707.0090s
	iters: 400, epoch: 2 | loss: 0.2150139
	speed: 0.1845s/iter; left time: 2435.5260s
Epoch: 2 cost time: 87.25327610969543
Epoch: 2, Steps: 469 | Train Loss: 0.375 Vali Loss: 0.222 Vali Acc: 0.923 Test Loss: 0.222 Test Acc: 0.923
Validation loss decreased (-0.829896 --> -0.922811).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4483545
	speed: 0.8033s/iter; left time: 10469.5544s
	iters: 200, epoch: 3 | loss: 0.1435784
	speed: 0.3511s/iter; left time: 4540.1300s
	iters: 300, epoch: 3 | loss: 0.1236995
	speed: 0.2959s/iter; left time: 3797.5445s
	iters: 400, epoch: 3 | loss: 0.0724665
	speed: 0.3176s/iter; left time: 4043.9386s
Epoch: 3 cost time: 154.08171963691711
Epoch: 3, Steps: 469 | Train Loss: 0.152 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
Validation loss decreased (-0.922811 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0928393
	speed: 0.9561s/iter; left time: 12012.7320s
	iters: 200, epoch: 4 | loss: 0.0811379
	speed: 0.3146s/iter; left time: 3921.6491s
	iters: 300, epoch: 4 | loss: 0.0361793
	speed: 0.3337s/iter; left time: 4125.9343s
	iters: 400, epoch: 4 | loss: 0.0313505
	speed: 0.3383s/iter; left time: 4148.2981s
Epoch: 4 cost time: 154.0542848110199
Epoch: 4, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1014635
	speed: 0.9360s/iter; left time: 11320.5130s
	iters: 200, epoch: 5 | loss: 0.0098883
	speed: 0.3328s/iter; left time: 3991.7899s
	iters: 300, epoch: 5 | loss: 0.0551877
	speed: 0.3058s/iter; left time: 3637.7902s
	iters: 400, epoch: 5 | loss: 0.0179606
	speed: 0.3492s/iter; left time: 4119.2296s
Epoch: 5 cost time: 151.71173644065857
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (-0.966265 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0123226
	speed: 0.9677s/iter; left time: 11250.2666s
	iters: 200, epoch: 6 | loss: 0.0339352
	speed: 0.3504s/iter; left time: 4038.2284s
	iters: 300, epoch: 6 | loss: 0.1075343
	speed: 0.3482s/iter; left time: 3978.7585s
	iters: 400, epoch: 6 | loss: 0.0177365
	speed: 0.3394s/iter; left time: 3843.9238s
Epoch: 6 cost time: 160.48839664459229
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.972555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1481384
	speed: 0.9876s/iter; left time: 11018.1362s
	iters: 200, epoch: 7 | loss: 0.0503172
	speed: 0.3583s/iter; left time: 3962.1580s
	iters: 300, epoch: 7 | loss: 0.5129535
	speed: 0.3232s/iter; left time: 3541.3617s
	iters: 400, epoch: 7 | loss: 0.0042767
	speed: 0.3407s/iter; left time: 3699.2158s
Epoch: 7 cost time: 161.5293116569519
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0105757
	speed: 1.0167s/iter; left time: 10866.9047s
	iters: 200, epoch: 8 | loss: 0.0402198
	speed: 0.3376s/iter; left time: 3574.1747s
	iters: 300, epoch: 8 | loss: 0.0160639
	speed: 0.3185s/iter; left time: 3340.6333s
	iters: 400, epoch: 8 | loss: 0.2674030
	speed: 0.3460s/iter; left time: 3594.2100s
Epoch: 8 cost time: 161.70272779464722
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.972555 --> -0.980560).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0041741
	speed: 1.0200s/iter; left time: 10423.5547s
	iters: 200, epoch: 9 | loss: 0.0241608
	speed: 0.3324s/iter; left time: 3364.0603s
	iters: 300, epoch: 9 | loss: 0.0047393
	speed: 0.3231s/iter; left time: 3237.4661s
	iters: 400, epoch: 9 | loss: 0.0062363
	speed: 0.3647s/iter; left time: 3617.4195s
Epoch: 9 cost time: 161.84277844429016
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.980560 --> -0.981989).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0808322
	speed: 0.9979s/iter; left time: 9729.9285s
	iters: 200, epoch: 10 | loss: 0.0178978
	speed: 0.3341s/iter; left time: 3224.5224s
	iters: 300, epoch: 10 | loss: 0.0606531
	speed: 0.3507s/iter; left time: 3348.7304s
	iters: 400, epoch: 10 | loss: 0.0087268
	speed: 0.3630s/iter; left time: 3429.9027s
Epoch: 10 cost time: 163.39264583587646
Epoch: 10, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0237004
	speed: 0.8746s/iter; left time: 8117.2925s
	iters: 200, epoch: 11 | loss: 0.0255239
	speed: 0.3031s/iter; left time: 2782.3339s
	iters: 300, epoch: 11 | loss: 0.0059463
	speed: 0.3083s/iter; left time: 2799.4544s
	iters: 400, epoch: 11 | loss: 0.0080436
	speed: 0.2969s/iter; left time: 2666.3948s
Epoch: 11 cost time: 134.18725609779358
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0106029
	speed: 1.1811s/iter; left time: 10408.2253s
	iters: 200, epoch: 12 | loss: 0.0036510
	speed: 0.5623s/iter; left time: 4898.9697s
	iters: 300, epoch: 12 | loss: 0.0215782
	speed: 0.5375s/iter; left time: 4629.0625s
	iters: 400, epoch: 12 | loss: 0.0067030
	speed: 0.5263s/iter; left time: 4479.5227s
Epoch: 12 cost time: 252.66943383216858
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0023642
	speed: 1.5320s/iter; left time: 12781.5253s
	iters: 200, epoch: 13 | loss: 0.0060939
	speed: 0.5398s/iter; left time: 4449.5259s
	iters: 300, epoch: 13 | loss: 0.0234825
	speed: 0.5159s/iter; left time: 4201.0423s
	iters: 400, epoch: 13 | loss: 0.1002289
	speed: 0.5349s/iter; left time: 4302.5361s
Epoch: 13 cost time: 253.1638662815094
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0130703
	speed: 1.5894s/iter; left time: 12514.7574s
	iters: 200, epoch: 14 | loss: 0.0487980
	speed: 0.5382s/iter; left time: 4183.8725s
	iters: 300, epoch: 14 | loss: 0.0103088
	speed: 0.5204s/iter; left time: 3993.7998s
	iters: 400, epoch: 14 | loss: 0.0717034
	speed: 0.5546s/iter; left time: 4200.8823s
Epoch: 14 cost time: 256.3296959400177
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.981989 --> -0.983990).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0044248
	speed: 1.5732s/iter; left time: 11649.7552s
	iters: 200, epoch: 15 | loss: 0.0815167
	speed: 0.5299s/iter; left time: 3871.0616s
	iters: 300, epoch: 15 | loss: 0.0059439
	speed: 0.5549s/iter; left time: 3997.8129s
	iters: 400, epoch: 15 | loss: 0.0110135
	speed: 0.5717s/iter; left time: 4061.7119s
Epoch: 15 cost time: 257.8968641757965
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0914790
	speed: 1.5807s/iter; left time: 10963.5062s
	iters: 200, epoch: 16 | loss: 0.0444170
	speed: 0.5368s/iter; left time: 3669.6014s
	iters: 300, epoch: 16 | loss: 0.0014725
	speed: 0.5067s/iter; left time: 3413.1933s
	iters: 400, epoch: 16 | loss: 0.0016774
	speed: 0.5180s/iter; left time: 3437.6436s
Epoch: 16 cost time: 246.10116839408875
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0128404
	speed: 1.4009s/iter; left time: 9059.5856s
	iters: 200, epoch: 17 | loss: 0.0063722
	speed: 0.5098s/iter; left time: 3245.8657s
	iters: 300, epoch: 17 | loss: 0.1151200
	speed: 0.4967s/iter; left time: 3112.5069s
	iters: 400, epoch: 17 | loss: 0.0014634
	speed: 0.4672s/iter; left time: 2881.3900s
Epoch: 17 cost time: 227.91989064216614
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0008707
	speed: 1.3151s/iter; left time: 7887.9894s
	iters: 200, epoch: 18 | loss: 0.0125674
	speed: 0.4809s/iter; left time: 2836.0755s
	iters: 300, epoch: 18 | loss: 0.0033639
	speed: 0.5269s/iter; left time: 3054.9247s
	iters: 400, epoch: 18 | loss: 0.0011618
	speed: 0.5018s/iter; left time: 2858.9793s
Epoch: 18 cost time: 230.27051377296448
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0511944
	speed: 1.4543s/iter; left time: 8040.5827s
	iters: 200, epoch: 19 | loss: 0.0004439
	speed: 0.4716s/iter; left time: 2560.2616s
	iters: 300, epoch: 19 | loss: 0.0059220
	speed: 0.5635s/iter; left time: 3002.8707s
	iters: 400, epoch: 19 | loss: 0.0529417
	speed: 0.5474s/iter; left time: 2862.4464s
Epoch: 19 cost time: 247.14418816566467
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2687842
	speed: 1.5766s/iter; left time: 7977.8467s
	iters: 200, epoch: 20 | loss: 0.0081458
	speed: 0.5379s/iter; left time: 2668.0705s
	iters: 300, epoch: 20 | loss: 0.0012878
	speed: 0.5473s/iter; left time: 2659.9020s
	iters: 400, epoch: 20 | loss: 0.0254905
	speed: 0.5632s/iter; left time: 2680.7997s
Epoch: 20 cost time: 260.46962881088257
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0321667
	speed: 1.6958s/iter; left time: 7785.5627s
	iters: 200, epoch: 21 | loss: 0.0069242
	speed: 0.5403s/iter; left time: 2426.5879s
	iters: 300, epoch: 21 | loss: 0.0011051
	speed: 0.5569s/iter; left time: 2445.5556s
	iters: 400, epoch: 21 | loss: 0.0006283
	speed: 0.5570s/iter; left time: 2390.1143s
Epoch: 21 cost time: 259.5909311771393
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0014910
	speed: 1.6329s/iter; left time: 6730.6831s
	iters: 200, epoch: 22 | loss: 0.0004572
	speed: 0.5730s/iter; left time: 2304.6066s
	iters: 300, epoch: 22 | loss: 0.0040552
	speed: 0.5558s/iter; left time: 2179.8859s
	iters: 400, epoch: 22 | loss: 0.0082637
	speed: 0.5462s/iter; left time: 2087.4644s
Epoch: 22 cost time: 261.5871729850769
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1704854
	speed: 1.6082s/iter; left time: 5874.5842s
	iters: 200, epoch: 23 | loss: 0.0092066
	speed: 0.5935s/iter; left time: 2108.8310s
	iters: 300, epoch: 23 | loss: 0.0046250
	speed: 0.5834s/iter; left time: 2014.5083s
	iters: 400, epoch: 23 | loss: 0.0105772
	speed: 0.5702s/iter; left time: 1911.8587s
Epoch: 23 cost time: 273.98188495635986
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0026590
	speed: 1.6439s/iter; left time: 5234.1894s
	iters: 200, epoch: 24 | loss: 0.4944689
	speed: 0.5851s/iter; left time: 1804.4409s
	iters: 300, epoch: 24 | loss: 0.0043250
	speed: 0.5783s/iter; left time: 1725.7735s
	iters: 400, epoch: 24 | loss: 0.0024529
	speed: 0.5213s/iter; left time: 1503.3510s
Epoch: 24 cost time: 257.116005897522
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 87146
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9477831
	speed: 0.4250s/iter; left time: 5937.8683s
	iters: 200, epoch: 1 | loss: 1.6428721
	speed: 0.4127s/iter; left time: 5724.2464s
	iters: 300, epoch: 1 | loss: 1.0896178
	speed: 0.4132s/iter; left time: 5690.2154s
	iters: 400, epoch: 1 | loss: 0.9637960
	speed: 0.3845s/iter; left time: 5256.3483s
Epoch: 1 cost time: 192.20060420036316
Epoch: 1, Steps: 469 | Train Loss: 1.488 Vali Loss: 0.667 Vali Acc: 0.851 Test Loss: 0.667 Test Acc: 0.851
Validation loss decreased (inf --> -0.851051).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5451939
	speed: 1.2883s/iter; left time: 17395.2844s
	iters: 200, epoch: 2 | loss: 0.5525256
	speed: 0.4470s/iter; left time: 5990.3099s
	iters: 300, epoch: 2 | loss: 0.2735158
	speed: 0.4294s/iter; left time: 5711.7116s
	iters: 400, epoch: 2 | loss: 0.2100265
	speed: 0.4597s/iter; left time: 6068.8295s
Epoch: 2 cost time: 207.4347538948059
Epoch: 2, Steps: 469 | Train Loss: 0.380 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.851051 --> -0.921667).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1298667
	speed: 1.3642s/iter; left time: 17779.7654s
	iters: 200, epoch: 3 | loss: 0.2691863
	speed: 0.4384s/iter; left time: 5670.0017s
	iters: 300, epoch: 3 | loss: 0.1230855
	speed: 0.4618s/iter; left time: 5926.5749s
	iters: 400, epoch: 3 | loss: 0.0886000
	speed: 0.4729s/iter; left time: 6021.0937s
Epoch: 3 cost time: 215.91873860359192
Epoch: 3, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.921667 --> -0.962263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0255113
	speed: 1.3972s/iter; left time: 17554.1132s
	iters: 200, epoch: 4 | loss: 0.1070255
	speed: 0.4612s/iter; left time: 5748.2473s
	iters: 300, epoch: 4 | loss: 0.0748564
	speed: 0.4485s/iter; left time: 5544.9348s
	iters: 400, epoch: 4 | loss: 0.0379923
	speed: 0.4712s/iter; left time: 5778.2973s
Epoch: 4 cost time: 215.77002263069153
Epoch: 4, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.962263 --> -0.969696).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1234043
	speed: 1.3586s/iter; left time: 16432.2690s
	iters: 200, epoch: 5 | loss: 0.0209314
	speed: 0.3926s/iter; left time: 4709.0694s
	iters: 300, epoch: 5 | loss: 0.0136431
	speed: 0.3755s/iter; left time: 4467.0842s
	iters: 400, epoch: 5 | loss: 0.0444876
	speed: 0.3742s/iter; left time: 4413.6147s
Epoch: 5 cost time: 183.2250792980194
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0275757
	speed: 1.2191s/iter; left time: 14173.3285s
	iters: 200, epoch: 6 | loss: 0.1678174
	speed: 0.4251s/iter; left time: 4899.9894s
	iters: 300, epoch: 6 | loss: 0.0101100
	speed: 0.4017s/iter; left time: 4590.3054s
	iters: 400, epoch: 6 | loss: 0.0134943
	speed: 0.4283s/iter; left time: 4850.7763s
Epoch: 6 cost time: 197.4115161895752
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.969696 --> -0.977129).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0136901
	speed: 1.3603s/iter; left time: 15176.9038s
	iters: 200, epoch: 7 | loss: 0.0079158
	speed: 0.5031s/iter; left time: 5562.3550s
	iters: 300, epoch: 7 | loss: 0.0115456
	speed: 0.4984s/iter; left time: 5460.4412s
	iters: 400, epoch: 7 | loss: 0.0165091
	speed: 0.4987s/iter; left time: 5414.6634s
Epoch: 7 cost time: 231.1809844970703
Epoch: 7, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0255951
	speed: 1.4710s/iter; left time: 15721.7004s
	iters: 200, epoch: 8 | loss: 0.0300898
	speed: 0.4992s/iter; left time: 5285.9324s
	iters: 300, epoch: 8 | loss: 0.0043691
	speed: 0.5105s/iter; left time: 5354.5222s
	iters: 400, epoch: 8 | loss: 0.0043492
	speed: 0.5154s/iter; left time: 5354.0184s
Epoch: 8 cost time: 236.798086643219
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0028231
	speed: 1.4142s/iter; left time: 14451.7362s
	iters: 200, epoch: 9 | loss: 0.0309691
	speed: 0.4504s/iter; left time: 4557.6010s
	iters: 300, epoch: 9 | loss: 0.0098162
	speed: 0.4560s/iter; left time: 4568.6170s
	iters: 400, epoch: 9 | loss: 0.0354724
	speed: 0.4602s/iter; left time: 4564.6520s
Epoch: 9 cost time: 208.19906449317932
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979702).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0203720
	speed: 1.3183s/iter; left time: 12853.0039s
	iters: 200, epoch: 10 | loss: 0.0147227
	speed: 0.4185s/iter; left time: 4038.9496s
	iters: 300, epoch: 10 | loss: 0.0362766
	speed: 0.4662s/iter; left time: 4452.6236s
	iters: 400, epoch: 10 | loss: 0.0095170
	speed: 0.4812s/iter; left time: 4547.8106s
Epoch: 10 cost time: 211.88807725906372
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0039534
	speed: 1.3815s/iter; left time: 12822.0648s
	iters: 200, epoch: 11 | loss: 0.0142602
	speed: 0.4774s/iter; left time: 4383.2456s
	iters: 300, epoch: 11 | loss: 0.0026777
	speed: 0.3524s/iter; left time: 3200.5240s
	iters: 400, epoch: 11 | loss: 0.0038369
	speed: 0.3828s/iter; left time: 3438.2290s
Epoch: 11 cost time: 193.53469848632812
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0410476
	speed: 1.1061s/iter; left time: 9747.1399s
	iters: 200, epoch: 12 | loss: 0.0235311
	speed: 0.3403s/iter; left time: 2965.0313s
	iters: 300, epoch: 12 | loss: 0.0057749
	speed: 0.3646s/iter; left time: 3140.0584s
	iters: 400, epoch: 12 | loss: 0.0181293
	speed: 0.3711s/iter; left time: 3158.4795s
Epoch: 12 cost time: 167.04022359848022
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0020137
	speed: 1.1735s/iter; left time: 9790.1835s
	iters: 200, epoch: 13 | loss: 0.0037220
	speed: 0.4102s/iter; left time: 3381.5679s
	iters: 300, epoch: 13 | loss: 0.0021336
	speed: 0.4370s/iter; left time: 3558.8840s
	iters: 400, epoch: 13 | loss: 0.0173754
	speed: 0.4285s/iter; left time: 3446.6278s
Epoch: 13 cost time: 202.08648705482483
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0267429
	speed: 1.3161s/iter; left time: 10363.3132s
	iters: 200, epoch: 14 | loss: 0.0262495
	speed: 0.4294s/iter; left time: 3338.2675s
	iters: 300, epoch: 14 | loss: 0.1598784
	speed: 0.4583s/iter; left time: 3516.6883s
	iters: 400, epoch: 14 | loss: 0.0447685
	speed: 0.4383s/iter; left time: 3319.5210s
Epoch: 14 cost time: 204.26534605026245
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0073929
	speed: 1.2979s/iter; left time: 9611.0992s
	iters: 200, epoch: 15 | loss: 0.0084957
	speed: 0.4147s/iter; left time: 3029.3160s
	iters: 300, epoch: 15 | loss: 0.1539974
	speed: 0.3632s/iter; left time: 2617.0166s
	iters: 400, epoch: 15 | loss: 0.0042551
	speed: 0.3918s/iter; left time: 2783.8898s
Epoch: 15 cost time: 188.32721734046936
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0023249
	speed: 1.1566s/iter; left time: 8022.0971s
	iters: 200, epoch: 16 | loss: 0.0041281
	speed: 0.3938s/iter; left time: 2692.3321s
	iters: 300, epoch: 16 | loss: 0.0226358
	speed: 0.3717s/iter; left time: 2503.8290s
	iters: 400, epoch: 16 | loss: 0.1592752
	speed: 0.2974s/iter; left time: 1973.8258s
Epoch: 16 cost time: 168.9094660282135
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.980274).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0007282
	speed: 1.0763s/iter; left time: 6960.4658s
	iters: 200, epoch: 17 | loss: 0.0009551
	speed: 0.3544s/iter; left time: 2256.6460s
	iters: 300, epoch: 17 | loss: 0.0019516
	speed: 0.3722s/iter; left time: 2332.3844s
	iters: 400, epoch: 17 | loss: 0.0023214
	speed: 0.3514s/iter; left time: 2167.3328s
Epoch: 17 cost time: 165.70358085632324
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0021304
	speed: 1.0733s/iter; left time: 6437.7612s
	iters: 200, epoch: 18 | loss: 0.0023562
	speed: 0.2310s/iter; left time: 1362.3083s
	iters: 300, epoch: 18 | loss: 0.0005269
	speed: 0.3166s/iter; left time: 1835.7117s
	iters: 400, epoch: 18 | loss: 0.0525502
	speed: 0.3435s/iter; left time: 1957.3242s
Epoch: 18 cost time: 149.94990611076355
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981703).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0085077
	speed: 0.9819s/iter; left time: 5428.7426s
	iters: 200, epoch: 19 | loss: 0.0136284
	speed: 0.3427s/iter; left time: 1860.7821s
	iters: 300, epoch: 19 | loss: 0.0063305
	speed: 0.3404s/iter; left time: 1814.0928s
	iters: 400, epoch: 19 | loss: 0.0007058
	speed: 0.3787s/iter; left time: 1980.1827s
Epoch: 19 cost time: 167.68336653709412
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1258253
	speed: 1.2127s/iter; left time: 6136.4275s
	iters: 200, epoch: 20 | loss: 0.0005235
	speed: 0.4101s/iter; left time: 2033.9572s
	iters: 300, epoch: 20 | loss: 0.0640288
	speed: 0.4396s/iter; left time: 2136.5117s
	iters: 400, epoch: 20 | loss: 0.0055278
	speed: 0.4364s/iter; left time: 2077.1869s
Epoch: 20 cost time: 197.25707936286926
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0148244
	speed: 1.3401s/iter; left time: 6152.4761s
	iters: 200, epoch: 21 | loss: 0.4091021
	speed: 0.4099s/iter; left time: 1841.0012s
	iters: 300, epoch: 21 | loss: 0.0059041
	speed: 0.4300s/iter; left time: 1887.9998s
	iters: 400, epoch: 21 | loss: 0.0166180
	speed: 0.4313s/iter; left time: 1850.8272s
Epoch: 21 cost time: 197.86481618881226
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0010368
	speed: 1.2889s/iter; left time: 5313.0404s
	iters: 200, epoch: 22 | loss: 0.0032946
	speed: 0.4166s/iter; left time: 1675.6200s
	iters: 300, epoch: 22 | loss: 0.0045723
	speed: 0.3995s/iter; left time: 1566.7435s
	iters: 400, epoch: 22 | loss: 0.0024682
	speed: 0.4502s/iter; left time: 1720.5698s
Epoch: 22 cost time: 200.60877227783203
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0043020
	speed: 1.2421s/iter; left time: 4537.4773s
	iters: 200, epoch: 23 | loss: 0.0109606
	speed: 0.4189s/iter; left time: 1488.3305s
	iters: 300, epoch: 23 | loss: 0.0036411
	speed: 0.3946s/iter; left time: 1362.6698s
	iters: 400, epoch: 23 | loss: 0.0028978
	speed: 0.3942s/iter; left time: 1321.7110s
Epoch: 23 cost time: 187.6301953792572
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0102167
	speed: 1.2153s/iter; left time: 3869.4958s
	iters: 200, epoch: 24 | loss: 0.0011296
	speed: 0.3781s/iter; left time: 1166.0204s
	iters: 300, epoch: 24 | loss: 0.0020661
	speed: 0.3807s/iter; left time: 1135.8923s
	iters: 400, epoch: 24 | loss: 0.0026869
	speed: 0.3531s/iter; left time: 1018.4714s
Epoch: 24 cost time: 176.0006377696991
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0063253
	speed: 1.1376s/iter; left time: 3088.5763s
	iters: 200, epoch: 25 | loss: 0.0051636
	speed: 0.3388s/iter; left time: 885.8952s
	iters: 300, epoch: 25 | loss: 0.0548598
	speed: 0.4136s/iter; left time: 1040.2388s
	iters: 400, epoch: 25 | loss: 0.0015057
	speed: 0.3936s/iter; left time: 950.5128s
Epoch: 25 cost time: 173.49850940704346
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0019582
	speed: 1.2169s/iter; left time: 2733.0941s
	iters: 200, epoch: 26 | loss: 0.0026316
	speed: 0.3942s/iter; left time: 846.0104s
	iters: 300, epoch: 26 | loss: 0.0054426
	speed: 0.4019s/iter; left time: 822.2161s
	iters: 400, epoch: 26 | loss: 0.0010625
	speed: 0.3995s/iter; left time: 777.3447s
Epoch: 26 cost time: 193.96341824531555
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0008882
	speed: 1.4219s/iter; left time: 2526.7724s
	iters: 200, epoch: 27 | loss: 0.0026653
	speed: 0.4654s/iter; left time: 780.5289s
	iters: 300, epoch: 27 | loss: 0.0143403
	speed: 0.4710s/iter; left time: 742.7913s
	iters: 400, epoch: 27 | loss: 0.0005631
	speed: 0.4608s/iter; left time: 680.5418s
Epoch: 27 cost time: 215.1187183856964
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.981703 --> -0.984848).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0060213
	speed: 1.3254s/iter; left time: 1733.5601s
	iters: 200, epoch: 28 | loss: 0.2593623
	speed: 0.4435s/iter; left time: 535.8027s
	iters: 300, epoch: 28 | loss: 0.0044687
	speed: 0.4392s/iter; left time: 486.6608s
	iters: 400, epoch: 28 | loss: 0.0000755
	speed: 0.4438s/iter; left time: 447.3253s
Epoch: 28 cost time: 205.83858609199524
Epoch: 28, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0012053
	speed: 1.3609s/iter; left time: 1141.8287s
	iters: 200, epoch: 29 | loss: 0.0063510
	speed: 0.4555s/iter; left time: 336.6405s
	iters: 300, epoch: 29 | loss: 0.0003699
	speed: 0.4459s/iter; left time: 284.9053s
	iters: 400, epoch: 29 | loss: 0.0161536
	speed: 0.4534s/iter; left time: 244.4068s
Epoch: 29 cost time: 208.4691677093506
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0009329
	speed: 1.2637s/iter; left time: 467.5827s
	iters: 200, epoch: 30 | loss: 0.0039119
	speed: 0.4184s/iter; left time: 112.9604s
	iters: 300, epoch: 30 | loss: 0.0005562
	speed: 0.4206s/iter; left time: 71.5054s
	iters: 400, epoch: 30 | loss: 0.0024089
	speed: 0.3914s/iter; left time: 27.4004s
Epoch: 30 cost time: 191.4729516506195
Epoch: 30, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 294186
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0348301
	speed: 0.2862s/iter; left time: 3998.0303s
	iters: 200, epoch: 1 | loss: 1.7697198
	speed: 0.2755s/iter; left time: 3820.9613s
	iters: 300, epoch: 1 | loss: 1.4792972
	speed: 0.2673s/iter; left time: 3680.7161s
	iters: 400, epoch: 1 | loss: 1.2952162
	speed: 0.2591s/iter; left time: 3542.3802s
Epoch: 1 cost time: 128.87148070335388
Epoch: 1, Steps: 469 | Train Loss: 1.604 Vali Loss: 0.810 Vali Acc: 0.795 Test Loss: 0.810 Test Acc: 0.795
Validation loss decreased (inf --> -0.795018).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6038700
	speed: 0.9259s/iter; left time: 12501.5709s
	iters: 200, epoch: 2 | loss: 0.4524665
	speed: 0.2670s/iter; left time: 3578.4575s
	iters: 300, epoch: 2 | loss: 0.3620366
	speed: 0.2659s/iter; left time: 3536.9579s
	iters: 400, epoch: 2 | loss: 0.3716286
	speed: 0.2750s/iter; left time: 3630.2951s
Epoch: 2 cost time: 128.39943671226501
Epoch: 2, Steps: 469 | Train Loss: 0.500 Vali Loss: 0.307 Vali Acc: 0.911 Test Loss: 0.307 Test Acc: 0.911
Validation loss decreased (-0.795018 --> -0.910517).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2806658
	speed: 0.9946s/iter; left time: 12962.4545s
	iters: 200, epoch: 3 | loss: 0.1297365
	speed: 0.2560s/iter; left time: 3311.1156s
	iters: 300, epoch: 3 | loss: 0.3079275
	speed: 0.2622s/iter; left time: 3365.4209s
	iters: 400, epoch: 3 | loss: 0.0848946
	speed: 0.2709s/iter; left time: 3449.9550s
Epoch: 3 cost time: 125.7808473110199
Epoch: 3, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.910517 --> -0.947683).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0793430
	speed: 0.9546s/iter; left time: 11994.0561s
	iters: 200, epoch: 4 | loss: 0.1434696
	speed: 0.2564s/iter; left time: 3196.1515s
	iters: 300, epoch: 4 | loss: 0.1718446
	speed: 0.3046s/iter; left time: 3766.3762s
	iters: 400, epoch: 4 | loss: 0.1021181
	speed: 0.2631s/iter; left time: 3226.3899s
Epoch: 4 cost time: 128.37763571739197
Epoch: 4, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
Validation loss decreased (-0.947683 --> -0.960548).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0785620
	speed: 0.9264s/iter; left time: 11204.9620s
	iters: 200, epoch: 5 | loss: 0.0220381
	speed: 0.2629s/iter; left time: 3152.9954s
	iters: 300, epoch: 5 | loss: 0.0692937
	speed: 0.2673s/iter; left time: 3179.3279s
	iters: 400, epoch: 5 | loss: 0.0227022
	speed: 0.2626s/iter; left time: 3097.6300s
Epoch: 5 cost time: 122.62172770500183
Epoch: 5, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.960548 --> -0.965122).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0256686
	speed: 0.9426s/iter; left time: 10958.6995s
	iters: 200, epoch: 6 | loss: 0.0369184
	speed: 0.2619s/iter; left time: 3018.9479s
	iters: 300, epoch: 6 | loss: 0.2587492
	speed: 0.3216s/iter; left time: 3674.4002s
	iters: 400, epoch: 6 | loss: 0.0273176
	speed: 0.3109s/iter; left time: 3520.9244s
Epoch: 6 cost time: 136.94114208221436
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.965122 --> -0.968552).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0656669
	speed: 1.0320s/iter; left time: 11514.0827s
	iters: 200, epoch: 7 | loss: 0.0514823
	speed: 0.2959s/iter; left time: 3272.2785s
	iters: 300, epoch: 7 | loss: 0.2309787
	speed: 0.2975s/iter; left time: 3259.2824s
	iters: 400, epoch: 7 | loss: 0.0059487
	speed: 0.2993s/iter; left time: 3249.4417s
Epoch: 7 cost time: 139.3531789779663
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.125 Vali Acc: 0.963 Test Loss: 0.125 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1002694
	speed: 1.0553s/iter; left time: 11279.5394s
	iters: 200, epoch: 8 | loss: 0.1015157
	speed: 0.3142s/iter; left time: 3326.8369s
	iters: 300, epoch: 8 | loss: 0.0651653
	speed: 0.3105s/iter; left time: 3256.0291s
	iters: 400, epoch: 8 | loss: 0.1240799
	speed: 0.3048s/iter; left time: 3166.6791s
Epoch: 8 cost time: 145.18003964424133
Epoch: 8, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.968552 --> -0.973127).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0093815
	speed: 1.0500s/iter; left time: 10729.7004s
	iters: 200, epoch: 9 | loss: 0.0292397
	speed: 0.2926s/iter; left time: 2961.1138s
	iters: 300, epoch: 9 | loss: 0.0702891
	speed: 0.2891s/iter; left time: 2896.0362s
	iters: 400, epoch: 9 | loss: 0.0085868
	speed: 0.2938s/iter; left time: 2914.6885s
Epoch: 9 cost time: 134.99153399467468
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.973127 --> -0.977129).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1263162
	speed: 0.9613s/iter; left time: 9372.7989s
	iters: 200, epoch: 10 | loss: 0.0041210
	speed: 0.2822s/iter; left time: 2722.8744s
	iters: 300, epoch: 10 | loss: 0.0870698
	speed: 0.2814s/iter; left time: 2686.9364s
	iters: 400, epoch: 10 | loss: 0.0214638
	speed: 0.2837s/iter; left time: 2680.5556s
Epoch: 10 cost time: 131.72660636901855
Epoch: 10, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0632871
	speed: 0.9955s/iter; left time: 9239.5623s
	iters: 200, epoch: 11 | loss: 0.0261318
	speed: 0.2884s/iter; left time: 2647.7249s
	iters: 300, epoch: 11 | loss: 0.0104114
	speed: 0.2612s/iter; left time: 2372.2648s
	iters: 400, epoch: 11 | loss: 0.0282736
	speed: 0.2569s/iter; left time: 2307.5502s
Epoch: 11 cost time: 127.57953906059265
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977129).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1102802
	speed: 1.0307s/iter; left time: 9082.8680s
	iters: 200, epoch: 12 | loss: 0.0062868
	speed: 0.2769s/iter; left time: 2412.5425s
	iters: 300, epoch: 12 | loss: 0.0098016
	speed: 0.2828s/iter; left time: 2435.6725s
	iters: 400, epoch: 12 | loss: 0.0102654
	speed: 0.2712s/iter; left time: 2308.5128s
Epoch: 12 cost time: 133.22465300559998
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0155613
	speed: 0.9899s/iter; left time: 8258.7349s
	iters: 200, epoch: 13 | loss: 0.0109811
	speed: 0.2686s/iter; left time: 2214.4311s
	iters: 300, epoch: 13 | loss: 0.1171917
	speed: 0.3102s/iter; left time: 2526.3533s
	iters: 400, epoch: 13 | loss: 0.0740470
	speed: 0.3083s/iter; left time: 2479.6683s
Epoch: 13 cost time: 139.3537142276764
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977987).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0296607
	speed: 1.1167s/iter; left time: 8792.8658s
	iters: 200, epoch: 14 | loss: 0.0049905
	speed: 0.3528s/iter; left time: 2742.9934s
	iters: 300, epoch: 14 | loss: 0.0327928
	speed: 0.3241s/iter; left time: 2486.7745s
	iters: 400, epoch: 14 | loss: 0.0191150
	speed: 0.3540s/iter; left time: 2680.8531s
Epoch: 14 cost time: 158.657452583313
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0032041
	speed: 1.1996s/iter; left time: 8883.3397s
	iters: 200, epoch: 15 | loss: 0.1620606
	speed: 0.3389s/iter; left time: 2475.3575s
	iters: 300, epoch: 15 | loss: 0.0082892
	speed: 0.3177s/iter; left time: 2288.8419s
	iters: 400, epoch: 15 | loss: 0.0072022
	speed: 0.3114s/iter; left time: 2212.5472s
Epoch: 15 cost time: 154.19797587394714
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.977987 --> -0.979988).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0147260
	speed: 1.1334s/iter; left time: 7861.4133s
	iters: 200, epoch: 16 | loss: 0.0125442
	speed: 0.3097s/iter; left time: 2117.1717s
	iters: 300, epoch: 16 | loss: 0.0049932
	speed: 0.3143s/iter; left time: 2117.3790s
	iters: 400, epoch: 16 | loss: 0.0010923
	speed: 0.3141s/iter; left time: 2084.3631s
Epoch: 16 cost time: 145.98391270637512
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1369690
	speed: 1.1136s/iter; left time: 7201.4413s
	iters: 200, epoch: 17 | loss: 0.0050192
	speed: 0.3366s/iter; left time: 2143.2749s
	iters: 300, epoch: 17 | loss: 0.1003394
	speed: 0.3074s/iter; left time: 1926.3567s
	iters: 400, epoch: 17 | loss: 0.0022800
	speed: 0.2852s/iter; left time: 1758.9676s
Epoch: 17 cost time: 143.49402379989624
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0011273
	speed: 1.0293s/iter; left time: 6173.7131s
	iters: 200, epoch: 18 | loss: 0.0086166
	speed: 0.2803s/iter; left time: 1653.1315s
	iters: 300, epoch: 18 | loss: 0.0053930
	speed: 0.2516s/iter; left time: 1458.8478s
	iters: 400, epoch: 18 | loss: 0.0287533
	speed: 0.2506s/iter; left time: 1427.9989s
Epoch: 18 cost time: 125.51775121688843
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0020511
	speed: 0.9020s/iter; left time: 4987.2047s
	iters: 200, epoch: 19 | loss: 0.0048165
	speed: 0.2536s/iter; left time: 1376.8616s
	iters: 300, epoch: 19 | loss: 0.0372887
	speed: 0.2603s/iter; left time: 1387.1632s
	iters: 400, epoch: 19 | loss: 0.0091424
	speed: 0.2533s/iter; left time: 1324.6398s
Epoch: 19 cost time: 117.62870788574219
Epoch: 19, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0061258
	speed: 0.8970s/iter; left time: 4539.0106s
	iters: 200, epoch: 20 | loss: 0.0028300
	speed: 0.2662s/iter; left time: 1320.4439s
	iters: 300, epoch: 20 | loss: 0.0048204
	speed: 0.2639s/iter; left time: 1282.6667s
	iters: 400, epoch: 20 | loss: 0.0224932
	speed: 0.2569s/iter; left time: 1222.6881s
Epoch: 20 cost time: 124.09181070327759
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980560).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0025619
	speed: 0.9244s/iter; left time: 4244.0829s
	iters: 200, epoch: 21 | loss: 0.0792954
	speed: 0.2487s/iter; left time: 1116.8351s
	iters: 300, epoch: 21 | loss: 0.0009254
	speed: 0.2384s/iter; left time: 1046.9448s
	iters: 400, epoch: 21 | loss: 0.0020095
	speed: 0.2634s/iter; left time: 1130.2181s
Epoch: 21 cost time: 117.56581473350525
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.980560 --> -0.980560).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0031051
	speed: 0.8596s/iter; left time: 3543.2728s
	iters: 200, epoch: 22 | loss: 0.0003333
	speed: 0.2365s/iter; left time: 951.3882s
	iters: 300, epoch: 22 | loss: 0.0030881
	speed: 0.2645s/iter; left time: 1037.2732s
	iters: 400, epoch: 22 | loss: 0.0286386
	speed: 0.2646s/iter; left time: 1011.2891s
Epoch: 22 cost time: 117.61101460456848
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2645506
	speed: 0.9135s/iter; left time: 3336.8539s
	iters: 200, epoch: 23 | loss: 0.0307560
	speed: 0.2724s/iter; left time: 967.9796s
	iters: 300, epoch: 23 | loss: 0.0058235
	speed: 0.3142s/iter; left time: 1085.0836s
	iters: 400, epoch: 23 | loss: 0.0118884
	speed: 0.3025s/iter; left time: 1014.3159s
Epoch: 23 cost time: 136.4436960220337
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0014131
	speed: 1.0360s/iter; left time: 3298.6541s
	iters: 200, epoch: 24 | loss: 0.4463579
	speed: 0.2725s/iter; left time: 840.2431s
	iters: 300, epoch: 24 | loss: 0.0033206
	speed: 0.2810s/iter; left time: 838.3952s
	iters: 400, epoch: 24 | loss: 0.0182452
	speed: 0.2828s/iter; left time: 815.6176s
Epoch: 24 cost time: 130.99460077285767
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.980560 --> -0.984276).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0015092
	speed: 1.0289s/iter; left time: 2793.3949s
	iters: 200, epoch: 25 | loss: 0.1133584
	speed: 0.2845s/iter; left time: 743.8661s
	iters: 300, epoch: 25 | loss: 0.0102134
	speed: 0.3054s/iter; left time: 768.0784s
	iters: 400, epoch: 25 | loss: 0.0025783
	speed: 0.3201s/iter; left time: 773.0606s
Epoch: 25 cost time: 142.4073247909546
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0010060
	speed: 1.1103s/iter; left time: 2493.7040s
	iters: 200, epoch: 26 | loss: 0.0023066
	speed: 0.3235s/iter; left time: 694.2249s
	iters: 300, epoch: 26 | loss: 0.0014986
	speed: 0.3055s/iter; left time: 624.9709s
	iters: 400, epoch: 26 | loss: 0.2726160
	speed: 0.3185s/iter; left time: 619.8746s
Epoch: 26 cost time: 148.3905918598175
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1182873
	speed: 1.0579s/iter; left time: 1879.8758s
	iters: 200, epoch: 27 | loss: 0.0050822
	speed: 0.2761s/iter; left time: 462.9894s
	iters: 300, epoch: 27 | loss: 0.0314398
	speed: 0.2724s/iter; left time: 429.5053s
	iters: 400, epoch: 27 | loss: 0.0990557
	speed: 0.2615s/iter; left time: 386.2667s
Epoch: 27 cost time: 126.99899482727051
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0389391
	speed: 0.8677s/iter; left time: 1135.0050s
	iters: 200, epoch: 28 | loss: 0.0029338
	speed: 0.2513s/iter; left time: 303.5403s
	iters: 300, epoch: 28 | loss: 0.0112561
	speed: 0.2517s/iter; left time: 278.8965s
	iters: 400, epoch: 28 | loss: 0.3160079
	speed: 0.2551s/iter; left time: 257.1768s
Epoch: 28 cost time: 117.55551481246948
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0336576
	speed: 0.8942s/iter; left time: 750.1978s
	iters: 200, epoch: 29 | loss: 0.0048505
	speed: 0.2536s/iter; left time: 187.4032s
	iters: 300, epoch: 29 | loss: 0.0046032
	speed: 0.2512s/iter; left time: 160.5048s
	iters: 400, epoch: 29 | loss: 0.0032174
	speed: 0.2432s/iter; left time: 131.0739s
Epoch: 29 cost time: 117.40516066551208
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0015320
	speed: 0.9293s/iter; left time: 343.8546s
	iters: 200, epoch: 30 | loss: 0.0020571
	speed: 0.2634s/iter; left time: 71.1172s
	iters: 300, epoch: 30 | loss: 0.0102325
	speed: 0.2755s/iter; left time: 46.8405s
	iters: 400, epoch: 30 | loss: 0.0040481
	speed: 0.2907s/iter; left time: 20.3516s
Epoch: 30 cost time: 129.23315477371216
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 87146
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4553232
	speed: 1.2464s/iter; left time: 17413.7664s
	iters: 200, epoch: 1 | loss: 0.0406643
	speed: 1.1966s/iter; left time: 16598.5746s
	iters: 300, epoch: 1 | loss: 0.0313260
	speed: 1.1724s/iter; left time: 16145.5671s
	iters: 400, epoch: 1 | loss: 0.0260158
	speed: 1.1526s/iter; left time: 15756.5336s
Epoch: 1 cost time: 559.3044762611389
Epoch: 1, Steps: 469 | Train Loss: 0.310 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (inf --> -0.953400).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0743193
	speed: 3.5867s/iter; left time: 48427.5017s
	iters: 200, epoch: 2 | loss: 0.0144446
	speed: 1.1027s/iter; left time: 14779.0463s
	iters: 300, epoch: 2 | loss: 0.0763091
	speed: 1.1069s/iter; left time: 14723.8841s
	iters: 400, epoch: 2 | loss: 0.1741661
	speed: 1.0313s/iter; left time: 13615.4076s
Epoch: 2 cost time: 507.952032327652
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.953400 --> -0.962835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0241723
	speed: 3.2826s/iter; left time: 42781.7543s
	iters: 200, epoch: 3 | loss: 0.0070543
	speed: 1.2142s/iter; left time: 15703.5602s
	iters: 300, epoch: 3 | loss: 0.0967211
	speed: 1.2536s/iter; left time: 16087.0360s
	iters: 400, epoch: 3 | loss: 0.0006750
	speed: 1.2056s/iter; left time: 15350.3655s
Epoch: 3 cost time: 571.726567029953
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.962835 --> -0.963978).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0183640
	speed: 3.7293s/iter; left time: 46854.9866s
	iters: 200, epoch: 4 | loss: 0.0880764
	speed: 1.1475s/iter; left time: 14302.5906s
	iters: 300, epoch: 4 | loss: 0.0046921
	speed: 1.1529s/iter; left time: 14254.8871s
	iters: 400, epoch: 4 | loss: 0.0301758
	speed: 1.1497s/iter; left time: 14100.2345s
Epoch: 4 cost time: 540.5796225070953
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.963978 --> -0.972841).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0186628
	speed: 3.5291s/iter; left time: 42683.9871s
	iters: 200, epoch: 5 | loss: 0.0014585
	speed: 1.2464s/iter; left time: 14950.5775s
	iters: 300, epoch: 5 | loss: 0.0080895
	speed: 1.2446s/iter; left time: 14804.5395s
	iters: 400, epoch: 5 | loss: 0.0041579
	speed: 1.1515s/iter; left time: 13581.9844s
Epoch: 5 cost time: 557.7054128646851
Epoch: 5, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4248162
	speed: 3.4293s/iter; left time: 39868.6507s
	iters: 200, epoch: 6 | loss: 0.0024145
	speed: 1.1784s/iter; left time: 13581.7521s
	iters: 300, epoch: 6 | loss: 0.0005785
	speed: 1.1802s/iter; left time: 13485.0210s
	iters: 400, epoch: 6 | loss: 0.3397338
	speed: 1.1849s/iter; left time: 13420.4617s
Epoch: 6 cost time: 546.1624891757965
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972841 --> -0.975699).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0165306
	speed: 3.4370s/iter; left time: 38346.1841s
	iters: 200, epoch: 7 | loss: 0.0003873
	speed: 1.0875s/iter; left time: 12024.5748s
	iters: 300, epoch: 7 | loss: 0.0020736
	speed: 1.1544s/iter; left time: 12648.7376s
	iters: 400, epoch: 7 | loss: 0.0009699
	speed: 1.1961s/iter; left time: 12985.7708s
Epoch: 7 cost time: 529.6494340896606
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0021664
	speed: 3.5148s/iter; left time: 37566.0923s
	iters: 200, epoch: 8 | loss: 0.0006719
	speed: 1.0813s/iter; left time: 11449.1303s
	iters: 300, epoch: 8 | loss: 0.0165772
	speed: 1.0100s/iter; left time: 10592.9067s
	iters: 400, epoch: 8 | loss: 0.0047548
	speed: 1.0042s/iter; left time: 10431.4272s
Epoch: 8 cost time: 492.22718262672424
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003220
	speed: 3.2736s/iter; left time: 33453.1266s
	iters: 200, epoch: 9 | loss: 0.4834093
	speed: 1.0378s/iter; left time: 10501.2928s
	iters: 300, epoch: 9 | loss: 0.0065556
	speed: 1.0245s/iter; left time: 10264.7270s
	iters: 400, epoch: 9 | loss: 0.0003252
	speed: 1.0286s/iter; left time: 10202.9146s
Epoch: 9 cost time: 486.2101800441742
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003752
	speed: 3.1117s/iter; left time: 30339.2868s
	iters: 200, epoch: 10 | loss: 0.0003018
	speed: 1.1221s/iter; left time: 10828.5519s
	iters: 300, epoch: 10 | loss: 0.0001644
	speed: 1.1514s/iter; left time: 10996.1254s
	iters: 400, epoch: 10 | loss: 0.0003728
	speed: 1.1496s/iter; left time: 10863.9934s
Epoch: 10 cost time: 523.7969560623169
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.975699 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0029743
	speed: 3.4202s/iter; left time: 31743.0024s
	iters: 200, epoch: 11 | loss: 0.0003221
	speed: 1.1532s/iter; left time: 10587.4965s
	iters: 300, epoch: 11 | loss: 0.0068075
	speed: 1.1304s/iter; left time: 10265.4006s
	iters: 400, epoch: 11 | loss: 0.0009340
	speed: 1.1242s/iter; left time: 10096.0016s
Epoch: 11 cost time: 526.7465455532074
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0009587
	speed: 3.3385s/iter; left time: 29418.5399s
	iters: 200, epoch: 12 | loss: 0.0006014
	speed: 1.0845s/iter; left time: 9448.0966s
	iters: 300, epoch: 12 | loss: 0.0024892
	speed: 1.0667s/iter; left time: 9186.2642s
	iters: 400, epoch: 12 | loss: 0.0005391
	speed: 1.0733s/iter; left time: 9135.6090s
Epoch: 12 cost time: 506.134085893631
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0001678
	speed: 3.2489s/iter; left time: 27105.7504s
	iters: 200, epoch: 13 | loss: 0.1521065
	speed: 1.0352s/iter; left time: 8533.5280s
	iters: 300, epoch: 13 | loss: 0.0013523
	speed: 1.0895s/iter; left time: 8871.9581s
	iters: 400, epoch: 13 | loss: 0.0030725
	speed: 1.1100s/iter; left time: 8927.9660s
Epoch: 13 cost time: 500.9103889465332
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002901
	speed: 3.3061s/iter; left time: 26031.9620s
	iters: 200, epoch: 14 | loss: 0.0001643
	speed: 0.9858s/iter; left time: 7663.8368s
	iters: 300, epoch: 14 | loss: 0.0004931
	speed: 0.9701s/iter; left time: 7444.2817s
	iters: 400, epoch: 14 | loss: 0.0003771
	speed: 0.9704s/iter; left time: 7349.9796s
Epoch: 14 cost time: 468.97420024871826
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0020929
	speed: 3.1109s/iter; left time: 23036.4069s
	iters: 200, epoch: 15 | loss: 0.0001105
	speed: 0.9998s/iter; left time: 7303.4663s
	iters: 300, epoch: 15 | loss: 0.0013627
	speed: 0.9309s/iter; left time: 6707.3235s
	iters: 400, epoch: 15 | loss: 0.0006335
	speed: 0.9386s/iter; left time: 6669.0052s
Epoch: 15 cost time: 454.8224391937256
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0253488
	speed: 3.0639s/iter; left time: 21251.0812s
	iters: 200, epoch: 16 | loss: 0.0003333
	speed: 1.1569s/iter; left time: 7908.4651s
	iters: 300, epoch: 16 | loss: 0.0090822
	speed: 1.2994s/iter; left time: 8753.0142s
	iters: 400, epoch: 16 | loss: 0.0007555
	speed: 1.2632s/iter; left time: 8382.5513s
Epoch: 16 cost time: 557.8280205726624
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0002916
	speed: 3.7263s/iter; left time: 24098.0827s
	iters: 200, epoch: 17 | loss: 0.0020310
	speed: 1.2599s/iter; left time: 8021.6806s
	iters: 300, epoch: 17 | loss: 0.0002025
	speed: 1.2807s/iter; left time: 8026.2471s
	iters: 400, epoch: 17 | loss: 0.0008489
	speed: 1.3263s/iter; left time: 8179.4510s
Epoch: 17 cost time: 605.8774971961975
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0001713
	speed: 3.9713s/iter; left time: 23820.1556s
	iters: 200, epoch: 18 | loss: 0.0031014
	speed: 1.2977s/iter; left time: 7653.7665s
	iters: 300, epoch: 18 | loss: 0.0002080
	speed: 1.3018s/iter; left time: 7547.6880s
	iters: 400, epoch: 18 | loss: 0.0002892
	speed: 1.3639s/iter; left time: 7771.6675s
Epoch: 18 cost time: 617.0171365737915
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0117208
	speed: 4.1220s/iter; left time: 22790.7834s
	iters: 200, epoch: 19 | loss: 0.0563928
	speed: 1.3203s/iter; left time: 7167.7422s
	iters: 300, epoch: 19 | loss: 0.0000436
	speed: 1.3050s/iter; left time: 6954.2147s
	iters: 400, epoch: 19 | loss: 0.0010489
	speed: 1.1959s/iter; left time: 6253.5247s
Epoch: 19 cost time: 596.192732334137
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0001110
	speed: 3.5209s/iter; left time: 17815.7342s
	iters: 200, epoch: 20 | loss: 0.0003085
	speed: 1.1560s/iter; left time: 5733.5438s
	iters: 300, epoch: 20 | loss: 0.0392667
	speed: 1.1538s/iter; left time: 5607.2932s
	iters: 400, epoch: 20 | loss: 0.0430705
	speed: 1.1353s/iter; left time: 5404.2617s
Epoch: 20 cost time: 533.4732053279877
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 56248586
model size : 217.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1872574
	speed: 0.4017s/iter; left time: 5611.6199s
	iters: 200, epoch: 1 | loss: 0.0551489
	speed: 0.4146s/iter; left time: 5751.4270s
	iters: 300, epoch: 1 | loss: 0.2106148
	speed: 0.4194s/iter; left time: 5775.9393s
	iters: 400, epoch: 1 | loss: 0.0190923
	speed: 0.3879s/iter; left time: 5302.5554s
Epoch: 1 cost time: 191.0246720314026
Epoch: 1, Steps: 469 | Train Loss: 0.314 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (inf --> -0.932816).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0030220
	speed: 1.3961s/iter; left time: 18850.3261s
	iters: 200, epoch: 2 | loss: 0.0147319
	speed: 0.4152s/iter; left time: 5564.2240s
	iters: 300, epoch: 2 | loss: 0.0085300
	speed: 0.4277s/iter; left time: 5689.2585s
	iters: 400, epoch: 2 | loss: 0.0360747
	speed: 0.4287s/iter; left time: 5659.5224s
Epoch: 2 cost time: 197.43039441108704
Epoch: 2, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.932816 --> -0.968552).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3992116
	speed: 1.5061s/iter; left time: 19628.9964s
	iters: 200, epoch: 3 | loss: 0.0102342
	speed: 0.4144s/iter; left time: 5359.7172s
	iters: 300, epoch: 3 | loss: 0.0204592
	speed: 0.4141s/iter; left time: 5314.3669s
	iters: 400, epoch: 3 | loss: 0.0012938
	speed: 0.3826s/iter; left time: 4871.1875s
Epoch: 3 cost time: 191.34440398216248
Epoch: 3, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0666095
	speed: 1.4505s/iter; left time: 18223.8069s
	iters: 200, epoch: 4 | loss: 0.0023347
	speed: 0.4139s/iter; left time: 5159.3190s
	iters: 300, epoch: 4 | loss: 0.0564134
	speed: 0.3921s/iter; left time: 4847.5455s
	iters: 400, epoch: 4 | loss: 0.0105177
	speed: 0.3894s/iter; left time: 4776.1341s
Epoch: 4 cost time: 188.15216088294983
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.968552 --> -0.975413).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0208821
	speed: 1.4104s/iter; left time: 17058.5611s
	iters: 200, epoch: 5 | loss: 0.0016654
	speed: 0.4370s/iter; left time: 5241.6820s
	iters: 300, epoch: 5 | loss: 0.0002301
	speed: 0.4335s/iter; left time: 5157.0484s
	iters: 400, epoch: 5 | loss: 0.1223203
	speed: 0.4341s/iter; left time: 5120.4998s
Epoch: 5 cost time: 200.84786319732666
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1405145
	speed: 1.4438s/iter; left time: 16785.2638s
	iters: 200, epoch: 6 | loss: 0.0056489
	speed: 0.4300s/iter; left time: 4955.7466s
	iters: 300, epoch: 6 | loss: 0.0017307
	speed: 0.4425s/iter; left time: 5056.3755s
	iters: 400, epoch: 6 | loss: 0.0003777
	speed: 0.4099s/iter; left time: 4642.7502s
Epoch: 6 cost time: 199.7876226902008
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0063132
	speed: 1.3335s/iter; left time: 14878.3244s
	iters: 200, epoch: 7 | loss: 0.0001371
	speed: 0.3679s/iter; left time: 4068.3134s
	iters: 300, epoch: 7 | loss: 0.0030261
	speed: 0.3700s/iter; left time: 4054.4942s
	iters: 400, epoch: 7 | loss: 0.0059883
	speed: 0.3858s/iter; left time: 4188.1604s
Epoch: 7 cost time: 176.0171413421631
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0477740
	speed: 1.3356s/iter; left time: 14274.7463s
	iters: 200, epoch: 8 | loss: 0.0098551
	speed: 0.3832s/iter; left time: 4057.0878s
	iters: 300, epoch: 8 | loss: 0.0012336
	speed: 0.3812s/iter; left time: 3997.7962s
	iters: 400, epoch: 8 | loss: 0.0011579
	speed: 0.3775s/iter; left time: 3921.3083s
Epoch: 8 cost time: 179.97040486335754
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0003717
	speed: 1.3023s/iter; left time: 13307.7887s
	iters: 200, epoch: 9 | loss: 0.0053362
	speed: 0.3758s/iter; left time: 3803.0985s
	iters: 300, epoch: 9 | loss: 0.0115676
	speed: 0.3759s/iter; left time: 3765.7588s
	iters: 400, epoch: 9 | loss: 0.0010404
	speed: 0.3642s/iter; left time: 3612.7211s
Epoch: 9 cost time: 173.6212089061737
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.231 Vali Acc: 0.940 Test Loss: 0.231 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0007198
	speed: 1.3397s/iter; left time: 13062.1854s
	iters: 200, epoch: 10 | loss: 0.0004802
	speed: 0.4307s/iter; left time: 4156.4628s
	iters: 300, epoch: 10 | loss: 0.0001943
	speed: 0.4256s/iter; left time: 4064.3041s
	iters: 400, epoch: 10 | loss: 0.0006447
	speed: 0.4335s/iter; left time: 4096.7487s
Epoch: 10 cost time: 198.5680627822876
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0033982
	speed: 1.4602s/iter; left time: 13551.8869s
	iters: 200, epoch: 11 | loss: 0.0000454
	speed: 0.4198s/iter; left time: 3853.8679s
	iters: 300, epoch: 11 | loss: 0.0156118
	speed: 0.4228s/iter; left time: 3839.4473s
	iters: 400, epoch: 11 | loss: 0.0007661
	speed: 0.4357s/iter; left time: 3912.9660s
Epoch: 11 cost time: 198.67965459823608
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0003956
	speed: 1.4907s/iter; left time: 13135.6905s
	iters: 200, epoch: 12 | loss: 0.0025812
	speed: 0.4139s/iter; left time: 3606.2484s
	iters: 300, epoch: 12 | loss: 0.0012743
	speed: 0.4107s/iter; left time: 3536.6795s
	iters: 400, epoch: 12 | loss: 0.0004821
	speed: 0.3968s/iter; left time: 3377.5257s
Epoch: 12 cost time: 190.59001541137695
Epoch: 12, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976843).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0052547
	speed: 1.3087s/iter; left time: 10918.7818s
	iters: 200, epoch: 13 | loss: 0.0001219
	speed: 0.3841s/iter; left time: 3165.9431s
	iters: 300, epoch: 13 | loss: 0.0076845
	speed: 0.3754s/iter; left time: 3057.1363s
	iters: 400, epoch: 13 | loss: 0.0000805
	speed: 0.3642s/iter; left time: 2929.1783s
Epoch: 13 cost time: 176.03064560890198
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0003228
	speed: 1.2484s/iter; left time: 9830.2918s
	iters: 200, epoch: 14 | loss: 0.0090214
	speed: 0.3603s/iter; left time: 2800.7206s
	iters: 300, epoch: 14 | loss: 0.0019318
	speed: 0.3757s/iter; left time: 2883.2059s
	iters: 400, epoch: 14 | loss: 0.0007730
	speed: 0.3956s/iter; left time: 2996.0295s
Epoch: 14 cost time: 178.00465488433838
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0017247
	speed: 1.3893s/iter; left time: 10287.6555s
	iters: 200, epoch: 15 | loss: 0.0011680
	speed: 0.4040s/iter; left time: 2951.1461s
	iters: 300, epoch: 15 | loss: 0.0001626
	speed: 0.4040s/iter; left time: 2911.1515s
	iters: 400, epoch: 15 | loss: 0.0001813
	speed: 0.3982s/iter; left time: 2828.9250s
Epoch: 15 cost time: 187.27150917053223
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.981131).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000575
	speed: 1.3485s/iter; left time: 9353.0774s
	iters: 200, epoch: 16 | loss: 0.0000683
	speed: 0.3438s/iter; left time: 2350.3196s
	iters: 300, epoch: 16 | loss: 0.0000166
	speed: 0.3573s/iter; left time: 2406.9116s
	iters: 400, epoch: 16 | loss: 0.0005089
	speed: 0.3724s/iter; left time: 2471.2719s
Epoch: 16 cost time: 170.20934081077576
Epoch: 16, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0025089
	speed: 1.2551s/iter; left time: 8116.4182s
	iters: 200, epoch: 17 | loss: 0.0000286
	speed: 0.3642s/iter; left time: 2318.8142s
	iters: 300, epoch: 17 | loss: 0.0162386
	speed: 0.3558s/iter; left time: 2229.5175s
	iters: 400, epoch: 17 | loss: 0.0006191
	speed: 0.3636s/iter; left time: 2242.5492s
Epoch: 17 cost time: 168.5203399658203
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0060733
	speed: 1.3344s/iter; left time: 8003.4904s
	iters: 200, epoch: 18 | loss: 0.0001380
	speed: 0.3992s/iter; left time: 2354.7510s
	iters: 300, epoch: 18 | loss: 0.2804406
	speed: 0.4060s/iter; left time: 2353.8490s
	iters: 400, epoch: 18 | loss: 0.0001326
	speed: 0.4019s/iter; left time: 2289.8214s
Epoch: 18 cost time: 189.37859344482422
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0007962
	speed: 1.4085s/iter; left time: 7787.8260s
	iters: 200, epoch: 19 | loss: 0.0014211
	speed: 0.3979s/iter; left time: 2160.3090s
	iters: 300, epoch: 19 | loss: 0.0001265
	speed: 0.3955s/iter; left time: 2107.3937s
	iters: 400, epoch: 19 | loss: 0.0000094
	speed: 0.3989s/iter; left time: 2085.7764s
Epoch: 19 cost time: 185.94506192207336
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000608
	speed: 1.4709s/iter; left time: 7442.6397s
	iters: 200, epoch: 20 | loss: 0.0000738
	speed: 0.4213s/iter; left time: 2089.8080s
	iters: 300, epoch: 20 | loss: 0.0001771
	speed: 0.4249s/iter; left time: 2064.8238s
	iters: 400, epoch: 20 | loss: 0.0033335
	speed: 0.4293s/iter; left time: 2043.4504s
Epoch: 20 cost time: 199.33267307281494
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0001331
	speed: 1.5051s/iter; left time: 6910.0853s
	iters: 200, epoch: 21 | loss: 0.0001596
	speed: 0.4400s/iter; left time: 1976.0603s
	iters: 300, epoch: 21 | loss: 0.0001202
	speed: 0.4439s/iter; left time: 1948.9946s
	iters: 400, epoch: 21 | loss: 0.0037209
	speed: 0.4464s/iter; left time: 1915.6235s
Epoch: 21 cost time: 205.59497475624084
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0018922
	speed: 1.4829s/iter; left time: 6112.3309s
	iters: 200, epoch: 22 | loss: 0.0005255
	speed: 0.4191s/iter; left time: 1685.7209s
	iters: 300, epoch: 22 | loss: 0.0000211
	speed: 0.4213s/iter; left time: 1652.5250s
	iters: 400, epoch: 22 | loss: 0.0004122
	speed: 0.4056s/iter; left time: 1550.1371s
Epoch: 22 cost time: 196.44448924064636
Epoch: 22, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0001148
	speed: 1.4768s/iter; left time: 5394.6008s
	iters: 200, epoch: 23 | loss: 0.0044107
	speed: 0.4073s/iter; left time: 1447.1367s
	iters: 300, epoch: 23 | loss: 0.0002397
	speed: 0.4152s/iter; left time: 1433.8412s
	iters: 400, epoch: 23 | loss: 0.0005814
	speed: 0.4163s/iter; left time: 1395.8123s
Epoch: 23 cost time: 194.10897850990295
Epoch: 23, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0004264
	speed: 1.4248s/iter; left time: 4536.5334s
	iters: 200, epoch: 24 | loss: 0.0000333
	speed: 0.3790s/iter; left time: 1168.8559s
	iters: 300, epoch: 24 | loss: 0.0002788
	speed: 0.3783s/iter; left time: 1128.7650s
	iters: 400, epoch: 24 | loss: 0.0001665
	speed: 0.3768s/iter; left time: 1086.6439s
Epoch: 24 cost time: 178.43914270401
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0062348
	speed: 1.3209s/iter; left time: 3586.3387s
	iters: 200, epoch: 25 | loss: 0.0001721
	speed: 0.4025s/iter; left time: 1052.4606s
	iters: 300, epoch: 25 | loss: 0.0001138
	speed: 0.4023s/iter; left time: 1011.6820s
	iters: 400, epoch: 25 | loss: 0.0000598
	speed: 0.4066s/iter; left time: 982.0349s
Epoch: 25 cost time: 188.34816122055054
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 16531466
model size : 65.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5361574
	speed: 0.7639s/iter; left time: 10672.7708s
	iters: 200, epoch: 1 | loss: 0.0449997
	speed: 0.7679s/iter; left time: 10651.0443s
	iters: 300, epoch: 1 | loss: 0.0275303
	speed: 0.8133s/iter; left time: 11199.9360s
	iters: 400, epoch: 1 | loss: 0.0199072
	speed: 0.7872s/iter; left time: 10761.8964s
Epoch: 1 cost time: 369.85539722442627
Epoch: 1, Steps: 469 | Train Loss: 0.322 Vali Loss: 0.189 Vali Acc: 0.942 Test Loss: 0.189 Test Acc: 0.942
Validation loss decreased (inf --> -0.942251).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0231702
	speed: 2.4558s/iter; left time: 33158.3144s
	iters: 200, epoch: 2 | loss: 0.2921437
	speed: 0.7747s/iter; left time: 10382.8408s
	iters: 300, epoch: 2 | loss: 0.0201747
	speed: 0.7621s/iter; left time: 10138.0391s
	iters: 400, epoch: 2 | loss: 0.1866041
	speed: 0.7721s/iter; left time: 10193.8555s
Epoch: 2 cost time: 361.6052587032318
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.942251 --> -0.951685).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0102221
	speed: 2.4036s/iter; left time: 31325.4839s
	iters: 200, epoch: 3 | loss: 0.0647715
	speed: 0.7483s/iter; left time: 9677.8730s
	iters: 300, epoch: 3 | loss: 0.0284416
	speed: 0.7622s/iter; left time: 9781.6658s
	iters: 400, epoch: 3 | loss: 0.0012998
	speed: 0.7740s/iter; left time: 9855.7405s
Epoch: 3 cost time: 354.4590976238251
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.951685 --> -0.962549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0046352
	speed: 2.2485s/iter; left time: 28249.6888s
	iters: 200, epoch: 4 | loss: 0.0368714
	speed: 0.6982s/iter; left time: 8701.7496s
	iters: 300, epoch: 4 | loss: 0.0322385
	speed: 0.7787s/iter; left time: 9628.3561s
	iters: 400, epoch: 4 | loss: 0.0232645
	speed: 0.7763s/iter; left time: 9521.1338s
Epoch: 4 cost time: 350.0551450252533
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0311673
	speed: 2.4125s/iter; left time: 29179.0033s
	iters: 200, epoch: 5 | loss: 0.0045145
	speed: 0.7470s/iter; left time: 8959.8466s
	iters: 300, epoch: 5 | loss: 0.0184831
	speed: 0.7639s/iter; left time: 9086.0629s
	iters: 400, epoch: 5 | loss: 0.2983823
	speed: 0.7996s/iter; left time: 9431.0023s
Epoch: 5 cost time: 359.9829411506653
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.962549 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018367
	speed: 2.4478s/iter; left time: 28457.8716s
	iters: 200, epoch: 6 | loss: 0.0084575
	speed: 0.7239s/iter; left time: 8343.2828s
	iters: 300, epoch: 6 | loss: 0.0066128
	speed: 0.7278s/iter; left time: 8315.7300s
	iters: 400, epoch: 6 | loss: 0.1094503
	speed: 0.7394s/iter; left time: 8374.6921s
Epoch: 6 cost time: 345.32997965812683
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0014256
	speed: 2.3418s/iter; left time: 26127.7246s
	iters: 200, epoch: 7 | loss: 0.0044289
	speed: 0.7263s/iter; left time: 8030.5483s
	iters: 300, epoch: 7 | loss: 0.0008247
	speed: 0.7420s/iter; left time: 8130.4906s
	iters: 400, epoch: 7 | loss: 0.0027250
	speed: 0.7587s/iter; left time: 8237.6030s
Epoch: 7 cost time: 348.75273966789246
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.969124 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004958
	speed: 2.3412s/iter; left time: 25023.1936s
	iters: 200, epoch: 8 | loss: 0.0008109
	speed: 0.7275s/iter; left time: 7702.7835s
	iters: 300, epoch: 8 | loss: 0.0001327
	speed: 0.7301s/iter; left time: 7657.1162s
	iters: 400, epoch: 8 | loss: 0.0003139
	speed: 0.7479s/iter; left time: 7769.0230s
Epoch: 8 cost time: 343.3070607185364
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0060981
	speed: 2.2924s/iter; left time: 23425.7437s
	iters: 200, epoch: 9 | loss: 0.0004992
	speed: 0.7192s/iter; left time: 7277.8269s
	iters: 300, epoch: 9 | loss: 0.0001623
	speed: 0.7101s/iter; left time: 7114.1064s
	iters: 400, epoch: 9 | loss: 0.0017459
	speed: 0.7100s/iter; left time: 7042.9456s
Epoch: 9 cost time: 333.52008748054504
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0005543
	speed: 2.1388s/iter; left time: 20853.7319s
	iters: 200, epoch: 10 | loss: 0.0002941
	speed: 0.7096s/iter; left time: 6847.6220s
	iters: 300, epoch: 10 | loss: 0.0010525
	speed: 0.7716s/iter; left time: 7368.8382s
	iters: 400, epoch: 10 | loss: 0.0001117
	speed: 0.7741s/iter; left time: 7314.8293s
Epoch: 10 cost time: 349.10680103302
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0063586
	speed: 2.2848s/iter; left time: 21205.3556s
	iters: 200, epoch: 11 | loss: 0.0035544
	speed: 0.7051s/iter; left time: 6473.6079s
	iters: 300, epoch: 11 | loss: 0.0003669
	speed: 0.7270s/iter; left time: 6601.9311s
	iters: 400, epoch: 11 | loss: 0.0006151
	speed: 0.7444s/iter; left time: 6685.1530s
Epoch: 11 cost time: 339.389023065567
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0002391
	speed: 2.2461s/iter; left time: 19792.3372s
	iters: 200, epoch: 12 | loss: 0.0006312
	speed: 0.7060s/iter; left time: 6150.3693s
	iters: 300, epoch: 12 | loss: 0.0026759
	speed: 0.6754s/iter; left time: 5816.4543s
	iters: 400, epoch: 12 | loss: 0.0085940
	speed: 0.6586s/iter; left time: 5605.8799s
Epoch: 12 cost time: 323.48289036750793
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0003405
	speed: 2.2539s/iter; left time: 18804.2687s
	iters: 200, epoch: 13 | loss: 0.0708293
	speed: 0.8158s/iter; left time: 6724.8612s
	iters: 300, epoch: 13 | loss: 0.0010086
	speed: 0.9167s/iter; left time: 7464.5452s
	iters: 400, epoch: 13 | loss: 0.0018569
	speed: 0.8765s/iter; left time: 7049.7822s
Epoch: 13 cost time: 399.10746717453003
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0001718
	speed: 2.8324s/iter; left time: 22302.3854s
	iters: 200, epoch: 14 | loss: 0.0007425
	speed: 0.9408s/iter; left time: 7313.6549s
	iters: 300, epoch: 14 | loss: 0.0063648
	speed: 0.8948s/iter; left time: 6866.4935s
	iters: 400, epoch: 14 | loss: 0.0015585
	speed: 0.8860s/iter; left time: 6710.8771s
Epoch: 14 cost time: 425.6673595905304
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0001564
	speed: 2.8054s/iter; left time: 20773.7971s
	iters: 200, epoch: 15 | loss: 0.0001102
	speed: 0.9025s/iter; left time: 6592.9307s
	iters: 300, epoch: 15 | loss: 0.0001280
	speed: 0.8402s/iter; left time: 6053.8485s
	iters: 400, epoch: 15 | loss: 0.0002561
	speed: 0.8729s/iter; left time: 6202.2041s
Epoch: 15 cost time: 413.76911664009094
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000414
	speed: 2.6606s/iter; left time: 18453.8737s
	iters: 200, epoch: 16 | loss: 0.0010816
	speed: 0.8306s/iter; left time: 5677.6586s
	iters: 300, epoch: 16 | loss: 0.1820062
	speed: 0.8562s/iter; left time: 5767.2435s
	iters: 400, epoch: 16 | loss: 0.0035530
	speed: 0.8663s/iter; left time: 5748.5425s
Epoch: 16 cost time: 397.67691349983215
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0001715
	speed: 2.7374s/iter; left time: 17702.7072s
	iters: 200, epoch: 17 | loss: 0.0016129
	speed: 0.8485s/iter; left time: 5402.5944s
	iters: 300, epoch: 17 | loss: 0.0002085
	speed: 0.8609s/iter; left time: 5395.5178s
	iters: 400, epoch: 17 | loss: 0.0016979
	speed: 0.8654s/iter; left time: 5337.2158s
Epoch: 17 cost time: 399.92790150642395
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000549
	speed: 2.6199s/iter; left time: 15714.3760s
	iters: 200, epoch: 18 | loss: 0.0088616
	speed: 0.7903s/iter; left time: 4661.3420s
	iters: 300, epoch: 18 | loss: 0.0003137
	speed: 0.7685s/iter; left time: 4455.8800s
	iters: 400, epoch: 18 | loss: 0.0000629
	speed: 0.7546s/iter; left time: 4299.4627s
Epoch: 18 cost time: 365.5343072414398
Epoch: 18, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.977129 --> -0.980559).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0056818
	speed: 2.4431s/iter; left time: 13507.6916s
	iters: 200, epoch: 19 | loss: 0.0171450
	speed: 0.8144s/iter; left time: 4421.6391s
	iters: 300, epoch: 19 | loss: 0.0022011
	speed: 0.7955s/iter; left time: 4238.9706s
	iters: 400, epoch: 19 | loss: 0.0006102
	speed: 0.7901s/iter; left time: 4131.4169s
Epoch: 19 cost time: 374.71918058395386
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000751
	speed: 2.3612s/iter; left time: 11947.5404s
	iters: 200, epoch: 20 | loss: 0.0000203
	speed: 0.7362s/iter; left time: 3651.7060s
	iters: 300, epoch: 20 | loss: 0.0001324
	speed: 0.7396s/iter; left time: 3594.6737s
	iters: 400, epoch: 20 | loss: 0.2255906
	speed: 0.7713s/iter; left time: 3671.5106s
Epoch: 20 cost time: 355.2839434146881
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0313578
	speed: 2.6428s/iter; left time: 12132.9869s
	iters: 200, epoch: 21 | loss: 0.0654126
	speed: 0.8210s/iter; left time: 3687.1384s
	iters: 300, epoch: 21 | loss: 0.0147422
	speed: 0.8360s/iter; left time: 3671.0800s
	iters: 400, epoch: 21 | loss: 0.0004933
	speed: 0.8169s/iter; left time: 3505.4373s
Epoch: 21 cost time: 390.19185853004456
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0007904
	speed: 2.5694s/iter; left time: 10591.2506s
	iters: 200, epoch: 22 | loss: 0.0021463
	speed: 0.8314s/iter; left time: 3343.7309s
	iters: 300, epoch: 22 | loss: 0.0023468
	speed: 0.7791s/iter; left time: 3055.5539s
	iters: 400, epoch: 22 | loss: 0.0008153
	speed: 0.7903s/iter; left time: 3020.3840s
Epoch: 22 cost time: 377.64319467544556
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0015258
	speed: 2.3019s/iter; left time: 8408.7989s
	iters: 200, epoch: 23 | loss: 0.0003052
	speed: 0.7559s/iter; left time: 2685.8751s
	iters: 300, epoch: 23 | loss: 0.0000634
	speed: 0.7444s/iter; left time: 2570.2607s
	iters: 400, epoch: 23 | loss: 0.0001898
	speed: 0.7073s/iter; left time: 2371.4842s
Epoch: 23 cost time: 337.4298872947693
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0018449
	speed: 2.3432s/iter; left time: 7460.8256s
	iters: 200, epoch: 24 | loss: 0.0038805
	speed: 0.7808s/iter; left time: 2407.8416s
	iters: 300, epoch: 24 | loss: 0.0000728
	speed: 0.8016s/iter; left time: 2391.9888s
	iters: 400, epoch: 24 | loss: 0.3470348
	speed: 0.7653s/iter; left time: 2207.1748s
Epoch: 24 cost time: 361.0517055988312
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0139837
	speed: 2.4050s/iter; left time: 6529.6701s
	iters: 200, epoch: 25 | loss: 0.0018747
	speed: 0.7493s/iter; left time: 1959.4018s
	iters: 300, epoch: 25 | loss: 0.0001674
	speed: 0.6828s/iter; left time: 1717.1755s
	iters: 400, epoch: 25 | loss: 0.0382491
	speed: 0.7013s/iter; left time: 1693.5990s
Epoch: 25 cost time: 334.925576210022
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000174
	speed: 2.0812s/iter; left time: 4674.4175s
	iters: 200, epoch: 26 | loss: 0.0007967
	speed: 0.6530s/iter; left time: 1401.3282s
	iters: 300, epoch: 26 | loss: 0.0001087
	speed: 0.6681s/iter; left time: 1367.0093s
	iters: 400, epoch: 26 | loss: 0.0008387
	speed: 0.7116s/iter; left time: 1384.7359s
Epoch: 26 cost time: 322.44680738449097
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0155043
	speed: 2.0413s/iter; left time: 3627.4489s
	iters: 200, epoch: 27 | loss: 0.0005373
	speed: 0.6438s/iter; left time: 1079.7001s
	iters: 300, epoch: 27 | loss: 0.0015028
	speed: 0.6107s/iter; left time: 963.0392s
	iters: 400, epoch: 27 | loss: 0.0018457
	speed: 0.6924s/iter; left time: 1022.6838s
Epoch: 27 cost time: 313.3971800804138
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0011696
	speed: 2.3241s/iter; left time: 3039.8740s
	iters: 200, epoch: 28 | loss: 0.0001920
	speed: 0.7629s/iter; left time: 921.6346s
	iters: 300, epoch: 28 | loss: 0.0001523
	speed: 0.7233s/iter; left time: 801.3633s
	iters: 400, epoch: 28 | loss: 0.0039136
	speed: 0.8685s/iter; left time: 875.4269s
Epoch: 28 cost time: 372.4212131500244
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.965 Test Loss: 0.226 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 56248586
model size : 217.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1999004
	speed: 0.3401s/iter; left time: 4750.9989s
	iters: 200, epoch: 1 | loss: 0.0636724
	speed: 0.3324s/iter; left time: 4610.5384s
	iters: 300, epoch: 1 | loss: 0.3478459
	speed: 0.3376s/iter; left time: 4648.9749s
	iters: 400, epoch: 1 | loss: 0.0163879
	speed: 0.3331s/iter; left time: 4554.0495s
Epoch: 1 cost time: 154.53116869926453
Epoch: 1, Steps: 469 | Train Loss: 0.323 Vali Loss: 0.166 Vali Acc: 0.947 Test Loss: 0.166 Test Acc: 0.947
Validation loss decreased (inf --> -0.946825).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0013862
	speed: 1.1439s/iter; left time: 15445.3930s
	iters: 200, epoch: 2 | loss: 0.0111603
	speed: 0.3058s/iter; left time: 4097.8245s
	iters: 300, epoch: 2 | loss: 0.0023737
	speed: 0.3069s/iter; left time: 4082.3445s
	iters: 400, epoch: 2 | loss: 0.0336911
	speed: 0.3282s/iter; left time: 4332.7581s
Epoch: 2 cost time: 147.61101460456848
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.946825 --> -0.951399).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3671251
	speed: 1.1292s/iter; left time: 14717.4097s
	iters: 200, epoch: 3 | loss: 0.1570687
	speed: 0.2677s/iter; left time: 3462.4357s
	iters: 300, epoch: 3 | loss: 0.0233710
	speed: 0.2950s/iter; left time: 3785.5389s
	iters: 400, epoch: 3 | loss: 0.0008051
	speed: 0.3043s/iter; left time: 3874.4498s
Epoch: 3 cost time: 137.16282153129578
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1203209
	speed: 1.0211s/iter; left time: 12828.7446s
	iters: 200, epoch: 4 | loss: 0.0041116
	speed: 0.3184s/iter; left time: 3968.2986s
	iters: 300, epoch: 4 | loss: 0.0288393
	speed: 0.3057s/iter; left time: 3779.5585s
	iters: 400, epoch: 4 | loss: 0.0963938
	speed: 0.2872s/iter; left time: 3522.7754s
Epoch: 4 cost time: 141.12148475646973
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0806494
	speed: 1.1889s/iter; left time: 14380.2191s
	iters: 200, epoch: 5 | loss: 0.0063064
	speed: 0.3305s/iter; left time: 3964.9176s
	iters: 300, epoch: 5 | loss: 0.0003192
	speed: 0.3330s/iter; left time: 3960.9427s
	iters: 400, epoch: 5 | loss: 0.0011331
	speed: 0.3350s/iter; left time: 3950.7595s
Epoch: 5 cost time: 154.4936330318451
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
Validation loss decreased (-0.951399 --> -0.967409).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0048605
	speed: 1.1982s/iter; left time: 13930.7480s
	iters: 200, epoch: 6 | loss: 0.0056064
	speed: 0.3364s/iter; left time: 3877.5256s
	iters: 300, epoch: 6 | loss: 0.0010892
	speed: 0.3321s/iter; left time: 3794.1105s
	iters: 400, epoch: 6 | loss: 0.0005467
	speed: 0.2979s/iter; left time: 3373.7207s
Epoch: 6 cost time: 150.6807897090912
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.967409 --> -0.980274).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0009955
	speed: 1.0617s/iter; left time: 11845.2869s
	iters: 200, epoch: 7 | loss: 0.0024560
	speed: 0.2690s/iter; left time: 2973.9375s
	iters: 300, epoch: 7 | loss: 0.0013063
	speed: 0.2722s/iter; left time: 2982.6992s
	iters: 400, epoch: 7 | loss: 0.0012387
	speed: 0.2832s/iter; left time: 3074.2997s
Epoch: 7 cost time: 127.38844084739685
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0014116
	speed: 1.0078s/iter; left time: 10771.2122s
	iters: 200, epoch: 8 | loss: 0.0001621
	speed: 0.2464s/iter; left time: 2608.5604s
	iters: 300, epoch: 8 | loss: 0.0012232
	speed: 0.2556s/iter; left time: 2681.1620s
	iters: 400, epoch: 8 | loss: 0.0084192
	speed: 0.2352s/iter; left time: 2443.1525s
Epoch: 8 cost time: 117.84141707420349
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0004302
	speed: 0.8686s/iter; left time: 8876.0799s
	iters: 200, epoch: 9 | loss: 0.0096859
	speed: 0.2929s/iter; left time: 2963.6864s
	iters: 300, epoch: 9 | loss: 0.0005762
	speed: 0.2825s/iter; left time: 2829.9619s
	iters: 400, epoch: 9 | loss: 0.0023673
	speed: 0.2892s/iter; left time: 2868.1104s
Epoch: 9 cost time: 130.03578448295593
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0075048
	speed: 0.9876s/iter; left time: 9628.6187s
	iters: 200, epoch: 10 | loss: 0.0003374
	speed: 0.2488s/iter; left time: 2400.8368s
	iters: 300, epoch: 10 | loss: 0.0000976
	speed: 0.2414s/iter; left time: 2305.7452s
	iters: 400, epoch: 10 | loss: 0.0010906
	speed: 0.2489s/iter; left time: 2351.9209s
Epoch: 10 cost time: 114.3660957813263
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0017531
	speed: 0.8519s/iter; left time: 7906.7933s
	iters: 200, epoch: 11 | loss: 0.0002495
	speed: 0.2659s/iter; left time: 2441.6235s
	iters: 300, epoch: 11 | loss: 0.0001124
	speed: 0.2682s/iter; left time: 2435.2443s
	iters: 400, epoch: 11 | loss: 0.0007581
	speed: 0.2706s/iter; left time: 2429.8573s
Epoch: 11 cost time: 126.2781674861908
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0004414
	speed: 1.0585s/iter; left time: 9327.2404s
	iters: 200, epoch: 12 | loss: 0.0018695
	speed: 0.3174s/iter; left time: 2765.1548s
	iters: 300, epoch: 12 | loss: 0.0004675
	speed: 0.3182s/iter; left time: 2740.5197s
	iters: 400, epoch: 12 | loss: 0.0401386
	speed: 0.3229s/iter; left time: 2748.3574s
Epoch: 12 cost time: 151.4077250957489
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000289
	speed: 1.2525s/iter; left time: 10449.9905s
	iters: 200, epoch: 13 | loss: 0.0007060
	speed: 0.3144s/iter; left time: 2591.2938s
	iters: 300, epoch: 13 | loss: 0.0007061
	speed: 0.3076s/iter; left time: 2504.9937s
	iters: 400, epoch: 13 | loss: 0.0001432
	speed: 0.2921s/iter; left time: 2349.6599s
Epoch: 13 cost time: 145.74672508239746
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0029925
	speed: 1.0938s/iter; left time: 8612.3637s
	iters: 200, epoch: 14 | loss: 0.0025072
	speed: 0.2984s/iter; left time: 2320.0135s
	iters: 300, epoch: 14 | loss: 0.0001921
	speed: 0.3051s/iter; left time: 2341.2976s
	iters: 400, epoch: 14 | loss: 0.0006604
	speed: 0.3128s/iter; left time: 2369.2056s
Epoch: 14 cost time: 143.59913754463196
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0021488
	speed: 1.2071s/iter; left time: 8938.6271s
	iters: 200, epoch: 15 | loss: 0.0000849
	speed: 0.3123s/iter; left time: 2281.4160s
	iters: 300, epoch: 15 | loss: 0.0001310
	speed: 0.3124s/iter; left time: 2251.1873s
	iters: 400, epoch: 15 | loss: 0.0007820
	speed: 0.3151s/iter; left time: 2238.6931s
Epoch: 15 cost time: 148.46098160743713
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0008404
	speed: 1.0296s/iter; left time: 7141.5807s
	iters: 200, epoch: 16 | loss: 0.0000841
	speed: 0.2351s/iter; left time: 1606.9687s
	iters: 300, epoch: 16 | loss: 0.0004964
	speed: 0.2420s/iter; left time: 1629.9580s
	iters: 400, epoch: 16 | loss: 0.0007284
	speed: 0.2463s/iter; left time: 1634.5655s
Epoch: 16 cost time: 117.43728494644165
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 16531466
model size : 65.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5237157
	speed: 0.3881s/iter; left time: 5422.0704s
	iters: 200, epoch: 1 | loss: 0.0496557
	speed: 0.3700s/iter; left time: 5132.1443s
	iters: 300, epoch: 1 | loss: 0.0697103
	speed: 0.4259s/iter; left time: 5865.3137s
	iters: 400, epoch: 1 | loss: 0.0387645
	speed: 0.4296s/iter; left time: 5873.3039s
Epoch: 1 cost time: 191.58853483200073
Epoch: 1, Steps: 469 | Train Loss: 0.352 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (inf --> -0.957117).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0339402
	speed: 1.2939s/iter; left time: 17469.7412s
	iters: 200, epoch: 2 | loss: 0.0522967
	speed: 0.3795s/iter; left time: 5085.5291s
	iters: 300, epoch: 2 | loss: 0.1973599
	speed: 0.3848s/iter; left time: 5119.2349s
	iters: 400, epoch: 2 | loss: 0.1499278
	speed: 0.4181s/iter; left time: 5520.1427s
Epoch: 2 cost time: 190.8648600578308
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.957117 --> -0.965694).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0047631
	speed: 1.6314s/iter; left time: 21261.6384s
	iters: 200, epoch: 3 | loss: 0.0115715
	speed: 0.4323s/iter; left time: 5591.4119s
	iters: 300, epoch: 3 | loss: 0.3917460
	speed: 0.4424s/iter; left time: 5677.5933s
	iters: 400, epoch: 3 | loss: 0.9738823
	speed: 0.4497s/iter; left time: 5726.0741s
Epoch: 3 cost time: 212.08367800712585
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0127122
	speed: 1.5198s/iter; left time: 19094.2888s
	iters: 200, epoch: 4 | loss: 0.0493416
	speed: 0.4554s/iter; left time: 5676.7246s
	iters: 300, epoch: 4 | loss: 0.0048425
	speed: 0.3890s/iter; left time: 4809.6645s
	iters: 400, epoch: 4 | loss: 0.1840814
	speed: 0.4175s/iter; left time: 5120.2458s
Epoch: 4 cost time: 201.90637397766113
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.965694 --> -0.968266).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1254049
	speed: 1.4449s/iter; left time: 17476.0658s
	iters: 200, epoch: 5 | loss: 0.2578684
	speed: 0.4252s/iter; left time: 5100.3566s
	iters: 300, epoch: 5 | loss: 0.0279160
	speed: 0.4350s/iter; left time: 5174.3367s
	iters: 400, epoch: 5 | loss: 0.2505093
	speed: 0.3872s/iter; left time: 4567.2451s
Epoch: 5 cost time: 194.4152488708496
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1938882
	speed: 1.2170s/iter; left time: 14148.9460s
	iters: 200, epoch: 6 | loss: 0.0033849
	speed: 0.4041s/iter; left time: 4658.1554s
	iters: 300, epoch: 6 | loss: 0.0031470
	speed: 0.4399s/iter; left time: 5026.7722s
	iters: 400, epoch: 6 | loss: 0.3225497
	speed: 0.4261s/iter; left time: 4826.2979s
Epoch: 6 cost time: 194.9164583683014
Epoch: 6, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.969982).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0032974
	speed: 1.3013s/iter; left time: 14519.0620s
	iters: 200, epoch: 7 | loss: 0.0030259
	speed: 0.4143s/iter; left time: 4580.5398s
	iters: 300, epoch: 7 | loss: 0.0014893
	speed: 0.4144s/iter; left time: 4540.9076s
	iters: 400, epoch: 7 | loss: 0.0002808
	speed: 0.3922s/iter; left time: 4258.0738s
Epoch: 7 cost time: 190.36678290367126
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0004208
	speed: 1.2506s/iter; left time: 13366.2929s
	iters: 200, epoch: 8 | loss: 0.0001226
	speed: 0.4124s/iter; left time: 4366.7671s
	iters: 300, epoch: 8 | loss: 0.0010359
	speed: 0.4250s/iter; left time: 4457.6049s
	iters: 400, epoch: 8 | loss: 0.0019114
	speed: 0.4134s/iter; left time: 4294.8072s
Epoch: 8 cost time: 188.04259061813354
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0139272
	speed: 1.2218s/iter; left time: 12486.0489s
	iters: 200, epoch: 9 | loss: 0.0051787
	speed: 0.3966s/iter; left time: 4013.3999s
	iters: 300, epoch: 9 | loss: 0.0013488
	speed: 0.4697s/iter; left time: 4706.3798s
	iters: 400, epoch: 9 | loss: 0.0008071
	speed: 0.4700s/iter; left time: 4661.6578s
Epoch: 9 cost time: 203.71327996253967
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.969982 --> -0.976271).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0032791
	speed: 1.4855s/iter; left time: 14483.6755s
	iters: 200, epoch: 10 | loss: 0.0003758
	speed: 0.4661s/iter; left time: 4498.0196s
	iters: 300, epoch: 10 | loss: 0.0002182
	speed: 0.4726s/iter; left time: 4513.6601s
	iters: 400, epoch: 10 | loss: 0.0000985
	speed: 0.3934s/iter; left time: 3717.9269s
Epoch: 10 cost time: 206.15502166748047
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0309499
	speed: 1.2392s/iter; left time: 11501.1770s
	iters: 200, epoch: 11 | loss: 0.0057302
	speed: 0.3301s/iter; left time: 3030.9674s
	iters: 300, epoch: 11 | loss: 0.0002752
	speed: 0.3735s/iter; left time: 3391.9406s
	iters: 400, epoch: 11 | loss: 0.0024923
	speed: 0.3812s/iter; left time: 3423.2752s
Epoch: 11 cost time: 171.64058113098145
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0016359
	speed: 1.1866s/iter; left time: 10456.6877s
	iters: 200, epoch: 12 | loss: 0.0258453
	speed: 0.3685s/iter; left time: 3210.7046s
	iters: 300, epoch: 12 | loss: 0.0006566
	speed: 0.3525s/iter; left time: 3035.3291s
	iters: 400, epoch: 12 | loss: 0.0045978
	speed: 0.3578s/iter; left time: 3045.3190s
Epoch: 12 cost time: 167.2790720462799
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0008000
	speed: 1.0293s/iter; left time: 8587.2377s
	iters: 200, epoch: 13 | loss: 0.1968587
	speed: 0.3230s/iter; left time: 2662.2945s
	iters: 300, epoch: 13 | loss: 0.0016524
	speed: 0.3357s/iter; left time: 2733.5425s
	iters: 400, epoch: 13 | loss: 0.0001071
	speed: 0.3508s/iter; left time: 2821.2137s
Epoch: 13 cost time: 158.5517270565033
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0015261
	speed: 1.2827s/iter; left time: 10099.6177s
	iters: 200, epoch: 14 | loss: 0.0001032
	speed: 0.3909s/iter; left time: 3038.6618s
	iters: 300, epoch: 14 | loss: 0.0047064
	speed: 0.3955s/iter; left time: 3035.0876s
	iters: 400, epoch: 14 | loss: 0.0001011
	speed: 0.4569s/iter; left time: 3460.4565s
Epoch: 14 cost time: 195.57037329673767
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000576
	speed: 1.4699s/iter; left time: 10884.5059s
	iters: 200, epoch: 15 | loss: 0.0004825
	speed: 0.4371s/iter; left time: 3192.6699s
	iters: 300, epoch: 15 | loss: 0.0065437
	speed: 0.4061s/iter; left time: 2926.2708s
	iters: 400, epoch: 15 | loss: 0.0001484
	speed: 0.3952s/iter; left time: 2807.8243s
Epoch: 15 cost time: 194.69509625434875
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.976843).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0035563
	speed: 1.2719s/iter; left time: 8821.6489s
	iters: 200, epoch: 16 | loss: 0.0004715
	speed: 0.3850s/iter; left time: 2632.1937s
	iters: 300, epoch: 16 | loss: 0.0060999
	speed: 0.3866s/iter; left time: 2603.8586s
	iters: 400, epoch: 16 | loss: 0.0105505
	speed: 0.4028s/iter; left time: 2673.2887s
Epoch: 16 cost time: 182.87180018424988
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0003095
	speed: 1.1771s/iter; left time: 7612.0196s
	iters: 200, epoch: 17 | loss: 0.0009309
	speed: 0.3411s/iter; left time: 2171.7840s
	iters: 300, epoch: 17 | loss: 0.0003472
	speed: 0.3475s/iter; left time: 2177.8743s
	iters: 400, epoch: 17 | loss: 0.0059057
	speed: 0.3302s/iter; left time: 2036.1832s
Epoch: 17 cost time: 162.16661381721497
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0803086
	speed: 1.0964s/iter; left time: 6576.0086s
	iters: 200, epoch: 18 | loss: 0.0081117
	speed: 0.3445s/iter; left time: 2031.7975s
	iters: 300, epoch: 18 | loss: 0.0011813
	speed: 0.3192s/iter; left time: 1850.8385s
	iters: 400, epoch: 18 | loss: 0.0002948
	speed: 0.3004s/iter; left time: 1711.9436s
Epoch: 18 cost time: 155.48821926116943
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2543826
	speed: 1.0331s/iter; left time: 5711.9627s
	iters: 200, epoch: 19 | loss: 0.0976499
	speed: 0.3597s/iter; left time: 1952.6634s
	iters: 300, epoch: 19 | loss: 0.0002228
	speed: 0.3723s/iter; left time: 1983.9876s
	iters: 400, epoch: 19 | loss: 0.0005152
	speed: 0.3822s/iter; left time: 1998.6371s
Epoch: 19 cost time: 171.36396956443787
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976843 --> -0.980274).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001530
	speed: 1.2399s/iter; left time: 6273.7478s
	iters: 200, epoch: 20 | loss: 0.0000286
	speed: 0.3586s/iter; left time: 1778.5561s
	iters: 300, epoch: 20 | loss: 0.0003115
	speed: 0.3734s/iter; left time: 1814.6292s
	iters: 400, epoch: 20 | loss: 0.0061759
	speed: 0.3903s/iter; left time: 1857.6931s
Epoch: 20 cost time: 178.14191675186157
Epoch: 20, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2540917
	speed: 1.2259s/iter; left time: 5627.9511s
	iters: 200, epoch: 21 | loss: 0.1971195
	speed: 0.3805s/iter; left time: 1708.8604s
	iters: 300, epoch: 21 | loss: 0.0000902
	speed: 0.3292s/iter; left time: 1445.4465s
	iters: 400, epoch: 21 | loss: 0.0001037
	speed: 0.3343s/iter; left time: 1434.4216s
Epoch: 21 cost time: 166.8119716644287
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0008490
	speed: 1.1300s/iter; left time: 4657.9255s
	iters: 200, epoch: 22 | loss: 0.0007958
	speed: 0.3840s/iter; left time: 1544.6410s
	iters: 300, epoch: 22 | loss: 0.0021265
	speed: 0.3711s/iter; left time: 1455.2791s
	iters: 400, epoch: 22 | loss: 0.0015254
	speed: 0.3387s/iter; left time: 1294.6365s
Epoch: 22 cost time: 164.72203993797302
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0027199
	speed: 1.0378s/iter; left time: 3790.9097s
	iters: 200, epoch: 23 | loss: 0.0003721
	speed: 0.3074s/iter; left time: 1092.1253s
	iters: 300, epoch: 23 | loss: 0.0004444
	speed: 0.3468s/iter; left time: 1197.4382s
	iters: 400, epoch: 23 | loss: 0.0005994
	speed: 0.3692s/iter; left time: 1237.9163s
Epoch: 23 cost time: 160.56862378120422
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0025033
	speed: 1.0330s/iter; left time: 3289.0836s
	iters: 200, epoch: 24 | loss: 0.1783591
	speed: 0.3136s/iter; left time: 967.1985s
	iters: 300, epoch: 24 | loss: 0.0025201
	speed: 0.2866s/iter; left time: 855.2774s
	iters: 400, epoch: 24 | loss: 0.0002872
	speed: 0.2940s/iter; left time: 847.9109s
Epoch: 24 cost time: 143.40190863609314
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0017380
	speed: 0.9998s/iter; left time: 2714.5836s
	iters: 200, epoch: 25 | loss: 0.0003594
	speed: 0.3593s/iter; left time: 939.6794s
	iters: 300, epoch: 25 | loss: 0.0027928
	speed: 0.3746s/iter; left time: 942.1545s
	iters: 400, epoch: 25 | loss: 0.0007403
	speed: 0.3357s/iter; left time: 810.6159s
Epoch: 25 cost time: 163.01803517341614
Epoch: 25, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0004031
	speed: 1.1234s/iter; left time: 2523.1069s
	iters: 200, epoch: 26 | loss: 0.0001146
	speed: 0.3900s/iter; left time: 836.9259s
	iters: 300, epoch: 26 | loss: 0.0057470
	speed: 0.3975s/iter; left time: 813.2731s
	iters: 400, epoch: 26 | loss: 0.1266025
	speed: 0.3973s/iter; left time: 773.2329s
Epoch: 26 cost time: 185.3509876728058
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0032385
	speed: 1.1702s/iter; left time: 2079.3634s
	iters: 200, epoch: 27 | loss: 0.0003859
	speed: 0.3454s/iter; left time: 579.1691s
	iters: 300, epoch: 27 | loss: 0.0012224
	speed: 0.3557s/iter; left time: 560.9569s
	iters: 400, epoch: 27 | loss: 0.0080450
	speed: 0.3829s/iter; left time: 565.6007s
Epoch: 27 cost time: 170.27568912506104
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0018648
	speed: 1.1897s/iter; left time: 1556.1904s
	iters: 200, epoch: 28 | loss: 0.0008305
	speed: 0.3421s/iter; left time: 413.2750s
	iters: 300, epoch: 28 | loss: 0.0004847
	speed: 0.3303s/iter; left time: 365.9248s
	iters: 400, epoch: 28 | loss: 0.5546532
	speed: 0.3222s/iter; left time: 324.7280s
Epoch: 28 cost time: 154.11510252952576
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.349 Vali Acc: 0.921 Test Loss: 0.349 Test Acc: 0.921
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0001097
	speed: 1.0523s/iter; left time: 882.8682s
	iters: 200, epoch: 29 | loss: 0.0001638
	speed: 0.3404s/iter; left time: 251.5672s
	iters: 300, epoch: 29 | loss: 0.0000215
	speed: 0.3256s/iter; left time: 208.0892s
	iters: 400, epoch: 29 | loss: 0.0008226
	speed: 0.3224s/iter; left time: 173.7675s
Epoch: 29 cost time: 155.23910927772522
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.980274 --> -0.983132).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000607
	speed: 1.0287s/iter; left time: 380.6123s
	iters: 200, epoch: 30 | loss: 0.0010370
	speed: 0.3040s/iter; left time: 82.0871s
	iters: 300, epoch: 30 | loss: 0.0003991
	speed: 0.3191s/iter; left time: 54.2410s
	iters: 400, epoch: 30 | loss: 0.0000775
	speed: 0.3151s/iter; left time: 22.0559s
Epoch: 30 cost time: 148.18807196617126
Epoch: 30, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 56248586
model size : 217.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2619950
	speed: 0.1664s/iter; left time: 2324.6395s
	iters: 200, epoch: 1 | loss: 0.0616899
	speed: 0.1643s/iter; left time: 2279.4197s
	iters: 300, epoch: 1 | loss: 0.2266494
	speed: 0.1633s/iter; left time: 2249.0119s
	iters: 400, epoch: 1 | loss: 0.0298469
	speed: 0.1634s/iter; left time: 2233.3836s
Epoch: 1 cost time: 76.66333055496216
Epoch: 1, Steps: 469 | Train Loss: 0.361 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (inf --> -0.964264).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0029551
	speed: 0.6467s/iter; left time: 8731.2361s
	iters: 200, epoch: 2 | loss: 0.0224722
	speed: 0.1525s/iter; left time: 2044.3596s
	iters: 300, epoch: 2 | loss: 0.0123408
	speed: 0.1431s/iter; left time: 1903.5249s
	iters: 400, epoch: 2 | loss: 0.0093296
	speed: 0.1351s/iter; left time: 1783.9763s
Epoch: 2 cost time: 68.73826718330383
Epoch: 2, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.964264 --> -0.971411).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1660280
	speed: 0.6078s/iter; left time: 7921.8624s
	iters: 200, epoch: 3 | loss: 0.0726635
	speed: 0.1510s/iter; left time: 1953.3292s
	iters: 300, epoch: 3 | loss: 0.0350545
	speed: 0.1503s/iter; left time: 1928.1858s
	iters: 400, epoch: 3 | loss: 0.0043924
	speed: 0.1503s/iter; left time: 1913.4816s
Epoch: 3 cost time: 70.7733702659607
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0821812
	speed: 0.6325s/iter; left time: 7947.0066s
	iters: 200, epoch: 4 | loss: 0.0046338
	speed: 0.1550s/iter; left time: 1931.7284s
	iters: 300, epoch: 4 | loss: 0.1094572
	speed: 0.1560s/iter; left time: 1928.4881s
	iters: 400, epoch: 4 | loss: 0.0878573
	speed: 0.1517s/iter; left time: 1860.4868s
Epoch: 4 cost time: 72.14581894874573
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0185968
	speed: 0.5875s/iter; left time: 7105.2415s
	iters: 200, epoch: 5 | loss: 0.0015485
	speed: 0.1435s/iter; left time: 1721.0046s
	iters: 300, epoch: 5 | loss: 0.0114345
	speed: 0.1452s/iter; left time: 1727.3854s
	iters: 400, epoch: 5 | loss: 0.0185018
	speed: 0.1367s/iter; left time: 1612.5398s
Epoch: 5 cost time: 64.9814887046814
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.958 Test Loss: 0.129 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0148780
	speed: 0.5322s/iter; left time: 6187.7850s
	iters: 200, epoch: 6 | loss: 0.0017403
	speed: 0.1289s/iter; left time: 1485.7684s
	iters: 300, epoch: 6 | loss: 0.0003144
	speed: 0.1338s/iter; left time: 1528.6382s
	iters: 400, epoch: 6 | loss: 0.0041460
	speed: 0.1364s/iter; left time: 1544.3428s
Epoch: 6 cost time: 62.99959969520569
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.971411 --> -0.978272).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0180550
	speed: 0.5662s/iter; left time: 6317.3444s
	iters: 200, epoch: 7 | loss: 0.0021470
	speed: 0.1370s/iter; left time: 1514.6309s
	iters: 300, epoch: 7 | loss: 0.0016704
	speed: 0.1307s/iter; left time: 1431.6466s
	iters: 400, epoch: 7 | loss: 0.2112641
	speed: 0.1242s/iter; left time: 1348.8203s
Epoch: 7 cost time: 60.841100215911865
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0097313
	speed: 0.4736s/iter; left time: 5061.5788s
	iters: 200, epoch: 8 | loss: 0.0066206
	speed: 0.1193s/iter; left time: 1263.4940s
	iters: 300, epoch: 8 | loss: 0.0017189
	speed: 0.1189s/iter; left time: 1247.2438s
	iters: 400, epoch: 8 | loss: 0.0041585
	speed: 0.1166s/iter; left time: 1211.0550s
Epoch: 8 cost time: 55.33406710624695
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0373333
	speed: 0.5295s/iter; left time: 5410.9009s
	iters: 200, epoch: 9 | loss: 0.0775241
	speed: 0.1343s/iter; left time: 1358.5147s
	iters: 300, epoch: 9 | loss: 0.0021204
	speed: 0.1342s/iter; left time: 1345.0163s
	iters: 400, epoch: 9 | loss: 0.0025080
	speed: 0.1345s/iter; left time: 1334.1238s
Epoch: 9 cost time: 63.336427450180054
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003321
	speed: 0.5382s/iter; left time: 5247.4707s
	iters: 200, epoch: 10 | loss: 0.0006434
	speed: 0.1334s/iter; left time: 1286.9750s
	iters: 300, epoch: 10 | loss: 0.0051201
	speed: 0.1324s/iter; left time: 1264.8849s
	iters: 400, epoch: 10 | loss: 0.0001965
	speed: 0.1268s/iter; left time: 1198.4690s
Epoch: 10 cost time: 62.372623443603516
Epoch: 10, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1217459
	speed: 0.5938s/iter; left time: 5510.8164s
	iters: 200, epoch: 11 | loss: 0.0000848
	speed: 0.1420s/iter; left time: 1303.4587s
	iters: 300, epoch: 11 | loss: 0.0148286
	speed: 0.1413s/iter; left time: 1283.0562s
	iters: 400, epoch: 11 | loss: 0.0003394
	speed: 0.1457s/iter; left time: 1308.8718s
Epoch: 11 cost time: 67.58466911315918
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0004459
	speed: 0.6281s/iter; left time: 5534.7466s
	iters: 200, epoch: 12 | loss: 1.2164909
	speed: 0.1498s/iter; left time: 1305.0221s
	iters: 300, epoch: 12 | loss: 0.0007175
	speed: 0.1499s/iter; left time: 1290.5181s
	iters: 400, epoch: 12 | loss: 0.0078655
	speed: 0.1432s/iter; left time: 1218.8642s
Epoch: 12 cost time: 69.27425837516785
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0018535
	speed: 0.6005s/iter; left time: 5009.8311s
	iters: 200, epoch: 13 | loss: 0.0004203
	speed: 0.1448s/iter; left time: 1193.4295s
	iters: 300, epoch: 13 | loss: 0.0010891
	speed: 0.1412s/iter; left time: 1149.4446s
	iters: 400, epoch: 13 | loss: 0.0001539
	speed: 0.1371s/iter; left time: 1102.9797s
Epoch: 13 cost time: 66.59428977966309
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000436
	speed: 0.5655s/iter; left time: 4452.7966s
	iters: 200, epoch: 14 | loss: 0.0001915
	speed: 0.1465s/iter; left time: 1138.6851s
	iters: 300, epoch: 14 | loss: 0.0002636
	speed: 0.1530s/iter; left time: 1174.2440s
	iters: 400, epoch: 14 | loss: 0.0034305
	speed: 0.1513s/iter; left time: 1145.7437s
Epoch: 14 cost time: 69.4376060962677
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0004449
	speed: 0.6413s/iter; left time: 4748.6151s
	iters: 200, epoch: 15 | loss: 0.0000595
	speed: 0.1574s/iter; left time: 1150.0252s
	iters: 300, epoch: 15 | loss: 0.0068493
	speed: 0.1554s/iter; left time: 1119.5665s
	iters: 400, epoch: 15 | loss: 0.0004072
	speed: 0.1570s/iter; left time: 1115.8011s
Epoch: 15 cost time: 73.63553738594055
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002983
	speed: 0.6412s/iter; left time: 4447.3961s
	iters: 200, epoch: 16 | loss: 0.0213383
	speed: 0.1443s/iter; left time: 986.4744s
	iters: 300, epoch: 16 | loss: 0.0010343
	speed: 0.1395s/iter; left time: 939.5562s
	iters: 400, epoch: 16 | loss: 0.0030824
	speed: 0.1363s/iter; left time: 904.5081s
Epoch: 16 cost time: 66.2940878868103
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 16531466
model size : 65.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1198710
	speed: 0.4823s/iter; left time: 6738.2024s
	iters: 200, epoch: 1 | loss: 0.0732518
	speed: 0.4912s/iter; left time: 6813.1753s
	iters: 300, epoch: 1 | loss: 0.0668737
	speed: 0.4878s/iter; left time: 6718.1026s
	iters: 400, epoch: 1 | loss: 0.0709995
	speed: 0.5000s/iter; left time: 6835.9110s
Epoch: 1 cost time: 229.20860981941223
Epoch: 1, Steps: 469 | Train Loss: 0.336 Vali Loss: 0.221 Vali Acc: 0.945 Test Loss: 0.221 Test Acc: 0.945
Validation loss decreased (inf --> -0.944538).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0531723
	speed: 1.5390s/iter; left time: 20779.8052s
	iters: 200, epoch: 2 | loss: 0.0621234
	speed: 0.5172s/iter; left time: 6931.6088s
	iters: 300, epoch: 2 | loss: 0.1231081
	speed: 0.5766s/iter; left time: 7669.8560s
	iters: 400, epoch: 2 | loss: 0.0401781
	speed: 0.5525s/iter; left time: 7293.8398s
Epoch: 2 cost time: 249.2286412715912
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.192 Vali Acc: 0.945 Test Loss: 0.192 Test Acc: 0.945
Validation loss decreased (-0.944538 --> -0.945110).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0519887
	speed: 1.7404s/iter; left time: 22682.6664s
	iters: 200, epoch: 3 | loss: 0.0203911
	speed: 0.5723s/iter; left time: 7401.0486s
	iters: 300, epoch: 3 | loss: 0.1537393
	speed: 0.5609s/iter; left time: 7198.5741s
	iters: 400, epoch: 3 | loss: 0.0038167
	speed: 0.5668s/iter; left time: 7217.0126s
Epoch: 3 cost time: 263.33722615242004
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.945110 --> -0.948254).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0208275
	speed: 1.7694s/iter; left time: 22230.5762s
	iters: 200, epoch: 4 | loss: 0.0023909
	speed: 0.4940s/iter; left time: 6157.8242s
	iters: 300, epoch: 4 | loss: 0.2834091
	speed: 0.4804s/iter; left time: 5940.0298s
	iters: 400, epoch: 4 | loss: 0.0050201
	speed: 0.4767s/iter; left time: 5846.1390s
Epoch: 4 cost time: 231.37474966049194
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.948254 --> -0.971697).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0011733
	speed: 1.5119s/iter; left time: 18286.5745s
	iters: 200, epoch: 5 | loss: 0.0031792
	speed: 0.4474s/iter; left time: 5366.2366s
	iters: 300, epoch: 5 | loss: 0.0106389
	speed: 0.4065s/iter; left time: 4835.5355s
	iters: 400, epoch: 5 | loss: 0.0032271
	speed: 0.4163s/iter; left time: 4909.8285s
Epoch: 5 cost time: 204.93350529670715
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0021881
	speed: 1.4720s/iter; left time: 17113.3793s
	iters: 200, epoch: 6 | loss: 0.0020319
	speed: 0.5043s/iter; left time: 5813.0149s
	iters: 300, epoch: 6 | loss: 0.0299299
	speed: 0.4605s/iter; left time: 5261.5144s
	iters: 400, epoch: 6 | loss: 0.0626600
	speed: 0.4846s/iter; left time: 5489.0173s
Epoch: 6 cost time: 230.25254249572754
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.325 Vali Acc: 0.939 Test Loss: 0.325 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0857807
	speed: 1.5791s/iter; left time: 17617.9528s
	iters: 200, epoch: 7 | loss: 0.0053373
	speed: 0.5093s/iter; left time: 5631.2224s
	iters: 300, epoch: 7 | loss: 0.0243223
	speed: 0.4727s/iter; left time: 5179.8634s
	iters: 400, epoch: 7 | loss: 0.0024869
	speed: 0.4798s/iter; left time: 5209.1867s
Epoch: 7 cost time: 230.50614953041077
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.971697 --> -0.978558).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004200
	speed: 1.4844s/iter; left time: 15865.0736s
	iters: 200, epoch: 8 | loss: 0.0004829
	speed: 0.4629s/iter; left time: 4900.8122s
	iters: 300, epoch: 8 | loss: 0.0009875
	speed: 0.4205s/iter; left time: 4410.5378s
	iters: 400, epoch: 8 | loss: 0.0002748
	speed: 0.4006s/iter; left time: 4161.2064s
Epoch: 8 cost time: 198.62933230400085
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0014122
	speed: 1.3274s/iter; left time: 13564.1935s
	iters: 200, epoch: 9 | loss: 0.2180691
	speed: 0.4306s/iter; left time: 4357.1248s
	iters: 300, epoch: 9 | loss: 0.0007946
	speed: 0.4419s/iter; left time: 4427.8391s
	iters: 400, epoch: 9 | loss: 0.2585322
	speed: 0.4037s/iter; left time: 4003.8830s
Epoch: 9 cost time: 196.05277705192566
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0061866
	speed: 1.5329s/iter; left time: 14945.7495s
	iters: 200, epoch: 10 | loss: 0.0001281
	speed: 0.4771s/iter; left time: 4604.3919s
	iters: 300, epoch: 10 | loss: 0.0002656
	speed: 0.4991s/iter; left time: 4766.6597s
	iters: 400, epoch: 10 | loss: 0.2197392
	speed: 0.4569s/iter; left time: 4317.8341s
Epoch: 10 cost time: 220.11132788658142
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0005429
	speed: 1.5281s/iter; left time: 14182.0508s
	iters: 200, epoch: 11 | loss: 0.0004278
	speed: 0.4619s/iter; left time: 4240.6923s
	iters: 300, epoch: 11 | loss: 0.0009341
	speed: 0.4963s/iter; left time: 4507.3417s
	iters: 400, epoch: 11 | loss: 0.0005939
	speed: 0.4728s/iter; left time: 4245.8882s
Epoch: 11 cost time: 215.29359006881714
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0080114
	speed: 1.3141s/iter; left time: 11580.1482s
	iters: 200, epoch: 12 | loss: 0.0061148
	speed: 0.3825s/iter; left time: 3332.2557s
	iters: 300, epoch: 12 | loss: 0.0016515
	speed: 0.4137s/iter; left time: 3563.0745s
	iters: 400, epoch: 12 | loss: 0.0001164
	speed: 0.4123s/iter; left time: 3509.5236s
Epoch: 12 cost time: 187.32984232902527
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0004029
	speed: 1.1731s/iter; left time: 9787.2329s
	iters: 200, epoch: 13 | loss: 0.0000207
	speed: 0.4454s/iter; left time: 3671.3730s
	iters: 300, epoch: 13 | loss: 0.0118189
	speed: 0.4670s/iter; left time: 3802.9902s
	iters: 400, epoch: 13 | loss: 0.0034509
	speed: 0.4796s/iter; left time: 3857.8110s
Epoch: 13 cost time: 208.15284848213196
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0004521
	speed: 1.6295s/iter; left time: 12830.5452s
	iters: 200, epoch: 14 | loss: 0.0009664
	speed: 0.5043s/iter; left time: 3920.7833s
	iters: 300, epoch: 14 | loss: 0.0021363
	speed: 0.4872s/iter; left time: 3739.1039s
	iters: 400, epoch: 14 | loss: 0.0004506
	speed: 0.4861s/iter; left time: 3681.5206s
Epoch: 14 cost time: 234.7059245109558
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.935 Test Loss: 0.471 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0002576
	speed: 1.6382s/iter; left time: 12131.0571s
	iters: 200, epoch: 15 | loss: 0.0892301
	speed: 0.4789s/iter; left time: 3498.5028s
	iters: 300, epoch: 15 | loss: 0.0774883
	speed: 0.4426s/iter; left time: 3188.7235s
	iters: 400, epoch: 15 | loss: 0.0005192
	speed: 0.4474s/iter; left time: 3178.5107s
Epoch: 15 cost time: 216.44200658798218
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0305283
	speed: 1.3815s/iter; left time: 9582.2601s
	iters: 200, epoch: 16 | loss: 0.0014457
	speed: 0.4496s/iter; left time: 3073.3054s
	iters: 300, epoch: 16 | loss: 0.3768921
	speed: 0.4452s/iter; left time: 2998.8710s
	iters: 400, epoch: 16 | loss: 0.0002501
	speed: 0.4336s/iter; left time: 2877.2721s
Epoch: 16 cost time: 203.44032311439514
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0989886
	speed: 1.3956s/iter; left time: 9025.4919s
	iters: 200, epoch: 17 | loss: 0.0002532
	speed: 0.5394s/iter; left time: 3434.1641s
	iters: 300, epoch: 17 | loss: 0.0016097
	speed: 0.5203s/iter; left time: 3260.8105s
	iters: 400, epoch: 17 | loss: 0.0004534
	speed: 0.5112s/iter; left time: 3152.4013s
Epoch: 17 cost time: 238.9933123588562
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 28131338
model size : 109.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3453182
	speed: 0.2022s/iter; left time: 2824.5499s
	iters: 200, epoch: 1 | loss: 0.0907779
	speed: 0.1860s/iter; left time: 2579.4814s
	iters: 300, epoch: 1 | loss: 0.0211540
	speed: 0.1846s/iter; left time: 2542.5012s
	iters: 400, epoch: 1 | loss: 0.2453165
	speed: 0.1880s/iter; left time: 2569.5709s
Epoch: 1 cost time: 89.00564384460449
Epoch: 1, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (inf --> -0.961977).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0011947
	speed: 0.7437s/iter; left time: 10041.6599s
	iters: 200, epoch: 2 | loss: 0.0044109
	speed: 0.1991s/iter; left time: 2667.9716s
	iters: 300, epoch: 2 | loss: 0.1047659
	speed: 0.1998s/iter; left time: 2658.1056s
	iters: 400, epoch: 2 | loss: 0.4032208
	speed: 0.2002s/iter; left time: 2643.1961s
Epoch: 2 cost time: 93.19298315048218
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.961977 --> -0.970554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0396815
	speed: 0.6770s/iter; left time: 8823.8355s
	iters: 200, epoch: 3 | loss: 0.0016704
	speed: 0.1666s/iter; left time: 2154.8787s
	iters: 300, epoch: 3 | loss: 0.0191329
	speed: 0.1668s/iter; left time: 2140.5093s
	iters: 400, epoch: 3 | loss: 0.0028532
	speed: 0.1809s/iter; left time: 2303.8426s
Epoch: 3 cost time: 80.91650152206421
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0412980
	speed: 0.6818s/iter; left time: 8565.9913s
	iters: 200, epoch: 4 | loss: 0.0013827
	speed: 0.1797s/iter; left time: 2239.9956s
	iters: 300, epoch: 4 | loss: 0.0059163
	speed: 0.1644s/iter; left time: 2032.3716s
	iters: 400, epoch: 4 | loss: 0.0346193
	speed: 0.1590s/iter; left time: 1949.9719s
Epoch: 4 cost time: 79.48496222496033
Epoch: 4, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.970554 --> -0.974270).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0019396
	speed: 0.5999s/iter; left time: 7255.3361s
	iters: 200, epoch: 5 | loss: 0.0019898
	speed: 0.1729s/iter; left time: 2073.7023s
	iters: 300, epoch: 5 | loss: 0.0086310
	speed: 0.1747s/iter; left time: 2077.7169s
	iters: 400, epoch: 5 | loss: 0.0111987
	speed: 0.1744s/iter; left time: 2057.0735s
Epoch: 5 cost time: 80.66974711418152
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0021193
	speed: 0.6424s/iter; left time: 7468.1229s
	iters: 200, epoch: 6 | loss: 0.0023109
	speed: 0.1599s/iter; left time: 1842.9814s
	iters: 300, epoch: 6 | loss: 0.0007915
	speed: 0.1499s/iter; left time: 1712.4277s
	iters: 400, epoch: 6 | loss: 0.0003687
	speed: 0.1645s/iter; left time: 1863.5277s
Epoch: 6 cost time: 75.5176568031311
Epoch: 6, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0005301
	speed: 0.7353s/iter; left time: 8204.2915s
	iters: 200, epoch: 7 | loss: 0.0877059
	speed: 0.2027s/iter; left time: 2241.6954s
	iters: 300, epoch: 7 | loss: 0.0014987
	speed: 0.2018s/iter; left time: 2211.3169s
	iters: 400, epoch: 7 | loss: 0.0010713
	speed: 0.2029s/iter; left time: 2202.5378s
Epoch: 7 cost time: 95.28720331192017
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.974556).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0453804
	speed: 0.7102s/iter; left time: 7590.9450s
	iters: 200, epoch: 8 | loss: 0.0001919
	speed: 0.1854s/iter; left time: 1963.1745s
	iters: 300, epoch: 8 | loss: 0.0016031
	speed: 0.1839s/iter; left time: 1928.7489s
	iters: 400, epoch: 8 | loss: 0.0033905
	speed: 0.1913s/iter; left time: 1987.1496s
Epoch: 8 cost time: 88.13082933425903
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0240696
	speed: 0.7486s/iter; left time: 7650.2399s
	iters: 200, epoch: 9 | loss: 0.0114508
	speed: 0.1945s/iter; left time: 1968.0158s
	iters: 300, epoch: 9 | loss: 0.0001371
	speed: 0.1946s/iter; left time: 1949.6806s
	iters: 400, epoch: 9 | loss: 0.0867378
	speed: 0.1933s/iter; left time: 1917.2196s
Epoch: 9 cost time: 91.54757142066956
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2441590
	speed: 0.7263s/iter; left time: 7081.1015s
	iters: 200, epoch: 10 | loss: 0.0007284
	speed: 0.2009s/iter; left time: 1938.4978s
	iters: 300, epoch: 10 | loss: 0.0003093
	speed: 0.2051s/iter; left time: 1958.4224s
	iters: 400, epoch: 10 | loss: 0.0010556
	speed: 0.2070s/iter; left time: 1955.8252s
Epoch: 10 cost time: 94.92468786239624
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0917885
	speed: 0.7016s/iter; left time: 6511.9758s
	iters: 200, epoch: 11 | loss: 0.0001924
	speed: 0.1647s/iter; left time: 1511.7109s
	iters: 300, epoch: 11 | loss: 0.0017208
	speed: 0.1543s/iter; left time: 1401.5081s
	iters: 400, epoch: 11 | loss: 0.0043828
	speed: 0.1560s/iter; left time: 1401.1301s
Epoch: 11 cost time: 75.91799998283386
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1454358
	speed: 0.6240s/iter; left time: 5499.0769s
	iters: 200, epoch: 12 | loss: 0.0014530
	speed: 0.1724s/iter; left time: 1501.8368s
	iters: 300, epoch: 12 | loss: 0.0011116
	speed: 0.1716s/iter; left time: 1478.0802s
	iters: 400, epoch: 12 | loss: 0.0000408
	speed: 0.1723s/iter; left time: 1466.7689s
Epoch: 12 cost time: 81.02465891838074
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975985).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0029164
	speed: 0.6118s/iter; left time: 5104.5594s
	iters: 200, epoch: 13 | loss: 0.0183501
	speed: 0.1546s/iter; left time: 1274.4153s
	iters: 300, epoch: 13 | loss: 0.0822757
	speed: 0.1575s/iter; left time: 1282.6068s
	iters: 400, epoch: 13 | loss: 0.0018509
	speed: 0.1566s/iter; left time: 1259.4869s
Epoch: 13 cost time: 75.25232410430908
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001375
	speed: 0.6702s/iter; left time: 5277.4279s
	iters: 200, epoch: 14 | loss: 0.0002051
	speed: 0.1755s/iter; left time: 1364.7162s
	iters: 300, epoch: 14 | loss: 0.0001070
	speed: 0.1764s/iter; left time: 1353.3216s
	iters: 400, epoch: 14 | loss: 0.0003929
	speed: 0.1608s/iter; left time: 1217.6011s
Epoch: 14 cost time: 79.90533828735352
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000824
	speed: 0.6148s/iter; left time: 4552.7191s
	iters: 200, epoch: 15 | loss: 0.0074678
	speed: 0.1618s/iter; left time: 1181.7319s
	iters: 300, epoch: 15 | loss: 0.0006953
	speed: 0.1706s/iter; left time: 1229.2273s
	iters: 400, epoch: 15 | loss: 0.0003958
	speed: 0.1731s/iter; left time: 1229.5255s
Epoch: 15 cost time: 79.53169703483582
Epoch: 15, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977129).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2632591
	speed: 0.6643s/iter; left time: 4607.8447s
	iters: 200, epoch: 16 | loss: 0.0006573
	speed: 0.1620s/iter; left time: 1107.6007s
	iters: 300, epoch: 16 | loss: 0.0001921
	speed: 0.1394s/iter; left time: 939.1150s
	iters: 400, epoch: 16 | loss: 0.0213384
	speed: 0.1138s/iter; left time: 755.1693s
Epoch: 16 cost time: 67.09470796585083
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0058559
	speed: 0.6771s/iter; left time: 4379.0601s
	iters: 200, epoch: 17 | loss: 0.0035622
	speed: 0.2025s/iter; left time: 1289.5370s
	iters: 300, epoch: 17 | loss: 0.0003538
	speed: 0.1493s/iter; left time: 935.9412s
	iters: 400, epoch: 17 | loss: 0.0001524
	speed: 0.1713s/iter; left time: 1056.2872s
Epoch: 17 cost time: 85.90830659866333
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001590
	speed: 0.7183s/iter; left time: 4308.5776s
	iters: 200, epoch: 18 | loss: 0.0003010
	speed: 0.1762s/iter; left time: 1039.2377s
	iters: 300, epoch: 18 | loss: 0.0001501
	speed: 0.1816s/iter; left time: 1052.9464s
	iters: 400, epoch: 18 | loss: 0.0006532
	speed: 0.1939s/iter; left time: 1105.0245s
Epoch: 18 cost time: 86.58178853988647
Epoch: 18, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0006202
	speed: 0.6913s/iter; left time: 3822.3066s
	iters: 200, epoch: 19 | loss: 0.0002472
	speed: 0.1750s/iter; left time: 950.1215s
	iters: 300, epoch: 19 | loss: 0.0004625
	speed: 0.1908s/iter; left time: 1016.8758s
	iters: 400, epoch: 19 | loss: 0.0000375
	speed: 0.1947s/iter; left time: 1018.3386s
Epoch: 19 cost time: 87.06716918945312
Epoch: 19, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000491
	speed: 0.6872s/iter; left time: 3476.9956s
	iters: 200, epoch: 20 | loss: 0.0000209
	speed: 0.1920s/iter; left time: 952.1176s
	iters: 300, epoch: 20 | loss: 0.0008086
	speed: 0.2010s/iter; left time: 976.9075s
	iters: 400, epoch: 20 | loss: 0.0002933
	speed: 0.2016s/iter; left time: 959.8004s
Epoch: 20 cost time: 91.37122130393982
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0005806
	speed: 0.6990s/iter; left time: 3209.1492s
	iters: 200, epoch: 21 | loss: 0.0026315
	speed: 0.2022s/iter; left time: 908.2057s
	iters: 300, epoch: 21 | loss: 0.0005447
	speed: 0.2029s/iter; left time: 890.9552s
	iters: 400, epoch: 21 | loss: 0.0005115
	speed: 0.2030s/iter; left time: 871.2274s
Epoch: 21 cost time: 91.82279849052429
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000250
	speed: 0.6918s/iter; left time: 2851.5529s
	iters: 200, epoch: 22 | loss: 0.0000553
	speed: 0.1968s/iter; left time: 791.3568s
	iters: 300, epoch: 22 | loss: 0.0023953
	speed: 0.1979s/iter; left time: 776.1935s
	iters: 400, epoch: 22 | loss: 0.0002469
	speed: 0.1856s/iter; left time: 709.3410s
Epoch: 22 cost time: 89.11691451072693
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0002917
	speed: 0.6927s/iter; left time: 2530.5970s
	iters: 200, epoch: 23 | loss: 0.0000139
	speed: 0.1960s/iter; left time: 696.2263s
	iters: 300, epoch: 23 | loss: 0.0000904
	speed: 0.1937s/iter; left time: 668.7462s
	iters: 400, epoch: 23 | loss: 0.0001719
	speed: 0.1793s/iter; left time: 601.0859s
Epoch: 23 cost time: 89.0768723487854
Epoch: 23, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0001438
	speed: 0.6993s/iter; left time: 2226.4378s
	iters: 200, epoch: 24 | loss: 0.0001359
	speed: 0.2014s/iter; left time: 620.9666s
	iters: 300, epoch: 24 | loss: 0.0006441
	speed: 0.1857s/iter; left time: 554.1992s
	iters: 400, epoch: 24 | loss: 0.0043321
	speed: 0.1796s/iter; left time: 517.9257s
Epoch: 24 cost time: 88.69987344741821
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.978272).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0001556
	speed: 0.6937s/iter; left time: 1883.4698s
	iters: 200, epoch: 25 | loss: 0.0002221
	speed: 0.1740s/iter; left time: 454.9665s
	iters: 300, epoch: 25 | loss: 0.0006418
	speed: 0.1618s/iter; left time: 406.9381s
	iters: 400, epoch: 25 | loss: 0.0000833
	speed: 0.1585s/iter; left time: 382.8693s
Epoch: 25 cost time: 78.98757410049438
Epoch: 25, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000961
	speed: 0.6411s/iter; left time: 1439.9612s
	iters: 200, epoch: 26 | loss: 0.0000552
	speed: 0.1584s/iter; left time: 339.9409s
	iters: 300, epoch: 26 | loss: 0.0000158
	speed: 0.1548s/iter; left time: 316.7880s
	iters: 400, epoch: 26 | loss: 0.0002021
	speed: 0.1560s/iter; left time: 303.6700s
Epoch: 26 cost time: 75.85090374946594
Epoch: 26, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.982275).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0025087
	speed: 0.6468s/iter; left time: 1149.3128s
	iters: 200, epoch: 27 | loss: 0.0001454
	speed: 0.1574s/iter; left time: 264.0282s
	iters: 300, epoch: 27 | loss: 0.1040027
	speed: 0.1527s/iter; left time: 240.7495s
	iters: 400, epoch: 27 | loss: 0.0022902
	speed: 0.1513s/iter; left time: 223.3970s
Epoch: 27 cost time: 75.39218878746033
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000654
	speed: 0.6470s/iter; left time: 846.2558s
	iters: 200, epoch: 28 | loss: 0.0036510
	speed: 0.1582s/iter; left time: 191.0505s
	iters: 300, epoch: 28 | loss: 0.0000628
	speed: 0.1589s/iter; left time: 176.1116s
	iters: 400, epoch: 28 | loss: 0.0003707
	speed: 0.1663s/iter; left time: 167.6009s
Epoch: 28 cost time: 77.07827806472778
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0004215
	speed: 0.6399s/iter; left time: 536.8922s
	iters: 200, epoch: 29 | loss: 0.0006808
	speed: 0.1544s/iter; left time: 114.0833s
	iters: 300, epoch: 29 | loss: 0.0001244
	speed: 0.1534s/iter; left time: 98.0380s
	iters: 400, epoch: 29 | loss: 0.0001627
	speed: 0.1744s/iter; left time: 94.0129s
Epoch: 29 cost time: 76.42656540870667
Epoch: 29, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000124
	speed: 0.6210s/iter; left time: 229.7859s
	iters: 200, epoch: 30 | loss: 0.0006323
	speed: 0.1633s/iter; left time: 44.0889s
	iters: 300, epoch: 30 | loss: 0.0000248
	speed: 0.1814s/iter; left time: 30.8378s
	iters: 400, epoch: 30 | loss: 0.0303187
	speed: 0.1933s/iter; left time: 13.5294s
Epoch: 30 cost time: 82.92128992080688
Epoch: 30, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 8272394
model size : 34.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1290539
	speed: 0.4640s/iter; left time: 6482.2708s
	iters: 200, epoch: 1 | loss: 0.0900730
	speed: 0.4561s/iter; left time: 6326.7440s
	iters: 300, epoch: 1 | loss: 0.1020421
	speed: 0.4398s/iter; left time: 6056.6594s
	iters: 400, epoch: 1 | loss: 0.0384555
	speed: 0.4345s/iter; left time: 5940.5828s
Epoch: 1 cost time: 211.47736024856567
Epoch: 1, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (inf --> -0.948826).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0911953
	speed: 1.5065s/iter; left time: 20340.8010s
	iters: 200, epoch: 2 | loss: 0.2608838
	speed: 0.4518s/iter; left time: 6054.8097s
	iters: 300, epoch: 2 | loss: 0.1869320
	speed: 0.4593s/iter; left time: 6109.6848s
	iters: 400, epoch: 2 | loss: 0.0861717
	speed: 0.4269s/iter; left time: 5635.4450s
Epoch: 2 cost time: 206.43955278396606
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.948826 --> -0.971983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0190272
	speed: 1.4863s/iter; left time: 19371.2750s
	iters: 200, epoch: 3 | loss: 0.1330285
	speed: 0.4790s/iter; left time: 6194.5443s
	iters: 300, epoch: 3 | loss: 0.1646539
	speed: 0.4510s/iter; left time: 5787.6036s
	iters: 400, epoch: 3 | loss: 0.0012075
	speed: 0.4450s/iter; left time: 5666.2879s
Epoch: 3 cost time: 212.37727046012878
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0278464
	speed: 1.4218s/iter; left time: 17863.1685s
	iters: 200, epoch: 4 | loss: 0.0032987
	speed: 0.4103s/iter; left time: 5113.7919s
	iters: 300, epoch: 4 | loss: 0.1429887
	speed: 0.4196s/iter; left time: 5187.9265s
	iters: 400, epoch: 4 | loss: 0.0003012
	speed: 0.4410s/iter; left time: 5408.0560s
Epoch: 4 cost time: 199.49558806419373
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0085942
	speed: 1.4115s/iter; left time: 17072.1025s
	iters: 200, epoch: 5 | loss: 0.0485005
	speed: 0.4255s/iter; left time: 5103.3001s
	iters: 300, epoch: 5 | loss: 0.0212975
	speed: 0.4689s/iter; left time: 5577.4965s
	iters: 400, epoch: 5 | loss: 0.0067845
	speed: 0.4455s/iter; left time: 5254.1090s
Epoch: 5 cost time: 204.08990240097046
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0008255
	speed: 1.4226s/iter; left time: 16538.9482s
	iters: 200, epoch: 6 | loss: 0.0009992
	speed: 0.4221s/iter; left time: 4864.6327s
	iters: 300, epoch: 6 | loss: 0.0011351
	speed: 0.4041s/iter; left time: 4616.8643s
	iters: 400, epoch: 6 | loss: 0.1385374
	speed: 0.4087s/iter; left time: 4628.6974s
Epoch: 6 cost time: 197.15584754943848
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0157320
	speed: 1.4278s/iter; left time: 15930.0040s
	iters: 200, epoch: 7 | loss: 0.0011028
	speed: 0.4071s/iter; left time: 4500.9667s
	iters: 300, epoch: 7 | loss: 0.0032890
	speed: 0.3923s/iter; left time: 4298.1786s
	iters: 400, epoch: 7 | loss: 0.0006778
	speed: 0.3938s/iter; left time: 4275.2669s
Epoch: 7 cost time: 184.91479229927063
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.971983 --> -0.976271).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003482
	speed: 1.2683s/iter; left time: 13555.8615s
	iters: 200, epoch: 8 | loss: 0.0474485
	speed: 0.3760s/iter; left time: 3981.4247s
	iters: 300, epoch: 8 | loss: 0.0008002
	speed: 0.3791s/iter; left time: 3975.8762s
	iters: 400, epoch: 8 | loss: 0.1113992
	speed: 0.3788s/iter; left time: 3934.7520s
Epoch: 8 cost time: 181.1966745853424
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.976271 --> -0.977701).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2285879
	speed: 1.3979s/iter; left time: 14285.5843s
	iters: 200, epoch: 9 | loss: 0.2617990
	speed: 0.4159s/iter; left time: 4208.7310s
	iters: 300, epoch: 9 | loss: 0.0012756
	speed: 0.4442s/iter; left time: 4450.8899s
	iters: 400, epoch: 9 | loss: 0.0022766
	speed: 0.4201s/iter; left time: 4167.1577s
Epoch: 9 cost time: 196.08393716812134
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1386499
	speed: 1.2887s/iter; left time: 12564.8680s
	iters: 200, epoch: 10 | loss: 0.0006484
	speed: 0.4059s/iter; left time: 3916.8344s
	iters: 300, epoch: 10 | loss: 0.0005834
	speed: 0.3728s/iter; left time: 3559.8263s
	iters: 400, epoch: 10 | loss: 0.0232376
	speed: 0.4246s/iter; left time: 4012.3996s
Epoch: 10 cost time: 191.6531126499176
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0296484
	speed: 1.4760s/iter; left time: 13698.9249s
	iters: 200, epoch: 11 | loss: 0.0015123
	speed: 0.4222s/iter; left time: 3876.2476s
	iters: 300, epoch: 11 | loss: 0.0007829
	speed: 0.4521s/iter; left time: 4105.6218s
	iters: 400, epoch: 11 | loss: 0.0024582
	speed: 0.4470s/iter; left time: 4014.1027s
Epoch: 11 cost time: 202.88841557502747
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.977701 --> -0.981703).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0054292
	speed: 1.4714s/iter; left time: 12965.9178s
	iters: 200, epoch: 12 | loss: 0.0002097
	speed: 0.4338s/iter; left time: 3779.5768s
	iters: 300, epoch: 12 | loss: 0.0001203
	speed: 0.4176s/iter; left time: 3596.2902s
	iters: 400, epoch: 12 | loss: 0.0000412
	speed: 0.4405s/iter; left time: 3749.2747s
Epoch: 12 cost time: 205.38448405265808
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0042837
	speed: 1.3164s/iter; left time: 10982.4633s
	iters: 200, epoch: 13 | loss: 0.0000581
	speed: 0.4056s/iter; left time: 3343.6287s
	iters: 300, epoch: 13 | loss: 0.0039980
	speed: 0.4054s/iter; left time: 3301.4599s
	iters: 400, epoch: 13 | loss: 0.0035885
	speed: 0.3761s/iter; left time: 3024.9915s
Epoch: 13 cost time: 181.5971064567566
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0001108
	speed: 1.3841s/iter; left time: 10898.0144s
	iters: 200, epoch: 14 | loss: 0.0029763
	speed: 0.3926s/iter; left time: 3051.7509s
	iters: 300, epoch: 14 | loss: 0.0007950
	speed: 0.3950s/iter; left time: 3031.3143s
	iters: 400, epoch: 14 | loss: 0.0003435
	speed: 0.4116s/iter; left time: 3117.0918s
Epoch: 14 cost time: 190.62457919120789
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001303
	speed: 1.3144s/iter; left time: 9733.1854s
	iters: 200, epoch: 15 | loss: 0.0002062
	speed: 0.4067s/iter; left time: 2970.6018s
	iters: 300, epoch: 15 | loss: 0.0000462
	speed: 0.3352s/iter; left time: 2415.1017s
	iters: 400, epoch: 15 | loss: 0.0055749
	speed: 0.3305s/iter; left time: 2348.3580s
Epoch: 15 cost time: 172.01338171958923
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0105400
	speed: 1.1687s/iter; left time: 8106.0164s
	iters: 200, epoch: 16 | loss: 0.0005306
	speed: 0.3192s/iter; left time: 2182.1581s
	iters: 300, epoch: 16 | loss: 0.0003200
	speed: 0.3169s/iter; left time: 2134.8068s
	iters: 400, epoch: 16 | loss: 0.0001901
	speed: 0.3562s/iter; left time: 2363.6617s
Epoch: 16 cost time: 156.7852065563202
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0219869
	speed: 1.1104s/iter; left time: 7181.0176s
	iters: 200, epoch: 17 | loss: 0.4671445
	speed: 0.2969s/iter; left time: 1890.2068s
	iters: 300, epoch: 17 | loss: 0.0421045
	speed: 0.3314s/iter; left time: 2076.7183s
	iters: 400, epoch: 17 | loss: 0.0006985
	speed: 0.3146s/iter; left time: 1940.0475s
Epoch: 17 cost time: 144.76391077041626
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000796
	speed: 1.3129s/iter; left time: 7874.8843s
	iters: 200, epoch: 18 | loss: 0.0004237
	speed: 0.4320s/iter; left time: 2548.2176s
	iters: 300, epoch: 18 | loss: 0.0002490
	speed: 0.4145s/iter; left time: 2403.4160s
	iters: 400, epoch: 18 | loss: 0.0002576
	speed: 0.4065s/iter; left time: 2316.0012s
Epoch: 18 cost time: 195.97096633911133
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0020353
	speed: 1.4075s/iter; left time: 7782.1811s
	iters: 200, epoch: 19 | loss: 0.0019875
	speed: 0.4065s/iter; left time: 2207.1263s
	iters: 300, epoch: 19 | loss: 0.0000215
	speed: 0.4162s/iter; left time: 2218.1729s
	iters: 400, epoch: 19 | loss: 0.0008022
	speed: 0.4240s/iter; left time: 2217.2565s
Epoch: 19 cost time: 195.6747341156006
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.3667732
	speed: 1.3329s/iter; left time: 6744.7008s
	iters: 200, epoch: 20 | loss: 0.0003903
	speed: 0.3767s/iter; left time: 1868.4692s
	iters: 300, epoch: 20 | loss: 0.0002528
	speed: 0.3714s/iter; left time: 1805.0653s
	iters: 400, epoch: 20 | loss: 0.0007489
	speed: 0.3512s/iter; left time: 1671.7679s
Epoch: 20 cost time: 172.05139756202698
Epoch: 20, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000189
	speed: 1.2550s/iter; left time: 5761.6287s
	iters: 200, epoch: 21 | loss: 0.0001134
	speed: 0.3415s/iter; left time: 1533.7894s
	iters: 300, epoch: 21 | loss: 0.0000308
	speed: 0.3969s/iter; left time: 1742.8215s
	iters: 400, epoch: 21 | loss: 0.0000306
	speed: 0.4080s/iter; left time: 1750.9071s
Epoch: 21 cost time: 179.50474381446838
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 28131338
model size : 109.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3933573
	speed: 0.1884s/iter; left time: 2631.9897s
	iters: 200, epoch: 1 | loss: 0.0819360
	speed: 0.1732s/iter; left time: 2401.9746s
	iters: 300, epoch: 1 | loss: 0.0115598
	speed: 0.1633s/iter; left time: 2248.8139s
	iters: 400, epoch: 1 | loss: 0.0121642
	speed: 0.1544s/iter; left time: 2110.7649s
Epoch: 1 cost time: 76.81581974029541
Epoch: 1, Steps: 469 | Train Loss: 0.352 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
Validation loss decreased (inf --> -0.948826).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0020282
	speed: 0.5781s/iter; left time: 7806.0838s
	iters: 200, epoch: 2 | loss: 0.0032891
	speed: 0.1389s/iter; left time: 1861.1163s
	iters: 300, epoch: 2 | loss: 0.1406259
	speed: 0.1199s/iter; left time: 1594.4817s
	iters: 400, epoch: 2 | loss: 0.0370089
	speed: 0.1314s/iter; left time: 1734.4869s
Epoch: 2 cost time: 63.786439418792725
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.948826 --> -0.975128).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0110051
	speed: 0.5289s/iter; left time: 6892.7568s
	iters: 200, epoch: 3 | loss: 0.0055733
	speed: 0.1237s/iter; left time: 1600.0759s
	iters: 300, epoch: 3 | loss: 0.0103034
	speed: 0.1409s/iter; left time: 1808.0817s
	iters: 400, epoch: 3 | loss: 0.0014377
	speed: 0.1253s/iter; left time: 1595.1415s
Epoch: 3 cost time: 59.56942915916443
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.976843).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0759604
	speed: 0.5314s/iter; left time: 6675.8891s
	iters: 200, epoch: 4 | loss: 0.0139851
	speed: 0.1503s/iter; left time: 1872.9301s
	iters: 300, epoch: 4 | loss: 0.0007711
	speed: 0.1400s/iter; left time: 1731.4763s
	iters: 400, epoch: 4 | loss: 0.0127350
	speed: 0.1293s/iter; left time: 1585.7205s
Epoch: 4 cost time: 65.30505394935608
Epoch: 4, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0014854
	speed: 0.5608s/iter; left time: 6782.4143s
	iters: 200, epoch: 5 | loss: 0.1520006
	speed: 0.1341s/iter; left time: 1608.7872s
	iters: 300, epoch: 5 | loss: 0.0428837
	speed: 0.1307s/iter; left time: 1554.2396s
	iters: 400, epoch: 5 | loss: 0.0010935
	speed: 0.1295s/iter; left time: 1527.2878s
Epoch: 5 cost time: 63.967673540115356
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0319321
	speed: 0.5620s/iter; left time: 6533.9531s
	iters: 200, epoch: 6 | loss: 0.0008855
	speed: 0.0996s/iter; left time: 1148.3371s
	iters: 300, epoch: 6 | loss: 0.0007125
	speed: 0.1324s/iter; left time: 1512.5823s
	iters: 400, epoch: 6 | loss: 0.0001620
	speed: 0.1304s/iter; left time: 1477.0445s
Epoch: 6 cost time: 58.30275559425354
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0006107
	speed: 0.4827s/iter; left time: 5386.0297s
	iters: 200, epoch: 7 | loss: 0.0055981
	speed: 0.1338s/iter; left time: 1479.4907s
	iters: 300, epoch: 7 | loss: 0.0002583
	speed: 0.1234s/iter; left time: 1352.0636s
	iters: 400, epoch: 7 | loss: 0.0007540
	speed: 0.1170s/iter; left time: 1269.8764s
Epoch: 7 cost time: 57.54928278923035
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0021411
	speed: 0.5378s/iter; left time: 5748.0409s
	iters: 200, epoch: 8 | loss: 0.0005448
	speed: 0.1355s/iter; left time: 1434.9445s
	iters: 300, epoch: 8 | loss: 0.0000887
	speed: 0.1331s/iter; left time: 1395.9678s
	iters: 400, epoch: 8 | loss: 0.0398378
	speed: 0.1382s/iter; left time: 1435.5348s
Epoch: 8 cost time: 65.44240307807922
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0356397
	speed: 0.5924s/iter; left time: 6053.6457s
	iters: 200, epoch: 9 | loss: 0.0710275
	speed: 0.1897s/iter; left time: 1919.3211s
	iters: 300, epoch: 9 | loss: 0.0039268
	speed: 0.1895s/iter; left time: 1898.1166s
	iters: 400, epoch: 9 | loss: 0.0242390
	speed: 0.1890s/iter; left time: 1874.2051s
Epoch: 9 cost time: 88.95018434524536
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.237 Vali Acc: 0.952 Test Loss: 0.237 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0202323
	speed: 0.7429s/iter; left time: 7243.1602s
	iters: 200, epoch: 10 | loss: 0.0045647
	speed: 0.1743s/iter; left time: 1682.3516s
	iters: 300, epoch: 10 | loss: 0.0005792
	speed: 0.1744s/iter; left time: 1665.5488s
	iters: 400, epoch: 10 | loss: 0.0001449
	speed: 0.1738s/iter; left time: 1641.9432s
Epoch: 10 cost time: 82.22489905357361
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.978272).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0027603
	speed: 0.7485s/iter; left time: 6947.2916s
	iters: 200, epoch: 11 | loss: 0.0000378
	speed: 0.1896s/iter; left time: 1740.6570s
	iters: 300, epoch: 11 | loss: 0.0001353
	speed: 0.1875s/iter; left time: 1702.8820s
	iters: 400, epoch: 11 | loss: 0.0014236
	speed: 0.1559s/iter; left time: 1399.9915s
Epoch: 11 cost time: 84.29411172866821
Epoch: 11, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978844).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002124
	speed: 0.6578s/iter; left time: 5796.3845s
	iters: 200, epoch: 12 | loss: 0.0008956
	speed: 0.1557s/iter; left time: 1356.7826s
	iters: 300, epoch: 12 | loss: 0.0005386
	speed: 0.1577s/iter; left time: 1357.7731s
	iters: 400, epoch: 12 | loss: 0.0012041
	speed: 0.1579s/iter; left time: 1343.9009s
Epoch: 12 cost time: 73.99662733078003
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0042336
	speed: 0.6774s/iter; left time: 5651.1554s
	iters: 200, epoch: 13 | loss: 0.0015897
	speed: 0.1711s/iter; left time: 1410.2888s
	iters: 300, epoch: 13 | loss: 0.0001973
	speed: 0.1552s/iter; left time: 1263.9199s
	iters: 400, epoch: 13 | loss: 0.0013361
	speed: 0.1868s/iter; left time: 1502.2454s
Epoch: 13 cost time: 81.4053521156311
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0134729
	speed: 0.7072s/iter; left time: 5568.5774s
	iters: 200, epoch: 14 | loss: 0.0035224
	speed: 0.1670s/iter; left time: 1297.9316s
	iters: 300, epoch: 14 | loss: 0.0016310
	speed: 0.1713s/iter; left time: 1314.7409s
	iters: 400, epoch: 14 | loss: 0.0035091
	speed: 0.1694s/iter; left time: 1283.2088s
Epoch: 14 cost time: 80.48618626594543
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000372
	speed: 0.7411s/iter; left time: 5488.0147s
	iters: 200, epoch: 15 | loss: 0.0043406
	speed: 0.1864s/iter; left time: 1361.7999s
	iters: 300, epoch: 15 | loss: 0.0000161
	speed: 0.1841s/iter; left time: 1326.6005s
	iters: 400, epoch: 15 | loss: 0.0008553
	speed: 0.1839s/iter; left time: 1306.3016s
Epoch: 15 cost time: 86.30625629425049
Epoch: 15, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000197
	speed: 0.6661s/iter; left time: 4619.9383s
	iters: 200, epoch: 16 | loss: 0.0001725
	speed: 0.1518s/iter; left time: 1037.8284s
	iters: 300, epoch: 16 | loss: 0.0001088
	speed: 0.1519s/iter; left time: 1023.4212s
	iters: 400, epoch: 16 | loss: 0.0082742
	speed: 0.1555s/iter; left time: 1032.0845s
Epoch: 16 cost time: 71.54263949394226
Epoch: 16, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0067431
	speed: 0.6702s/iter; left time: 4334.1161s
	iters: 200, epoch: 17 | loss: 0.0014872
	speed: 0.1652s/iter; left time: 1051.8419s
	iters: 300, epoch: 17 | loss: 0.0007760
	speed: 0.1652s/iter; left time: 1035.4986s
	iters: 400, epoch: 17 | loss: 0.0027478
	speed: 0.1606s/iter; left time: 990.4664s
Epoch: 17 cost time: 75.50371503829956
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000375
	speed: 0.6222s/iter; left time: 3732.1848s
	iters: 200, epoch: 18 | loss: 0.0000381
	speed: 0.1597s/iter; left time: 942.1683s
	iters: 300, epoch: 18 | loss: 0.0001665
	speed: 0.1578s/iter; left time: 915.0165s
	iters: 400, epoch: 18 | loss: 0.0341167
	speed: 0.1707s/iter; left time: 972.4891s
Epoch: 18 cost time: 76.84015774726868
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0038237
	speed: 0.6867s/iter; left time: 3796.8914s
	iters: 200, epoch: 19 | loss: 0.0000812
	speed: 0.1603s/iter; left time: 870.2164s
	iters: 300, epoch: 19 | loss: 0.0007908
	speed: 0.1583s/iter; left time: 843.3843s
	iters: 400, epoch: 19 | loss: 0.0000164
	speed: 0.1278s/iter; left time: 668.2303s
Epoch: 19 cost time: 70.41369557380676
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0004406
	speed: 0.5313s/iter; left time: 2688.2464s
	iters: 200, epoch: 20 | loss: 0.0001905
	speed: 0.1334s/iter; left time: 661.8384s
	iters: 300, epoch: 20 | loss: 0.0002353
	speed: 0.1383s/iter; left time: 672.1768s
	iters: 400, epoch: 20 | loss: 0.0023554
	speed: 0.1465s/iter; left time: 697.1625s
Epoch: 20 cost time: 65.64263606071472
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0005719
	speed: 0.6055s/iter; left time: 2780.0614s
	iters: 200, epoch: 21 | loss: 0.0007743
	speed: 0.1692s/iter; left time: 759.6680s
	iters: 300, epoch: 21 | loss: 0.0068663
	speed: 0.1667s/iter; left time: 731.9734s
	iters: 400, epoch: 21 | loss: 0.0001695
	speed: 0.1540s/iter; left time: 660.9870s
Epoch: 21 cost time: 76.93842601776123
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 8272394
model size : 34.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1879029
	speed: 0.2561s/iter; left time: 3578.5776s
	iters: 200, epoch: 1 | loss: 0.0959686
	speed: 0.2448s/iter; left time: 3394.9985s
	iters: 300, epoch: 1 | loss: 0.1638051
	speed: 0.2419s/iter; left time: 3331.0268s
	iters: 400, epoch: 1 | loss: 0.0504018
	speed: 0.2428s/iter; left time: 3319.8544s
Epoch: 1 cost time: 115.55999732017517
Epoch: 1, Steps: 469 | Train Loss: 0.372 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
Validation loss decreased (inf --> -0.937962).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0618648
	speed: 0.7933s/iter; left time: 10711.4395s
	iters: 200, epoch: 2 | loss: 0.3311212
	speed: 0.2017s/iter; left time: 2702.7965s
	iters: 300, epoch: 2 | loss: 0.3466531
	speed: 0.2019s/iter; left time: 2685.1568s
	iters: 400, epoch: 2 | loss: 0.1859729
	speed: 0.2184s/iter; left time: 2883.3411s
Epoch: 2 cost time: 98.05054330825806
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.937962 --> -0.976557).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0808116
	speed: 0.8178s/iter; left time: 10658.9371s
	iters: 200, epoch: 3 | loss: 0.1642617
	speed: 0.2139s/iter; left time: 2766.9063s
	iters: 300, epoch: 3 | loss: 0.1137002
	speed: 0.1962s/iter; left time: 2518.3413s
	iters: 400, epoch: 3 | loss: 0.0012427
	speed: 0.1968s/iter; left time: 2506.1421s
Epoch: 3 cost time: 99.45666885375977
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.953 Test Loss: 0.148 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0404397
	speed: 0.8913s/iter; left time: 11197.9542s
	iters: 200, epoch: 4 | loss: 0.2390302
	speed: 0.2541s/iter; left time: 3167.6116s
	iters: 300, epoch: 4 | loss: 0.0897004
	speed: 0.2548s/iter; left time: 3150.3507s
	iters: 400, epoch: 4 | loss: 0.0029747
	speed: 0.2532s/iter; left time: 3105.4676s
Epoch: 4 cost time: 119.6815550327301
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0063384
	speed: 0.8522s/iter; left time: 10306.9061s
	iters: 200, epoch: 5 | loss: 0.0196000
	speed: 0.2198s/iter; left time: 2636.1734s
	iters: 300, epoch: 5 | loss: 0.0017629
	speed: 0.2200s/iter; left time: 2617.0514s
	iters: 400, epoch: 5 | loss: 0.0017438
	speed: 0.2375s/iter; left time: 2801.0862s
Epoch: 5 cost time: 105.81190490722656
Epoch: 5, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002602
	speed: 0.8692s/iter; left time: 10105.3639s
	iters: 200, epoch: 6 | loss: 0.0065561
	speed: 0.2225s/iter; left time: 2564.7777s
	iters: 300, epoch: 6 | loss: 0.0120927
	speed: 0.2225s/iter; left time: 2542.4541s
	iters: 400, epoch: 6 | loss: 0.0619502
	speed: 0.2228s/iter; left time: 2523.7490s
Epoch: 6 cost time: 106.30846834182739
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5904835
	speed: 0.8481s/iter; left time: 9462.2462s
	iters: 200, epoch: 7 | loss: 0.0034276
	speed: 0.2422s/iter; left time: 2678.4458s
	iters: 300, epoch: 7 | loss: 0.0456807
	speed: 0.2420s/iter; left time: 2651.9843s
	iters: 400, epoch: 7 | loss: 0.0010649
	speed: 0.2305s/iter; left time: 2502.6730s
Epoch: 7 cost time: 111.91093492507935
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001724
	speed: 0.7978s/iter; left time: 8526.8567s
	iters: 200, epoch: 8 | loss: 0.0016262
	speed: 0.2144s/iter; left time: 2270.5152s
	iters: 300, epoch: 8 | loss: 0.0002689
	speed: 0.2134s/iter; left time: 2238.0662s
	iters: 400, epoch: 8 | loss: 0.0254771
	speed: 0.2311s/iter; left time: 2400.7589s
Epoch: 8 cost time: 103.426185131073
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977415).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0563209
	speed: 0.9455s/iter; left time: 9661.9251s
	iters: 200, epoch: 9 | loss: 0.0710208
	speed: 0.2575s/iter; left time: 2605.1545s
	iters: 300, epoch: 9 | loss: 0.0014402
	speed: 0.3300s/iter; left time: 3306.6348s
	iters: 400, epoch: 9 | loss: 0.0761607
	speed: 0.4209s/iter; left time: 4174.4808s
Epoch: 9 cost time: 156.15330123901367
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.981131).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1646945
	speed: 1.6109s/iter; left time: 15706.2483s
	iters: 200, epoch: 10 | loss: 0.0019136
	speed: 0.4242s/iter; left time: 4093.4433s
	iters: 300, epoch: 10 | loss: 0.0000838
	speed: 0.4205s/iter; left time: 4015.9159s
	iters: 400, epoch: 10 | loss: 0.0084815
	speed: 0.4211s/iter; left time: 3979.2193s
Epoch: 10 cost time: 199.63947296142578
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0148569
	speed: 1.4944s/iter; left time: 13869.7130s
	iters: 200, epoch: 11 | loss: 0.0043979
	speed: 0.3931s/iter; left time: 3608.7923s
	iters: 300, epoch: 11 | loss: 0.0010483
	speed: 0.3800s/iter; left time: 3451.0932s
	iters: 400, epoch: 11 | loss: 0.0003344
	speed: 0.4092s/iter; left time: 3674.8811s
Epoch: 11 cost time: 185.72323393821716
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0145072
	speed: 1.5474s/iter; left time: 13635.2839s
	iters: 200, epoch: 12 | loss: 0.0001949
	speed: 0.4169s/iter; left time: 3631.9542s
	iters: 300, epoch: 12 | loss: 0.0589332
	speed: 0.4036s/iter; left time: 3475.8837s
	iters: 400, epoch: 12 | loss: 0.0004294
	speed: 0.4037s/iter; left time: 3435.8697s
Epoch: 12 cost time: 191.54598331451416
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0002150
	speed: 1.4133s/iter; left time: 11790.7594s
	iters: 200, epoch: 13 | loss: 0.0018174
	speed: 0.2976s/iter; left time: 2453.0303s
	iters: 300, epoch: 13 | loss: 0.0013387
	speed: 0.2967s/iter; left time: 2415.9347s
	iters: 400, epoch: 13 | loss: 0.0062313
	speed: 0.2950s/iter; left time: 2372.4737s
Epoch: 13 cost time: 144.60449290275574
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0091301
	speed: 1.0560s/iter; left time: 8314.7771s
	iters: 200, epoch: 14 | loss: 0.0008351
	speed: 0.2880s/iter; left time: 2238.7145s
	iters: 300, epoch: 14 | loss: 0.0106011
	speed: 0.2941s/iter; left time: 2257.1410s
	iters: 400, epoch: 14 | loss: 0.0103795
	speed: 0.3135s/iter; left time: 2374.1256s
Epoch: 14 cost time: 139.96270942687988
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0001151
	speed: 1.1464s/iter; left time: 8489.3767s
	iters: 200, epoch: 15 | loss: 0.0002768
	speed: 0.2922s/iter; left time: 2134.2051s
	iters: 300, epoch: 15 | loss: 0.0005342
	speed: 0.2844s/iter; left time: 2049.4544s
	iters: 400, epoch: 15 | loss: 0.0002464
	speed: 0.2831s/iter; left time: 2011.7096s
Epoch: 15 cost time: 135.03808450698853
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0004499
	speed: 1.0053s/iter; left time: 6972.8520s
	iters: 200, epoch: 16 | loss: 0.0004894
	speed: 0.2631s/iter; left time: 1798.5772s
	iters: 300, epoch: 16 | loss: 0.1602110
	speed: 0.2878s/iter; left time: 1938.9289s
	iters: 400, epoch: 16 | loss: 0.0000712
	speed: 0.3150s/iter; left time: 2090.4580s
Epoch: 16 cost time: 134.2063708305359
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.961 Test Loss: 0.188 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0011507
	speed: 1.1205s/iter; left time: 7246.2573s
	iters: 200, epoch: 17 | loss: 0.0038493
	speed: 0.3239s/iter; left time: 2062.1469s
	iters: 300, epoch: 17 | loss: 0.0012940
	speed: 0.3237s/iter; left time: 2028.5461s
	iters: 400, epoch: 17 | loss: 0.0002771
	speed: 0.3151s/iter; left time: 1943.1877s
Epoch: 17 cost time: 147.80326223373413
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0054581
	speed: 1.0989s/iter; left time: 6591.1538s
	iters: 200, epoch: 18 | loss: 0.0006966
	speed: 0.2967s/iter; left time: 1749.9263s
	iters: 300, epoch: 18 | loss: 0.0000155
	speed: 0.2809s/iter; left time: 1628.9392s
	iters: 400, epoch: 18 | loss: 0.0002265
	speed: 0.2718s/iter; left time: 1548.6404s
Epoch: 18 cost time: 134.18806767463684
Epoch: 18, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0061972
	speed: 1.0737s/iter; left time: 5936.7284s
	iters: 200, epoch: 19 | loss: 0.0014976
	speed: 0.2807s/iter; left time: 1523.8165s
	iters: 300, epoch: 19 | loss: 0.0004087
	speed: 0.2834s/iter; left time: 1510.3077s
	iters: 400, epoch: 19 | loss: 0.0015479
	speed: 0.3025s/iter; left time: 1581.8211s
Epoch: 19 cost time: 138.46308279037476
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 28131338
model size : 109.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4182633
	speed: 0.1560s/iter; left time: 2178.9158s
	iters: 200, epoch: 1 | loss: 0.1525345
	speed: 0.1422s/iter; left time: 1972.6968s
	iters: 300, epoch: 1 | loss: 0.0173508
	speed: 0.1482s/iter; left time: 2041.4291s
	iters: 400, epoch: 1 | loss: 0.0136711
	speed: 0.1467s/iter; left time: 2006.0058s
Epoch: 1 cost time: 69.5894877910614
Epoch: 1, Steps: 469 | Train Loss: 0.388 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
Validation loss decreased (inf --> -0.955116).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0034460
	speed: 0.6320s/iter; left time: 8533.7780s
	iters: 200, epoch: 2 | loss: 0.0045477
	speed: 0.1272s/iter; left time: 1704.3003s
	iters: 300, epoch: 2 | loss: 0.0783238
	speed: 0.1255s/iter; left time: 1669.3887s
	iters: 400, epoch: 2 | loss: 0.0404216
	speed: 0.1274s/iter; left time: 1681.5784s
Epoch: 2 cost time: 59.716055154800415
Epoch: 2, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
Validation loss decreased (-0.955116 --> -0.965694).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0727583
	speed: 0.6263s/iter; left time: 8162.5091s
	iters: 200, epoch: 3 | loss: 0.0249083
	speed: 0.1397s/iter; left time: 1806.9574s
	iters: 300, epoch: 3 | loss: 0.0515910
	speed: 0.1380s/iter; left time: 1770.6223s
	iters: 400, epoch: 3 | loss: 0.0139582
	speed: 0.1322s/iter; left time: 1683.3520s
Epoch: 3 cost time: 64.6538233757019
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0057048
	speed: 0.6058s/iter; left time: 7611.8086s
	iters: 200, epoch: 4 | loss: 0.0009970
	speed: 0.1440s/iter; left time: 1794.6817s
	iters: 300, epoch: 4 | loss: 0.0020227
	speed: 0.1413s/iter; left time: 1746.7235s
	iters: 400, epoch: 4 | loss: 0.0356969
	speed: 0.1432s/iter; left time: 1755.8121s
Epoch: 4 cost time: 67.05253887176514
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.965694 --> -0.967980).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0109011
	speed: 0.6411s/iter; left time: 7754.2580s
	iters: 200, epoch: 5 | loss: 0.0041744
	speed: 0.1353s/iter; left time: 1622.5423s
	iters: 300, epoch: 5 | loss: 0.0053722
	speed: 0.1360s/iter; left time: 1618.2994s
	iters: 400, epoch: 5 | loss: 0.0159979
	speed: 0.1353s/iter; left time: 1596.0815s
Epoch: 5 cost time: 64.33715224266052
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0004005
	speed: 0.6443s/iter; left time: 7490.0826s
	iters: 200, epoch: 6 | loss: 0.0037641
	speed: 0.1421s/iter; left time: 1638.0626s
	iters: 300, epoch: 6 | loss: 0.0002371
	speed: 0.1310s/iter; left time: 1496.3670s
	iters: 400, epoch: 6 | loss: 0.0057771
	speed: 0.1310s/iter; left time: 1484.0261s
Epoch: 6 cost time: 63.9512996673584
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0050071
	speed: 0.5825s/iter; left time: 6499.1605s
	iters: 200, epoch: 7 | loss: 0.0004082
	speed: 0.1380s/iter; left time: 1525.5970s
	iters: 300, epoch: 7 | loss: 0.0030209
	speed: 0.1376s/iter; left time: 1507.2584s
	iters: 400, epoch: 7 | loss: 0.0005080
	speed: 0.1367s/iter; left time: 1483.6115s
Epoch: 7 cost time: 65.11741089820862
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.967980 --> -0.977415).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0019495
	speed: 0.5901s/iter; left time: 6306.9293s
	iters: 200, epoch: 8 | loss: 0.0080245
	speed: 0.1212s/iter; left time: 1282.9901s
	iters: 300, epoch: 8 | loss: 0.0013311
	speed: 0.1214s/iter; left time: 1273.5301s
	iters: 400, epoch: 8 | loss: 0.0072612
	speed: 0.1297s/iter; left time: 1347.6465s
Epoch: 8 cost time: 58.69224429130554
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0228948
	speed: 0.6061s/iter; left time: 6193.9483s
	iters: 200, epoch: 9 | loss: 0.0012872
	speed: 0.1248s/iter; left time: 1263.1047s
	iters: 300, epoch: 9 | loss: 0.0008771
	speed: 0.1249s/iter; left time: 1251.2503s
	iters: 400, epoch: 9 | loss: 0.0274065
	speed: 0.1237s/iter; left time: 1227.4388s
Epoch: 9 cost time: 59.58843922615051
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0247802
	speed: 0.5859s/iter; left time: 5712.7946s
	iters: 200, epoch: 10 | loss: 0.0028846
	speed: 0.1320s/iter; left time: 1273.5654s
	iters: 300, epoch: 10 | loss: 0.0007107
	speed: 0.1305s/iter; left time: 1246.2814s
	iters: 400, epoch: 10 | loss: 0.0090296
	speed: 0.1316s/iter; left time: 1243.3645s
Epoch: 10 cost time: 61.30599045753479
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004618
	speed: 0.5411s/iter; left time: 5021.8240s
	iters: 200, epoch: 11 | loss: 0.0001804
	speed: 0.1206s/iter; left time: 1107.5723s
	iters: 300, epoch: 11 | loss: 0.0005418
	speed: 0.1306s/iter; left time: 1185.9151s
	iters: 400, epoch: 11 | loss: 0.0032564
	speed: 0.1308s/iter; left time: 1175.0446s
Epoch: 11 cost time: 59.45700263977051
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0005811
	speed: 0.5936s/iter; left time: 5230.5808s
	iters: 200, epoch: 12 | loss: 0.0020266
	speed: 0.1233s/iter; left time: 1074.5920s
	iters: 300, epoch: 12 | loss: 0.1016015
	speed: 0.1256s/iter; left time: 1081.9929s
	iters: 400, epoch: 12 | loss: 0.0002219
	speed: 0.1178s/iter; left time: 1003.0717s
Epoch: 12 cost time: 57.917351961135864
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0062567
	speed: 0.5944s/iter; left time: 4959.2064s
	iters: 200, epoch: 13 | loss: 0.0469497
	speed: 0.1341s/iter; left time: 1105.6891s
	iters: 300, epoch: 13 | loss: 0.0011833
	speed: 0.1338s/iter; left time: 1089.4127s
	iters: 400, epoch: 13 | loss: 0.0033174
	speed: 0.1222s/iter; left time: 983.1022s
Epoch: 13 cost time: 61.15528106689453
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.977986).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0005228
	speed: 0.5567s/iter; left time: 4383.6013s
	iters: 200, epoch: 14 | loss: 0.0000504
	speed: 0.1274s/iter; left time: 990.0461s
	iters: 300, epoch: 14 | loss: 0.0036504
	speed: 0.1300s/iter; left time: 997.6873s
	iters: 400, epoch: 14 | loss: 0.0036769
	speed: 0.1297s/iter; left time: 982.0573s
Epoch: 14 cost time: 59.997254848480225
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0001533
	speed: 0.5672s/iter; left time: 4199.7712s
	iters: 200, epoch: 15 | loss: 0.0106184
	speed: 0.1163s/iter; left time: 849.6694s
	iters: 300, epoch: 15 | loss: 0.0000984
	speed: 0.1188s/iter; left time: 856.0183s
	iters: 400, epoch: 15 | loss: 0.0003649
	speed: 0.1152s/iter; left time: 818.1831s
Epoch: 15 cost time: 55.11048460006714
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000606
	speed: 0.5822s/iter; left time: 4037.9341s
	iters: 200, epoch: 16 | loss: 0.0011626
	speed: 0.1362s/iter; left time: 931.2506s
	iters: 300, epoch: 16 | loss: 0.0037842
	speed: 0.1299s/iter; left time: 875.3194s
	iters: 400, epoch: 16 | loss: 0.0046745
	speed: 0.1256s/iter; left time: 833.4616s
Epoch: 16 cost time: 61.189958810806274
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0017600
	speed: 0.6012s/iter; left time: 3887.8312s
	iters: 200, epoch: 17 | loss: 0.0012496
	speed: 0.1450s/iter; left time: 922.9632s
	iters: 300, epoch: 17 | loss: 0.0147838
	speed: 0.1453s/iter; left time: 910.3882s
	iters: 400, epoch: 17 | loss: 0.0003747
	speed: 0.1455s/iter; left time: 897.1079s
Epoch: 17 cost time: 67.59073090553284
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.977986 --> -0.979702).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0012728
	speed: 0.6341s/iter; left time: 3803.2259s
	iters: 200, epoch: 18 | loss: 0.1310382
	speed: 0.1326s/iter; left time: 781.8590s
	iters: 300, epoch: 18 | loss: 0.0004811
	speed: 0.1339s/iter; left time: 776.3134s
	iters: 400, epoch: 18 | loss: 0.0000362
	speed: 0.1308s/iter; left time: 745.3889s
Epoch: 18 cost time: 62.46406865119934
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0891765
	speed: 0.6187s/iter; left time: 3421.0010s
	iters: 200, epoch: 19 | loss: 0.0002233
	speed: 0.1380s/iter; left time: 749.0928s
	iters: 300, epoch: 19 | loss: 0.0001712
	speed: 0.1247s/iter; left time: 664.6462s
	iters: 400, epoch: 19 | loss: 0.0000627
	speed: 0.1271s/iter; left time: 664.7001s
Epoch: 19 cost time: 61.9411244392395
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000381
	speed: 0.5784s/iter; left time: 2926.5603s
	iters: 200, epoch: 20 | loss: 0.0009264
	speed: 0.1378s/iter; left time: 683.5179s
	iters: 300, epoch: 20 | loss: 0.0000585
	speed: 0.1366s/iter; left time: 664.0887s
	iters: 400, epoch: 20 | loss: 0.0032708
	speed: 0.1422s/iter; left time: 676.8033s
Epoch: 20 cost time: 65.12970066070557
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0075957
	speed: 0.6130s/iter; left time: 2814.2828s
	iters: 200, epoch: 21 | loss: 0.0001735
	speed: 0.1265s/iter; left time: 568.3052s
	iters: 300, epoch: 21 | loss: 0.0001791
	speed: 0.1321s/iter; left time: 580.0037s
	iters: 400, epoch: 21 | loss: 0.0001692
	speed: 0.1330s/iter; left time: 570.7977s
Epoch: 21 cost time: 61.78190636634827
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0001877
	speed: 0.5849s/iter; left time: 2410.9670s
	iters: 200, epoch: 22 | loss: 0.0002506
	speed: 0.1500s/iter; left time: 603.3158s
	iters: 300, epoch: 22 | loss: 0.0001100
	speed: 0.1500s/iter; left time: 588.2281s
	iters: 400, epoch: 22 | loss: 0.6987589
	speed: 0.1499s/iter; left time: 572.9562s
Epoch: 22 cost time: 68.80703568458557
Epoch: 22, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0020101
	speed: 0.6701s/iter; left time: 2447.8901s
	iters: 200, epoch: 23 | loss: 0.0001447
	speed: 0.1355s/iter; left time: 481.4687s
	iters: 300, epoch: 23 | loss: 0.0004539
	speed: 0.1359s/iter; left time: 469.2329s
	iters: 400, epoch: 23 | loss: 0.0009533
	speed: 0.1340s/iter; left time: 449.4250s
Epoch: 23 cost time: 64.45123529434204
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0007090
	speed: 0.6068s/iter; left time: 1932.1881s
	iters: 200, epoch: 24 | loss: 0.0099843
	speed: 0.1429s/iter; left time: 440.7329s
	iters: 300, epoch: 24 | loss: 0.0013996
	speed: 0.1424s/iter; left time: 424.9622s
	iters: 400, epoch: 24 | loss: 0.0012082
	speed: 0.1428s/iter; left time: 411.8922s
Epoch: 24 cost time: 66.91568970680237
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0001230
	speed: 0.6559s/iter; left time: 1780.7329s
	iters: 200, epoch: 25 | loss: 0.0006398
	speed: 0.1363s/iter; left time: 356.3095s
	iters: 300, epoch: 25 | loss: 0.0013660
	speed: 0.1463s/iter; left time: 367.8776s
	iters: 400, epoch: 25 | loss: 0.0001751
	speed: 0.1479s/iter; left time: 357.2592s
Epoch: 25 cost time: 67.81813454627991
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0015574
	speed: 0.6759s/iter; left time: 1517.9905s
	iters: 200, epoch: 26 | loss: 0.0294437
	speed: 0.1557s/iter; left time: 334.0617s
	iters: 300, epoch: 26 | loss: 0.0004868
	speed: 0.1570s/iter; left time: 321.3029s
	iters: 400, epoch: 26 | loss: 0.0001074
	speed: 0.1559s/iter; left time: 303.3998s
Epoch: 26 cost time: 73.49180102348328
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0070155
	speed: 0.7617s/iter; left time: 1353.6167s
	iters: 200, epoch: 27 | loss: 0.0000597
	speed: 0.2325s/iter; left time: 389.8684s
	iters: 300, epoch: 27 | loss: 0.0006124
	speed: 0.2324s/iter; left time: 366.4610s
	iters: 400, epoch: 27 | loss: 0.0001171
	speed: 0.2297s/iter; left time: 339.2330s
Epoch: 27 cost time: 106.26997709274292
Epoch: 27, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 8272394
model size : 34.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5795725
	speed: 1.0691s/iter; left time: 14936.9334s
	iters: 200, epoch: 1 | loss: 0.0969756
	speed: 1.0724s/iter; left time: 14875.1884s
	iters: 300, epoch: 1 | loss: 0.0299764
	speed: 1.0634s/iter; left time: 14644.4642s
	iters: 400, epoch: 1 | loss: 0.1420096
	speed: 1.0733s/iter; left time: 14673.2357s
Epoch: 1 cost time: 502.02670550346375
Epoch: 1, Steps: 469 | Train Loss: 0.399 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (inf --> -0.963120).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0387926
	speed: 3.7557s/iter; left time: 50709.4975s
	iters: 200, epoch: 2 | loss: 0.0106626
	speed: 1.0442s/iter; left time: 13994.3832s
	iters: 300, epoch: 2 | loss: 0.1915160
	speed: 1.0139s/iter; left time: 13487.0265s
	iters: 400, epoch: 2 | loss: 0.0075866
	speed: 0.9979s/iter; left time: 13174.5743s
Epoch: 2 cost time: 479.15978384017944
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.963120 --> -0.969410).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0865857
	speed: 3.7206s/iter; left time: 48490.2561s
	iters: 200, epoch: 3 | loss: 0.1612410
	speed: 1.0342s/iter; left time: 13375.2095s
	iters: 300, epoch: 3 | loss: 0.0458208
	speed: 1.0281s/iter; left time: 13193.3252s
	iters: 400, epoch: 3 | loss: 0.0083629
	speed: 0.9612s/iter; left time: 12238.9851s
Epoch: 3 cost time: 470.7435178756714
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0059137
	speed: 3.7706s/iter; left time: 47373.2014s
	iters: 200, epoch: 4 | loss: 0.0015519
	speed: 1.0697s/iter; left time: 13332.1421s
	iters: 300, epoch: 4 | loss: 0.0551703
	speed: 1.0816s/iter; left time: 13372.4010s
	iters: 400, epoch: 4 | loss: 0.0075792
	speed: 1.0413s/iter; left time: 12770.8319s
Epoch: 4 cost time: 492.7504253387451
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0009284
	speed: 3.8133s/iter; left time: 46121.4418s
	iters: 200, epoch: 5 | loss: 0.0015746
	speed: 1.0509s/iter; left time: 12605.0782s
	iters: 300, epoch: 5 | loss: 0.0051345
	speed: 1.0805s/iter; left time: 12852.1517s
	iters: 400, epoch: 5 | loss: 0.0280898
	speed: 1.0136s/iter; left time: 11954.9888s
Epoch: 5 cost time: 490.999666929245
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0060369
	speed: 3.7764s/iter; left time: 43904.0505s
	iters: 200, epoch: 6 | loss: 0.1295382
	speed: 1.0554s/iter; left time: 12164.0213s
	iters: 300, epoch: 6 | loss: 0.0052635
	speed: 1.0410s/iter; left time: 11894.8791s
	iters: 400, epoch: 6 | loss: 0.0017032
	speed: 1.0570s/iter; left time: 11972.1475s
Epoch: 6 cost time: 493.50167417526245
Epoch: 6, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0009294
	speed: 3.6653s/iter; left time: 40893.2623s
	iters: 200, epoch: 7 | loss: 0.0296198
	speed: 1.0662s/iter; left time: 11789.3170s
	iters: 300, epoch: 7 | loss: 0.0053225
	speed: 1.0439s/iter; left time: 11438.1142s
	iters: 400, epoch: 7 | loss: 0.0006840
	speed: 1.0312s/iter; left time: 11195.2080s
Epoch: 7 cost time: 487.7835385799408
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.969410 --> -0.974270).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0069467
	speed: 3.6320s/iter; left time: 38818.9273s
	iters: 200, epoch: 8 | loss: 0.0005153
	speed: 0.9662s/iter; left time: 10230.3189s
	iters: 300, epoch: 8 | loss: 0.0043762
	speed: 0.9989s/iter; left time: 10476.6221s
	iters: 400, epoch: 8 | loss: 0.1112562
	speed: 0.9785s/iter; left time: 10164.1489s
Epoch: 8 cost time: 455.5670545101166
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0005728
	speed: 3.6026s/iter; left time: 36814.5892s
	iters: 200, epoch: 9 | loss: 0.0021381
	speed: 0.9563s/iter; left time: 9676.8595s
	iters: 300, epoch: 9 | loss: 0.0012573
	speed: 0.8884s/iter; left time: 8900.9706s
	iters: 400, epoch: 9 | loss: 0.0220276
	speed: 0.8646s/iter; left time: 8575.9972s
Epoch: 9 cost time: 425.67005467414856
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0148251
	speed: 3.1976s/iter; left time: 31176.8390s
	iters: 200, epoch: 10 | loss: 0.0091399
	speed: 0.8827s/iter; left time: 8517.9285s
	iters: 300, epoch: 10 | loss: 0.0003280
	speed: 0.9970s/iter; left time: 9521.4979s
	iters: 400, epoch: 10 | loss: 0.0506333
	speed: 0.9286s/iter; left time: 8775.0615s
Epoch: 10 cost time: 433.9264221191406
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975128).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0509589
	speed: 3.4549s/iter; left time: 32064.6646s
	iters: 200, epoch: 11 | loss: 0.0091179
	speed: 0.9441s/iter; left time: 8667.8041s
	iters: 300, epoch: 11 | loss: 0.0008777
	speed: 0.9889s/iter; left time: 8980.4250s
	iters: 400, epoch: 11 | loss: 0.0012870
	speed: 0.9153s/iter; left time: 8220.1151s
Epoch: 11 cost time: 447.3210015296936
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.975128 --> -0.977987).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0022389
	speed: 3.2869s/iter; left time: 28963.9890s
	iters: 200, epoch: 12 | loss: 0.0018753
	speed: 0.8640s/iter; left time: 7526.8552s
	iters: 300, epoch: 12 | loss: 0.0012988
	speed: 0.8720s/iter; left time: 7510.0735s
	iters: 400, epoch: 12 | loss: 0.0021624
	speed: 0.8614s/iter; left time: 7332.1575s
Epoch: 12 cost time: 411.6667401790619
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0004632
	speed: 2.9963s/iter; left time: 24998.4904s
	iters: 200, epoch: 13 | loss: 0.0004657
	speed: 0.8160s/iter; left time: 6726.5463s
	iters: 300, epoch: 13 | loss: 0.0012884
	speed: 0.8551s/iter; left time: 6963.2542s
	iters: 400, epoch: 13 | loss: 0.0015080
	speed: 0.7999s/iter; left time: 6433.5120s
Epoch: 13 cost time: 389.01957058906555
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1706317
	speed: 2.7948s/iter; left time: 22006.2101s
	iters: 200, epoch: 14 | loss: 0.0002077
	speed: 0.7759s/iter; left time: 6031.7776s
	iters: 300, epoch: 14 | loss: 0.0003214
	speed: 0.7498s/iter; left time: 5753.9758s
	iters: 400, epoch: 14 | loss: 0.0006799
	speed: 0.6773s/iter; left time: 5129.6446s
Epoch: 14 cost time: 348.07498145103455
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0010899
	speed: 2.7724s/iter; left time: 20529.2792s
	iters: 200, epoch: 15 | loss: 0.0014857
	speed: 0.7753s/iter; left time: 5663.4708s
	iters: 300, epoch: 15 | loss: 0.0103839
	speed: 0.7192s/iter; left time: 5182.0052s
	iters: 400, epoch: 15 | loss: 0.0030925
	speed: 0.7685s/iter; left time: 5460.4484s
Epoch: 15 cost time: 356.64682126045227
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0004816
	speed: 2.8030s/iter; left time: 19441.5703s
	iters: 200, epoch: 16 | loss: 0.0008629
	speed: 0.7795s/iter; left time: 5328.5379s
	iters: 300, epoch: 16 | loss: 0.0021687
	speed: 0.7540s/iter; left time: 5079.0344s
	iters: 400, epoch: 16 | loss: 0.0002751
	speed: 0.8013s/iter; left time: 5317.5487s
Epoch: 16 cost time: 364.3428671360016
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0005299
	speed: 2.9499s/iter; left time: 19076.8883s
	iters: 200, epoch: 17 | loss: 0.0064505
	speed: 0.8105s/iter; left time: 5160.3930s
	iters: 300, epoch: 17 | loss: 0.0045698
	speed: 0.7868s/iter; left time: 4931.1793s
	iters: 400, epoch: 17 | loss: 0.0000891
	speed: 0.8663s/iter; left time: 5342.3751s
Epoch: 17 cost time: 389.808141708374
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0005931
	speed: 3.0405s/iter; left time: 18236.8831s
	iters: 200, epoch: 18 | loss: 0.0005410
	speed: 0.8510s/iter; left time: 5018.9033s
	iters: 300, epoch: 18 | loss: 0.0024624
	speed: 0.8506s/iter; left time: 4931.5207s
	iters: 400, epoch: 18 | loss: 0.1513164
	speed: 0.8554s/iter; left time: 4874.1428s
Epoch: 18 cost time: 397.10314774513245
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002333
	speed: 3.0164s/iter; left time: 16677.9220s
	iters: 200, epoch: 19 | loss: 0.0000616
	speed: 0.8499s/iter; left time: 4614.3396s
	iters: 300, epoch: 19 | loss: 0.0287664
	speed: 0.8997s/iter; left time: 4794.3357s
	iters: 400, epoch: 19 | loss: 0.0013646
	speed: 0.8521s/iter; left time: 4455.4803s
Epoch: 19 cost time: 400.0929834842682
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0002146
	speed: 3.0225s/iter; left time: 15293.9092s
	iters: 200, epoch: 20 | loss: 0.0895884
	speed: 0.8443s/iter; left time: 4187.8536s
	iters: 300, epoch: 20 | loss: 0.0003887
	speed: 0.7671s/iter; left time: 3728.1394s
	iters: 400, epoch: 20 | loss: 0.0012679
	speed: 0.8052s/iter; left time: 3832.7038s
Epoch: 20 cost time: 380.79939699172974
Epoch: 20, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0010629
	speed: 2.9355s/iter; left time: 13476.9568s
	iters: 200, epoch: 21 | loss: 0.0031955
	speed: 0.7863s/iter; left time: 3531.4968s
	iters: 300, epoch: 21 | loss: 0.0002771
	speed: 0.7597s/iter; left time: 3335.7445s
	iters: 400, epoch: 21 | loss: 0.0285960
	speed: 0.7869s/iter; left time: 3376.5773s
Epoch: 21 cost time: 371.087717294693
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.977987 --> -0.978272).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001516
	speed: 2.9112s/iter; left time: 12000.1138s
	iters: 200, epoch: 22 | loss: 0.0001948
	speed: 0.7488s/iter; left time: 3011.6498s
	iters: 300, epoch: 22 | loss: 0.0001257
	speed: 0.7653s/iter; left time: 3001.6342s
	iters: 400, epoch: 22 | loss: 0.0002585
	speed: 0.7710s/iter; left time: 2946.7883s
Epoch: 22 cost time: 359.3612902164459
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0025800
	speed: 2.7930s/iter; left time: 10202.6580s
	iters: 200, epoch: 23 | loss: 0.0010465
	speed: 0.8160s/iter; left time: 2899.3681s
	iters: 300, epoch: 23 | loss: 0.0002795
	speed: 0.8047s/iter; left time: 2778.7827s
	iters: 400, epoch: 23 | loss: 0.0001249
	speed: 0.7747s/iter; left time: 2597.5662s
Epoch: 23 cost time: 369.4797167778015
Epoch: 23, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.981417).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0003933
	speed: 2.8299s/iter; left time: 9010.5305s
	iters: 200, epoch: 24 | loss: 0.0002426
	speed: 0.7814s/iter; left time: 2409.6949s
	iters: 300, epoch: 24 | loss: 0.0003830
	speed: 0.7916s/iter; left time: 2362.2356s
	iters: 400, epoch: 24 | loss: 0.0031380
	speed: 0.7522s/iter; left time: 2169.4653s
Epoch: 24 cost time: 366.7029435634613
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0200794
	speed: 2.7955s/iter; left time: 7589.8355s
	iters: 200, epoch: 25 | loss: 0.0007715
	speed: 0.7315s/iter; left time: 1912.7990s
	iters: 300, epoch: 25 | loss: 0.0057592
	speed: 0.7692s/iter; left time: 1934.5875s
	iters: 400, epoch: 25 | loss: 0.0026862
	speed: 0.7694s/iter; left time: 1858.0778s
Epoch: 25 cost time: 356.94839811325073
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0001513
	speed: 2.8143s/iter; left time: 6320.9663s
	iters: 200, epoch: 26 | loss: 0.0006243
	speed: 0.7663s/iter; left time: 1644.4581s
	iters: 300, epoch: 26 | loss: 0.0289302
	speed: 0.7448s/iter; left time: 1523.8155s
	iters: 400, epoch: 26 | loss: 0.0002194
	speed: 0.7542s/iter; left time: 1467.6899s
Epoch: 26 cost time: 354.60549092292786
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0004983
	speed: 2.6579s/iter; left time: 4723.0164s
	iters: 200, epoch: 27 | loss: 0.0004966
	speed: 0.7361s/iter; left time: 1234.3724s
	iters: 300, epoch: 27 | loss: 0.1251675
	speed: 0.7286s/iter; left time: 1148.9404s
	iters: 400, epoch: 27 | loss: 0.0004735
	speed: 0.7407s/iter; left time: 1094.0532s
Epoch: 27 cost time: 344.981778383255
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000819
	speed: 2.6129s/iter; left time: 3417.6607s
	iters: 200, epoch: 28 | loss: 0.0001133
	speed: 0.7252s/iter; left time: 876.0094s
	iters: 300, epoch: 28 | loss: 0.0015888
	speed: 0.7654s/iter; left time: 848.0328s
	iters: 400, epoch: 28 | loss: 0.0003014
	speed: 0.7376s/iter; left time: 743.4518s
Epoch: 28 cost time: 343.2921688556671
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0153835
	speed: 2.7107s/iter; left time: 2274.2916s
	iters: 200, epoch: 29 | loss: 0.0001129
	speed: 0.7763s/iter; left time: 573.6816s
	iters: 300, epoch: 29 | loss: 0.0000639
	speed: 0.8369s/iter; left time: 534.7830s
	iters: 400, epoch: 29 | loss: 0.0036647
	speed: 0.8544s/iter; left time: 460.5267s
Epoch: 29 cost time: 385.5312535762787
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0010268
	speed: 3.1298s/iter; left time: 1158.0399s
	iters: 200, epoch: 30 | loss: 0.0000805
	speed: 0.8625s/iter; left time: 232.8655s
	iters: 300, epoch: 30 | loss: 0.0009587
	speed: 0.8504s/iter; left time: 144.5651s
	iters: 400, epoch: 30 | loss: 0.0017742
	speed: 0.8598s/iter; left time: 60.1841s
Epoch: 30 cost time: 404.10298204421997
Epoch: 30, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 28126602
model size : 108.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3700089
	speed: 0.3545s/iter; left time: 4952.6291s
	iters: 200, epoch: 1 | loss: 0.2117493
	speed: 0.3349s/iter; left time: 4644.8033s
	iters: 300, epoch: 1 | loss: 0.1101028
	speed: 0.3371s/iter; left time: 4641.6122s
	iters: 400, epoch: 1 | loss: 0.0396783
	speed: 0.3376s/iter; left time: 4614.7726s
Epoch: 1 cost time: 160.08294010162354
Epoch: 1, Steps: 469 | Train Loss: 0.401 Vali Loss: 0.146 Vali Acc: 0.954 Test Loss: 0.146 Test Acc: 0.954
Validation loss decreased (inf --> -0.954258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0081251
	speed: 1.3571s/iter; left time: 18323.6558s
	iters: 200, epoch: 2 | loss: 0.0459411
	speed: 0.3540s/iter; left time: 4744.1636s
	iters: 300, epoch: 2 | loss: 0.1743540
	speed: 0.3435s/iter; left time: 4569.2652s
	iters: 400, epoch: 2 | loss: 0.0404403
	speed: 0.3334s/iter; left time: 4401.2128s
Epoch: 2 cost time: 160.13216948509216
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.954258 --> -0.971411).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0250592
	speed: 1.3446s/iter; left time: 17524.2780s
	iters: 200, epoch: 3 | loss: 0.0014337
	speed: 0.3341s/iter; left time: 4321.4961s
	iters: 300, epoch: 3 | loss: 0.0271267
	speed: 0.3380s/iter; left time: 4337.4373s
	iters: 400, epoch: 3 | loss: 0.0043246
	speed: 0.3369s/iter; left time: 4289.5015s
Epoch: 3 cost time: 158.40063047409058
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972841).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0035733
	speed: 1.3752s/iter; left time: 17277.9802s
	iters: 200, epoch: 4 | loss: 0.0718936
	speed: 0.3275s/iter; left time: 4082.0694s
	iters: 300, epoch: 4 | loss: 0.0030156
	speed: 0.3175s/iter; left time: 3925.4901s
	iters: 400, epoch: 4 | loss: 0.0013776
	speed: 0.3189s/iter; left time: 3911.0630s
Epoch: 4 cost time: 153.23991084098816
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0017817
	speed: 1.2853s/iter; left time: 15545.4369s
	iters: 200, epoch: 5 | loss: 0.0050133
	speed: 0.3234s/iter; left time: 3879.6795s
	iters: 300, epoch: 5 | loss: 0.2063998
	speed: 0.3223s/iter; left time: 3834.1634s
	iters: 400, epoch: 5 | loss: 0.0103776
	speed: 0.3232s/iter; left time: 3812.2597s
Epoch: 5 cost time: 151.26546478271484
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0092885
	speed: 1.3061s/iter; left time: 15184.6907s
	iters: 200, epoch: 6 | loss: 0.0015561
	speed: 0.3188s/iter; left time: 3674.5991s
	iters: 300, epoch: 6 | loss: 0.0238886
	speed: 0.3192s/iter; left time: 3647.1802s
	iters: 400, epoch: 6 | loss: 0.0006382
	speed: 0.3228s/iter; left time: 3655.7309s
Epoch: 6 cost time: 151.32138633728027
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.972841 --> -0.975414).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0845792
	speed: 1.2912s/iter; left time: 14405.9618s
	iters: 200, epoch: 7 | loss: 0.0023921
	speed: 0.3218s/iter; left time: 3558.5966s
	iters: 300, epoch: 7 | loss: 0.0091276
	speed: 0.3225s/iter; left time: 3534.0309s
	iters: 400, epoch: 7 | loss: 0.0240963
	speed: 0.3164s/iter; left time: 3435.1264s
Epoch: 7 cost time: 151.54990434646606
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.975414 --> -0.978272).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0014172
	speed: 1.3097s/iter; left time: 13997.9517s
	iters: 200, epoch: 8 | loss: 0.0026277
	speed: 0.3221s/iter; left time: 3409.9815s
	iters: 300, epoch: 8 | loss: 0.0004476
	speed: 0.3256s/iter; left time: 3415.1337s
	iters: 400, epoch: 8 | loss: 0.0005729
	speed: 0.3271s/iter; left time: 3398.3793s
Epoch: 8 cost time: 151.91563534736633
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0107127
	speed: 1.2803s/iter; left time: 13083.0198s
	iters: 200, epoch: 9 | loss: 0.0038356
	speed: 0.3156s/iter; left time: 3193.2132s
	iters: 300, epoch: 9 | loss: 0.0030268
	speed: 0.3192s/iter; left time: 3198.2757s
	iters: 400, epoch: 9 | loss: 0.0002521
	speed: 0.3303s/iter; left time: 3276.3624s
Epoch: 9 cost time: 152.36889243125916
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0007026
	speed: 1.3595s/iter; left time: 13254.7281s
	iters: 200, epoch: 10 | loss: 0.0005198
	speed: 0.3399s/iter; left time: 3279.9358s
	iters: 300, epoch: 10 | loss: 0.0013497
	speed: 0.3426s/iter; left time: 3272.1658s
	iters: 400, epoch: 10 | loss: 0.0012013
	speed: 0.3282s/iter; left time: 3101.6506s
Epoch: 10 cost time: 158.53235030174255
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3472196
	speed: 1.3341s/iter; left time: 12381.6637s
	iters: 200, epoch: 11 | loss: 0.0073394
	speed: 0.3396s/iter; left time: 3117.5346s
	iters: 300, epoch: 11 | loss: 0.0023570
	speed: 0.3456s/iter; left time: 3138.0042s
	iters: 400, epoch: 11 | loss: 0.0007003
	speed: 0.3468s/iter; left time: 3114.6701s
Epoch: 11 cost time: 160.0047960281372
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0006410
	speed: 1.3670s/iter; left time: 12046.3058s
	iters: 200, epoch: 12 | loss: 0.0004219
	speed: 0.3378s/iter; left time: 2943.1778s
	iters: 300, epoch: 12 | loss: 0.0003607
	speed: 0.3270s/iter; left time: 2816.3921s
	iters: 400, epoch: 12 | loss: 0.0276981
	speed: 0.3267s/iter; left time: 2781.1448s
Epoch: 12 cost time: 155.70239996910095
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0026573
	speed: 1.2625s/iter; left time: 10533.1747s
	iters: 200, epoch: 13 | loss: 0.0027304
	speed: 0.3351s/iter; left time: 2762.2300s
	iters: 300, epoch: 13 | loss: 0.0024591
	speed: 0.3162s/iter; left time: 2574.4525s
	iters: 400, epoch: 13 | loss: 0.0035459
	speed: 0.3210s/iter; left time: 2581.6258s
Epoch: 13 cost time: 153.31687998771667
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0001689
	speed: 1.3341s/iter; left time: 10504.5155s
	iters: 200, epoch: 14 | loss: 0.0008926
	speed: 0.3055s/iter; left time: 2375.0829s
	iters: 300, epoch: 14 | loss: 0.0004106
	speed: 0.2993s/iter; left time: 2296.5984s
	iters: 400, epoch: 14 | loss: 0.0003844
	speed: 0.3094s/iter; left time: 2343.1587s
Epoch: 14 cost time: 146.50404930114746
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0033666
	speed: 1.2658s/iter; left time: 9373.4732s
	iters: 200, epoch: 15 | loss: 0.0292962
	speed: 0.3154s/iter; left time: 2304.3481s
	iters: 300, epoch: 15 | loss: 0.0004886
	speed: 0.3266s/iter; left time: 2353.3293s
	iters: 400, epoch: 15 | loss: 0.0008038
	speed: 0.3088s/iter; left time: 2193.7521s
Epoch: 15 cost time: 149.66863107681274
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0007683
	speed: 1.2275s/iter; left time: 8513.7182s
	iters: 200, epoch: 16 | loss: 0.0025971
	speed: 0.3127s/iter; left time: 2137.3014s
	iters: 300, epoch: 16 | loss: 0.0003185
	speed: 0.3184s/iter; left time: 2144.7968s
	iters: 400, epoch: 16 | loss: 0.0020212
	speed: 0.2990s/iter; left time: 1984.1977s
Epoch: 16 cost time: 142.2490816116333
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0002838
	speed: 1.2454s/iter; left time: 8054.1811s
	iters: 200, epoch: 17 | loss: 0.5823479
	speed: 0.3253s/iter; left time: 2070.9416s
	iters: 300, epoch: 17 | loss: 0.0035464
	speed: 0.2978s/iter; left time: 1866.2841s
	iters: 400, epoch: 17 | loss: 0.0135366
	speed: 0.2970s/iter; left time: 1831.4647s
Epoch: 17 cost time: 147.1752803325653
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 8267274
model size : 32.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6122287
	speed: 0.5523s/iter; left time: 7716.3846s
	iters: 200, epoch: 1 | loss: 0.1259844
	speed: 0.5824s/iter; left time: 8078.3874s
	iters: 300, epoch: 1 | loss: 0.0441089
	speed: 0.5343s/iter; left time: 7357.4322s
	iters: 400, epoch: 1 | loss: 0.2530467
	speed: 0.5605s/iter; left time: 7662.8277s
Epoch: 1 cost time: 264.29466700553894
Epoch: 1, Steps: 469 | Train Loss: 0.410 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
Validation loss decreased (inf --> -0.957689).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0585645
	speed: 2.0466s/iter; left time: 27633.5929s
	iters: 200, epoch: 2 | loss: 0.0047489
	speed: 0.5258s/iter; left time: 7046.3781s
	iters: 300, epoch: 2 | loss: 0.1813584
	speed: 0.5556s/iter; left time: 7390.8359s
	iters: 400, epoch: 2 | loss: 0.0109218
	speed: 0.5718s/iter; left time: 7548.7904s
Epoch: 2 cost time: 260.11428928375244
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.957689 --> -0.958546).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0448137
	speed: 2.0539s/iter; left time: 26768.3832s
	iters: 200, epoch: 3 | loss: 0.0762935
	speed: 0.5330s/iter; left time: 6892.8536s
	iters: 300, epoch: 3 | loss: 0.0080250
	speed: 0.5417s/iter; left time: 6951.5129s
	iters: 400, epoch: 3 | loss: 0.0043067
	speed: 0.5789s/iter; left time: 7370.5233s
Epoch: 3 cost time: 258.3782844543457
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.958546 --> -0.961691).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0047693
	speed: 2.0746s/iter; left time: 26065.8979s
	iters: 200, epoch: 4 | loss: 0.0037770
	speed: 0.5297s/iter; left time: 6602.3929s
	iters: 300, epoch: 4 | loss: 0.0576464
	speed: 0.5871s/iter; left time: 7258.6156s
	iters: 400, epoch: 4 | loss: 0.0809088
	speed: 0.6003s/iter; left time: 7362.6845s
Epoch: 4 cost time: 266.0468864440918
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0040505
	speed: 2.1443s/iter; left time: 25935.8097s
	iters: 200, epoch: 5 | loss: 0.0008588
	speed: 0.5718s/iter; left time: 6859.0989s
	iters: 300, epoch: 5 | loss: 0.0096976
	speed: 0.5845s/iter; left time: 6952.8089s
	iters: 400, epoch: 5 | loss: 0.0097823
	speed: 0.5440s/iter; left time: 6416.9796s
Epoch: 5 cost time: 265.23495841026306
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.961691 --> -0.976271).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0015924
	speed: 2.2020s/iter; left time: 25600.4650s
	iters: 200, epoch: 6 | loss: 0.0048494
	speed: 0.5802s/iter; left time: 6687.5743s
	iters: 300, epoch: 6 | loss: 0.0013633
	speed: 0.5508s/iter; left time: 6293.3237s
	iters: 400, epoch: 6 | loss: 0.0023768
	speed: 0.5632s/iter; left time: 6378.7976s
Epoch: 6 cost time: 268.56182169914246
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.979416).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0011964
	speed: 2.0933s/iter; left time: 23354.3945s
	iters: 200, epoch: 7 | loss: 0.0028279
	speed: 0.5565s/iter; left time: 6152.9232s
	iters: 300, epoch: 7 | loss: 0.0017210
	speed: 0.5314s/iter; left time: 5822.2802s
	iters: 400, epoch: 7 | loss: 0.0012266
	speed: 0.5671s/iter; left time: 6157.3773s
Epoch: 7 cost time: 264.4733715057373
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0029419
	speed: 2.0797s/iter; left time: 22227.5534s
	iters: 200, epoch: 8 | loss: 0.0006967
	speed: 0.5860s/iter; left time: 6204.5243s
	iters: 300, epoch: 8 | loss: 0.0061592
	speed: 0.5724s/iter; left time: 6003.4327s
	iters: 400, epoch: 8 | loss: 0.0042163
	speed: 0.5498s/iter; left time: 5711.5043s
Epoch: 8 cost time: 264.72469329833984
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0355766
	speed: 2.0957s/iter; left time: 21415.6967s
	iters: 200, epoch: 9 | loss: 0.0175749
	speed: 0.4967s/iter; left time: 5026.0600s
	iters: 300, epoch: 9 | loss: 0.0005730
	speed: 0.5374s/iter; left time: 5384.1104s
	iters: 400, epoch: 9 | loss: 0.0160798
	speed: 0.5349s/iter; left time: 5305.6934s
Epoch: 9 cost time: 239.89318251609802
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0011735
	speed: 1.4361s/iter; left time: 14001.7020s
	iters: 200, epoch: 10 | loss: 0.1257379
	speed: 0.4163s/iter; left time: 4016.8214s
	iters: 300, epoch: 10 | loss: 0.0011697
	speed: 0.4190s/iter; left time: 4001.8553s
	iters: 400, epoch: 10 | loss: 0.0003739
	speed: 0.3751s/iter; left time: 3544.8028s
Epoch: 10 cost time: 188.42604160308838
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0073310
	speed: 1.4836s/iter; left time: 13769.0218s
	iters: 200, epoch: 11 | loss: 0.0007404
	speed: 0.4001s/iter; left time: 3673.2696s
	iters: 300, epoch: 11 | loss: 0.0002185
	speed: 0.4512s/iter; left time: 4097.7647s
	iters: 400, epoch: 11 | loss: 0.0005162
	speed: 0.4143s/iter; left time: 3721.2661s
Epoch: 11 cost time: 189.49523067474365
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0027285
	speed: 1.4716s/iter; left time: 12967.6013s
	iters: 200, epoch: 12 | loss: 0.0816478
	speed: 0.4332s/iter; left time: 3774.4017s
	iters: 300, epoch: 12 | loss: 0.0001886
	speed: 0.3774s/iter; left time: 3249.9263s
	iters: 400, epoch: 12 | loss: 0.0154409
	speed: 0.4183s/iter; left time: 3560.1446s
Epoch: 12 cost time: 202.59769773483276
Epoch: 12, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0004372
	speed: 1.5880s/iter; left time: 13248.8967s
	iters: 200, epoch: 13 | loss: 0.0019408
	speed: 0.4554s/iter; left time: 3753.5701s
	iters: 300, epoch: 13 | loss: 0.0011500
	speed: 0.4732s/iter; left time: 3853.1614s
	iters: 400, epoch: 13 | loss: 0.0015885
	speed: 0.4398s/iter; left time: 3537.2214s
Epoch: 13 cost time: 203.08038592338562
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0016515
	speed: 1.5218s/iter; left time: 11982.8480s
	iters: 200, epoch: 14 | loss: 0.0037502
	speed: 0.4068s/iter; left time: 3162.3053s
	iters: 300, epoch: 14 | loss: 0.0014240
	speed: 0.3899s/iter; left time: 2992.4674s
	iters: 400, epoch: 14 | loss: 0.0019809
	speed: 0.4569s/iter; left time: 3460.3817s
Epoch: 14 cost time: 205.27857065200806
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0007939
	speed: 1.5580s/iter; left time: 11537.3091s
	iters: 200, epoch: 15 | loss: 0.0020055
	speed: 0.4746s/iter; left time: 3466.6470s
	iters: 300, epoch: 15 | loss: 0.0018056
	speed: 0.4712s/iter; left time: 3394.7400s
	iters: 400, epoch: 15 | loss: 0.0081583
	speed: 0.4040s/iter; left time: 2870.0795s
Epoch: 15 cost time: 201.84081172943115
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001935
	speed: 1.4870s/iter; left time: 10314.0574s
	iters: 200, epoch: 16 | loss: 0.0027948
	speed: 0.3358s/iter; left time: 2295.5733s
	iters: 300, epoch: 16 | loss: 0.0354840
	speed: 0.3549s/iter; left time: 2390.4020s
	iters: 400, epoch: 16 | loss: 0.0154226
	speed: 0.3688s/iter; left time: 2447.4456s
Epoch: 16 cost time: 170.68887305259705
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0001726
	speed: 1.4231s/iter; left time: 9203.2714s
	iters: 200, epoch: 17 | loss: 0.0000871
	speed: 0.3932s/iter; left time: 2503.7188s
	iters: 300, epoch: 17 | loss: 0.0014136
	speed: 0.3771s/iter; left time: 2363.3506s
	iters: 400, epoch: 17 | loss: 0.0003618
	speed: 0.4162s/iter; left time: 2566.8598s
Epoch: 17 cost time: 190.9289059638977
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0508168
	speed: 1.6273s/iter; left time: 9760.6861s
	iters: 200, epoch: 18 | loss: 0.0029420
	speed: 0.4355s/iter; left time: 2568.6414s
	iters: 300, epoch: 18 | loss: 0.0031873
	speed: 0.4793s/iter; left time: 2778.9881s
	iters: 400, epoch: 18 | loss: 0.0157356
	speed: 0.4791s/iter; left time: 2729.8880s
Epoch: 18 cost time: 210.34233212471008
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 28126602
model size : 108.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3842368
	speed: 0.2120s/iter; left time: 2962.2989s
	iters: 200, epoch: 1 | loss: 0.2359969
	speed: 0.1772s/iter; left time: 2457.3992s
	iters: 300, epoch: 1 | loss: 0.1480735
	speed: 0.1645s/iter; left time: 2264.9295s
	iters: 400, epoch: 1 | loss: 0.0681931
	speed: 0.1401s/iter; left time: 1915.8966s
Epoch: 1 cost time: 79.23635220527649
Epoch: 1, Steps: 469 | Train Loss: 0.415 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (inf --> -0.969410).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0711866
	speed: 0.6329s/iter; left time: 8545.3115s
	iters: 200, epoch: 2 | loss: 0.1473096
	speed: 0.1642s/iter; left time: 2200.8305s
	iters: 300, epoch: 2 | loss: 0.1407514
	speed: 0.1723s/iter; left time: 2291.4201s
	iters: 400, epoch: 2 | loss: 0.0854025
	speed: 0.1643s/iter; left time: 2169.3251s
Epoch: 2 cost time: 76.87842798233032
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.140 Vali Acc: 0.953 Test Loss: 0.140 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0148074
	speed: 0.6536s/iter; left time: 8517.9334s
	iters: 200, epoch: 3 | loss: 0.0101470
	speed: 0.1562s/iter; left time: 2019.8493s
	iters: 300, epoch: 3 | loss: 0.0054542
	speed: 0.1575s/iter; left time: 2021.7344s
	iters: 400, epoch: 3 | loss: 0.0133347
	speed: 0.1571s/iter; left time: 2000.4522s
Epoch: 3 cost time: 74.132488489151
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.969410 --> -0.978558).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0252026
	speed: 0.6542s/iter; left time: 8219.8604s
	iters: 200, epoch: 4 | loss: 0.0048640
	speed: 0.1572s/iter; left time: 1958.8050s
	iters: 300, epoch: 4 | loss: 0.0124668
	speed: 0.1565s/iter; left time: 1934.9340s
	iters: 400, epoch: 4 | loss: 0.0007810
	speed: 0.1681s/iter; left time: 2061.2213s
Epoch: 4 cost time: 75.84727811813354
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0049444
	speed: 0.7148s/iter; left time: 8644.9943s
	iters: 200, epoch: 5 | loss: 0.0021506
	speed: 0.1643s/iter; left time: 1970.8668s
	iters: 300, epoch: 5 | loss: 0.0045749
	speed: 0.1633s/iter; left time: 1942.9548s
	iters: 400, epoch: 5 | loss: 0.0208164
	speed: 0.1628s/iter; left time: 1919.7159s
Epoch: 5 cost time: 78.51947712898254
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.223 Vali Acc: 0.945 Test Loss: 0.223 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0010155
	speed: 0.7139s/iter; left time: 8299.8570s
	iters: 200, epoch: 6 | loss: 0.0067863
	speed: 0.1643s/iter; left time: 1893.2900s
	iters: 300, epoch: 6 | loss: 0.0075313
	speed: 0.1837s/iter; left time: 2098.4082s
	iters: 400, epoch: 6 | loss: 0.0012855
	speed: 0.1788s/iter; left time: 2025.3094s
Epoch: 6 cost time: 79.1390929222107
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0196357
	speed: 0.6659s/iter; left time: 7429.2699s
	iters: 200, epoch: 7 | loss: 0.0010067
	speed: 0.1600s/iter; left time: 1769.3990s
	iters: 300, epoch: 7 | loss: 0.0150243
	speed: 0.1585s/iter; left time: 1736.8304s
	iters: 400, epoch: 7 | loss: 0.0006048
	speed: 0.1656s/iter; left time: 1797.9561s
Epoch: 7 cost time: 77.85936641693115
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0005230
	speed: 0.7302s/iter; left time: 7804.3593s
	iters: 200, epoch: 8 | loss: 0.0010267
	speed: 0.1589s/iter; left time: 1682.9248s
	iters: 300, epoch: 8 | loss: 0.0017385
	speed: 0.1661s/iter; left time: 1742.0917s
	iters: 400, epoch: 8 | loss: 0.0015391
	speed: 0.1711s/iter; left time: 1777.2582s
Epoch: 8 cost time: 77.34340929985046
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0809615
	speed: 0.6255s/iter; left time: 6391.6934s
	iters: 200, epoch: 9 | loss: 0.0039603
	speed: 0.1629s/iter; left time: 1648.1882s
	iters: 300, epoch: 9 | loss: 0.0011112
	speed: 0.1451s/iter; left time: 1454.1832s
	iters: 400, epoch: 9 | loss: 0.0104209
	speed: 0.1427s/iter; left time: 1415.2913s
Epoch: 9 cost time: 71.58026623725891
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981989).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0012599
	speed: 0.6248s/iter; left time: 6092.1452s
	iters: 200, epoch: 10 | loss: 0.0010386
	speed: 0.1313s/iter; left time: 1267.2607s
	iters: 300, epoch: 10 | loss: 0.0074799
	speed: 0.1342s/iter; left time: 1281.3396s
	iters: 400, epoch: 10 | loss: 0.0058528
	speed: 0.1497s/iter; left time: 1414.5563s
Epoch: 10 cost time: 65.17955160140991
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0011791
	speed: 0.6103s/iter; left time: 5663.7392s
	iters: 200, epoch: 11 | loss: 0.0006989
	speed: 0.1625s/iter; left time: 1491.5758s
	iters: 300, epoch: 11 | loss: 0.0017711
	speed: 0.1553s/iter; left time: 1410.2814s
	iters: 400, epoch: 11 | loss: 0.0012694
	speed: 0.1447s/iter; left time: 1299.2013s
Epoch: 11 cost time: 71.804603099823
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0219817
	speed: 0.5966s/iter; left time: 5257.4876s
	iters: 200, epoch: 12 | loss: 0.0334347
	speed: 0.1285s/iter; left time: 1119.5607s
	iters: 300, epoch: 12 | loss: 0.0009623
	speed: 0.1290s/iter; left time: 1111.0671s
	iters: 400, epoch: 12 | loss: 0.2250633
	speed: 0.1697s/iter; left time: 1444.2708s
Epoch: 12 cost time: 68.82350063323975
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0003117
	speed: 0.7243s/iter; left time: 6042.8385s
	iters: 200, epoch: 13 | loss: 0.0019087
	speed: 0.1841s/iter; left time: 1517.3068s
	iters: 300, epoch: 13 | loss: 0.0033839
	speed: 0.1784s/iter; left time: 1452.5468s
	iters: 400, epoch: 13 | loss: 0.0004382
	speed: 0.1540s/iter; left time: 1238.8167s
Epoch: 13 cost time: 79.319326877594
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0003251
	speed: 0.6744s/iter; left time: 5309.8857s
	iters: 200, epoch: 14 | loss: 0.0004690
	speed: 0.1654s/iter; left time: 1286.1877s
	iters: 300, epoch: 14 | loss: 0.0005471
	speed: 0.1652s/iter; left time: 1267.5363s
	iters: 400, epoch: 14 | loss: 0.0004649
	speed: 0.1719s/iter; left time: 1302.1918s
Epoch: 14 cost time: 79.86208271980286
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0006227
	speed: 0.7192s/iter; left time: 5325.5286s
	iters: 200, epoch: 15 | loss: 0.0009284
	speed: 0.1636s/iter; left time: 1195.1727s
	iters: 300, epoch: 15 | loss: 0.0005593
	speed: 0.1712s/iter; left time: 1233.4530s
	iters: 400, epoch: 15 | loss: 0.5173945
	speed: 0.1630s/iter; left time: 1158.1169s
Epoch: 15 cost time: 76.42694091796875
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0021343
	speed: 0.7016s/iter; left time: 4866.5919s
	iters: 200, epoch: 16 | loss: 0.0023451
	speed: 0.1720s/iter; left time: 1176.0255s
	iters: 300, epoch: 16 | loss: 0.0003295
	speed: 0.1456s/iter; left time: 981.0567s
	iters: 400, epoch: 16 | loss: 0.0098692
	speed: 0.1444s/iter; left time: 958.5358s
Epoch: 16 cost time: 75.89112782478333
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0001097
	speed: 0.6042s/iter; left time: 3907.6473s
	iters: 200, epoch: 17 | loss: 0.0032553
	speed: 0.1311s/iter; left time: 834.7206s
	iters: 300, epoch: 17 | loss: 0.0007748
	speed: 0.1485s/iter; left time: 930.7322s
	iters: 400, epoch: 17 | loss: 0.0082226
	speed: 0.1487s/iter; left time: 917.0801s
Epoch: 17 cost time: 66.53239321708679
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0004122
	speed: 0.5982s/iter; left time: 3587.9665s
	iters: 200, epoch: 18 | loss: 0.0001248
	speed: 0.1175s/iter; left time: 692.9940s
	iters: 300, epoch: 18 | loss: 0.0001657
	speed: 0.1694s/iter; left time: 982.3298s
	iters: 400, epoch: 18 | loss: 0.0038294
	speed: 0.1660s/iter; left time: 945.7403s
Epoch: 18 cost time: 71.02269339561462
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0001500
	speed: 0.6724s/iter; left time: 3717.9608s
	iters: 200, epoch: 19 | loss: 0.0057293
	speed: 0.1633s/iter; left time: 886.6538s
	iters: 300, epoch: 19 | loss: 0.0000686
	speed: 0.1711s/iter; left time: 911.8720s
	iters: 400, epoch: 19 | loss: 0.0011051
	speed: 0.1670s/iter; left time: 873.1094s
Epoch: 19 cost time: 78.09903693199158
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 8267274
model size : 32.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7992726
	speed: 0.2856s/iter; left time: 3989.7967s
	iters: 200, epoch: 1 | loss: 0.2241348
	speed: 0.2685s/iter; left time: 3724.0582s
	iters: 300, epoch: 1 | loss: 0.0796125
	speed: 0.2738s/iter; left time: 3769.9885s
	iters: 400, epoch: 1 | loss: 0.1447139
	speed: 0.2824s/iter; left time: 3860.5120s
Epoch: 1 cost time: 131.48987555503845
Epoch: 1, Steps: 469 | Train Loss: 0.465 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
Validation loss decreased (inf --> -0.956545).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2106264
	speed: 1.0956s/iter; left time: 14792.8059s
	iters: 200, epoch: 2 | loss: 0.0170652
	speed: 0.2588s/iter; left time: 3468.1676s
	iters: 300, epoch: 2 | loss: 0.1733426
	speed: 0.2604s/iter; left time: 3464.0906s
	iters: 400, epoch: 2 | loss: 0.0163449
	speed: 0.2502s/iter; left time: 3303.7342s
Epoch: 2 cost time: 123.93658518791199
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
Validation loss decreased (-0.956545 --> -0.966837).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0199181
	speed: 1.0948s/iter; left time: 14268.4503s
	iters: 200, epoch: 3 | loss: 0.0258189
	speed: 0.2930s/iter; left time: 3789.8923s
	iters: 300, epoch: 3 | loss: 0.0074537
	speed: 0.2829s/iter; left time: 3629.9916s
	iters: 400, epoch: 3 | loss: 0.1029863
	speed: 0.2641s/iter; left time: 3363.2187s
Epoch: 3 cost time: 130.0298490524292
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.966837 --> -0.972841).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102026
	speed: 0.8632s/iter; left time: 10845.2203s
	iters: 200, epoch: 4 | loss: 0.0023572
	speed: 0.2323s/iter; left time: 2894.8416s
	iters: 300, epoch: 4 | loss: 0.0544591
	speed: 0.2126s/iter; left time: 2628.5608s
	iters: 400, epoch: 4 | loss: 0.0609299
	speed: 0.2126s/iter; left time: 2607.7070s
Epoch: 4 cost time: 104.76598501205444
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.966 Test Loss: 0.109 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0010802
	speed: 0.8279s/iter; left time: 10013.6907s
	iters: 200, epoch: 5 | loss: 0.0017210
	speed: 0.1998s/iter; left time: 2396.4069s
	iters: 300, epoch: 5 | loss: 0.0909904
	speed: 0.2258s/iter; left time: 2685.8642s
	iters: 400, epoch: 5 | loss: 0.0056488
	speed: 0.2253s/iter; left time: 2657.8101s
Epoch: 5 cost time: 100.95574712753296
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0025097
	speed: 0.8468s/iter; left time: 9844.4780s
	iters: 200, epoch: 6 | loss: 0.0529652
	speed: 0.2427s/iter; left time: 2797.1559s
	iters: 300, epoch: 6 | loss: 0.0025315
	speed: 0.2421s/iter; left time: 2766.3478s
	iters: 400, epoch: 6 | loss: 0.0043936
	speed: 0.2312s/iter; left time: 2618.5217s
Epoch: 6 cost time: 111.5338876247406
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0018549
	speed: 0.9466s/iter; left time: 10561.5228s
	iters: 200, epoch: 7 | loss: 0.0130389
	speed: 0.2650s/iter; left time: 2929.8384s
	iters: 300, epoch: 7 | loss: 0.0092130
	speed: 0.2442s/iter; left time: 2675.6903s
	iters: 400, epoch: 7 | loss: 0.0002203
	speed: 0.2428s/iter; left time: 2635.6793s
Epoch: 7 cost time: 119.48497581481934
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0015964
	speed: 1.0005s/iter; left time: 10693.7958s
	iters: 200, epoch: 8 | loss: 0.0009756
	speed: 0.2294s/iter; left time: 2428.8392s
	iters: 300, epoch: 8 | loss: 0.0014451
	speed: 0.2350s/iter; left time: 2464.6886s
	iters: 400, epoch: 8 | loss: 0.0946902
	speed: 0.2573s/iter; left time: 2672.4497s
Epoch: 8 cost time: 114.97369837760925
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.974270).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0014154
	speed: 0.9849s/iter; left time: 10064.2057s
	iters: 200, epoch: 9 | loss: 0.0005790
	speed: 0.2636s/iter; left time: 2667.3592s
	iters: 300, epoch: 9 | loss: 0.0031206
	speed: 0.2506s/iter; left time: 2511.2183s
	iters: 400, epoch: 9 | loss: 0.0008913
	speed: 0.2296s/iter; left time: 2277.0438s
Epoch: 9 cost time: 113.41235423088074
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.974270 --> -0.979702).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0058739
	speed: 0.8048s/iter; left time: 7846.8820s
	iters: 200, epoch: 10 | loss: 0.0013134
	speed: 0.2370s/iter; left time: 2287.2221s
	iters: 300, epoch: 10 | loss: 0.0010095
	speed: 0.2332s/iter; left time: 2227.3791s
	iters: 400, epoch: 10 | loss: 0.0030804
	speed: 0.2145s/iter; left time: 2027.0133s
Epoch: 10 cost time: 106.29817914962769
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0009637
	speed: 0.8586s/iter; left time: 7968.2575s
	iters: 200, epoch: 11 | loss: 0.0008091
	speed: 0.2014s/iter; left time: 1849.2928s
	iters: 300, epoch: 11 | loss: 0.0000832
	speed: 0.1925s/iter; left time: 1748.4563s
	iters: 400, epoch: 11 | loss: 0.0949183
	speed: 0.2008s/iter; left time: 1803.4356s
Epoch: 11 cost time: 98.22126412391663
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.197 Vali Acc: 0.945 Test Loss: 0.197 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0088275
	speed: 0.8787s/iter; left time: 7743.3415s
	iters: 200, epoch: 12 | loss: 0.0064625
	speed: 0.2424s/iter; left time: 2112.0573s
	iters: 300, epoch: 12 | loss: 0.0009112
	speed: 0.2580s/iter; left time: 2222.0482s
	iters: 400, epoch: 12 | loss: 0.0142605
	speed: 0.2619s/iter; left time: 2229.4161s
Epoch: 12 cost time: 116.39867067337036
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0011613
	speed: 0.9129s/iter; left time: 7616.1412s
	iters: 200, epoch: 13 | loss: 0.0002036
	speed: 0.2628s/iter; left time: 2166.2571s
	iters: 300, epoch: 13 | loss: 0.0004998
	speed: 0.2694s/iter; left time: 2193.8959s
	iters: 400, epoch: 13 | loss: 0.0003737
	speed: 0.2668s/iter; left time: 2145.9559s
Epoch: 13 cost time: 120.20983076095581
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1632205
	speed: 0.9616s/iter; left time: 7571.4778s
	iters: 200, epoch: 14 | loss: 0.0017910
	speed: 0.2582s/iter; left time: 2007.2509s
	iters: 300, epoch: 14 | loss: 0.0009378
	speed: 0.2305s/iter; left time: 1769.0020s
	iters: 400, epoch: 14 | loss: 0.0461870
	speed: 0.2321s/iter; left time: 1757.8429s
Epoch: 14 cost time: 114.19376063346863
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0768697
	speed: 0.9571s/iter; left time: 7087.1761s
	iters: 200, epoch: 15 | loss: 0.0015121
	speed: 0.2103s/iter; left time: 1536.4254s
	iters: 300, epoch: 15 | loss: 0.0069831
	speed: 0.2124s/iter; left time: 1530.5795s
	iters: 400, epoch: 15 | loss: 0.0008356
	speed: 0.2238s/iter; left time: 1589.8626s
Epoch: 15 cost time: 104.19505524635315
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0010475
	speed: 0.8007s/iter; left time: 5553.9644s
	iters: 200, epoch: 16 | loss: 0.0001610
	speed: 0.1955s/iter; left time: 1336.7323s
	iters: 300, epoch: 16 | loss: 0.0002605
	speed: 0.2127s/iter; left time: 1432.8508s
	iters: 400, epoch: 16 | loss: 0.0016660
	speed: 0.1816s/iter; left time: 1205.0087s
Epoch: 16 cost time: 95.74771618843079
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0012676
	speed: 0.8844s/iter; left time: 5719.1615s
	iters: 200, epoch: 17 | loss: 0.0001619
	speed: 0.2084s/iter; left time: 1326.8732s
	iters: 300, epoch: 17 | loss: 0.2000151
	speed: 0.2080s/iter; left time: 1303.7712s
	iters: 400, epoch: 17 | loss: 0.0001784
	speed: 0.2253s/iter; left time: 1389.4970s
Epoch: 17 cost time: 100.89727354049683
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0086848
	speed: 0.8612s/iter; left time: 5165.3983s
	iters: 200, epoch: 18 | loss: 0.0003828
	speed: 0.2176s/iter; left time: 1283.3887s
	iters: 300, epoch: 18 | loss: 0.0007587
	speed: 0.2533s/iter; left time: 1468.4886s
	iters: 400, epoch: 18 | loss: 0.0860880
	speed: 0.2448s/iter; left time: 1394.7648s
Epoch: 18 cost time: 109.14978575706482
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000812
	speed: 0.8812s/iter; left time: 4872.4117s
	iters: 200, epoch: 19 | loss: 0.0001749
	speed: 0.2387s/iter; left time: 1295.9137s
	iters: 300, epoch: 19 | loss: 0.0021567
	speed: 0.2366s/iter; left time: 1260.6804s
	iters: 400, epoch: 19 | loss: 0.0004975
	speed: 0.2300s/iter; left time: 1202.5431s
Epoch: 19 cost time: 112.44003772735596
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 28126602
model size : 108.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5784933
	speed: 0.1354s/iter; left time: 1891.9755s
	iters: 200, epoch: 1 | loss: 0.3179594
	speed: 0.1159s/iter; left time: 1607.8949s
	iters: 300, epoch: 1 | loss: 0.2112820
	speed: 0.1086s/iter; left time: 1495.4346s
	iters: 400, epoch: 1 | loss: 0.1381831
	speed: 0.1015s/iter; left time: 1387.0767s
Epoch: 1 cost time: 53.46185088157654
Epoch: 1, Steps: 469 | Train Loss: 0.491 Vali Loss: 0.149 Vali Acc: 0.948 Test Loss: 0.149 Test Acc: 0.948
Validation loss decreased (inf --> -0.947969).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0839166
	speed: 0.4955s/iter; left time: 6690.1336s
	iters: 200, epoch: 2 | loss: 0.0771731
	speed: 0.1096s/iter; left time: 1468.6607s
	iters: 300, epoch: 2 | loss: 0.3454913
	speed: 0.1100s/iter; left time: 1463.8126s
	iters: 400, epoch: 2 | loss: 0.0752086
	speed: 0.0880s/iter; left time: 1162.0987s
Epoch: 2 cost time: 48.03991436958313
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
Validation loss decreased (-0.947969 --> -0.973698).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0475868
	speed: 0.4021s/iter; left time: 5241.1387s
	iters: 200, epoch: 3 | loss: 0.0050794
	speed: 0.1096s/iter; left time: 1416.9777s
	iters: 300, epoch: 3 | loss: 0.0306448
	speed: 0.1091s/iter; left time: 1400.2500s
	iters: 400, epoch: 3 | loss: 0.0085177
	speed: 0.1066s/iter; left time: 1357.6206s
Epoch: 3 cost time: 49.372161865234375
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0035222
	speed: 0.4149s/iter; left time: 5213.2402s
	iters: 200, epoch: 4 | loss: 0.2767681
	speed: 0.0960s/iter; left time: 1196.6159s
	iters: 300, epoch: 4 | loss: 0.0059469
	speed: 0.0944s/iter; left time: 1166.9819s
	iters: 400, epoch: 4 | loss: 0.0119123
	speed: 0.0991s/iter; left time: 1215.3017s
Epoch: 4 cost time: 45.60224771499634
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.953 Test Loss: 0.147 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0031477
	speed: 0.4555s/iter; left time: 5508.6718s
	iters: 200, epoch: 5 | loss: 0.0013178
	speed: 0.0906s/iter; left time: 1087.2667s
	iters: 300, epoch: 5 | loss: 0.0051617
	speed: 0.0983s/iter; left time: 1169.1274s
	iters: 400, epoch: 5 | loss: 0.0018652
	speed: 0.0968s/iter; left time: 1141.7616s
Epoch: 5 cost time: 45.45689916610718
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0008248
	speed: 0.4268s/iter; left time: 4962.0083s
	iters: 200, epoch: 6 | loss: 0.0044304
	speed: 0.0957s/iter; left time: 1103.5220s
	iters: 300, epoch: 6 | loss: 0.0183561
	speed: 0.1091s/iter; left time: 1246.4049s
	iters: 400, epoch: 6 | loss: 0.0268450
	speed: 0.1057s/iter; left time: 1197.0950s
Epoch: 6 cost time: 48.024367570877075
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.973698 --> -0.979988).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0057317
	speed: 0.4628s/iter; left time: 5163.2250s
	iters: 200, epoch: 7 | loss: 0.0010399
	speed: 0.1101s/iter; left time: 1217.7500s
	iters: 300, epoch: 7 | loss: 0.0103974
	speed: 0.1173s/iter; left time: 1284.9990s
	iters: 400, epoch: 7 | loss: 0.0004364
	speed: 0.1244s/iter; left time: 1350.1036s
Epoch: 7 cost time: 54.205233573913574
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.979988 --> -0.987135).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0021044
	speed: 0.5169s/iter; left time: 5524.7458s
	iters: 200, epoch: 8 | loss: 0.0010461
	speed: 0.1006s/iter; left time: 1065.1299s
	iters: 300, epoch: 8 | loss: 0.0036813
	speed: 0.1031s/iter; left time: 1081.1970s
	iters: 400, epoch: 8 | loss: 0.1214156
	speed: 0.1106s/iter; left time: 1148.9938s
Epoch: 8 cost time: 50.61699318885803
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0124943
	speed: 0.5469s/iter; left time: 5589.1523s
	iters: 200, epoch: 9 | loss: 0.0018833
	speed: 0.1017s/iter; left time: 1028.8357s
	iters: 300, epoch: 9 | loss: 0.0012963
	speed: 0.1039s/iter; left time: 1040.8138s
	iters: 400, epoch: 9 | loss: 0.0127775
	speed: 0.1007s/iter; left time: 998.6671s
Epoch: 9 cost time: 49.605170249938965
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0084279
	speed: 0.5290s/iter; left time: 5158.1953s
	iters: 200, epoch: 10 | loss: 0.0027472
	speed: 0.1120s/iter; left time: 1081.1650s
	iters: 300, epoch: 10 | loss: 0.0041380
	speed: 0.1131s/iter; left time: 1080.0987s
	iters: 400, epoch: 10 | loss: 0.0133055
	speed: 0.1035s/iter; left time: 978.3280s
Epoch: 10 cost time: 51.9745352268219
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2293376
	speed: 0.5018s/iter; left time: 4657.2250s
	iters: 200, epoch: 11 | loss: 0.0137305
	speed: 0.1136s/iter; left time: 1042.9501s
	iters: 300, epoch: 11 | loss: 0.0006171
	speed: 0.1146s/iter; left time: 1040.4486s
	iters: 400, epoch: 11 | loss: 0.0052752
	speed: 0.1128s/iter; left time: 1013.3028s
Epoch: 11 cost time: 53.78238391876221
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0003097
	speed: 0.4637s/iter; left time: 4086.4415s
	iters: 200, epoch: 12 | loss: 0.0017572
	speed: 0.0927s/iter; left time: 807.3711s
	iters: 300, epoch: 12 | loss: 0.0031684
	speed: 0.0858s/iter; left time: 739.0308s
	iters: 400, epoch: 12 | loss: 0.1615381
	speed: 0.0899s/iter; left time: 765.5701s
Epoch: 12 cost time: 43.39046287536621
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0017936
	speed: 0.4563s/iter; left time: 3806.6647s
	iters: 200, epoch: 13 | loss: 0.0795366
	speed: 0.0973s/iter; left time: 802.1418s
	iters: 300, epoch: 13 | loss: 0.0030564
	speed: 0.0876s/iter; left time: 713.4159s
	iters: 400, epoch: 13 | loss: 0.0009528
	speed: 0.0846s/iter; left time: 680.7611s
Epoch: 13 cost time: 42.74897623062134
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0003899
	speed: 0.4243s/iter; left time: 3340.9291s
	iters: 200, epoch: 14 | loss: 0.0019895
	speed: 0.0722s/iter; left time: 561.3477s
	iters: 300, epoch: 14 | loss: 0.0003137
	speed: 0.0706s/iter; left time: 541.8114s
	iters: 400, epoch: 14 | loss: 0.0002465
	speed: 0.1039s/iter; left time: 787.1164s
Epoch: 14 cost time: 41.984368324279785
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0003609
	speed: 0.4750s/iter; left time: 3517.0548s
	iters: 200, epoch: 15 | loss: 0.0004992
	speed: 0.1148s/iter; left time: 838.4855s
	iters: 300, epoch: 15 | loss: 0.0023175
	speed: 0.1096s/iter; left time: 789.6572s
	iters: 400, epoch: 15 | loss: 0.0837497
	speed: 0.1063s/iter; left time: 755.2558s
Epoch: 15 cost time: 51.41692495346069
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0280522
	speed: 0.4396s/iter; left time: 3049.0329s
	iters: 200, epoch: 16 | loss: 0.0016514
	speed: 0.0941s/iter; left time: 643.0035s
	iters: 300, epoch: 16 | loss: 0.0007088
	speed: 0.1018s/iter; left time: 685.7162s
	iters: 400, epoch: 16 | loss: 0.0010757
	speed: 0.1069s/iter; left time: 709.0650s
Epoch: 16 cost time: 47.91175985336304
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000862
	speed: 0.5125s/iter; left time: 3314.5223s
	iters: 200, epoch: 17 | loss: 0.0197906
	speed: 0.1183s/iter; left time: 753.3718s
	iters: 300, epoch: 17 | loss: 0.0016628
	speed: 0.1065s/iter; left time: 667.3452s
	iters: 400, epoch: 17 | loss: 0.0026289
	speed: 0.1021s/iter; left time: 629.8752s
Epoch: 17 cost time: 52.446741342544556
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9871355060034306
model parameter : 8267274
model size : 32.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4236042
	speed: 0.4300s/iter; left time: 6006.9924s
	iters: 200, epoch: 1 | loss: 0.0864272
	speed: 0.4263s/iter; left time: 5913.2776s
	iters: 300, epoch: 1 | loss: 0.0706123
	speed: 0.3717s/iter; left time: 5118.2711s
	iters: 400, epoch: 1 | loss: 0.0408319
	speed: 0.4170s/iter; left time: 5700.6687s
Epoch: 1 cost time: 192.70225167274475
Epoch: 1, Steps: 469 | Train Loss: 0.462 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (inf --> -0.967695).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0331788
	speed: 1.3826s/iter; left time: 18668.5154s
	iters: 200, epoch: 2 | loss: 0.0591243
	speed: 0.3240s/iter; left time: 4342.8417s
	iters: 300, epoch: 2 | loss: 0.0233822
	speed: 0.3345s/iter; left time: 4449.4643s
	iters: 400, epoch: 2 | loss: 0.0068792
	speed: 0.3288s/iter; left time: 4340.6018s
Epoch: 2 cost time: 154.72035765647888
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.967695 --> -0.975700).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1104857
	speed: 1.1304s/iter; left time: 14732.1186s
	iters: 200, epoch: 3 | loss: 0.0202180
	speed: 0.3131s/iter; left time: 4049.2061s
	iters: 300, epoch: 3 | loss: 0.0031626
	speed: 0.2940s/iter; left time: 3773.3195s
	iters: 400, epoch: 3 | loss: 0.0858859
	speed: 0.3117s/iter; left time: 3969.3723s
Epoch: 3 cost time: 148.89518404006958
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0048321
	speed: 1.1965s/iter; left time: 15033.2470s
	iters: 200, epoch: 4 | loss: 0.0503087
	speed: 0.3459s/iter; left time: 4311.4423s
	iters: 300, epoch: 4 | loss: 0.0037737
	speed: 0.4012s/iter; left time: 4961.0236s
	iters: 400, epoch: 4 | loss: 0.0015005
	speed: 0.3697s/iter; left time: 4533.9248s
Epoch: 4 cost time: 171.06513929367065
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0324014
	speed: 1.2914s/iter; left time: 15618.8880s
	iters: 200, epoch: 5 | loss: 0.0056453
	speed: 0.3662s/iter; left time: 4392.2342s
	iters: 300, epoch: 5 | loss: 0.0006455
	speed: 0.3684s/iter; left time: 4381.9370s
	iters: 400, epoch: 5 | loss: 0.0049737
	speed: 0.3237s/iter; left time: 3818.3691s
Epoch: 5 cost time: 174.8308355808258
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.975700 --> -0.977415).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0020559
	speed: 1.1854s/iter; left time: 13781.9129s
	iters: 200, epoch: 6 | loss: 0.0588329
	speed: 0.2764s/iter; left time: 3186.1836s
	iters: 300, epoch: 6 | loss: 0.0083377
	speed: 0.3413s/iter; left time: 3899.1606s
	iters: 400, epoch: 6 | loss: 0.0008580
	speed: 0.2952s/iter; left time: 3343.2687s
Epoch: 6 cost time: 143.67433953285217
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0086292
	speed: 1.0632s/iter; left time: 11862.4266s
	iters: 200, epoch: 7 | loss: 0.0100336
	speed: 0.3109s/iter; left time: 3437.8614s
	iters: 300, epoch: 7 | loss: 0.0004433
	speed: 0.2499s/iter; left time: 2738.5312s
	iters: 400, epoch: 7 | loss: 0.0010771
	speed: 0.3426s/iter; left time: 3719.4639s
Epoch: 7 cost time: 150.38955760002136
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1071325
	speed: 1.4338s/iter; left time: 15324.0123s
	iters: 200, epoch: 8 | loss: 0.0038802
	speed: 0.4024s/iter; left time: 4260.1041s
	iters: 300, epoch: 8 | loss: 0.0002144
	speed: 0.4461s/iter; left time: 4678.2130s
	iters: 400, epoch: 8 | loss: 0.0033788
	speed: 0.4356s/iter; left time: 4525.1674s
Epoch: 8 cost time: 194.2428023815155
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0022596
	speed: 1.4104s/iter; left time: 14413.0765s
	iters: 200, epoch: 9 | loss: 0.0610820
	speed: 0.3677s/iter; left time: 3720.7308s
	iters: 300, epoch: 9 | loss: 0.0014321
	speed: 0.3543s/iter; left time: 3549.3287s
	iters: 400, epoch: 9 | loss: 0.1922704
	speed: 0.2872s/iter; left time: 2848.3569s
Epoch: 9 cost time: 168.30716967582703
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0013565
	speed: 1.1616s/iter; left time: 11326.0003s
	iters: 200, epoch: 10 | loss: 0.0201078
	speed: 0.2923s/iter; left time: 2820.8673s
	iters: 300, epoch: 10 | loss: 0.0003337
	speed: 0.3375s/iter; left time: 3223.2115s
	iters: 400, epoch: 10 | loss: 0.0014035
	speed: 0.3383s/iter; left time: 3196.5853s
Epoch: 10 cost time: 151.7712380886078
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0008740
	speed: 1.1265s/iter; left time: 10455.1885s
	iters: 200, epoch: 11 | loss: 0.0013561
	speed: 0.3852s/iter; left time: 3536.3642s
	iters: 300, epoch: 11 | loss: 0.0002548
	speed: 0.4043s/iter; left time: 3671.6700s
	iters: 400, epoch: 11 | loss: 0.0013381
	speed: 0.3742s/iter; left time: 3360.3617s
Epoch: 11 cost time: 175.0992021560669
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0004017
	speed: 1.4052s/iter; left time: 12382.9682s
	iters: 200, epoch: 12 | loss: 0.0006011
	speed: 0.3964s/iter; left time: 3453.4594s
	iters: 300, epoch: 12 | loss: 0.0037945
	speed: 0.3626s/iter; left time: 3122.6776s
	iters: 400, epoch: 12 | loss: 0.0033552
	speed: 0.4347s/iter; left time: 3700.2905s
Epoch: 12 cost time: 187.22358441352844
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0012571
	speed: 1.2951s/iter; left time: 10804.9435s
	iters: 200, epoch: 13 | loss: 0.0005542
	speed: 0.3096s/iter; left time: 2552.2592s
	iters: 300, epoch: 13 | loss: 0.0009028
	speed: 0.4147s/iter; left time: 3376.9934s
	iters: 400, epoch: 13 | loss: 0.0095651
	speed: 0.3433s/iter; left time: 2761.1989s
Epoch: 13 cost time: 159.39891648292542
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1626689
	speed: 1.2709s/iter; left time: 10007.2701s
	iters: 200, epoch: 14 | loss: 0.0002820
	speed: 0.3867s/iter; left time: 3006.3931s
	iters: 300, epoch: 14 | loss: 0.0009567
	speed: 0.3159s/iter; left time: 2424.5478s
	iters: 400, epoch: 14 | loss: 0.1314411
	speed: 0.3485s/iter; left time: 2639.7296s
Epoch: 14 cost time: 173.13749718666077
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0011578
	speed: 1.4657s/iter; left time: 10853.8614s
	iters: 200, epoch: 15 | loss: 0.0002566
	speed: 0.3785s/iter; left time: 2764.7434s
	iters: 300, epoch: 15 | loss: 0.0012334
	speed: 0.4663s/iter; left time: 3359.6682s
	iters: 400, epoch: 15 | loss: 0.0002831
	speed: 0.4410s/iter; left time: 3133.0126s
Epoch: 15 cost time: 197.8656566143036
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 14066826
model size : 54.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6348072
	speed: 0.2712s/iter; left time: 3789.2086s
	iters: 200, epoch: 1 | loss: 0.0961203
	speed: 0.2345s/iter; left time: 3252.2966s
	iters: 300, epoch: 1 | loss: 0.0434504
	speed: 0.1900s/iter; left time: 2617.0763s
	iters: 400, epoch: 1 | loss: 0.0227508
	speed: 0.1677s/iter; left time: 2293.0480s
Epoch: 1 cost time: 100.01091289520264
Epoch: 1, Steps: 469 | Train Loss: 0.463 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (inf --> -0.970553).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0144690
	speed: 0.6850s/iter; left time: 9248.6345s
	iters: 200, epoch: 2 | loss: 0.0466598
	speed: 0.2027s/iter; left time: 2716.5345s
	iters: 300, epoch: 2 | loss: 0.0025110
	speed: 0.2192s/iter; left time: 2915.5518s
	iters: 400, epoch: 2 | loss: 0.1376826
	speed: 0.1907s/iter; left time: 2517.0799s
Epoch: 2 cost time: 91.83243155479431
Epoch: 2, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1330273
	speed: 0.6397s/iter; left time: 8337.1171s
	iters: 200, epoch: 3 | loss: 0.0146838
	speed: 0.2093s/iter; left time: 2707.2095s
	iters: 300, epoch: 3 | loss: 0.0015055
	speed: 0.1901s/iter; left time: 2439.8125s
	iters: 400, epoch: 3 | loss: 0.0010548
	speed: 0.1923s/iter; left time: 2448.7516s
Epoch: 3 cost time: 94.60293745994568
Epoch: 3, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.970553 --> -0.976843).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0017374
	speed: 0.6548s/iter; left time: 8226.3067s
	iters: 200, epoch: 4 | loss: 0.0074772
	speed: 0.1778s/iter; left time: 2216.4316s
	iters: 300, epoch: 4 | loss: 0.0019387
	speed: 0.2533s/iter; left time: 3131.4233s
	iters: 400, epoch: 4 | loss: 0.2974900
	speed: 0.2536s/iter; left time: 3110.6472s
Epoch: 4 cost time: 100.56562685966492
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0195740
	speed: 0.7811s/iter; left time: 9447.1486s
	iters: 200, epoch: 5 | loss: 0.3192488
	speed: 0.2259s/iter; left time: 2709.3884s
	iters: 300, epoch: 5 | loss: 0.0016851
	speed: 0.2019s/iter; left time: 2401.3465s
	iters: 400, epoch: 5 | loss: 0.0022518
	speed: 0.2201s/iter; left time: 2595.7008s
Epoch: 5 cost time: 104.98361492156982
Epoch: 5, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0109485
	speed: 0.8288s/iter; left time: 9635.8473s
	iters: 200, epoch: 6 | loss: 0.0066767
	speed: 0.2007s/iter; left time: 2313.7830s
	iters: 300, epoch: 6 | loss: 0.0500647
	speed: 0.2015s/iter; left time: 2302.1216s
	iters: 400, epoch: 6 | loss: 0.2971191
	speed: 0.1583s/iter; left time: 1792.7895s
Epoch: 6 cost time: 92.2804913520813
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.215 Vali Acc: 0.955 Test Loss: 0.215 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0009750
	speed: 0.7581s/iter; left time: 8458.1243s
	iters: 200, epoch: 7 | loss: 0.0008375
	speed: 0.1814s/iter; left time: 2006.0903s
	iters: 300, epoch: 7 | loss: 0.0012242
	speed: 0.1422s/iter; left time: 1558.4244s
	iters: 400, epoch: 7 | loss: 0.0006573
	speed: 0.1650s/iter; left time: 1791.8590s
Epoch: 7 cost time: 82.50141143798828
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0013191
	speed: 0.6010s/iter; left time: 6423.0861s
	iters: 200, epoch: 8 | loss: 0.0031178
	speed: 0.1691s/iter; left time: 1790.8005s
	iters: 300, epoch: 8 | loss: 0.1083358
	speed: 0.1935s/iter; left time: 2029.5755s
	iters: 400, epoch: 8 | loss: 0.0054956
	speed: 0.1526s/iter; left time: 1585.6120s
Epoch: 8 cost time: 79.7839207649231
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0006093
	speed: 0.5514s/iter; left time: 5634.4611s
	iters: 200, epoch: 9 | loss: 0.0039794
	speed: 0.1932s/iter; left time: 1955.0547s
	iters: 300, epoch: 9 | loss: 0.0015547
	speed: 0.1785s/iter; left time: 1788.0424s
	iters: 400, epoch: 9 | loss: 0.0237671
	speed: 0.1702s/iter; left time: 1688.6627s
Epoch: 9 cost time: 83.0334587097168
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0004230
	speed: 0.5891s/iter; left time: 5744.0830s
	iters: 200, epoch: 10 | loss: 0.0084186
	speed: 0.1574s/iter; left time: 1518.6802s
	iters: 300, epoch: 10 | loss: 0.0001725
	speed: 0.1507s/iter; left time: 1438.7548s
	iters: 400, epoch: 10 | loss: 0.0031068
	speed: 0.1692s/iter; left time: 1599.1540s
Epoch: 10 cost time: 71.09207272529602
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0003708
	speed: 0.5349s/iter; left time: 4964.0407s
	iters: 200, epoch: 11 | loss: 0.0006508
	speed: 0.1112s/iter; left time: 1021.3648s
	iters: 300, epoch: 11 | loss: 0.0346641
	speed: 0.1075s/iter; left time: 976.5614s
	iters: 400, epoch: 11 | loss: 0.0143145
	speed: 0.1085s/iter; left time: 974.5205s
Epoch: 11 cost time: 63.332255840301514
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0105677
	speed: 0.6960s/iter; left time: 6132.8848s
	iters: 200, epoch: 12 | loss: 0.0090667
	speed: 0.1974s/iter; left time: 1720.0068s
	iters: 300, epoch: 12 | loss: 0.0130685
	speed: 0.2114s/iter; left time: 1820.7627s
	iters: 400, epoch: 12 | loss: 0.2018858
	speed: 0.2044s/iter; left time: 1739.7082s
Epoch: 12 cost time: 93.00174355506897
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.979130).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0019859
	speed: 0.7021s/iter; left time: 5857.4222s
	iters: 200, epoch: 13 | loss: 0.0031992
	speed: 0.2108s/iter; left time: 1737.4778s
	iters: 300, epoch: 13 | loss: 0.0009099
	speed: 0.1831s/iter; left time: 1490.6405s
	iters: 400, epoch: 13 | loss: 0.0008324
	speed: 0.1988s/iter; left time: 1598.6718s
Epoch: 13 cost time: 94.09188055992126
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0669288
	speed: 0.7060s/iter; left time: 5558.9141s
	iters: 200, epoch: 14 | loss: 0.0005265
	speed: 0.1759s/iter; left time: 1367.7645s
	iters: 300, epoch: 14 | loss: 0.0052777
	speed: 0.2034s/iter; left time: 1560.9445s
	iters: 400, epoch: 14 | loss: 0.0030289
	speed: 0.2036s/iter; left time: 1542.3740s
Epoch: 14 cost time: 91.95773005485535
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0010845
	speed: 0.6800s/iter; left time: 5035.1289s
	iters: 200, epoch: 15 | loss: 0.1101785
	speed: 0.1908s/iter; left time: 1393.5621s
	iters: 300, epoch: 15 | loss: 0.0033591
	speed: 0.2388s/iter; left time: 1720.5790s
	iters: 400, epoch: 15 | loss: 0.0011249
	speed: 0.2444s/iter; left time: 1736.3089s
Epoch: 15 cost time: 101.43829894065857
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0032741
	speed: 0.8681s/iter; left time: 6021.3406s
	iters: 200, epoch: 16 | loss: 0.0001223
	speed: 0.2074s/iter; left time: 1417.6168s
	iters: 300, epoch: 16 | loss: 0.0001780
	speed: 0.1895s/iter; left time: 1276.7156s
	iters: 400, epoch: 16 | loss: 0.0366776
	speed: 0.1905s/iter; left time: 1263.9992s
Epoch: 16 cost time: 100.09741282463074
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1777199
	speed: 0.7255s/iter; left time: 4691.8116s
	iters: 200, epoch: 17 | loss: 0.0015096
	speed: 0.2000s/iter; left time: 1273.2280s
	iters: 300, epoch: 17 | loss: 0.0118992
	speed: 0.2315s/iter; left time: 1450.8110s
	iters: 400, epoch: 17 | loss: 0.0016260
	speed: 0.2315s/iter; left time: 1427.7441s
Epoch: 17 cost time: 99.81192874908447
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979416).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0029535
	speed: 0.7245s/iter; left time: 4345.5284s
	iters: 200, epoch: 18 | loss: 0.0085400
	speed: 0.2148s/iter; left time: 1266.6601s
	iters: 300, epoch: 18 | loss: 0.0009066
	speed: 0.1942s/iter; left time: 1126.1888s
	iters: 400, epoch: 18 | loss: 0.1204909
	speed: 0.1877s/iter; left time: 1069.2499s
Epoch: 18 cost time: 93.84837126731873
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0006648
	speed: 0.7412s/iter; left time: 4098.2977s
	iters: 200, epoch: 19 | loss: 0.0295821
	speed: 0.2011s/iter; left time: 1091.7490s
	iters: 300, epoch: 19 | loss: 0.0001687
	speed: 0.2276s/iter; left time: 1212.9444s
	iters: 400, epoch: 19 | loss: 0.0009596
	speed: 0.2600s/iter; left time: 1359.3775s
Epoch: 19 cost time: 108.2517819404602
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.979416 --> -0.979416).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0002528
	speed: 0.8100s/iter; left time: 4098.5160s
	iters: 200, epoch: 20 | loss: 0.0037020
	speed: 0.2520s/iter; left time: 1249.7031s
	iters: 300, epoch: 20 | loss: 0.0223380
	speed: 0.2486s/iter; left time: 1208.2810s
	iters: 400, epoch: 20 | loss: 0.6793410
	speed: 0.2334s/iter; left time: 1110.8932s
Epoch: 20 cost time: 112.43059396743774
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0010160
	speed: 0.8716s/iter; left time: 4001.5789s
	iters: 200, epoch: 21 | loss: 0.0020968
	speed: 0.2293s/iter; left time: 1029.9746s
	iters: 300, epoch: 21 | loss: 0.0001528
	speed: 0.2206s/iter; left time: 968.7443s
	iters: 400, epoch: 21 | loss: 0.0001580
	speed: 0.2368s/iter; left time: 1015.9547s
Epoch: 21 cost time: 112.6111068725586
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0090095
	speed: 0.8136s/iter; left time: 3353.4986s
	iters: 200, epoch: 22 | loss: 0.0003862
	speed: 0.2332s/iter; left time: 937.8302s
	iters: 300, epoch: 22 | loss: 0.0025782
	speed: 0.2181s/iter; left time: 855.5010s
	iters: 400, epoch: 22 | loss: 0.0197050
	speed: 0.2526s/iter; left time: 965.4335s
Epoch: 22 cost time: 110.93424701690674
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000830
	speed: 0.8769s/iter; left time: 3203.2561s
	iters: 200, epoch: 23 | loss: 0.0003486
	speed: 0.2315s/iter; left time: 822.3515s
	iters: 300, epoch: 23 | loss: 0.0231771
	speed: 0.2469s/iter; left time: 852.5012s
	iters: 400, epoch: 23 | loss: 0.0009215
	speed: 0.2610s/iter; left time: 874.9993s
Epoch: 23 cost time: 115.08106207847595
Epoch: 23, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000525
	speed: 0.8040s/iter; left time: 2559.8032s
	iters: 200, epoch: 24 | loss: 0.0001806
	speed: 0.2240s/iter; left time: 690.7554s
	iters: 300, epoch: 24 | loss: 0.4839195
	speed: 0.2385s/iter; left time: 711.5911s
	iters: 400, epoch: 24 | loss: 0.0018497
	speed: 0.2341s/iter; left time: 675.1963s
Epoch: 24 cost time: 106.10208058357239
Epoch: 24, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0001546
	speed: 0.7155s/iter; left time: 1942.6389s
	iters: 200, epoch: 25 | loss: 0.0000629
	speed: 0.2291s/iter; left time: 598.9814s
	iters: 300, epoch: 25 | loss: 0.0659394
	speed: 0.2309s/iter; left time: 580.6967s
	iters: 400, epoch: 25 | loss: 0.0053040
	speed: 0.2358s/iter; left time: 569.3634s
Epoch: 25 cost time: 104.85549139976501
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0629510
	speed: 0.7676s/iter; left time: 1723.9757s
	iters: 200, epoch: 26 | loss: 0.0004906
	speed: 0.2291s/iter; left time: 491.7147s
	iters: 300, epoch: 26 | loss: 0.0003786
	speed: 0.2261s/iter; left time: 462.5776s
	iters: 400, epoch: 26 | loss: 0.0149823
	speed: 0.2003s/iter; left time: 389.8356s
Epoch: 26 cost time: 102.98945116996765
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0001092
	speed: 0.7729s/iter; left time: 1373.3971s
	iters: 200, epoch: 27 | loss: 0.0015883
	speed: 0.2709s/iter; left time: 454.3754s
	iters: 300, epoch: 27 | loss: 0.0000715
	speed: 0.2579s/iter; left time: 406.7681s
	iters: 400, epoch: 27 | loss: 0.0041116
	speed: 0.2460s/iter; left time: 363.3674s
Epoch: 27 cost time: 121.058420419693
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.986 Test Loss: 0.077 Test Acc: 0.986
Validation loss decreased (-0.979416 --> -0.985705).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0001055
	speed: 0.8849s/iter; left time: 1157.4505s
	iters: 200, epoch: 28 | loss: 0.0002058
	speed: 0.2518s/iter; left time: 304.1718s
	iters: 300, epoch: 28 | loss: 0.0023539
	speed: 0.2360s/iter; left time: 261.4601s
	iters: 400, epoch: 28 | loss: 0.0001227
	speed: 0.2340s/iter; left time: 235.8318s
Epoch: 28 cost time: 115.42644762992859
Epoch: 28, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000186
	speed: 0.9143s/iter; left time: 767.1286s
	iters: 200, epoch: 29 | loss: 0.0000318
	speed: 0.2518s/iter; left time: 186.1005s
	iters: 300, epoch: 29 | loss: 0.0000418
	speed: 0.2464s/iter; left time: 157.4261s
	iters: 400, epoch: 29 | loss: 0.0007312
	speed: 0.2378s/iter; left time: 128.1801s
Epoch: 29 cost time: 118.68233299255371
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0001421
	speed: 0.8844s/iter; left time: 327.2118s
	iters: 200, epoch: 30 | loss: 0.0012369
	speed: 0.2330s/iter; left time: 62.8996s
	iters: 300, epoch: 30 | loss: 0.0001239
	speed: 0.2466s/iter; left time: 41.9157s
	iters: 400, epoch: 30 | loss: 0.0149705
	speed: 0.2604s/iter; left time: 18.2281s
Epoch: 30 cost time: 117.92968797683716
Epoch: 30, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 4136970
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4269208
	speed: 0.3032s/iter; left time: 4235.7494s
	iters: 200, epoch: 1 | loss: 0.1021573
	speed: 0.2951s/iter; left time: 4093.8849s
	iters: 300, epoch: 1 | loss: 0.0965553
	speed: 0.2813s/iter; left time: 3873.8566s
	iters: 400, epoch: 1 | loss: 0.0718769
	speed: 0.2730s/iter; left time: 3731.8391s
Epoch: 1 cost time: 133.27086472511292
Epoch: 1, Steps: 469 | Train Loss: 0.475 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
Validation loss decreased (inf --> -0.958832).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0432056
	speed: 1.0362s/iter; left time: 13990.1873s
	iters: 200, epoch: 2 | loss: 0.0917148
	speed: 0.2957s/iter; left time: 3963.5334s
	iters: 300, epoch: 2 | loss: 0.0121374
	speed: 0.2658s/iter; left time: 3535.7768s
	iters: 400, epoch: 2 | loss: 0.0148720
	speed: 0.2502s/iter; left time: 3303.3350s
Epoch: 2 cost time: 128.23198175430298
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.125 Vali Acc: 0.958 Test Loss: 0.125 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2019129
	speed: 1.0183s/iter; left time: 13271.5488s
	iters: 200, epoch: 3 | loss: 0.0681347
	speed: 0.2704s/iter; left time: 3497.3736s
	iters: 300, epoch: 3 | loss: 0.0037702
	speed: 0.2655s/iter; left time: 3407.1174s
	iters: 400, epoch: 3 | loss: 0.2384777
	speed: 0.2863s/iter; left time: 3645.6735s
Epoch: 3 cost time: 130.43138432502747
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.958832 --> -0.967695).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0136889
	speed: 1.0536s/iter; left time: 13237.0440s
	iters: 200, epoch: 4 | loss: 0.0200669
	speed: 0.2977s/iter; left time: 3710.6085s
	iters: 300, epoch: 4 | loss: 0.0062746
	speed: 0.3143s/iter; left time: 3885.7537s
	iters: 400, epoch: 4 | loss: 0.0042590
	speed: 0.3312s/iter; left time: 4061.5846s
Epoch: 4 cost time: 145.0741832256317
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0025562
	speed: 1.1782s/iter; left time: 14250.8329s
	iters: 200, epoch: 5 | loss: 0.0244099
	speed: 0.3192s/iter; left time: 3828.4497s
	iters: 300, epoch: 5 | loss: 0.0666762
	speed: 0.3072s/iter; left time: 3654.1810s
	iters: 400, epoch: 5 | loss: 0.0006197
	speed: 0.2880s/iter; left time: 3397.0301s
Epoch: 5 cost time: 144.6541624069214
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967695 --> -0.969696).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0043911
	speed: 1.1840s/iter; left time: 13765.5667s
	iters: 200, epoch: 6 | loss: 0.0078809
	speed: 0.3040s/iter; left time: 3503.6716s
	iters: 300, epoch: 6 | loss: 0.0013928
	speed: 0.3045s/iter; left time: 3478.8275s
	iters: 400, epoch: 6 | loss: 0.0138128
	speed: 0.3075s/iter; left time: 3483.2755s
Epoch: 6 cost time: 146.93008828163147
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1023539
	speed: 1.1418s/iter; left time: 12739.3780s
	iters: 200, epoch: 7 | loss: 0.4381880
	speed: 0.2963s/iter; left time: 3275.8380s
	iters: 300, epoch: 7 | loss: 0.0085027
	speed: 0.3298s/iter; left time: 3613.6713s
	iters: 400, epoch: 7 | loss: 0.0002725
	speed: 0.3341s/iter; left time: 3627.5694s
Epoch: 7 cost time: 147.4320900440216
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969696 --> -0.969982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0100775
	speed: 1.0716s/iter; left time: 11453.5804s
	iters: 200, epoch: 8 | loss: 0.0036239
	speed: 0.2787s/iter; left time: 2950.3975s
	iters: 300, epoch: 8 | loss: 0.0005093
	speed: 0.2725s/iter; left time: 2858.0882s
	iters: 400, epoch: 8 | loss: 0.0019011
	speed: 0.2533s/iter; left time: 2631.6673s
Epoch: 8 cost time: 125.23425960540771
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2033892
	speed: 1.0592s/iter; left time: 10823.9381s
	iters: 200, epoch: 9 | loss: 0.0419806
	speed: 0.2669s/iter; left time: 2700.9376s
	iters: 300, epoch: 9 | loss: 0.0006165
	speed: 0.2601s/iter; left time: 2605.6465s
	iters: 400, epoch: 9 | loss: 0.0046300
	speed: 0.2531s/iter; left time: 2510.1125s
Epoch: 9 cost time: 127.1367290019989
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1767039
	speed: 1.0244s/iter; left time: 9987.9025s
	iters: 200, epoch: 10 | loss: 0.0025069
	speed: 0.2684s/iter; left time: 2589.7080s
	iters: 300, epoch: 10 | loss: 0.0007619
	speed: 0.2918s/iter; left time: 2786.7504s
	iters: 400, epoch: 10 | loss: 0.0043068
	speed: 0.3221s/iter; left time: 3043.5225s
Epoch: 10 cost time: 136.95577025413513
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.969982 --> -0.971697).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0013695
	speed: 1.1190s/iter; left time: 10385.7913s
	iters: 200, epoch: 11 | loss: 0.0019147
	speed: 0.2794s/iter; left time: 2565.5479s
	iters: 300, epoch: 11 | loss: 0.0007300
	speed: 0.2724s/iter; left time: 2474.0317s
	iters: 400, epoch: 11 | loss: 0.0035263
	speed: 0.3056s/iter; left time: 2744.8639s
Epoch: 11 cost time: 134.23098421096802
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011810
	speed: 1.0971s/iter; left time: 9667.7933s
	iters: 200, epoch: 12 | loss: 0.0640747
	speed: 0.2668s/iter; left time: 2324.4015s
	iters: 300, epoch: 12 | loss: 0.0028010
	speed: 0.2891s/iter; left time: 2489.9478s
	iters: 400, epoch: 12 | loss: 0.0071851
	speed: 0.2870s/iter; left time: 2443.2752s
Epoch: 12 cost time: 131.97920274734497
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.973984).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0011243
	speed: 1.0937s/iter; left time: 9125.1543s
	iters: 200, epoch: 13 | loss: 0.0003081
	speed: 0.2872s/iter; left time: 2367.1181s
	iters: 300, epoch: 13 | loss: 0.0013283
	speed: 0.3159s/iter; left time: 2572.1221s
	iters: 400, epoch: 13 | loss: 0.0008798
	speed: 0.2931s/iter; left time: 2357.5606s
Epoch: 13 cost time: 138.1401650905609
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0126471
	speed: 1.0589s/iter; left time: 8337.5507s
	iters: 200, epoch: 14 | loss: 0.0004039
	speed: 0.2771s/iter; left time: 2154.2346s
	iters: 300, epoch: 14 | loss: 0.0020959
	speed: 0.2851s/iter; left time: 2187.7422s
	iters: 400, epoch: 14 | loss: 0.0004226
	speed: 0.2521s/iter; left time: 1909.2559s
Epoch: 14 cost time: 126.17923760414124
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1037059
	speed: 0.9498s/iter; left time: 7033.2463s
	iters: 200, epoch: 15 | loss: 0.0004424
	speed: 0.2436s/iter; left time: 1779.5680s
	iters: 300, epoch: 15 | loss: 0.0009961
	speed: 0.2625s/iter; left time: 1891.5026s
	iters: 400, epoch: 15 | loss: 0.0013879
	speed: 0.2334s/iter; left time: 1658.1680s
Epoch: 15 cost time: 112.66051650047302
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0073016
	speed: 0.9577s/iter; left time: 6642.5368s
	iters: 200, epoch: 16 | loss: 0.0002027
	speed: 0.2649s/iter; left time: 1811.1642s
	iters: 300, epoch: 16 | loss: 0.0014045
	speed: 0.2673s/iter; left time: 1800.6250s
	iters: 400, epoch: 16 | loss: 0.0000688
	speed: 0.2313s/iter; left time: 1534.6949s
Epoch: 16 cost time: 116.61864709854126
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0001140
	speed: 0.9503s/iter; left time: 6145.8077s
	iters: 200, epoch: 17 | loss: 0.0085676
	speed: 0.2893s/iter; left time: 1841.7572s
	iters: 300, epoch: 17 | loss: 0.0045624
	speed: 0.2511s/iter; left time: 1573.4429s
	iters: 400, epoch: 17 | loss: 0.0024730
	speed: 0.2643s/iter; left time: 1629.6320s
Epoch: 17 cost time: 125.83384227752686
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0001530
	speed: 0.9907s/iter; left time: 5941.9282s
	iters: 200, epoch: 18 | loss: 0.0007438
	speed: 0.2897s/iter; left time: 1708.6358s
	iters: 300, epoch: 18 | loss: 0.0015181
	speed: 0.2670s/iter; left time: 1547.8179s
	iters: 400, epoch: 18 | loss: 0.0003513
	speed: 0.2440s/iter; left time: 1390.5334s
Epoch: 18 cost time: 124.8051962852478
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.973984 --> -0.977700).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001679
	speed: 0.9990s/iter; left time: 5523.2511s
	iters: 200, epoch: 19 | loss: 0.0002049
	speed: 0.2883s/iter; left time: 1565.3077s
	iters: 300, epoch: 19 | loss: 0.0134247
	speed: 0.2942s/iter; left time: 1567.7773s
	iters: 400, epoch: 19 | loss: 0.1100158
	speed: 0.2496s/iter; left time: 1304.9908s
Epoch: 19 cost time: 124.48607635498047
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0738614
	speed: 1.0010s/iter; left time: 5064.9027s
	iters: 200, epoch: 20 | loss: 0.0127925
	speed: 0.2530s/iter; left time: 1254.7866s
	iters: 300, epoch: 20 | loss: 0.0012615
	speed: 0.2827s/iter; left time: 1373.9525s
	iters: 400, epoch: 20 | loss: 0.0021789
	speed: 0.3146s/iter; left time: 1497.5474s
Epoch: 20 cost time: 132.39776825904846
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000430
	speed: 0.9506s/iter; left time: 4364.3114s
	iters: 200, epoch: 21 | loss: 0.0033873
	speed: 0.2293s/iter; left time: 1029.9483s
	iters: 300, epoch: 21 | loss: 0.0005361
	speed: 0.2205s/iter; left time: 968.0663s
	iters: 400, epoch: 21 | loss: 0.0006779
	speed: 0.2620s/iter; left time: 1124.4255s
Epoch: 21 cost time: 115.94980239868164
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001451
	speed: 0.8986s/iter; left time: 3703.8864s
	iters: 200, epoch: 22 | loss: 0.0000798
	speed: 0.2371s/iter; left time: 953.4263s
	iters: 300, epoch: 22 | loss: 0.0015134
	speed: 0.2252s/iter; left time: 883.0906s
	iters: 400, epoch: 22 | loss: 0.0001694
	speed: 0.2395s/iter; left time: 915.5414s
Epoch: 22 cost time: 111.82022666931152
Epoch: 22, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.2075317
	speed: 0.8999s/iter; left time: 3287.4271s
	iters: 200, epoch: 23 | loss: 0.0010378
	speed: 0.2237s/iter; left time: 794.7464s
	iters: 300, epoch: 23 | loss: 0.0022430
	speed: 0.2434s/iter; left time: 840.4344s
	iters: 400, epoch: 23 | loss: 0.0004879
	speed: 0.2753s/iter; left time: 923.2060s
Epoch: 23 cost time: 117.9435019493103
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0066673
	speed: 1.0352s/iter; left time: 3295.9219s
	iters: 200, epoch: 24 | loss: 0.0000674
	speed: 0.2590s/iter; left time: 798.8079s
	iters: 300, epoch: 24 | loss: 0.0008209
	speed: 0.2523s/iter; left time: 752.8382s
	iters: 400, epoch: 24 | loss: 0.0111351
	speed: 0.3023s/iter; left time: 871.8870s
Epoch: 24 cost time: 133.27067470550537
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0001083
	speed: 1.0355s/iter; left time: 2811.3881s
	iters: 200, epoch: 25 | loss: 0.0002643
	speed: 0.2898s/iter; left time: 757.8261s
	iters: 300, epoch: 25 | loss: 0.0017329
	speed: 0.2491s/iter; left time: 626.4171s
	iters: 400, epoch: 25 | loss: 0.0053130
	speed: 0.2728s/iter; left time: 658.7662s
Epoch: 25 cost time: 133.1710283756256
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0035542
	speed: 1.0307s/iter; left time: 2314.8815s
	iters: 200, epoch: 26 | loss: 0.0048775
	speed: 0.2772s/iter; left time: 594.7780s
	iters: 300, epoch: 26 | loss: 0.0010569
	speed: 0.2757s/iter; left time: 564.0915s
	iters: 400, epoch: 26 | loss: 0.0009194
	speed: 0.2753s/iter; left time: 535.7058s
Epoch: 26 cost time: 129.57207989692688
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.977700 --> -0.978272).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0002457
	speed: 0.9967s/iter; left time: 1771.2199s
	iters: 200, epoch: 27 | loss: 0.0002882
	speed: 0.2801s/iter; left time: 469.6440s
	iters: 300, epoch: 27 | loss: 0.0002782
	speed: 0.2583s/iter; left time: 407.3515s
	iters: 400, epoch: 27 | loss: 0.0188765
	speed: 0.2662s/iter; left time: 393.2237s
Epoch: 27 cost time: 129.85047101974487
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0003614
	speed: 0.9429s/iter; left time: 1233.2500s
	iters: 200, epoch: 28 | loss: 0.0039336
	speed: 0.2486s/iter; left time: 300.3410s
	iters: 300, epoch: 28 | loss: 0.0001587
	speed: 0.2639s/iter; left time: 292.3492s
	iters: 400, epoch: 28 | loss: 0.0000928
	speed: 0.2562s/iter; left time: 258.2085s
Epoch: 28 cost time: 120.05553555488586
Epoch: 28, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0042360
	speed: 0.9095s/iter; left time: 763.0943s
	iters: 200, epoch: 29 | loss: 0.0003034
	speed: 0.2483s/iter; left time: 183.5187s
	iters: 300, epoch: 29 | loss: 0.0017673
	speed: 0.2571s/iter; left time: 164.2558s
	iters: 400, epoch: 29 | loss: 0.0023896
	speed: 0.2442s/iter; left time: 131.6291s
Epoch: 29 cost time: 117.09007239341736
Epoch: 29, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0005771
	speed: 0.9084s/iter; left time: 336.1262s
	iters: 200, epoch: 30 | loss: 0.0003966
	speed: 0.2775s/iter; left time: 74.9195s
	iters: 300, epoch: 30 | loss: 0.0005186
	speed: 0.2599s/iter; left time: 44.1870s
	iters: 400, epoch: 30 | loss: 0.0004239
	speed: 0.2727s/iter; left time: 19.0910s
Epoch: 30 cost time: 124.80859017372131
Epoch: 30, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 14066826
model size : 54.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6618468
	speed: 0.1916s/iter; left time: 2676.5736s
	iters: 200, epoch: 1 | loss: 0.0935337
	speed: 0.1539s/iter; left time: 2135.3611s
	iters: 300, epoch: 1 | loss: 0.0557348
	speed: 0.1479s/iter; left time: 2037.0925s
	iters: 400, epoch: 1 | loss: 0.0256013
	speed: 0.1577s/iter; left time: 2156.1892s
Epoch: 1 cost time: 76.52366018295288
Epoch: 1, Steps: 469 | Train Loss: 0.475 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (inf --> -0.977129).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0147113
	speed: 0.5910s/iter; left time: 7979.9617s
	iters: 200, epoch: 2 | loss: 0.0349156
	speed: 0.1712s/iter; left time: 2293.8766s
	iters: 300, epoch: 2 | loss: 0.0833819
	speed: 0.1564s/iter; left time: 2081.0212s
	iters: 400, epoch: 2 | loss: 0.0701453
	speed: 0.1663s/iter; left time: 2196.0865s
Epoch: 2 cost time: 79.23632574081421
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0778166
	speed: 0.5800s/iter; left time: 7559.2294s
	iters: 200, epoch: 3 | loss: 0.0025483
	speed: 0.1632s/iter; left time: 2110.6982s
	iters: 300, epoch: 3 | loss: 0.0209209
	speed: 0.1421s/iter; left time: 1824.0804s
	iters: 400, epoch: 3 | loss: 0.0023457
	speed: 0.1612s/iter; left time: 2051.9569s
Epoch: 3 cost time: 73.27850985527039
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0090606
	speed: 0.6152s/iter; left time: 7728.7781s
	iters: 200, epoch: 4 | loss: 0.0013614
	speed: 0.1598s/iter; left time: 1991.4029s
	iters: 300, epoch: 4 | loss: 0.0057870
	speed: 0.1616s/iter; left time: 1997.5863s
	iters: 400, epoch: 4 | loss: 0.2856144
	speed: 0.1436s/iter; left time: 1760.8292s
Epoch: 4 cost time: 72.21054983139038
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0830617
	speed: 0.5298s/iter; left time: 6407.6173s
	iters: 200, epoch: 5 | loss: 0.0820316
	speed: 0.1352s/iter; left time: 1621.4781s
	iters: 300, epoch: 5 | loss: 0.0109687
	speed: 0.1485s/iter; left time: 1766.3414s
	iters: 400, epoch: 5 | loss: 0.0652405
	speed: 0.1458s/iter; left time: 1719.1844s
Epoch: 5 cost time: 65.31264185905457
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2241126
	speed: 0.4718s/iter; left time: 5484.6406s
	iters: 200, epoch: 6 | loss: 0.0145657
	speed: 0.1195s/iter; left time: 1377.5014s
	iters: 300, epoch: 6 | loss: 0.2078741
	speed: 0.1278s/iter; left time: 1460.7017s
	iters: 400, epoch: 6 | loss: 0.1158370
	speed: 0.1489s/iter; left time: 1686.5851s
Epoch: 6 cost time: 62.90031313896179
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7404088
	speed: 0.5128s/iter; left time: 5720.8712s
	iters: 200, epoch: 7 | loss: 0.0007013
	speed: 0.1273s/iter; left time: 1407.6959s
	iters: 300, epoch: 7 | loss: 0.0036888
	speed: 0.1205s/iter; left time: 1319.8747s
	iters: 400, epoch: 7 | loss: 0.0029340
	speed: 0.1224s/iter; left time: 1329.1259s
Epoch: 7 cost time: 61.517908811569214
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0023800
	speed: 0.4899s/iter; left time: 5236.0826s
	iters: 200, epoch: 8 | loss: 0.0787628
	speed: 0.1487s/iter; left time: 1574.5135s
	iters: 300, epoch: 8 | loss: 0.0122946
	speed: 0.1331s/iter; left time: 1396.0858s
	iters: 400, epoch: 8 | loss: 0.0550181
	speed: 0.1286s/iter; left time: 1335.7465s
Epoch: 8 cost time: 64.25707364082336
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0024499
	speed: 0.4896s/iter; left time: 5002.7643s
	iters: 200, epoch: 9 | loss: 0.0002489
	speed: 0.1510s/iter; left time: 1528.0339s
	iters: 300, epoch: 9 | loss: 0.0209966
	speed: 0.1612s/iter; left time: 1615.1929s
	iters: 400, epoch: 9 | loss: 0.0116220
	speed: 0.1566s/iter; left time: 1553.5610s
Epoch: 9 cost time: 71.68057870864868
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0016642
	speed: 0.5811s/iter; left time: 5665.8852s
	iters: 200, epoch: 10 | loss: 0.0052986
	speed: 0.1770s/iter; left time: 1707.9321s
	iters: 300, epoch: 10 | loss: 0.0005369
	speed: 0.1767s/iter; left time: 1687.9122s
	iters: 400, epoch: 10 | loss: 0.0004628
	speed: 0.1665s/iter; left time: 1573.6860s
Epoch: 10 cost time: 80.87538981437683
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.977987 --> -0.978558).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0019195
	speed: 0.6157s/iter; left time: 5714.7376s
	iters: 200, epoch: 11 | loss: 0.0005208
	speed: 0.1912s/iter; left time: 1755.6259s
	iters: 300, epoch: 11 | loss: 0.1088530
	speed: 0.1902s/iter; left time: 1727.4754s
	iters: 400, epoch: 11 | loss: 0.0116089
	speed: 0.1889s/iter; left time: 1696.5981s
Epoch: 11 cost time: 86.20089483261108
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0071185
	speed: 0.5859s/iter; left time: 5162.9029s
	iters: 200, epoch: 12 | loss: 0.0002823
	speed: 0.1782s/iter; left time: 1552.6901s
	iters: 300, epoch: 12 | loss: 0.0003612
	speed: 0.1894s/iter; left time: 1631.2779s
	iters: 400, epoch: 12 | loss: 0.0235952
	speed: 0.1888s/iter; left time: 1607.0929s
Epoch: 12 cost time: 84.68541026115417
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0001473
	speed: 0.6371s/iter; left time: 5315.5096s
	iters: 200, epoch: 13 | loss: 0.0021910
	speed: 0.1709s/iter; left time: 1408.4731s
	iters: 300, epoch: 13 | loss: 0.0008220
	speed: 0.1740s/iter; left time: 1416.8780s
	iters: 400, epoch: 13 | loss: 0.0006191
	speed: 0.1799s/iter; left time: 1447.0571s
Epoch: 13 cost time: 81.63288640975952
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0019256
	speed: 0.6299s/iter; left time: 4959.9461s
	iters: 200, epoch: 14 | loss: 0.0004739
	speed: 0.1782s/iter; left time: 1385.1554s
	iters: 300, epoch: 14 | loss: 0.0309235
	speed: 0.1873s/iter; left time: 1437.3561s
	iters: 400, epoch: 14 | loss: 0.0001616
	speed: 0.1884s/iter; left time: 1427.0124s
Epoch: 14 cost time: 85.22605538368225
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0003822
	speed: 0.5460s/iter; left time: 4043.0054s
	iters: 200, epoch: 15 | loss: 0.0485227
	speed: 0.1369s/iter; left time: 999.9561s
	iters: 300, epoch: 15 | loss: 0.0014373
	speed: 0.1619s/iter; left time: 1166.3379s
	iters: 400, epoch: 15 | loss: 0.0025466
	speed: 0.1656s/iter; left time: 1176.5900s
Epoch: 15 cost time: 71.86017751693726
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978844).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002318
	speed: 0.5682s/iter; left time: 3941.1249s
	iters: 200, epoch: 16 | loss: 0.0001543
	speed: 0.1364s/iter; left time: 932.4674s
	iters: 300, epoch: 16 | loss: 0.0002402
	speed: 0.1380s/iter; left time: 929.5947s
	iters: 400, epoch: 16 | loss: 0.0074345
	speed: 0.1536s/iter; left time: 1019.4826s
Epoch: 16 cost time: 67.52886986732483
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2432853
	speed: 0.5711s/iter; left time: 3693.3740s
	iters: 200, epoch: 17 | loss: 0.0019511
	speed: 0.1501s/iter; left time: 955.7654s
	iters: 300, epoch: 17 | loss: 0.0202685
	speed: 0.1499s/iter; left time: 939.1912s
	iters: 400, epoch: 17 | loss: 0.0001515
	speed: 0.1578s/iter; left time: 973.2680s
Epoch: 17 cost time: 72.2013840675354
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0118642
	speed: 0.5489s/iter; left time: 3292.0354s
	iters: 200, epoch: 18 | loss: 0.0500733
	speed: 0.1389s/iter; left time: 819.3793s
	iters: 300, epoch: 18 | loss: 0.0009664
	speed: 0.1511s/iter; left time: 875.8884s
	iters: 400, epoch: 18 | loss: 0.0007208
	speed: 0.1576s/iter; left time: 898.0816s
Epoch: 18 cost time: 70.48497319221497
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979702).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1154839
	speed: 0.6198s/iter; left time: 3426.6938s
	iters: 200, epoch: 19 | loss: 0.0027734
	speed: 0.1629s/iter; left time: 884.5029s
	iters: 300, epoch: 19 | loss: 0.0001383
	speed: 0.1585s/iter; left time: 844.5140s
	iters: 400, epoch: 19 | loss: 0.0000579
	speed: 0.1633s/iter; left time: 853.8350s
Epoch: 19 cost time: 77.23411393165588
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0003035
	speed: 0.6821s/iter; left time: 3451.2179s
	iters: 200, epoch: 20 | loss: 0.0969156
	speed: 0.1740s/iter; left time: 862.9611s
	iters: 300, epoch: 20 | loss: 0.0102513
	speed: 0.1750s/iter; left time: 850.6501s
	iters: 400, epoch: 20 | loss: 0.0068651
	speed: 0.1641s/iter; left time: 781.3100s
Epoch: 20 cost time: 81.71489548683167
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0048045
	speed: 0.6442s/iter; left time: 2957.3701s
	iters: 200, epoch: 21 | loss: 0.0012401
	speed: 0.1705s/iter; left time: 765.6885s
	iters: 300, epoch: 21 | loss: 0.0002108
	speed: 0.1754s/iter; left time: 770.0072s
	iters: 400, epoch: 21 | loss: 0.0004142
	speed: 0.1712s/iter; left time: 734.7650s
Epoch: 21 cost time: 82.58141350746155
Epoch: 21, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0060494
	speed: 0.6731s/iter; left time: 2774.3307s
	iters: 200, epoch: 22 | loss: 0.0000718
	speed: 0.1751s/iter; left time: 704.2620s
	iters: 300, epoch: 22 | loss: 0.0055917
	speed: 0.1612s/iter; left time: 632.2870s
	iters: 400, epoch: 22 | loss: 0.0021450
	speed: 0.1610s/iter; left time: 615.3136s
Epoch: 22 cost time: 78.79562616348267
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0001373
	speed: 0.6624s/iter; left time: 2419.7736s
	iters: 200, epoch: 23 | loss: 0.0002120
	speed: 0.1896s/iter; left time: 673.7742s
	iters: 300, epoch: 23 | loss: 0.0020014
	speed: 0.1779s/iter; left time: 614.1813s
	iters: 400, epoch: 23 | loss: 0.0003524
	speed: 0.1619s/iter; left time: 542.9210s
Epoch: 23 cost time: 83.52448630332947
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0001297
	speed: 0.6129s/iter; left time: 1951.3917s
	iters: 200, epoch: 24 | loss: 0.0005917
	speed: 0.1894s/iter; left time: 584.2254s
	iters: 300, epoch: 24 | loss: 0.6589770
	speed: 0.1852s/iter; left time: 552.7693s
	iters: 400, epoch: 24 | loss: 0.0003914
	speed: 0.1773s/iter; left time: 511.4764s
Epoch: 24 cost time: 85.10583806037903
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.966 Test Loss: 0.169 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0001590
	speed: 0.5838s/iter; left time: 1585.0141s
	iters: 200, epoch: 25 | loss: 0.0000591
	speed: 0.1536s/iter; left time: 401.6129s
	iters: 300, epoch: 25 | loss: 0.0030261
	speed: 0.1554s/iter; left time: 390.9132s
	iters: 400, epoch: 25 | loss: 0.0043547
	speed: 0.1420s/iter; left time: 343.0166s
Epoch: 25 cost time: 70.30881142616272
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0010968
	speed: 0.4629s/iter; left time: 1039.6849s
	iters: 200, epoch: 26 | loss: 0.0002458
	speed: 0.1486s/iter; left time: 318.8977s
	iters: 300, epoch: 26 | loss: 0.0001055
	speed: 0.1548s/iter; left time: 316.6312s
	iters: 400, epoch: 26 | loss: 0.0013752
	speed: 0.1403s/iter; left time: 272.9968s
Epoch: 26 cost time: 61.9473135471344
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000737
	speed: 0.4793s/iter; left time: 851.6798s
	iters: 200, epoch: 27 | loss: 0.0001401
	speed: 0.1312s/iter; left time: 220.0896s
	iters: 300, epoch: 27 | loss: 0.0003473
	speed: 0.1380s/iter; left time: 217.6295s
	iters: 400, epoch: 27 | loss: 0.0100502
	speed: 0.1430s/iter; left time: 211.1679s
Epoch: 27 cost time: 66.41106843948364
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000445
	speed: 0.4902s/iter; left time: 641.1319s
	iters: 200, epoch: 28 | loss: 0.0015542
	speed: 0.1250s/iter; left time: 151.0294s
	iters: 300, epoch: 28 | loss: 0.0017252
	speed: 0.1532s/iter; left time: 169.6992s
	iters: 400, epoch: 28 | loss: 0.0020866
	speed: 0.1505s/iter; left time: 151.7458s
Epoch: 28 cost time: 64.44326448440552
Epoch: 28, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 4136970
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5535251
	speed: 0.1615s/iter; left time: 2256.4365s
	iters: 200, epoch: 1 | loss: 0.2208852
	speed: 0.1571s/iter; left time: 2179.0475s
	iters: 300, epoch: 1 | loss: 0.1039545
	speed: 0.1650s/iter; left time: 2272.4489s
	iters: 400, epoch: 1 | loss: 0.0611818
	speed: 0.1776s/iter; left time: 2428.3295s
Epoch: 1 cost time: 78.60456466674805
Epoch: 1, Steps: 469 | Train Loss: 0.533 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (inf --> -0.958546).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0272274
	speed: 0.6381s/iter; left time: 8616.0525s
	iters: 200, epoch: 2 | loss: 0.0383917
	speed: 0.1635s/iter; left time: 2191.3474s
	iters: 300, epoch: 2 | loss: 0.0091647
	speed: 0.1746s/iter; left time: 2322.1105s
	iters: 400, epoch: 2 | loss: 0.0047488
	speed: 0.1628s/iter; left time: 2148.7570s
Epoch: 2 cost time: 76.97104692459106
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.958546 --> -0.967981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0649627
	speed: 0.6614s/iter; left time: 8619.8557s
	iters: 200, epoch: 3 | loss: 0.0322560
	speed: 0.1474s/iter; left time: 1906.7169s
	iters: 300, epoch: 3 | loss: 0.0035891
	speed: 0.1535s/iter; left time: 1969.7741s
	iters: 400, epoch: 3 | loss: 0.3310727
	speed: 0.1746s/iter; left time: 2223.3942s
Epoch: 3 cost time: 75.55812120437622
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0032252
	speed: 0.6594s/iter; left time: 8284.6156s
	iters: 200, epoch: 4 | loss: 0.1126873
	speed: 0.1635s/iter; left time: 2037.3081s
	iters: 300, epoch: 4 | loss: 0.0263455
	speed: 0.1640s/iter; left time: 2027.2352s
	iters: 400, epoch: 4 | loss: 0.0105030
	speed: 0.1604s/iter; left time: 1967.4418s
Epoch: 4 cost time: 75.19489598274231
Epoch: 4, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
Validation loss decreased (-0.967981 --> -0.972269).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0342098
	speed: 0.6858s/iter; left time: 8295.3108s
	iters: 200, epoch: 5 | loss: 0.0113992
	speed: 0.1465s/iter; left time: 1757.4053s
	iters: 300, epoch: 5 | loss: 0.0063177
	speed: 0.1479s/iter; left time: 1759.3872s
	iters: 400, epoch: 5 | loss: 0.0090847
	speed: 0.1507s/iter; left time: 1776.9294s
Epoch: 5 cost time: 72.44518232345581
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0460016
	speed: 0.6074s/iter; left time: 7062.0683s
	iters: 200, epoch: 6 | loss: 0.0102641
	speed: 0.1607s/iter; left time: 1851.9329s
	iters: 300, epoch: 6 | loss: 0.0097491
	speed: 0.1511s/iter; left time: 1726.1903s
	iters: 400, epoch: 6 | loss: 0.0027387
	speed: 0.1454s/iter; left time: 1646.3117s
Epoch: 6 cost time: 68.80347013473511
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8296657
	speed: 0.5269s/iter; left time: 5878.8862s
	iters: 200, epoch: 7 | loss: 0.1329834
	speed: 0.1186s/iter; left time: 1311.6536s
	iters: 300, epoch: 7 | loss: 0.0013225
	speed: 0.1117s/iter; left time: 1223.6686s
	iters: 400, epoch: 7 | loss: 0.0003082
	speed: 0.1304s/iter; left time: 1415.9352s
Epoch: 7 cost time: 59.202106952667236
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0574021
	speed: 0.5154s/iter; left time: 5508.1889s
	iters: 200, epoch: 8 | loss: 0.0016623
	speed: 0.1284s/iter; left time: 1359.6027s
	iters: 300, epoch: 8 | loss: 0.0002414
	speed: 0.1445s/iter; left time: 1515.6381s
	iters: 400, epoch: 8 | loss: 0.0024823
	speed: 0.1349s/iter; left time: 1401.4785s
Epoch: 8 cost time: 60.16901612281799
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0066744
	speed: 0.4925s/iter; left time: 5033.1963s
	iters: 200, epoch: 9 | loss: 0.0280918
	speed: 0.0878s/iter; left time: 888.1928s
	iters: 300, epoch: 9 | loss: 0.0007177
	speed: 0.1209s/iter; left time: 1211.4646s
	iters: 400, epoch: 9 | loss: 0.0024692
	speed: 0.1341s/iter; left time: 1330.3612s
Epoch: 9 cost time: 57.43710446357727
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0003832
	speed: 0.5466s/iter; left time: 5329.5802s
	iters: 200, epoch: 10 | loss: 0.0031937
	speed: 0.1275s/iter; left time: 1230.5428s
	iters: 300, epoch: 10 | loss: 0.0034589
	speed: 0.1445s/iter; left time: 1380.3939s
	iters: 400, epoch: 10 | loss: 0.2859321
	speed: 0.1524s/iter; left time: 1440.5525s
Epoch: 10 cost time: 65.16474509239197
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0025902
	speed: 0.5805s/iter; left time: 5387.1921s
	iters: 200, epoch: 11 | loss: 0.0068697
	speed: 0.1731s/iter; left time: 1589.3051s
	iters: 300, epoch: 11 | loss: 0.0057943
	speed: 0.1631s/iter; left time: 1481.4244s
	iters: 400, epoch: 11 | loss: 0.0008123
	speed: 0.1574s/iter; left time: 1413.9272s
Epoch: 11 cost time: 74.6343891620636
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0007353
	speed: 0.6202s/iter; left time: 5465.6279s
	iters: 200, epoch: 12 | loss: 0.0001619
	speed: 0.1579s/iter; left time: 1375.4629s
	iters: 300, epoch: 12 | loss: 0.0013954
	speed: 0.1589s/iter; left time: 1368.0807s
	iters: 400, epoch: 12 | loss: 0.2957630
	speed: 0.1539s/iter; left time: 1309.7237s
Epoch: 12 cost time: 74.44904828071594
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0008284
	speed: 0.6201s/iter; left time: 5173.2669s
	iters: 200, epoch: 13 | loss: 0.0001178
	speed: 0.1723s/iter; left time: 1420.5023s
	iters: 300, epoch: 13 | loss: 0.0014093
	speed: 0.1626s/iter; left time: 1323.8488s
	iters: 400, epoch: 13 | loss: 0.0041828
	speed: 0.1441s/iter; left time: 1158.8656s
Epoch: 13 cost time: 73.88932037353516
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0660602
	speed: 0.6518s/iter; left time: 5132.4668s
	iters: 200, epoch: 14 | loss: 0.0003588
	speed: 0.1504s/iter; left time: 1169.1435s
	iters: 300, epoch: 14 | loss: 0.0072901
	speed: 0.1410s/iter; left time: 1082.0244s
	iters: 400, epoch: 14 | loss: 0.0024170
	speed: 0.1400s/iter; left time: 1060.5954s
Epoch: 14 cost time: 71.47096967697144
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.972269 --> -0.976557).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0028734
	speed: 0.6657s/iter; left time: 4929.1562s
	iters: 200, epoch: 15 | loss: 0.0001623
	speed: 0.1427s/iter; left time: 1042.3331s
	iters: 300, epoch: 15 | loss: 0.0025992
	speed: 0.1541s/iter; left time: 1109.9725s
	iters: 400, epoch: 15 | loss: 0.0004413
	speed: 0.1567s/iter; left time: 1113.0455s
Epoch: 15 cost time: 71.61053800582886
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978844).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0006795
	speed: 0.6434s/iter; left time: 4462.5174s
	iters: 200, epoch: 16 | loss: 0.0051215
	speed: 0.1520s/iter; left time: 1038.9837s
	iters: 300, epoch: 16 | loss: 0.0592115
	speed: 0.1419s/iter; left time: 955.8482s
	iters: 400, epoch: 16 | loss: 0.0009065
	speed: 0.1500s/iter; left time: 995.6239s
Epoch: 16 cost time: 69.72039818763733
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0001733
	speed: 0.5521s/iter; left time: 3570.6598s
	iters: 200, epoch: 17 | loss: 0.0001057
	speed: 0.1173s/iter; left time: 746.8477s
	iters: 300, epoch: 17 | loss: 0.0046449
	speed: 0.1329s/iter; left time: 832.6892s
	iters: 400, epoch: 17 | loss: 0.0002514
	speed: 0.1384s/iter; left time: 853.4667s
Epoch: 17 cost time: 59.119553089141846
Epoch: 17, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.978844 --> -0.983133).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0006376
	speed: 0.5513s/iter; left time: 3306.7404s
	iters: 200, epoch: 18 | loss: 0.0018146
	speed: 0.1403s/iter; left time: 827.5390s
	iters: 300, epoch: 18 | loss: 0.0008681
	speed: 0.1408s/iter; left time: 816.5942s
	iters: 400, epoch: 18 | loss: 0.0341209
	speed: 0.1443s/iter; left time: 822.3531s
Epoch: 18 cost time: 66.1101758480072
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3591264
	speed: 0.5618s/iter; left time: 3106.2295s
	iters: 200, epoch: 19 | loss: 0.0002488
	speed: 0.1420s/iter; left time: 771.1751s
	iters: 300, epoch: 19 | loss: 0.1640092
	speed: 0.1415s/iter; left time: 753.9610s
	iters: 400, epoch: 19 | loss: 0.0279672
	speed: 0.1494s/iter; left time: 781.0034s
Epoch: 19 cost time: 66.54149389266968
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0009567
	speed: 0.5591s/iter; left time: 2829.1256s
	iters: 200, epoch: 20 | loss: 0.0000628
	speed: 0.1434s/iter; left time: 711.2485s
	iters: 300, epoch: 20 | loss: 0.0000743
	speed: 0.1537s/iter; left time: 746.8741s
	iters: 400, epoch: 20 | loss: 0.0006840
	speed: 0.1417s/iter; left time: 674.2782s
Epoch: 20 cost time: 67.91963195800781
Epoch: 20, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001378
	speed: 0.6340s/iter; left time: 2910.7112s
	iters: 200, epoch: 21 | loss: 0.0000526
	speed: 0.1751s/iter; left time: 786.3473s
	iters: 300, epoch: 21 | loss: 0.0030840
	speed: 0.1655s/iter; left time: 726.6137s
	iters: 400, epoch: 21 | loss: 0.0001396
	speed: 0.1628s/iter; left time: 698.4251s
Epoch: 21 cost time: 77.47211718559265
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0003820
	speed: 0.6656s/iter; left time: 2743.6964s
	iters: 200, epoch: 22 | loss: 0.0000318
	speed: 0.1678s/iter; left time: 674.9475s
	iters: 300, epoch: 22 | loss: 0.0012796
	speed: 0.1630s/iter; left time: 639.4003s
	iters: 400, epoch: 22 | loss: 0.0000779
	speed: 0.1508s/iter; left time: 576.4558s
Epoch: 22 cost time: 76.68499255180359
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1720431
	speed: 0.6812s/iter; left time: 2488.4984s
	iters: 200, epoch: 23 | loss: 0.0000432
	speed: 0.1624s/iter; left time: 576.9042s
	iters: 300, epoch: 23 | loss: 0.0011810
	speed: 0.1502s/iter; left time: 518.7763s
	iters: 400, epoch: 23 | loss: 0.0015632
	speed: 0.1565s/iter; left time: 524.7737s
Epoch: 23 cost time: 75.53527212142944
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.983133 --> -0.985134).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0014587
	speed: 0.6965s/iter; left time: 2217.6968s
	iters: 200, epoch: 24 | loss: 0.0009759
	speed: 0.1509s/iter; left time: 465.2698s
	iters: 300, epoch: 24 | loss: 0.0002051
	speed: 0.1538s/iter; left time: 458.8889s
	iters: 400, epoch: 24 | loss: 0.0267569
	speed: 0.1653s/iter; left time: 476.6353s
Epoch: 24 cost time: 75.14184331893921
Epoch: 24, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0002276
	speed: 0.6808s/iter; left time: 1848.4242s
	iters: 200, epoch: 25 | loss: 0.0427099
	speed: 0.1519s/iter; left time: 397.3204s
	iters: 300, epoch: 25 | loss: 0.0002439
	speed: 0.1673s/iter; left time: 420.8628s
	iters: 400, epoch: 25 | loss: 0.0002955
	speed: 0.1684s/iter; left time: 406.7285s
Epoch: 25 cost time: 76.97967219352722
Epoch: 25, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000869
	speed: 0.6677s/iter; left time: 1499.7629s
	iters: 200, epoch: 26 | loss: 0.0061581
	speed: 0.1653s/iter; left time: 354.7542s
	iters: 300, epoch: 26 | loss: 0.0002084
	speed: 0.1684s/iter; left time: 344.5510s
	iters: 400, epoch: 26 | loss: 0.0002072
	speed: 0.1705s/iter; left time: 331.7043s
Epoch: 26 cost time: 75.99869561195374
Epoch: 26, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0021799
	speed: 0.5685s/iter; left time: 1010.1958s
	iters: 200, epoch: 27 | loss: 0.0001092
	speed: 0.1473s/iter; left time: 247.0360s
	iters: 300, epoch: 27 | loss: 0.0002537
	speed: 0.1603s/iter; left time: 252.8334s
	iters: 400, epoch: 27 | loss: 0.0001129
	speed: 0.1492s/iter; left time: 220.3083s
Epoch: 27 cost time: 70.19814586639404
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0001348
	speed: 0.5675s/iter; left time: 742.3334s
	iters: 200, epoch: 28 | loss: 0.0008110
	speed: 0.1585s/iter; left time: 191.4812s
	iters: 300, epoch: 28 | loss: 0.0001228
	speed: 0.1490s/iter; left time: 165.0614s
	iters: 400, epoch: 28 | loss: 0.0001468
	speed: 0.1421s/iter; left time: 143.2513s
Epoch: 28 cost time: 68.53863787651062
Epoch: 28, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0001069
	speed: 0.4930s/iter; left time: 413.5967s
	iters: 200, epoch: 29 | loss: 0.0001601
	speed: 0.1456s/iter; left time: 107.6181s
	iters: 300, epoch: 29 | loss: 0.0014508
	speed: 0.1375s/iter; left time: 87.8549s
	iters: 400, epoch: 29 | loss: 0.0055623
	speed: 0.1175s/iter; left time: 63.3246s
Epoch: 29 cost time: 58.53665828704834
Epoch: 29, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0053991
	speed: 0.5050s/iter; left time: 186.8640s
	iters: 200, epoch: 30 | loss: 0.0022037
	speed: 0.1356s/iter; left time: 36.6068s
	iters: 300, epoch: 30 | loss: 0.0119033
	speed: 0.1411s/iter; left time: 23.9874s
	iters: 400, epoch: 30 | loss: 0.0012044
	speed: 0.1175s/iter; left time: 8.2257s
Epoch: 30 cost time: 59.13708209991455
Epoch: 30, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 14066826
model size : 54.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8054590
	speed: 0.1074s/iter; left time: 1500.2612s
	iters: 200, epoch: 1 | loss: 0.1587387
	speed: 0.0891s/iter; left time: 1235.7177s
	iters: 300, epoch: 1 | loss: 0.1314836
	speed: 0.0725s/iter; left time: 998.5163s
	iters: 400, epoch: 1 | loss: 0.0553559
	speed: 0.0688s/iter; left time: 940.1770s
Epoch: 1 cost time: 38.703017473220825
Epoch: 1, Steps: 469 | Train Loss: 0.546 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (inf --> -0.971411).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0141500
	speed: 0.3550s/iter; left time: 4792.8802s
	iters: 200, epoch: 2 | loss: 0.0464585
	speed: 0.0705s/iter; left time: 944.7822s
	iters: 300, epoch: 2 | loss: 0.0431578
	speed: 0.0754s/iter; left time: 1002.3761s
	iters: 400, epoch: 2 | loss: 0.1380974
	speed: 0.0612s/iter; left time: 807.6209s
Epoch: 2 cost time: 32.27917742729187
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0529542
	speed: 0.2628s/iter; left time: 3425.6840s
	iters: 200, epoch: 3 | loss: 0.0191777
	speed: 0.0809s/iter; left time: 1045.8221s
	iters: 300, epoch: 3 | loss: 0.0090484
	speed: 0.0798s/iter; left time: 1023.4982s
	iters: 400, epoch: 3 | loss: 0.0014104
	speed: 0.0811s/iter; left time: 1032.8943s
Epoch: 3 cost time: 38.243847608566284
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.971697 --> -0.979702).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0039949
	speed: 0.3558s/iter; left time: 4470.3128s
	iters: 200, epoch: 4 | loss: 0.0034180
	speed: 0.0828s/iter; left time: 1031.8602s
	iters: 300, epoch: 4 | loss: 0.0007376
	speed: 0.0863s/iter; left time: 1066.4140s
	iters: 400, epoch: 4 | loss: 0.0968322
	speed: 0.0836s/iter; left time: 1024.8276s
Epoch: 4 cost time: 38.86063551902771
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.963 Test Loss: 0.114 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0192144
	speed: 0.3584s/iter; left time: 4334.5788s
	iters: 200, epoch: 5 | loss: 0.0498840
	speed: 0.0836s/iter; left time: 1002.2908s
	iters: 300, epoch: 5 | loss: 0.0041683
	speed: 0.0720s/iter; left time: 856.6521s
	iters: 400, epoch: 5 | loss: 0.0085278
	speed: 0.0717s/iter; left time: 845.6427s
Epoch: 5 cost time: 37.790958404541016
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1244814
	speed: 0.3642s/iter; left time: 4234.0401s
	iters: 200, epoch: 6 | loss: 0.1417839
	speed: 0.0517s/iter; left time: 596.3633s
	iters: 300, epoch: 6 | loss: 0.0486945
	speed: 0.0634s/iter; left time: 724.4250s
	iters: 400, epoch: 6 | loss: 0.0644958
	speed: 0.0763s/iter; left time: 864.5887s
Epoch: 6 cost time: 32.05822229385376
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0091343
	speed: 0.2722s/iter; left time: 3036.5661s
	iters: 200, epoch: 7 | loss: 0.0016496
	speed: 0.0463s/iter; left time: 511.5546s
	iters: 300, epoch: 7 | loss: 0.0239769
	speed: 0.0460s/iter; left time: 504.5225s
	iters: 400, epoch: 7 | loss: 0.0015576
	speed: 0.0404s/iter; left time: 438.9839s
Epoch: 7 cost time: 25.267422676086426
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0020589
	speed: 0.3660s/iter; left time: 3911.5831s
	iters: 200, epoch: 8 | loss: 0.0092069
	speed: 0.0825s/iter; left time: 873.6716s
	iters: 300, epoch: 8 | loss: 0.0033820
	speed: 0.0685s/iter; left time: 718.5385s
	iters: 400, epoch: 8 | loss: 0.0008960
	speed: 0.0725s/iter; left time: 752.6954s
Epoch: 8 cost time: 36.57489800453186
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007775
	speed: 0.3382s/iter; left time: 3455.7094s
	iters: 200, epoch: 9 | loss: 0.0087374
	speed: 0.0669s/iter; left time: 676.7186s
	iters: 300, epoch: 9 | loss: 0.0004843
	speed: 0.0788s/iter; left time: 789.4481s
	iters: 400, epoch: 9 | loss: 0.0056053
	speed: 0.0852s/iter; left time: 845.3292s
Epoch: 9 cost time: 36.74825859069824
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0006243
	speed: 0.4158s/iter; left time: 4053.8790s
	iters: 200, epoch: 10 | loss: 0.0679629
	speed: 0.0982s/iter; left time: 947.2866s
	iters: 300, epoch: 10 | loss: 0.0006884
	speed: 0.0995s/iter; left time: 950.5032s
	iters: 400, epoch: 10 | loss: 0.0010893
	speed: 0.0917s/iter; left time: 866.1445s
Epoch: 10 cost time: 44.525628328323364
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980560).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3521394
	speed: 0.4177s/iter; left time: 3877.0842s
	iters: 200, epoch: 11 | loss: 0.0056424
	speed: 0.1012s/iter; left time: 928.9269s
	iters: 300, epoch: 11 | loss: 0.2376241
	speed: 0.0971s/iter; left time: 882.0345s
	iters: 400, epoch: 11 | loss: 0.0303711
	speed: 0.0949s/iter; left time: 852.3175s
Epoch: 11 cost time: 47.013367891311646
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0017353
	speed: 0.3897s/iter; left time: 3433.9570s
	iters: 200, epoch: 12 | loss: 0.0059950
	speed: 0.1011s/iter; left time: 880.7756s
	iters: 300, epoch: 12 | loss: 0.0017769
	speed: 0.1040s/iter; left time: 895.7321s
	iters: 400, epoch: 12 | loss: 0.0003183
	speed: 0.0916s/iter; left time: 779.5713s
Epoch: 12 cost time: 45.14319372177124
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0110273
	speed: 0.4103s/iter; left time: 3422.9931s
	iters: 200, epoch: 13 | loss: 0.0005396
	speed: 0.0866s/iter; left time: 714.0755s
	iters: 300, epoch: 13 | loss: 0.0639296
	speed: 0.0784s/iter; left time: 638.3663s
	iters: 400, epoch: 13 | loss: 0.0001022
	speed: 0.0729s/iter; left time: 586.1444s
Epoch: 13 cost time: 38.399230003356934
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0045233
	speed: 0.3499s/iter; left time: 2755.0256s
	iters: 200, epoch: 14 | loss: 0.0001060
	speed: 0.0723s/iter; left time: 561.7456s
	iters: 300, epoch: 14 | loss: 0.0775617
	speed: 0.0714s/iter; left time: 547.6243s
	iters: 400, epoch: 14 | loss: 0.0001754
	speed: 0.0790s/iter; left time: 598.4905s
Epoch: 14 cost time: 36.36088299751282
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0007763
	speed: 0.3721s/iter; left time: 2755.6065s
	iters: 200, epoch: 15 | loss: 0.0027088
	speed: 0.0733s/iter; left time: 535.3221s
	iters: 300, epoch: 15 | loss: 0.0050450
	speed: 0.0777s/iter; left time: 559.6227s
	iters: 400, epoch: 15 | loss: 0.0001879
	speed: 0.0833s/iter; left time: 591.6148s
Epoch: 15 cost time: 36.911367416381836
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.980560 --> -0.986563).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000394
	speed: 0.3425s/iter; left time: 2375.7491s
	iters: 200, epoch: 16 | loss: 0.0001687
	speed: 0.0902s/iter; left time: 616.3665s
	iters: 300, epoch: 16 | loss: 0.0006014
	speed: 0.0892s/iter; left time: 600.6171s
	iters: 400, epoch: 16 | loss: 0.0275991
	speed: 0.0903s/iter; left time: 599.4836s
Epoch: 16 cost time: 42.11061882972717
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0205959
	speed: 0.4287s/iter; left time: 2772.4106s
	iters: 200, epoch: 17 | loss: 0.0007110
	speed: 0.0998s/iter; left time: 635.2330s
	iters: 300, epoch: 17 | loss: 0.0606063
	speed: 0.0911s/iter; left time: 571.2180s
	iters: 400, epoch: 17 | loss: 0.0007688
	speed: 0.0906s/iter; left time: 558.5890s
Epoch: 17 cost time: 45.144004821777344
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000705
	speed: 0.4471s/iter; left time: 2681.8959s
	iters: 200, epoch: 18 | loss: 0.0455706
	speed: 0.0969s/iter; left time: 571.7115s
	iters: 300, epoch: 18 | loss: 0.0002671
	speed: 0.0962s/iter; left time: 558.0127s
	iters: 400, epoch: 18 | loss: 0.0001843
	speed: 0.0936s/iter; left time: 533.5302s
Epoch: 18 cost time: 46.52215051651001
Epoch: 18, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986563 --> -0.986563).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000709
	speed: 0.4251s/iter; left time: 2350.4929s
	iters: 200, epoch: 19 | loss: 0.0004654
	speed: 0.0898s/iter; left time: 487.6904s
	iters: 300, epoch: 19 | loss: 0.0035298
	speed: 0.0945s/iter; left time: 503.5712s
	iters: 400, epoch: 19 | loss: 0.0000999
	speed: 0.1085s/iter; left time: 567.1232s
Epoch: 19 cost time: 46.16618847846985
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0127589
	speed: 0.3853s/iter; left time: 1949.3824s
	iters: 200, epoch: 20 | loss: 0.0153753
	speed: 0.0759s/iter; left time: 376.5148s
	iters: 300, epoch: 20 | loss: 0.0028439
	speed: 0.0835s/iter; left time: 405.9994s
	iters: 400, epoch: 20 | loss: 0.1246709
	speed: 0.0803s/iter; left time: 382.1700s
Epoch: 20 cost time: 37.16335129737854
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2197760
	speed: 0.3370s/iter; left time: 1547.3454s
	iters: 200, epoch: 21 | loss: 0.0014417
	speed: 0.0898s/iter; left time: 403.0820s
	iters: 300, epoch: 21 | loss: 0.0083322
	speed: 0.0810s/iter; left time: 355.7875s
	iters: 400, epoch: 21 | loss: 0.0003437
	speed: 0.0797s/iter; left time: 341.7835s
Epoch: 21 cost time: 39.41086268424988
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0152622
	speed: 0.3593s/iter; left time: 1481.0053s
	iters: 200, epoch: 22 | loss: 0.0026562
	speed: 0.0693s/iter; left time: 278.5630s
	iters: 300, epoch: 22 | loss: 0.0008812
	speed: 0.0700s/iter; left time: 274.5853s
	iters: 400, epoch: 22 | loss: 0.0015187
	speed: 0.0737s/iter; left time: 281.8702s
Epoch: 22 cost time: 35.15595102310181
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0036871
	speed: 0.3692s/iter; left time: 1348.6918s
	iters: 200, epoch: 23 | loss: 0.0003058
	speed: 0.0774s/iter; left time: 275.1380s
	iters: 300, epoch: 23 | loss: 0.0002930
	speed: 0.0914s/iter; left time: 315.4696s
	iters: 400, epoch: 23 | loss: 0.0008158
	speed: 0.1064s/iter; left time: 356.7488s
Epoch: 23 cost time: 42.88496732711792
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000461
	speed: 0.4116s/iter; left time: 1310.4969s
	iters: 200, epoch: 24 | loss: 0.0102405
	speed: 0.0969s/iter; left time: 298.7449s
	iters: 300, epoch: 24 | loss: 0.5461613
	speed: 0.0999s/iter; left time: 298.2102s
	iters: 400, epoch: 24 | loss: 0.0010689
	speed: 0.1077s/iter; left time: 310.6900s
Epoch: 24 cost time: 46.668720722198486
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0002009
	speed: 0.4415s/iter; left time: 1198.6361s
	iters: 200, epoch: 25 | loss: 0.0001475
	speed: 0.1036s/iter; left time: 270.8742s
	iters: 300, epoch: 25 | loss: 0.1377565
	speed: 0.0947s/iter; left time: 238.2905s
	iters: 400, epoch: 25 | loss: 0.0009690
	speed: 0.0901s/iter; left time: 217.5573s
Epoch: 25 cost time: 46.32777142524719
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0018186
	speed: 0.4225s/iter; left time: 949.0161s
	iters: 200, epoch: 26 | loss: 0.0000550
	speed: 0.0965s/iter; left time: 207.0726s
	iters: 300, epoch: 26 | loss: 0.0000469
	speed: 0.0961s/iter; left time: 196.5483s
	iters: 400, epoch: 26 | loss: 0.0022072
	speed: 0.0966s/iter; left time: 187.9620s
Epoch: 26 cost time: 45.301854610443115
Epoch: 26, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.3445769
	speed: 0.3667s/iter; left time: 651.5916s
	iters: 200, epoch: 27 | loss: 0.0012428
	speed: 0.0704s/iter; left time: 118.0486s
	iters: 300, epoch: 27 | loss: 0.0011639
	speed: 0.0692s/iter; left time: 109.1007s
	iters: 400, epoch: 27 | loss: 0.0460722
	speed: 0.0833s/iter; left time: 123.0547s
Epoch: 27 cost time: 35.772881269454956
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000920
	speed: 0.3504s/iter; left time: 458.3221s
	iters: 200, epoch: 28 | loss: 0.0000892
	speed: 0.0841s/iter; left time: 101.5929s
	iters: 300, epoch: 28 | loss: 0.0235014
	speed: 0.0899s/iter; left time: 99.6215s
	iters: 400, epoch: 28 | loss: 0.0000506
	speed: 0.0896s/iter; left time: 90.3428s
Epoch: 28 cost time: 39.37344932556152
Epoch: 28, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 4136970
model size : 17.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7091864
	speed: 0.1608s/iter; left time: 2246.8832s
	iters: 200, epoch: 1 | loss: 0.1669065
	speed: 0.1555s/iter; left time: 2156.8442s
	iters: 300, epoch: 1 | loss: 0.1522556
	speed: 0.1712s/iter; left time: 2358.2471s
	iters: 400, epoch: 1 | loss: 0.0257932
	speed: 0.1708s/iter; left time: 2335.6597s
Epoch: 1 cost time: 78.31715369224548
Epoch: 1, Steps: 469 | Train Loss: 0.489 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (inf --> -0.963120).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0553547
	speed: 0.7810s/iter; left time: 10545.2487s
	iters: 200, epoch: 2 | loss: 0.1104551
	speed: 0.1861s/iter; left time: 2494.2303s
	iters: 300, epoch: 2 | loss: 0.0206919
	speed: 0.1857s/iter; left time: 2469.8090s
	iters: 400, epoch: 2 | loss: 0.0171405
	speed: 0.1715s/iter; left time: 2264.3549s
Epoch: 2 cost time: 85.21265578269958
Epoch: 2, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.963120 --> -0.981703).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0323302
	speed: 0.7611s/iter; left time: 9919.3472s
	iters: 200, epoch: 3 | loss: 0.0135502
	speed: 0.1684s/iter; left time: 2178.2911s
	iters: 300, epoch: 3 | loss: 0.3075985
	speed: 0.1929s/iter; left time: 2475.4268s
	iters: 400, epoch: 3 | loss: 0.0053566
	speed: 0.1811s/iter; left time: 2305.7198s
Epoch: 3 cost time: 82.27947664260864
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0171724
	speed: 0.6398s/iter; left time: 8038.3095s
	iters: 200, epoch: 4 | loss: 0.0012756
	speed: 0.1393s/iter; left time: 1735.6382s
	iters: 300, epoch: 4 | loss: 0.0007312
	speed: 0.1461s/iter; left time: 1806.8096s
	iters: 400, epoch: 4 | loss: 0.3001466
	speed: 0.1611s/iter; left time: 1975.3623s
Epoch: 4 cost time: 70.46421504020691
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1008473
	speed: 0.6257s/iter; left time: 7567.8695s
	iters: 200, epoch: 5 | loss: 0.0007742
	speed: 0.1451s/iter; left time: 1739.9840s
	iters: 300, epoch: 5 | loss: 0.0005682
	speed: 0.1478s/iter; left time: 1757.6543s
	iters: 400, epoch: 5 | loss: 0.0718110
	speed: 0.1468s/iter; left time: 1731.1514s
Epoch: 5 cost time: 68.39666724205017
Epoch: 5, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0028844
	speed: 0.7007s/iter; left time: 8145.9830s
	iters: 200, epoch: 6 | loss: 0.0063281
	speed: 0.1651s/iter; left time: 1903.4389s
	iters: 300, epoch: 6 | loss: 0.0009944
	speed: 0.1699s/iter; left time: 1941.2589s
	iters: 400, epoch: 6 | loss: 0.0008951
	speed: 0.1859s/iter; left time: 2105.3591s
Epoch: 6 cost time: 82.11295938491821
Epoch: 6, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0183554
	speed: 0.7636s/iter; left time: 8519.3539s
	iters: 200, epoch: 7 | loss: 0.0004128
	speed: 0.1788s/iter; left time: 1976.9125s
	iters: 300, epoch: 7 | loss: 0.2755100
	speed: 0.1666s/iter; left time: 1825.0446s
	iters: 400, epoch: 7 | loss: 0.1082373
	speed: 0.1664s/iter; left time: 1806.0935s
Epoch: 7 cost time: 81.25465536117554
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0013892
	speed: 0.7386s/iter; left time: 7894.4001s
	iters: 200, epoch: 8 | loss: 0.0007487
	speed: 0.1356s/iter; left time: 1435.6163s
	iters: 300, epoch: 8 | loss: 0.0012648
	speed: 0.1426s/iter; left time: 1496.0236s
	iters: 400, epoch: 8 | loss: 0.0104018
	speed: 0.1419s/iter; left time: 1473.9525s
Epoch: 8 cost time: 66.23125147819519
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0007099
	speed: 0.6417s/iter; left time: 6557.9965s
	iters: 200, epoch: 9 | loss: 0.0033359
	speed: 0.1496s/iter; left time: 1513.3696s
	iters: 300, epoch: 9 | loss: 0.0008527
	speed: 0.1338s/iter; left time: 1340.2016s
	iters: 400, epoch: 9 | loss: 0.1850090
	speed: 0.1411s/iter; left time: 1399.6756s
Epoch: 9 cost time: 67.57802248001099
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0191986
	speed: 0.6541s/iter; left time: 6377.2938s
	iters: 200, epoch: 10 | loss: 0.0092196
	speed: 0.1450s/iter; left time: 1399.0592s
	iters: 300, epoch: 10 | loss: 0.0004718
	speed: 0.1807s/iter; left time: 1725.4978s
	iters: 400, epoch: 10 | loss: 0.0013531
	speed: 0.1654s/iter; left time: 1562.9645s
Epoch: 10 cost time: 76.0275571346283
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0004534
	speed: 0.7755s/iter; left time: 7197.7804s
	iters: 200, epoch: 11 | loss: 0.0051740
	speed: 0.1786s/iter; left time: 1639.7951s
	iters: 300, epoch: 11 | loss: 0.0007482
	speed: 0.1652s/iter; left time: 1500.1129s
	iters: 400, epoch: 11 | loss: 0.0827552
	speed: 0.1716s/iter; left time: 1541.3102s
Epoch: 11 cost time: 82.50312876701355
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0018568
	speed: 0.6998s/iter; left time: 6166.7559s
	iters: 200, epoch: 12 | loss: 0.0006027
	speed: 0.1470s/iter; left time: 1280.8902s
	iters: 300, epoch: 12 | loss: 0.0021931
	speed: 0.1213s/iter; left time: 1045.0539s
	iters: 400, epoch: 12 | loss: 0.0043766
	speed: 0.1271s/iter; left time: 1082.1354s
Epoch: 12 cost time: 63.5954225063324
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.981703 --> -0.981703).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0881576
	speed: 0.6803s/iter; left time: 5675.5170s
	iters: 200, epoch: 13 | loss: 0.0003031
	speed: 0.1399s/iter; left time: 1152.8464s
	iters: 300, epoch: 13 | loss: 0.0028820
	speed: 0.1565s/iter; left time: 1274.4488s
	iters: 400, epoch: 13 | loss: 0.0612815
	speed: 0.1661s/iter; left time: 1335.8540s
Epoch: 13 cost time: 71.44198775291443
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0008445
	speed: 0.6680s/iter; left time: 5259.4407s
	iters: 200, epoch: 14 | loss: 0.0007914
	speed: 0.1389s/iter; left time: 1079.9833s
	iters: 300, epoch: 14 | loss: 0.0008626
	speed: 0.1670s/iter; left time: 1281.3039s
	iters: 400, epoch: 14 | loss: 0.0016812
	speed: 0.1734s/iter; left time: 1313.4076s
Epoch: 14 cost time: 73.96408486366272
Epoch: 14, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0858130
	speed: 0.7811s/iter; left time: 5784.1203s
	iters: 200, epoch: 15 | loss: 0.0001739
	speed: 0.1745s/iter; left time: 1274.7339s
	iters: 300, epoch: 15 | loss: 0.2266274
	speed: 0.1959s/iter; left time: 1411.4160s
	iters: 400, epoch: 15 | loss: 0.0000797
	speed: 0.2065s/iter; left time: 1467.0596s
Epoch: 15 cost time: 88.84083676338196
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.983418).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0059518
	speed: 0.7833s/iter; left time: 5433.2616s
	iters: 200, epoch: 16 | loss: 0.0001831
	speed: 0.1897s/iter; left time: 1296.6366s
	iters: 300, epoch: 16 | loss: 0.0002608
	speed: 0.1908s/iter; left time: 1285.4373s
	iters: 400, epoch: 16 | loss: 0.0054258
	speed: 0.2042s/iter; left time: 1355.0796s
Epoch: 16 cost time: 90.25094413757324
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0021012
	speed: 0.6751s/iter; left time: 4366.0729s
	iters: 200, epoch: 17 | loss: 0.0177478
	speed: 0.1612s/iter; left time: 1026.2857s
	iters: 300, epoch: 17 | loss: 0.0068935
	speed: 0.1604s/iter; left time: 1005.3890s
	iters: 400, epoch: 17 | loss: 0.0005536
	speed: 0.1692s/iter; left time: 1043.6024s
Epoch: 17 cost time: 76.8486840724945
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0012521
	speed: 0.6556s/iter; left time: 3932.1843s
	iters: 200, epoch: 18 | loss: 0.0108974
	speed: 0.1676s/iter; left time: 988.6622s
	iters: 300, epoch: 18 | loss: 0.0004248
	speed: 0.1604s/iter; left time: 930.0714s
	iters: 400, epoch: 18 | loss: 0.0049494
	speed: 0.1495s/iter; left time: 852.1270s
Epoch: 18 cost time: 76.76328110694885
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0035983
	speed: 0.7097s/iter; left time: 3924.0732s
	iters: 200, epoch: 19 | loss: 0.0007829
	speed: 0.2036s/iter; left time: 1105.5358s
	iters: 300, epoch: 19 | loss: 0.0007308
	speed: 0.1848s/iter; left time: 984.8392s
	iters: 400, epoch: 19 | loss: 0.0005591
	speed: 0.1707s/iter; left time: 892.4023s
Epoch: 19 cost time: 88.927330493927
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0006011
	speed: 0.8108s/iter; left time: 4102.8115s
	iters: 200, epoch: 20 | loss: 0.0002903
	speed: 0.2067s/iter; left time: 1025.3070s
	iters: 300, epoch: 20 | loss: 0.0036727
	speed: 0.1758s/iter; left time: 854.2771s
	iters: 400, epoch: 20 | loss: 0.0004239
	speed: 0.1672s/iter; left time: 795.8780s
Epoch: 20 cost time: 86.93460011482239
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0016280
	speed: 0.7839s/iter; left time: 3598.7938s
	iters: 200, epoch: 21 | loss: 0.0021706
	speed: 0.1518s/iter; left time: 681.7202s
	iters: 300, epoch: 21 | loss: 0.0002930
	speed: 0.1169s/iter; left time: 513.1104s
	iters: 400, epoch: 21 | loss: 0.0002147
	speed: 0.1700s/iter; left time: 729.5852s
Epoch: 21 cost time: 72.06136679649353
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0006593
	speed: 0.7685s/iter; left time: 3167.8967s
	iters: 200, epoch: 22 | loss: 0.0003718
	speed: 0.1670s/iter; left time: 671.5451s
	iters: 300, epoch: 22 | loss: 0.0008677
	speed: 0.1723s/iter; left time: 675.8840s
	iters: 400, epoch: 22 | loss: 0.0052102
	speed: 0.1683s/iter; left time: 643.1273s
Epoch: 22 cost time: 80.05500555038452
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0003224
	speed: 0.7682s/iter; left time: 2806.1551s
	iters: 200, epoch: 23 | loss: 0.0002028
	speed: 0.1713s/iter; left time: 608.6662s
	iters: 300, epoch: 23 | loss: 0.0004181
	speed: 0.1737s/iter; left time: 599.7584s
	iters: 400, epoch: 23 | loss: 0.0004103
	speed: 0.1853s/iter; left time: 621.4475s
Epoch: 23 cost time: 85.52276349067688
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0892172
	speed: 0.9092s/iter; left time: 2895.0200s
	iters: 200, epoch: 24 | loss: 0.0099012
	speed: 0.1841s/iter; left time: 567.7057s
	iters: 300, epoch: 24 | loss: 0.0038826
	speed: 0.1855s/iter; left time: 553.5291s
	iters: 400, epoch: 24 | loss: 0.0003890
	speed: 0.2108s/iter; left time: 608.0861s
Epoch: 24 cost time: 92.2636137008667
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0010622
	speed: 0.8860s/iter; left time: 2405.4690s
	iters: 200, epoch: 25 | loss: 0.0003524
	speed: 0.1930s/iter; left time: 504.5665s
	iters: 300, epoch: 25 | loss: 0.0001569
	speed: 0.1980s/iter; left time: 497.8718s
	iters: 400, epoch: 25 | loss: 0.0010757
	speed: 0.1921s/iter; left time: 463.8994s
Epoch: 25 cost time: 89.30683541297913
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 7036938
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8284789
	speed: 0.1114s/iter; left time: 1556.6703s
	iters: 200, epoch: 1 | loss: 0.1503692
	speed: 0.0987s/iter; left time: 1368.7252s
	iters: 300, epoch: 1 | loss: 0.1270425
	speed: 0.0878s/iter; left time: 1208.5972s
	iters: 400, epoch: 1 | loss: 0.0392219
	speed: 0.0751s/iter; left time: 1027.2647s
Epoch: 1 cost time: 43.116172075271606
Epoch: 1, Steps: 469 | Train Loss: 0.537 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (inf --> -0.959976).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1271441
	speed: 0.4492s/iter; left time: 6065.4739s
	iters: 200, epoch: 2 | loss: 0.0817473
	speed: 0.0855s/iter; left time: 1146.3219s
	iters: 300, epoch: 2 | loss: 0.0074372
	speed: 0.0814s/iter; left time: 1082.6517s
	iters: 400, epoch: 2 | loss: 0.0619956
	speed: 0.0857s/iter; left time: 1131.2558s
Epoch: 2 cost time: 41.55899715423584
Epoch: 2, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.959976 --> -0.970554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0051797
	speed: 0.4876s/iter; left time: 6355.0922s
	iters: 200, epoch: 3 | loss: 0.0708027
	speed: 0.1059s/iter; left time: 1369.0004s
	iters: 300, epoch: 3 | loss: 0.1825846
	speed: 0.1019s/iter; left time: 1307.3947s
	iters: 400, epoch: 3 | loss: 0.0126543
	speed: 0.1134s/iter; left time: 1443.5810s
Epoch: 3 cost time: 52.100462675094604
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970554 --> -0.972841).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0093437
	speed: 0.5385s/iter; left time: 6765.7279s
	iters: 200, epoch: 4 | loss: 0.0221473
	speed: 0.1076s/iter; left time: 1341.4200s
	iters: 300, epoch: 4 | loss: 0.0025961
	speed: 0.1086s/iter; left time: 1342.9506s
	iters: 400, epoch: 4 | loss: 0.1900473
	speed: 0.1179s/iter; left time: 1446.1562s
Epoch: 4 cost time: 53.259621143341064
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972841 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0356526
	speed: 0.5209s/iter; left time: 6300.6233s
	iters: 200, epoch: 5 | loss: 0.0009145
	speed: 0.1120s/iter; left time: 1344.0093s
	iters: 300, epoch: 5 | loss: 0.0079170
	speed: 0.1177s/iter; left time: 1400.1523s
	iters: 400, epoch: 5 | loss: 0.0037883
	speed: 0.1168s/iter; left time: 1377.9306s
Epoch: 5 cost time: 54.187122106552124
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014449
	speed: 0.4540s/iter; left time: 5278.1506s
	iters: 200, epoch: 6 | loss: 0.0113153
	speed: 0.0960s/iter; left time: 1106.6079s
	iters: 300, epoch: 6 | loss: 0.0260529
	speed: 0.1029s/iter; left time: 1175.5249s
	iters: 400, epoch: 6 | loss: 0.0034849
	speed: 0.0999s/iter; left time: 1131.5748s
Epoch: 6 cost time: 46.395251750946045
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0046102
	speed: 0.3945s/iter; left time: 4401.5264s
	iters: 200, epoch: 7 | loss: 0.0536725
	speed: 0.1053s/iter; left time: 1164.7892s
	iters: 300, epoch: 7 | loss: 0.0042232
	speed: 0.1041s/iter; left time: 1140.4473s
	iters: 400, epoch: 7 | loss: 0.0018458
	speed: 0.0973s/iter; left time: 1056.0771s
Epoch: 7 cost time: 47.748767137527466
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0010338
	speed: 0.3826s/iter; left time: 4088.8187s
	iters: 200, epoch: 8 | loss: 0.0016819
	speed: 0.1090s/iter; left time: 1153.7239s
	iters: 300, epoch: 8 | loss: 0.0011307
	speed: 0.1078s/iter; left time: 1130.8838s
	iters: 400, epoch: 8 | loss: 0.0009578
	speed: 0.1025s/iter; left time: 1064.6481s
Epoch: 8 cost time: 48.18619227409363
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0014704
	speed: 0.3950s/iter; left time: 4037.0036s
	iters: 200, epoch: 9 | loss: 0.0001872
	speed: 0.1266s/iter; left time: 1280.7385s
	iters: 300, epoch: 9 | loss: 0.0005851
	speed: 0.1265s/iter; left time: 1267.8432s
	iters: 400, epoch: 9 | loss: 0.0012473
	speed: 0.1219s/iter; left time: 1209.1638s
Epoch: 9 cost time: 55.94332981109619
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0017476
	speed: 0.4744s/iter; left time: 4625.8308s
	iters: 200, epoch: 10 | loss: 0.0017627
	speed: 0.1267s/iter; left time: 1222.9144s
	iters: 300, epoch: 10 | loss: 0.0002159
	speed: 0.1280s/iter; left time: 1221.9353s
	iters: 400, epoch: 10 | loss: 0.0037456
	speed: 0.1261s/iter; left time: 1192.0666s
Epoch: 10 cost time: 57.03305792808533
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976843 --> -0.980274).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0160983
	speed: 0.4983s/iter; left time: 4625.1434s
	iters: 200, epoch: 11 | loss: 0.0015330
	speed: 0.1182s/iter; left time: 1085.2913s
	iters: 300, epoch: 11 | loss: 0.0003276
	speed: 0.1303s/iter; left time: 1182.8805s
	iters: 400, epoch: 11 | loss: 0.0071157
	speed: 0.1215s/iter; left time: 1091.3569s
Epoch: 11 cost time: 57.229329109191895
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0002143
	speed: 0.4849s/iter; left time: 4272.5660s
	iters: 200, epoch: 12 | loss: 0.0283637
	speed: 0.1015s/iter; left time: 884.4499s
	iters: 300, epoch: 12 | loss: 0.0004267
	speed: 0.1019s/iter; left time: 877.1708s
	iters: 400, epoch: 12 | loss: 0.0001600
	speed: 0.0973s/iter; left time: 828.0924s
Epoch: 12 cost time: 46.98926019668579
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981989).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000151
	speed: 0.4460s/iter; left time: 3720.8552s
	iters: 200, epoch: 13 | loss: 0.0001680
	speed: 0.1010s/iter; left time: 832.1930s
	iters: 300, epoch: 13 | loss: 0.1234214
	speed: 0.0945s/iter; left time: 769.1775s
	iters: 400, epoch: 13 | loss: 0.0004096
	speed: 0.0849s/iter; left time: 682.4875s
Epoch: 13 cost time: 45.166971921920776
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000495
	speed: 0.4659s/iter; left time: 3668.5774s
	iters: 200, epoch: 14 | loss: 0.1095725
	speed: 0.1022s/iter; left time: 794.8384s
	iters: 300, epoch: 14 | loss: 0.0011420
	speed: 0.0891s/iter; left time: 683.4974s
	iters: 400, epoch: 14 | loss: 0.0005777
	speed: 0.0876s/iter; left time: 663.6275s
Epoch: 14 cost time: 44.207448959350586
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.981989 --> -0.982275).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002533
	speed: 0.4759s/iter; left time: 3524.1440s
	iters: 200, epoch: 15 | loss: 0.0003725
	speed: 0.0941s/iter; left time: 687.5390s
	iters: 300, epoch: 15 | loss: 0.0022781
	speed: 0.0887s/iter; left time: 639.3124s
	iters: 400, epoch: 15 | loss: 0.0000479
	speed: 0.0866s/iter; left time: 614.9488s
Epoch: 15 cost time: 44.59614539146423
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0011601
	speed: 0.4865s/iter; left time: 3374.2187s
	iters: 200, epoch: 16 | loss: 0.0001920
	speed: 0.1047s/iter; left time: 715.9963s
	iters: 300, epoch: 16 | loss: 0.3627638
	speed: 0.0904s/iter; left time: 608.9331s
	iters: 400, epoch: 16 | loss: 0.0007003
	speed: 0.0897s/iter; left time: 595.3810s
Epoch: 16 cost time: 46.48024225234985
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0002690
	speed: 0.4753s/iter; left time: 3073.7242s
	iters: 200, epoch: 17 | loss: 0.0007386
	speed: 0.1377s/iter; left time: 876.4875s
	iters: 300, epoch: 17 | loss: 0.0011766
	speed: 0.1282s/iter; left time: 803.3032s
	iters: 400, epoch: 17 | loss: 0.0000896
	speed: 0.1212s/iter; left time: 747.1415s
Epoch: 17 cost time: 62.45711016654968
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0001499
	speed: 0.6269s/iter; left time: 3759.9984s
	iters: 200, epoch: 18 | loss: 0.0011802
	speed: 0.1334s/iter; left time: 786.5089s
	iters: 300, epoch: 18 | loss: 0.0077780
	speed: 0.1329s/iter; left time: 770.7927s
	iters: 400, epoch: 18 | loss: 0.0131332
	speed: 0.1318s/iter; left time: 751.1583s
Epoch: 18 cost time: 63.36231756210327
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0001051
	speed: 0.6161s/iter; left time: 3406.4355s
	iters: 200, epoch: 19 | loss: 0.0125038
	speed: 0.1265s/iter; left time: 686.5695s
	iters: 300, epoch: 19 | loss: 0.0000833
	speed: 0.1254s/iter; left time: 668.4248s
	iters: 400, epoch: 19 | loss: 0.0000924
	speed: 0.0930s/iter; left time: 486.4513s
Epoch: 19 cost time: 54.873400926589966
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0002320
	speed: 0.5669s/iter; left time: 2868.6978s
	iters: 200, epoch: 20 | loss: 0.0004816
	speed: 0.1152s/iter; left time: 571.4777s
	iters: 300, epoch: 20 | loss: 0.0001611
	speed: 0.1211s/iter; left time: 588.3136s
	iters: 400, epoch: 20 | loss: 0.0002108
	speed: 0.1143s/iter; left time: 543.8891s
Epoch: 20 cost time: 53.713701486587524
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000862
	speed: 0.5225s/iter; left time: 2398.9556s
	iters: 200, epoch: 21 | loss: 0.0000448
	speed: 0.1301s/iter; left time: 584.0687s
	iters: 300, epoch: 21 | loss: 0.0005642
	speed: 0.1312s/iter; left time: 576.2985s
	iters: 400, epoch: 21 | loss: 0.0114873
	speed: 0.1331s/iter; left time: 571.0831s
Epoch: 21 cost time: 62.353469133377075
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2835718
	speed: 0.5773s/iter; left time: 2379.7877s
	iters: 200, epoch: 22 | loss: 0.0001161
	speed: 0.1433s/iter; left time: 576.2058s
	iters: 300, epoch: 22 | loss: 0.0000579
	speed: 0.1314s/iter; left time: 515.5329s
	iters: 400, epoch: 22 | loss: 0.0004957
	speed: 0.1245s/iter; left time: 475.6872s
Epoch: 22 cost time: 62.767072916030884
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0001504
	speed: 0.5737s/iter; left time: 2095.6456s
	iters: 200, epoch: 23 | loss: 0.0027416
	speed: 0.1330s/iter; left time: 472.5576s
	iters: 300, epoch: 23 | loss: 0.0000292
	speed: 0.1433s/iter; left time: 494.9668s
	iters: 400, epoch: 23 | loss: 0.0001488
	speed: 0.1346s/iter; left time: 451.3501s
Epoch: 23 cost time: 62.600279331207275
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0002719
	speed: 0.5763s/iter; left time: 1835.0006s
	iters: 200, epoch: 24 | loss: 0.0094913
	speed: 0.1313s/iter; left time: 404.9828s
	iters: 300, epoch: 24 | loss: 0.0000687
	speed: 0.1304s/iter; left time: 388.9698s
	iters: 400, epoch: 24 | loss: 0.0009646
	speed: 0.1321s/iter; left time: 381.0514s
Epoch: 24 cost time: 62.58661675453186
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 2071818
model size : 9.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7212418
	speed: 0.1849s/iter; left time: 2583.3284s
	iters: 200, epoch: 1 | loss: 0.1503829
	speed: 0.1544s/iter; left time: 2141.4607s
	iters: 300, epoch: 1 | loss: 0.1659060
	speed: 0.1590s/iter; left time: 2190.0038s
	iters: 400, epoch: 1 | loss: 0.0528443
	speed: 0.1591s/iter; left time: 2175.0907s
Epoch: 1 cost time: 75.1244945526123
Epoch: 1, Steps: 469 | Train Loss: 0.497 Vali Loss: 0.124 Vali Acc: 0.960 Test Loss: 0.124 Test Acc: 0.960
Validation loss decreased (inf --> -0.960262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0280005
	speed: 0.6897s/iter; left time: 9311.6608s
	iters: 200, epoch: 2 | loss: 0.0893349
	speed: 0.1324s/iter; left time: 1774.5593s
	iters: 300, epoch: 2 | loss: 0.0191670
	speed: 0.1404s/iter; left time: 1867.5576s
	iters: 400, epoch: 2 | loss: 0.0051082
	speed: 0.1577s/iter; left time: 2082.6034s
Epoch: 2 cost time: 68.23278450965881
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.960262 --> -0.976843).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0141756
	speed: 0.6878s/iter; left time: 8964.3495s
	iters: 200, epoch: 3 | loss: 0.0037932
	speed: 0.1349s/iter; left time: 1744.4924s
	iters: 300, epoch: 3 | loss: 0.1803151
	speed: 0.1453s/iter; left time: 1865.2313s
	iters: 400, epoch: 3 | loss: 0.0028919
	speed: 0.1682s/iter; left time: 2142.2322s
Epoch: 3 cost time: 70.83540177345276
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0040806
	speed: 0.6748s/iter; left time: 8478.1480s
	iters: 200, epoch: 4 | loss: 0.3621186
	speed: 0.1458s/iter; left time: 1817.6571s
	iters: 300, epoch: 4 | loss: 0.0108255
	speed: 0.1548s/iter; left time: 1913.5455s
	iters: 400, epoch: 4 | loss: 0.0101357
	speed: 0.1531s/iter; left time: 1877.5155s
Epoch: 4 cost time: 69.11814618110657
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.981131).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0396991
	speed: 0.6641s/iter; left time: 8032.8914s
	iters: 200, epoch: 5 | loss: 0.0068850
	speed: 0.1565s/iter; left time: 1877.1537s
	iters: 300, epoch: 5 | loss: 0.0006558
	speed: 0.1680s/iter; left time: 1998.9173s
	iters: 400, epoch: 5 | loss: 0.0427321
	speed: 0.1625s/iter; left time: 1917.1375s
Epoch: 5 cost time: 74.95441460609436
Epoch: 5, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4720066
	speed: 0.6968s/iter; left time: 8101.4113s
	iters: 200, epoch: 6 | loss: 0.0037928
	speed: 0.1705s/iter; left time: 1965.3392s
	iters: 300, epoch: 6 | loss: 0.0009034
	speed: 0.1435s/iter; left time: 1640.0885s
	iters: 400, epoch: 6 | loss: 0.0007504
	speed: 0.1375s/iter; left time: 1556.8962s
Epoch: 6 cost time: 72.7638807296753
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0243539
	speed: 0.7179s/iter; left time: 8009.3863s
	iters: 200, epoch: 7 | loss: 0.0005064
	speed: 0.1462s/iter; left time: 1616.6306s
	iters: 300, epoch: 7 | loss: 0.0288191
	speed: 0.1589s/iter; left time: 1740.5525s
	iters: 400, epoch: 7 | loss: 0.0266425
	speed: 0.1578s/iter; left time: 1713.4795s
Epoch: 7 cost time: 72.94652485847473
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0007892
	speed: 0.7739s/iter; left time: 8271.3023s
	iters: 200, epoch: 8 | loss: 0.0008360
	speed: 0.1537s/iter; left time: 1626.8843s
	iters: 300, epoch: 8 | loss: 0.0025455
	speed: 0.1524s/iter; left time: 1598.2258s
	iters: 400, epoch: 8 | loss: 0.0029775
	speed: 0.1599s/iter; left time: 1661.4852s
Epoch: 8 cost time: 76.97692823410034
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0014827
	speed: 0.7685s/iter; left time: 7853.6567s
	iters: 200, epoch: 9 | loss: 0.0023386
	speed: 0.1693s/iter; left time: 1712.7443s
	iters: 300, epoch: 9 | loss: 0.0010388
	speed: 0.1794s/iter; left time: 1797.2510s
	iters: 400, epoch: 9 | loss: 0.0076448
	speed: 0.1758s/iter; left time: 1743.2870s
Epoch: 9 cost time: 79.63078618049622
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0005442
	speed: 0.7557s/iter; left time: 7368.1719s
	iters: 200, epoch: 10 | loss: 0.0096787
	speed: 0.1615s/iter; left time: 1558.7616s
	iters: 300, epoch: 10 | loss: 0.0006109
	speed: 0.1702s/iter; left time: 1625.6115s
	iters: 400, epoch: 10 | loss: 0.0010278
	speed: 0.1820s/iter; left time: 1719.7902s
Epoch: 10 cost time: 81.04418301582336
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0025031
	speed: 0.7490s/iter; left time: 6951.7561s
	iters: 200, epoch: 11 | loss: 0.0186343
	speed: 0.1869s/iter; left time: 1716.0143s
	iters: 300, epoch: 11 | loss: 0.0013505
	speed: 0.1813s/iter; left time: 1646.4482s
	iters: 400, epoch: 11 | loss: 0.0069383
	speed: 0.1613s/iter; left time: 1448.2844s
Epoch: 11 cost time: 80.97488713264465
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0032139
	speed: 0.7581s/iter; left time: 6680.4748s
	iters: 200, epoch: 12 | loss: 0.0001701
	speed: 0.1692s/iter; left time: 1473.7863s
	iters: 300, epoch: 12 | loss: 0.0215132
	speed: 0.1677s/iter; left time: 1444.0968s
	iters: 400, epoch: 12 | loss: 0.0002696
	speed: 0.1724s/iter; left time: 1467.4621s
Epoch: 12 cost time: 80.05287957191467
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0035321
	speed: 0.7674s/iter; left time: 6402.7228s
	iters: 200, epoch: 13 | loss: 0.0002042
	speed: 0.1795s/iter; left time: 1479.8067s
	iters: 300, epoch: 13 | loss: 0.0007749
	speed: 0.1537s/iter; left time: 1251.3616s
	iters: 400, epoch: 13 | loss: 0.0002872
	speed: 0.1517s/iter; left time: 1220.4005s
Epoch: 13 cost time: 78.29183411598206
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0021700
	speed: 0.7812s/iter; left time: 6151.2907s
	iters: 200, epoch: 14 | loss: 0.0009277
	speed: 0.1538s/iter; left time: 1195.7275s
	iters: 300, epoch: 14 | loss: 0.0587263
	speed: 0.1690s/iter; left time: 1296.8987s
	iters: 400, epoch: 14 | loss: 0.0156460
	speed: 0.1721s/iter; left time: 1303.6909s
Epoch: 14 cost time: 77.8530445098877
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0224883
	speed: 0.7248s/iter; left time: 5366.7811s
	iters: 200, epoch: 15 | loss: 0.0005395
	speed: 0.1261s/iter; left time: 920.9210s
	iters: 300, epoch: 15 | loss: 0.0112220
	speed: 0.1434s/iter; left time: 1033.2830s
	iters: 400, epoch: 15 | loss: 0.0000428
	speed: 0.1287s/iter; left time: 914.7218s
Epoch: 15 cost time: 61.99663782119751
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0002382
	speed: 0.5835s/iter; left time: 4047.2206s
	iters: 200, epoch: 16 | loss: 0.0031252
	speed: 0.1208s/iter; left time: 825.9593s
	iters: 300, epoch: 16 | loss: 0.0010431
	speed: 0.1135s/iter; left time: 764.5545s
	iters: 400, epoch: 16 | loss: 0.0007044
	speed: 0.1313s/iter; left time: 871.5058s
Epoch: 16 cost time: 61.3888201713562
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0001810
	speed: 0.5772s/iter; left time: 3732.8333s
	iters: 200, epoch: 17 | loss: 0.0007639
	speed: 0.1320s/iter; left time: 840.6199s
	iters: 300, epoch: 17 | loss: 0.0003610
	speed: 0.1483s/iter; left time: 929.6995s
	iters: 400, epoch: 17 | loss: 0.0013225
	speed: 0.1226s/iter; left time: 756.3798s
Epoch: 17 cost time: 60.00923442840576
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001706
	speed: 0.5758s/iter; left time: 3453.4742s
	iters: 200, epoch: 18 | loss: 0.0001005
	speed: 0.1288s/iter; left time: 759.4620s
	iters: 300, epoch: 18 | loss: 0.0009035
	speed: 0.1145s/iter; left time: 663.9393s
	iters: 400, epoch: 18 | loss: 0.0002377
	speed: 0.1240s/iter; left time: 706.7678s
Epoch: 18 cost time: 60.371280908584595
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0001479
	speed: 0.5847s/iter; left time: 3232.6668s
	iters: 200, epoch: 19 | loss: 0.0022624
	speed: 0.1339s/iter; left time: 726.8628s
	iters: 300, epoch: 19 | loss: 0.0518374
	speed: 0.1421s/iter; left time: 757.1366s
	iters: 400, epoch: 19 | loss: 0.0015655
	speed: 0.1298s/iter; left time: 678.5126s
Epoch: 19 cost time: 61.25814723968506
Epoch: 19, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0008449
	speed: 0.5754s/iter; left time: 2911.3869s
	iters: 200, epoch: 20 | loss: 0.0411143
	speed: 0.1320s/iter; left time: 654.6285s
	iters: 300, epoch: 20 | loss: 0.0049573
	speed: 0.1202s/iter; left time: 584.3084s
	iters: 400, epoch: 20 | loss: 0.0079600
	speed: 0.1225s/iter; left time: 583.1982s
Epoch: 20 cost time: 60.031126499176025
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0030047
	speed: 0.5880s/iter; left time: 2699.5090s
	iters: 200, epoch: 21 | loss: 0.0007267
	speed: 0.1477s/iter; left time: 663.1152s
	iters: 300, epoch: 21 | loss: 0.0017980
	speed: 0.1494s/iter; left time: 656.1008s
	iters: 400, epoch: 21 | loss: 0.0004524
	speed: 0.1479s/iter; left time: 634.7741s
Epoch: 21 cost time: 67.30959844589233
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981989).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0002899
	speed: 0.6544s/iter; left time: 2697.4350s
	iters: 200, epoch: 22 | loss: 0.0002148
	speed: 0.1662s/iter; left time: 668.5348s
	iters: 300, epoch: 22 | loss: 0.0002869
	speed: 0.1677s/iter; left time: 657.7605s
	iters: 400, epoch: 22 | loss: 0.0014733
	speed: 0.1742s/iter; left time: 665.7194s
Epoch: 22 cost time: 80.13519525527954
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003425
	speed: 0.7419s/iter; left time: 2709.9912s
	iters: 200, epoch: 23 | loss: 0.0008607
	speed: 0.1830s/iter; left time: 650.2221s
	iters: 300, epoch: 23 | loss: 0.0013482
	speed: 0.1783s/iter; left time: 615.7266s
	iters: 400, epoch: 23 | loss: 0.0818875
	speed: 0.1601s/iter; left time: 536.8820s
Epoch: 23 cost time: 80.25229716300964
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983132).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0011918
	speed: 0.7399s/iter; left time: 2355.8866s
	iters: 200, epoch: 24 | loss: 0.0336395
	speed: 0.1633s/iter; left time: 503.5098s
	iters: 300, epoch: 24 | loss: 0.0014453
	speed: 0.1683s/iter; left time: 502.2918s
	iters: 400, epoch: 24 | loss: 0.0000536
	speed: 0.1720s/iter; left time: 496.1164s
Epoch: 24 cost time: 78.62524271011353
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001823
	speed: 0.7353s/iter; left time: 1996.2538s
	iters: 200, epoch: 25 | loss: 0.0008021
	speed: 0.1806s/iter; left time: 472.3220s
	iters: 300, epoch: 25 | loss: 0.0000650
	speed: 0.1689s/iter; left time: 424.7537s
	iters: 400, epoch: 25 | loss: 0.0002660
	speed: 0.1536s/iter; left time: 371.0258s
Epoch: 25 cost time: 79.24122834205627
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0001361
	speed: 0.7430s/iter; left time: 1668.6782s
	iters: 200, epoch: 26 | loss: 0.3399222
	speed: 0.1656s/iter; left time: 355.4069s
	iters: 300, epoch: 26 | loss: 0.0002123
	speed: 0.1718s/iter; left time: 351.4712s
	iters: 400, epoch: 26 | loss: 0.0051943
	speed: 0.1690s/iter; left time: 328.9224s
Epoch: 26 cost time: 79.0360209941864
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3416995
	speed: 0.7418s/iter; left time: 1318.1561s
	iters: 200, epoch: 27 | loss: 0.0045792
	speed: 0.1790s/iter; left time: 300.1996s
	iters: 300, epoch: 27 | loss: 0.0000817
	speed: 0.1603s/iter; left time: 252.7343s
	iters: 400, epoch: 27 | loss: 0.0002729
	speed: 0.1525s/iter; left time: 225.1829s
Epoch: 27 cost time: 78.31132078170776
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0002165
	speed: 0.7449s/iter; left time: 974.3280s
	iters: 200, epoch: 28 | loss: 0.0001497
	speed: 0.1619s/iter; left time: 195.5635s
	iters: 300, epoch: 28 | loss: 0.0009057
	speed: 0.1770s/iter; left time: 196.1282s
	iters: 400, epoch: 28 | loss: 0.0000627
	speed: 0.1692s/iter; left time: 170.5544s
Epoch: 28 cost time: 77.85432600975037
Epoch: 28, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0007285
	speed: 0.6452s/iter; left time: 541.2978s
	iters: 200, epoch: 29 | loss: 0.0007231
	speed: 0.1323s/iter; left time: 97.7978s
	iters: 300, epoch: 29 | loss: 0.0006450
	speed: 0.1627s/iter; left time: 103.9359s
	iters: 400, epoch: 29 | loss: 0.0002544
	speed: 0.1642s/iter; left time: 88.5106s
Epoch: 29 cost time: 71.52516603469849
Epoch: 29, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0001762
	speed: 0.7184s/iter; left time: 265.8127s
	iters: 200, epoch: 30 | loss: 0.0001677
	speed: 0.1724s/iter; left time: 46.5403s
	iters: 300, epoch: 30 | loss: 0.0032320
	speed: 0.1442s/iter; left time: 24.5101s
	iters: 400, epoch: 30 | loss: 0.0000395
	speed: 0.1453s/iter; left time: 10.1680s
Epoch: 30 cost time: 74.00697350502014
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 7036938
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8069450
	speed: 0.1223s/iter; left time: 1708.1879s
	iters: 200, epoch: 1 | loss: 0.1612208
	speed: 0.1017s/iter; left time: 1410.4108s
	iters: 300, epoch: 1 | loss: 0.1321545
	speed: 0.1031s/iter; left time: 1420.0647s
	iters: 400, epoch: 1 | loss: 0.0510555
	speed: 0.0917s/iter; left time: 1254.2469s
Epoch: 1 cost time: 48.29118776321411
Epoch: 1, Steps: 469 | Train Loss: 0.546 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
Validation loss decreased (inf --> -0.963978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1921431
	speed: 0.4776s/iter; left time: 6448.4893s
	iters: 200, epoch: 2 | loss: 0.0585188
	speed: 0.1071s/iter; left time: 1435.5650s
	iters: 300, epoch: 2 | loss: 0.0107725
	speed: 0.1024s/iter; left time: 1362.1687s
	iters: 400, epoch: 2 | loss: 0.0514896
	speed: 0.0907s/iter; left time: 1197.3507s
Epoch: 2 cost time: 47.749056339263916
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.963978 --> -0.975414).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0046524
	speed: 0.4601s/iter; left time: 5996.2890s
	iters: 200, epoch: 3 | loss: 0.0914002
	speed: 0.1099s/iter; left time: 1421.5757s
	iters: 300, epoch: 3 | loss: 0.1038887
	speed: 0.1049s/iter; left time: 1345.7693s
	iters: 400, epoch: 3 | loss: 0.0604248
	speed: 0.0989s/iter; left time: 1258.8001s
Epoch: 3 cost time: 49.08030986785889
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0082625
	speed: 0.4527s/iter; left time: 5687.2069s
	iters: 200, epoch: 4 | loss: 0.0328608
	speed: 0.1014s/iter; left time: 1264.1139s
	iters: 300, epoch: 4 | loss: 0.0122201
	speed: 0.0927s/iter; left time: 1146.6700s
	iters: 400, epoch: 4 | loss: 0.0462862
	speed: 0.0989s/iter; left time: 1212.3898s
Epoch: 4 cost time: 46.418936014175415
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0179192
	speed: 0.4789s/iter; left time: 5791.8776s
	iters: 200, epoch: 5 | loss: 0.0014676
	speed: 0.0972s/iter; left time: 1166.1787s
	iters: 300, epoch: 5 | loss: 0.0056477
	speed: 0.0887s/iter; left time: 1055.0129s
	iters: 400, epoch: 5 | loss: 0.0024855
	speed: 0.0900s/iter; left time: 1061.2701s
Epoch: 5 cost time: 44.40261721611023
Epoch: 5, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.975414 --> -0.980845).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0013815
	speed: 0.5026s/iter; left time: 5842.6544s
	iters: 200, epoch: 6 | loss: 0.2039603
	speed: 0.1036s/iter; left time: 1194.0680s
	iters: 300, epoch: 6 | loss: 0.1888498
	speed: 0.1003s/iter; left time: 1145.7149s
	iters: 400, epoch: 6 | loss: 0.0013572
	speed: 0.0966s/iter; left time: 1094.6048s
Epoch: 6 cost time: 48.98986029624939
Epoch: 6, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0036148
	speed: 0.5030s/iter; left time: 5612.2535s
	iters: 200, epoch: 7 | loss: 0.0013771
	speed: 0.1060s/iter; left time: 1171.7854s
	iters: 300, epoch: 7 | loss: 0.0007505
	speed: 0.1031s/iter; left time: 1129.1591s
	iters: 400, epoch: 7 | loss: 0.0052606
	speed: 0.1062s/iter; left time: 1153.2971s
Epoch: 7 cost time: 49.77858877182007
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0010454
	speed: 0.5043s/iter; left time: 5390.0853s
	iters: 200, epoch: 8 | loss: 0.0024038
	speed: 0.0985s/iter; left time: 1043.4199s
	iters: 300, epoch: 8 | loss: 0.0006093
	speed: 0.0988s/iter; left time: 1036.6830s
	iters: 400, epoch: 8 | loss: 0.0060407
	speed: 0.1027s/iter; left time: 1067.2694s
Epoch: 8 cost time: 48.02887582778931
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.980845 --> -0.982561).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0071774
	speed: 0.5248s/iter; left time: 5362.5120s
	iters: 200, epoch: 9 | loss: 0.0334713
	speed: 0.0967s/iter; left time: 978.6583s
	iters: 300, epoch: 9 | loss: 0.0007661
	speed: 0.0990s/iter; left time: 992.2245s
	iters: 400, epoch: 9 | loss: 0.0019317
	speed: 0.1046s/iter; left time: 1037.5090s
Epoch: 9 cost time: 48.067731857299805
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0141484
	speed: 0.4926s/iter; left time: 4802.5840s
	iters: 200, epoch: 10 | loss: 0.0017526
	speed: 0.0871s/iter; left time: 840.2982s
	iters: 300, epoch: 10 | loss: 0.0003061
	speed: 0.0796s/iter; left time: 759.8177s
	iters: 400, epoch: 10 | loss: 0.0004677
	speed: 0.1057s/iter; left time: 999.2658s
Epoch: 10 cost time: 44.94696927070618
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0316927
	speed: 0.4418s/iter; left time: 4100.1682s
	iters: 200, epoch: 11 | loss: 0.0019754
	speed: 0.1002s/iter; left time: 920.1415s
	iters: 300, epoch: 11 | loss: 0.0040659
	speed: 0.1086s/iter; left time: 985.9990s
	iters: 400, epoch: 11 | loss: 0.2018605
	speed: 0.1012s/iter; left time: 908.8209s
Epoch: 11 cost time: 46.91387128829956
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001262
	speed: 0.4434s/iter; left time: 3907.2503s
	iters: 200, epoch: 12 | loss: 0.0000875
	speed: 0.0952s/iter; left time: 829.8179s
	iters: 300, epoch: 12 | loss: 0.0009006
	speed: 0.0856s/iter; left time: 736.9206s
	iters: 400, epoch: 12 | loss: 0.0006518
	speed: 0.0741s/iter; left time: 630.6248s
Epoch: 12 cost time: 41.02807974815369
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.982561 --> -0.984848).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0280349
	speed: 0.4338s/iter; left time: 3619.3913s
	iters: 200, epoch: 13 | loss: 0.0001211
	speed: 0.0831s/iter; left time: 685.2154s
	iters: 300, epoch: 13 | loss: 0.0112826
	speed: 0.0887s/iter; left time: 722.0597s
	iters: 400, epoch: 13 | loss: 0.0003430
	speed: 0.1008s/iter; left time: 810.6096s
Epoch: 13 cost time: 43.19655251502991
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0003548
	speed: 0.4185s/iter; left time: 3295.5931s
	iters: 200, epoch: 14 | loss: 0.0025399
	speed: 0.1014s/iter; left time: 788.5690s
	iters: 300, epoch: 14 | loss: 0.0022740
	speed: 0.1017s/iter; left time: 780.1509s
	iters: 400, epoch: 14 | loss: 0.0088578
	speed: 0.0837s/iter; left time: 634.1360s
Epoch: 14 cost time: 43.91377592086792
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1427041
	speed: 0.4392s/iter; left time: 3251.9491s
	iters: 200, epoch: 15 | loss: 0.0001857
	speed: 0.0854s/iter; left time: 624.0007s
	iters: 300, epoch: 15 | loss: 0.0001648
	speed: 0.0826s/iter; left time: 595.3631s
	iters: 400, epoch: 15 | loss: 0.0001285
	speed: 0.0845s/iter; left time: 600.4921s
Epoch: 15 cost time: 41.62148356437683
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0003263
	speed: 0.4318s/iter; left time: 2994.7322s
	iters: 200, epoch: 16 | loss: 0.0029423
	speed: 0.0848s/iter; left time: 579.9148s
	iters: 300, epoch: 16 | loss: 0.0004258
	speed: 0.0819s/iter; left time: 551.8936s
	iters: 400, epoch: 16 | loss: 0.0004009
	speed: 0.0939s/iter; left time: 623.3593s
Epoch: 16 cost time: 40.99710392951965
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0023190
	speed: 0.3812s/iter; left time: 2465.0250s
	iters: 200, epoch: 17 | loss: 0.0010021
	speed: 0.0948s/iter; left time: 603.6408s
	iters: 300, epoch: 17 | loss: 0.0004628
	speed: 0.0801s/iter; left time: 501.9048s
	iters: 400, epoch: 17 | loss: 0.0000144
	speed: 0.0745s/iter; left time: 459.2500s
Epoch: 17 cost time: 39.423770904541016
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000977
	speed: 0.3894s/iter; left time: 2335.3637s
	iters: 200, epoch: 18 | loss: 0.0004238
	speed: 0.0706s/iter; left time: 416.5950s
	iters: 300, epoch: 18 | loss: 0.0000634
	speed: 0.0737s/iter; left time: 427.2392s
	iters: 400, epoch: 18 | loss: 0.0022647
	speed: 0.0823s/iter; left time: 469.2116s
Epoch: 18 cost time: 37.079917430877686
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000528
	speed: 0.3788s/iter; left time: 2094.2926s
	iters: 200, epoch: 19 | loss: 0.0007929
	speed: 0.0856s/iter; left time: 464.8390s
	iters: 300, epoch: 19 | loss: 0.0001597
	speed: 0.0908s/iter; left time: 483.9819s
	iters: 400, epoch: 19 | loss: 0.0000683
	speed: 0.0826s/iter; left time: 431.9386s
Epoch: 19 cost time: 38.74315547943115
Epoch: 19, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0010681
	speed: 0.3767s/iter; left time: 1906.2035s
	iters: 200, epoch: 20 | loss: 0.0008683
	speed: 0.0782s/iter; left time: 387.8912s
	iters: 300, epoch: 20 | loss: 0.0000263
	speed: 0.0706s/iter; left time: 342.8832s
	iters: 400, epoch: 20 | loss: 0.0000664
	speed: 0.0717s/iter; left time: 341.4481s
Epoch: 20 cost time: 36.71361017227173
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0002380
	speed: 0.3846s/iter; left time: 1765.8083s
	iters: 200, epoch: 21 | loss: 0.0008170
	speed: 0.0737s/iter; left time: 331.0447s
	iters: 300, epoch: 21 | loss: 0.0002135
	speed: 0.0824s/iter; left time: 361.7842s
	iters: 400, epoch: 21 | loss: 0.0008275
	speed: 0.0909s/iter; left time: 389.9916s
Epoch: 21 cost time: 38.313546657562256
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0515815
	speed: 0.3679s/iter; left time: 1516.6193s
	iters: 200, epoch: 22 | loss: 0.0001904
	speed: 0.0905s/iter; left time: 364.0637s
	iters: 300, epoch: 22 | loss: 0.0000751
	speed: 0.0788s/iter; left time: 309.1329s
	iters: 400, epoch: 22 | loss: 0.1915840
	speed: 0.0726s/iter; left time: 277.6351s
Epoch: 22 cost time: 38.13588619232178
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 2071818
model size : 9.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8685466
	speed: 0.1235s/iter; left time: 1725.0725s
	iters: 200, epoch: 1 | loss: 0.2362429
	speed: 0.1067s/iter; left time: 1479.9503s
	iters: 300, epoch: 1 | loss: 0.1528301
	speed: 0.0850s/iter; left time: 1169.8630s
	iters: 400, epoch: 1 | loss: 0.0613515
	speed: 0.0835s/iter; left time: 1141.3628s
Epoch: 1 cost time: 45.52669382095337
Epoch: 1, Steps: 469 | Train Loss: 0.553 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
Validation loss decreased (inf --> -0.961119).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0338691
	speed: 0.4689s/iter; left time: 6331.5267s
	iters: 200, epoch: 2 | loss: 0.1074515
	speed: 0.1005s/iter; left time: 1347.3433s
	iters: 300, epoch: 2 | loss: 0.0400377
	speed: 0.0980s/iter; left time: 1303.1492s
	iters: 400, epoch: 2 | loss: 0.0128927
	speed: 0.0928s/iter; left time: 1224.8741s
Epoch: 2 cost time: 46.14269709587097
Epoch: 2, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.961119 --> -0.968267).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0472116
	speed: 0.5975s/iter; left time: 7787.0571s
	iters: 200, epoch: 3 | loss: 0.0096200
	speed: 0.1106s/iter; left time: 1430.1201s
	iters: 300, epoch: 3 | loss: 0.2166412
	speed: 0.1089s/iter; left time: 1396.9568s
	iters: 400, epoch: 3 | loss: 0.0077232
	speed: 0.1089s/iter; left time: 1387.1788s
Epoch: 3 cost time: 53.623509645462036
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0067420
	speed: 0.6175s/iter; left time: 7757.7214s
	iters: 200, epoch: 4 | loss: 0.0909958
	speed: 0.1173s/iter; left time: 1461.5723s
	iters: 300, epoch: 4 | loss: 0.0204326
	speed: 0.1089s/iter; left time: 1346.7775s
	iters: 400, epoch: 4 | loss: 0.0108243
	speed: 0.1088s/iter; left time: 1334.6199s
Epoch: 4 cost time: 54.27971649169922
Epoch: 4, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.968267 --> -0.977987).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0065798
	speed: 0.6147s/iter; left time: 7435.0180s
	iters: 200, epoch: 5 | loss: 0.0096874
	speed: 0.1231s/iter; left time: 1476.6421s
	iters: 300, epoch: 5 | loss: 0.0175467
	speed: 0.1121s/iter; left time: 1333.7381s
	iters: 400, epoch: 5 | loss: 0.0251525
	speed: 0.1166s/iter; left time: 1375.0696s
Epoch: 5 cost time: 56.26484751701355
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0031820
	speed: 0.6038s/iter; left time: 7020.0108s
	iters: 200, epoch: 6 | loss: 0.0094203
	speed: 0.1239s/iter; left time: 1428.1497s
	iters: 300, epoch: 6 | loss: 0.0283647
	speed: 0.1214s/iter; left time: 1387.4141s
	iters: 400, epoch: 6 | loss: 0.0023883
	speed: 0.1230s/iter; left time: 1392.8946s
Epoch: 6 cost time: 58.065123081207275
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0057143
	speed: 0.5890s/iter; left time: 6571.8673s
	iters: 200, epoch: 7 | loss: 0.0001450
	speed: 0.1260s/iter; left time: 1393.5586s
	iters: 300, epoch: 7 | loss: 0.0162139
	speed: 0.1351s/iter; left time: 1480.2616s
	iters: 400, epoch: 7 | loss: 0.0554810
	speed: 0.1220s/iter; left time: 1324.4290s
Epoch: 7 cost time: 59.64525628089905
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0064932
	speed: 0.5750s/iter; left time: 6145.2703s
	iters: 200, epoch: 8 | loss: 0.1172782
	speed: 0.1358s/iter; left time: 1437.5066s
	iters: 300, epoch: 8 | loss: 0.0006485
	speed: 0.1354s/iter; left time: 1420.1839s
	iters: 400, epoch: 8 | loss: 0.0011260
	speed: 0.1270s/iter; left time: 1319.3803s
Epoch: 8 cost time: 60.228477001190186
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.977987 --> -0.980845).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003174
	speed: 0.5731s/iter; left time: 5856.9775s
	iters: 200, epoch: 9 | loss: 0.1707179
	speed: 0.1353s/iter; left time: 1369.3073s
	iters: 300, epoch: 9 | loss: 0.0007025
	speed: 0.1362s/iter; left time: 1364.5576s
	iters: 400, epoch: 9 | loss: 0.0003987
	speed: 0.1271s/iter; left time: 1260.8958s
Epoch: 9 cost time: 61.01041102409363
Epoch: 9, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0026285
	speed: 0.5663s/iter; left time: 5521.5223s
	iters: 200, epoch: 10 | loss: 0.0009163
	speed: 0.1361s/iter; left time: 1313.1383s
	iters: 300, epoch: 10 | loss: 0.0010500
	speed: 0.1307s/iter; left time: 1248.2152s
	iters: 400, epoch: 10 | loss: 0.0403529
	speed: 0.1245s/iter; left time: 1176.9246s
Epoch: 10 cost time: 60.62168049812317
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0009928
	speed: 0.5796s/iter; left time: 5378.8580s
	iters: 200, epoch: 11 | loss: 0.0029754
	speed: 0.1300s/iter; left time: 1193.5884s
	iters: 300, epoch: 11 | loss: 0.0011167
	speed: 0.1150s/iter; left time: 1044.7022s
	iters: 400, epoch: 11 | loss: 0.0005122
	speed: 0.1123s/iter; left time: 1008.2968s
Epoch: 11 cost time: 56.25011086463928
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2289837
	speed: 0.5359s/iter; left time: 4722.5535s
	iters: 200, epoch: 12 | loss: 0.0002672
	speed: 0.1025s/iter; left time: 893.0646s
	iters: 300, epoch: 12 | loss: 0.0038182
	speed: 0.1128s/iter; left time: 971.2279s
	iters: 400, epoch: 12 | loss: 0.0015153
	speed: 0.1101s/iter; left time: 937.1271s
Epoch: 12 cost time: 51.9466016292572
Epoch: 12, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0013853
	speed: 0.5364s/iter; left time: 4474.9265s
	iters: 200, epoch: 13 | loss: 0.0001031
	speed: 0.0970s/iter; left time: 799.7714s
	iters: 300, epoch: 13 | loss: 0.0006688
	speed: 0.1013s/iter; left time: 824.9515s
	iters: 400, epoch: 13 | loss: 0.0008988
	speed: 0.1055s/iter; left time: 848.7667s
Epoch: 13 cost time: 48.30344891548157
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0005782
	speed: 0.5176s/iter; left time: 4075.8166s
	iters: 200, epoch: 14 | loss: 0.0009384
	speed: 0.0929s/iter; left time: 722.3912s
	iters: 300, epoch: 14 | loss: 0.0032795
	speed: 0.0959s/iter; left time: 735.7596s
	iters: 400, epoch: 14 | loss: 0.0010698
	speed: 0.1107s/iter; left time: 838.3713s
Epoch: 14 cost time: 47.71074414253235
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0469235
	speed: 0.5194s/iter; left time: 3846.1504s
	iters: 200, epoch: 15 | loss: 0.0004343
	speed: 0.0915s/iter; left time: 668.5766s
	iters: 300, epoch: 15 | loss: 0.0000503
	speed: 0.0965s/iter; left time: 695.2738s
	iters: 400, epoch: 15 | loss: 0.0022539
	speed: 0.1164s/iter; left time: 826.8849s
Epoch: 15 cost time: 48.09694766998291
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0012386
	speed: 0.5269s/iter; left time: 3654.7965s
	iters: 200, epoch: 16 | loss: 0.0038177
	speed: 0.0928s/iter; left time: 634.1895s
	iters: 300, epoch: 16 | loss: 0.0002261
	speed: 0.1051s/iter; left time: 708.1931s
	iters: 400, epoch: 16 | loss: 0.0002942
	speed: 0.1139s/iter; left time: 755.9362s
Epoch: 16 cost time: 49.51087784767151
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0008343
	speed: 0.5280s/iter; left time: 3414.7132s
	iters: 200, epoch: 17 | loss: 0.0008393
	speed: 0.1004s/iter; left time: 639.0060s
	iters: 300, epoch: 17 | loss: 0.0056785
	speed: 0.1059s/iter; left time: 663.9192s
	iters: 400, epoch: 17 | loss: 0.0005031
	speed: 0.1109s/iter; left time: 684.1695s
Epoch: 17 cost time: 49.06440496444702
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0053377
	speed: 0.5152s/iter; left time: 3089.9035s
	iters: 200, epoch: 18 | loss: 0.0000588
	speed: 0.1037s/iter; left time: 611.3725s
	iters: 300, epoch: 18 | loss: 0.0000505
	speed: 0.1076s/iter; left time: 624.0439s
	iters: 400, epoch: 18 | loss: 0.0015243
	speed: 0.0969s/iter; left time: 552.1869s
Epoch: 18 cost time: 47.384713649749756
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.981417).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000842
	speed: 0.4526s/iter; left time: 2502.6922s
	iters: 200, epoch: 19 | loss: 0.0005204
	speed: 0.1198s/iter; left time: 650.2881s
	iters: 300, epoch: 19 | loss: 0.0003025
	speed: 0.1134s/iter; left time: 604.0802s
	iters: 400, epoch: 19 | loss: 0.0156604
	speed: 0.0981s/iter; left time: 512.7241s
Epoch: 19 cost time: 50.83692717552185
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1740437
	speed: 0.5297s/iter; left time: 2680.0709s
	iters: 200, epoch: 20 | loss: 0.5329499
	speed: 0.1121s/iter; left time: 555.8723s
	iters: 300, epoch: 20 | loss: 0.0007330
	speed: 0.0981s/iter; left time: 476.8688s
	iters: 400, epoch: 20 | loss: 0.0247712
	speed: 0.0975s/iter; left time: 463.9368s
Epoch: 20 cost time: 49.979254722595215
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0004479
	speed: 0.4816s/iter; left time: 2210.8068s
	iters: 200, epoch: 21 | loss: 0.0001898
	speed: 0.0924s/iter; left time: 414.9112s
	iters: 300, epoch: 21 | loss: 0.0000874
	speed: 0.0980s/iter; left time: 430.1101s
	iters: 400, epoch: 21 | loss: 0.0001863
	speed: 0.0879s/iter; left time: 377.0257s
Epoch: 21 cost time: 42.30534482002258
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0004228
	speed: 0.4760s/iter; left time: 1961.9898s
	iters: 200, epoch: 22 | loss: 0.0001251
	speed: 0.0862s/iter; left time: 346.8606s
	iters: 300, epoch: 22 | loss: 0.1016289
	speed: 0.0895s/iter; left time: 351.0323s
	iters: 400, epoch: 22 | loss: 0.0486386
	speed: 0.1075s/iter; left time: 410.9661s
Epoch: 22 cost time: 44.933720111846924
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.981417 --> -0.984276).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1710550
	speed: 0.4757s/iter; left time: 1737.7633s
	iters: 200, epoch: 23 | loss: 0.0002832
	speed: 0.1066s/iter; left time: 378.7608s
	iters: 300, epoch: 23 | loss: 0.0001391
	speed: 0.0989s/iter; left time: 341.3924s
	iters: 400, epoch: 23 | loss: 0.0025037
	speed: 0.0975s/iter; left time: 326.9984s
Epoch: 23 cost time: 46.65094041824341
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0073948
	speed: 0.4692s/iter; left time: 1493.7792s
	iters: 200, epoch: 24 | loss: 0.0078126
	speed: 0.1021s/iter; left time: 314.8355s
	iters: 300, epoch: 24 | loss: 0.0005938
	speed: 0.1048s/iter; left time: 312.6871s
	iters: 400, epoch: 24 | loss: 0.0003415
	speed: 0.0956s/iter; left time: 275.6735s
Epoch: 24 cost time: 46.658464670181274
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0003643
	speed: 0.4904s/iter; left time: 1331.3892s
	iters: 200, epoch: 25 | loss: 0.0001509
	speed: 0.0861s/iter; left time: 225.2698s
	iters: 300, epoch: 25 | loss: 0.0000983
	speed: 0.0883s/iter; left time: 222.0142s
	iters: 400, epoch: 25 | loss: 0.0008107
	speed: 0.0926s/iter; left time: 223.5896s
Epoch: 25 cost time: 44.3447539806366
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0001984
	speed: 0.4876s/iter; left time: 1095.0579s
	iters: 200, epoch: 26 | loss: 0.2722751
	speed: 0.0993s/iter; left time: 213.1327s
	iters: 300, epoch: 26 | loss: 0.0051863
	speed: 0.0907s/iter; left time: 185.5776s
	iters: 400, epoch: 26 | loss: 0.0001927
	speed: 0.0921s/iter; left time: 179.1333s
Epoch: 26 cost time: 45.178646087646484
Epoch: 26, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2183489
	speed: 0.4839s/iter; left time: 859.8771s
	iters: 200, epoch: 27 | loss: 0.0042343
	speed: 0.0885s/iter; left time: 148.3930s
	iters: 300, epoch: 27 | loss: 0.0000320
	speed: 0.1054s/iter; left time: 166.1614s
	iters: 400, epoch: 27 | loss: 0.0002889
	speed: 0.1128s/iter; left time: 166.5521s
Epoch: 27 cost time: 46.83757781982422
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0011487
	speed: 0.4694s/iter; left time: 613.9432s
	iters: 200, epoch: 28 | loss: 0.0011155
	speed: 0.0888s/iter; left time: 107.2498s
	iters: 300, epoch: 28 | loss: 0.0037038
	speed: 0.0874s/iter; left time: 96.8565s
	iters: 400, epoch: 28 | loss: 0.0009405
	speed: 0.0810s/iter; left time: 81.6948s
Epoch: 28 cost time: 42.33527612686157
Epoch: 28, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0012565
	speed: 0.4132s/iter; left time: 346.6450s
	iters: 200, epoch: 29 | loss: 0.0000075
	speed: 0.0998s/iter; left time: 73.7550s
	iters: 300, epoch: 29 | loss: 0.0001274
	speed: 0.0886s/iter; left time: 56.6238s
	iters: 400, epoch: 29 | loss: 0.0007261
	speed: 0.0756s/iter; left time: 40.7694s
Epoch: 29 cost time: 40.69842839241028
Epoch: 29, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0003886
	speed: 0.3864s/iter; left time: 142.9630s
	iters: 200, epoch: 30 | loss: 0.0000380
	speed: 0.0628s/iter; left time: 16.9484s
	iters: 300, epoch: 30 | loss: 0.0004438
	speed: 0.0878s/iter; left time: 14.9202s
	iters: 400, epoch: 30 | loss: 0.0001033
	speed: 0.0974s/iter; left time: 6.8173s
Epoch: 30 cost time: 38.001952171325684
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 7036938
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9095023
	speed: 0.1051s/iter; left time: 1468.1243s
	iters: 200, epoch: 1 | loss: 0.2504303
	speed: 0.0830s/iter; left time: 1151.6267s
	iters: 300, epoch: 1 | loss: 0.1631840
	speed: 0.0721s/iter; left time: 992.3324s
	iters: 400, epoch: 1 | loss: 0.0793604
	speed: 0.0647s/iter; left time: 883.8767s
Epoch: 1 cost time: 36.89403676986694
Epoch: 1, Steps: 469 | Train Loss: 0.619 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (inf --> -0.963120).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2720721
	speed: 0.3787s/iter; left time: 5112.6357s
	iters: 200, epoch: 2 | loss: 0.0824033
	speed: 0.0740s/iter; left time: 991.3290s
	iters: 300, epoch: 2 | loss: 0.0260042
	speed: 0.0649s/iter; left time: 863.2548s
	iters: 400, epoch: 2 | loss: 0.0295850
	speed: 0.0661s/iter; left time: 872.8396s
Epoch: 2 cost time: 34.01839065551758
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
Validation loss decreased (-0.963120 --> -0.963121).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0128034
	speed: 0.3781s/iter; left time: 4928.3971s
	iters: 200, epoch: 3 | loss: 0.0886913
	speed: 0.0758s/iter; left time: 980.5731s
	iters: 300, epoch: 3 | loss: 0.1229259
	speed: 0.0778s/iter; left time: 997.8599s
	iters: 400, epoch: 3 | loss: 0.0149881
	speed: 0.0783s/iter; left time: 997.1030s
Epoch: 3 cost time: 36.197532176971436
Epoch: 3, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.963121 --> -0.971697).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0068469
	speed: 0.3715s/iter; left time: 4667.9092s
	iters: 200, epoch: 4 | loss: 0.0092275
	speed: 0.0899s/iter; left time: 1120.1049s
	iters: 300, epoch: 4 | loss: 0.0015064
	speed: 0.0713s/iter; left time: 881.9307s
	iters: 400, epoch: 4 | loss: 0.0676742
	speed: 0.0666s/iter; left time: 816.9153s
Epoch: 4 cost time: 36.70490527153015
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0109815
	speed: 0.3772s/iter; left time: 4562.0697s
	iters: 200, epoch: 5 | loss: 0.0041064
	speed: 0.0778s/iter; left time: 932.6849s
	iters: 300, epoch: 5 | loss: 0.0029883
	speed: 0.0733s/iter; left time: 872.1133s
	iters: 400, epoch: 5 | loss: 0.0036456
	speed: 0.0684s/iter; left time: 806.5028s
Epoch: 5 cost time: 35.400609493255615
Epoch: 5, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.971697 --> -0.980560).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0031219
	speed: 0.3661s/iter; left time: 4256.2106s
	iters: 200, epoch: 6 | loss: 0.1276069
	speed: 0.0860s/iter; left time: 991.1958s
	iters: 300, epoch: 6 | loss: 0.0091505
	speed: 0.0965s/iter; left time: 1102.4457s
	iters: 400, epoch: 6 | loss: 0.0026156
	speed: 0.0823s/iter; left time: 931.6824s
Epoch: 6 cost time: 39.35519981384277
Epoch: 6, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0016144
	speed: 0.4107s/iter; left time: 4582.1082s
	iters: 200, epoch: 7 | loss: 0.0162547
	speed: 0.0931s/iter; left time: 1029.2701s
	iters: 300, epoch: 7 | loss: 0.0047248
	speed: 0.0863s/iter; left time: 945.4019s
	iters: 400, epoch: 7 | loss: 0.0026798
	speed: 0.0743s/iter; left time: 806.4888s
Epoch: 7 cost time: 40.75650954246521
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0004721
	speed: 0.4125s/iter; left time: 4408.7563s
	iters: 200, epoch: 8 | loss: 0.0013860
	speed: 0.0861s/iter; left time: 911.3180s
	iters: 300, epoch: 8 | loss: 0.0003773
	speed: 0.0862s/iter; left time: 903.8395s
	iters: 400, epoch: 8 | loss: 0.0101298
	speed: 0.0868s/iter; left time: 901.7041s
Epoch: 8 cost time: 40.986878633499146
Epoch: 8, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0005579
	speed: 0.4023s/iter; left time: 4111.3132s
	iters: 200, epoch: 9 | loss: 0.0014922
	speed: 0.0973s/iter; left time: 984.6451s
	iters: 300, epoch: 9 | loss: 0.0012844
	speed: 0.0977s/iter; left time: 978.7430s
	iters: 400, epoch: 9 | loss: 0.0623637
	speed: 0.0827s/iter; left time: 820.6009s
Epoch: 9 cost time: 42.07160711288452
Epoch: 9, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.980560 --> -0.981417).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0061052
	speed: 0.4092s/iter; left time: 3989.5556s
	iters: 200, epoch: 10 | loss: 0.0237987
	speed: 0.0894s/iter; left time: 863.1900s
	iters: 300, epoch: 10 | loss: 0.0003184
	speed: 0.0859s/iter; left time: 820.5445s
	iters: 400, epoch: 10 | loss: 0.0001392
	speed: 0.0790s/iter; left time: 746.5077s
Epoch: 10 cost time: 40.793962478637695
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0021877
	speed: 0.4115s/iter; left time: 3818.7711s
	iters: 200, epoch: 11 | loss: 0.0006768
	speed: 0.0862s/iter; left time: 791.7999s
	iters: 300, epoch: 11 | loss: 0.0005757
	speed: 0.0886s/iter; left time: 804.8662s
	iters: 400, epoch: 11 | loss: 0.0884449
	speed: 0.0923s/iter; left time: 829.2840s
Epoch: 11 cost time: 41.67107439041138
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0004438
	speed: 0.4047s/iter; left time: 3566.6117s
	iters: 200, epoch: 12 | loss: 0.0023142
	speed: 0.0978s/iter; left time: 852.2256s
	iters: 300, epoch: 12 | loss: 0.0007181
	speed: 0.0971s/iter; left time: 836.2328s
	iters: 400, epoch: 12 | loss: 0.0017252
	speed: 0.0835s/iter; left time: 710.6916s
Epoch: 12 cost time: 42.2069308757782
Epoch: 12, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000654
	speed: 0.4097s/iter; left time: 3418.0213s
	iters: 200, epoch: 13 | loss: 0.0014424
	speed: 0.0858s/iter; left time: 707.2781s
	iters: 300, epoch: 13 | loss: 0.0108099
	speed: 0.0851s/iter; left time: 692.8059s
	iters: 400, epoch: 13 | loss: 0.0159287
	speed: 0.0834s/iter; left time: 671.1598s
Epoch: 13 cost time: 40.299553871154785
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0002988
	speed: 0.4047s/iter; left time: 3186.8510s
	iters: 200, epoch: 14 | loss: 0.0007437
	speed: 0.0855s/iter; left time: 664.9446s
	iters: 300, epoch: 14 | loss: 0.0003457
	speed: 0.0907s/iter; left time: 696.3632s
	iters: 400, epoch: 14 | loss: 0.0005811
	speed: 0.0978s/iter; left time: 740.8699s
Epoch: 14 cost time: 41.70850110054016
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3402972
	speed: 0.3956s/iter; left time: 2929.4581s
	iters: 200, epoch: 15 | loss: 0.0003377
	speed: 0.0988s/iter; left time: 721.9008s
	iters: 300, epoch: 15 | loss: 0.0001901
	speed: 0.0956s/iter; left time: 688.6483s
	iters: 400, epoch: 15 | loss: 0.0000303
	speed: 0.0850s/iter; left time: 603.7506s
Epoch: 15 cost time: 42.08140730857849
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0002308
	speed: 0.4021s/iter; left time: 2788.6754s
	iters: 200, epoch: 16 | loss: 0.0066348
	speed: 0.0770s/iter; left time: 526.4112s
	iters: 300, epoch: 16 | loss: 0.0002266
	speed: 0.0747s/iter; left time: 503.5021s
	iters: 400, epoch: 16 | loss: 0.0002222
	speed: 0.0592s/iter; left time: 393.0802s
Epoch: 16 cost time: 33.829007625579834
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0008933
	speed: 0.3610s/iter; left time: 2334.6910s
	iters: 200, epoch: 17 | loss: 0.0005284
	speed: 0.0599s/iter; left time: 381.6112s
	iters: 300, epoch: 17 | loss: 0.0001485
	speed: 0.0637s/iter; left time: 399.3743s
	iters: 400, epoch: 17 | loss: 0.0003108
	speed: 0.0711s/iter; left time: 438.3305s
Epoch: 17 cost time: 31.081685781478882
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0001755
	speed: 0.3332s/iter; left time: 1998.4172s
	iters: 200, epoch: 18 | loss: 0.0001285
	speed: 0.0579s/iter; left time: 341.5415s
	iters: 300, epoch: 18 | loss: 0.0000707
	speed: 0.0506s/iter; left time: 293.2452s
	iters: 400, epoch: 18 | loss: 0.0240296
	speed: 0.0579s/iter; left time: 329.9171s
Epoch: 18 cost time: 27.3651704788208
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0006955
	speed: 0.2974s/iter; left time: 1644.5188s
	iters: 200, epoch: 19 | loss: 0.0139141
	speed: 0.0662s/iter; left time: 359.6417s
	iters: 300, epoch: 19 | loss: 0.0003399
	speed: 0.0687s/iter; left time: 365.8743s
	iters: 400, epoch: 19 | loss: 0.0003424
	speed: 0.0628s/iter; left time: 328.5280s
Epoch: 19 cost time: 29.140555381774902
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0046938
	speed: 0.2919s/iter; left time: 1477.0229s
	iters: 200, epoch: 20 | loss: 0.0002991
	speed: 0.0634s/iter; left time: 314.5602s
	iters: 300, epoch: 20 | loss: 0.0002031
	speed: 0.0608s/iter; left time: 295.3443s
	iters: 400, epoch: 20 | loss: 0.0000316
	speed: 0.0628s/iter; left time: 299.0518s
Epoch: 20 cost time: 29.291508674621582
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.981703 --> -0.981703).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000938
	speed: 0.3111s/iter; left time: 1428.1517s
	iters: 200, epoch: 21 | loss: 0.0000433
	speed: 0.0520s/iter; left time: 233.6799s
	iters: 300, epoch: 21 | loss: 0.0012811
	speed: 0.0506s/iter; left time: 222.3295s
	iters: 400, epoch: 21 | loss: 0.0145214
	speed: 0.0537s/iter; left time: 230.5413s
Epoch: 21 cost time: 27.474449634552002
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0011407
	speed: 0.3126s/iter; left time: 1288.7358s
	iters: 200, epoch: 22 | loss: 0.0017051
	speed: 0.0609s/iter; left time: 244.8185s
	iters: 300, epoch: 22 | loss: 0.0006657
	speed: 0.0567s/iter; left time: 222.4993s
	iters: 400, epoch: 22 | loss: 0.0470833
	speed: 0.0546s/iter; left time: 208.8062s
Epoch: 22 cost time: 27.838488578796387
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0041875
	speed: 0.3100s/iter; left time: 1132.4650s
	iters: 200, epoch: 23 | loss: 0.0055000
	speed: 0.0554s/iter; left time: 196.7233s
	iters: 300, epoch: 23 | loss: 0.0008172
	speed: 0.0670s/iter; left time: 231.5223s
	iters: 400, epoch: 23 | loss: 0.0004508
	speed: 0.0690s/iter; left time: 231.4221s
Epoch: 23 cost time: 29.31388282775879
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0002555
	speed: 0.2957s/iter; left time: 941.3888s
	iters: 200, epoch: 24 | loss: 0.0003049
	speed: 0.0637s/iter; left time: 196.5300s
	iters: 300, epoch: 24 | loss: 0.0006008
	speed: 0.0635s/iter; left time: 189.4261s
	iters: 400, epoch: 24 | loss: 0.0003611
	speed: 0.0619s/iter; left time: 178.5374s
Epoch: 24 cost time: 29.30742049217224
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982561).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0001826
	speed: 0.3044s/iter; left time: 826.4336s
	iters: 200, epoch: 25 | loss: 0.0003282
	speed: 0.0702s/iter; left time: 183.6899s
	iters: 300, epoch: 25 | loss: 0.0010629
	speed: 0.0551s/iter; left time: 138.5434s
	iters: 400, epoch: 25 | loss: 0.1657095
	speed: 0.0541s/iter; left time: 130.7611s
Epoch: 25 cost time: 28.819636344909668
Epoch: 25, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0877013
	speed: 0.3476s/iter; left time: 780.6255s
	iters: 200, epoch: 26 | loss: 0.0000865
	speed: 0.0688s/iter; left time: 147.6353s
	iters: 300, epoch: 26 | loss: 0.0000402
	speed: 0.0710s/iter; left time: 145.2335s
	iters: 400, epoch: 26 | loss: 0.0106398
	speed: 0.0632s/iter; left time: 123.0321s
Epoch: 26 cost time: 32.22842860221863
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0001536
	speed: 0.3588s/iter; left time: 637.6730s
	iters: 200, epoch: 27 | loss: 0.0000691
	speed: 0.0618s/iter; left time: 103.6461s
	iters: 300, epoch: 27 | loss: 0.0000549
	speed: 0.0651s/iter; left time: 102.6771s
	iters: 400, epoch: 27 | loss: 0.0217191
	speed: 0.0697s/iter; left time: 102.9254s
Epoch: 27 cost time: 31.478159427642822
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0326570
	speed: 0.3183s/iter; left time: 416.3962s
	iters: 200, epoch: 28 | loss: 0.0000946
	speed: 0.0718s/iter; left time: 86.6983s
	iters: 300, epoch: 28 | loss: 0.0003147
	speed: 0.0846s/iter; left time: 93.7618s
	iters: 400, epoch: 28 | loss: 0.0001931
	speed: 0.0926s/iter; left time: 93.3772s
Epoch: 28 cost time: 39.22469615936279
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000716
	speed: 0.4653s/iter; left time: 390.3513s
	iters: 200, epoch: 29 | loss: 0.0029465
	speed: 0.0822s/iter; left time: 60.7417s
	iters: 300, epoch: 29 | loss: 0.0001965
	speed: 0.0825s/iter; left time: 52.6976s
	iters: 400, epoch: 29 | loss: 0.0000463
	speed: 0.0822s/iter; left time: 44.3325s
Epoch: 29 cost time: 41.02359223365784
Epoch: 29, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0264313
	speed: 0.4812s/iter; left time: 178.0410s
	iters: 200, epoch: 30 | loss: 0.0000873
	speed: 0.0823s/iter; left time: 22.2287s
	iters: 300, epoch: 30 | loss: 0.0000505
	speed: 0.0834s/iter; left time: 14.1745s
	iters: 400, epoch: 30 | loss: 0.0004634
	speed: 0.0913s/iter; left time: 6.3883s
Epoch: 30 cost time: 41.16090393066406
Epoch: 30, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 2071818
model size : 9.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1869882
	speed: 0.3065s/iter; left time: 4282.6513s
	iters: 200, epoch: 1 | loss: 0.5159467
	speed: 0.3062s/iter; left time: 4247.4232s
	iters: 300, epoch: 1 | loss: 0.1643603
	speed: 0.3180s/iter; left time: 4379.2411s
	iters: 400, epoch: 1 | loss: 0.0585406
	speed: 0.2849s/iter; left time: 3894.7255s
Epoch: 1 cost time: 143.20609498023987
Epoch: 1, Steps: 469 | Train Loss: 0.607 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (inf --> -0.959690).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0313132
	speed: 0.9589s/iter; left time: 12946.8484s
	iters: 200, epoch: 2 | loss: 0.0169584
	speed: 0.3059s/iter; left time: 4099.5082s
	iters: 300, epoch: 2 | loss: 0.2658743
	speed: 0.3134s/iter; left time: 4168.3685s
	iters: 400, epoch: 2 | loss: 0.0158279
	speed: 0.2848s/iter; left time: 3760.2992s
Epoch: 2 cost time: 139.97693729400635
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.959690 --> -0.970554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0500319
	speed: 0.9341s/iter; left time: 12174.0779s
	iters: 200, epoch: 3 | loss: 0.2590539
	speed: 0.2634s/iter; left time: 3406.7260s
	iters: 300, epoch: 3 | loss: 0.0143667
	speed: 0.2798s/iter; left time: 3591.0722s
	iters: 400, epoch: 3 | loss: 0.0033573
	speed: 0.2348s/iter; left time: 2990.2595s
Epoch: 3 cost time: 121.9902184009552
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.970554 --> -0.972555).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0323327
	speed: 0.8363s/iter; left time: 10507.4279s
	iters: 200, epoch: 4 | loss: 0.0149505
	speed: 0.2456s/iter; left time: 3061.2851s
	iters: 300, epoch: 4 | loss: 0.0041242
	speed: 0.2966s/iter; left time: 3667.5585s
	iters: 400, epoch: 4 | loss: 0.0424186
	speed: 0.2244s/iter; left time: 2752.2115s
Epoch: 4 cost time: 117.98901128768921
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0265882
	speed: 0.7507s/iter; left time: 9080.2203s
	iters: 200, epoch: 5 | loss: 0.0025831
	speed: 0.2385s/iter; left time: 2860.6618s
	iters: 300, epoch: 5 | loss: 0.0388634
	speed: 0.2592s/iter; left time: 3083.7717s
	iters: 400, epoch: 5 | loss: 0.0033554
	speed: 0.2267s/iter; left time: 2674.0065s
Epoch: 5 cost time: 108.3502368927002
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.972555 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0025825
	speed: 0.7623s/iter; left time: 8862.4738s
	iters: 200, epoch: 6 | loss: 0.0115985
	speed: 0.2097s/iter; left time: 2417.5431s
	iters: 300, epoch: 6 | loss: 0.0159485
	speed: 0.2674s/iter; left time: 3055.2751s
	iters: 400, epoch: 6 | loss: 0.0080403
	speed: 0.2246s/iter; left time: 2543.7655s
Epoch: 6 cost time: 109.27557277679443
Epoch: 6, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0010792
	speed: 0.7873s/iter; left time: 8783.7093s
	iters: 200, epoch: 7 | loss: 0.0004707
	speed: 0.2642s/iter; left time: 2921.2504s
	iters: 300, epoch: 7 | loss: 0.0150456
	speed: 0.2432s/iter; left time: 2664.8925s
	iters: 400, epoch: 7 | loss: 0.0106957
	speed: 0.2349s/iter; left time: 2550.1078s
Epoch: 7 cost time: 116.9470751285553
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0004609
	speed: 0.7815s/iter; left time: 8352.3082s
	iters: 200, epoch: 8 | loss: 0.0067667
	speed: 0.2431s/iter; left time: 2573.9402s
	iters: 300, epoch: 8 | loss: 0.1002164
	speed: 0.2414s/iter; left time: 2531.9884s
	iters: 400, epoch: 8 | loss: 0.0008461
	speed: 0.2443s/iter; left time: 2537.4594s
Epoch: 8 cost time: 112.43328428268433
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0030968
	speed: 0.8178s/iter; left time: 8357.3364s
	iters: 200, epoch: 9 | loss: 0.0022263
	speed: 0.2733s/iter; left time: 2765.3297s
	iters: 300, epoch: 9 | loss: 0.1502780
	speed: 0.2860s/iter; left time: 2865.6078s
	iters: 400, epoch: 9 | loss: 0.0008786
	speed: 0.2847s/iter; left time: 2824.1259s
Epoch: 9 cost time: 126.76515460014343
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0038812
	speed: 0.8533s/iter; left time: 8319.3434s
	iters: 200, epoch: 10 | loss: 0.0014104
	speed: 0.2817s/iter; left time: 2718.8054s
	iters: 300, epoch: 10 | loss: 0.0014807
	speed: 0.2848s/iter; left time: 2719.3949s
	iters: 400, epoch: 10 | loss: 0.0024915
	speed: 0.2807s/iter; left time: 2652.2722s
Epoch: 10 cost time: 127.42971229553223
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.979416).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0009213
	speed: 0.8619s/iter; left time: 7999.0094s
	iters: 200, epoch: 11 | loss: 0.0022279
	speed: 0.2771s/iter; left time: 2544.4926s
	iters: 300, epoch: 11 | loss: 0.0034814
	speed: 0.2910s/iter; left time: 2642.9568s
	iters: 400, epoch: 11 | loss: 0.0016405
	speed: 0.2408s/iter; left time: 2162.9969s
Epoch: 11 cost time: 120.43754005432129
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0016642
	speed: 0.7116s/iter; left time: 6270.2633s
	iters: 200, epoch: 12 | loss: 0.0199673
	speed: 0.2257s/iter; left time: 1966.1192s
	iters: 300, epoch: 12 | loss: 0.0008140
	speed: 0.2246s/iter; left time: 1933.8750s
	iters: 400, epoch: 12 | loss: 0.0141980
	speed: 0.2525s/iter; left time: 2149.1871s
Epoch: 12 cost time: 104.25156116485596
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0009474
	speed: 0.7033s/iter; left time: 5867.3432s
	iters: 200, epoch: 13 | loss: 0.0004208
	speed: 0.2152s/iter; left time: 1774.1774s
	iters: 300, epoch: 13 | loss: 0.0022078
	speed: 0.2165s/iter; left time: 1763.0877s
	iters: 400, epoch: 13 | loss: 0.0015136
	speed: 0.2504s/iter; left time: 2014.1902s
Epoch: 13 cost time: 105.17855930328369
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0004271
	speed: 0.7209s/iter; left time: 5676.2656s
	iters: 200, epoch: 14 | loss: 0.0009982
	speed: 0.2050s/iter; left time: 1593.2837s
	iters: 300, epoch: 14 | loss: 0.4983714
	speed: 0.1595s/iter; left time: 1224.3582s
	iters: 400, epoch: 14 | loss: 0.0018046
	speed: 0.2933s/iter; left time: 2221.4075s
Epoch: 14 cost time: 108.31827139854431
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0005149
	speed: 0.8058s/iter; left time: 5967.3001s
	iters: 200, epoch: 15 | loss: 0.0008527
	speed: 0.2418s/iter; left time: 1766.5245s
	iters: 300, epoch: 15 | loss: 0.0015034
	speed: 0.2608s/iter; left time: 1879.1717s
	iters: 400, epoch: 15 | loss: 0.0003566
	speed: 0.2602s/iter; left time: 1848.3926s
Epoch: 15 cost time: 124.81782007217407
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0019949
	speed: 0.9474s/iter; left time: 6571.3381s
	iters: 200, epoch: 16 | loss: 0.0008963
	speed: 0.3099s/iter; left time: 2118.4264s
	iters: 300, epoch: 16 | loss: 0.0008814
	speed: 0.2655s/iter; left time: 1788.7330s
	iters: 400, epoch: 16 | loss: 0.0016907
	speed: 0.3294s/iter; left time: 2186.0136s
Epoch: 16 cost time: 142.52111649513245
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0021255
	speed: 0.9528s/iter; left time: 6161.4966s
	iters: 200, epoch: 17 | loss: 0.0012250
	speed: 0.2792s/iter; left time: 1777.6068s
	iters: 300, epoch: 17 | loss: 0.0063429
	speed: 0.2990s/iter; left time: 1873.5253s
	iters: 400, epoch: 17 | loss: 0.0007120
	speed: 0.3016s/iter; left time: 1860.1970s
Epoch: 17 cost time: 141.36398720741272
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0169819
	speed: 0.9608s/iter; left time: 5762.8236s
	iters: 200, epoch: 18 | loss: 0.0014013
	speed: 0.2885s/iter; left time: 1701.7581s
	iters: 300, epoch: 18 | loss: 0.0006161
	speed: 0.2771s/iter; left time: 1606.4511s
	iters: 400, epoch: 18 | loss: 0.0003627
	speed: 0.3395s/iter; left time: 1934.4079s
Epoch: 18 cost time: 142.06680846214294
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001863
	speed: 0.9331s/iter; left time: 5158.9958s
	iters: 200, epoch: 19 | loss: 0.0003002
	speed: 0.2821s/iter; left time: 1531.3962s
	iters: 300, epoch: 19 | loss: 0.0017167
	speed: 0.3087s/iter; left time: 1645.2356s
	iters: 400, epoch: 19 | loss: 0.0015708
	speed: 0.2956s/iter; left time: 1545.8786s
Epoch: 19 cost time: 140.7810673713684
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0019639
	speed: 0.9374s/iter; left time: 4743.2861s
	iters: 200, epoch: 20 | loss: 0.0039487
	speed: 0.4846s/iter; left time: 2403.6896s
	iters: 300, epoch: 20 | loss: 0.0440394
	speed: 0.5980s/iter; left time: 2906.2062s
	iters: 400, epoch: 20 | loss: 0.0004247
	speed: 0.6171s/iter; left time: 2937.3874s
Epoch: 20 cost time: 239.20659685134888
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0012506
	speed: 1.9754s/iter; left time: 9069.1953s
	iters: 200, epoch: 21 | loss: 0.0032905
	speed: 0.6880s/iter; left time: 3089.9762s
	iters: 300, epoch: 21 | loss: 0.0010210
	speed: 0.6882s/iter; left time: 3021.9840s
	iters: 400, epoch: 21 | loss: 0.0004947
	speed: 0.5269s/iter; left time: 2260.8401s
Epoch: 21 cost time: 296.2761552333832
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0012722
	speed: 1.6549s/iter; left time: 6821.4641s
	iters: 200, epoch: 22 | loss: 0.0031743
	speed: 0.5333s/iter; left time: 2144.8816s
	iters: 300, epoch: 22 | loss: 0.0112442
	speed: 0.5431s/iter; left time: 2130.0005s
	iters: 400, epoch: 22 | loss: 0.0003259
	speed: 0.5423s/iter; left time: 2072.7308s
Epoch: 22 cost time: 244.85147762298584
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0006220
	speed: 1.4869s/iter; left time: 5431.5940s
	iters: 200, epoch: 23 | loss: 0.0010217
	speed: 0.4998s/iter; left time: 1775.8705s
	iters: 300, epoch: 23 | loss: 0.0007525
	speed: 0.4993s/iter; left time: 1723.9808s
	iters: 400, epoch: 23 | loss: 0.0002531
	speed: 0.4513s/iter; left time: 1513.2591s
Epoch: 23 cost time: 226.28341007232666
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0005761
	speed: 1.6034s/iter; left time: 5105.2566s
	iters: 200, epoch: 24 | loss: 0.0003291
	speed: 0.4647s/iter; left time: 1433.1859s
	iters: 300, epoch: 24 | loss: 0.0004178
	speed: 0.5332s/iter; left time: 1590.9671s
	iters: 400, epoch: 24 | loss: 0.0004808
	speed: 0.5250s/iter; left time: 1513.9823s
Epoch: 24 cost time: 243.16524386405945
Epoch: 24, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980559).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0002284
	speed: 1.6082s/iter; left time: 4366.3059s
	iters: 200, epoch: 25 | loss: 0.0001738
	speed: 0.5617s/iter; left time: 1468.8073s
	iters: 300, epoch: 25 | loss: 0.0002712
	speed: 0.5056s/iter; left time: 1271.5702s
	iters: 400, epoch: 25 | loss: 0.0008097
	speed: 0.5461s/iter; left time: 1318.8609s
Epoch: 25 cost time: 241.22051811218262
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0007344
	speed: 1.5466s/iter; left time: 3473.6850s
	iters: 200, epoch: 26 | loss: 0.0008451
	speed: 0.5125s/iter; left time: 1099.7774s
	iters: 300, epoch: 26 | loss: 0.0049360
	speed: 0.5331s/iter; left time: 1090.8177s
	iters: 400, epoch: 26 | loss: 0.0001998
	speed: 0.4445s/iter; left time: 865.0631s
Epoch: 26 cost time: 240.37346649169922
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0008629
	speed: 1.6211s/iter; left time: 2880.7515s
	iters: 200, epoch: 27 | loss: 0.0035879
	speed: 0.5399s/iter; left time: 905.3826s
	iters: 300, epoch: 27 | loss: 0.0005291
	speed: 0.5323s/iter; left time: 839.4469s
	iters: 400, epoch: 27 | loss: 0.0003344
	speed: 0.5555s/iter; left time: 820.4397s
Epoch: 27 cost time: 251.30405616760254
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0001938
	speed: 1.6313s/iter; left time: 2133.7620s
	iters: 200, epoch: 28 | loss: 0.0002624
	speed: 0.4897s/iter; left time: 591.6163s
	iters: 300, epoch: 28 | loss: 0.0003892
	speed: 0.5091s/iter; left time: 564.0740s
	iters: 400, epoch: 28 | loss: 0.1463664
	speed: 0.4831s/iter; left time: 486.9963s
Epoch: 28 cost time: 227.80217838287354
Epoch: 28, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0255953
	speed: 1.5240s/iter; left time: 1278.6368s
	iters: 200, epoch: 29 | loss: 0.0175815
	speed: 0.5489s/iter; left time: 405.6251s
	iters: 300, epoch: 29 | loss: 0.0001774
	speed: 0.5075s/iter; left time: 324.2708s
	iters: 400, epoch: 29 | loss: 0.0001330
	speed: 0.5380s/iter; left time: 289.9663s
Epoch: 29 cost time: 243.9738211631775
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0005886
	speed: 1.5636s/iter; left time: 578.5220s
	iters: 200, epoch: 30 | loss: 0.0003267
	speed: 0.4183s/iter; left time: 112.9463s
	iters: 300, epoch: 30 | loss: 0.0008941
	speed: 0.5267s/iter; left time: 89.5376s
	iters: 400, epoch: 30 | loss: 0.0004534
	speed: 0.4682s/iter; left time: 32.7732s
Epoch: 30 cost time: 226.97202277183533
Epoch: 30, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 7034570
model size : 27.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9597909
	speed: 0.3398s/iter; left time: 4747.8935s
	iters: 200, epoch: 1 | loss: 0.5263240
	speed: 0.3179s/iter; left time: 4408.9797s
	iters: 300, epoch: 1 | loss: 0.2452529
	speed: 0.3020s/iter; left time: 4158.8572s
	iters: 400, epoch: 1 | loss: 0.1400656
	speed: 0.3137s/iter; left time: 4288.5113s
Epoch: 1 cost time: 151.0866458415985
Epoch: 1, Steps: 469 | Train Loss: 0.660 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (inf --> -0.942537).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0202403
	speed: 1.0379s/iter; left time: 14013.6261s
	iters: 200, epoch: 2 | loss: 0.0260457
	speed: 0.3549s/iter; left time: 4756.5895s
	iters: 300, epoch: 2 | loss: 0.0198969
	speed: 0.2565s/iter; left time: 3411.9853s
	iters: 400, epoch: 2 | loss: 0.0074340
	speed: 0.3090s/iter; left time: 4080.0000s
Epoch: 2 cost time: 147.1868975162506
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.942537 --> -0.976557).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0172722
	speed: 1.0306s/iter; left time: 13432.4352s
	iters: 200, epoch: 3 | loss: 0.0337614
	speed: 0.3160s/iter; left time: 4086.9222s
	iters: 300, epoch: 3 | loss: 0.3309047
	speed: 0.3288s/iter; left time: 4219.7809s
	iters: 400, epoch: 3 | loss: 0.4141896
	speed: 0.3483s/iter; left time: 4435.2759s
Epoch: 3 cost time: 152.47288703918457
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0120034
	speed: 1.0936s/iter; left time: 13739.3629s
	iters: 200, epoch: 4 | loss: 0.0014334
	speed: 0.2586s/iter; left time: 3223.7431s
	iters: 300, epoch: 4 | loss: 0.0253432
	speed: 0.3117s/iter; left time: 3853.9775s
	iters: 400, epoch: 4 | loss: 0.0120597
	speed: 0.3356s/iter; left time: 4115.6283s
Epoch: 4 cost time: 148.8091378211975
Epoch: 4, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1283428
	speed: 1.0279s/iter; left time: 12432.2990s
	iters: 200, epoch: 5 | loss: 0.4701096
	speed: 0.3356s/iter; left time: 4025.0092s
	iters: 300, epoch: 5 | loss: 0.0026474
	speed: 0.3352s/iter; left time: 3987.0873s
	iters: 400, epoch: 5 | loss: 0.0642615
	speed: 0.3316s/iter; left time: 3911.1385s
Epoch: 5 cost time: 156.58148622512817
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1093862
	speed: 1.0726s/iter; left time: 12469.7360s
	iters: 200, epoch: 6 | loss: 0.0021947
	speed: 0.2963s/iter; left time: 3415.5401s
	iters: 300, epoch: 6 | loss: 0.0035384
	speed: 0.3338s/iter; left time: 3814.3838s
	iters: 400, epoch: 6 | loss: 0.0023019
	speed: 0.3302s/iter; left time: 3739.4190s
Epoch: 6 cost time: 147.481675863266
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3264494
	speed: 1.0233s/iter; left time: 11417.3567s
	iters: 200, epoch: 7 | loss: 0.0227487
	speed: 0.3194s/iter; left time: 3532.0223s
	iters: 300, epoch: 7 | loss: 0.0006260
	speed: 0.3038s/iter; left time: 3329.2427s
	iters: 400, epoch: 7 | loss: 0.0025351
	speed: 0.3203s/iter; left time: 3477.5099s
Epoch: 7 cost time: 146.6006920337677
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0119810
	speed: 1.0186s/iter; left time: 10887.2870s
	iters: 200, epoch: 8 | loss: 0.0017601
	speed: 0.3168s/iter; left time: 3354.4600s
	iters: 300, epoch: 8 | loss: 0.0114374
	speed: 0.2953s/iter; left time: 3096.9341s
	iters: 400, epoch: 8 | loss: 0.0019334
	speed: 0.3182s/iter; left time: 3305.9017s
Epoch: 8 cost time: 147.79490971565247
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.976557 --> -0.980845).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0009894
	speed: 0.9706s/iter; left time: 9918.9957s
	iters: 200, epoch: 9 | loss: 0.0233267
	speed: 0.2798s/iter; left time: 2830.9526s
	iters: 300, epoch: 9 | loss: 0.0065183
	speed: 0.2879s/iter; left time: 2884.7054s
	iters: 400, epoch: 9 | loss: 0.0219790
	speed: 0.2878s/iter; left time: 2854.9457s
Epoch: 9 cost time: 137.60407948493958
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0295941
	speed: 0.9088s/iter; left time: 8860.8344s
	iters: 200, epoch: 10 | loss: 0.0005000
	speed: 0.2879s/iter; left time: 2778.5813s
	iters: 300, epoch: 10 | loss: 0.0007345
	speed: 0.2833s/iter; left time: 2705.7159s
	iters: 400, epoch: 10 | loss: 0.0032685
	speed: 0.2983s/iter; left time: 2818.7470s
Epoch: 10 cost time: 132.9418647289276
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0084368
	speed: 0.9397s/iter; left time: 8721.3567s
	iters: 200, epoch: 11 | loss: 0.0016563
	speed: 0.2941s/iter; left time: 2699.7865s
	iters: 300, epoch: 11 | loss: 0.0037349
	speed: 0.3243s/iter; left time: 2944.7367s
	iters: 400, epoch: 11 | loss: 0.0003015
	speed: 0.3288s/iter; left time: 2953.2205s
Epoch: 11 cost time: 145.2531657218933
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0014592
	speed: 1.0661s/iter; left time: 9394.3239s
	iters: 200, epoch: 12 | loss: 0.0038612
	speed: 0.3099s/iter; left time: 2699.5824s
	iters: 300, epoch: 12 | loss: 0.0106365
	speed: 0.2618s/iter; left time: 2254.7388s
	iters: 400, epoch: 12 | loss: 0.0012029
	speed: 0.3339s/iter; left time: 2841.9214s
Epoch: 12 cost time: 146.11175727844238
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0009481
	speed: 1.0231s/iter; left time: 8535.9067s
	iters: 200, epoch: 13 | loss: 0.0048283
	speed: 0.2696s/iter; left time: 2222.2633s
	iters: 300, epoch: 13 | loss: 0.1044675
	speed: 0.3062s/iter; left time: 2493.3011s
	iters: 400, epoch: 13 | loss: 0.0001972
	speed: 0.3086s/iter; left time: 2482.2594s
Epoch: 13 cost time: 142.90071821212769
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0027331
	speed: 1.0089s/iter; left time: 7944.1093s
	iters: 200, epoch: 14 | loss: 0.0084023
	speed: 0.3116s/iter; left time: 2422.1789s
	iters: 300, epoch: 14 | loss: 0.0008089
	speed: 0.3248s/iter; left time: 2492.6139s
	iters: 400, epoch: 14 | loss: 0.0775280
	speed: 0.2928s/iter; left time: 2217.7275s
Epoch: 14 cost time: 140.7906150817871
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5492466
	speed: 0.9881s/iter; left time: 7317.1057s
	iters: 200, epoch: 15 | loss: 0.0003707
	speed: 0.3009s/iter; left time: 2197.8580s
	iters: 300, epoch: 15 | loss: 0.0004122
	speed: 0.3378s/iter; left time: 2433.6272s
	iters: 400, epoch: 15 | loss: 0.0003828
	speed: 0.3535s/iter; left time: 2511.3859s
Epoch: 15 cost time: 153.36074113845825
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0038477
	speed: 1.1260s/iter; left time: 7809.6000s
	iters: 200, epoch: 16 | loss: 0.0008363
	speed: 0.3318s/iter; left time: 2268.2019s
	iters: 300, epoch: 16 | loss: 0.1742756
	speed: 0.3235s/iter; left time: 2179.1817s
	iters: 400, epoch: 16 | loss: 0.0012543
	speed: 0.3666s/iter; left time: 2432.9923s
Epoch: 16 cost time: 162.7387466430664
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0016218
	speed: 1.0638s/iter; left time: 6879.5497s
	iters: 200, epoch: 17 | loss: 0.0012885
	speed: 0.3398s/iter; left time: 2163.5567s
	iters: 300, epoch: 17 | loss: 0.0017651
	speed: 0.3252s/iter; left time: 2038.2361s
	iters: 400, epoch: 17 | loss: 0.0022558
	speed: 0.2987s/iter; left time: 1842.2919s
Epoch: 17 cost time: 155.2386965751648
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0003656
	speed: 1.1123s/iter; left time: 6671.6262s
	iters: 200, epoch: 18 | loss: 0.0072073
	speed: 0.3397s/iter; left time: 2003.6359s
	iters: 300, epoch: 18 | loss: 0.0620047
	speed: 0.3586s/iter; left time: 2079.4418s
	iters: 400, epoch: 18 | loss: 0.0002772
	speed: 0.3392s/iter; left time: 1933.0247s
Epoch: 18 cost time: 157.20456051826477
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 2069258
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2107040
	speed: 0.3606s/iter; left time: 5038.3140s
	iters: 200, epoch: 1 | loss: 0.5483311
	speed: 0.4019s/iter; left time: 5574.5730s
	iters: 300, epoch: 1 | loss: 0.1587567
	speed: 0.3752s/iter; left time: 5166.3244s
	iters: 400, epoch: 1 | loss: 0.0532064
	speed: 0.3889s/iter; left time: 5316.3601s
Epoch: 1 cost time: 179.24548935890198
Epoch: 1, Steps: 469 | Train Loss: 0.618 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (inf --> -0.959404).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0345068
	speed: 1.2328s/iter; left time: 16644.9569s
	iters: 200, epoch: 2 | loss: 0.0379920
	speed: 0.3548s/iter; left time: 4754.9901s
	iters: 300, epoch: 2 | loss: 0.1389222
	speed: 0.4070s/iter; left time: 5414.2453s
	iters: 400, epoch: 2 | loss: 0.0173281
	speed: 0.3851s/iter; left time: 5083.6714s
Epoch: 2 cost time: 178.72245860099792
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
Validation loss decreased (-0.959404 --> -0.963121).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1227798
	speed: 1.2953s/iter; left time: 16881.8448s
	iters: 200, epoch: 3 | loss: 0.2337736
	speed: 0.3451s/iter; left time: 4463.3646s
	iters: 300, epoch: 3 | loss: 0.0381472
	speed: 0.3451s/iter; left time: 4428.6949s
	iters: 400, epoch: 3 | loss: 0.0044237
	speed: 0.2884s/iter; left time: 3672.7952s
Epoch: 3 cost time: 157.62368035316467
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.963121 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0078885
	speed: 1.1598s/iter; left time: 14572.0966s
	iters: 200, epoch: 4 | loss: 0.0434932
	speed: 0.3646s/iter; left time: 4544.6291s
	iters: 300, epoch: 4 | loss: 0.0133989
	speed: 0.3281s/iter; left time: 4056.7790s
	iters: 400, epoch: 4 | loss: 0.1265204
	speed: 0.3303s/iter; left time: 4051.0244s
Epoch: 4 cost time: 161.18251085281372
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.966265 --> -0.977701).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0097440
	speed: 1.1155s/iter; left time: 13491.4591s
	iters: 200, epoch: 5 | loss: 0.0021536
	speed: 0.3716s/iter; left time: 4457.0917s
	iters: 300, epoch: 5 | loss: 0.1589281
	speed: 0.3173s/iter; left time: 3774.7894s
	iters: 400, epoch: 5 | loss: 0.0027998
	speed: 0.3037s/iter; left time: 3581.6176s
Epoch: 5 cost time: 153.31404328346252
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2403538
	speed: 1.1608s/iter; left time: 13495.6574s
	iters: 200, epoch: 6 | loss: 0.4403101
	speed: 0.3695s/iter; left time: 4258.6296s
	iters: 300, epoch: 6 | loss: 0.0033478
	speed: 0.3652s/iter; left time: 4173.0326s
	iters: 400, epoch: 6 | loss: 0.0891398
	speed: 0.3667s/iter; left time: 4153.0925s
Epoch: 6 cost time: 170.73762774467468
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0300810
	speed: 1.0738s/iter; left time: 11980.7753s
	iters: 200, epoch: 7 | loss: 0.0042343
	speed: 0.3170s/iter; left time: 3505.0716s
	iters: 300, epoch: 7 | loss: 0.0034559
	speed: 0.3493s/iter; left time: 3827.1099s
	iters: 400, epoch: 7 | loss: 0.0016681
	speed: 0.2589s/iter; left time: 2810.3360s
Epoch: 7 cost time: 147.60820078849792
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005810
	speed: 1.1574s/iter; left time: 12370.7211s
	iters: 200, epoch: 8 | loss: 0.0034161
	speed: 0.3628s/iter; left time: 3840.8513s
	iters: 300, epoch: 8 | loss: 0.0652881
	speed: 0.3101s/iter; left time: 3252.7877s
	iters: 400, epoch: 8 | loss: 0.0023735
	speed: 0.3226s/iter; left time: 3351.3544s
Epoch: 8 cost time: 158.20775055885315
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0060502
	speed: 1.0090s/iter; left time: 10310.6051s
	iters: 200, epoch: 9 | loss: 0.0008967
	speed: 0.3393s/iter; left time: 3433.6895s
	iters: 300, epoch: 9 | loss: 0.0518937
	speed: 0.3558s/iter; left time: 3564.8294s
	iters: 400, epoch: 9 | loss: 0.0007374
	speed: 0.3095s/iter; left time: 3069.7511s
Epoch: 9 cost time: 154.92360758781433
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.977701 --> -0.981703).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0124214
	speed: 1.0395s/iter; left time: 10135.1966s
	iters: 200, epoch: 10 | loss: 0.0033058
	speed: 0.3324s/iter; left time: 3207.7571s
	iters: 300, epoch: 10 | loss: 0.2179067
	speed: 0.3587s/iter; left time: 3425.8107s
	iters: 400, epoch: 10 | loss: 0.0028728
	speed: 0.3464s/iter; left time: 3273.3136s
Epoch: 10 cost time: 158.27091336250305
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0021658
	speed: 1.0709s/iter; left time: 9938.8509s
	iters: 200, epoch: 11 | loss: 0.0011757
	speed: 0.3029s/iter; left time: 2781.1568s
	iters: 300, epoch: 11 | loss: 0.0030512
	speed: 0.3395s/iter; left time: 3083.1844s
	iters: 400, epoch: 11 | loss: 0.0016648
	speed: 0.3445s/iter; left time: 3093.7694s
Epoch: 11 cost time: 156.07340455055237
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0175252
	speed: 1.0612s/iter; left time: 9351.1828s
	iters: 200, epoch: 12 | loss: 0.0378204
	speed: 0.2846s/iter; left time: 2479.6835s
	iters: 300, epoch: 12 | loss: 0.0006296
	speed: 0.3193s/iter; left time: 2750.1469s
	iters: 400, epoch: 12 | loss: 0.0042428
	speed: 0.2874s/iter; left time: 2446.0407s
Epoch: 12 cost time: 140.55842208862305
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0018717
	speed: 0.9915s/iter; left time: 8272.0494s
	iters: 200, epoch: 13 | loss: 0.0018203
	speed: 0.3361s/iter; left time: 2770.0999s
	iters: 300, epoch: 13 | loss: 0.0012102
	speed: 0.3318s/iter; left time: 2702.1178s
	iters: 400, epoch: 13 | loss: 0.0211535
	speed: 0.3029s/iter; left time: 2436.5565s
Epoch: 13 cost time: 149.16738486289978
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0009141
	speed: 1.0012s/iter; left time: 7883.3813s
	iters: 200, epoch: 14 | loss: 0.0005075
	speed: 0.3166s/iter; left time: 2461.1137s
	iters: 300, epoch: 14 | loss: 0.3447802
	speed: 0.3207s/iter; left time: 2460.9592s
	iters: 400, epoch: 14 | loss: 0.0039137
	speed: 0.3369s/iter; left time: 2551.9184s
Epoch: 14 cost time: 150.60624051094055
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0003544
	speed: 0.9852s/iter; left time: 7295.1118s
	iters: 200, epoch: 15 | loss: 0.0008905
	speed: 0.3138s/iter; left time: 2292.1379s
	iters: 300, epoch: 15 | loss: 0.0011584
	speed: 0.3553s/iter; left time: 2560.2176s
	iters: 400, epoch: 15 | loss: 0.0004546
	speed: 0.3829s/iter; left time: 2720.3671s
Epoch: 15 cost time: 153.69423747062683
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0121071
	speed: 1.2047s/iter; left time: 8356.0172s
	iters: 200, epoch: 16 | loss: 0.0005811
	speed: 0.3928s/iter; left time: 2685.3147s
	iters: 300, epoch: 16 | loss: 0.0003776
	speed: 0.3071s/iter; left time: 2068.6855s
	iters: 400, epoch: 16 | loss: 0.0004561
	speed: 0.3555s/iter; left time: 2359.0866s
Epoch: 16 cost time: 169.69644856452942
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0004612
	speed: 1.2358s/iter; left time: 7991.9022s
	iters: 200, epoch: 17 | loss: 0.0003344
	speed: 0.3263s/iter; left time: 2077.7962s
	iters: 300, epoch: 17 | loss: 0.0017871
	speed: 0.3234s/iter; left time: 2026.8690s
	iters: 400, epoch: 17 | loss: 0.0001536
	speed: 0.3851s/iter; left time: 2375.1361s
Epoch: 17 cost time: 165.86739468574524
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0070053
	speed: 1.1456s/iter; left time: 6871.4602s
	iters: 200, epoch: 18 | loss: 0.0095491
	speed: 0.3453s/iter; left time: 2036.8623s
	iters: 300, epoch: 18 | loss: 0.0001420
	speed: 0.3898s/iter; left time: 2260.1583s
	iters: 400, epoch: 18 | loss: 0.0052666
	speed: 0.3375s/iter; left time: 1922.8757s
Epoch: 18 cost time: 164.1629455089569
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0001982
	speed: 1.1962s/iter; left time: 6613.7149s
	iters: 200, epoch: 19 | loss: 0.3478290
	speed: 0.3581s/iter; left time: 1944.2376s
	iters: 300, epoch: 19 | loss: 0.0017450
	speed: 0.3745s/iter; left time: 1995.8767s
	iters: 400, epoch: 19 | loss: 0.0001736
	speed: 0.3396s/iter; left time: 1775.9829s
Epoch: 19 cost time: 172.70036005973816
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 7034570
model size : 27.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9685669
	speed: 0.2604s/iter; left time: 3637.9503s
	iters: 200, epoch: 1 | loss: 0.5880886
	speed: 0.2110s/iter; left time: 2926.3130s
	iters: 300, epoch: 1 | loss: 0.2476901
	speed: 0.2147s/iter; left time: 2957.2991s
	iters: 400, epoch: 1 | loss: 0.1715455
	speed: 0.2183s/iter; left time: 2984.3518s
Epoch: 1 cost time: 106.17809820175171
Epoch: 1, Steps: 469 | Train Loss: 0.675 Vali Loss: 0.185 Vali Acc: 0.939 Test Loss: 0.185 Test Acc: 0.939
Validation loss decreased (inf --> -0.939392).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0206220
	speed: 0.8992s/iter; left time: 12141.2277s
	iters: 200, epoch: 2 | loss: 0.0859435
	speed: 0.2024s/iter; left time: 2712.2208s
	iters: 300, epoch: 2 | loss: 0.0199260
	speed: 0.2257s/iter; left time: 3002.3309s
	iters: 400, epoch: 2 | loss: 0.0210920
	speed: 0.2020s/iter; left time: 2666.5902s
Epoch: 2 cost time: 102.33553910255432
Epoch: 2, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
Validation loss decreased (-0.939392 --> -0.958832).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0216423
	speed: 0.8615s/iter; left time: 11228.4142s
	iters: 200, epoch: 3 | loss: 0.0159762
	speed: 0.2100s/iter; left time: 2716.3683s
	iters: 300, epoch: 3 | loss: 0.3457085
	speed: 0.2076s/iter; left time: 2664.1037s
	iters: 400, epoch: 3 | loss: 0.4621383
	speed: 0.2356s/iter; left time: 2999.3052s
Epoch: 3 cost time: 103.49545764923096
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.958832 --> -0.975414).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0188817
	speed: 0.9556s/iter; left time: 12005.5822s
	iters: 200, epoch: 4 | loss: 0.0328368
	speed: 0.2468s/iter; left time: 3076.0932s
	iters: 300, epoch: 4 | loss: 0.0266022
	speed: 0.1984s/iter; left time: 2453.4739s
	iters: 400, epoch: 4 | loss: 0.0139422
	speed: 0.2265s/iter; left time: 2777.8955s
Epoch: 4 cost time: 111.45653247833252
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.975414 --> -0.979416).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2175196
	speed: 0.8649s/iter; left time: 10460.6478s
	iters: 200, epoch: 5 | loss: 0.0056247
	speed: 0.2398s/iter; left time: 2876.1926s
	iters: 300, epoch: 5 | loss: 0.0045580
	speed: 0.2405s/iter; left time: 2860.7466s
	iters: 400, epoch: 5 | loss: 0.1204820
	speed: 0.2228s/iter; left time: 2627.8165s
Epoch: 5 cost time: 107.53642582893372
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0299060
	speed: 0.7175s/iter; left time: 8341.8574s
	iters: 200, epoch: 6 | loss: 0.0044765
	speed: 0.2406s/iter; left time: 2773.3763s
	iters: 300, epoch: 6 | loss: 0.0017208
	speed: 0.2334s/iter; left time: 2666.4328s
	iters: 400, epoch: 6 | loss: 0.0018178
	speed: 0.1857s/iter; left time: 2103.7824s
Epoch: 6 cost time: 101.72223329544067
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0405604
	speed: 0.7984s/iter; left time: 8907.2972s
	iters: 200, epoch: 7 | loss: 0.0023025
	speed: 0.2202s/iter; left time: 2434.9983s
	iters: 300, epoch: 7 | loss: 0.0008336
	speed: 0.2258s/iter; left time: 2474.1726s
	iters: 400, epoch: 7 | loss: 0.0031483
	speed: 0.2143s/iter; left time: 2326.9880s
Epoch: 7 cost time: 105.36202931404114
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0050078
	speed: 0.7257s/iter; left time: 7756.7527s
	iters: 200, epoch: 8 | loss: 0.0031841
	speed: 0.2050s/iter; left time: 2170.2533s
	iters: 300, epoch: 8 | loss: 0.0053570
	speed: 0.2068s/iter; left time: 2168.9481s
	iters: 400, epoch: 8 | loss: 0.0004421
	speed: 0.2101s/iter; left time: 2182.2548s
Epoch: 8 cost time: 95.35095810890198
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0017245
	speed: 0.6782s/iter; left time: 6930.0257s
	iters: 200, epoch: 9 | loss: 0.0167065
	speed: 0.2301s/iter; left time: 2328.2970s
	iters: 300, epoch: 9 | loss: 0.0062134
	speed: 0.2314s/iter; left time: 2318.8079s
	iters: 400, epoch: 9 | loss: 0.0012993
	speed: 0.2215s/iter; left time: 2197.0673s
Epoch: 9 cost time: 100.90926146507263
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0196605
	speed: 0.6944s/iter; left time: 6770.5445s
	iters: 200, epoch: 10 | loss: 0.0104396
	speed: 0.2271s/iter; left time: 2191.2477s
	iters: 300, epoch: 10 | loss: 0.0005590
	speed: 0.2134s/iter; left time: 2038.0062s
	iters: 400, epoch: 10 | loss: 0.0013366
	speed: 0.2024s/iter; left time: 1912.2216s
Epoch: 10 cost time: 98.39519095420837
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0104216
	speed: 0.6463s/iter; left time: 5998.7430s
	iters: 200, epoch: 11 | loss: 0.0026532
	speed: 0.1574s/iter; left time: 1444.7102s
	iters: 300, epoch: 11 | loss: 0.0003495
	speed: 0.1845s/iter; left time: 1675.8796s
	iters: 400, epoch: 11 | loss: 0.0007450
	speed: 0.1938s/iter; left time: 1740.3162s
Epoch: 11 cost time: 80.1013548374176
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0012820
	speed: 0.7988s/iter; left time: 7039.4146s
	iters: 200, epoch: 12 | loss: 0.0079633
	speed: 0.2244s/iter; left time: 1954.5507s
	iters: 300, epoch: 12 | loss: 0.0292389
	speed: 0.2519s/iter; left time: 2169.6281s
	iters: 400, epoch: 12 | loss: 0.0002343
	speed: 0.2481s/iter; left time: 2111.9041s
Epoch: 12 cost time: 112.21505284309387
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0001924
	speed: 0.8817s/iter; left time: 7355.7428s
	iters: 200, epoch: 13 | loss: 0.0794973
	speed: 0.2425s/iter; left time: 1998.7544s
	iters: 300, epoch: 13 | loss: 0.0003613
	speed: 0.2325s/iter; left time: 1893.1216s
	iters: 400, epoch: 13 | loss: 0.0003036
	speed: 0.2498s/iter; left time: 2008.9950s
Epoch: 13 cost time: 113.37322640419006
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980845).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0012494
	speed: 0.8852s/iter; left time: 6970.2349s
	iters: 200, epoch: 14 | loss: 0.0008933
	speed: 0.2345s/iter; left time: 1823.2881s
	iters: 300, epoch: 14 | loss: 0.0006128
	speed: 0.2390s/iter; left time: 1833.8764s
	iters: 400, epoch: 14 | loss: 0.0029671
	speed: 0.2555s/iter; left time: 1934.8062s
Epoch: 14 cost time: 114.42336320877075
Epoch: 14, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.981703).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1818059
	speed: 0.9771s/iter; left time: 7235.5874s
	iters: 200, epoch: 15 | loss: 0.0001837
	speed: 0.2530s/iter; left time: 1847.9093s
	iters: 300, epoch: 15 | loss: 0.0005089
	speed: 0.2466s/iter; left time: 1776.5868s
	iters: 400, epoch: 15 | loss: 0.0002429
	speed: 0.2487s/iter; left time: 1767.2425s
Epoch: 15 cost time: 118.86242747306824
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.986 Test Loss: 0.068 Test Acc: 0.986
Validation loss decreased (-0.981703 --> -0.986277).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0074920
	speed: 0.8829s/iter; left time: 6123.5062s
	iters: 200, epoch: 16 | loss: 0.0435898
	speed: 0.2506s/iter; left time: 1713.3799s
	iters: 300, epoch: 16 | loss: 0.0082708
	speed: 0.2317s/iter; left time: 1560.6207s
	iters: 400, epoch: 16 | loss: 0.0010286
	speed: 0.2507s/iter; left time: 1663.3683s
Epoch: 16 cost time: 116.04129242897034
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0021054
	speed: 0.8762s/iter; left time: 5666.3378s
	iters: 200, epoch: 17 | loss: 0.0006412
	speed: 0.2331s/iter; left time: 1484.4082s
	iters: 300, epoch: 17 | loss: 0.0072979
	speed: 0.2432s/iter; left time: 1523.9122s
	iters: 400, epoch: 17 | loss: 0.0041874
	speed: 0.2405s/iter; left time: 1483.4403s
Epoch: 17 cost time: 111.31906366348267
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0009751
	speed: 0.8895s/iter; left time: 5335.3226s
	iters: 200, epoch: 18 | loss: 0.0036260
	speed: 0.2467s/iter; left time: 1455.0184s
	iters: 300, epoch: 18 | loss: 0.0040790
	speed: 0.2517s/iter; left time: 1459.1043s
	iters: 400, epoch: 18 | loss: 0.0011090
	speed: 0.2034s/iter; left time: 1158.9287s
Epoch: 18 cost time: 111.04708480834961
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0002293
	speed: 0.8999s/iter; left time: 4975.6988s
	iters: 200, epoch: 19 | loss: 0.0005541
	speed: 0.2279s/iter; left time: 1237.3810s
	iters: 300, epoch: 19 | loss: 0.0341508
	speed: 0.2343s/iter; left time: 1248.5516s
	iters: 400, epoch: 19 | loss: 0.0019961
	speed: 0.2363s/iter; left time: 1235.4505s
Epoch: 19 cost time: 110.99374103546143
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0004360
	speed: 0.8742s/iter; left time: 4423.3068s
	iters: 200, epoch: 20 | loss: 0.0001373
	speed: 0.2315s/iter; left time: 1148.2759s
	iters: 300, epoch: 20 | loss: 0.0003492
	speed: 0.2316s/iter; left time: 1125.3574s
	iters: 400, epoch: 20 | loss: 0.0003047
	speed: 0.1755s/iter; left time: 835.5904s
Epoch: 20 cost time: 104.07978320121765
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0003244
	speed: 0.8473s/iter; left time: 3889.8839s
	iters: 200, epoch: 21 | loss: 0.0005334
	speed: 0.2186s/iter; left time: 981.6198s
	iters: 300, epoch: 21 | loss: 0.0005919
	speed: 0.1916s/iter; left time: 841.1094s
	iters: 400, epoch: 21 | loss: 0.0009275
	speed: 0.2588s/iter; left time: 1110.5770s
Epoch: 21 cost time: 104.2191572189331
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0064022
	speed: 0.8250s/iter; left time: 3400.6411s
	iters: 200, epoch: 22 | loss: 0.0021942
	speed: 0.2400s/iter; left time: 965.2281s
	iters: 300, epoch: 22 | loss: 0.0003244
	speed: 0.2615s/iter; left time: 1025.5193s
	iters: 400, epoch: 22 | loss: 0.0002530
	speed: 0.2433s/iter; left time: 929.9278s
Epoch: 22 cost time: 112.62600231170654
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0002233
	speed: 0.8310s/iter; left time: 3035.5503s
	iters: 200, epoch: 23 | loss: 0.0031942
	speed: 0.2531s/iter; left time: 899.2867s
	iters: 300, epoch: 23 | loss: 0.0016465
	speed: 0.2315s/iter; left time: 799.2486s
	iters: 400, epoch: 23 | loss: 0.0002122
	speed: 0.2088s/iter; left time: 700.1658s
Epoch: 23 cost time: 108.17672061920166
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0005966
	speed: 0.8639s/iter; left time: 2750.5527s
	iters: 200, epoch: 24 | loss: 0.0002600
	speed: 0.2172s/iter; left time: 669.9322s
	iters: 300, epoch: 24 | loss: 0.0002636
	speed: 0.1710s/iter; left time: 510.1253s
	iters: 400, epoch: 24 | loss: 0.0002422
	speed: 0.2129s/iter; left time: 614.0326s
Epoch: 24 cost time: 100.90953397750854
Epoch: 24, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0001827
	speed: 0.8244s/iter; left time: 2238.1338s
	iters: 200, epoch: 25 | loss: 0.0001438
	speed: 0.2164s/iter; left time: 565.9505s
	iters: 300, epoch: 25 | loss: 0.0004894
	speed: 0.1745s/iter; left time: 438.8785s
	iters: 400, epoch: 25 | loss: 0.0006527
	speed: 0.2335s/iter; left time: 563.9466s
Epoch: 25 cost time: 100.06475234031677
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 2069258
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3897725
	speed: 0.2434s/iter; left time: 3401.2106s
	iters: 200, epoch: 1 | loss: 0.7732998
	speed: 0.2162s/iter; left time: 2998.6623s
	iters: 300, epoch: 1 | loss: 0.2063396
	speed: 0.2217s/iter; left time: 3053.5118s
	iters: 400, epoch: 1 | loss: 0.0890174
	speed: 0.1989s/iter; left time: 2718.8455s
Epoch: 1 cost time: 102.33568620681763
Epoch: 1, Steps: 469 | Train Loss: 0.725 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
Validation loss decreased (inf --> -0.924526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0627808
	speed: 0.8328s/iter; left time: 11244.1814s
	iters: 200, epoch: 2 | loss: 0.0225466
	speed: 0.2229s/iter; left time: 2986.9196s
	iters: 300, epoch: 2 | loss: 0.1331282
	speed: 0.2060s/iter; left time: 2740.8476s
	iters: 400, epoch: 2 | loss: 0.0363868
	speed: 0.1989s/iter; left time: 2625.7704s
Epoch: 2 cost time: 99.73277616500854
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.924526 --> -0.968553).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0067270
	speed: 0.7871s/iter; left time: 10258.0373s
	iters: 200, epoch: 3 | loss: 0.1510013
	speed: 0.1987s/iter; left time: 2569.7896s
	iters: 300, epoch: 3 | loss: 0.0381784
	speed: 0.1943s/iter; left time: 2493.6261s
	iters: 400, epoch: 3 | loss: 0.0235875
	speed: 0.2055s/iter; left time: 2617.2028s
Epoch: 3 cost time: 94.82978439331055
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.125 Vali Acc: 0.958 Test Loss: 0.125 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1364714
	speed: 0.7487s/iter; left time: 9406.8344s
	iters: 200, epoch: 4 | loss: 0.3680583
	speed: 0.2002s/iter; left time: 2494.9208s
	iters: 300, epoch: 4 | loss: 0.0168008
	speed: 0.2278s/iter; left time: 2816.4216s
	iters: 400, epoch: 4 | loss: 0.0645891
	speed: 0.2352s/iter; left time: 2884.7719s
Epoch: 4 cost time: 99.56196880340576
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0129601
	speed: 0.8233s/iter; left time: 9957.4852s
	iters: 200, epoch: 5 | loss: 0.0048125
	speed: 0.2208s/iter; left time: 2648.1967s
	iters: 300, epoch: 5 | loss: 0.3239447
	speed: 0.2291s/iter; left time: 2724.6207s
	iters: 400, epoch: 5 | loss: 0.0011302
	speed: 0.2260s/iter; left time: 2665.1372s
Epoch: 5 cost time: 105.52828526496887
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3751720
	speed: 0.7666s/iter; left time: 8912.0328s
	iters: 200, epoch: 6 | loss: 0.1625247
	speed: 0.2293s/iter; left time: 2643.3422s
	iters: 300, epoch: 6 | loss: 0.0809222
	speed: 0.2305s/iter; left time: 2633.3727s
	iters: 400, epoch: 6 | loss: 0.0055140
	speed: 0.1862s/iter; left time: 2108.7097s
Epoch: 6 cost time: 95.90159869194031
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (-0.968553 --> -0.971411).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0052423
	speed: 0.7584s/iter; left time: 8461.5622s
	iters: 200, epoch: 7 | loss: 0.0002797
	speed: 0.2104s/iter; left time: 2326.1677s
	iters: 300, epoch: 7 | loss: 0.0005493
	speed: 0.2381s/iter; left time: 2608.9678s
	iters: 400, epoch: 7 | loss: 0.0025467
	speed: 0.2368s/iter; left time: 2570.5459s
Epoch: 7 cost time: 104.66906976699829
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.971411 --> -0.979416).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0009092
	speed: 0.8597s/iter; left time: 9188.7479s
	iters: 200, epoch: 8 | loss: 0.0018654
	speed: 0.1791s/iter; left time: 1896.3124s
	iters: 300, epoch: 8 | loss: 0.0220810
	speed: 0.1687s/iter; left time: 1769.0403s
	iters: 400, epoch: 8 | loss: 0.0067275
	speed: 0.2191s/iter; left time: 2275.6560s
Epoch: 8 cost time: 94.3179407119751
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0014123
	speed: 0.7852s/iter; left time: 8023.7948s
	iters: 200, epoch: 9 | loss: 0.0080927
	speed: 0.2437s/iter; left time: 2465.5493s
	iters: 300, epoch: 9 | loss: 0.0147964
	speed: 0.2469s/iter; left time: 2473.3158s
	iters: 400, epoch: 9 | loss: 0.0045754
	speed: 0.2319s/iter; left time: 2299.9809s
Epoch: 9 cost time: 109.12184453010559
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0064989
	speed: 0.8331s/iter; left time: 8122.2750s
	iters: 200, epoch: 10 | loss: 0.0019441
	speed: 0.2363s/iter; left time: 2280.5295s
	iters: 300, epoch: 10 | loss: 0.0068025
	speed: 0.2417s/iter; left time: 2308.0231s
	iters: 400, epoch: 10 | loss: 0.0008214
	speed: 0.2374s/iter; left time: 2243.2178s
Epoch: 10 cost time: 112.66866755485535
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0002778
	speed: 0.8908s/iter; left time: 8267.7110s
	iters: 200, epoch: 11 | loss: 0.0021724
	speed: 0.2468s/iter; left time: 2265.8523s
	iters: 300, epoch: 11 | loss: 0.0023962
	speed: 0.2373s/iter; left time: 2154.6810s
	iters: 400, epoch: 11 | loss: 0.0031958
	speed: 0.2206s/iter; left time: 1981.3090s
Epoch: 11 cost time: 111.19564962387085
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0658090
	speed: 0.8239s/iter; left time: 7259.8153s
	iters: 200, epoch: 12 | loss: 0.0034172
	speed: 0.2175s/iter; left time: 1895.0836s
	iters: 300, epoch: 12 | loss: 0.0010570
	speed: 0.2134s/iter; left time: 1837.3799s
	iters: 400, epoch: 12 | loss: 0.0004099
	speed: 0.2006s/iter; left time: 1707.8714s
Epoch: 12 cost time: 98.00419497489929
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.979416 --> -0.984276).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0071061
	speed: 0.7885s/iter; left time: 6578.5494s
	iters: 200, epoch: 13 | loss: 0.0002539
	speed: 0.2156s/iter; left time: 1776.8036s
	iters: 300, epoch: 13 | loss: 0.0028739
	speed: 0.1893s/iter; left time: 1541.5977s
	iters: 400, epoch: 13 | loss: 0.0005819
	speed: 0.1954s/iter; left time: 1571.9278s
Epoch: 13 cost time: 93.8916437625885
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0061507
	speed: 0.8017s/iter; left time: 6312.6777s
	iters: 200, epoch: 14 | loss: 0.0011674
	speed: 0.2061s/iter; left time: 1602.4168s
	iters: 300, epoch: 14 | loss: 0.4993576
	speed: 0.2005s/iter; left time: 1538.2812s
	iters: 400, epoch: 14 | loss: 0.0175115
	speed: 0.1944s/iter; left time: 1472.4107s
Epoch: 14 cost time: 95.49543285369873
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0005338
	speed: 0.7678s/iter; left time: 5685.3969s
	iters: 200, epoch: 15 | loss: 0.0176774
	speed: 0.1950s/iter; left time: 1424.7424s
	iters: 300, epoch: 15 | loss: 0.0009037
	speed: 0.1854s/iter; left time: 1335.9200s
	iters: 400, epoch: 15 | loss: 0.0002734
	speed: 0.1859s/iter; left time: 1320.9000s
Epoch: 15 cost time: 87.77167654037476
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002982
	speed: 0.8110s/iter; left time: 5625.3381s
	iters: 200, epoch: 16 | loss: 0.0002692
	speed: 0.2150s/iter; left time: 1469.4686s
	iters: 300, epoch: 16 | loss: 0.0003593
	speed: 0.2011s/iter; left time: 1354.5330s
	iters: 400, epoch: 16 | loss: 0.0001059
	speed: 0.1710s/iter; left time: 1134.9317s
Epoch: 16 cost time: 96.75713896751404
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0010249
	speed: 0.8326s/iter; left time: 5384.1988s
	iters: 200, epoch: 17 | loss: 0.0002089
	speed: 0.2024s/iter; left time: 1288.4308s
	iters: 300, epoch: 17 | loss: 0.0019019
	speed: 0.1754s/iter; left time: 1099.1118s
	iters: 400, epoch: 17 | loss: 0.0005345
	speed: 0.1773s/iter; left time: 1093.2003s
Epoch: 17 cost time: 90.42350721359253
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0076444
	speed: 0.7187s/iter; left time: 4310.7727s
	iters: 200, epoch: 18 | loss: 0.0006910
	speed: 0.1949s/iter; left time: 1149.2679s
	iters: 300, epoch: 18 | loss: 0.0010233
	speed: 0.2067s/iter; left time: 1198.7077s
	iters: 400, epoch: 18 | loss: 0.0008922
	speed: 0.2254s/iter; left time: 1284.2556s
Epoch: 18 cost time: 94.75043940544128
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001347
	speed: 0.8189s/iter; left time: 4527.4694s
	iters: 200, epoch: 19 | loss: 0.0005130
	speed: 0.1942s/iter; left time: 1054.2619s
	iters: 300, epoch: 19 | loss: 0.0003611
	speed: 0.2004s/iter; left time: 1068.1939s
	iters: 400, epoch: 19 | loss: 0.0000440
	speed: 0.1934s/iter; left time: 1011.2344s
Epoch: 19 cost time: 91.05022072792053
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0011746
	speed: 0.6420s/iter; left time: 3248.6532s
	iters: 200, epoch: 20 | loss: 0.0076382
	speed: 0.1773s/iter; left time: 879.5107s
	iters: 300, epoch: 20 | loss: 0.0002451
	speed: 0.1918s/iter; left time: 932.0736s
	iters: 400, epoch: 20 | loss: 0.0003534
	speed: 0.2001s/iter; left time: 952.4814s
Epoch: 20 cost time: 87.62754893302917
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0748710
	speed: 0.6519s/iter; left time: 2992.7145s
	iters: 200, epoch: 21 | loss: 0.0040454
	speed: 0.1983s/iter; left time: 890.4981s
	iters: 300, epoch: 21 | loss: 0.0003049
	speed: 0.2095s/iter; left time: 920.0557s
	iters: 400, epoch: 21 | loss: 0.0164680
	speed: 0.2093s/iter; left time: 897.9221s
Epoch: 21 cost time: 94.44306135177612
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0003433
	speed: 0.6619s/iter; left time: 2728.5280s
	iters: 200, epoch: 22 | loss: 0.0016543
	speed: 0.2077s/iter; left time: 835.4942s
	iters: 300, epoch: 22 | loss: 0.4751939
	speed: 0.1930s/iter; left time: 756.8243s
	iters: 400, epoch: 22 | loss: 0.0006093
	speed: 0.1848s/iter; left time: 706.3855s
Epoch: 22 cost time: 87.22775959968567
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.243 Vali Acc: 0.957 Test Loss: 0.243 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 7034570
model size : 27.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0679332
	speed: 0.1978s/iter; left time: 2763.1911s
	iters: 200, epoch: 1 | loss: 0.7584115
	speed: 0.1727s/iter; left time: 2395.0412s
	iters: 300, epoch: 1 | loss: 0.3914790
	speed: 0.1365s/iter; left time: 1880.0711s
	iters: 400, epoch: 1 | loss: 0.1765529
	speed: 0.0819s/iter; left time: 1119.2131s
Epoch: 1 cost time: 65.31079030036926
Epoch: 1, Steps: 469 | Train Loss: 0.785 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (inf --> -0.933388).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0329272
	speed: 0.5446s/iter; left time: 7353.3719s
	iters: 200, epoch: 2 | loss: 0.1043146
	speed: 0.1450s/iter; left time: 1943.1880s
	iters: 300, epoch: 2 | loss: 0.0493238
	speed: 0.1515s/iter; left time: 2015.9100s
	iters: 400, epoch: 2 | loss: 0.0225398
	speed: 0.1627s/iter; left time: 2147.7139s
Epoch: 2 cost time: 68.72114109992981
Epoch: 2, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
Validation loss decreased (-0.933388 --> -0.956545).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0345018
	speed: 0.6379s/iter; left time: 8313.8826s
	iters: 200, epoch: 3 | loss: 0.0269869
	speed: 0.1658s/iter; left time: 2143.9458s
	iters: 300, epoch: 3 | loss: 0.2499385
	speed: 0.1580s/iter; left time: 2028.1137s
	iters: 400, epoch: 3 | loss: 0.2026264
	speed: 0.1044s/iter; left time: 1329.8070s
Epoch: 3 cost time: 66.31157875061035
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.956545 --> -0.958832).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0829346
	speed: 0.6120s/iter; left time: 7688.5803s
	iters: 200, epoch: 4 | loss: 0.0038569
	speed: 0.1080s/iter; left time: 1346.1986s
	iters: 300, epoch: 4 | loss: 0.0312366
	speed: 0.1177s/iter; left time: 1455.3646s
	iters: 400, epoch: 4 | loss: 0.0197399
	speed: 0.1413s/iter; left time: 1732.2950s
Epoch: 4 cost time: 60.2126567363739
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.958832 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4187926
	speed: 0.5973s/iter; left time: 7224.8701s
	iters: 200, epoch: 5 | loss: 0.0073012
	speed: 0.1440s/iter; left time: 1727.5520s
	iters: 300, epoch: 5 | loss: 0.0046324
	speed: 0.1295s/iter; left time: 1540.7560s
	iters: 400, epoch: 5 | loss: 0.0171755
	speed: 0.0932s/iter; left time: 1098.9489s
Epoch: 5 cost time: 59.24058389663696
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
Validation loss decreased (-0.971983 --> -0.979416).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0063313
	speed: 0.5555s/iter; left time: 6458.4662s
	iters: 200, epoch: 6 | loss: 0.0064006
	speed: 0.1011s/iter; left time: 1165.5568s
	iters: 300, epoch: 6 | loss: 0.0019637
	speed: 0.1107s/iter; left time: 1264.7705s
	iters: 400, epoch: 6 | loss: 0.0049224
	speed: 0.1470s/iter; left time: 1664.6336s
Epoch: 6 cost time: 56.310256481170654
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3545986
	speed: 0.5091s/iter; left time: 5679.9844s
	iters: 200, epoch: 7 | loss: 0.0024548
	speed: 0.1400s/iter; left time: 1548.2502s
	iters: 300, epoch: 7 | loss: 0.0007348
	speed: 0.1288s/iter; left time: 1411.2929s
	iters: 400, epoch: 7 | loss: 0.0108167
	speed: 0.1173s/iter; left time: 1273.3806s
Epoch: 7 cost time: 59.192058086395264
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980845).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1196531
	speed: 0.6364s/iter; left time: 6801.7216s
	iters: 200, epoch: 8 | loss: 0.0009999
	speed: 0.1461s/iter; left time: 1546.6949s
	iters: 300, epoch: 8 | loss: 0.1461556
	speed: 0.1384s/iter; left time: 1451.9535s
	iters: 400, epoch: 8 | loss: 0.0005245
	speed: 0.1453s/iter; left time: 1509.2500s
Epoch: 8 cost time: 69.11365580558777
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1090217
	speed: 0.6490s/iter; left time: 6631.8817s
	iters: 200, epoch: 9 | loss: 0.0048452
	speed: 0.1403s/iter; left time: 1419.6410s
	iters: 300, epoch: 9 | loss: 0.0185223
	speed: 0.1363s/iter; left time: 1365.4282s
	iters: 400, epoch: 9 | loss: 0.0009926
	speed: 0.1546s/iter; left time: 1533.9063s
Epoch: 9 cost time: 69.29874873161316
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0710102
	speed: 0.6834s/iter; left time: 6663.1446s
	iters: 200, epoch: 10 | loss: 0.2377282
	speed: 0.1162s/iter; left time: 1120.8873s
	iters: 300, epoch: 10 | loss: 0.0006901
	speed: 0.1369s/iter; left time: 1307.4821s
	iters: 400, epoch: 10 | loss: 0.0019445
	speed: 0.1615s/iter; left time: 1526.6067s
Epoch: 10 cost time: 66.4327039718628
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0053547
	speed: 0.6204s/iter; left time: 5758.1804s
	iters: 200, epoch: 11 | loss: 0.0031757
	speed: 0.1588s/iter; left time: 1457.6157s
	iters: 300, epoch: 11 | loss: 0.0040614
	speed: 0.1595s/iter; left time: 1448.1211s
	iters: 400, epoch: 11 | loss: 0.0016612
	speed: 0.1549s/iter; left time: 1391.5729s
Epoch: 11 cost time: 72.78395795822144
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0006219
	speed: 0.5886s/iter; left time: 5187.1378s
	iters: 200, epoch: 12 | loss: 0.0210817
	speed: 0.1548s/iter; left time: 1348.6043s
	iters: 300, epoch: 12 | loss: 0.0027549
	speed: 0.1334s/iter; left time: 1148.9132s
	iters: 400, epoch: 12 | loss: 0.0006717
	speed: 0.0935s/iter; left time: 796.1033s
Epoch: 12 cost time: 62.14144420623779
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0007354
	speed: 0.5702s/iter; left time: 4757.3194s
	iters: 200, epoch: 13 | loss: 0.0016104
	speed: 0.1325s/iter; left time: 1092.1463s
	iters: 300, epoch: 13 | loss: 0.0003629
	speed: 0.1285s/iter; left time: 1046.7141s
	iters: 400, epoch: 13 | loss: 0.0006221
	speed: 0.0999s/iter; left time: 803.5084s
Epoch: 13 cost time: 56.44391870498657
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0328549
	speed: 0.4702s/iter; left time: 3702.3117s
	iters: 200, epoch: 14 | loss: 0.0010361
	speed: 0.0748s/iter; left time: 581.6016s
	iters: 300, epoch: 14 | loss: 0.0007001
	speed: 0.0961s/iter; left time: 737.7996s
	iters: 400, epoch: 14 | loss: 0.0036718
	speed: 0.1301s/iter; left time: 985.0256s
Epoch: 14 cost time: 49.010090351104736
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.980845 --> -0.983704).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0159706
	speed: 0.5668s/iter; left time: 4196.8417s
	iters: 200, epoch: 15 | loss: 0.0021498
	speed: 0.1156s/iter; left time: 844.3047s
	iters: 300, epoch: 15 | loss: 0.0030867
	speed: 0.1271s/iter; left time: 916.1104s
	iters: 400, epoch: 15 | loss: 0.0000877
	speed: 0.0988s/iter; left time: 701.8430s
Epoch: 15 cost time: 54.812551736831665
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0739858
	speed: 0.4953s/iter; left time: 3435.0596s
	iters: 200, epoch: 16 | loss: 0.0012155
	speed: 0.0969s/iter; left time: 662.1878s
	iters: 300, epoch: 16 | loss: 0.0047008
	speed: 0.1164s/iter; left time: 784.0316s
	iters: 400, epoch: 16 | loss: 0.0009536
	speed: 0.1214s/iter; left time: 805.7252s
Epoch: 16 cost time: 53.90793466567993
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0051885
	speed: 0.5245s/iter; left time: 3392.0422s
	iters: 200, epoch: 17 | loss: 0.0014598
	speed: 0.1043s/iter; left time: 664.3789s
	iters: 300, epoch: 17 | loss: 0.0004331
	speed: 0.1026s/iter; left time: 642.8450s
	iters: 400, epoch: 17 | loss: 0.0372377
	speed: 0.0990s/iter; left time: 610.4225s
Epoch: 17 cost time: 50.081913471221924
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0001732
	speed: 0.4631s/iter; left time: 2777.5365s
	iters: 200, epoch: 18 | loss: 0.0025228
	speed: 0.0991s/iter; left time: 584.3864s
	iters: 300, epoch: 18 | loss: 0.0083595
	speed: 0.1344s/iter; left time: 779.5219s
	iters: 400, epoch: 18 | loss: 0.0002017
	speed: 0.1316s/iter; left time: 749.6354s
Epoch: 18 cost time: 59.09231209754944
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0002340
	speed: 0.5736s/iter; left time: 3171.1652s
	iters: 200, epoch: 19 | loss: 0.0004231
	speed: 0.1164s/iter; left time: 631.8653s
	iters: 300, epoch: 19 | loss: 0.1421663
	speed: 0.1440s/iter; left time: 767.1770s
	iters: 400, epoch: 19 | loss: 0.0006529
	speed: 0.1494s/iter; left time: 781.0022s
Epoch: 19 cost time: 64.01357197761536
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0009340
	speed: 0.6099s/iter; left time: 3085.8996s
	iters: 200, epoch: 20 | loss: 0.0004440
	speed: 0.1347s/iter; left time: 667.9264s
	iters: 300, epoch: 20 | loss: 0.0013448
	speed: 0.1499s/iter; left time: 728.4128s
	iters: 400, epoch: 20 | loss: 0.0035011
	speed: 0.1422s/iter; left time: 677.1079s
Epoch: 20 cost time: 62.760300159454346
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0001661
	speed: 0.5766s/iter; left time: 2647.0057s
	iters: 200, epoch: 21 | loss: 0.0001563
	speed: 0.1508s/iter; left time: 677.3118s
	iters: 300, epoch: 21 | loss: 0.0029095
	speed: 0.1539s/iter; left time: 675.9167s
	iters: 400, epoch: 21 | loss: 0.0350816
	speed: 0.1175s/iter; left time: 504.3241s
Epoch: 21 cost time: 64.31743121147156
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0008247
	speed: 0.5475s/iter; left time: 2256.7067s
	iters: 200, epoch: 22 | loss: 0.0006252
	speed: 0.1065s/iter; left time: 428.4911s
	iters: 300, epoch: 22 | loss: 0.0003304
	speed: 0.1170s/iter; left time: 458.7250s
	iters: 400, epoch: 22 | loss: 0.0004233
	speed: 0.1035s/iter; left time: 395.5976s
Epoch: 22 cost time: 49.62764263153076
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0001027
	speed: 0.4661s/iter; left time: 1702.7794s
	iters: 200, epoch: 23 | loss: 0.0005022
	speed: 0.0906s/iter; left time: 321.7578s
	iters: 300, epoch: 23 | loss: 0.0004422
	speed: 0.1320s/iter; left time: 455.9200s
	iters: 400, epoch: 23 | loss: 0.0000745
	speed: 0.1359s/iter; left time: 455.7519s
Epoch: 23 cost time: 54.709409952163696
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0001998
	speed: 0.5881s/iter; left time: 1872.3733s
	iters: 200, epoch: 24 | loss: 0.0002637
	speed: 0.0805s/iter; left time: 248.2508s
	iters: 300, epoch: 24 | loss: 0.0002678
	speed: 0.1062s/iter; left time: 317.0299s
	iters: 400, epoch: 24 | loss: 0.0000528
	speed: 0.0844s/iter; left time: 243.5038s
Epoch: 24 cost time: 47.059720277786255
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 2069258
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1296006
	speed: 0.3324s/iter; left time: 4643.9144s
	iters: 200, epoch: 1 | loss: 0.4271316
	speed: 0.2431s/iter; left time: 3371.4866s
	iters: 300, epoch: 1 | loss: 0.1685968
	speed: 0.3063s/iter; left time: 4218.7395s
	iters: 400, epoch: 1 | loss: 0.0325146
	speed: 0.2805s/iter; left time: 3834.6296s
Epoch: 1 cost time: 139.73194766044617
Epoch: 1, Steps: 469 | Train Loss: 0.690 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (inf --> -0.956259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3123713
	speed: 0.9534s/iter; left time: 12872.8180s
	iters: 200, epoch: 2 | loss: 0.4060987
	speed: 0.3457s/iter; left time: 4633.3173s
	iters: 300, epoch: 2 | loss: 0.2674147
	speed: 0.3648s/iter; left time: 4852.3920s
	iters: 400, epoch: 2 | loss: 0.0190666
	speed: 0.2870s/iter; left time: 3789.3318s
Epoch: 2 cost time: 154.17547345161438
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
Validation loss decreased (-0.956259 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0792253
	speed: 0.9797s/iter; left time: 12767.8298s
	iters: 200, epoch: 3 | loss: 0.0435379
	speed: 0.3101s/iter; left time: 4010.3328s
	iters: 300, epoch: 3 | loss: 0.0057498
	speed: 0.3010s/iter; left time: 3863.2250s
	iters: 400, epoch: 3 | loss: 0.0479522
	speed: 0.2865s/iter; left time: 3648.0890s
Epoch: 3 cost time: 141.34011340141296
Epoch: 3, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.964264 --> -0.975985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0869443
	speed: 0.8082s/iter; left time: 10154.1973s
	iters: 200, epoch: 4 | loss: 0.0083566
	speed: 0.3101s/iter; left time: 3865.5330s
	iters: 300, epoch: 4 | loss: 0.0030185
	speed: 0.2448s/iter; left time: 3027.2749s
	iters: 400, epoch: 4 | loss: 0.0011798
	speed: 0.2642s/iter; left time: 3239.5443s
Epoch: 4 cost time: 129.8062424659729
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0090329
	speed: 0.6907s/iter; left time: 8354.5424s
	iters: 200, epoch: 5 | loss: 0.0369655
	speed: 0.1822s/iter; left time: 2185.6701s
	iters: 300, epoch: 5 | loss: 0.0488227
	speed: 0.2631s/iter; left time: 3129.4605s
	iters: 400, epoch: 5 | loss: 0.0021703
	speed: 0.2023s/iter; left time: 2386.0321s
Epoch: 5 cost time: 107.28015398979187
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0016911
	speed: 0.9160s/iter; left time: 10649.4184s
	iters: 200, epoch: 6 | loss: 0.0008868
	speed: 0.3647s/iter; left time: 4203.7899s
	iters: 300, epoch: 6 | loss: 0.0014327
	speed: 0.4020s/iter; left time: 4593.4175s
	iters: 400, epoch: 6 | loss: 0.0018029
	speed: 0.3624s/iter; left time: 4104.7537s
Epoch: 6 cost time: 171.37093114852905
Epoch: 6, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0156007
	speed: 1.0886s/iter; left time: 12145.3487s
	iters: 200, epoch: 7 | loss: 0.0048916
	speed: 0.3878s/iter; left time: 4287.8488s
	iters: 300, epoch: 7 | loss: 0.0006135
	speed: 0.3744s/iter; left time: 4102.4955s
	iters: 400, epoch: 7 | loss: 0.0012541
	speed: 0.3141s/iter; left time: 3410.3627s
Epoch: 7 cost time: 160.90245127677917
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.975985 --> -0.979416).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1334161
	speed: 0.8847s/iter; left time: 9456.0082s
	iters: 200, epoch: 8 | loss: 0.0015755
	speed: 0.2748s/iter; left time: 2909.7863s
	iters: 300, epoch: 8 | loss: 0.0009613
	speed: 0.2962s/iter; left time: 3106.4132s
	iters: 400, epoch: 8 | loss: 0.0030626
	speed: 0.2737s/iter; left time: 2843.5094s
Epoch: 8 cost time: 129.88860845565796
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0011030
	speed: 0.7587s/iter; left time: 7753.2799s
	iters: 200, epoch: 9 | loss: 0.0022890
	speed: 0.2616s/iter; left time: 2646.7638s
	iters: 300, epoch: 9 | loss: 0.0017537
	speed: 0.2418s/iter; left time: 2423.0303s
	iters: 400, epoch: 9 | loss: 0.5297433
	speed: 0.2502s/iter; left time: 2482.2144s
Epoch: 9 cost time: 120.15404200553894
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.981989).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0014035
	speed: 0.8818s/iter; left time: 8597.0666s
	iters: 200, epoch: 10 | loss: 0.0022163
	speed: 0.2192s/iter; left time: 2115.0039s
	iters: 300, epoch: 10 | loss: 0.0028137
	speed: 0.4198s/iter; left time: 4008.6360s
	iters: 400, epoch: 10 | loss: 0.0011654
	speed: 0.3972s/iter; left time: 3753.9377s
Epoch: 10 cost time: 166.20334219932556
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0045302
	speed: 1.3339s/iter; left time: 12379.6701s
	iters: 200, epoch: 11 | loss: 0.2598746
	speed: 0.4367s/iter; left time: 4009.7379s
	iters: 300, epoch: 11 | loss: 0.0008731
	speed: 0.4534s/iter; left time: 4117.3736s
	iters: 400, epoch: 11 | loss: 0.0034363
	speed: 0.4364s/iter; left time: 3919.4600s
Epoch: 11 cost time: 207.30159854888916
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0021696
	speed: 1.1490s/iter; left time: 10125.0429s
	iters: 200, epoch: 12 | loss: 0.0006014
	speed: 0.3692s/iter; left time: 3216.7930s
	iters: 300, epoch: 12 | loss: 0.0011179
	speed: 0.3717s/iter; left time: 3200.9759s
	iters: 400, epoch: 12 | loss: 0.0004061
	speed: 0.3118s/iter; left time: 2654.3621s
Epoch: 12 cost time: 157.98034977912903
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0073952
	speed: 0.8868s/iter; left time: 7398.5096s
	iters: 200, epoch: 13 | loss: 0.0005899
	speed: 0.2589s/iter; left time: 2134.4794s
	iters: 300, epoch: 13 | loss: 0.1612825
	speed: 0.2786s/iter; left time: 2268.7942s
	iters: 400, epoch: 13 | loss: 0.0053740
	speed: 0.3331s/iter; left time: 2679.1473s
Epoch: 13 cost time: 139.5464882850647
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0002526
	speed: 1.1260s/iter; left time: 8866.5153s
	iters: 200, epoch: 14 | loss: 0.0006609
	speed: 0.3950s/iter; left time: 3071.0665s
	iters: 300, epoch: 14 | loss: 0.0046126
	speed: 0.3038s/iter; left time: 2331.6294s
	iters: 400, epoch: 14 | loss: 0.0010569
	speed: 0.3768s/iter; left time: 2854.0690s
Epoch: 14 cost time: 167.81291604042053
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983418).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0013172
	speed: 0.9252s/iter; left time: 6850.9660s
	iters: 200, epoch: 15 | loss: 0.0158155
	speed: 0.3432s/iter; left time: 2507.0692s
	iters: 300, epoch: 15 | loss: 0.0023080
	speed: 0.3486s/iter; left time: 2511.8866s
	iters: 400, epoch: 15 | loss: 0.2264453
	speed: 0.3210s/iter; left time: 2280.4929s
Epoch: 15 cost time: 157.8821678161621
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002711
	speed: 1.0270s/iter; left time: 7123.6176s
	iters: 200, epoch: 16 | loss: 0.0010209
	speed: 0.4181s/iter; left time: 2858.0937s
	iters: 300, epoch: 16 | loss: 0.0004836
	speed: 0.3833s/iter; left time: 2581.7260s
	iters: 400, epoch: 16 | loss: 0.0403637
	speed: 0.4129s/iter; left time: 2739.9226s
Epoch: 16 cost time: 186.826514005661
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0001511
	speed: 1.1358s/iter; left time: 7345.1990s
	iters: 200, epoch: 17 | loss: 0.0008523
	speed: 0.3855s/iter; left time: 2454.3865s
	iters: 300, epoch: 17 | loss: 0.0258813
	speed: 0.3357s/iter; left time: 2103.7948s
	iters: 400, epoch: 17 | loss: 0.0004500
	speed: 0.4038s/iter; left time: 2490.2822s
Epoch: 17 cost time: 178.9936261177063
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0012290
	speed: 1.2303s/iter; left time: 7379.1533s
	iters: 200, epoch: 18 | loss: 0.1209500
	speed: 0.4053s/iter; left time: 2390.2021s
	iters: 300, epoch: 18 | loss: 0.0016039
	speed: 0.4245s/iter; left time: 2461.2788s
	iters: 400, epoch: 18 | loss: 0.0004554
	speed: 0.4457s/iter; left time: 2539.3631s
Epoch: 18 cost time: 196.0487551689148
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.4165258
	speed: 1.2106s/iter; left time: 6693.4727s
	iters: 200, epoch: 19 | loss: 0.4243656
	speed: 0.4653s/iter; left time: 2526.3291s
	iters: 300, epoch: 19 | loss: 0.0004915
	speed: 0.4436s/iter; left time: 2363.9142s
	iters: 400, epoch: 19 | loss: 0.0014197
	speed: 0.4615s/iter; left time: 2413.4038s
Epoch: 19 cost time: 211.52985191345215
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0002921
	speed: 1.0915s/iter; left time: 5523.2066s
	iters: 200, epoch: 20 | loss: 0.0028732
	speed: 0.3655s/iter; left time: 1812.7454s
	iters: 300, epoch: 20 | loss: 0.0002442
	speed: 0.4054s/iter; left time: 1970.3775s
	iters: 400, epoch: 20 | loss: 0.0013568
	speed: 0.3735s/iter; left time: 1778.0492s
Epoch: 20 cost time: 181.65193963050842
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0002313
	speed: 1.1414s/iter; left time: 5240.1416s
	iters: 200, epoch: 21 | loss: 0.0003148
	speed: 0.3711s/iter; left time: 1666.8258s
	iters: 300, epoch: 21 | loss: 0.0118667
	speed: 0.3655s/iter; left time: 1605.0151s
	iters: 400, epoch: 21 | loss: 0.0002239
	speed: 0.3499s/iter; left time: 1501.6035s
Epoch: 21 cost time: 168.43056750297546
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.945 Test Loss: 0.260 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0005115
	speed: 1.1080s/iter; left time: 4567.0240s
	iters: 200, epoch: 22 | loss: 0.0025546
	speed: 0.3864s/iter; left time: 1553.9754s
	iters: 300, epoch: 22 | loss: 0.0006028
	speed: 0.4717s/iter; left time: 1850.0951s
	iters: 400, epoch: 22 | loss: 0.0016426
	speed: 0.4235s/iter; left time: 1618.7913s
Epoch: 22 cost time: 189.68609380722046
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0001589
	speed: 1.2197s/iter; left time: 4455.5521s
	iters: 200, epoch: 23 | loss: 0.0006633
	speed: 0.4361s/iter; left time: 1549.6376s
	iters: 300, epoch: 23 | loss: 0.0065503
	speed: 0.4665s/iter; left time: 1610.6687s
	iters: 400, epoch: 23 | loss: 0.0013789
	speed: 0.3614s/iter; left time: 1211.6505s
Epoch: 23 cost time: 192.4458065032959
Epoch: 23, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.5062732
	speed: 1.0750s/iter; left time: 3422.8701s
	iters: 200, epoch: 24 | loss: 0.0007240
	speed: 0.3082s/iter; left time: 950.6027s
	iters: 300, epoch: 24 | loss: 0.0002727
	speed: 0.3705s/iter; left time: 1105.6790s
	iters: 400, epoch: 24 | loss: 0.0009555
	speed: 0.3590s/iter; left time: 1035.3111s
Epoch: 24 cost time: 163.60752058029175
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 3519050
model size : 14.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3259866
	speed: 0.2468s/iter; left time: 3447.8368s
	iters: 200, epoch: 1 | loss: 0.7229058
	speed: 0.2586s/iter; left time: 3587.1249s
	iters: 300, epoch: 1 | loss: 0.2537070
	speed: 0.1699s/iter; left time: 2339.8681s
	iters: 400, epoch: 1 | loss: 0.2753961
	speed: 0.2041s/iter; left time: 2789.7911s
Epoch: 1 cost time: 102.14993333816528
Epoch: 1, Steps: 469 | Train Loss: 0.731 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
Validation loss decreased (inf --> -0.956259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0203552
	speed: 0.6582s/iter; left time: 8887.2554s
	iters: 200, epoch: 2 | loss: 0.0233573
	speed: 0.1737s/iter; left time: 2328.2125s
	iters: 300, epoch: 2 | loss: 0.0409949
	speed: 0.1820s/iter; left time: 2420.3384s
	iters: 400, epoch: 2 | loss: 0.0077288
	speed: 0.2022s/iter; left time: 2669.9793s
Epoch: 2 cost time: 95.20799446105957
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.956259 --> -0.973126).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0155619
	speed: 0.8395s/iter; left time: 10941.3690s
	iters: 200, epoch: 3 | loss: 0.4261950
	speed: 0.2477s/iter; left time: 3202.8755s
	iters: 300, epoch: 3 | loss: 0.0187253
	speed: 0.2747s/iter; left time: 3525.6841s
	iters: 400, epoch: 3 | loss: 0.0895514
	speed: 0.2141s/iter; left time: 2725.7822s
Epoch: 3 cost time: 112.71085500717163
Epoch: 3, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973126 --> -0.977129).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0395469
	speed: 0.7447s/iter; left time: 9356.1118s
	iters: 200, epoch: 4 | loss: 0.0360971
	speed: 0.1844s/iter; left time: 2297.9354s
	iters: 300, epoch: 4 | loss: 0.0021704
	speed: 0.2110s/iter; left time: 2608.5497s
	iters: 400, epoch: 4 | loss: 0.0023049
	speed: 0.2505s/iter; left time: 3071.9490s
Epoch: 4 cost time: 103.06785368919373
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0180329
	speed: 0.6222s/iter; left time: 7525.7769s
	iters: 200, epoch: 5 | loss: 0.0021036
	speed: 0.1667s/iter; left time: 1999.3403s
	iters: 300, epoch: 5 | loss: 0.0208833
	speed: 0.1651s/iter; left time: 1963.7960s
	iters: 400, epoch: 5 | loss: 0.0277551
	speed: 0.1692s/iter; left time: 1995.8648s
Epoch: 5 cost time: 79.26245737075806
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0102246
	speed: 0.4559s/iter; left time: 5300.4257s
	iters: 200, epoch: 6 | loss: 0.0014601
	speed: 0.1735s/iter; left time: 1999.3871s
	iters: 300, epoch: 6 | loss: 0.0031817
	speed: 0.2186s/iter; left time: 2497.2784s
	iters: 400, epoch: 6 | loss: 0.0009321
	speed: 0.1900s/iter; left time: 2151.6510s
Epoch: 6 cost time: 84.29331135749817
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977701).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0054532
	speed: 0.5834s/iter; left time: 6509.2355s
	iters: 200, epoch: 7 | loss: 0.0013791
	speed: 0.1478s/iter; left time: 1634.7088s
	iters: 300, epoch: 7 | loss: 0.0007791
	speed: 0.1830s/iter; left time: 2005.0056s
	iters: 400, epoch: 7 | loss: 0.0038103
	speed: 0.2335s/iter; left time: 2535.0095s
Epoch: 7 cost time: 89.29875087738037
Epoch: 7, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.977701 --> -0.979702).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0014099
	speed: 0.6415s/iter; left time: 6856.2339s
	iters: 200, epoch: 8 | loss: 0.0007775
	speed: 0.1618s/iter; left time: 1713.5434s
	iters: 300, epoch: 8 | loss: 0.0010517
	speed: 0.1631s/iter; left time: 1710.8212s
	iters: 400, epoch: 8 | loss: 0.2537220
	speed: 0.1500s/iter; left time: 1558.6262s
Epoch: 8 cost time: 77.48411989212036
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0027764
	speed: 0.6145s/iter; left time: 6279.8552s
	iters: 200, epoch: 9 | loss: 0.0007800
	speed: 0.1843s/iter; left time: 1864.4287s
	iters: 300, epoch: 9 | loss: 0.0016805
	speed: 0.1900s/iter; left time: 1903.2047s
	iters: 400, epoch: 9 | loss: 0.0003176
	speed: 0.1570s/iter; left time: 1557.2449s
Epoch: 9 cost time: 80.68766188621521
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1560882
	speed: 0.6274s/iter; left time: 6116.8287s
	iters: 200, epoch: 10 | loss: 0.0003681
	speed: 0.1673s/iter; left time: 1614.2411s
	iters: 300, epoch: 10 | loss: 0.0012008
	speed: 0.1562s/iter; left time: 1491.8641s
	iters: 400, epoch: 10 | loss: 0.0024736
	speed: 0.1681s/iter; left time: 1588.5367s
Epoch: 10 cost time: 81.42247557640076
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
Validation loss decreased (-0.979702 --> -0.984276).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0903278
	speed: 0.5185s/iter; left time: 4811.9110s
	iters: 200, epoch: 11 | loss: 0.0205040
	speed: 0.1587s/iter; left time: 1457.0567s
	iters: 300, epoch: 11 | loss: 0.0007551
	speed: 0.2155s/iter; left time: 1956.5040s
	iters: 400, epoch: 11 | loss: 0.0019124
	speed: 0.1771s/iter; left time: 1590.8002s
Epoch: 11 cost time: 82.31383275985718
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0042401
	speed: 0.6491s/iter; left time: 5720.2855s
	iters: 200, epoch: 12 | loss: 0.0006401
	speed: 0.1621s/iter; left time: 1412.4163s
	iters: 300, epoch: 12 | loss: 0.0005538
	speed: 0.1759s/iter; left time: 1515.2602s
	iters: 400, epoch: 12 | loss: 0.0003344
	speed: 0.1814s/iter; left time: 1544.2582s
Epoch: 12 cost time: 86.77781224250793
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0644295
	speed: 0.5804s/iter; left time: 4842.3201s
	iters: 200, epoch: 13 | loss: 0.0004567
	speed: 0.2101s/iter; left time: 1731.6347s
	iters: 300, epoch: 13 | loss: 0.0005074
	speed: 0.1935s/iter; left time: 1575.3499s
	iters: 400, epoch: 13 | loss: 0.0004468
	speed: 0.1585s/iter; left time: 1275.0292s
Epoch: 13 cost time: 87.27395153045654
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0006096
	speed: 0.6915s/iter; left time: 5444.9079s
	iters: 200, epoch: 14 | loss: 0.0001702
	speed: 0.1841s/iter; left time: 1431.4975s
	iters: 300, epoch: 14 | loss: 0.0032166
	speed: 0.2123s/iter; left time: 1628.8784s
	iters: 400, epoch: 14 | loss: 0.0083641
	speed: 0.2175s/iter; left time: 1647.1480s
Epoch: 14 cost time: 93.88941311836243
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0001636
	speed: 0.6444s/iter; left time: 4771.4144s
	iters: 200, epoch: 15 | loss: 0.0003751
	speed: 0.1843s/iter; left time: 1346.6015s
	iters: 300, epoch: 15 | loss: 0.0027825
	speed: 0.1336s/iter; left time: 962.8121s
	iters: 400, epoch: 15 | loss: 0.0017910
	speed: 0.2095s/iter; left time: 1488.6141s
Epoch: 15 cost time: 87.05930423736572
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0011134
	speed: 0.6224s/iter; left time: 4316.6956s
	iters: 200, epoch: 16 | loss: 0.0001183
	speed: 0.2189s/iter; left time: 1496.4987s
	iters: 300, epoch: 16 | loss: 0.0411874
	speed: 0.1572s/iter; left time: 1058.5857s
	iters: 400, epoch: 16 | loss: 0.0013067
	speed: 0.1520s/iter; left time: 1008.4873s
Epoch: 16 cost time: 84.87148213386536
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001245
	speed: 0.6091s/iter; left time: 3939.2224s
	iters: 200, epoch: 17 | loss: 0.0023716
	speed: 0.1690s/iter; left time: 1075.8901s
	iters: 300, epoch: 17 | loss: 0.0002776
	speed: 0.1849s/iter; left time: 1158.6569s
	iters: 400, epoch: 17 | loss: 0.0017373
	speed: 0.1585s/iter; left time: 977.2815s
Epoch: 17 cost time: 80.1962022781372
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0002601
	speed: 0.5749s/iter; left time: 3448.1045s
	iters: 200, epoch: 18 | loss: 0.0005481
	speed: 0.1083s/iter; left time: 638.5247s
	iters: 300, epoch: 18 | loss: 0.0036349
	speed: 0.0815s/iter; left time: 472.4765s
	iters: 400, epoch: 18 | loss: 0.0021546
	speed: 0.1662s/iter; left time: 947.2645s
Epoch: 18 cost time: 63.84771418571472
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0001547
	speed: 0.5862s/iter; left time: 3241.0748s
	iters: 200, epoch: 19 | loss: 0.0002608
	speed: 0.1976s/iter; left time: 1072.5823s
	iters: 300, epoch: 19 | loss: 0.0015539
	speed: 0.1496s/iter; left time: 797.2629s
	iters: 400, epoch: 19 | loss: 0.0020113
	speed: 0.1486s/iter; left time: 777.0953s
Epoch: 19 cost time: 80.95727634429932
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0003311
	speed: 0.5146s/iter; left time: 2603.6411s
	iters: 200, epoch: 20 | loss: 0.0001467
	speed: 0.1068s/iter; left time: 529.9584s
	iters: 300, epoch: 20 | loss: 0.0017680
	speed: 0.1555s/iter; left time: 755.8096s
	iters: 400, epoch: 20 | loss: 0.0004898
	speed: 0.1878s/iter; left time: 893.8766s
Epoch: 20 cost time: 69.4244167804718
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 1036298
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1312947
	speed: 0.2231s/iter; left time: 3117.2147s
	iters: 200, epoch: 1 | loss: 0.4307076
	speed: 0.2170s/iter; left time: 3009.6738s
	iters: 300, epoch: 1 | loss: 0.1854674
	speed: 0.2675s/iter; left time: 3683.9490s
	iters: 400, epoch: 1 | loss: 0.0447713
	speed: 0.2103s/iter; left time: 2875.1465s
Epoch: 1 cost time: 102.0635232925415
Epoch: 1, Steps: 469 | Train Loss: 0.702 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
Validation loss decreased (inf --> -0.938534).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4196039
	speed: 0.6629s/iter; left time: 8950.1700s
	iters: 200, epoch: 2 | loss: 0.4254600
	speed: 0.1974s/iter; left time: 2645.7525s
	iters: 300, epoch: 2 | loss: 0.2345914
	speed: 0.2127s/iter; left time: 2829.6916s
	iters: 400, epoch: 2 | loss: 0.0167448
	speed: 0.1871s/iter; left time: 2470.2583s
Epoch: 2 cost time: 92.21651577949524
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.938534 --> -0.957117).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0478270
	speed: 0.6760s/iter; left time: 8810.8573s
	iters: 200, epoch: 3 | loss: 0.0241823
	speed: 0.2017s/iter; left time: 2608.5332s
	iters: 300, epoch: 3 | loss: 0.0072225
	speed: 0.2481s/iter; left time: 3183.4065s
	iters: 400, epoch: 3 | loss: 0.1465225
	speed: 0.2281s/iter; left time: 2904.8439s
Epoch: 3 cost time: 105.11799335479736
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0859202
	speed: 0.7678s/iter; left time: 9647.2238s
	iters: 200, epoch: 4 | loss: 0.0158054
	speed: 0.2144s/iter; left time: 2672.4268s
	iters: 300, epoch: 4 | loss: 0.0075785
	speed: 0.2191s/iter; left time: 2709.3579s
	iters: 400, epoch: 4 | loss: 0.0015277
	speed: 0.2103s/iter; left time: 2579.2419s
Epoch: 4 cost time: 99.38223934173584
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0174684
	speed: 0.6245s/iter; left time: 7553.8780s
	iters: 200, epoch: 5 | loss: 0.0888746
	speed: 0.1739s/iter; left time: 2086.4508s
	iters: 300, epoch: 5 | loss: 0.0032430
	speed: 0.1306s/iter; left time: 1553.3152s
	iters: 400, epoch: 5 | loss: 0.0021390
	speed: 0.1500s/iter; left time: 1768.6899s
Epoch: 5 cost time: 76.46508264541626
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.957117 --> -0.974842).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006389
	speed: 0.5571s/iter; left time: 6476.3545s
	iters: 200, epoch: 6 | loss: 0.0065392
	speed: 0.1679s/iter; left time: 1935.5187s
	iters: 300, epoch: 6 | loss: 0.0015269
	speed: 0.1412s/iter; left time: 1613.1522s
	iters: 400, epoch: 6 | loss: 0.0039560
	speed: 0.1597s/iter; left time: 1808.5565s
Epoch: 6 cost time: 75.94338941574097
Epoch: 6, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0155898
	speed: 0.5253s/iter; left time: 5860.7512s
	iters: 200, epoch: 7 | loss: 0.0443313
	speed: 0.1694s/iter; left time: 1872.7555s
	iters: 300, epoch: 7 | loss: 0.0022671
	speed: 0.1653s/iter; left time: 1811.3340s
	iters: 400, epoch: 7 | loss: 0.0015497
	speed: 0.1658s/iter; left time: 1799.6095s
Epoch: 7 cost time: 75.57068133354187
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.974842 --> -0.978844).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0012535
	speed: 0.5963s/iter; left time: 6373.1000s
	iters: 200, epoch: 8 | loss: 0.0019829
	speed: 0.1990s/iter; left time: 2107.5400s
	iters: 300, epoch: 8 | loss: 0.0111960
	speed: 0.1657s/iter; left time: 1738.3235s
	iters: 400, epoch: 8 | loss: 0.0024779
	speed: 0.2053s/iter; left time: 2132.1486s
Epoch: 8 cost time: 85.90826320648193
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.978844 --> -0.981989).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0170413
	speed: 0.6412s/iter; left time: 6552.4541s
	iters: 200, epoch: 9 | loss: 0.0077152
	speed: 0.1646s/iter; left time: 1665.4847s
	iters: 300, epoch: 9 | loss: 0.0007086
	speed: 0.1514s/iter; left time: 1517.3659s
	iters: 400, epoch: 9 | loss: 0.0410239
	speed: 0.1780s/iter; left time: 1765.3889s
Epoch: 9 cost time: 79.90380883216858
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0009500
	speed: 0.5959s/iter; left time: 5809.7439s
	iters: 200, epoch: 10 | loss: 0.0024106
	speed: 0.1724s/iter; left time: 1663.5885s
	iters: 300, epoch: 10 | loss: 0.0016973
	speed: 0.2008s/iter; left time: 1917.2219s
	iters: 400, epoch: 10 | loss: 0.0021946
	speed: 0.1907s/iter; left time: 1802.3957s
Epoch: 10 cost time: 87.88911414146423
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0022067
	speed: 0.6198s/iter; left time: 5752.3223s
	iters: 200, epoch: 11 | loss: 0.0222091
	speed: 0.1946s/iter; left time: 1786.4395s
	iters: 300, epoch: 11 | loss: 0.0024993
	speed: 0.2145s/iter; left time: 1947.7953s
	iters: 400, epoch: 11 | loss: 0.0015120
	speed: 0.1820s/iter; left time: 1634.1418s
Epoch: 11 cost time: 91.28026533126831
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0005271
	speed: 0.6583s/iter; left time: 5801.2165s
	iters: 200, epoch: 12 | loss: 0.0005013
	speed: 0.2076s/iter; left time: 1808.6292s
	iters: 300, epoch: 12 | loss: 0.0011159
	speed: 0.1158s/iter; left time: 996.9626s
	iters: 400, epoch: 12 | loss: 0.0001848
	speed: 0.1232s/iter; left time: 1048.9896s
Epoch: 12 cost time: 73.59635710716248
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0067598
	speed: 0.5005s/iter; left time: 4175.9889s
	iters: 200, epoch: 13 | loss: 0.0092844
	speed: 0.1670s/iter; left time: 1376.7168s
	iters: 300, epoch: 13 | loss: 0.0105844
	speed: 0.1077s/iter; left time: 877.1083s
	iters: 400, epoch: 13 | loss: 0.0001190
	speed: 0.1601s/iter; left time: 1287.9278s
Epoch: 13 cost time: 71.81892895698547
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0001094
	speed: 0.6668s/iter; left time: 5250.0060s
	iters: 200, epoch: 14 | loss: 0.0023757
	speed: 0.2059s/iter; left time: 1600.8027s
	iters: 300, epoch: 14 | loss: 0.0010842
	speed: 0.1748s/iter; left time: 1341.2316s
	iters: 400, epoch: 14 | loss: 0.0026675
	speed: 0.1968s/iter; left time: 1490.6777s
Epoch: 14 cost time: 91.33854675292969
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0111257
	speed: 0.6718s/iter; left time: 4975.0187s
	iters: 200, epoch: 15 | loss: 0.0099131
	speed: 0.1898s/iter; left time: 1386.5624s
	iters: 300, epoch: 15 | loss: 0.0003907
	speed: 0.1902s/iter; left time: 1370.4931s
	iters: 400, epoch: 15 | loss: 0.0003214
	speed: 0.2015s/iter; left time: 1431.8761s
Epoch: 15 cost time: 92.66260027885437
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0002551
	speed: 0.7158s/iter; left time: 4965.1159s
	iters: 200, epoch: 16 | loss: 0.0005110
	speed: 0.2000s/iter; left time: 1367.2621s
	iters: 300, epoch: 16 | loss: 0.0350051
	speed: 0.1872s/iter; left time: 1260.9035s
	iters: 400, epoch: 16 | loss: 0.0629227
	speed: 0.2110s/iter; left time: 1400.0976s
Epoch: 16 cost time: 97.40577507019043
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0001508
	speed: 0.7037s/iter; left time: 4550.6361s
	iters: 200, epoch: 17 | loss: 0.0065827
	speed: 0.2090s/iter; left time: 1330.7609s
	iters: 300, epoch: 17 | loss: 0.0004334
	speed: 0.1972s/iter; left time: 1235.8341s
	iters: 400, epoch: 17 | loss: 0.0014967
	speed: 0.1941s/iter; left time: 1196.7828s
Epoch: 17 cost time: 96.77074146270752
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0028416
	speed: 0.7241s/iter; left time: 4343.3239s
	iters: 200, epoch: 18 | loss: 0.3892517
	speed: 0.2031s/iter; left time: 1198.0980s
	iters: 300, epoch: 18 | loss: 0.0001997
	speed: 0.2079s/iter; left time: 1205.5257s
	iters: 400, epoch: 18 | loss: 0.0000690
	speed: 0.2082s/iter; left time: 1186.4357s
Epoch: 18 cost time: 97.65172410011292
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983132).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3807183
	speed: 0.7389s/iter; left time: 4085.6161s
	iters: 200, epoch: 19 | loss: 0.0003704
	speed: 0.2209s/iter; left time: 1199.1402s
	iters: 300, epoch: 19 | loss: 0.0004839
	speed: 0.2471s/iter; left time: 1316.9957s
	iters: 400, epoch: 19 | loss: 0.0051001
	speed: 0.2178s/iter; left time: 1138.8197s
Epoch: 19 cost time: 106.21665596961975
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0026349
	speed: 0.7343s/iter; left time: 3715.5939s
	iters: 200, epoch: 20 | loss: 0.0019561
	speed: 0.2160s/iter; left time: 1071.5934s
	iters: 300, epoch: 20 | loss: 0.0000451
	speed: 0.1882s/iter; left time: 914.8144s
	iters: 400, epoch: 20 | loss: 0.0005675
	speed: 0.1863s/iter; left time: 886.6417s
Epoch: 20 cost time: 93.06372570991516
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0013371
	speed: 0.6883s/iter; left time: 3159.8350s
	iters: 200, epoch: 21 | loss: 0.0002835
	speed: 0.1909s/iter; left time: 857.2823s
	iters: 300, epoch: 21 | loss: 0.0005118
	speed: 0.1855s/iter; left time: 814.4625s
	iters: 400, epoch: 21 | loss: 0.0134448
	speed: 0.1638s/iter; left time: 703.0491s
Epoch: 21 cost time: 87.22111749649048
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0010415
	speed: 0.5904s/iter; left time: 2433.6291s
	iters: 200, epoch: 22 | loss: 0.0011576
	speed: 0.1520s/iter; left time: 611.2285s
	iters: 300, epoch: 22 | loss: 0.0002472
	speed: 0.1616s/iter; left time: 633.6849s
	iters: 400, epoch: 22 | loss: 0.0267398
	speed: 0.1557s/iter; left time: 595.0373s
Epoch: 22 cost time: 76.31871294975281
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0001230
	speed: 0.5484s/iter; left time: 2003.3216s
	iters: 200, epoch: 23 | loss: 0.0002404
	speed: 0.1414s/iter; left time: 502.3936s
	iters: 300, epoch: 23 | loss: 0.0002288
	speed: 0.1795s/iter; left time: 619.7586s
	iters: 400, epoch: 23 | loss: 0.0007306
	speed: 0.1508s/iter; left time: 505.6059s
Epoch: 23 cost time: 74.05582857131958
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983132 --> -0.983418).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0042413
	speed: 0.6112s/iter; left time: 1946.0021s
	iters: 200, epoch: 24 | loss: 0.0003123
	speed: 0.2055s/iter; left time: 633.7455s
	iters: 300, epoch: 24 | loss: 0.0004201
	speed: 0.1966s/iter; left time: 586.6678s
	iters: 400, epoch: 24 | loss: 0.0036760
	speed: 0.1932s/iter; left time: 557.2035s
Epoch: 24 cost time: 92.88874959945679
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0012713
	speed: 0.6726s/iter; left time: 1826.0251s
	iters: 200, epoch: 25 | loss: 0.0008641
	speed: 0.2102s/iter; left time: 549.5515s
	iters: 300, epoch: 25 | loss: 0.0085729
	speed: 0.1828s/iter; left time: 459.6635s
	iters: 400, epoch: 25 | loss: 0.0005607
	speed: 0.2117s/iter; left time: 511.3355s
Epoch: 25 cost time: 91.91643452644348
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0002930
	speed: 0.5848s/iter; left time: 1313.5632s
	iters: 200, epoch: 26 | loss: 0.0001320
	speed: 0.1687s/iter; left time: 361.9339s
	iters: 300, epoch: 26 | loss: 0.0029392
	speed: 0.1677s/iter; left time: 343.1197s
	iters: 400, epoch: 26 | loss: 0.0004105
	speed: 0.1494s/iter; left time: 290.7428s
Epoch: 26 cost time: 79.01594972610474
Epoch: 26, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0003456
	speed: 0.5649s/iter; left time: 1003.8159s
	iters: 200, epoch: 27 | loss: 0.0006028
	speed: 0.1553s/iter; left time: 260.4791s
	iters: 300, epoch: 27 | loss: 0.4092439
	speed: 0.1433s/iter; left time: 226.0472s
	iters: 400, epoch: 27 | loss: 0.4510596
	speed: 0.2019s/iter; left time: 298.2392s
Epoch: 27 cost time: 80.17708945274353
Epoch: 27, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0016188
	speed: 0.5944s/iter; left time: 777.5367s
	iters: 200, epoch: 28 | loss: 0.0004272
	speed: 0.1632s/iter; left time: 197.1817s
	iters: 300, epoch: 28 | loss: 0.0003943
	speed: 0.1537s/iter; left time: 170.2908s
	iters: 400, epoch: 28 | loss: 0.0008187
	speed: 0.1545s/iter; left time: 155.7633s
Epoch: 28 cost time: 74.25919580459595
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0001187
	speed: 0.5540s/iter; left time: 464.7715s
	iters: 200, epoch: 29 | loss: 0.0002664
	speed: 0.1537s/iter; left time: 113.5769s
	iters: 300, epoch: 29 | loss: 0.0001202
	speed: 0.1584s/iter; left time: 101.2213s
	iters: 400, epoch: 29 | loss: 0.0003210
	speed: 0.1591s/iter; left time: 85.7718s
Epoch: 29 cost time: 70.56441879272461
Epoch: 29, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0001307
	speed: 0.4305s/iter; left time: 159.2730s
	iters: 200, epoch: 30 | loss: 0.0010533
	speed: 0.1271s/iter; left time: 34.3064s
	iters: 300, epoch: 30 | loss: 0.0006420
	speed: 0.1458s/iter; left time: 24.7877s
	iters: 400, epoch: 30 | loss: 0.0002264
	speed: 0.1392s/iter; left time: 9.7465s
Epoch: 30 cost time: 64.15369081497192
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 3519050
model size : 14.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3273029
	speed: 0.1175s/iter; left time: 1641.2965s
	iters: 200, epoch: 1 | loss: 0.7280210
	speed: 0.0911s/iter; left time: 1264.1031s
	iters: 300, epoch: 1 | loss: 0.2518081
	speed: 0.0955s/iter; left time: 1315.4219s
	iters: 400, epoch: 1 | loss: 0.3219275
	speed: 0.1228s/iter; left time: 1679.1614s
Epoch: 1 cost time: 51.44314646720886
Epoch: 1, Steps: 469 | Train Loss: 0.739 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
Validation loss decreased (inf --> -0.955402).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0278087
	speed: 0.4470s/iter; left time: 6034.9067s
	iters: 200, epoch: 2 | loss: 0.0431344
	speed: 0.1236s/iter; left time: 1657.0875s
	iters: 300, epoch: 2 | loss: 0.0588075
	speed: 0.1201s/iter; left time: 1597.4108s
	iters: 400, epoch: 2 | loss: 0.0081222
	speed: 0.1414s/iter; left time: 1866.3968s
Epoch: 2 cost time: 61.633734464645386
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.955402 --> -0.972269).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0319894
	speed: 0.4935s/iter; left time: 6431.7722s
	iters: 200, epoch: 3 | loss: 0.3994738
	speed: 0.1253s/iter; left time: 1620.0594s
	iters: 300, epoch: 3 | loss: 0.0141965
	speed: 0.1210s/iter; left time: 1552.8422s
	iters: 400, epoch: 3 | loss: 0.0295339
	speed: 0.1354s/iter; left time: 1724.2634s
Epoch: 3 cost time: 62.17560625076294
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.972269 --> -0.977701).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0195123
	speed: 0.4954s/iter; left time: 6223.5835s
	iters: 200, epoch: 4 | loss: 0.0211227
	speed: 0.1320s/iter; left time: 1645.1455s
	iters: 300, epoch: 4 | loss: 0.0021932
	speed: 0.1217s/iter; left time: 1505.2491s
	iters: 400, epoch: 4 | loss: 0.0024810
	speed: 0.1290s/iter; left time: 1581.4993s
Epoch: 4 cost time: 58.91038417816162
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0090233
	speed: 0.4496s/iter; left time: 5438.4374s
	iters: 200, epoch: 5 | loss: 0.0973796
	speed: 0.1392s/iter; left time: 1670.1383s
	iters: 300, epoch: 5 | loss: 0.0838010
	speed: 0.1240s/iter; left time: 1474.4654s
	iters: 400, epoch: 5 | loss: 0.0685159
	speed: 0.1319s/iter; left time: 1555.8458s
Epoch: 5 cost time: 63.26800751686096
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.977701 --> -0.979988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0421440
	speed: 0.5141s/iter; left time: 5976.9260s
	iters: 200, epoch: 6 | loss: 0.0021624
	speed: 0.1217s/iter; left time: 1402.2517s
	iters: 300, epoch: 6 | loss: 0.0065474
	speed: 0.1231s/iter; left time: 1406.4411s
	iters: 400, epoch: 6 | loss: 0.0023196
	speed: 0.1377s/iter; left time: 1559.4481s
Epoch: 6 cost time: 63.08276963233948
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0049663
	speed: 0.4801s/iter; left time: 5356.9501s
	iters: 200, epoch: 7 | loss: 0.0015138
	speed: 0.1066s/iter; left time: 1178.3758s
	iters: 300, epoch: 7 | loss: 0.0038754
	speed: 0.1173s/iter; left time: 1285.5235s
	iters: 400, epoch: 7 | loss: 0.0048317
	speed: 0.1356s/iter; left time: 1472.4353s
Epoch: 7 cost time: 57.40846252441406
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0006403
	speed: 0.4486s/iter; left time: 4795.0531s
	iters: 200, epoch: 8 | loss: 0.0202629
	speed: 0.1238s/iter; left time: 1311.1031s
	iters: 300, epoch: 8 | loss: 0.0018146
	speed: 0.1226s/iter; left time: 1286.0717s
	iters: 400, epoch: 8 | loss: 0.2964604
	speed: 0.1241s/iter; left time: 1289.0853s
Epoch: 8 cost time: 56.00362682342529
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0020213
	speed: 0.3890s/iter; left time: 3975.1689s
	iters: 200, epoch: 9 | loss: 0.0015799
	speed: 0.1133s/iter; left time: 1146.2917s
	iters: 300, epoch: 9 | loss: 0.0008310
	speed: 0.1018s/iter; left time: 1020.0683s
	iters: 400, epoch: 9 | loss: 0.0004707
	speed: 0.0948s/iter; left time: 940.7575s
Epoch: 9 cost time: 50.68197250366211
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1224368
	speed: 0.4120s/iter; left time: 4016.5711s
	iters: 200, epoch: 10 | loss: 0.0003469
	speed: 0.1038s/iter; left time: 1001.6099s
	iters: 300, epoch: 10 | loss: 0.0069035
	speed: 0.1103s/iter; left time: 1053.7004s
	iters: 400, epoch: 10 | loss: 0.0019537
	speed: 0.1218s/iter; left time: 1150.6949s
Epoch: 10 cost time: 54.33392643928528
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0019480
	speed: 0.4918s/iter; left time: 4564.6247s
	iters: 200, epoch: 11 | loss: 0.0205173
	speed: 0.1173s/iter; left time: 1076.7176s
	iters: 300, epoch: 11 | loss: 0.0009827
	speed: 0.1134s/iter; left time: 1030.0181s
	iters: 400, epoch: 11 | loss: 0.0009508
	speed: 0.1269s/iter; left time: 1139.8712s
Epoch: 11 cost time: 58.70759105682373
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.979988 --> -0.984562).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0010438
	speed: 0.5060s/iter; left time: 4458.7959s
	iters: 200, epoch: 12 | loss: 0.0009892
	speed: 0.1368s/iter; left time: 1191.4101s
	iters: 300, epoch: 12 | loss: 0.0013419
	speed: 0.1217s/iter; left time: 1048.3723s
	iters: 400, epoch: 12 | loss: 0.0129543
	speed: 0.1463s/iter; left time: 1245.3218s
Epoch: 12 cost time: 64.7768566608429
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0018221
	speed: 0.4802s/iter; left time: 4006.6671s
	iters: 200, epoch: 13 | loss: 0.0008158
	speed: 0.1282s/iter; left time: 1056.8695s
	iters: 300, epoch: 13 | loss: 0.0007710
	speed: 0.1395s/iter; left time: 1136.2563s
	iters: 400, epoch: 13 | loss: 0.0005094
	speed: 0.1158s/iter; left time: 931.0844s
Epoch: 13 cost time: 58.93230199813843
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0022484
	speed: 0.4723s/iter; left time: 3718.8560s
	iters: 200, epoch: 14 | loss: 0.0004240
	speed: 0.1324s/iter; left time: 1029.1492s
	iters: 300, epoch: 14 | loss: 0.0049429
	speed: 0.0979s/iter; left time: 751.5256s
	iters: 400, epoch: 14 | loss: 0.0147635
	speed: 0.1189s/iter; left time: 900.8094s
Epoch: 14 cost time: 57.40035152435303
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0005319
	speed: 0.5139s/iter; left time: 3805.7509s
	iters: 200, epoch: 15 | loss: 0.0148884
	speed: 0.1316s/iter; left time: 961.0961s
	iters: 300, epoch: 15 | loss: 0.0009429
	speed: 0.1220s/iter; left time: 879.1911s
	iters: 400, epoch: 15 | loss: 0.0079972
	speed: 0.1319s/iter; left time: 936.9463s
Epoch: 15 cost time: 62.62029027938843
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0005350
	speed: 0.5100s/iter; left time: 3537.4183s
	iters: 200, epoch: 16 | loss: 0.0006604
	speed: 0.1281s/iter; left time: 875.6116s
	iters: 300, epoch: 16 | loss: 0.0035019
	speed: 0.1365s/iter; left time: 919.2516s
	iters: 400, epoch: 16 | loss: 0.0012491
	speed: 0.1470s/iter; left time: 975.6602s
Epoch: 16 cost time: 64.54977464675903
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0002296
	speed: 0.4687s/iter; left time: 3031.1666s
	iters: 200, epoch: 17 | loss: 0.0008644
	speed: 0.1273s/iter; left time: 810.7106s
	iters: 300, epoch: 17 | loss: 0.0001109
	speed: 0.1321s/iter; left time: 827.7225s
	iters: 400, epoch: 17 | loss: 0.0001932
	speed: 0.1188s/iter; left time: 732.4689s
Epoch: 17 cost time: 55.34627437591553
Epoch: 17, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0002399
	speed: 0.3955s/iter; left time: 2372.3055s
	iters: 200, epoch: 18 | loss: 0.0007840
	speed: 0.1089s/iter; left time: 642.4153s
	iters: 300, epoch: 18 | loss: 0.0003779
	speed: 0.0958s/iter; left time: 555.3932s
	iters: 400, epoch: 18 | loss: 0.0155856
	speed: 0.0959s/iter; left time: 546.1880s
Epoch: 18 cost time: 48.10826587677002
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0020582
	speed: 0.4068s/iter; left time: 2249.4341s
	iters: 200, epoch: 19 | loss: 0.0003093
	speed: 0.0859s/iter; left time: 466.5339s
	iters: 300, epoch: 19 | loss: 0.0016078
	speed: 0.0768s/iter; left time: 409.2033s
	iters: 400, epoch: 19 | loss: 0.0001972
	speed: 0.0963s/iter; left time: 503.5419s
Epoch: 19 cost time: 43.98650026321411
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0053107
	speed: 0.4097s/iter; left time: 2073.2365s
	iters: 200, epoch: 20 | loss: 0.0001178
	speed: 0.0963s/iter; left time: 477.5484s
	iters: 300, epoch: 20 | loss: 0.0021905
	speed: 0.1012s/iter; left time: 491.6800s
	iters: 400, epoch: 20 | loss: 0.0003266
	speed: 0.1106s/iter; left time: 526.6510s
Epoch: 20 cost time: 48.879268646240234
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0002038
	speed: 0.4119s/iter; left time: 1890.9662s
	iters: 200, epoch: 21 | loss: 0.0036263
	speed: 0.0940s/iter; left time: 422.1782s
	iters: 300, epoch: 21 | loss: 0.0001046
	speed: 0.1007s/iter; left time: 442.0637s
	iters: 400, epoch: 21 | loss: 0.0210474
	speed: 0.1024s/iter; left time: 439.2564s
Epoch: 21 cost time: 46.47492027282715
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 1036298
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2399796
	speed: 0.1363s/iter; left time: 1904.0488s
	iters: 200, epoch: 1 | loss: 0.6208952
	speed: 0.1027s/iter; left time: 1424.7288s
	iters: 300, epoch: 1 | loss: 0.3366409
	speed: 0.0983s/iter; left time: 1353.1751s
	iters: 400, epoch: 1 | loss: 0.0560068
	speed: 0.1035s/iter; left time: 1414.9104s
Epoch: 1 cost time: 51.25886940956116
Epoch: 1, Steps: 469 | Train Loss: 0.790 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
Validation loss decreased (inf --> -0.921953).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2398389
	speed: 0.4174s/iter; left time: 5636.1001s
	iters: 200, epoch: 2 | loss: 0.4353230
	speed: 0.1109s/iter; left time: 1485.8748s
	iters: 300, epoch: 2 | loss: 0.0378845
	speed: 0.1247s/iter; left time: 1658.7164s
	iters: 400, epoch: 2 | loss: 0.0310009
	speed: 0.1249s/iter; left time: 1648.6535s
Epoch: 2 cost time: 55.12839126586914
Epoch: 2, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (-0.921953 --> -0.965979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0366677
	speed: 0.5289s/iter; left time: 6893.6552s
	iters: 200, epoch: 3 | loss: 0.0210187
	speed: 0.1221s/iter; left time: 1579.6187s
	iters: 300, epoch: 3 | loss: 0.0134860
	speed: 0.1254s/iter; left time: 1609.8382s
	iters: 400, epoch: 3 | loss: 0.2548911
	speed: 0.1257s/iter; left time: 1600.6555s
Epoch: 3 cost time: 58.40779638290405
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1787997
	speed: 0.4738s/iter; left time: 5953.1270s
	iters: 200, epoch: 4 | loss: 0.0251626
	speed: 0.1145s/iter; left time: 1427.0569s
	iters: 300, epoch: 4 | loss: 0.0064450
	speed: 0.1144s/iter; left time: 1414.9516s
	iters: 400, epoch: 4 | loss: 0.0014605
	speed: 0.1214s/iter; left time: 1489.3127s
Epoch: 4 cost time: 56.33434009552002
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0299866
	speed: 0.4814s/iter; left time: 5822.8491s
	iters: 200, epoch: 5 | loss: 0.0461148
	speed: 0.1147s/iter; left time: 1375.6395s
	iters: 300, epoch: 5 | loss: 0.0042388
	speed: 0.1197s/iter; left time: 1424.2751s
	iters: 400, epoch: 5 | loss: 0.0033135
	speed: 0.1294s/iter; left time: 1526.3624s
Epoch: 5 cost time: 57.878599643707275
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.965979 --> -0.970268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0022832
	speed: 0.4446s/iter; left time: 5168.6132s
	iters: 200, epoch: 6 | loss: 0.0021059
	speed: 0.1123s/iter; left time: 1294.9012s
	iters: 300, epoch: 6 | loss: 0.0010898
	speed: 0.1190s/iter; left time: 1359.9557s
	iters: 400, epoch: 6 | loss: 0.0182370
	speed: 0.1063s/iter; left time: 1203.4205s
Epoch: 6 cost time: 50.88565731048584
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0290012
	speed: 0.4519s/iter; left time: 5041.4852s
	iters: 200, epoch: 7 | loss: 0.0267356
	speed: 0.0998s/iter; left time: 1103.3962s
	iters: 300, epoch: 7 | loss: 0.0036671
	speed: 0.0839s/iter; left time: 919.5192s
	iters: 400, epoch: 7 | loss: 0.0006342
	speed: 0.0917s/iter; left time: 995.6582s
Epoch: 7 cost time: 46.47546434402466
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.970268 --> -0.975128).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0023483
	speed: 0.3847s/iter; left time: 4112.1805s
	iters: 200, epoch: 8 | loss: 0.0024873
	speed: 0.0920s/iter; left time: 974.3745s
	iters: 300, epoch: 8 | loss: 0.0093012
	speed: 0.0855s/iter; left time: 896.3983s
	iters: 400, epoch: 8 | loss: 0.0066933
	speed: 0.0912s/iter; left time: 947.6806s
Epoch: 8 cost time: 43.67449879646301
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0100521
	speed: 0.3470s/iter; left time: 3546.3328s
	iters: 200, epoch: 9 | loss: 0.0042732
	speed: 0.1014s/iter; left time: 1026.2009s
	iters: 300, epoch: 9 | loss: 0.0014179
	speed: 0.1020s/iter; left time: 1021.5950s
	iters: 400, epoch: 9 | loss: 0.3808995
	speed: 0.1022s/iter; left time: 1014.1177s
Epoch: 9 cost time: 47.43567776679993
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0033241
	speed: 0.3944s/iter; left time: 3845.3534s
	iters: 200, epoch: 10 | loss: 0.0054516
	speed: 0.1143s/iter; left time: 1102.7991s
	iters: 300, epoch: 10 | loss: 0.0152508
	speed: 0.1080s/iter; left time: 1031.3000s
	iters: 400, epoch: 10 | loss: 0.0008370
	speed: 0.0933s/iter; left time: 881.7655s
Epoch: 10 cost time: 47.988208055496216
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.975128 --> -0.978844).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0008846
	speed: 0.4070s/iter; left time: 3777.5434s
	iters: 200, epoch: 11 | loss: 0.2476949
	speed: 0.1057s/iter; left time: 970.2913s
	iters: 300, epoch: 11 | loss: 0.0007952
	speed: 0.0938s/iter; left time: 851.9623s
	iters: 400, epoch: 11 | loss: 0.0037066
	speed: 0.0902s/iter; left time: 809.6546s
Epoch: 11 cost time: 46.393322229385376
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0968043
	speed: 0.4075s/iter; left time: 3591.0420s
	iters: 200, epoch: 12 | loss: 0.0008498
	speed: 0.0688s/iter; left time: 598.9550s
	iters: 300, epoch: 12 | loss: 0.0968930
	speed: 0.0849s/iter; left time: 731.1378s
	iters: 400, epoch: 12 | loss: 0.0009115
	speed: 0.1029s/iter; left time: 876.2709s
Epoch: 12 cost time: 43.239559173583984
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.981417).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1229700
	speed: 0.4323s/iter; left time: 3606.8378s
	iters: 200, epoch: 13 | loss: 0.0003192
	speed: 0.1104s/iter; left time: 910.2116s
	iters: 300, epoch: 13 | loss: 0.0028836
	speed: 0.1165s/iter; left time: 948.4436s
	iters: 400, epoch: 13 | loss: 0.0001348
	speed: 0.1100s/iter; left time: 884.4189s
Epoch: 13 cost time: 52.14327883720398
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981989).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0002408
	speed: 0.4275s/iter; left time: 3366.1050s
	iters: 200, epoch: 14 | loss: 0.0673771
	speed: 0.1231s/iter; left time: 957.0619s
	iters: 300, epoch: 14 | loss: 0.1634934
	speed: 0.1111s/iter; left time: 852.5679s
	iters: 400, epoch: 14 | loss: 0.0085779
	speed: 0.0989s/iter; left time: 748.8418s
Epoch: 14 cost time: 52.289146900177
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0019468
	speed: 0.4176s/iter; left time: 3091.9826s
	iters: 200, epoch: 15 | loss: 0.1876914
	speed: 0.1111s/iter; left time: 811.5755s
	iters: 300, epoch: 15 | loss: 0.0010103
	speed: 0.0998s/iter; left time: 719.0165s
	iters: 400, epoch: 15 | loss: 0.3256529
	speed: 0.1016s/iter; left time: 722.0498s
Epoch: 15 cost time: 50.97840642929077
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0011221
	speed: 0.4408s/iter; left time: 3057.5509s
	iters: 200, epoch: 16 | loss: 0.0020440
	speed: 0.1059s/iter; left time: 724.0859s
	iters: 300, epoch: 16 | loss: 0.0014059
	speed: 0.1051s/iter; left time: 708.2383s
	iters: 400, epoch: 16 | loss: 0.0081759
	speed: 0.1124s/iter; left time: 745.9899s
Epoch: 16 cost time: 51.19906568527222
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0012572
	speed: 0.3953s/iter; left time: 2556.5020s
	iters: 200, epoch: 17 | loss: 0.0010309
	speed: 0.0893s/iter; left time: 568.3449s
	iters: 300, epoch: 17 | loss: 0.0002793
	speed: 0.1046s/iter; left time: 655.3368s
	iters: 400, epoch: 17 | loss: 0.0001625
	speed: 0.0958s/iter; left time: 590.5916s
Epoch: 17 cost time: 44.51074409484863
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001586
	speed: 0.3775s/iter; left time: 2264.2175s
	iters: 200, epoch: 18 | loss: 0.0080350
	speed: 0.0995s/iter; left time: 586.8300s
	iters: 300, epoch: 18 | loss: 0.0029511
	speed: 0.0730s/iter; left time: 423.0865s
	iters: 400, epoch: 18 | loss: 0.0001218
	speed: 0.0731s/iter; left time: 416.7760s
Epoch: 18 cost time: 39.741008043289185
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4703645
	speed: 0.3242s/iter; left time: 1792.5343s
	iters: 200, epoch: 19 | loss: 0.1698892
	speed: 0.0601s/iter; left time: 326.3654s
	iters: 300, epoch: 19 | loss: 0.0003760
	speed: 0.0724s/iter; left time: 385.7137s
	iters: 400, epoch: 19 | loss: 0.0314992
	speed: 0.0837s/iter; left time: 437.7793s
Epoch: 19 cost time: 36.419447898864746
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0006574
	speed: 0.3652s/iter; left time: 1847.7493s
	iters: 200, epoch: 20 | loss: 0.0017514
	speed: 0.0858s/iter; left time: 425.4622s
	iters: 300, epoch: 20 | loss: 0.0002760
	speed: 0.0880s/iter; left time: 427.5251s
	iters: 400, epoch: 20 | loss: 0.0000629
	speed: 0.0872s/iter; left time: 415.1472s
Epoch: 20 cost time: 40.091373443603516
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0145563
	speed: 0.3682s/iter; left time: 1690.2818s
	iters: 200, epoch: 21 | loss: 0.0002513
	speed: 0.0928s/iter; left time: 416.7498s
	iters: 300, epoch: 21 | loss: 0.0007772
	speed: 0.0945s/iter; left time: 414.8498s
	iters: 400, epoch: 21 | loss: 0.0004804
	speed: 0.0876s/iter; left time: 375.8096s
Epoch: 21 cost time: 44.48908185958862
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0004237
	speed: 0.4026s/iter; left time: 1659.6695s
	iters: 200, epoch: 22 | loss: 0.0064795
	speed: 0.0923s/iter; left time: 371.3371s
	iters: 300, epoch: 22 | loss: 0.0001313
	speed: 0.0983s/iter; left time: 385.6858s
	iters: 400, epoch: 22 | loss: 0.0009509
	speed: 0.0984s/iter; left time: 375.9310s
Epoch: 22 cost time: 43.812018156051636
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0009418
	speed: 0.3232s/iter; left time: 1180.5284s
	iters: 200, epoch: 23 | loss: 0.0001021
	speed: 0.0879s/iter; left time: 312.3068s
	iters: 300, epoch: 23 | loss: 0.0026353
	speed: 0.1044s/iter; left time: 360.4656s
	iters: 400, epoch: 23 | loss: 0.0023118
	speed: 0.1004s/iter; left time: 336.6376s
Epoch: 23 cost time: 44.371965169906616
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 3519050
model size : 14.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4740722
	speed: 0.0920s/iter; left time: 1284.6959s
	iters: 200, epoch: 1 | loss: 0.8973320
	speed: 0.0772s/iter; left time: 1071.3649s
	iters: 300, epoch: 1 | loss: 0.3271427
	speed: 0.0820s/iter; left time: 1129.2413s
	iters: 400, epoch: 1 | loss: 0.4108426
	speed: 0.0930s/iter; left time: 1272.0339s
Epoch: 1 cost time: 40.63687443733215
Epoch: 1, Steps: 469 | Train Loss: 0.855 Vali Loss: 0.241 Vali Acc: 0.934 Test Loss: 0.241 Test Acc: 0.934
Validation loss decreased (inf --> -0.933674).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0577895
	speed: 0.3504s/iter; left time: 4730.5693s
	iters: 200, epoch: 2 | loss: 0.0915498
	speed: 0.0895s/iter; left time: 1199.5221s
	iters: 300, epoch: 2 | loss: 0.0713579
	speed: 0.0894s/iter; left time: 1189.4517s
	iters: 400, epoch: 2 | loss: 0.0132817
	speed: 0.0924s/iter; left time: 1219.9623s
Epoch: 2 cost time: 41.761024475097656
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.933674 --> -0.968552).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0431886
	speed: 0.3835s/iter; left time: 4998.6925s
	iters: 200, epoch: 3 | loss: 0.5049137
	speed: 0.0938s/iter; left time: 1213.3932s
	iters: 300, epoch: 3 | loss: 0.0159419
	speed: 0.0895s/iter; left time: 1148.0051s
	iters: 400, epoch: 3 | loss: 0.0700987
	speed: 0.0793s/iter; left time: 1009.3388s
Epoch: 3 cost time: 41.83516192436218
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0278275
	speed: 0.3912s/iter; left time: 4914.9789s
	iters: 200, epoch: 4 | loss: 0.0217312
	speed: 0.0915s/iter; left time: 1140.7637s
	iters: 300, epoch: 4 | loss: 0.0027537
	speed: 0.0796s/iter; left time: 983.9863s
	iters: 400, epoch: 4 | loss: 0.0026885
	speed: 0.0780s/iter; left time: 956.0935s
Epoch: 4 cost time: 40.22905611991882
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.968552 --> -0.981131).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0987623
	speed: 0.3992s/iter; left time: 4828.7369s
	iters: 200, epoch: 5 | loss: 0.0218743
	speed: 0.0821s/iter; left time: 984.7985s
	iters: 300, epoch: 5 | loss: 0.0484399
	speed: 0.0727s/iter; left time: 865.2698s
	iters: 400, epoch: 5 | loss: 0.0481663
	speed: 0.0617s/iter; left time: 727.9376s
Epoch: 5 cost time: 35.83853101730347
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0107753
	speed: 0.3625s/iter; left time: 4214.2950s
	iters: 200, epoch: 6 | loss: 0.0036207
	speed: 0.0705s/iter; left time: 812.4206s
	iters: 300, epoch: 6 | loss: 0.0104797
	speed: 0.0741s/iter; left time: 846.4576s
	iters: 400, epoch: 6 | loss: 0.0007479
	speed: 0.0756s/iter; left time: 856.7085s
Epoch: 6 cost time: 35.70288038253784
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0080590
	speed: 0.3443s/iter; left time: 3841.8807s
	iters: 200, epoch: 7 | loss: 0.0054874
	speed: 0.0636s/iter; left time: 702.7359s
	iters: 300, epoch: 7 | loss: 0.0041928
	speed: 0.0685s/iter; left time: 750.3820s
	iters: 400, epoch: 7 | loss: 0.0006468
	speed: 0.0793s/iter; left time: 861.1441s
Epoch: 7 cost time: 33.297441720962524
Epoch: 7, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0121362
	speed: 0.3088s/iter; left time: 3300.0785s
	iters: 200, epoch: 8 | loss: 0.0017541
	speed: 0.0610s/iter; left time: 645.7522s
	iters: 300, epoch: 8 | loss: 0.0018699
	speed: 0.0809s/iter; left time: 848.8197s
	iters: 400, epoch: 8 | loss: 0.1968710
	speed: 0.0812s/iter; left time: 843.7848s
Epoch: 8 cost time: 33.528202056884766
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0057362
	speed: 0.3198s/iter; left time: 3268.1517s
	iters: 200, epoch: 9 | loss: 0.0016133
	speed: 0.0834s/iter; left time: 843.5547s
	iters: 300, epoch: 9 | loss: 0.0011494
	speed: 0.0763s/iter; left time: 764.4359s
	iters: 400, epoch: 9 | loss: 0.0012971
	speed: 0.0749s/iter; left time: 742.5486s
Epoch: 9 cost time: 35.55430555343628
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0435655
	speed: 0.3242s/iter; left time: 3160.8435s
	iters: 200, epoch: 10 | loss: 0.0007743
	speed: 0.0775s/iter; left time: 747.8362s
	iters: 300, epoch: 10 | loss: 0.0597679
	speed: 0.0733s/iter; left time: 700.0136s
	iters: 400, epoch: 10 | loss: 0.0081650
	speed: 0.0719s/iter; left time: 679.2308s
Epoch: 10 cost time: 35.2247896194458
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0144235
	speed: 0.3204s/iter; left time: 2973.9377s
	iters: 200, epoch: 11 | loss: 0.0314477
	speed: 0.0742s/iter; left time: 681.4042s
	iters: 300, epoch: 11 | loss: 0.0004823
	speed: 0.0655s/iter; left time: 594.9706s
	iters: 400, epoch: 11 | loss: 0.0013588
	speed: 0.0659s/iter; left time: 591.9414s
Epoch: 11 cost time: 31.684343576431274
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0020242
	speed: 0.2836s/iter; left time: 2499.4468s
	iters: 200, epoch: 12 | loss: 0.0007101
	speed: 0.0564s/iter; left time: 491.3050s
	iters: 300, epoch: 12 | loss: 0.0048294
	speed: 0.0589s/iter; left time: 506.9822s
	iters: 400, epoch: 12 | loss: 0.0003419
	speed: 0.0612s/iter; left time: 520.5315s
Epoch: 12 cost time: 27.489351272583008
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.974 Test Loss: 0.083 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0028698
	speed: 0.3250s/iter; left time: 2711.5339s
	iters: 200, epoch: 13 | loss: 0.0018876
	speed: 0.0770s/iter; left time: 635.0315s
	iters: 300, epoch: 13 | loss: 0.0002727
	speed: 0.0777s/iter; left time: 632.5022s
	iters: 400, epoch: 13 | loss: 0.0003230
	speed: 0.0705s/iter; left time: 566.9457s
Epoch: 13 cost time: 35.03096389770508
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0019243
	speed: 0.3681s/iter; left time: 2898.4722s
	iters: 200, epoch: 14 | loss: 0.0001893
	speed: 0.0885s/iter; left time: 687.6806s
	iters: 300, epoch: 14 | loss: 0.0026530
	speed: 0.0877s/iter; left time: 673.0325s
	iters: 400, epoch: 14 | loss: 0.0836953
	speed: 0.0868s/iter; left time: 657.7273s
Epoch: 14 cost time: 41.21259307861328
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 1036298
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1072000
	speed: 0.3375s/iter; left time: 4714.5253s
	iters: 200, epoch: 1 | loss: 0.5828833
	speed: 0.3073s/iter; left time: 4261.9421s
	iters: 300, epoch: 1 | loss: 0.2361410
	speed: 0.3279s/iter; left time: 4515.1301s
	iters: 400, epoch: 1 | loss: 0.3150279
	speed: 0.2875s/iter; left time: 3930.6448s
Epoch: 1 cost time: 145.97627425193787
Epoch: 1, Steps: 469 | Train Loss: 0.753 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
Validation loss decreased (inf --> -0.955401).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1701402
	speed: 0.7356s/iter; left time: 9932.3139s
	iters: 200, epoch: 2 | loss: 0.1995290
	speed: 0.2753s/iter; left time: 3689.4912s
	iters: 300, epoch: 2 | loss: 0.0820826
	speed: 0.2640s/iter; left time: 3511.7350s
	iters: 400, epoch: 2 | loss: 0.0240929
	speed: 0.2080s/iter; left time: 2745.8491s
Epoch: 2 cost time: 110.95536684989929
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.955401 --> -0.973698).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0667306
	speed: 0.5439s/iter; left time: 7088.6986s
	iters: 200, epoch: 3 | loss: 0.0889998
	speed: 0.2195s/iter; left time: 2838.5573s
	iters: 300, epoch: 3 | loss: 0.0365394
	speed: 0.2042s/iter; left time: 2620.7080s
	iters: 400, epoch: 3 | loss: 0.0133398
	speed: 0.2112s/iter; left time: 2688.8002s
Epoch: 3 cost time: 96.68194389343262
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0287397
	speed: 0.5920s/iter; left time: 7437.6050s
	iters: 200, epoch: 4 | loss: 0.0064966
	speed: 0.1781s/iter; left time: 2220.1782s
	iters: 300, epoch: 4 | loss: 0.0199072
	speed: 0.1683s/iter; left time: 2080.8134s
	iters: 400, epoch: 4 | loss: 0.1654234
	speed: 0.1795s/iter; left time: 2201.8358s
Epoch: 4 cost time: 82.87185144424438
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.973698 --> -0.979416).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0925433
	speed: 0.6215s/iter; left time: 7517.2308s
	iters: 200, epoch: 5 | loss: 0.0062043
	speed: 0.2588s/iter; left time: 3104.1542s
	iters: 300, epoch: 5 | loss: 0.0305344
	speed: 0.2652s/iter; left time: 3154.1219s
	iters: 400, epoch: 5 | loss: 0.0769866
	speed: 0.2912s/iter; left time: 3434.9755s
Epoch: 5 cost time: 126.697762966156
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0017454
	speed: 0.7476s/iter; left time: 8691.2486s
	iters: 200, epoch: 6 | loss: 0.0036188
	speed: 0.2431s/iter; left time: 2801.8556s
	iters: 300, epoch: 6 | loss: 0.0028532
	speed: 0.2698s/iter; left time: 3082.7123s
	iters: 400, epoch: 6 | loss: 0.0188426
	speed: 0.2701s/iter; left time: 3058.9431s
Epoch: 6 cost time: 122.69378399848938
Epoch: 6, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2369217
	speed: 0.7461s/iter; left time: 8324.1991s
	iters: 200, epoch: 7 | loss: 0.0014348
	speed: 0.4576s/iter; left time: 5060.0026s
	iters: 300, epoch: 7 | loss: 0.1457550
	speed: 0.4671s/iter; left time: 5117.7458s
	iters: 400, epoch: 7 | loss: 0.0004372
	speed: 0.3868s/iter; left time: 4199.1801s
Epoch: 7 cost time: 189.4018497467041
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0011754
	speed: 1.0611s/iter; left time: 11340.9675s
	iters: 200, epoch: 8 | loss: 0.0069997
	speed: 0.4059s/iter; left time: 4297.2893s
	iters: 300, epoch: 8 | loss: 0.0070343
	speed: 0.3971s/iter; left time: 4164.9037s
	iters: 400, epoch: 8 | loss: 0.0104079
	speed: 0.4057s/iter; left time: 4214.6900s
Epoch: 8 cost time: 191.27763032913208
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0004155
	speed: 1.0325s/iter; left time: 10551.3230s
	iters: 200, epoch: 9 | loss: 0.0068516
	speed: 0.3779s/iter; left time: 3823.6380s
	iters: 300, epoch: 9 | loss: 0.5054491
	speed: 0.3824s/iter; left time: 3831.1434s
	iters: 400, epoch: 9 | loss: 0.0021242
	speed: 0.3915s/iter; left time: 3883.2877s
Epoch: 9 cost time: 183.3370440006256
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2790247
	speed: 1.1394s/iter; left time: 11109.5788s
	iters: 200, epoch: 10 | loss: 0.0153157
	speed: 0.4342s/iter; left time: 4189.5846s
	iters: 300, epoch: 10 | loss: 0.0025287
	speed: 0.4381s/iter; left time: 4183.6856s
	iters: 400, epoch: 10 | loss: 0.0017421
	speed: 0.3554s/iter; left time: 3358.9129s
Epoch: 10 cost time: 193.08438539505005
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.981417).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0009784
	speed: 1.0587s/iter; left time: 9825.9969s
	iters: 200, epoch: 11 | loss: 0.0008173
	speed: 0.3957s/iter; left time: 3633.1116s
	iters: 300, epoch: 11 | loss: 0.0005513
	speed: 0.4004s/iter; left time: 3635.9338s
	iters: 400, epoch: 11 | loss: 0.0240052
	speed: 0.3943s/iter; left time: 3541.6503s
Epoch: 11 cost time: 188.79839301109314
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.981417 --> -0.983704).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1510344
	speed: 1.0415s/iter; left time: 9177.6817s
	iters: 200, epoch: 12 | loss: 0.0002801
	speed: 0.3536s/iter; left time: 3080.6630s
	iters: 300, epoch: 12 | loss: 0.0016772
	speed: 0.1764s/iter; left time: 1519.1867s
	iters: 400, epoch: 12 | loss: 0.0014667
	speed: 0.3437s/iter; left time: 2925.1688s
Epoch: 12 cost time: 153.3157603740692
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0189919
	speed: 1.2755s/iter; left time: 10641.9029s
	iters: 200, epoch: 13 | loss: 0.0018008
	speed: 0.5313s/iter; left time: 4379.8190s
	iters: 300, epoch: 13 | loss: 0.0037731
	speed: 0.5448s/iter; left time: 4436.6359s
	iters: 400, epoch: 13 | loss: 0.0077657
	speed: 0.5443s/iter; left time: 4377.6084s
Epoch: 13 cost time: 253.82087206840515
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1178325
	speed: 1.3852s/iter; left time: 10906.9437s
	iters: 200, epoch: 14 | loss: 0.0712183
	speed: 0.5316s/iter; left time: 4132.8428s
	iters: 300, epoch: 14 | loss: 0.0007654
	speed: 0.5317s/iter; left time: 4080.4584s
	iters: 400, epoch: 14 | loss: 0.0020630
	speed: 0.5757s/iter; left time: 4360.4972s
Epoch: 14 cost time: 256.7325932979584
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0021647
	speed: 1.5165s/iter; left time: 11229.7580s
	iters: 200, epoch: 15 | loss: 0.0001389
	speed: 0.5862s/iter; left time: 4282.5117s
	iters: 300, epoch: 15 | loss: 0.0021030
	speed: 0.5235s/iter; left time: 3771.9423s
	iters: 400, epoch: 15 | loss: 0.0001564
	speed: 0.5649s/iter; left time: 4013.5888s
Epoch: 15 cost time: 265.4666476249695
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0003146
	speed: 1.4393s/iter; left time: 9983.2247s
	iters: 200, epoch: 16 | loss: 0.0004115
	speed: 0.5525s/iter; left time: 3776.8391s
	iters: 300, epoch: 16 | loss: 0.0094185
	speed: 0.5471s/iter; left time: 3685.1459s
	iters: 400, epoch: 16 | loss: 0.0012895
	speed: 0.4952s/iter; left time: 3286.0032s
Epoch: 16 cost time: 251.9089789390564
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0079522
	speed: 1.4496s/iter; left time: 9374.3473s
	iters: 200, epoch: 17 | loss: 0.0005559
	speed: 0.5352s/iter; left time: 3407.6508s
	iters: 300, epoch: 17 | loss: 0.2754185
	speed: 0.5374s/iter; left time: 3367.7963s
	iters: 400, epoch: 17 | loss: 0.0001951
	speed: 0.5391s/iter; left time: 3324.6623s
Epoch: 17 cost time: 254.69387769699097
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001746
	speed: 1.3687s/iter; left time: 8209.4218s
	iters: 200, epoch: 18 | loss: 0.0021292
	speed: 0.5261s/iter; left time: 3103.0039s
	iters: 300, epoch: 18 | loss: 0.0007258
	speed: 0.4446s/iter; left time: 2577.9376s
	iters: 400, epoch: 18 | loss: 0.0040454
	speed: 0.4841s/iter; left time: 2758.6847s
Epoch: 18 cost time: 230.56973457336426
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0004386
	speed: 1.2595s/iter; left time: 6963.9312s
	iters: 200, epoch: 19 | loss: 0.0018881
	speed: 0.5055s/iter; left time: 2744.3702s
	iters: 300, epoch: 19 | loss: 0.0016176
	speed: 0.5524s/iter; left time: 2943.9140s
	iters: 400, epoch: 19 | loss: 0.0000414
	speed: 0.5543s/iter; left time: 2898.6464s
Epoch: 19 cost time: 246.14698958396912
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0004140
	speed: 1.4449s/iter; left time: 7311.0647s
	iters: 200, epoch: 20 | loss: 0.0000917
	speed: 0.5734s/iter; left time: 2844.0140s
	iters: 300, epoch: 20 | loss: 0.0036362
	speed: 0.5775s/iter; left time: 2806.6746s
	iters: 400, epoch: 20 | loss: 0.0048563
	speed: 0.5751s/iter; left time: 2737.2468s
Epoch: 20 cost time: 271.04744362831116
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0003486
	speed: 1.4639s/iter; left time: 6720.9862s
	iters: 200, epoch: 21 | loss: 0.0006878
	speed: 0.5718s/iter; left time: 2567.7732s
	iters: 300, epoch: 21 | loss: 0.0008781
	speed: 0.5716s/iter; left time: 2509.7416s
	iters: 400, epoch: 21 | loss: 0.0027413
	speed: 0.5647s/iter; left time: 2422.9227s
Epoch: 21 cost time: 265.8316423892975
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 1761290
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4580905
	speed: 0.3089s/iter; left time: 4315.1937s
	iters: 200, epoch: 1 | loss: 0.5307468
	speed: 0.2949s/iter; left time: 4090.7894s
	iters: 300, epoch: 1 | loss: 0.5453744
	speed: 0.2921s/iter; left time: 4022.9620s
	iters: 400, epoch: 1 | loss: 0.0569152
	speed: 0.2920s/iter; left time: 3992.1779s
Epoch: 1 cost time: 139.25057220458984
Epoch: 1, Steps: 469 | Train Loss: 0.789 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
Validation loss decreased (inf --> -0.952542).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0305382
	speed: 0.8699s/iter; left time: 11745.1770s
	iters: 200, epoch: 2 | loss: 0.0415515
	speed: 0.2928s/iter; left time: 3924.7407s
	iters: 300, epoch: 2 | loss: 0.0385197
	speed: 0.2960s/iter; left time: 3936.9375s
	iters: 400, epoch: 2 | loss: 0.0142277
	speed: 0.2856s/iter; left time: 3770.7036s
Epoch: 2 cost time: 137.3141450881958
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.952542 --> -0.973984).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0294534
	speed: 0.8336s/iter; left time: 10864.8546s
	iters: 200, epoch: 3 | loss: 0.0308151
	speed: 0.2767s/iter; left time: 3578.4785s
	iters: 300, epoch: 3 | loss: 0.0109006
	speed: 0.2883s/iter; left time: 3700.3539s
	iters: 400, epoch: 3 | loss: 0.0096988
	speed: 0.2801s/iter; left time: 3567.1084s
Epoch: 3 cost time: 129.109477519989
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.977415).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0049403
	speed: 0.8480s/iter; left time: 10654.4730s
	iters: 200, epoch: 4 | loss: 0.0107368
	speed: 0.2864s/iter; left time: 3569.7323s
	iters: 300, epoch: 4 | loss: 0.0201083
	speed: 0.2917s/iter; left time: 3605.9699s
	iters: 400, epoch: 4 | loss: 0.0186665
	speed: 0.3091s/iter; left time: 3790.8981s
Epoch: 4 cost time: 137.64487051963806
Epoch: 4, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0016795
	speed: 0.8783s/iter; left time: 10623.1667s
	iters: 200, epoch: 5 | loss: 0.0142877
	speed: 0.3149s/iter; left time: 3777.0719s
	iters: 300, epoch: 5 | loss: 0.0064215
	speed: 0.3103s/iter; left time: 3691.3860s
	iters: 400, epoch: 5 | loss: 0.0144565
	speed: 0.3135s/iter; left time: 3697.2568s
Epoch: 5 cost time: 146.332585811615
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0050587
	speed: 0.9351s/iter; left time: 10871.1143s
	iters: 200, epoch: 6 | loss: 0.0510310
	speed: 0.3195s/iter; left time: 3682.1265s
	iters: 300, epoch: 6 | loss: 0.0220842
	speed: 0.3267s/iter; left time: 3732.5970s
	iters: 400, epoch: 6 | loss: 0.0050263
	speed: 0.3178s/iter; left time: 3599.6846s
Epoch: 6 cost time: 150.64139676094055
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.981131).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008389
	speed: 0.9531s/iter; left time: 10634.0714s
	iters: 200, epoch: 7 | loss: 0.0041487
	speed: 0.3175s/iter; left time: 3510.0479s
	iters: 300, epoch: 7 | loss: 0.0619817
	speed: 0.3119s/iter; left time: 3417.6931s
	iters: 400, epoch: 7 | loss: 0.0262190
	speed: 0.3247s/iter; left time: 3525.0555s
Epoch: 7 cost time: 149.62771725654602
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0011902
	speed: 0.9524s/iter; left time: 10178.8805s
	iters: 200, epoch: 8 | loss: 0.0084772
	speed: 0.3145s/iter; left time: 3330.1791s
	iters: 300, epoch: 8 | loss: 0.1188079
	speed: 0.3115s/iter; left time: 3267.4798s
	iters: 400, epoch: 8 | loss: 0.0029147
	speed: 0.3242s/iter; left time: 3367.7016s
Epoch: 8 cost time: 150.72235941886902
Epoch: 8, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0013830
	speed: 0.9497s/iter; left time: 9705.1562s
	iters: 200, epoch: 9 | loss: 0.0019386
	speed: 0.3136s/iter; left time: 3172.8161s
	iters: 300, epoch: 9 | loss: 0.0005094
	speed: 0.3034s/iter; left time: 3039.5976s
	iters: 400, epoch: 9 | loss: 0.0018940
	speed: 0.3107s/iter; left time: 3081.5787s
Epoch: 9 cost time: 142.00594806671143
Epoch: 9, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003990
	speed: 0.8655s/iter; left time: 8438.5861s
	iters: 200, epoch: 10 | loss: 0.0007931
	speed: 0.2929s/iter; left time: 2826.7768s
	iters: 300, epoch: 10 | loss: 0.0068875
	speed: 0.3088s/iter; left time: 2949.0768s
	iters: 400, epoch: 10 | loss: 0.0013027
	speed: 0.3005s/iter; left time: 2839.5364s
Epoch: 10 cost time: 141.4423704147339
Epoch: 10, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0029069
	speed: 0.9003s/iter; left time: 8355.9181s
	iters: 200, epoch: 11 | loss: 0.0005660
	speed: 0.2580s/iter; left time: 2369.0502s
	iters: 300, epoch: 11 | loss: 0.0005639
	speed: 0.3199s/iter; left time: 2905.3734s
	iters: 400, epoch: 11 | loss: 0.0072149
	speed: 0.2939s/iter; left time: 2639.4618s
Epoch: 11 cost time: 137.837256193161
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0004757
	speed: 0.8997s/iter; left time: 7928.5621s
	iters: 200, epoch: 12 | loss: 0.0063545
	speed: 0.3111s/iter; left time: 2710.4900s
	iters: 300, epoch: 12 | loss: 0.0103504
	speed: 0.3034s/iter; left time: 2612.6057s
	iters: 400, epoch: 12 | loss: 0.0004230
	speed: 0.3306s/iter; left time: 2813.9479s
Epoch: 12 cost time: 147.74245190620422
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.982847).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0008792
	speed: 0.9213s/iter; left time: 7686.0462s
	iters: 200, epoch: 13 | loss: 0.0015930
	speed: 0.3164s/iter; left time: 2608.1988s
	iters: 300, epoch: 13 | loss: 0.2311629
	speed: 0.3139s/iter; left time: 2555.8559s
	iters: 400, epoch: 13 | loss: 0.0578204
	speed: 0.3298s/iter; left time: 2652.7999s
Epoch: 13 cost time: 145.08372402191162
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0089323
	speed: 0.9499s/iter; left time: 7479.7558s
	iters: 200, epoch: 14 | loss: 0.0000966
	speed: 0.3067s/iter; left time: 2383.9087s
	iters: 300, epoch: 14 | loss: 0.0229449
	speed: 0.3172s/iter; left time: 2433.9150s
	iters: 400, epoch: 14 | loss: 0.0383777
	speed: 0.3413s/iter; left time: 2584.7423s
Epoch: 14 cost time: 152.6088125705719
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1088362
	speed: 1.0311s/iter; left time: 7635.1832s
	iters: 200, epoch: 15 | loss: 0.0001495
	speed: 0.3467s/iter; left time: 2532.3252s
	iters: 300, epoch: 15 | loss: 0.0006219
	speed: 0.3409s/iter; left time: 2456.3322s
	iters: 400, epoch: 15 | loss: 0.3579915
	speed: 0.3301s/iter; left time: 2345.4604s
Epoch: 15 cost time: 157.95472502708435
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0030461
	speed: 0.9649s/iter; left time: 6692.7642s
	iters: 200, epoch: 16 | loss: 0.0002081
	speed: 0.3362s/iter; left time: 2298.0790s
	iters: 300, epoch: 16 | loss: 0.0747879
	speed: 0.3198s/iter; left time: 2153.9953s
	iters: 400, epoch: 16 | loss: 0.0003832
	speed: 0.3279s/iter; left time: 2175.9506s
Epoch: 16 cost time: 153.23223614692688
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0021083
	speed: 0.9466s/iter; left time: 6121.6128s
	iters: 200, epoch: 17 | loss: 0.0019681
	speed: 0.3012s/iter; left time: 1917.6347s
	iters: 300, epoch: 17 | loss: 0.0025433
	speed: 0.3151s/iter; left time: 1974.7633s
	iters: 400, epoch: 17 | loss: 0.0015912
	speed: 0.3085s/iter; left time: 1902.4906s
Epoch: 17 cost time: 145.82866430282593
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0094384
	speed: 0.9130s/iter; left time: 5476.4034s
	iters: 200, epoch: 18 | loss: 0.0001827
	speed: 0.3126s/iter; left time: 1843.5415s
	iters: 300, epoch: 18 | loss: 0.0025752
	speed: 0.3007s/iter; left time: 1743.7077s
	iters: 400, epoch: 18 | loss: 0.0007812
	speed: 0.3042s/iter; left time: 1733.4270s
Epoch: 18 cost time: 143.00067687034607
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001466
	speed: 0.9064s/iter; left time: 5011.3430s
	iters: 200, epoch: 19 | loss: 0.0001608
	speed: 0.2913s/iter; left time: 1581.5799s
	iters: 300, epoch: 19 | loss: 0.0001501
	speed: 0.3125s/iter; left time: 1665.4245s
	iters: 400, epoch: 19 | loss: 0.0001449
	speed: 0.2925s/iter; left time: 1529.5246s
Epoch: 19 cost time: 136.90123009681702
Epoch: 19, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0004986
	speed: 0.8080s/iter; left time: 4088.3772s
	iters: 200, epoch: 20 | loss: 0.0024118
	speed: 0.2932s/iter; left time: 1454.4951s
	iters: 300, epoch: 20 | loss: 0.0048371
	speed: 0.3055s/iter; left time: 1484.7889s
	iters: 400, epoch: 20 | loss: 0.0006581
	speed: 0.3228s/iter; left time: 1536.6932s
Epoch: 20 cost time: 141.87052059173584
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0003143
	speed: 0.9468s/iter; left time: 4346.6170s
	iters: 200, epoch: 21 | loss: 0.0000768
	speed: 0.3163s/iter; left time: 1420.5228s
	iters: 300, epoch: 21 | loss: 0.0002845
	speed: 0.3252s/iter; left time: 1427.8492s
	iters: 400, epoch: 21 | loss: 0.0001328
	speed: 0.3188s/iter; left time: 1368.1482s
Epoch: 21 cost time: 151.2966718673706
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.1607753
	speed: 0.9588s/iter; left time: 3952.3090s
	iters: 200, epoch: 22 | loss: 0.0004889
	speed: 0.3100s/iter; left time: 1246.8353s
	iters: 300, epoch: 22 | loss: 0.0017219
	speed: 0.3139s/iter; left time: 1231.0182s
	iters: 400, epoch: 22 | loss: 0.0013796
	speed: 0.3182s/iter; left time: 1216.1226s
Epoch: 22 cost time: 148.10143423080444
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 519818
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1190510
	speed: 0.4158s/iter; left time: 5808.9159s
	iters: 200, epoch: 1 | loss: 0.5857844
	speed: 0.3839s/iter; left time: 5325.4650s
	iters: 300, epoch: 1 | loss: 0.2186065
	speed: 0.3687s/iter; left time: 5077.4524s
	iters: 400, epoch: 1 | loss: 0.2992170
	speed: 0.4075s/iter; left time: 5570.3727s
Epoch: 1 cost time: 186.52036690711975
Epoch: 1, Steps: 469 | Train Loss: 0.765 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (inf --> -0.947682).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1612463
	speed: 1.1090s/iter; left time: 14973.2648s
	iters: 200, epoch: 2 | loss: 0.2078077
	speed: 0.4063s/iter; left time: 5445.2564s
	iters: 300, epoch: 2 | loss: 0.0509702
	speed: 0.3911s/iter; left time: 5202.6804s
	iters: 400, epoch: 2 | loss: 0.0215604
	speed: 0.3841s/iter; left time: 5070.9580s
Epoch: 2 cost time: 185.68170046806335
Epoch: 2, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.947682 --> -0.973127).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0331654
	speed: 1.0498s/iter; left time: 13681.5490s
	iters: 200, epoch: 3 | loss: 0.1604157
	speed: 0.3745s/iter; left time: 4843.4141s
	iters: 300, epoch: 3 | loss: 0.0802751
	speed: 0.3870s/iter; left time: 4966.2508s
	iters: 400, epoch: 3 | loss: 0.0093003
	speed: 0.3690s/iter; left time: 4698.7351s
Epoch: 3 cost time: 178.19709992408752
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0153662
	speed: 1.0484s/iter; left time: 13171.7763s
	iters: 200, epoch: 4 | loss: 0.0125517
	speed: 0.3756s/iter; left time: 4681.8680s
	iters: 300, epoch: 4 | loss: 0.0151690
	speed: 0.3928s/iter; left time: 4856.4050s
	iters: 400, epoch: 4 | loss: 0.1882109
	speed: 0.3926s/iter; left time: 4814.5866s
Epoch: 4 cost time: 181.63383221626282
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.973127 --> -0.976843).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0074893
	speed: 0.9992s/iter; left time: 12085.0125s
	iters: 200, epoch: 5 | loss: 0.0022979
	speed: 0.3749s/iter; left time: 4497.4247s
	iters: 300, epoch: 5 | loss: 0.0356317
	speed: 0.3803s/iter; left time: 4524.1178s
	iters: 400, epoch: 5 | loss: 0.0064329
	speed: 0.4085s/iter; left time: 4818.1759s
Epoch: 5 cost time: 175.99303078651428
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0038201
	speed: 1.0805s/iter; left time: 12562.4252s
	iters: 200, epoch: 6 | loss: 0.0090146
	speed: 0.3996s/iter; left time: 4605.7576s
	iters: 300, epoch: 6 | loss: 0.0019745
	speed: 0.3842s/iter; left time: 4389.7559s
	iters: 400, epoch: 6 | loss: 0.0284301
	speed: 0.3752s/iter; left time: 4249.9357s
Epoch: 6 cost time: 179.91953301429749
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977415).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0092243
	speed: 0.9984s/iter; left time: 11138.5937s
	iters: 200, epoch: 7 | loss: 0.0010016
	speed: 0.3849s/iter; left time: 4255.3786s
	iters: 300, epoch: 7 | loss: 0.3229142
	speed: 0.3928s/iter; left time: 4303.9855s
	iters: 400, epoch: 7 | loss: 0.0004181
	speed: 0.3879s/iter; left time: 4211.7266s
Epoch: 7 cost time: 178.15493488311768
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0051784
	speed: 1.0925s/iter; left time: 11676.4668s
	iters: 200, epoch: 8 | loss: 0.0077351
	speed: 0.3957s/iter; left time: 4190.0672s
	iters: 300, epoch: 8 | loss: 0.0249876
	speed: 0.3980s/iter; left time: 4173.9373s
	iters: 400, epoch: 8 | loss: 0.0022375
	speed: 0.4019s/iter; left time: 4174.8774s
Epoch: 8 cost time: 186.50425601005554
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003393
	speed: 1.0599s/iter; left time: 10831.3635s
	iters: 200, epoch: 9 | loss: 0.0050546
	speed: 0.3523s/iter; left time: 3565.2211s
	iters: 300, epoch: 9 | loss: 0.0100697
	speed: 0.2929s/iter; left time: 2934.7844s
	iters: 400, epoch: 9 | loss: 0.0037054
	speed: 0.3167s/iter; left time: 3141.1302s
Epoch: 9 cost time: 156.2639663219452
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0264197
	speed: 0.9229s/iter; left time: 8998.3172s
	iters: 200, epoch: 10 | loss: 0.0039232
	speed: 0.3246s/iter; left time: 3132.4224s
	iters: 300, epoch: 10 | loss: 0.0024432
	speed: 0.3109s/iter; left time: 2969.0473s
	iters: 400, epoch: 10 | loss: 0.0010614
	speed: 0.3521s/iter; left time: 3327.7322s
Epoch: 10 cost time: 157.40020847320557
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.982275).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0076646
	speed: 1.0187s/iter; left time: 9454.1872s
	iters: 200, epoch: 11 | loss: 0.0008285
	speed: 0.3692s/iter; left time: 3389.9597s
	iters: 300, epoch: 11 | loss: 0.0006264
	speed: 0.3762s/iter; left time: 3415.9279s
	iters: 400, epoch: 11 | loss: 0.0024080
	speed: 0.3648s/iter; left time: 3276.0299s
Epoch: 11 cost time: 173.95522260665894
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3605640
	speed: 0.9961s/iter; left time: 8777.3645s
	iters: 200, epoch: 12 | loss: 0.0008345
	speed: 0.3725s/iter; left time: 3244.9544s
	iters: 300, epoch: 12 | loss: 0.0009178
	speed: 0.3661s/iter; left time: 3152.5128s
	iters: 400, epoch: 12 | loss: 0.0035963
	speed: 0.3643s/iter; left time: 3100.6281s
Epoch: 12 cost time: 169.4755392074585
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0017549
	speed: 0.8883s/iter; left time: 7411.0999s
	iters: 200, epoch: 13 | loss: 0.0574303
	speed: 0.3313s/iter; left time: 2730.9491s
	iters: 300, epoch: 13 | loss: 0.0037585
	speed: 0.3429s/iter; left time: 2792.5825s
	iters: 400, epoch: 13 | loss: 0.0019766
	speed: 0.2736s/iter; left time: 2200.7980s
Epoch: 13 cost time: 151.1832094192505
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.982275 --> -0.985134).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0166769
	speed: 0.9049s/iter; left time: 7125.4398s
	iters: 200, epoch: 14 | loss: 0.0547826
	speed: 0.3584s/iter; left time: 2785.9344s
	iters: 300, epoch: 14 | loss: 0.0078230
	speed: 0.3596s/iter; left time: 2759.2323s
	iters: 400, epoch: 14 | loss: 0.0046312
	speed: 0.3695s/iter; left time: 2798.9611s
Epoch: 14 cost time: 164.40244007110596
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0020413
	speed: 0.9839s/iter; left time: 7286.0537s
	iters: 200, epoch: 15 | loss: 0.0003501
	speed: 0.3297s/iter; left time: 2408.5737s
	iters: 300, epoch: 15 | loss: 0.0018972
	speed: 0.3035s/iter; left time: 2186.8692s
	iters: 400, epoch: 15 | loss: 0.0018802
	speed: 0.3132s/iter; left time: 2225.4109s
Epoch: 15 cost time: 150.73441243171692
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0002241
	speed: 0.7801s/iter; left time: 5411.0769s
	iters: 200, epoch: 16 | loss: 0.0001829
	speed: 0.2884s/iter; left time: 1971.6413s
	iters: 300, epoch: 16 | loss: 0.0009917
	speed: 0.2971s/iter; left time: 2001.2279s
	iters: 400, epoch: 16 | loss: 0.0001134
	speed: 0.2913s/iter; left time: 1932.8584s
Epoch: 16 cost time: 131.66451334953308
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0010225
	speed: 0.8588s/iter; left time: 5553.5635s
	iters: 200, epoch: 17 | loss: 0.0004524
	speed: 0.3047s/iter; left time: 1940.2832s
	iters: 300, epoch: 17 | loss: 0.0067148
	speed: 0.3524s/iter; left time: 2208.2708s
	iters: 400, epoch: 17 | loss: 0.0005682
	speed: 0.3561s/iter; left time: 2195.9108s
Epoch: 17 cost time: 158.7626564502716
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.985134 --> -0.985705).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0004721
	speed: 0.9547s/iter; left time: 5726.1139s
	iters: 200, epoch: 18 | loss: 0.0046153
	speed: 0.3343s/iter; left time: 1971.9953s
	iters: 300, epoch: 18 | loss: 0.0004496
	speed: 0.3349s/iter; left time: 1941.8837s
	iters: 400, epoch: 18 | loss: 0.0001860
	speed: 0.3068s/iter; left time: 1748.0131s
Epoch: 18 cost time: 145.7514841556549
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0004512
	speed: 0.6890s/iter; left time: 3809.2825s
	iters: 200, epoch: 19 | loss: 0.0005593
	speed: 0.2734s/iter; left time: 1484.3022s
	iters: 300, epoch: 19 | loss: 0.0010941
	speed: 0.2667s/iter; left time: 1421.3991s
	iters: 400, epoch: 19 | loss: 0.0002784
	speed: 0.2494s/iter; left time: 1304.2956s
Epoch: 19 cost time: 125.48093485832214
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0006922
	speed: 0.8511s/iter; left time: 4306.5791s
	iters: 200, epoch: 20 | loss: 0.0003261
	speed: 0.3095s/iter; left time: 1535.2868s
	iters: 300, epoch: 20 | loss: 0.0175682
	speed: 0.3309s/iter; left time: 1607.9875s
	iters: 400, epoch: 20 | loss: 0.0084047
	speed: 0.3511s/iter; left time: 1671.4675s
Epoch: 20 cost time: 154.68915915489197
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001043
	speed: 0.9618s/iter; left time: 4415.4365s
	iters: 200, epoch: 21 | loss: 0.0003716
	speed: 0.3438s/iter; left time: 1543.8549s
	iters: 300, epoch: 21 | loss: 0.0004077
	speed: 0.3050s/iter; left time: 1339.0828s
	iters: 400, epoch: 21 | loss: 0.0004803
	speed: 0.3091s/iter; left time: 1326.5135s
Epoch: 21 cost time: 152.45168352127075
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0092973
	speed: 0.8146s/iter; left time: 3357.8579s
	iters: 200, epoch: 22 | loss: 0.0005615
	speed: 0.2775s/iter; left time: 1116.1050s
	iters: 300, epoch: 22 | loss: 0.0003935
	speed: 0.2778s/iter; left time: 1089.6105s
	iters: 400, epoch: 22 | loss: 0.0038993
	speed: 0.2545s/iter; left time: 972.8335s
Epoch: 22 cost time: 112.26199531555176
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0041852
	speed: 0.5599s/iter; left time: 2045.2927s
	iters: 200, epoch: 23 | loss: 0.0003564
	speed: 0.2876s/iter; left time: 1021.9158s
	iters: 300, epoch: 23 | loss: 0.0000879
	speed: 0.2824s/iter; left time: 974.9632s
	iters: 400, epoch: 23 | loss: 0.2214793
	speed: 0.2637s/iter; left time: 884.2352s
Epoch: 23 cost time: 131.29160714149475
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0014859
	speed: 0.8446s/iter; left time: 2689.1439s
	iters: 200, epoch: 24 | loss: 0.0036052
	speed: 0.3058s/iter; left time: 942.9452s
	iters: 300, epoch: 24 | loss: 0.0003886
	speed: 0.2912s/iter; left time: 868.8788s
	iters: 400, epoch: 24 | loss: 0.0001871
	speed: 0.3076s/iter; left time: 887.1520s
Epoch: 24 cost time: 141.56528782844543
Epoch: 24, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0005546
	speed: 0.7810s/iter; left time: 2120.3920s
	iters: 200, epoch: 25 | loss: 0.0069452
	speed: 0.2704s/iter; left time: 706.9976s
	iters: 300, epoch: 25 | loss: 0.0742147
	speed: 0.2570s/iter; left time: 646.4199s
	iters: 400, epoch: 25 | loss: 0.0003067
	speed: 0.2846s/iter; left time: 687.3975s
Epoch: 25 cost time: 129.31186032295227
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0016691
	speed: 0.7890s/iter; left time: 1772.0850s
	iters: 200, epoch: 26 | loss: 0.0008194
	speed: 0.2559s/iter; left time: 549.2379s
	iters: 300, epoch: 26 | loss: 0.0005667
	speed: 0.2407s/iter; left time: 492.5558s
	iters: 400, epoch: 26 | loss: 0.0001466
	speed: 0.2440s/iter; left time: 474.7361s
Epoch: 26 cost time: 118.11797499656677
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0002540
	speed: 0.7205s/iter; left time: 1280.3508s
	iters: 200, epoch: 27 | loss: 0.0000665
	speed: 0.2743s/iter; left time: 459.9193s
	iters: 300, epoch: 27 | loss: 0.0020632
	speed: 0.3202s/iter; left time: 505.0224s
	iters: 400, epoch: 27 | loss: 0.2586978
	speed: 0.3585s/iter; left time: 529.4360s
Epoch: 27 cost time: 144.77490067481995
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 1761290
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4718879
	speed: 0.2389s/iter; left time: 3337.9663s
	iters: 200, epoch: 1 | loss: 0.5358034
	speed: 0.2231s/iter; left time: 3094.9784s
	iters: 300, epoch: 1 | loss: 0.5554116
	speed: 0.2194s/iter; left time: 3021.3810s
	iters: 400, epoch: 1 | loss: 0.0723774
	speed: 0.2112s/iter; left time: 2887.5789s
Epoch: 1 cost time: 104.15686869621277
Epoch: 1, Steps: 469 | Train Loss: 0.799 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (inf --> -0.951113).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0285868
	speed: 0.6905s/iter; left time: 9322.6553s
	iters: 200, epoch: 2 | loss: 0.0546288
	speed: 0.2049s/iter; left time: 2745.4547s
	iters: 300, epoch: 2 | loss: 0.0380416
	speed: 0.2124s/iter; left time: 2825.5473s
	iters: 400, epoch: 2 | loss: 0.0160836
	speed: 0.1971s/iter; left time: 2601.4645s
Epoch: 2 cost time: 94.40986895561218
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
Validation loss decreased (-0.951113 --> -0.971697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0304371
	speed: 0.6669s/iter; left time: 8691.8917s
	iters: 200, epoch: 3 | loss: 0.0660431
	speed: 0.1807s/iter; left time: 2336.6084s
	iters: 300, epoch: 3 | loss: 0.0084393
	speed: 0.1613s/iter; left time: 2069.7709s
	iters: 400, epoch: 3 | loss: 0.0051372
	speed: 0.1373s/iter; left time: 1747.8058s
Epoch: 3 cost time: 77.56764364242554
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.971697 --> -0.979988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0042543
	speed: 0.6199s/iter; left time: 7789.0193s
	iters: 200, epoch: 4 | loss: 0.0108162
	speed: 0.1810s/iter; left time: 2255.9587s
	iters: 300, epoch: 4 | loss: 0.0156096
	speed: 0.1913s/iter; left time: 2365.5673s
	iters: 400, epoch: 4 | loss: 0.1024472
	speed: 0.2142s/iter; left time: 2626.3506s
Epoch: 4 cost time: 91.80284929275513
Epoch: 4, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0024918
	speed: 0.6936s/iter; left time: 8388.6695s
	iters: 200, epoch: 5 | loss: 0.0190285
	speed: 0.2006s/iter; left time: 2405.8395s
	iters: 300, epoch: 5 | loss: 0.0081513
	speed: 0.2044s/iter; left time: 2430.9229s
	iters: 400, epoch: 5 | loss: 0.0117324
	speed: 0.2168s/iter; left time: 2557.7257s
Epoch: 5 cost time: 97.80075025558472
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0097199
	speed: 0.7349s/iter; left time: 8544.3018s
	iters: 200, epoch: 6 | loss: 0.0772351
	speed: 0.2058s/iter; left time: 2371.8578s
	iters: 300, epoch: 6 | loss: 0.0243884
	speed: 0.1799s/iter; left time: 2055.5893s
	iters: 400, epoch: 6 | loss: 0.0034068
	speed: 0.2174s/iter; left time: 2462.0367s
Epoch: 6 cost time: 96.50910544395447
Epoch: 6, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0006309
	speed: 0.6508s/iter; left time: 7260.5583s
	iters: 200, epoch: 7 | loss: 0.0022627
	speed: 0.1839s/iter; left time: 2033.9328s
	iters: 300, epoch: 7 | loss: 0.0165177
	speed: 0.2032s/iter; left time: 2226.5265s
	iters: 400, epoch: 7 | loss: 0.0081658
	speed: 0.2053s/iter; left time: 2228.9104s
Epoch: 7 cost time: 91.42274308204651
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0010878
	speed: 0.6728s/iter; left time: 7191.0769s
	iters: 200, epoch: 8 | loss: 0.0142356
	speed: 0.1807s/iter; left time: 1913.1830s
	iters: 300, epoch: 8 | loss: 0.1920802
	speed: 0.1885s/iter; left time: 1977.0137s
	iters: 400, epoch: 8 | loss: 0.0309105
	speed: 0.1922s/iter; left time: 1996.8412s
Epoch: 8 cost time: 88.61392331123352
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0004284
	speed: 0.6007s/iter; left time: 6138.3210s
	iters: 200, epoch: 9 | loss: 0.0012745
	speed: 0.1755s/iter; left time: 1775.4839s
	iters: 300, epoch: 9 | loss: 0.0038104
	speed: 0.1954s/iter; left time: 1958.0047s
	iters: 400, epoch: 9 | loss: 0.0035174
	speed: 0.1962s/iter; left time: 1946.1141s
Epoch: 9 cost time: 87.00081133842468
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.981989).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0025618
	speed: 0.6768s/iter; left time: 6598.5890s
	iters: 200, epoch: 10 | loss: 0.0014451
	speed: 0.1920s/iter; left time: 1853.0327s
	iters: 300, epoch: 10 | loss: 0.0086586
	speed: 0.1972s/iter; left time: 1883.7110s
	iters: 400, epoch: 10 | loss: 0.0009843
	speed: 0.1851s/iter; left time: 1749.5616s
Epoch: 10 cost time: 90.07587099075317
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0034893
	speed: 0.6899s/iter; left time: 6402.8770s
	iters: 200, epoch: 11 | loss: 0.0008932
	speed: 0.2088s/iter; left time: 1916.8341s
	iters: 300, epoch: 11 | loss: 0.0002631
	speed: 0.2075s/iter; left time: 1884.0323s
	iters: 400, epoch: 11 | loss: 0.0015856
	speed: 0.1782s/iter; left time: 1600.5365s
Epoch: 11 cost time: 89.11465835571289
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0012697
	speed: 0.5221s/iter; left time: 4600.9226s
	iters: 200, epoch: 12 | loss: 0.0005268
	speed: 0.1665s/iter; left time: 1450.3668s
	iters: 300, epoch: 12 | loss: 0.0219408
	speed: 0.1533s/iter; left time: 1320.1068s
	iters: 400, epoch: 12 | loss: 0.0003542
	speed: 0.1709s/iter; left time: 1454.8525s
Epoch: 12 cost time: 77.0770971775055
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0005117
	speed: 0.6008s/iter; left time: 5012.5698s
	iters: 200, epoch: 13 | loss: 0.0023352
	speed: 0.1832s/iter; left time: 1510.2917s
	iters: 300, epoch: 13 | loss: 0.0096471
	speed: 0.1582s/iter; left time: 1288.4994s
	iters: 400, epoch: 13 | loss: 0.0076372
	speed: 0.1406s/iter; left time: 1130.5812s
Epoch: 13 cost time: 73.37193536758423
Epoch: 13, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0018532
	speed: 0.4708s/iter; left time: 3707.2301s
	iters: 200, epoch: 14 | loss: 0.0004582
	speed: 0.1494s/iter; left time: 1161.4348s
	iters: 300, epoch: 14 | loss: 0.1919790
	speed: 0.1780s/iter; left time: 1365.6011s
	iters: 400, epoch: 14 | loss: 0.0064657
	speed: 0.1792s/iter; left time: 1357.3731s
Epoch: 14 cost time: 77.61246490478516
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983418).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0234129
	speed: 0.6183s/iter; left time: 4578.4533s
	iters: 200, epoch: 15 | loss: 0.0001424
	speed: 0.1758s/iter; left time: 1284.2392s
	iters: 300, epoch: 15 | loss: 0.0004493
	speed: 0.1383s/iter; left time: 996.2554s
	iters: 400, epoch: 15 | loss: 0.0085388
	speed: 0.1897s/iter; left time: 1347.7878s
Epoch: 15 cost time: 81.56488299369812
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0070287
	speed: 0.6861s/iter; left time: 4758.8547s
	iters: 200, epoch: 16 | loss: 0.0001191
	speed: 0.2142s/iter; left time: 1464.3083s
	iters: 300, epoch: 16 | loss: 0.3030228
	speed: 0.2053s/iter; left time: 1383.1462s
	iters: 400, epoch: 16 | loss: 0.0009652
	speed: 0.2048s/iter; left time: 1358.7602s
Epoch: 16 cost time: 96.71454620361328
Epoch: 16, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.983418 --> -0.985134).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0010776
	speed: 0.5988s/iter; left time: 3872.6486s
	iters: 200, epoch: 17 | loss: 0.0002317
	speed: 0.1721s/iter; left time: 1095.5950s
	iters: 300, epoch: 17 | loss: 0.0048312
	speed: 0.1629s/iter; left time: 1020.9852s
	iters: 400, epoch: 17 | loss: 0.0002722
	speed: 0.1640s/iter; left time: 1011.1261s
Epoch: 17 cost time: 79.76737427711487
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001823
	speed: 0.6158s/iter; left time: 3693.3182s
	iters: 200, epoch: 18 | loss: 0.0001122
	speed: 0.1719s/iter; left time: 1013.6371s
	iters: 300, epoch: 18 | loss: 0.0001411
	speed: 0.1923s/iter; left time: 1114.7094s
	iters: 400, epoch: 18 | loss: 0.0003401
	speed: 0.1692s/iter; left time: 964.2957s
Epoch: 18 cost time: 82.6867880821228
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0005236
	speed: 0.5859s/iter; left time: 3239.2893s
	iters: 200, epoch: 19 | loss: 0.0006201
	speed: 0.1439s/iter; left time: 781.3899s
	iters: 300, epoch: 19 | loss: 0.0001384
	speed: 0.1738s/iter; left time: 926.3020s
	iters: 400, epoch: 19 | loss: 0.0008321
	speed: 0.1950s/iter; left time: 1019.8252s
Epoch: 19 cost time: 82.5024356842041
Epoch: 19, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003977
	speed: 0.6882s/iter; left time: 3482.0455s
	iters: 200, epoch: 20 | loss: 0.0003317
	speed: 0.1993s/iter; left time: 988.4923s
	iters: 300, epoch: 20 | loss: 0.0038123
	speed: 0.1827s/iter; left time: 888.0235s
	iters: 400, epoch: 20 | loss: 0.0008099
	speed: 0.1881s/iter; left time: 895.1490s
Epoch: 20 cost time: 90.12568759918213
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0002697
	speed: 0.6154s/iter; left time: 2825.4379s
	iters: 200, epoch: 21 | loss: 0.0001156
	speed: 0.1812s/iter; left time: 813.5478s
	iters: 300, epoch: 21 | loss: 0.0818936
	speed: 0.1823s/iter; left time: 800.3430s
	iters: 400, epoch: 21 | loss: 0.0000348
	speed: 0.1021s/iter; left time: 438.0725s
Epoch: 21 cost time: 74.89868474006653
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0060132
	speed: 0.6235s/iter; left time: 2569.9122s
	iters: 200, epoch: 22 | loss: 0.0009631
	speed: 0.1833s/iter; left time: 737.0756s
	iters: 300, epoch: 22 | loss: 0.0013495
	speed: 0.1876s/iter; left time: 735.9438s
	iters: 400, epoch: 22 | loss: 0.0006791
	speed: 0.1900s/iter; left time: 726.2819s
Epoch: 22 cost time: 87.62599635124207
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0009300
	speed: 0.6317s/iter; left time: 2307.6446s
	iters: 200, epoch: 23 | loss: 0.0012846
	speed: 0.1853s/iter; left time: 658.2163s
	iters: 300, epoch: 23 | loss: 0.0003613
	speed: 0.1434s/iter; left time: 495.0757s
	iters: 400, epoch: 23 | loss: 0.0011097
	speed: 0.1442s/iter; left time: 483.5206s
Epoch: 23 cost time: 76.59841227531433
Epoch: 23, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1015727
	speed: 0.5494s/iter; left time: 1749.3149s
	iters: 200, epoch: 24 | loss: 0.0001218
	speed: 0.1833s/iter; left time: 565.3987s
	iters: 300, epoch: 24 | loss: 0.0001058
	speed: 0.1829s/iter; left time: 545.8440s
	iters: 400, epoch: 24 | loss: 0.0003025
	speed: 0.1861s/iter; left time: 536.7850s
Epoch: 24 cost time: 85.04329490661621
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0011030
	speed: 0.6375s/iter; left time: 1730.7654s
	iters: 200, epoch: 25 | loss: 0.0002774
	speed: 0.1996s/iter; left time: 521.8263s
	iters: 300, epoch: 25 | loss: 0.0000356
	speed: 0.1954s/iter; left time: 491.4352s
	iters: 400, epoch: 25 | loss: 0.0008012
	speed: 0.2093s/iter; left time: 505.4266s
Epoch: 25 cost time: 91.54308271408081
Epoch: 25, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0016835
	speed: 0.6846s/iter; left time: 1537.6020s
	iters: 200, epoch: 26 | loss: 0.0001688
	speed: 0.1985s/iter; left time: 426.0780s
	iters: 300, epoch: 26 | loss: 0.0007357
	speed: 0.2046s/iter; left time: 418.5781s
	iters: 400, epoch: 26 | loss: 0.0003170
	speed: 0.1500s/iter; left time: 291.8316s
Epoch: 26 cost time: 84.41960954666138
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
Validation loss decreased (-0.985134 --> -0.985705).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0014567
	speed: 0.4974s/iter; left time: 883.9159s
	iters: 200, epoch: 27 | loss: 0.0005634
	speed: 0.1571s/iter; left time: 263.5059s
	iters: 300, epoch: 27 | loss: 0.0001484
	speed: 0.1497s/iter; left time: 236.1041s
	iters: 400, epoch: 27 | loss: 0.0002133
	speed: 0.1448s/iter; left time: 213.8021s
Epoch: 27 cost time: 69.017493724823
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0001021
	speed: 0.5250s/iter; left time: 686.6679s
	iters: 200, epoch: 28 | loss: 0.0001866
	speed: 0.1850s/iter; left time: 223.4314s
	iters: 300, epoch: 28 | loss: 0.0000495
	speed: 0.1746s/iter; left time: 193.5115s
	iters: 400, epoch: 28 | loss: 0.0009711
	speed: 0.1785s/iter; left time: 179.9465s
Epoch: 28 cost time: 85.09077286720276
Epoch: 28, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0001162
	speed: 0.6289s/iter; left time: 527.6725s
	iters: 200, epoch: 29 | loss: 0.0004394
	speed: 0.2022s/iter; left time: 149.4440s
	iters: 300, epoch: 29 | loss: 0.0004015
	speed: 0.2108s/iter; left time: 134.7180s
	iters: 400, epoch: 29 | loss: 0.0009600
	speed: 0.2021s/iter; left time: 108.9084s
Epoch: 29 cost time: 93.67639708518982
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000302
	speed: 0.6159s/iter; left time: 227.8934s
	iters: 200, epoch: 30 | loss: 0.0007131
	speed: 0.1837s/iter; left time: 49.6008s
	iters: 300, epoch: 30 | loss: 0.0004993
	speed: 0.1875s/iter; left time: 31.8718s
	iters: 400, epoch: 30 | loss: 0.0000395
	speed: 0.1784s/iter; left time: 12.4905s
Epoch: 30 cost time: 86.55545401573181
Epoch: 30, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 519818
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2301136
	speed: 0.2153s/iter; left time: 3007.5706s
	iters: 200, epoch: 1 | loss: 0.6893461
	speed: 0.1693s/iter; left time: 2348.8123s
	iters: 300, epoch: 1 | loss: 0.3908688
	speed: 0.1619s/iter; left time: 2229.8000s
	iters: 400, epoch: 1 | loss: 0.3791413
	speed: 0.1634s/iter; left time: 2233.1876s
Epoch: 1 cost time: 82.94915866851807
Epoch: 1, Steps: 469 | Train Loss: 0.860 Vali Loss: 0.241 Vali Acc: 0.929 Test Loss: 0.241 Test Acc: 0.929
Validation loss decreased (inf --> -0.928814).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1768830
	speed: 0.5744s/iter; left time: 7755.8489s
	iters: 200, epoch: 2 | loss: 0.2703288
	speed: 0.1617s/iter; left time: 2166.9766s
	iters: 300, epoch: 2 | loss: 0.1193814
	speed: 0.1668s/iter; left time: 2218.3150s
	iters: 400, epoch: 2 | loss: 0.0221257
	speed: 0.1547s/iter; left time: 2042.0328s
Epoch: 2 cost time: 76.04482245445251
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.122 Vali Acc: 0.961 Test Loss: 0.122 Test Acc: 0.961
Validation loss decreased (-0.928814 --> -0.961119).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0817981
	speed: 0.4910s/iter; left time: 6399.3458s
	iters: 200, epoch: 3 | loss: 0.1222320
	speed: 0.1327s/iter; left time: 1715.6692s
	iters: 300, epoch: 3 | loss: 0.0398012
	speed: 0.1479s/iter; left time: 1897.9156s
	iters: 400, epoch: 3 | loss: 0.0083059
	speed: 0.1394s/iter; left time: 1775.1989s
Epoch: 3 cost time: 65.91409659385681
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.961119 --> -0.970268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0348330
	speed: 0.5423s/iter; left time: 6813.7415s
	iters: 200, epoch: 4 | loss: 0.0968197
	speed: 0.1824s/iter; left time: 2273.8921s
	iters: 300, epoch: 4 | loss: 0.0053261
	speed: 0.1579s/iter; left time: 1952.1306s
	iters: 400, epoch: 4 | loss: 0.1368506
	speed: 0.1876s/iter; left time: 2300.3957s
Epoch: 4 cost time: 83.682199716568
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970268).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2076222
	speed: 0.6325s/iter; left time: 7649.9395s
	iters: 200, epoch: 5 | loss: 0.0034705
	speed: 0.1834s/iter; left time: 2200.0155s
	iters: 300, epoch: 5 | loss: 0.0571594
	speed: 0.1852s/iter; left time: 2202.8459s
	iters: 400, epoch: 5 | loss: 0.0157913
	speed: 0.1615s/iter; left time: 1904.3141s
Epoch: 5 cost time: 83.9180850982666
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0030497
	speed: 0.5632s/iter; left time: 6547.2819s
	iters: 200, epoch: 6 | loss: 0.0053453
	speed: 0.1373s/iter; left time: 1582.1219s
	iters: 300, epoch: 6 | loss: 0.0080524
	speed: 0.1192s/iter; left time: 1362.2619s
	iters: 400, epoch: 6 | loss: 0.0070649
	speed: 0.1495s/iter; left time: 1693.6575s
Epoch: 6 cost time: 68.7282645702362
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0092420
	speed: 0.5992s/iter; left time: 6685.2517s
	iters: 200, epoch: 7 | loss: 0.0023363
	speed: 0.1806s/iter; left time: 1997.2527s
	iters: 300, epoch: 7 | loss: 0.1428918
	speed: 0.1779s/iter; left time: 1948.7108s
	iters: 400, epoch: 7 | loss: 0.0029724
	speed: 0.1848s/iter; left time: 2005.9913s
Epoch: 7 cost time: 84.32841801643372
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0061277
	speed: 0.6254s/iter; left time: 6684.5450s
	iters: 200, epoch: 8 | loss: 1.4603316
	speed: 0.1811s/iter; left time: 1917.4335s
	iters: 300, epoch: 8 | loss: 0.0455764
	speed: 0.1864s/iter; left time: 1955.2508s
	iters: 400, epoch: 8 | loss: 0.0020593
	speed: 0.1816s/iter; left time: 1886.0291s
Epoch: 8 cost time: 85.79962038993835
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.975985 --> -0.979702).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0004267
	speed: 0.6084s/iter; left time: 6217.7070s
	iters: 200, epoch: 9 | loss: 0.0048773
	speed: 0.1898s/iter; left time: 1920.6410s
	iters: 300, epoch: 9 | loss: 0.1356791
	speed: 0.1810s/iter; left time: 1813.8742s
	iters: 400, epoch: 9 | loss: 0.0018352
	speed: 0.1845s/iter; left time: 1830.1563s
Epoch: 9 cost time: 85.52251267433167
Epoch: 9, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0161984
	speed: 0.6321s/iter; left time: 6163.1060s
	iters: 200, epoch: 10 | loss: 0.0151371
	speed: 0.1838s/iter; left time: 1773.9711s
	iters: 300, epoch: 10 | loss: 0.0092304
	speed: 0.1642s/iter; left time: 1568.2404s
	iters: 400, epoch: 10 | loss: 0.0009275
	speed: 0.1852s/iter; left time: 1749.8911s
Epoch: 10 cost time: 85.89214324951172
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004831
	speed: 0.6438s/iter; left time: 5975.4700s
	iters: 200, epoch: 11 | loss: 0.0007133
	speed: 0.1576s/iter; left time: 1446.7614s
	iters: 300, epoch: 11 | loss: 0.0002068
	speed: 0.1406s/iter; left time: 1276.7738s
	iters: 400, epoch: 11 | loss: 0.0378393
	speed: 0.1754s/iter; left time: 1575.3330s
Epoch: 11 cost time: 78.26190733909607
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0510093
	speed: 0.6040s/iter; left time: 5322.1652s
	iters: 200, epoch: 12 | loss: 0.0083844
	speed: 0.1631s/iter; left time: 1421.1029s
	iters: 300, epoch: 12 | loss: 0.0104063
	speed: 0.1688s/iter; left time: 1453.4496s
	iters: 400, epoch: 12 | loss: 0.0003003
	speed: 0.1729s/iter; left time: 1471.3057s
Epoch: 12 cost time: 80.25612616539001
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0013802
	speed: 0.5725s/iter; left time: 4776.2479s
	iters: 200, epoch: 13 | loss: 0.0536903
	speed: 0.1732s/iter; left time: 1427.3681s
	iters: 300, epoch: 13 | loss: 0.0005266
	speed: 0.1703s/iter; left time: 1386.7268s
	iters: 400, epoch: 13 | loss: 0.0041894
	speed: 0.1643s/iter; left time: 1321.6783s
Epoch: 13 cost time: 77.45011377334595
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.979702 --> -0.984276).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0605344
	speed: 0.5757s/iter; left time: 4532.8824s
	iters: 200, epoch: 14 | loss: 0.1658826
	speed: 0.1817s/iter; left time: 1412.7429s
	iters: 300, epoch: 14 | loss: 0.0029071
	speed: 0.1824s/iter; left time: 1399.9104s
	iters: 400, epoch: 14 | loss: 0.0021818
	speed: 0.1871s/iter; left time: 1417.0646s
Epoch: 14 cost time: 86.43666124343872
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0092948
	speed: 0.6209s/iter; left time: 4597.5845s
	iters: 200, epoch: 15 | loss: 0.0003271
	speed: 0.1861s/iter; left time: 1359.7057s
	iters: 300, epoch: 15 | loss: 0.0006026
	speed: 0.1817s/iter; left time: 1309.4295s
	iters: 400, epoch: 15 | loss: 0.0009715
	speed: 0.1744s/iter; left time: 1238.8504s
Epoch: 15 cost time: 85.02305388450623
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000876
	speed: 0.5601s/iter; left time: 3884.6489s
	iters: 200, epoch: 16 | loss: 0.0002646
	speed: 0.1522s/iter; left time: 1040.5320s
	iters: 300, epoch: 16 | loss: 0.0003976
	speed: 0.1466s/iter; left time: 987.6025s
	iters: 400, epoch: 16 | loss: 0.0007217
	speed: 0.1598s/iter; left time: 1060.4279s
Epoch: 16 cost time: 72.15232872962952
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0005949
	speed: 0.5373s/iter; left time: 3474.6776s
	iters: 200, epoch: 17 | loss: 0.0002261
	speed: 0.1364s/iter; left time: 868.4393s
	iters: 300, epoch: 17 | loss: 0.0054200
	speed: 0.1468s/iter; left time: 919.7351s
	iters: 400, epoch: 17 | loss: 0.0003817
	speed: 0.1426s/iter; left time: 879.2144s
Epoch: 17 cost time: 69.32192397117615
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0004210
	speed: 0.5082s/iter; left time: 3048.4605s
	iters: 200, epoch: 18 | loss: 0.0112651
	speed: 0.1506s/iter; left time: 888.2757s
	iters: 300, epoch: 18 | loss: 0.0003130
	speed: 0.1436s/iter; left time: 832.4026s
	iters: 400, epoch: 18 | loss: 0.0002135
	speed: 0.1397s/iter; left time: 796.2309s
Epoch: 18 cost time: 67.81466817855835
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0002174
	speed: 0.5780s/iter; left time: 3195.9670s
	iters: 200, epoch: 19 | loss: 0.0008818
	speed: 0.1745s/iter; left time: 947.3512s
	iters: 300, epoch: 19 | loss: 0.0025769
	speed: 0.1909s/iter; left time: 1017.0745s
	iters: 400, epoch: 19 | loss: 0.0050567
	speed: 0.1816s/iter; left time: 949.6347s
Epoch: 19 cost time: 86.36646103858948
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0023375
	speed: 0.6381s/iter; left time: 3228.7729s
	iters: 200, epoch: 20 | loss: 0.0005108
	speed: 0.1968s/iter; left time: 976.2299s
	iters: 300, epoch: 20 | loss: 0.0005726
	speed: 0.1582s/iter; left time: 768.6429s
	iters: 400, epoch: 20 | loss: 0.0011480
	speed: 0.1806s/iter; left time: 859.8611s
Epoch: 20 cost time: 85.23816895484924
Epoch: 20, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0002677
	speed: 0.5699s/iter; left time: 2616.3663s
	iters: 200, epoch: 21 | loss: 0.0015520
	speed: 0.1499s/iter; left time: 673.2186s
	iters: 300, epoch: 21 | loss: 0.0004779
	speed: 0.1543s/iter; left time: 677.4207s
	iters: 400, epoch: 21 | loss: 0.0007118
	speed: 0.1463s/iter; left time: 627.7857s
Epoch: 21 cost time: 70.6517071723938
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0025375
	speed: 0.4990s/iter; left time: 2056.7883s
	iters: 200, epoch: 22 | loss: 0.0005336
	speed: 0.1406s/iter; left time: 565.4312s
	iters: 300, epoch: 22 | loss: 0.0045097
	speed: 0.1015s/iter; left time: 398.0676s
	iters: 400, epoch: 22 | loss: 0.0114782
	speed: 0.1579s/iter; left time: 603.5374s
Epoch: 22 cost time: 64.9967269897461
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0028216
	speed: 0.4853s/iter; left time: 1772.9286s
	iters: 200, epoch: 23 | loss: 0.0004177
	speed: 0.1511s/iter; left time: 536.9133s
	iters: 300, epoch: 23 | loss: 0.0004184
	speed: 0.1539s/iter; left time: 531.5485s
	iters: 400, epoch: 23 | loss: 0.1262489
	speed: 0.1534s/iter; left time: 514.4578s
Epoch: 23 cost time: 69.7438018321991
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 1761290
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5284182
	speed: 0.1277s/iter; left time: 1783.9976s
	iters: 200, epoch: 1 | loss: 0.6908466
	speed: 0.1118s/iter; left time: 1550.8191s
	iters: 300, epoch: 1 | loss: 0.5238264
	speed: 0.1146s/iter; left time: 1578.4943s
	iters: 400, epoch: 1 | loss: 0.1351441
	speed: 0.1142s/iter; left time: 1560.5937s
Epoch: 1 cost time: 54.71475577354431
Epoch: 1, Steps: 469 | Train Loss: 0.903 Vali Loss: 0.258 Vali Acc: 0.929 Test Loss: 0.258 Test Acc: 0.929
Validation loss decreased (inf --> -0.928814).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0918853
	speed: 0.4637s/iter; left time: 6261.4590s
	iters: 200, epoch: 2 | loss: 0.0995203
	speed: 0.1094s/iter; left time: 1466.7659s
	iters: 300, epoch: 2 | loss: 0.0687539
	speed: 0.1085s/iter; left time: 1442.6749s
	iters: 400, epoch: 2 | loss: 0.0217917
	speed: 0.1091s/iter; left time: 1439.9729s
Epoch: 2 cost time: 51.66639733314514
Epoch: 2, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.928814 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0426210
	speed: 0.4389s/iter; left time: 5719.5763s
	iters: 200, epoch: 3 | loss: 0.0649996
	speed: 0.1071s/iter; left time: 1385.6744s
	iters: 300, epoch: 3 | loss: 0.0082941
	speed: 0.0937s/iter; left time: 1202.5322s
	iters: 400, epoch: 3 | loss: 0.0094542
	speed: 0.0953s/iter; left time: 1213.6334s
Epoch: 3 cost time: 48.04731774330139
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.963978 --> -0.977987).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0068650
	speed: 0.4112s/iter; left time: 5166.1016s
	iters: 200, epoch: 4 | loss: 0.0164890
	speed: 0.1016s/iter; left time: 1266.0204s
	iters: 300, epoch: 4 | loss: 0.0085509
	speed: 0.0992s/iter; left time: 1226.7935s
	iters: 400, epoch: 4 | loss: 0.0666835
	speed: 0.1001s/iter; left time: 1227.3039s
Epoch: 4 cost time: 47.35214567184448
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0037020
	speed: 0.4156s/iter; left time: 5026.3909s
	iters: 200, epoch: 5 | loss: 0.0317976
	speed: 0.0843s/iter; left time: 1011.4808s
	iters: 300, epoch: 5 | loss: 0.0197467
	speed: 0.0924s/iter; left time: 1099.1464s
	iters: 400, epoch: 5 | loss: 0.0253428
	speed: 0.0907s/iter; left time: 1069.3176s
Epoch: 5 cost time: 43.1411247253418
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.977987 --> -0.979988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0061157
	speed: 0.3828s/iter; left time: 4450.6467s
	iters: 200, epoch: 6 | loss: 0.0536035
	speed: 0.0890s/iter; left time: 1026.1611s
	iters: 300, epoch: 6 | loss: 0.0214911
	speed: 0.0904s/iter; left time: 1032.6884s
	iters: 400, epoch: 6 | loss: 0.0107770
	speed: 0.0866s/iter; left time: 981.2427s
Epoch: 6 cost time: 41.51180171966553
Epoch: 6, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0059424
	speed: 0.4185s/iter; left time: 4668.7583s
	iters: 200, epoch: 7 | loss: 0.0024261
	speed: 0.1185s/iter; left time: 1310.0735s
	iters: 300, epoch: 7 | loss: 0.0744065
	speed: 0.1194s/iter; left time: 1308.4033s
	iters: 400, epoch: 7 | loss: 0.0418375
	speed: 0.1194s/iter; left time: 1296.7711s
Epoch: 7 cost time: 55.79834294319153
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0006781
	speed: 0.4992s/iter; left time: 5335.8968s
	iters: 200, epoch: 8 | loss: 0.0035306
	speed: 0.1203s/iter; left time: 1273.3398s
	iters: 300, epoch: 8 | loss: 0.3095895
	speed: 0.1274s/iter; left time: 1335.8473s
	iters: 400, epoch: 8 | loss: 0.0074032
	speed: 0.1240s/iter; left time: 1288.3824s
Epoch: 8 cost time: 58.234474897384644
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0015314
	speed: 0.4876s/iter; left time: 4982.5679s
	iters: 200, epoch: 9 | loss: 0.0014848
	speed: 0.1103s/iter; left time: 1116.3930s
	iters: 300, epoch: 9 | loss: 0.0007510
	speed: 0.1159s/iter; left time: 1160.8775s
	iters: 400, epoch: 9 | loss: 0.0038567
	speed: 0.1165s/iter; left time: 1155.0934s
Epoch: 9 cost time: 52.284164905548096
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.981131).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0011596
	speed: 0.4218s/iter; left time: 4112.8195s
	iters: 200, epoch: 10 | loss: 0.0005971
	speed: 0.0838s/iter; left time: 809.0342s
	iters: 300, epoch: 10 | loss: 0.3543822
	speed: 0.0913s/iter; left time: 871.6306s
	iters: 400, epoch: 10 | loss: 0.0024816
	speed: 0.0889s/iter; left time: 839.7608s
Epoch: 10 cost time: 42.213528871536255
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2212502
	speed: 0.3906s/iter; left time: 3625.3288s
	iters: 200, epoch: 11 | loss: 0.0035226
	speed: 0.0942s/iter; left time: 864.6831s
	iters: 300, epoch: 11 | loss: 0.0018206
	speed: 0.1062s/iter; left time: 964.7806s
	iters: 400, epoch: 11 | loss: 0.0014051
	speed: 0.1095s/iter; left time: 983.1212s
Epoch: 11 cost time: 46.16754174232483
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0069997
	speed: 0.4435s/iter; left time: 3908.0699s
	iters: 200, epoch: 12 | loss: 0.0013793
	speed: 0.1171s/iter; left time: 1020.2700s
	iters: 300, epoch: 12 | loss: 0.0104817
	speed: 0.1139s/iter; left time: 981.0453s
	iters: 400, epoch: 12 | loss: 0.0043915
	speed: 0.1086s/iter; left time: 924.5338s
Epoch: 12 cost time: 52.93220329284668
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.981131 --> -0.982275).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0003252
	speed: 0.4473s/iter; left time: 3732.1980s
	iters: 200, epoch: 13 | loss: 0.0003692
	speed: 0.0855s/iter; left time: 704.8056s
	iters: 300, epoch: 13 | loss: 0.2795465
	speed: 0.1009s/iter; left time: 822.0318s
	iters: 400, epoch: 13 | loss: 0.1702739
	speed: 0.1071s/iter; left time: 861.4292s
Epoch: 13 cost time: 46.8149299621582
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0095501
	speed: 0.4309s/iter; left time: 3392.7711s
	iters: 200, epoch: 14 | loss: 0.0001820
	speed: 0.1041s/iter; left time: 809.3280s
	iters: 300, epoch: 14 | loss: 0.1055326
	speed: 0.1043s/iter; left time: 800.3902s
	iters: 400, epoch: 14 | loss: 0.0019363
	speed: 0.0943s/iter; left time: 714.3507s
Epoch: 14 cost time: 47.200690507888794
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0890774
	speed: 0.3705s/iter; left time: 2743.3246s
	iters: 200, epoch: 15 | loss: 0.0002715
	speed: 0.1185s/iter; left time: 865.8982s
	iters: 300, epoch: 15 | loss: 0.0003708
	speed: 0.1223s/iter; left time: 881.4808s
	iters: 400, epoch: 15 | loss: 0.0752789
	speed: 0.1273s/iter; left time: 904.1820s
Epoch: 15 cost time: 56.19119715690613
Epoch: 15, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0072001
	speed: 0.5233s/iter; left time: 3629.7893s
	iters: 200, epoch: 16 | loss: 0.0001232
	speed: 0.1367s/iter; left time: 934.3505s
	iters: 300, epoch: 16 | loss: 0.0049243
	speed: 0.1367s/iter; left time: 920.8189s
	iters: 400, epoch: 16 | loss: 0.1089562
	speed: 0.1288s/iter; left time: 854.6288s
Epoch: 16 cost time: 61.59955406188965
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983133).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0005943
	speed: 0.5218s/iter; left time: 3374.2541s
	iters: 200, epoch: 17 | loss: 0.0024132
	speed: 0.1225s/iter; left time: 780.2041s
	iters: 300, epoch: 17 | loss: 0.0003269
	speed: 0.1204s/iter; left time: 754.7487s
	iters: 400, epoch: 17 | loss: 0.0093401
	speed: 0.1267s/iter; left time: 781.5063s
Epoch: 17 cost time: 58.938454389572144
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983133 --> -0.985134).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0214995
	speed: 0.5144s/iter; left time: 3085.2046s
	iters: 200, epoch: 18 | loss: 0.0047659
	speed: 0.1259s/iter; left time: 742.7259s
	iters: 300, epoch: 18 | loss: 0.0007393
	speed: 0.1382s/iter; left time: 801.4165s
	iters: 400, epoch: 18 | loss: 0.0006214
	speed: 0.1395s/iter; left time: 794.9040s
Epoch: 18 cost time: 62.31806135177612
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0006037
	speed: 0.5871s/iter; left time: 3246.2058s
	iters: 200, epoch: 19 | loss: 0.0004927
	speed: 0.1341s/iter; left time: 727.9846s
	iters: 300, epoch: 19 | loss: 0.0003525
	speed: 0.1384s/iter; left time: 737.6573s
	iters: 400, epoch: 19 | loss: 0.0000806
	speed: 0.1412s/iter; left time: 738.0916s
Epoch: 19 cost time: 64.69786357879639
Epoch: 19, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0008757
	speed: 0.5025s/iter; left time: 2542.4626s
	iters: 200, epoch: 20 | loss: 0.0027558
	speed: 0.1305s/iter; left time: 647.2611s
	iters: 300, epoch: 20 | loss: 0.0019115
	speed: 0.1274s/iter; left time: 618.9660s
	iters: 400, epoch: 20 | loss: 0.0000743
	speed: 0.1258s/iter; left time: 598.6010s
Epoch: 20 cost time: 59.292956590652466
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0016579
	speed: 0.5295s/iter; left time: 2430.7890s
	iters: 200, epoch: 21 | loss: 0.0001489
	speed: 0.1223s/iter; left time: 549.4208s
	iters: 300, epoch: 21 | loss: 0.0002288
	speed: 0.1297s/iter; left time: 569.5596s
	iters: 400, epoch: 21 | loss: 0.0001362
	speed: 0.1349s/iter; left time: 578.6724s
Epoch: 21 cost time: 59.96628022193909
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0124361
	speed: 0.4569s/iter; left time: 1883.5110s
	iters: 200, epoch: 22 | loss: 0.0043385
	speed: 0.1095s/iter; left time: 440.5330s
	iters: 300, epoch: 22 | loss: 0.0000690
	speed: 0.1170s/iter; left time: 458.9959s
	iters: 400, epoch: 22 | loss: 0.0048945
	speed: 0.1062s/iter; left time: 405.9703s
Epoch: 22 cost time: 52.45906615257263
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0001873
	speed: 0.4509s/iter; left time: 1647.1649s
	iters: 200, epoch: 23 | loss: 0.0015339
	speed: 0.1091s/iter; left time: 387.7564s
	iters: 300, epoch: 23 | loss: 0.0001543
	speed: 0.1027s/iter; left time: 354.5931s
	iters: 400, epoch: 23 | loss: 0.0000896
	speed: 0.1018s/iter; left time: 341.3699s
Epoch: 23 cost time: 51.50371050834656
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0459428
	speed: 0.5252s/iter; left time: 1672.2001s
	iters: 200, epoch: 24 | loss: 0.0129946
	speed: 0.1057s/iter; left time: 325.9578s
	iters: 300, epoch: 24 | loss: 0.0003154
	speed: 0.1404s/iter; left time: 419.0205s
	iters: 400, epoch: 24 | loss: 0.0085622
	speed: 0.1359s/iter; left time: 391.8457s
Epoch: 24 cost time: 59.961936235427856
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0001286
	speed: 0.5635s/iter; left time: 1529.8308s
	iters: 200, epoch: 25 | loss: 0.0013475
	speed: 0.1355s/iter; left time: 354.3622s
	iters: 300, epoch: 25 | loss: 0.0000862
	speed: 0.1321s/iter; left time: 332.2417s
	iters: 400, epoch: 25 | loss: 0.0003862
	speed: 0.1401s/iter; left time: 338.3832s
Epoch: 25 cost time: 64.48729467391968
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0044262
	speed: 0.5637s/iter; left time: 1266.0894s
	iters: 200, epoch: 26 | loss: 0.0001611
	speed: 0.1389s/iter; left time: 297.9831s
	iters: 300, epoch: 26 | loss: 0.0004557
	speed: 0.1396s/iter; left time: 285.5415s
	iters: 400, epoch: 26 | loss: 0.0004931
	speed: 0.1325s/iter; left time: 257.7943s
Epoch: 26 cost time: 64.07456493377686
Epoch: 26, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0017426
	speed: 0.5467s/iter; left time: 971.5389s
	iters: 200, epoch: 27 | loss: 0.0000563
	speed: 0.1085s/iter; left time: 181.8806s
	iters: 300, epoch: 27 | loss: 0.0004513
	speed: 0.1205s/iter; left time: 190.0695s
	iters: 400, epoch: 27 | loss: 0.0000329
	speed: 0.1236s/iter; left time: 182.5972s
Epoch: 27 cost time: 56.923075437545776
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 519818
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5310463
	speed: 0.1600s/iter; left time: 2235.9743s
	iters: 200, epoch: 1 | loss: 0.8421258
	speed: 0.1484s/iter; left time: 2058.5784s
	iters: 300, epoch: 1 | loss: 0.2615804
	speed: 0.1609s/iter; left time: 2215.6597s
	iters: 400, epoch: 1 | loss: 0.2741135
	speed: 0.1512s/iter; left time: 2067.5565s
Epoch: 1 cost time: 72.66416501998901
Epoch: 1, Steps: 469 | Train Loss: 0.908 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (inf --> -0.918522).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1127821
	speed: 0.5855s/iter; left time: 7905.5345s
	iters: 200, epoch: 2 | loss: 0.1654240
	speed: 0.1527s/iter; left time: 2046.1796s
	iters: 300, epoch: 2 | loss: 0.1109605
	speed: 0.1554s/iter; left time: 2066.6739s
	iters: 400, epoch: 2 | loss: 0.1206948
	speed: 0.1510s/iter; left time: 1992.9789s
Epoch: 2 cost time: 71.21383666992188
Epoch: 2, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
Validation loss decreased (-0.918522 --> -0.959690).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0207390
	speed: 0.5893s/iter; left time: 7680.5952s
	iters: 200, epoch: 3 | loss: 0.0733366
	speed: 0.1441s/iter; left time: 1864.2494s
	iters: 300, epoch: 3 | loss: 0.0135405
	speed: 0.1511s/iter; left time: 1939.5082s
	iters: 400, epoch: 3 | loss: 0.2005318
	speed: 0.1474s/iter; left time: 1877.0785s
Epoch: 3 cost time: 67.35270929336548
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0119719
	speed: 0.5473s/iter; left time: 6876.6743s
	iters: 200, epoch: 4 | loss: 0.0058404
	speed: 0.1580s/iter; left time: 1969.9134s
	iters: 300, epoch: 4 | loss: 0.3289973
	speed: 0.1649s/iter; left time: 2039.0961s
	iters: 400, epoch: 4 | loss: 0.0500177
	speed: 0.1666s/iter; left time: 2043.5777s
Epoch: 4 cost time: 75.89626169204712
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.959690 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3393794
	speed: 0.6442s/iter; left time: 7791.3937s
	iters: 200, epoch: 5 | loss: 0.0303346
	speed: 0.1847s/iter; left time: 2215.7355s
	iters: 300, epoch: 5 | loss: 0.0044764
	speed: 0.1795s/iter; left time: 2135.4891s
	iters: 400, epoch: 5 | loss: 0.0415093
	speed: 0.1848s/iter; left time: 2180.0484s
Epoch: 5 cost time: 84.82668018341064
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2920730
	speed: 0.7378s/iter; left time: 8578.2129s
	iters: 200, epoch: 6 | loss: 0.0030832
	speed: 0.1774s/iter; left time: 2044.5503s
	iters: 300, epoch: 6 | loss: 0.0073784
	speed: 0.1771s/iter; left time: 2023.2814s
	iters: 400, epoch: 6 | loss: 0.0514129
	speed: 0.1815s/iter; left time: 2055.6592s
Epoch: 6 cost time: 85.19335341453552
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0071614
	speed: 0.7071s/iter; left time: 7888.9928s
	iters: 200, epoch: 7 | loss: 0.0024235
	speed: 0.1534s/iter; left time: 1695.8511s
	iters: 300, epoch: 7 | loss: 0.0066847
	speed: 0.1707s/iter; left time: 1870.7944s
	iters: 400, epoch: 7 | loss: 0.0026559
	speed: 0.1687s/iter; left time: 1832.0263s
Epoch: 7 cost time: 77.25838088989258
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0013145
	speed: 0.5889s/iter; left time: 6294.6861s
	iters: 200, epoch: 8 | loss: 0.0817635
	speed: 0.1511s/iter; left time: 1599.5504s
	iters: 300, epoch: 8 | loss: 0.0060182
	speed: 0.1426s/iter; left time: 1495.8578s
	iters: 400, epoch: 8 | loss: 0.0617539
	speed: 0.1520s/iter; left time: 1579.0055s
Epoch: 8 cost time: 70.32051277160645
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0181273
	speed: 0.6162s/iter; left time: 6297.1246s
	iters: 200, epoch: 9 | loss: 0.0032005
	speed: 0.1567s/iter; left time: 1585.3879s
	iters: 300, epoch: 9 | loss: 0.0026791
	speed: 0.1568s/iter; left time: 1570.5704s
	iters: 400, epoch: 9 | loss: 0.0030444
	speed: 0.1485s/iter; left time: 1472.8842s
Epoch: 9 cost time: 72.29966974258423
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.976843).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0091087
	speed: 0.6022s/iter; left time: 5871.0426s
	iters: 200, epoch: 10 | loss: 0.0365802
	speed: 0.1468s/iter; left time: 1416.6176s
	iters: 300, epoch: 10 | loss: 0.0136771
	speed: 0.1425s/iter; left time: 1360.6152s
	iters: 400, epoch: 10 | loss: 0.0025524
	speed: 0.1360s/iter; left time: 1285.0086s
Epoch: 10 cost time: 67.96513271331787
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0058338
	speed: 0.5948s/iter; left time: 5520.3018s
	iters: 200, epoch: 11 | loss: 0.0012412
	speed: 0.1627s/iter; left time: 1493.5921s
	iters: 300, epoch: 11 | loss: 0.0030229
	speed: 0.1616s/iter; left time: 1467.8695s
	iters: 400, epoch: 11 | loss: 0.0010647
	speed: 0.1706s/iter; left time: 1532.5493s
Epoch: 11 cost time: 77.245365858078
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.979130).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1605038
	speed: 0.5632s/iter; left time: 4962.7040s
	iters: 200, epoch: 12 | loss: 0.0175033
	speed: 0.1615s/iter; left time: 1407.0689s
	iters: 300, epoch: 12 | loss: 0.0008282
	speed: 0.1699s/iter; left time: 1463.2492s
	iters: 400, epoch: 12 | loss: 0.0016069
	speed: 0.1629s/iter; left time: 1386.8713s
Epoch: 12 cost time: 76.84249639511108
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0025049
	speed: 0.5989s/iter; left time: 4996.4945s
	iters: 200, epoch: 13 | loss: 0.0004554
	speed: 0.1443s/iter; left time: 1189.4148s
	iters: 300, epoch: 13 | loss: 0.0013601
	speed: 0.1504s/iter; left time: 1224.3726s
	iters: 400, epoch: 13 | loss: 0.0011131
	speed: 0.1568s/iter; left time: 1261.5321s
Epoch: 13 cost time: 71.92579793930054
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0003720
	speed: 0.5908s/iter; left time: 4652.3152s
	iters: 200, epoch: 14 | loss: 0.0772467
	speed: 0.1411s/iter; left time: 1097.1383s
	iters: 300, epoch: 14 | loss: 0.2269512
	speed: 0.1317s/iter; left time: 1010.3912s
	iters: 400, epoch: 14 | loss: 0.0007194
	speed: 0.1224s/iter; left time: 926.7573s
Epoch: 14 cost time: 62.79064702987671
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0017943
	speed: 0.5562s/iter; left time: 4118.8132s
	iters: 200, epoch: 15 | loss: 0.0005723
	speed: 0.1370s/iter; left time: 1000.9431s
	iters: 300, epoch: 15 | loss: 0.0137448
	speed: 0.1387s/iter; left time: 999.6672s
	iters: 400, epoch: 15 | loss: 0.0158116
	speed: 0.1291s/iter; left time: 917.3541s
Epoch: 15 cost time: 64.30735969543457
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0016470
	speed: 0.5478s/iter; left time: 3799.7755s
	iters: 200, epoch: 16 | loss: 0.0844021
	speed: 0.1487s/iter; left time: 1016.4632s
	iters: 300, epoch: 16 | loss: 0.0007251
	speed: 0.1288s/iter; left time: 867.7448s
	iters: 400, epoch: 16 | loss: 0.0018836
	speed: 0.1259s/iter; left time: 835.6193s
Epoch: 16 cost time: 64.12060379981995
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0005339
	speed: 0.5008s/iter; left time: 3238.9907s
	iters: 200, epoch: 17 | loss: 0.0100229
	speed: 0.1280s/iter; left time: 814.7698s
	iters: 300, epoch: 17 | loss: 0.0005928
	speed: 0.1346s/iter; left time: 843.7120s
	iters: 400, epoch: 17 | loss: 0.0012557
	speed: 0.1398s/iter; left time: 862.4342s
Epoch: 17 cost time: 64.63017416000366
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0031819
	speed: 0.5977s/iter; left time: 3584.8692s
	iters: 200, epoch: 18 | loss: 0.0458681
	speed: 0.1501s/iter; left time: 885.3961s
	iters: 300, epoch: 18 | loss: 0.0006506
	speed: 0.1573s/iter; left time: 912.0413s
	iters: 400, epoch: 18 | loss: 0.0046782
	speed: 0.1527s/iter; left time: 870.2879s
Epoch: 18 cost time: 71.4927122592926
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0013560
	speed: 0.6518s/iter; left time: 3603.9620s
	iters: 200, epoch: 19 | loss: 0.0015082
	speed: 0.1644s/iter; left time: 892.6171s
	iters: 300, epoch: 19 | loss: 0.0007531
	speed: 0.1548s/iter; left time: 824.9157s
	iters: 400, epoch: 19 | loss: 0.0011060
	speed: 0.1527s/iter; left time: 798.6414s
Epoch: 19 cost time: 74.68263816833496
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0009580
	speed: 0.5969s/iter; left time: 3020.3152s
	iters: 200, epoch: 20 | loss: 0.0300382
	speed: 0.1508s/iter; left time: 748.1091s
	iters: 300, epoch: 20 | loss: 0.0200208
	speed: 0.1553s/iter; left time: 754.5851s
	iters: 400, epoch: 20 | loss: 0.0048321
	speed: 0.1527s/iter; left time: 726.8684s
Epoch: 20 cost time: 72.19541525840759
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0004598
	speed: 0.5643s/iter; left time: 2590.8583s
	iters: 200, epoch: 21 | loss: 0.0008521
	speed: 0.1207s/iter; left time: 541.9645s
	iters: 300, epoch: 21 | loss: 0.0529701
	speed: 0.1315s/iter; left time: 577.5683s
	iters: 400, epoch: 21 | loss: 0.0014053
	speed: 0.1250s/iter; left time: 536.2324s
Epoch: 21 cost time: 60.95035147666931
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 1760106
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6445576
	speed: 0.1162s/iter; left time: 1623.1761s
	iters: 200, epoch: 1 | loss: 0.8766641
	speed: 0.0986s/iter; left time: 1368.1525s
	iters: 300, epoch: 1 | loss: 0.5016649
	speed: 0.0952s/iter; left time: 1311.2976s
	iters: 400, epoch: 1 | loss: 0.2442008
	speed: 0.1034s/iter; left time: 1413.0774s
Epoch: 1 cost time: 48.88932824134827
Epoch: 1, Steps: 469 | Train Loss: 0.980 Vali Loss: 0.241 Vali Acc: 0.934 Test Loss: 0.241 Test Acc: 0.934
Validation loss decreased (inf --> -0.933674).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1227130
	speed: 0.4396s/iter; left time: 5934.9120s
	iters: 200, epoch: 2 | loss: 0.2872495
	speed: 0.0962s/iter; left time: 1288.8555s
	iters: 300, epoch: 2 | loss: 0.0417893
	speed: 0.0926s/iter; left time: 1231.8615s
	iters: 400, epoch: 2 | loss: 0.0950936
	speed: 0.0942s/iter; left time: 1243.4263s
Epoch: 2 cost time: 45.35296845436096
Epoch: 2, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.933674 --> -0.968838).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0582537
	speed: 0.4071s/iter; left time: 5305.1946s
	iters: 200, epoch: 3 | loss: 0.0779281
	speed: 0.1023s/iter; left time: 1322.4828s
	iters: 300, epoch: 3 | loss: 0.0329030
	speed: 0.1118s/iter; left time: 1434.2704s
	iters: 400, epoch: 3 | loss: 0.0164078
	speed: 0.1135s/iter; left time: 1445.3047s
Epoch: 3 cost time: 51.03908848762512
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0035244
	speed: 0.5601s/iter; left time: 7036.7279s
	iters: 200, epoch: 4 | loss: 0.1218667
	speed: 0.1475s/iter; left time: 1838.0193s
	iters: 300, epoch: 4 | loss: 0.0114733
	speed: 0.1473s/iter; left time: 1820.8270s
	iters: 400, epoch: 4 | loss: 0.0352288
	speed: 0.1462s/iter; left time: 1792.8802s
Epoch: 4 cost time: 68.7210910320282
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.968838 --> -0.969696).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1085999
	speed: 0.6320s/iter; left time: 7644.2526s
	iters: 200, epoch: 5 | loss: 0.0125898
	speed: 0.1474s/iter; left time: 1767.6564s
	iters: 300, epoch: 5 | loss: 0.0040876
	speed: 0.1559s/iter; left time: 1854.9453s
	iters: 400, epoch: 5 | loss: 0.0024680
	speed: 0.1571s/iter; left time: 1852.7587s
Epoch: 5 cost time: 71.6945698261261
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.969696 --> -0.974842).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0026909
	speed: 0.6272s/iter; left time: 7291.9372s
	iters: 200, epoch: 6 | loss: 0.0162507
	speed: 0.1442s/iter; left time: 1662.1919s
	iters: 300, epoch: 6 | loss: 0.0192344
	speed: 0.1477s/iter; left time: 1688.0344s
	iters: 400, epoch: 6 | loss: 0.0089754
	speed: 0.1474s/iter; left time: 1669.6146s
Epoch: 6 cost time: 69.30467963218689
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0115857
	speed: 0.6411s/iter; left time: 7152.6670s
	iters: 200, epoch: 7 | loss: 0.0106422
	speed: 0.1533s/iter; left time: 1694.6558s
	iters: 300, epoch: 7 | loss: 0.0106368
	speed: 0.1558s/iter; left time: 1706.8237s
	iters: 400, epoch: 7 | loss: 0.0018237
	speed: 0.1501s/iter; left time: 1629.8036s
Epoch: 7 cost time: 71.9585964679718
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.975700 --> -0.979702).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2014873
	speed: 0.6021s/iter; left time: 6434.9990s
	iters: 200, epoch: 8 | loss: 0.0016435
	speed: 0.1362s/iter; left time: 1441.5886s
	iters: 300, epoch: 8 | loss: 0.0029923
	speed: 0.1368s/iter; left time: 1434.4315s
	iters: 400, epoch: 8 | loss: 0.0045929
	speed: 0.1386s/iter; left time: 1439.5038s
Epoch: 8 cost time: 64.94214034080505
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0030092
	speed: 0.5987s/iter; left time: 6118.2629s
	iters: 200, epoch: 9 | loss: 0.0012586
	speed: 0.1351s/iter; left time: 1367.3698s
	iters: 300, epoch: 9 | loss: 0.0084858
	speed: 0.1350s/iter; left time: 1353.0176s
	iters: 400, epoch: 9 | loss: 0.0021983
	speed: 0.1317s/iter; left time: 1306.2099s
Epoch: 9 cost time: 63.77436184883118
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980560).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0146221
	speed: 0.5609s/iter; left time: 5468.7612s
	iters: 200, epoch: 10 | loss: 0.0558114
	speed: 0.1418s/iter; left time: 1368.7925s
	iters: 300, epoch: 10 | loss: 0.0009729
	speed: 0.1432s/iter; left time: 1367.6368s
	iters: 400, epoch: 10 | loss: 0.0013150
	speed: 0.1369s/iter; left time: 1293.3232s
Epoch: 10 cost time: 65.20450282096863
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0020124
	speed: 0.5834s/iter; left time: 5414.8010s
	iters: 200, epoch: 11 | loss: 0.0270215
	speed: 0.1367s/iter; left time: 1254.7611s
	iters: 300, epoch: 11 | loss: 0.0007600
	speed: 0.1394s/iter; left time: 1266.3357s
	iters: 400, epoch: 11 | loss: 0.0012901
	speed: 0.1303s/iter; left time: 1170.6592s
Epoch: 11 cost time: 63.31923532485962
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007252
	speed: 0.5691s/iter; left time: 5015.1485s
	iters: 200, epoch: 12 | loss: 0.0014329
	speed: 0.1535s/iter; left time: 1337.2671s
	iters: 300, epoch: 12 | loss: 0.0004959
	speed: 0.1554s/iter; left time: 1338.1652s
	iters: 400, epoch: 12 | loss: 0.0293220
	speed: 0.1565s/iter; left time: 1331.9090s
Epoch: 12 cost time: 71.2413501739502
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0449989
	speed: 0.6442s/iter; left time: 5374.1545s
	iters: 200, epoch: 13 | loss: 0.0013572
	speed: 0.1466s/iter; left time: 1208.4795s
	iters: 300, epoch: 13 | loss: 0.0030023
	speed: 0.1465s/iter; left time: 1193.2236s
	iters: 400, epoch: 13 | loss: 0.0034767
	speed: 0.1505s/iter; left time: 1210.1426s
Epoch: 13 cost time: 69.34134888648987
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0036146
	speed: 0.6427s/iter; left time: 5060.4553s
	iters: 200, epoch: 14 | loss: 0.0019780
	speed: 0.1540s/iter; left time: 1197.4295s
	iters: 300, epoch: 14 | loss: 0.0035952
	speed: 0.1517s/iter; left time: 1164.3501s
	iters: 400, epoch: 14 | loss: 0.0528417
	speed: 0.1548s/iter; left time: 1172.4913s
Epoch: 14 cost time: 72.40385580062866
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0006126
	speed: 0.6263s/iter; left time: 4637.7700s
	iters: 200, epoch: 15 | loss: 0.0011261
	speed: 0.1444s/iter; left time: 1054.7886s
	iters: 300, epoch: 15 | loss: 0.0803635
	speed: 0.1444s/iter; left time: 1040.6601s
	iters: 400, epoch: 15 | loss: 0.0006197
	speed: 0.1463s/iter; left time: 1039.3328s
Epoch: 15 cost time: 67.82429766654968
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0007230
	speed: 0.5789s/iter; left time: 4015.0837s
	iters: 200, epoch: 16 | loss: 0.0034539
	speed: 0.1471s/iter; left time: 1005.7539s
	iters: 300, epoch: 16 | loss: 0.0005149
	speed: 0.1485s/iter; left time: 1000.5539s
	iters: 400, epoch: 16 | loss: 0.0004668
	speed: 0.1457s/iter; left time: 966.8301s
Epoch: 16 cost time: 68.85448431968689
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0010356
	speed: 0.5621s/iter; left time: 3634.8775s
	iters: 200, epoch: 17 | loss: 0.0003242
	speed: 0.1282s/iter; left time: 816.1224s
	iters: 300, epoch: 17 | loss: 0.0017946
	speed: 0.1278s/iter; left time: 800.9004s
	iters: 400, epoch: 17 | loss: 0.0003389
	speed: 0.1293s/iter; left time: 797.4001s
Epoch: 17 cost time: 61.279714822769165
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0018171
	speed: 0.5623s/iter; left time: 3372.5812s
	iters: 200, epoch: 18 | loss: 0.0135047
	speed: 0.1333s/iter; left time: 786.4319s
	iters: 300, epoch: 18 | loss: 0.0003423
	speed: 0.1313s/iter; left time: 760.9949s
	iters: 400, epoch: 18 | loss: 0.0008173
	speed: 0.1252s/iter; left time: 713.3234s
Epoch: 18 cost time: 60.7094464302063
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0003362
	speed: 0.4876s/iter; left time: 2695.8155s
	iters: 200, epoch: 19 | loss: 0.0004721
	speed: 0.1296s/iter; left time: 703.7296s
	iters: 300, epoch: 19 | loss: 0.0006507
	speed: 0.1407s/iter; left time: 749.5293s
	iters: 400, epoch: 19 | loss: 0.0005098
	speed: 0.1342s/iter; left time: 701.7227s
Epoch: 19 cost time: 62.1517915725708
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 518538
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5349853
	speed: 0.1680s/iter; left time: 2347.4783s
	iters: 200, epoch: 1 | loss: 0.8522572
	speed: 0.1510s/iter; left time: 2094.5257s
	iters: 300, epoch: 1 | loss: 0.2649610
	speed: 0.1463s/iter; left time: 2014.9888s
	iters: 400, epoch: 1 | loss: 0.2509854
	speed: 0.1496s/iter; left time: 2045.3075s
Epoch: 1 cost time: 73.5226354598999
Epoch: 1, Steps: 469 | Train Loss: 0.919 Vali Loss: 0.292 Vali Acc: 0.915 Test Loss: 0.292 Test Acc: 0.915
Validation loss decreased (inf --> -0.914520).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1656671
	speed: 0.6708s/iter; left time: 9056.7791s
	iters: 200, epoch: 2 | loss: 0.1369998
	speed: 0.1722s/iter; left time: 2307.8977s
	iters: 300, epoch: 2 | loss: 0.1249468
	speed: 0.1707s/iter; left time: 2270.3551s
	iters: 400, epoch: 2 | loss: 0.0577191
	speed: 0.1700s/iter; left time: 2243.8803s
Epoch: 2 cost time: 80.73196578025818
Epoch: 2, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.914520 --> -0.950542).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0182426
	speed: 0.6549s/iter; left time: 8535.5123s
	iters: 200, epoch: 3 | loss: 0.3139493
	speed: 0.1636s/iter; left time: 2116.3377s
	iters: 300, epoch: 3 | loss: 0.0191929
	speed: 0.1654s/iter; left time: 2122.8085s
	iters: 400, epoch: 3 | loss: 0.1770792
	speed: 0.1719s/iter; left time: 2189.1658s
Epoch: 3 cost time: 79.03097748756409
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.950542 --> -0.967981).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0228655
	speed: 0.6295s/iter; left time: 7908.9557s
	iters: 200, epoch: 4 | loss: 0.0181403
	speed: 0.1743s/iter; left time: 2172.5945s
	iters: 300, epoch: 4 | loss: 0.1513229
	speed: 0.1719s/iter; left time: 2124.7974s
	iters: 400, epoch: 4 | loss: 0.3215878
	speed: 0.1801s/iter; left time: 2208.6910s
Epoch: 4 cost time: 83.00043201446533
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2629508
	speed: 0.6900s/iter; left time: 8345.0294s
	iters: 200, epoch: 5 | loss: 0.2002025
	speed: 0.1783s/iter; left time: 2139.1609s
	iters: 300, epoch: 5 | loss: 0.0038703
	speed: 0.1710s/iter; left time: 2033.7299s
	iters: 400, epoch: 5 | loss: 0.0945367
	speed: 0.1736s/iter; left time: 2047.1959s
Epoch: 5 cost time: 82.22026062011719
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.967981 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2366430
	speed: 0.6294s/iter; left time: 7317.7150s
	iters: 200, epoch: 6 | loss: 0.0041667
	speed: 0.1556s/iter; left time: 1792.9314s
	iters: 300, epoch: 6 | loss: 0.0128231
	speed: 0.1624s/iter; left time: 1855.2061s
	iters: 400, epoch: 6 | loss: 0.0039470
	speed: 0.1611s/iter; left time: 1824.2188s
Epoch: 6 cost time: 74.92591571807861
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0019649
	speed: 0.6319s/iter; left time: 7050.3732s
	iters: 200, epoch: 7 | loss: 0.0587074
	speed: 0.1596s/iter; left time: 1764.5564s
	iters: 300, epoch: 7 | loss: 0.0071547
	speed: 0.1679s/iter; left time: 1839.7595s
	iters: 400, epoch: 7 | loss: 0.0066395
	speed: 0.1608s/iter; left time: 1745.3023s
Epoch: 7 cost time: 75.30860877037048
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0242450
	speed: 0.6017s/iter; left time: 6430.6661s
	iters: 200, epoch: 8 | loss: 0.0082702
	speed: 0.1553s/iter; left time: 1644.1502s
	iters: 300, epoch: 8 | loss: 0.0060131
	speed: 0.1563s/iter; left time: 1638.9802s
	iters: 400, epoch: 8 | loss: 0.0512571
	speed: 0.1117s/iter; left time: 1160.5961s
Epoch: 8 cost time: 67.51474857330322
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0077079
	speed: 0.5765s/iter; left time: 5890.9602s
	iters: 200, epoch: 9 | loss: 0.0187878
	speed: 0.1552s/iter; left time: 1570.5245s
	iters: 300, epoch: 9 | loss: 0.0098868
	speed: 0.1561s/iter; left time: 1563.7684s
	iters: 400, epoch: 9 | loss: 0.0238216
	speed: 0.1542s/iter; left time: 1529.3244s
Epoch: 9 cost time: 72.72757005691528
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1103026
	speed: 0.6511s/iter; left time: 6347.7805s
	iters: 200, epoch: 10 | loss: 0.3160033
	speed: 0.1718s/iter; left time: 1658.3360s
	iters: 300, epoch: 10 | loss: 0.0678926
	speed: 0.1647s/iter; left time: 1572.5535s
	iters: 400, epoch: 10 | loss: 0.0031898
	speed: 0.1680s/iter; left time: 1587.7620s
Epoch: 10 cost time: 78.82867860794067
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
Validation loss decreased (-0.973984 --> -0.973984).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0012950
	speed: 0.6100s/iter; left time: 5661.5561s
	iters: 200, epoch: 11 | loss: 0.0031834
	speed: 0.1694s/iter; left time: 1555.5084s
	iters: 300, epoch: 11 | loss: 0.0032139
	speed: 0.2095s/iter; left time: 1902.5501s
	iters: 400, epoch: 11 | loss: 0.0021829
	speed: 0.2263s/iter; left time: 2032.7358s
Epoch: 11 cost time: 92.51429963111877
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
Validation loss decreased (-0.973984 --> -0.981703).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1060184
	speed: 0.8809s/iter; left time: 7762.5059s
	iters: 200, epoch: 12 | loss: 0.0049458
	speed: 0.2229s/iter; left time: 1941.9303s
	iters: 300, epoch: 12 | loss: 0.0007168
	speed: 0.2230s/iter; left time: 1920.7966s
	iters: 400, epoch: 12 | loss: 0.0030747
	speed: 0.2202s/iter; left time: 1874.5430s
Epoch: 12 cost time: 104.28552174568176
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0017449
	speed: 0.8497s/iter; left time: 7088.6908s
	iters: 200, epoch: 13 | loss: 0.0003990
	speed: 0.2083s/iter; left time: 1716.9384s
	iters: 300, epoch: 13 | loss: 0.0041659
	speed: 0.2103s/iter; left time: 1712.2348s
	iters: 400, epoch: 13 | loss: 0.0009351
	speed: 0.2047s/iter; left time: 1646.6797s
Epoch: 13 cost time: 98.49850249290466
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0007397
	speed: 0.8324s/iter; left time: 6554.4015s
	iters: 200, epoch: 14 | loss: 0.1411907
	speed: 0.2055s/iter; left time: 1597.5531s
	iters: 300, epoch: 14 | loss: 0.1255728
	speed: 0.2061s/iter; left time: 1581.4249s
	iters: 400, epoch: 14 | loss: 0.0016833
	speed: 0.2024s/iter; left time: 1532.6768s
Epoch: 14 cost time: 95.95995759963989
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0006159
	speed: 0.8111s/iter; left time: 6006.3332s
	iters: 200, epoch: 15 | loss: 0.0005699
	speed: 0.1975s/iter; left time: 1443.0765s
	iters: 300, epoch: 15 | loss: 0.0061304
	speed: 0.1955s/iter; left time: 1408.6838s
	iters: 400, epoch: 15 | loss: 0.0066542
	speed: 0.1994s/iter; left time: 1416.3910s
Epoch: 15 cost time: 92.50460863113403
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0486849
	speed: 0.6922s/iter; left time: 4800.9331s
	iters: 200, epoch: 16 | loss: 0.0115200
	speed: 0.1833s/iter; left time: 1252.7814s
	iters: 300, epoch: 16 | loss: 0.0086238
	speed: 0.1910s/iter; left time: 1286.5838s
	iters: 400, epoch: 16 | loss: 0.0863822
	speed: 0.1888s/iter; left time: 1252.6277s
Epoch: 16 cost time: 87.62808990478516
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.981703 --> -0.984848).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0013491
	speed: 0.7518s/iter; left time: 4861.6658s
	iters: 200, epoch: 17 | loss: 0.0009124
	speed: 0.1943s/iter; left time: 1237.1934s
	iters: 300, epoch: 17 | loss: 0.0014478
	speed: 0.1694s/iter; left time: 1061.9295s
	iters: 400, epoch: 17 | loss: 0.0054360
	speed: 0.2033s/iter; left time: 1253.9819s
Epoch: 17 cost time: 89.80993509292603
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0086197
	speed: 0.7976s/iter; left time: 4784.2421s
	iters: 200, epoch: 18 | loss: 0.0965170
	speed: 0.2081s/iter; left time: 1227.4025s
	iters: 300, epoch: 18 | loss: 0.0016286
	speed: 0.2107s/iter; left time: 1221.5892s
	iters: 400, epoch: 18 | loss: 0.0036063
	speed: 0.2082s/iter; left time: 1186.1115s
Epoch: 18 cost time: 99.46411371231079
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0174571
	speed: 0.8582s/iter; left time: 4745.0676s
	iters: 200, epoch: 19 | loss: 0.0081096
	speed: 0.2137s/iter; left time: 1160.2910s
	iters: 300, epoch: 19 | loss: 0.0017207
	speed: 0.2174s/iter; left time: 1158.7266s
	iters: 400, epoch: 19 | loss: 0.0236500
	speed: 0.2163s/iter; left time: 1131.1773s
Epoch: 19 cost time: 102.36808180809021
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0009591
	speed: 0.8658s/iter; left time: 4380.9067s
	iters: 200, epoch: 20 | loss: 0.0012961
	speed: 0.2185s/iter; left time: 1083.8943s
	iters: 300, epoch: 20 | loss: 0.0007923
	speed: 0.2135s/iter; left time: 1037.5540s
	iters: 400, epoch: 20 | loss: 0.0016422
	speed: 0.2161s/iter; left time: 1028.4979s
Epoch: 20 cost time: 101.1745171546936
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0044754
	speed: 0.8516s/iter; left time: 3909.8810s
	iters: 200, epoch: 21 | loss: 0.0012472
	speed: 0.2140s/iter; left time: 960.9450s
	iters: 300, epoch: 21 | loss: 0.0028039
	speed: 0.2142s/iter; left time: 940.3589s
	iters: 400, epoch: 21 | loss: 0.0016252
	speed: 0.2162s/iter; left time: 927.7386s
Epoch: 21 cost time: 101.29281854629517
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.984848 --> -0.986563).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0004927
	speed: 0.8618s/iter; left time: 3552.1772s
	iters: 200, epoch: 22 | loss: 0.0095200
	speed: 0.2109s/iter; left time: 848.0444s
	iters: 300, epoch: 22 | loss: 0.0014679
	speed: 0.2010s/iter; left time: 788.5005s
	iters: 400, epoch: 22 | loss: 0.0013079
	speed: 0.1974s/iter; left time: 754.3520s
Epoch: 22 cost time: 96.89130806922913
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0007577
	speed: 0.7804s/iter; left time: 2850.9176s
	iters: 200, epoch: 23 | loss: 0.0004648
	speed: 0.2003s/iter; left time: 711.5646s
	iters: 300, epoch: 23 | loss: 0.0002537
	speed: 0.2063s/iter; left time: 712.2100s
	iters: 400, epoch: 23 | loss: 0.0015447
	speed: 0.2037s/iter; left time: 682.9383s
Epoch: 23 cost time: 95.05105257034302
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0009566
	speed: 0.7451s/iter; left time: 2372.3847s
	iters: 200, epoch: 24 | loss: 0.1515615
	speed: 0.1892s/iter; left time: 583.4411s
	iters: 300, epoch: 24 | loss: 0.0022288
	speed: 0.1836s/iter; left time: 547.7803s
	iters: 400, epoch: 24 | loss: 0.0306876
	speed: 0.1825s/iter; left time: 526.3701s
Epoch: 24 cost time: 85.29392766952515
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0012264
	speed: 0.7365s/iter; left time: 1999.5528s
	iters: 200, epoch: 25 | loss: 0.0030808
	speed: 0.1880s/iter; left time: 491.4916s
	iters: 300, epoch: 25 | loss: 0.0003563
	speed: 0.1891s/iter; left time: 475.5020s
	iters: 400, epoch: 25 | loss: 0.0005981
	speed: 0.1926s/iter; left time: 465.1255s
Epoch: 25 cost time: 89.75115942955017
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0001837
	speed: 0.7737s/iter; left time: 1737.6853s
	iters: 200, epoch: 26 | loss: 0.0041834
	speed: 0.1909s/iter; left time: 409.6011s
	iters: 300, epoch: 26 | loss: 0.0240172
	speed: 0.2046s/iter; left time: 418.6777s
	iters: 400, epoch: 26 | loss: 0.0003168
	speed: 0.1874s/iter; left time: 364.7462s
Epoch: 26 cost time: 91.85077953338623
Epoch: 26, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0003132
	speed: 0.8124s/iter; left time: 1443.6458s
	iters: 200, epoch: 27 | loss: 0.0592923
	speed: 0.2024s/iter; left time: 339.4006s
	iters: 300, epoch: 27 | loss: 0.0001228
	speed: 0.2114s/iter; left time: 333.4322s
	iters: 400, epoch: 27 | loss: 0.0030597
	speed: 0.2124s/iter; left time: 313.7529s
Epoch: 27 cost time: 98.10692262649536
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0008768
	speed: 0.8672s/iter; left time: 1134.3311s
	iters: 200, epoch: 28 | loss: 0.0029437
	speed: 0.2218s/iter; left time: 267.9818s
	iters: 300, epoch: 28 | loss: 0.0006246
	speed: 0.2209s/iter; left time: 244.7800s
	iters: 400, epoch: 28 | loss: 0.0005101
	speed: 0.2177s/iter; left time: 219.4512s
Epoch: 28 cost time: 104.0492889881134
Epoch: 28, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0063339
	speed: 0.8448s/iter; left time: 708.7695s
	iters: 200, epoch: 29 | loss: 0.1879913
	speed: 0.2089s/iter; left time: 154.3659s
	iters: 300, epoch: 29 | loss: 0.0204988
	speed: 0.2028s/iter; left time: 129.5793s
	iters: 400, epoch: 29 | loss: 0.0028509
	speed: 0.2084s/iter; left time: 112.3519s
Epoch: 29 cost time: 97.31248617172241
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0005469
	speed: 0.7718s/iter; left time: 285.5494s
	iters: 200, epoch: 30 | loss: 0.0005298
	speed: 0.2088s/iter; left time: 56.3854s
	iters: 300, epoch: 30 | loss: 0.0002450
	speed: 0.2103s/iter; left time: 35.7567s
	iters: 400, epoch: 30 | loss: 0.0013576
	speed: 0.2096s/iter; left time: 14.6751s
Epoch: 30 cost time: 97.08076024055481
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 1760106
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6424756
	speed: 0.1636s/iter; left time: 2285.3620s
	iters: 200, epoch: 1 | loss: 0.8657207
	speed: 0.1474s/iter; left time: 2044.1609s
	iters: 300, epoch: 1 | loss: 0.4881730
	speed: 0.1421s/iter; left time: 1956.6307s
	iters: 400, epoch: 1 | loss: 0.2393642
	speed: 0.1420s/iter; left time: 1941.3642s
Epoch: 1 cost time: 69.47865748405457
Epoch: 1, Steps: 469 | Train Loss: 0.989 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
Validation loss decreased (inf --> -0.925669).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1687424
	speed: 0.6049s/iter; left time: 8167.3101s
	iters: 200, epoch: 2 | loss: 0.3021560
	speed: 0.1421s/iter; left time: 1904.7533s
	iters: 300, epoch: 2 | loss: 0.0546805
	speed: 0.1503s/iter; left time: 1999.5256s
	iters: 400, epoch: 2 | loss: 0.2181523
	speed: 0.1371s/iter; left time: 1809.3588s
Epoch: 2 cost time: 65.1966438293457
Epoch: 2, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.925669 --> -0.972555).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0597885
	speed: 0.6418s/iter; left time: 8364.0556s
	iters: 200, epoch: 3 | loss: 0.0946515
	speed: 0.1530s/iter; left time: 1978.6293s
	iters: 300, epoch: 3 | loss: 0.0222080
	speed: 0.1453s/iter; left time: 1864.5602s
	iters: 400, epoch: 3 | loss: 0.0141119
	speed: 0.1446s/iter; left time: 1841.3672s
Epoch: 3 cost time: 69.9097752571106
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0030022
	speed: 0.6564s/iter; left time: 8247.2493s
	iters: 200, epoch: 4 | loss: 0.0838693
	speed: 0.1478s/iter; left time: 1842.0983s
	iters: 300, epoch: 4 | loss: 0.0115717
	speed: 0.1231s/iter; left time: 1522.6053s
	iters: 400, epoch: 4 | loss: 0.0716235
	speed: 0.1391s/iter; left time: 1705.4740s
Epoch: 4 cost time: 66.0535261631012
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.973984).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0061461
	speed: 0.6157s/iter; left time: 7446.8287s
	iters: 200, epoch: 5 | loss: 0.0159406
	speed: 0.1487s/iter; left time: 1784.1971s
	iters: 300, epoch: 5 | loss: 0.0056368
	speed: 0.1555s/iter; left time: 1850.1138s
	iters: 400, epoch: 5 | loss: 0.0023523
	speed: 0.1525s/iter; left time: 1798.3965s
Epoch: 5 cost time: 71.05449151992798
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.976271).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0072474
	speed: 0.6900s/iter; left time: 8022.0997s
	iters: 200, epoch: 6 | loss: 0.0469043
	speed: 0.1612s/iter; left time: 1857.6608s
	iters: 300, epoch: 6 | loss: 0.0054275
	speed: 0.1620s/iter; left time: 1850.6827s
	iters: 400, epoch: 6 | loss: 0.0275784
	speed: 0.1624s/iter; left time: 1838.7814s
Epoch: 6 cost time: 76.87183570861816
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0065617
	speed: 0.7698s/iter; left time: 8588.3514s
	iters: 200, epoch: 7 | loss: 0.0035118
	speed: 0.1605s/iter; left time: 1774.3755s
	iters: 300, epoch: 7 | loss: 0.0049514
	speed: 0.1618s/iter; left time: 1773.1782s
	iters: 400, epoch: 7 | loss: 0.0091748
	speed: 0.1591s/iter; left time: 1726.9274s
Epoch: 7 cost time: 75.91468834877014
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976271 --> -0.980274).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0490101
	speed: 0.7275s/iter; left time: 7775.2052s
	iters: 200, epoch: 8 | loss: 0.0023334
	speed: 0.1639s/iter; left time: 1735.6915s
	iters: 300, epoch: 8 | loss: 0.0059941
	speed: 0.1691s/iter; left time: 1773.5626s
	iters: 400, epoch: 8 | loss: 0.0031412
	speed: 0.1584s/iter; left time: 1644.9813s
Epoch: 8 cost time: 77.08320665359497
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.980274 --> -0.980560).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020778
	speed: 0.7292s/iter; left time: 7451.7580s
	iters: 200, epoch: 9 | loss: 0.0009821
	speed: 0.1710s/iter; left time: 1730.2489s
	iters: 300, epoch: 9 | loss: 0.0125047
	speed: 0.1734s/iter; left time: 1737.0095s
	iters: 400, epoch: 9 | loss: 0.0145832
	speed: 0.1705s/iter; left time: 1691.2375s
Epoch: 9 cost time: 80.1231861114502
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.980560 --> -0.983990).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0115902
	speed: 0.7017s/iter; left time: 6841.7799s
	iters: 200, epoch: 10 | loss: 0.0440081
	speed: 0.1490s/iter; left time: 1438.1083s
	iters: 300, epoch: 10 | loss: 0.0011558
	speed: 0.1483s/iter; left time: 1415.9548s
	iters: 400, epoch: 10 | loss: 0.0306666
	speed: 0.1531s/iter; left time: 1446.9714s
Epoch: 10 cost time: 70.6844470500946
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1137977
	speed: 0.6657s/iter; left time: 6178.7049s
	iters: 200, epoch: 11 | loss: 0.0046099
	speed: 0.1436s/iter; left time: 1317.9876s
	iters: 300, epoch: 11 | loss: 0.0618212
	speed: 0.1436s/iter; left time: 1304.3712s
	iters: 400, epoch: 11 | loss: 0.0106215
	speed: 0.1432s/iter; left time: 1285.8417s
Epoch: 11 cost time: 68.03190732002258
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0004669
	speed: 0.6984s/iter; left time: 6154.5677s
	iters: 200, epoch: 12 | loss: 0.0013907
	speed: 0.1463s/iter; left time: 1274.7632s
	iters: 300, epoch: 12 | loss: 0.0023876
	speed: 0.1495s/iter; left time: 1287.9082s
	iters: 400, epoch: 12 | loss: 0.0062284
	speed: 0.1487s/iter; left time: 1265.8332s
Epoch: 12 cost time: 70.65244817733765
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0656089
	speed: 0.6906s/iter; left time: 5761.8854s
	iters: 200, epoch: 13 | loss: 0.0031592
	speed: 0.1575s/iter; left time: 1297.9431s
	iters: 300, epoch: 13 | loss: 0.0010242
	speed: 0.1467s/iter; left time: 1194.4803s
	iters: 400, epoch: 13 | loss: 0.0014904
	speed: 0.1448s/iter; left time: 1164.6962s
Epoch: 13 cost time: 70.84328532218933
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0004380
	speed: 0.5959s/iter; left time: 4692.1127s
	iters: 200, epoch: 14 | loss: 0.0641298
	speed: 0.1429s/iter; left time: 1111.2521s
	iters: 300, epoch: 14 | loss: 0.0013579
	speed: 0.1510s/iter; left time: 1159.1003s
	iters: 400, epoch: 14 | loss: 0.0342149
	speed: 0.1554s/iter; left time: 1177.2054s
Epoch: 14 cost time: 70.21362590789795
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0002998
	speed: 0.6933s/iter; left time: 5134.1770s
	iters: 200, epoch: 15 | loss: 0.0147781
	speed: 0.1651s/iter; left time: 1206.1569s
	iters: 300, epoch: 15 | loss: 0.0306701
	speed: 0.1642s/iter; left time: 1182.7164s
	iters: 400, epoch: 15 | loss: 0.0004363
	speed: 0.1649s/iter; left time: 1171.8944s
Epoch: 15 cost time: 76.86130738258362
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0117711
	speed: 0.6984s/iter; left time: 4844.4430s
	iters: 200, epoch: 16 | loss: 0.0023164
	speed: 0.1589s/iter; left time: 1085.9853s
	iters: 300, epoch: 16 | loss: 0.2306414
	speed: 0.1624s/iter; left time: 1093.8509s
	iters: 400, epoch: 16 | loss: 0.0005644
	speed: 0.1589s/iter; left time: 1054.7235s
Epoch: 16 cost time: 74.59647583961487
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0027474
	speed: 0.6666s/iter; left time: 4310.9848s
	iters: 200, epoch: 17 | loss: 0.0006994
	speed: 0.1489s/iter; left time: 947.7359s
	iters: 300, epoch: 17 | loss: 0.0022575
	speed: 0.1538s/iter; left time: 963.8808s
	iters: 400, epoch: 17 | loss: 0.0048075
	speed: 0.1638s/iter; left time: 1010.4081s
Epoch: 17 cost time: 70.72190356254578
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0009186
	speed: 0.7308s/iter; left time: 4383.5092s
	iters: 200, epoch: 18 | loss: 0.0057438
	speed: 0.1589s/iter; left time: 937.0691s
	iters: 300, epoch: 18 | loss: 0.0007066
	speed: 0.1580s/iter; left time: 916.0434s
	iters: 400, epoch: 18 | loss: 0.0006401
	speed: 0.1580s/iter; left time: 900.0964s
Epoch: 18 cost time: 75.35869455337524
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0006987
	speed: 0.7567s/iter; left time: 4183.9946s
	iters: 200, epoch: 19 | loss: 0.0003564
	speed: 0.1595s/iter; left time: 866.0659s
	iters: 300, epoch: 19 | loss: 0.0004783
	speed: 0.1487s/iter; left time: 792.6613s
	iters: 400, epoch: 19 | loss: 0.0004613
	speed: 0.1429s/iter; left time: 746.9691s
Epoch: 19 cost time: 71.8929705619812
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 518538
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6088718
	speed: 0.1982s/iter; left time: 2769.4218s
	iters: 200, epoch: 1 | loss: 1.0003928
	speed: 0.1810s/iter; left time: 2510.2698s
	iters: 300, epoch: 1 | loss: 0.4297995
	speed: 0.1693s/iter; left time: 2331.6188s
	iters: 400, epoch: 1 | loss: 0.3677639
	speed: 0.1915s/iter; left time: 2618.1882s
Epoch: 1 cost time: 87.95794463157654
Epoch: 1, Steps: 469 | Train Loss: 1.034 Vali Loss: 0.368 Vali Acc: 0.887 Test Loss: 0.368 Test Acc: 0.887
Validation loss decreased (inf --> -0.887075).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2019101
	speed: 0.7560s/iter; left time: 10207.3787s
	iters: 200, epoch: 2 | loss: 0.2448023
	speed: 0.1861s/iter; left time: 2493.9505s
	iters: 300, epoch: 2 | loss: 0.0972295
	speed: 0.1897s/iter; left time: 2523.4834s
	iters: 400, epoch: 2 | loss: 0.1306017
	speed: 0.1855s/iter; left time: 2448.7168s
Epoch: 2 cost time: 88.10175633430481
Epoch: 2, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
Validation loss decreased (-0.887075 --> -0.951685).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0431854
	speed: 0.7272s/iter; left time: 9476.9665s
	iters: 200, epoch: 3 | loss: 0.1847357
	speed: 0.2038s/iter; left time: 2636.0156s
	iters: 300, epoch: 3 | loss: 0.0609624
	speed: 0.2017s/iter; left time: 2588.7787s
	iters: 400, epoch: 3 | loss: 0.1968019
	speed: 0.2034s/iter; left time: 2590.3210s
Epoch: 3 cost time: 95.5999710559845
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.126 Vali Acc: 0.961 Test Loss: 0.126 Test Acc: 0.961
Validation loss decreased (-0.951685 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0297484
	speed: 0.7809s/iter; left time: 9811.3718s
	iters: 200, epoch: 4 | loss: 0.1256320
	speed: 0.2073s/iter; left time: 2584.3681s
	iters: 300, epoch: 4 | loss: 0.1085275
	speed: 0.2099s/iter; left time: 2595.2822s
	iters: 400, epoch: 4 | loss: 0.3788837
	speed: 0.2036s/iter; left time: 2497.4508s
Epoch: 4 cost time: 97.17597341537476
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
Validation loss decreased (-0.961405 --> -0.967123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4274531
	speed: 0.7825s/iter; left time: 9464.4142s
	iters: 200, epoch: 5 | loss: 0.0243037
	speed: 0.2038s/iter; left time: 2444.3497s
	iters: 300, epoch: 5 | loss: 0.0084280
	speed: 0.1833s/iter; left time: 2179.9392s
	iters: 400, epoch: 5 | loss: 0.0750974
	speed: 0.1665s/iter; left time: 1964.4117s
Epoch: 5 cost time: 88.80520915985107
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.967123 --> -0.978558).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3057389
	speed: 0.7012s/iter; left time: 8152.3261s
	iters: 200, epoch: 6 | loss: 0.0072691
	speed: 0.1971s/iter; left time: 2272.0406s
	iters: 300, epoch: 6 | loss: 0.0632513
	speed: 0.1972s/iter; left time: 2252.6431s
	iters: 400, epoch: 6 | loss: 0.0360151
	speed: 0.1988s/iter; left time: 2251.7877s
Epoch: 6 cost time: 92.18687772750854
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0033911
	speed: 0.7863s/iter; left time: 8772.4876s
	iters: 200, epoch: 7 | loss: 0.0182472
	speed: 0.2060s/iter; left time: 2278.2252s
	iters: 300, epoch: 7 | loss: 0.0049352
	speed: 0.1975s/iter; left time: 2163.8532s
	iters: 400, epoch: 7 | loss: 0.0253528
	speed: 0.1988s/iter; left time: 2158.0857s
Epoch: 7 cost time: 94.43493556976318
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0027953
	speed: 0.7305s/iter; left time: 7807.9918s
	iters: 200, epoch: 8 | loss: 0.0080788
	speed: 0.1706s/iter; left time: 1806.2105s
	iters: 300, epoch: 8 | loss: 0.0072818
	speed: 0.1706s/iter; left time: 1789.3132s
	iters: 400, epoch: 8 | loss: 0.2206132
	speed: 0.1632s/iter; left time: 1695.3121s
Epoch: 8 cost time: 80.21683549880981
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0035462
	speed: 0.6523s/iter; left time: 6665.3561s
	iters: 200, epoch: 9 | loss: 0.0530580
	speed: 0.1897s/iter; left time: 1919.8588s
	iters: 300, epoch: 9 | loss: 0.0049847
	speed: 0.1873s/iter; left time: 1876.3553s
	iters: 400, epoch: 9 | loss: 0.0049328
	speed: 0.1890s/iter; left time: 1874.4753s
Epoch: 9 cost time: 85.25261282920837
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978844).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0040376
	speed: 0.7339s/iter; left time: 7155.1514s
	iters: 200, epoch: 10 | loss: 0.2065095
	speed: 0.1839s/iter; left time: 1774.9846s
	iters: 300, epoch: 10 | loss: 0.0097269
	speed: 0.1849s/iter; left time: 1765.4309s
	iters: 400, epoch: 10 | loss: 0.0042331
	speed: 0.1831s/iter; left time: 1729.8890s
Epoch: 10 cost time: 88.30975866317749
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0058279
	speed: 0.7500s/iter; left time: 6960.4482s
	iters: 200, epoch: 11 | loss: 0.0598343
	speed: 0.1965s/iter; left time: 1804.2534s
	iters: 300, epoch: 11 | loss: 0.0100695
	speed: 0.1980s/iter; left time: 1797.8056s
	iters: 400, epoch: 11 | loss: 0.0020786
	speed: 0.1937s/iter; left time: 1739.3578s
Epoch: 11 cost time: 91.51668286323547
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.980274).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2544076
	speed: 0.7955s/iter; left time: 7009.5916s
	iters: 200, epoch: 12 | loss: 0.0176905
	speed: 0.2125s/iter; left time: 1850.9286s
	iters: 300, epoch: 12 | loss: 0.0012097
	speed: 0.2119s/iter; left time: 1825.1603s
	iters: 400, epoch: 12 | loss: 0.0008489
	speed: 0.2037s/iter; left time: 1733.8605s
Epoch: 12 cost time: 95.77453446388245
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0917878
	speed: 0.6669s/iter; left time: 5564.1876s
	iters: 200, epoch: 13 | loss: 0.0013150
	speed: 0.1623s/iter; left time: 1337.4598s
	iters: 300, epoch: 13 | loss: 0.0018288
	speed: 0.1637s/iter; left time: 1333.1166s
	iters: 400, epoch: 13 | loss: 0.0003830
	speed: 0.1637s/iter; left time: 1316.4444s
Epoch: 13 cost time: 78.36356782913208
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0015997
	speed: 0.6328s/iter; left time: 4982.5808s
	iters: 200, epoch: 14 | loss: 0.3247504
	speed: 0.1506s/iter; left time: 1170.7933s
	iters: 300, epoch: 14 | loss: 0.0549245
	speed: 0.1611s/iter; left time: 1236.1211s
	iters: 400, epoch: 14 | loss: 0.0008390
	speed: 0.1930s/iter; left time: 1461.9041s
Epoch: 14 cost time: 80.38127303123474
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0025044
	speed: 0.7508s/iter; left time: 5559.3153s
	iters: 200, epoch: 15 | loss: 0.0003045
	speed: 0.2114s/iter; left time: 1544.5269s
	iters: 300, epoch: 15 | loss: 0.0140398
	speed: 0.2102s/iter; left time: 1514.7655s
	iters: 400, epoch: 15 | loss: 0.0247915
	speed: 0.2135s/iter; left time: 1517.0988s
Epoch: 15 cost time: 98.63143920898438
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0023960
	speed: 0.7921s/iter; left time: 5493.7142s
	iters: 200, epoch: 16 | loss: 0.0125584
	speed: 0.1985s/iter; left time: 1356.6720s
	iters: 300, epoch: 16 | loss: 0.0058827
	speed: 0.1992s/iter; left time: 1341.6994s
	iters: 400, epoch: 16 | loss: 0.0181662
	speed: 0.1993s/iter; left time: 1322.4826s
Epoch: 16 cost time: 93.78953552246094
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0008636
	speed: 0.7629s/iter; left time: 4933.4184s
	iters: 200, epoch: 17 | loss: 0.2163859
	speed: 0.1587s/iter; left time: 1010.6972s
	iters: 300, epoch: 17 | loss: 0.0016288
	speed: 0.1679s/iter; left time: 1052.1128s
	iters: 400, epoch: 17 | loss: 0.0010419
	speed: 0.1818s/iter; left time: 1121.4487s
Epoch: 17 cost time: 82.80709505081177
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0045633
	speed: 0.6985s/iter; left time: 4189.6587s
	iters: 200, epoch: 18 | loss: 0.1914354
	speed: 0.1772s/iter; left time: 1045.2007s
	iters: 300, epoch: 18 | loss: 0.0045424
	speed: 0.1746s/iter; left time: 1012.3445s
	iters: 400, epoch: 18 | loss: 0.0027343
	speed: 0.1747s/iter; left time: 995.1992s
Epoch: 18 cost time: 83.16213512420654
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0046596
	speed: 0.6439s/iter; left time: 3560.0676s
	iters: 200, epoch: 19 | loss: 0.0009043
	speed: 0.1734s/iter; left time: 941.2060s
	iters: 300, epoch: 19 | loss: 0.0048066
	speed: 0.1788s/iter; left time: 952.9317s
	iters: 400, epoch: 19 | loss: 0.0017986
	speed: 0.1813s/iter; left time: 948.0411s
Epoch: 19 cost time: 84.8935182094574
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981703).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0011033
	speed: 0.7751s/iter; left time: 3922.0904s
	iters: 200, epoch: 20 | loss: 0.0248862
	speed: 0.2043s/iter; left time: 1013.5607s
	iters: 300, epoch: 20 | loss: 0.0014111
	speed: 0.2082s/iter; left time: 1012.0349s
	iters: 400, epoch: 20 | loss: 0.0014961
	speed: 0.2108s/iter; left time: 1003.1983s
Epoch: 20 cost time: 97.23972249031067
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.981703 --> -0.983704).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0017467
	speed: 0.7860s/iter; left time: 3608.6904s
	iters: 200, epoch: 21 | loss: 0.0004627
	speed: 0.2015s/iter; left time: 904.9511s
	iters: 300, epoch: 21 | loss: 0.1844484
	speed: 0.2035s/iter; left time: 893.6100s
	iters: 400, epoch: 21 | loss: 0.0061756
	speed: 0.1997s/iter; left time: 856.9226s
Epoch: 21 cost time: 93.73042869567871
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0003612
	speed: 0.7056s/iter; left time: 2908.6189s
	iters: 200, epoch: 22 | loss: 0.0132969
	speed: 0.1840s/iter; left time: 740.2299s
	iters: 300, epoch: 22 | loss: 0.0057350
	speed: 0.1838s/iter; left time: 720.7674s
	iters: 400, epoch: 22 | loss: 0.0002632
	speed: 0.1839s/iter; left time: 703.0556s
Epoch: 22 cost time: 86.5283784866333
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0006800
	speed: 0.7112s/iter; left time: 2597.8721s
	iters: 200, epoch: 23 | loss: 0.0004413
	speed: 0.1827s/iter; left time: 649.2901s
	iters: 300, epoch: 23 | loss: 0.0004186
	speed: 0.1500s/iter; left time: 518.0216s
	iters: 400, epoch: 23 | loss: 0.0007253
	speed: 0.1714s/iter; left time: 574.7875s
Epoch: 23 cost time: 80.89656329154968
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0019072
	speed: 0.6573s/iter; left time: 2092.9891s
	iters: 200, epoch: 24 | loss: 0.0015866
	speed: 0.1888s/iter; left time: 582.3996s
	iters: 300, epoch: 24 | loss: 0.0067222
	speed: 0.1896s/iter; left time: 565.7818s
	iters: 400, epoch: 24 | loss: 0.0981754
	speed: 0.1971s/iter; left time: 568.3867s
Epoch: 24 cost time: 87.1639289855957
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0018509
	speed: 0.7353s/iter; left time: 1996.2892s
	iters: 200, epoch: 25 | loss: 0.0005617
	speed: 0.1926s/iter; left time: 503.5551s
	iters: 300, epoch: 25 | loss: 0.0002077
	speed: 0.1961s/iter; left time: 493.0757s
	iters: 400, epoch: 25 | loss: 0.0053571
	speed: 0.1932s/iter; left time: 466.5782s
Epoch: 25 cost time: 91.46984386444092
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.983704 --> -0.983990).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0011238
	speed: 0.7333s/iter; left time: 1646.9485s
	iters: 200, epoch: 26 | loss: 0.0168902
	speed: 0.1697s/iter; left time: 364.2152s
	iters: 300, epoch: 26 | loss: 0.0164501
	speed: 0.1415s/iter; left time: 289.5872s
	iters: 400, epoch: 26 | loss: 0.0001642
	speed: 0.1639s/iter; left time: 318.9496s
Epoch: 26 cost time: 77.13363242149353
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0590643
	speed: 0.6420s/iter; left time: 1140.8191s
	iters: 200, epoch: 27 | loss: 0.0195862
	speed: 0.1715s/iter; left time: 287.5410s
	iters: 300, epoch: 27 | loss: 0.0001037
	speed: 0.1652s/iter; left time: 260.5604s
	iters: 400, epoch: 27 | loss: 0.0045200
	speed: 0.1639s/iter; left time: 242.0347s
Epoch: 27 cost time: 80.5979528427124
Epoch: 27, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0003716
	speed: 0.7081s/iter; left time: 926.2273s
	iters: 200, epoch: 28 | loss: 0.0006765
	speed: 0.1814s/iter; left time: 219.1277s
	iters: 300, epoch: 28 | loss: 0.0001305
	speed: 0.1793s/iter; left time: 198.7049s
	iters: 400, epoch: 28 | loss: 0.0001605
	speed: 0.1691s/iter; left time: 170.4088s
Epoch: 28 cost time: 83.47064757347107
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0068549
	speed: 0.7257s/iter; left time: 608.8853s
	iters: 200, epoch: 29 | loss: 0.0282374
	speed: 0.2006s/iter; left time: 148.2391s
	iters: 300, epoch: 29 | loss: 0.0002780
	speed: 0.1939s/iter; left time: 123.8761s
	iters: 400, epoch: 29 | loss: 0.0010827
	speed: 0.1696s/iter; left time: 91.4228s
Epoch: 29 cost time: 89.264151096344
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0010376
	speed: 0.7469s/iter; left time: 276.3592s
	iters: 200, epoch: 30 | loss: 0.0015318
	speed: 0.1941s/iter; left time: 52.4150s
	iters: 300, epoch: 30 | loss: 0.0001924
	speed: 0.1937s/iter; left time: 32.9315s
	iters: 400, epoch: 30 | loss: 0.0003484
	speed: 0.1948s/iter; left time: 13.6355s
Epoch: 30 cost time: 89.09791159629822
Epoch: 30, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 1760106
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7090825
	speed: 0.1462s/iter; left time: 2042.9989s
	iters: 200, epoch: 1 | loss: 1.0443077
	speed: 0.1285s/iter; left time: 1781.8287s
	iters: 300, epoch: 1 | loss: 0.7022035
	speed: 0.1327s/iter; left time: 1827.5816s
	iters: 400, epoch: 1 | loss: 0.3610967
	speed: 0.1294s/iter; left time: 1768.8276s
Epoch: 1 cost time: 63.19612669944763
Epoch: 1, Steps: 469 | Train Loss: 1.129 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
Validation loss decreased (inf --> -0.882786).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2590171
	speed: 0.6004s/iter; left time: 8106.7449s
	iters: 200, epoch: 2 | loss: 0.3506625
	speed: 0.1433s/iter; left time: 1920.8668s
	iters: 300, epoch: 2 | loss: 0.1617008
	speed: 0.1200s/iter; left time: 1595.8983s
	iters: 400, epoch: 2 | loss: 0.2437404
	speed: 0.1294s/iter; left time: 1707.7683s
Epoch: 2 cost time: 63.06868934631348
Epoch: 2, Steps: 469 | Train Loss: 0.206 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
Validation loss decreased (-0.882786 --> -0.960547).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2106504
	speed: 0.5888s/iter; left time: 7674.0171s
	iters: 200, epoch: 3 | loss: 0.1854563
	speed: 0.1327s/iter; left time: 1716.4797s
	iters: 300, epoch: 3 | loss: 0.0312477
	speed: 0.1467s/iter; left time: 1882.5693s
	iters: 400, epoch: 3 | loss: 0.0156081
	speed: 0.1480s/iter; left time: 1884.9328s
Epoch: 3 cost time: 65.40628004074097
Epoch: 3, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.960547 --> -0.965122).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0116667
	speed: 0.6129s/iter; left time: 7700.9483s
	iters: 200, epoch: 4 | loss: 0.1552379
	speed: 0.1413s/iter; left time: 1761.2681s
	iters: 300, epoch: 4 | loss: 0.0081402
	speed: 0.1422s/iter; left time: 1757.6382s
	iters: 400, epoch: 4 | loss: 0.0278976
	speed: 0.1419s/iter; left time: 1739.8052s
Epoch: 4 cost time: 66.41626071929932
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
Validation loss decreased (-0.965122 --> -0.972269).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0590875
	speed: 0.6309s/iter; left time: 7630.3188s
	iters: 200, epoch: 5 | loss: 0.0252716
	speed: 0.1267s/iter; left time: 1519.2248s
	iters: 300, epoch: 5 | loss: 0.0051200
	speed: 0.1372s/iter; left time: 1632.4963s
	iters: 400, epoch: 5 | loss: 0.0045431
	speed: 0.1428s/iter; left time: 1684.5154s
Epoch: 5 cost time: 64.45383286476135
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.972269 --> -0.978558).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0115350
	speed: 0.5638s/iter; left time: 6555.0385s
	iters: 200, epoch: 6 | loss: 0.0382349
	speed: 0.1218s/iter; left time: 1404.3364s
	iters: 300, epoch: 6 | loss: 0.0151672
	speed: 0.1493s/iter; left time: 1706.2419s
	iters: 400, epoch: 6 | loss: 0.0285684
	speed: 0.1486s/iter; left time: 1683.0258s
Epoch: 6 cost time: 64.32642984390259
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0231308
	speed: 0.6293s/iter; left time: 7020.8472s
	iters: 200, epoch: 7 | loss: 0.0025918
	speed: 0.1456s/iter; left time: 1610.0747s
	iters: 300, epoch: 7 | loss: 0.0338759
	speed: 0.1373s/iter; left time: 1504.6299s
	iters: 400, epoch: 7 | loss: 0.0054170
	speed: 0.1376s/iter; left time: 1494.2150s
Epoch: 7 cost time: 66.52993822097778
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0280570
	speed: 0.6056s/iter; left time: 6472.4526s
	iters: 200, epoch: 8 | loss: 0.0025954
	speed: 0.1409s/iter; left time: 1491.6167s
	iters: 300, epoch: 8 | loss: 0.0244821
	speed: 0.1387s/iter; left time: 1454.3747s
	iters: 400, epoch: 8 | loss: 0.0075273
	speed: 0.0911s/iter; left time: 946.7461s
Epoch: 8 cost time: 60.14464592933655
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979988).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0031729
	speed: 0.6791s/iter; left time: 6939.7409s
	iters: 200, epoch: 9 | loss: 0.0009872
	speed: 0.1459s/iter; left time: 1476.5237s
	iters: 300, epoch: 9 | loss: 0.0610652
	speed: 0.1467s/iter; left time: 1469.5811s
	iters: 400, epoch: 9 | loss: 0.0100119
	speed: 0.1501s/iter; left time: 1489.1241s
Epoch: 9 cost time: 70.47202491760254
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980560).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0021681
	speed: 0.6900s/iter; left time: 6727.0289s
	iters: 200, epoch: 10 | loss: 0.0116667
	speed: 0.1576s/iter; left time: 1521.2799s
	iters: 300, epoch: 10 | loss: 0.0021497
	speed: 0.1435s/iter; left time: 1370.1500s
	iters: 400, epoch: 10 | loss: 0.0184454
	speed: 0.1101s/iter; left time: 1040.2128s
Epoch: 10 cost time: 67.36396646499634
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.956 Test Loss: 0.140 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0006031
	speed: 0.6100s/iter; left time: 5661.5494s
	iters: 200, epoch: 11 | loss: 0.0018221
	speed: 0.1327s/iter; left time: 1218.5720s
	iters: 300, epoch: 11 | loss: 0.0028367
	speed: 0.1265s/iter; left time: 1148.9610s
	iters: 400, epoch: 11 | loss: 0.0007733
	speed: 0.1189s/iter; left time: 1067.7519s
Epoch: 11 cost time: 59.97186231613159
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.980560 --> -0.983133).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004887
	speed: 0.5605s/iter; left time: 4939.4403s
	iters: 200, epoch: 12 | loss: 0.0026948
	speed: 0.1301s/iter; left time: 1133.2696s
	iters: 300, epoch: 12 | loss: 0.0042066
	speed: 0.1335s/iter; left time: 1150.1212s
	iters: 400, epoch: 12 | loss: 0.0051619
	speed: 0.1244s/iter; left time: 1058.9847s
Epoch: 12 cost time: 60.805328369140625
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1107977
	speed: 0.4688s/iter; left time: 3911.2599s
	iters: 200, epoch: 13 | loss: 0.0129830
	speed: 0.0587s/iter; left time: 484.1728s
	iters: 300, epoch: 13 | loss: 0.0016951
	speed: 0.1315s/iter; left time: 1070.8760s
	iters: 400, epoch: 13 | loss: 0.0072876
	speed: 0.1380s/iter; left time: 1109.9397s
Epoch: 13 cost time: 48.047844886779785
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.983133 --> -0.984562).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0013285
	speed: 0.5848s/iter; left time: 4604.7357s
	iters: 200, epoch: 14 | loss: 0.0128746
	speed: 0.1416s/iter; left time: 1100.4630s
	iters: 300, epoch: 14 | loss: 0.0022505
	speed: 0.1414s/iter; left time: 1084.9390s
	iters: 400, epoch: 14 | loss: 0.0420900
	speed: 0.1404s/iter; left time: 1063.2142s
Epoch: 14 cost time: 66.47009921073914
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0018840
	speed: 0.6093s/iter; left time: 4511.6772s
	iters: 200, epoch: 15 | loss: 0.0033433
	speed: 0.1446s/iter; left time: 1056.2636s
	iters: 300, epoch: 15 | loss: 0.2047293
	speed: 0.1536s/iter; left time: 1106.8830s
	iters: 400, epoch: 15 | loss: 0.0004347
	speed: 0.1534s/iter; left time: 1089.7634s
Epoch: 15 cost time: 69.79469323158264
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0017784
	speed: 0.6022s/iter; left time: 4176.5324s
	iters: 200, epoch: 16 | loss: 0.0006906
	speed: 0.1122s/iter; left time: 766.7743s
	iters: 300, epoch: 16 | loss: 0.0005575
	speed: 0.1195s/iter; left time: 804.6777s
	iters: 400, epoch: 16 | loss: 0.0440471
	speed: 0.1335s/iter; left time: 885.8345s
Epoch: 16 cost time: 58.78356385231018
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0011348
	speed: 0.5884s/iter; left time: 3804.9453s
	iters: 200, epoch: 17 | loss: 0.0010689
	speed: 0.1190s/iter; left time: 757.8662s
	iters: 300, epoch: 17 | loss: 0.0038256
	speed: 0.0730s/iter; left time: 457.3305s
	iters: 400, epoch: 17 | loss: 0.0002404
	speed: 0.0971s/iter; left time: 598.6901s
Epoch: 17 cost time: 50.20376777648926
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0141940
	speed: 0.5154s/iter; left time: 3091.6480s
	iters: 200, epoch: 18 | loss: 0.0024601
	speed: 0.1166s/iter; left time: 687.4382s
	iters: 300, epoch: 18 | loss: 0.0009090
	speed: 0.1168s/iter; left time: 677.1903s
	iters: 400, epoch: 18 | loss: 0.0004514
	speed: 0.1192s/iter; left time: 679.3399s
Epoch: 18 cost time: 54.560906171798706
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.984562 --> -0.985134).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0004592
	speed: 0.5403s/iter; left time: 2987.1182s
	iters: 200, epoch: 19 | loss: 0.0016323
	speed: 0.1192s/iter; left time: 647.1752s
	iters: 300, epoch: 19 | loss: 0.0003390
	speed: 0.1211s/iter; left time: 645.1157s
	iters: 400, epoch: 19 | loss: 0.0017944
	speed: 0.1213s/iter; left time: 634.0708s
Epoch: 19 cost time: 56.62731575965881
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0112993
	speed: 0.5733s/iter; left time: 2900.7535s
	iters: 200, epoch: 20 | loss: 0.0005186
	speed: 0.1436s/iter; left time: 712.4047s
	iters: 300, epoch: 20 | loss: 0.0887258
	speed: 0.1316s/iter; left time: 639.3911s
	iters: 400, epoch: 20 | loss: 0.0004088
	speed: 0.1265s/iter; left time: 602.0946s
Epoch: 20 cost time: 62.88287377357483
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.049 Vali Acc: 0.988 Test Loss: 0.049 Test Acc: 0.988
Validation loss decreased (-0.985134 --> -0.988279).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0038717
	speed: 0.5604s/iter; left time: 2572.8697s
	iters: 200, epoch: 21 | loss: 0.0005914
	speed: 0.1332s/iter; left time: 598.0074s
	iters: 300, epoch: 21 | loss: 0.0006526
	speed: 0.1315s/iter; left time: 577.5323s
	iters: 400, epoch: 21 | loss: 0.0005104
	speed: 0.0971s/iter; left time: 416.6931s
Epoch: 21 cost time: 57.103360414505005
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0084877
	speed: 0.4790s/iter; left time: 1974.4385s
	iters: 200, epoch: 22 | loss: 0.0010335
	speed: 0.1071s/iter; left time: 430.9317s
	iters: 300, epoch: 22 | loss: 0.0006012
	speed: 0.1078s/iter; left time: 422.7214s
	iters: 400, epoch: 22 | loss: 0.0167363
	speed: 0.1029s/iter; left time: 393.1458s
Epoch: 22 cost time: 49.768853425979614
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0016971
	speed: 0.4378s/iter; left time: 1599.4411s
	iters: 200, epoch: 23 | loss: 0.0001930
	speed: 0.1332s/iter; left time: 473.1132s
	iters: 300, epoch: 23 | loss: 0.0213694
	speed: 0.1339s/iter; left time: 462.3871s
	iters: 400, epoch: 23 | loss: 0.0024811
	speed: 0.1326s/iter; left time: 444.6763s
Epoch: 23 cost time: 61.465567111968994
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0097146
	speed: 0.5009s/iter; left time: 1594.7701s
	iters: 200, epoch: 24 | loss: 0.0900048
	speed: 0.1181s/iter; left time: 364.3115s
	iters: 300, epoch: 24 | loss: 0.0001258
	speed: 0.1241s/iter; left time: 370.2575s
	iters: 400, epoch: 24 | loss: 0.0018199
	speed: 0.1370s/iter; left time: 394.9850s
Epoch: 24 cost time: 58.99346661567688
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0004351
	speed: 0.6172s/iter; left time: 1675.7750s
	iters: 200, epoch: 25 | loss: 0.0006676
	speed: 0.1381s/iter; left time: 361.0434s
	iters: 300, epoch: 25 | loss: 0.0001750
	speed: 0.1362s/iter; left time: 342.5575s
	iters: 400, epoch: 25 | loss: 0.0260374
	speed: 0.1392s/iter; left time: 336.1620s
Epoch: 25 cost time: 64.96980667114258
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0033485
	speed: 0.5863s/iter; left time: 1316.8006s
	iters: 200, epoch: 26 | loss: 0.0011098
	speed: 0.1354s/iter; left time: 290.4844s
	iters: 300, epoch: 26 | loss: 0.0001208
	speed: 0.1278s/iter; left time: 261.4846s
	iters: 400, epoch: 26 | loss: 0.0024997
	speed: 0.1213s/iter; left time: 235.9747s
Epoch: 26 cost time: 61.181172132492065
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0001713
	speed: 0.5427s/iter; left time: 964.3302s
	iters: 200, epoch: 27 | loss: 0.0022846
	speed: 0.0984s/iter; left time: 165.0574s
	iters: 300, epoch: 27 | loss: 0.0139776
	speed: 0.0989s/iter; left time: 155.9179s
	iters: 400, epoch: 27 | loss: 0.0001470
	speed: 0.1010s/iter; left time: 149.2346s
Epoch: 27 cost time: 48.24558711051941
Epoch: 27, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0001649
	speed: 0.5342s/iter; left time: 698.7840s
	iters: 200, epoch: 28 | loss: 0.0009200
	speed: 0.1103s/iter; left time: 133.2997s
	iters: 300, epoch: 28 | loss: 0.0008732
	speed: 0.1141s/iter; left time: 126.3821s
	iters: 400, epoch: 28 | loss: 0.0022740
	speed: 0.0955s/iter; left time: 96.2535s
Epoch: 28 cost time: 49.85269618034363
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0016081
	speed: 0.4921s/iter; left time: 412.8717s
	iters: 200, epoch: 29 | loss: 0.0001094
	speed: 0.1139s/iter; left time: 84.1787s
	iters: 300, epoch: 29 | loss: 0.0008220
	speed: 0.1084s/iter; left time: 69.2821s
	iters: 400, epoch: 29 | loss: 0.0044665
	speed: 0.1178s/iter; left time: 63.5112s
Epoch: 29 cost time: 54.0821692943573
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000894
	speed: 0.5910s/iter; left time: 218.6807s
	iters: 200, epoch: 30 | loss: 0.0013763
	speed: 0.1379s/iter; left time: 37.2287s
	iters: 300, epoch: 30 | loss: 0.0007454
	speed: 0.1289s/iter; left time: 21.9191s
	iters: 400, epoch: 30 | loss: 0.0002979
	speed: 0.1220s/iter; left time: 8.5366s
Epoch: 30 cost time: 61.993905544281006
Epoch: 30, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9882790165809033
model parameter : 518538
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7116745
	speed: 0.4936s/iter; left time: 6896.4861s
	iters: 200, epoch: 1 | loss: 0.9633430
	speed: 0.4227s/iter; left time: 5863.1773s
	iters: 300, epoch: 1 | loss: 0.3919262
	speed: 0.4143s/iter; left time: 5705.2144s
	iters: 400, epoch: 1 | loss: 0.4366892
	speed: 0.3899s/iter; left time: 5330.7340s
Epoch: 1 cost time: 202.14433789253235
Epoch: 1, Steps: 469 | Train Loss: 1.048 Vali Loss: 0.263 Vali Acc: 0.931 Test Loss: 0.263 Test Acc: 0.931
Validation loss decreased (inf --> -0.930529).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0755989
	speed: 1.0201s/iter; left time: 13773.4026s
	iters: 200, epoch: 2 | loss: 0.0734642
	speed: 0.3651s/iter; left time: 4893.3397s
	iters: 300, epoch: 2 | loss: 0.1249252
	speed: 0.3994s/iter; left time: 5312.4119s
	iters: 400, epoch: 2 | loss: 0.0727407
	speed: 0.4072s/iter; left time: 5375.2270s
Epoch: 2 cost time: 183.28649640083313
Epoch: 2, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.930529 --> -0.974556).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0209009
	speed: 1.1835s/iter; left time: 15424.2713s
	iters: 200, epoch: 3 | loss: 0.0086835
	speed: 0.6043s/iter; left time: 7815.7942s
	iters: 300, epoch: 3 | loss: 0.0975868
	speed: 0.5893s/iter; left time: 7562.3013s
	iters: 400, epoch: 3 | loss: 0.0082750
	speed: 0.4958s/iter; left time: 6313.1908s
Epoch: 3 cost time: 262.72392535209656
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.974556 --> -0.983418).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0054930
	speed: 1.3552s/iter; left time: 17026.6201s
	iters: 200, epoch: 4 | loss: 0.0097953
	speed: 0.5300s/iter; left time: 6606.1168s
	iters: 300, epoch: 4 | loss: 0.0228568
	speed: 0.5586s/iter; left time: 6906.7923s
	iters: 400, epoch: 4 | loss: 0.0290177
	speed: 0.5893s/iter; left time: 7227.1857s
Epoch: 4 cost time: 261.76500058174133
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0386873
	speed: 1.3456s/iter; left time: 16275.0143s
	iters: 200, epoch: 5 | loss: 0.0135341
	speed: 0.5312s/iter; left time: 6371.8208s
	iters: 300, epoch: 5 | loss: 0.0477281
	speed: 0.5267s/iter; left time: 6264.8177s
	iters: 400, epoch: 5 | loss: 0.0371730
	speed: 0.4873s/iter; left time: 5747.3712s
Epoch: 5 cost time: 246.43789386749268
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0040384
	speed: 1.3758s/iter; left time: 15995.1647s
	iters: 200, epoch: 6 | loss: 0.0143656
	speed: 0.5527s/iter; left time: 6370.4425s
	iters: 300, epoch: 6 | loss: 0.0010967
	speed: 0.5353s/iter; left time: 6115.8783s
	iters: 400, epoch: 6 | loss: 0.0397438
	speed: 0.5982s/iter; left time: 6775.2628s
Epoch: 6 cost time: 267.0436272621155
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0019222
	speed: 1.5399s/iter; left time: 17180.7145s
	iters: 200, epoch: 7 | loss: 0.0058509
	speed: 0.5681s/iter; left time: 6281.5919s
	iters: 300, epoch: 7 | loss: 0.0172664
	speed: 0.5506s/iter; left time: 6032.6681s
	iters: 400, epoch: 7 | loss: 0.1271188
	speed: 0.5791s/iter; left time: 6287.8245s
Epoch: 7 cost time: 272.68900656700134
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0086234
	speed: 1.4078s/iter; left time: 15046.0673s
	iters: 200, epoch: 8 | loss: 0.0050153
	speed: 0.5309s/iter; left time: 5621.5760s
	iters: 300, epoch: 8 | loss: 0.0026541
	speed: 0.5588s/iter; left time: 5861.1311s
	iters: 400, epoch: 8 | loss: 0.0194491
	speed: 0.5979s/iter; left time: 6211.3804s
Epoch: 8 cost time: 263.8233313560486
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0299514
	speed: 1.4321s/iter; left time: 14634.8302s
	iters: 200, epoch: 9 | loss: 0.0853995
	speed: 0.5881s/iter; left time: 5950.7723s
	iters: 300, epoch: 9 | loss: 0.0026227
	speed: 0.5303s/iter; left time: 5312.8243s
	iters: 400, epoch: 9 | loss: 0.0747281
	speed: 0.5458s/iter; left time: 5413.3953s
Epoch: 9 cost time: 263.8962736129761
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.983418 --> -0.985706).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0061525
	speed: 1.3781s/iter; left time: 13436.8486s
	iters: 200, epoch: 10 | loss: 0.0049777
	speed: 0.5382s/iter; left time: 5193.2388s
	iters: 300, epoch: 10 | loss: 0.4644888
	speed: 0.5639s/iter; left time: 5385.0253s
	iters: 400, epoch: 10 | loss: 0.0030346
	speed: 0.5774s/iter; left time: 5456.8413s
Epoch: 10 cost time: 263.2223012447357
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0036425
	speed: 1.3890s/iter; left time: 12890.8479s
	iters: 200, epoch: 11 | loss: 0.0167924
	speed: 0.5852s/iter; left time: 5372.9727s
	iters: 300, epoch: 11 | loss: 0.0003989
	speed: 0.6152s/iter; left time: 5586.1976s
	iters: 400, epoch: 11 | loss: 0.0037934
	speed: 0.6140s/iter; left time: 5514.5201s
Epoch: 11 cost time: 274.07596731185913
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0031979
	speed: 1.3639s/iter; left time: 12019.0470s
	iters: 200, epoch: 12 | loss: 0.1362639
	speed: 0.5640s/iter; left time: 4913.4573s
	iters: 300, epoch: 12 | loss: 0.0004390
	speed: 0.5898s/iter; left time: 5078.9503s
	iters: 400, epoch: 12 | loss: 0.0635371
	speed: 0.5825s/iter; left time: 4957.9082s
Epoch: 12 cost time: 271.0186855792999
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0482656
	speed: 1.3991s/iter; left time: 11672.5908s
	iters: 200, epoch: 13 | loss: 0.0035958
	speed: 0.5283s/iter; left time: 4354.9875s
	iters: 300, epoch: 13 | loss: 0.0010849
	speed: 0.5502s/iter; left time: 4479.8749s
	iters: 400, epoch: 13 | loss: 0.0010365
	speed: 0.5938s/iter; left time: 4775.6244s
Epoch: 13 cost time: 263.7124650478363
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0016766
	speed: 1.3274s/iter; left time: 10452.1383s
	iters: 200, epoch: 14 | loss: 0.0005052
	speed: 0.5231s/iter; left time: 4066.3225s
	iters: 300, epoch: 14 | loss: 0.0082282
	speed: 0.5873s/iter; left time: 4507.0875s
	iters: 400, epoch: 14 | loss: 0.1386557
	speed: 0.5776s/iter; left time: 4374.6090s
Epoch: 14 cost time: 257.97521901130676
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0035373
	speed: 1.3079s/iter; left time: 9685.1206s
	iters: 200, epoch: 15 | loss: 0.0005324
	speed: 0.5378s/iter; left time: 3928.4779s
	iters: 300, epoch: 15 | loss: 0.0017905
	speed: 0.5349s/iter; left time: 3853.7662s
	iters: 400, epoch: 15 | loss: 0.0014761
	speed: 0.5225s/iter; left time: 3712.1074s
Epoch: 15 cost time: 248.95216131210327
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0430477
	speed: 1.2333s/iter; left time: 8554.4361s
	iters: 200, epoch: 16 | loss: 0.0039074
	speed: 0.4605s/iter; left time: 3147.9653s
	iters: 300, epoch: 16 | loss: 0.0011675
	speed: 0.4868s/iter; left time: 3279.0082s
	iters: 400, epoch: 16 | loss: 0.0014207
	speed: 0.4996s/iter; left time: 3315.5883s
Epoch: 16 cost time: 224.99680495262146
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0529837
	speed: 1.1562s/iter; left time: 7477.2142s
	iters: 200, epoch: 17 | loss: 0.0205325
	speed: 0.4745s/iter; left time: 3020.9078s
	iters: 300, epoch: 17 | loss: 0.0012342
	speed: 0.4728s/iter; left time: 2963.2064s
	iters: 400, epoch: 17 | loss: 0.0002352
	speed: 0.4950s/iter; left time: 3052.9275s
Epoch: 17 cost time: 226.20315527915955
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0045676
	speed: 1.3208s/iter; left time: 7922.3168s
	iters: 200, epoch: 18 | loss: 0.0005831
	speed: 0.5680s/iter; left time: 3349.7726s
	iters: 300, epoch: 18 | loss: 0.0005544
	speed: 0.5725s/iter; left time: 3319.2360s
	iters: 400, epoch: 18 | loss: 0.0006412
	speed: 0.5442s/iter; left time: 3100.6171s
Epoch: 18 cost time: 259.81455421447754
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0019286
	speed: 1.2896s/iter; left time: 7130.3714s
	iters: 200, epoch: 19 | loss: 0.0006604
	speed: 0.5312s/iter; left time: 2883.9122s
	iters: 300, epoch: 19 | loss: 0.0078587
	speed: 0.5571s/iter; left time: 2968.9961s
	iters: 400, epoch: 19 | loss: 0.0009638
	speed: 0.5613s/iter; left time: 2935.1035s
Epoch: 19 cost time: 256.32001519203186
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 880938
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8206602
	speed: 0.3222s/iter; left time: 4501.4916s
	iters: 200, epoch: 1 | loss: 0.9798346
	speed: 0.2776s/iter; left time: 3850.0519s
	iters: 300, epoch: 1 | loss: 0.5747998
	speed: 0.2778s/iter; left time: 3825.9379s
	iters: 400, epoch: 1 | loss: 0.2311994
	speed: 0.2803s/iter; left time: 3831.3615s
Epoch: 1 cost time: 135.45381569862366
Epoch: 1, Steps: 469 | Train Loss: 1.064 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
Validation loss decreased (inf --> -0.922238).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2491581
	speed: 0.8490s/iter; left time: 11463.2943s
	iters: 200, epoch: 2 | loss: 0.1168356
	speed: 0.2467s/iter; left time: 3306.3999s
	iters: 300, epoch: 2 | loss: 0.0317469
	speed: 0.2947s/iter; left time: 3919.9836s
	iters: 400, epoch: 2 | loss: 0.2819640
	speed: 0.3070s/iter; left time: 4052.7269s
Epoch: 2 cost time: 131.7823634147644
Epoch: 2, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.922238 --> -0.964836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0391249
	speed: 0.8303s/iter; left time: 10821.3981s
	iters: 200, epoch: 3 | loss: 0.3663988
	speed: 0.2743s/iter; left time: 3547.2896s
	iters: 300, epoch: 3 | loss: 0.0074338
	speed: 0.2487s/iter; left time: 3191.5246s
	iters: 400, epoch: 3 | loss: 0.0448617
	speed: 0.2684s/iter; left time: 3417.2443s
Epoch: 3 cost time: 127.52255201339722
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.964836 --> -0.974556).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0445685
	speed: 0.7506s/iter; left time: 9430.2245s
	iters: 200, epoch: 4 | loss: 0.0074948
	speed: 0.2384s/iter; left time: 2971.5162s
	iters: 300, epoch: 4 | loss: 0.3118785
	speed: 0.2928s/iter; left time: 3620.4724s
	iters: 400, epoch: 4 | loss: 0.0457086
	speed: 0.3103s/iter; left time: 3805.6621s
Epoch: 4 cost time: 128.39334297180176
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.974556 --> -0.978558).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0204737
	speed: 0.8410s/iter; left time: 10171.6550s
	iters: 200, epoch: 5 | loss: 0.0132420
	speed: 0.2886s/iter; left time: 3461.8400s
	iters: 300, epoch: 5 | loss: 0.0817592
	speed: 0.2760s/iter; left time: 3282.9884s
	iters: 400, epoch: 5 | loss: 0.0245858
	speed: 0.2486s/iter; left time: 2931.7134s
Epoch: 5 cost time: 127.50454711914062
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0076155
	speed: 0.8148s/iter; left time: 9472.5311s
	iters: 200, epoch: 6 | loss: 0.0056123
	speed: 0.2441s/iter; left time: 2812.9458s
	iters: 300, epoch: 6 | loss: 0.0399320
	speed: 0.2448s/iter; left time: 2797.4818s
	iters: 400, epoch: 6 | loss: 0.2625813
	speed: 0.2811s/iter; left time: 3183.8688s
Epoch: 6 cost time: 126.76582789421082
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.981417).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0788211
	speed: 0.8331s/iter; left time: 9294.8250s
	iters: 200, epoch: 7 | loss: 0.0092508
	speed: 0.2722s/iter; left time: 3009.8286s
	iters: 300, epoch: 7 | loss: 0.0187174
	speed: 0.2863s/iter; left time: 3136.9885s
	iters: 400, epoch: 7 | loss: 0.0664904
	speed: 0.2767s/iter; left time: 3004.3074s
Epoch: 7 cost time: 126.22833180427551
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0053193
	speed: 0.7729s/iter; left time: 8260.7859s
	iters: 200, epoch: 8 | loss: 0.0060648
	speed: 0.2874s/iter; left time: 3042.7815s
	iters: 300, epoch: 8 | loss: 0.1214119
	speed: 0.2457s/iter; left time: 2576.7509s
	iters: 400, epoch: 8 | loss: 0.0009812
	speed: 0.2399s/iter; left time: 2491.7007s
Epoch: 8 cost time: 123.85878872871399
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0701791
	speed: 0.8555s/iter; left time: 8742.7228s
	iters: 200, epoch: 9 | loss: 0.0010094
	speed: 0.2646s/iter; left time: 2677.7665s
	iters: 300, epoch: 9 | loss: 0.0258182
	speed: 0.2661s/iter; left time: 2666.1384s
	iters: 400, epoch: 9 | loss: 0.0026588
	speed: 0.2896s/iter; left time: 2872.3668s
Epoch: 9 cost time: 132.0793261528015
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0014027
	speed: 0.8088s/iter; left time: 7885.6666s
	iters: 200, epoch: 10 | loss: 0.0015641
	speed: 0.2802s/iter; left time: 2704.1681s
	iters: 300, epoch: 10 | loss: 0.0202598
	speed: 0.3243s/iter; left time: 3097.2036s
	iters: 400, epoch: 10 | loss: 0.0125773
	speed: 0.2955s/iter; left time: 2792.2718s
Epoch: 10 cost time: 134.86700558662415
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.981417 --> -0.983990).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0023270
	speed: 0.8796s/iter; left time: 8163.7293s
	iters: 200, epoch: 11 | loss: 0.0029858
	speed: 0.3064s/iter; left time: 2812.8114s
	iters: 300, epoch: 11 | loss: 0.0017126
	speed: 0.2666s/iter; left time: 2421.2718s
	iters: 400, epoch: 11 | loss: 0.0019760
	speed: 0.2706s/iter; left time: 2430.0241s
Epoch: 11 cost time: 135.94716429710388
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0252367
	speed: 0.8673s/iter; left time: 7642.6782s
	iters: 200, epoch: 12 | loss: 0.1137717
	speed: 0.2614s/iter; left time: 2277.1419s
	iters: 300, epoch: 12 | loss: 0.0248499
	speed: 0.2807s/iter; left time: 2417.5121s
	iters: 400, epoch: 12 | loss: 0.0003209
	speed: 0.3131s/iter; left time: 2664.7503s
Epoch: 12 cost time: 134.1999011039734
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0041106
	speed: 0.8559s/iter; left time: 7140.5854s
	iters: 200, epoch: 13 | loss: 0.0009281
	speed: 0.3006s/iter; left time: 2477.7084s
	iters: 300, epoch: 13 | loss: 0.0180396
	speed: 0.2897s/iter; left time: 2359.0486s
	iters: 400, epoch: 13 | loss: 0.2448854
	speed: 0.2715s/iter; left time: 2183.9066s
Epoch: 13 cost time: 132.41098999977112
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7897024
	speed: 0.7567s/iter; left time: 5958.1862s
	iters: 200, epoch: 14 | loss: 0.0070229
	speed: 0.2522s/iter; left time: 1960.3628s
	iters: 300, epoch: 14 | loss: 0.0005860
	speed: 0.2550s/iter; left time: 1956.8920s
	iters: 400, epoch: 14 | loss: 0.0417798
	speed: 0.2514s/iter; left time: 1904.2544s
Epoch: 14 cost time: 119.42112994194031
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1438595
	speed: 0.7796s/iter; left time: 5772.8365s
	iters: 200, epoch: 15 | loss: 0.0371641
	speed: 0.2364s/iter; left time: 1727.0413s
	iters: 300, epoch: 15 | loss: 0.0033750
	speed: 0.2144s/iter; left time: 1544.9180s
	iters: 400, epoch: 15 | loss: 0.0318145
	speed: 0.2427s/iter; left time: 1724.4841s
Epoch: 15 cost time: 112.73127460479736
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0003141
	speed: 0.7154s/iter; left time: 4962.2620s
	iters: 200, epoch: 16 | loss: 0.0005164
	speed: 0.2067s/iter; left time: 1413.2531s
	iters: 300, epoch: 16 | loss: 0.0001855
	speed: 0.2451s/iter; left time: 1650.8461s
	iters: 400, epoch: 16 | loss: 0.0007145
	speed: 0.2175s/iter; left time: 1443.6338s
Epoch: 16 cost time: 104.06443786621094
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0004150
	speed: 0.6175s/iter; left time: 3993.1106s
	iters: 200, epoch: 17 | loss: 0.0003953
	speed: 0.1838s/iter; left time: 1170.0230s
	iters: 300, epoch: 17 | loss: 0.0086081
	speed: 0.2312s/iter; left time: 1449.2426s
	iters: 400, epoch: 17 | loss: 0.0004403
	speed: 0.2491s/iter; left time: 1536.2910s
Epoch: 17 cost time: 102.92300844192505
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0004077
	speed: 0.6945s/iter; left time: 4165.5989s
	iters: 200, epoch: 18 | loss: 0.0374515
	speed: 0.2175s/iter; left time: 1282.6428s
	iters: 300, epoch: 18 | loss: 0.0255994
	speed: 0.2587s/iter; left time: 1499.9285s
	iters: 400, epoch: 18 | loss: 0.0068729
	speed: 0.2306s/iter; left time: 1314.0786s
Epoch: 18 cost time: 110.1153814792633
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0039229
	speed: 0.6861s/iter; left time: 3793.3685s
	iters: 200, epoch: 19 | loss: 0.0612719
	speed: 0.2404s/iter; left time: 1305.2586s
	iters: 300, epoch: 19 | loss: 0.0005641
	speed: 0.2310s/iter; left time: 1230.9987s
	iters: 400, epoch: 19 | loss: 0.0001096
	speed: 0.2598s/iter; left time: 1358.6374s
Epoch: 19 cost time: 110.92847228050232
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0009424
	speed: 0.6802s/iter; left time: 3442.0146s
	iters: 200, epoch: 20 | loss: 0.0019296
	speed: 0.2272s/iter; left time: 1127.1014s
	iters: 300, epoch: 20 | loss: 0.0366273
	speed: 0.2495s/iter; left time: 1212.6554s
	iters: 400, epoch: 20 | loss: 0.0005202
	speed: 0.2487s/iter; left time: 1183.8982s
Epoch: 20 cost time: 113.7818775177002
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 260106
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7157431
	speed: 0.3217s/iter; left time: 4493.8463s
	iters: 200, epoch: 1 | loss: 0.9731992
	speed: 0.3751s/iter; left time: 5203.6199s
	iters: 300, epoch: 1 | loss: 0.4093909
	speed: 0.3705s/iter; left time: 5102.6852s
	iters: 400, epoch: 1 | loss: 0.5337245
	speed: 0.3330s/iter; left time: 4553.1021s
Epoch: 1 cost time: 163.19582629203796
Epoch: 1, Steps: 469 | Train Loss: 1.062 Vali Loss: 0.293 Vali Acc: 0.924 Test Loss: 0.293 Test Acc: 0.924
Validation loss decreased (inf --> -0.923668).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0941795
	speed: 0.9682s/iter; left time: 13073.1687s
	iters: 200, epoch: 2 | loss: 0.1389868
	speed: 0.3692s/iter; left time: 4948.3148s
	iters: 300, epoch: 2 | loss: 0.2145483
	speed: 0.3377s/iter; left time: 4492.2814s
	iters: 400, epoch: 2 | loss: 0.1099625
	speed: 0.3293s/iter; left time: 4347.8485s
Epoch: 2 cost time: 165.2033884525299
Epoch: 2, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.923668 --> -0.972269).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0198471
	speed: 0.9852s/iter; left time: 12840.0389s
	iters: 200, epoch: 3 | loss: 0.0105967
	speed: 0.3454s/iter; left time: 4467.1362s
	iters: 300, epoch: 3 | loss: 0.2466199
	speed: 0.3265s/iter; left time: 4190.2496s
	iters: 400, epoch: 3 | loss: 0.0080953
	speed: 0.3550s/iter; left time: 4520.5919s
Epoch: 3 cost time: 163.75686192512512
Epoch: 3, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.972269 --> -0.981703).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0038179
	speed: 0.9639s/iter; left time: 12111.0118s
	iters: 200, epoch: 4 | loss: 0.0105770
	speed: 0.3377s/iter; left time: 4208.8163s
	iters: 300, epoch: 4 | loss: 0.0146220
	speed: 0.3500s/iter; left time: 4327.9223s
	iters: 400, epoch: 4 | loss: 0.0047082
	speed: 0.3445s/iter; left time: 4224.9443s
Epoch: 4 cost time: 161.80845642089844
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1504235
	speed: 0.9539s/iter; left time: 11537.8444s
	iters: 200, epoch: 5 | loss: 0.0063974
	speed: 0.3490s/iter; left time: 4185.7694s
	iters: 300, epoch: 5 | loss: 0.0192720
	speed: 0.3351s/iter; left time: 3986.5827s
	iters: 400, epoch: 5 | loss: 0.0165559
	speed: 0.3321s/iter; left time: 3917.0026s
Epoch: 5 cost time: 160.65973210334778
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0029014
	speed: 0.9295s/iter; left time: 10806.8583s
	iters: 200, epoch: 6 | loss: 0.0090668
	speed: 0.2971s/iter; left time: 3423.9189s
	iters: 300, epoch: 6 | loss: 0.0016173
	speed: 0.3041s/iter; left time: 3474.4373s
	iters: 400, epoch: 6 | loss: 0.0173087
	speed: 0.3435s/iter; left time: 3890.8207s
Epoch: 6 cost time: 151.8789587020874
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0120948
	speed: 0.8798s/iter; left time: 9815.9580s
	iters: 200, epoch: 7 | loss: 0.0033393
	speed: 0.3099s/iter; left time: 3426.1375s
	iters: 300, epoch: 7 | loss: 0.0089160
	speed: 0.3469s/iter; left time: 3801.3076s
	iters: 400, epoch: 7 | loss: 0.2384826
	speed: 0.3354s/iter; left time: 3641.5013s
Epoch: 7 cost time: 150.61558055877686
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0302572
	speed: 0.8681s/iter; left time: 9278.3235s
	iters: 200, epoch: 8 | loss: 0.0245043
	speed: 0.3426s/iter; left time: 3627.3251s
	iters: 300, epoch: 8 | loss: 0.0040109
	speed: 0.3235s/iter; left time: 3392.8487s
	iters: 400, epoch: 8 | loss: 0.0320788
	speed: 0.3191s/iter; left time: 3314.7113s
Epoch: 8 cost time: 152.60677003860474
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1059347
	speed: 0.8098s/iter; left time: 8275.2731s
	iters: 200, epoch: 9 | loss: 0.0128097
	speed: 0.3032s/iter; left time: 3068.3493s
	iters: 300, epoch: 9 | loss: 0.0060915
	speed: 0.3095s/iter; left time: 3100.5240s
	iters: 400, epoch: 9 | loss: 0.0042683
	speed: 0.3054s/iter; left time: 3029.0491s
Epoch: 9 cost time: 141.96135187149048
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.981703 --> -0.981703).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0086792
	speed: 0.8099s/iter; left time: 7896.1955s
	iters: 200, epoch: 10 | loss: 0.0124477
	speed: 0.3219s/iter; left time: 3106.7992s
	iters: 300, epoch: 10 | loss: 0.4163426
	speed: 0.3417s/iter; left time: 3262.9131s
	iters: 400, epoch: 10 | loss: 0.0022245
	speed: 0.3051s/iter; left time: 2883.0754s
Epoch: 10 cost time: 148.75926804542542
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0035230
	speed: 0.8879s/iter; left time: 8240.6801s
	iters: 200, epoch: 11 | loss: 0.0721024
	speed: 0.3320s/iter; left time: 3047.9013s
	iters: 300, epoch: 11 | loss: 0.0009438
	speed: 0.3204s/iter; left time: 2909.8977s
	iters: 400, epoch: 11 | loss: 0.0059628
	speed: 0.2965s/iter; left time: 2662.4988s
Epoch: 11 cost time: 149.830144405365
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982561).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0132041
	speed: 0.8986s/iter; left time: 7918.3844s
	iters: 200, epoch: 12 | loss: 0.0041459
	speed: 0.3358s/iter; left time: 2925.2270s
	iters: 300, epoch: 12 | loss: 0.0012297
	speed: 0.2923s/iter; left time: 2517.5367s
	iters: 400, epoch: 12 | loss: 0.0027243
	speed: 0.3201s/iter; left time: 2724.6850s
Epoch: 12 cost time: 150.2529058456421
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0243503
	speed: 0.9013s/iter; left time: 7519.6091s
	iters: 200, epoch: 13 | loss: 0.0021128
	speed: 0.2984s/iter; left time: 2459.7175s
	iters: 300, epoch: 13 | loss: 0.0043154
	speed: 0.3105s/iter; left time: 2528.4561s
	iters: 400, epoch: 13 | loss: 0.0177706
	speed: 0.3269s/iter; left time: 2629.0012s
Epoch: 13 cost time: 148.81971263885498
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0085285
	speed: 0.8703s/iter; left time: 6852.9997s
	iters: 200, epoch: 14 | loss: 0.0330314
	speed: 0.3055s/iter; left time: 2374.9526s
	iters: 300, epoch: 14 | loss: 0.0098576
	speed: 0.3100s/iter; left time: 2379.2270s
	iters: 400, epoch: 14 | loss: 0.2212992
	speed: 0.2600s/iter; left time: 1969.5071s
Epoch: 14 cost time: 138.3324031829834
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.982561 --> -0.986563).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0023988
	speed: 0.7796s/iter; left time: 5772.6983s
	iters: 200, epoch: 15 | loss: 0.0016124
	speed: 0.2917s/iter; left time: 2130.9131s
	iters: 300, epoch: 15 | loss: 0.0031793
	speed: 0.2364s/iter; left time: 1703.2068s
	iters: 400, epoch: 15 | loss: 0.0034422
	speed: 0.2942s/iter; left time: 2089.9877s
Epoch: 15 cost time: 124.74195003509521
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0019149
	speed: 0.6922s/iter; left time: 4801.0516s
	iters: 200, epoch: 16 | loss: 0.0007031
	speed: 0.2186s/iter; left time: 1494.4209s
	iters: 300, epoch: 16 | loss: 0.0016796
	speed: 0.2912s/iter; left time: 1961.3700s
	iters: 400, epoch: 16 | loss: 0.0019595
	speed: 0.2192s/iter; left time: 1454.8279s
Epoch: 16 cost time: 117.34091019630432
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0213291
	speed: 0.6952s/iter; left time: 4495.6150s
	iters: 200, epoch: 17 | loss: 0.0014368
	speed: 0.2869s/iter; left time: 1826.7172s
	iters: 300, epoch: 17 | loss: 0.0022669
	speed: 0.2186s/iter; left time: 1369.8366s
	iters: 400, epoch: 17 | loss: 0.0003829
	speed: 0.2702s/iter; left time: 1666.3950s
Epoch: 17 cost time: 117.12313985824585
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0100389
	speed: 0.6488s/iter; left time: 3891.3741s
	iters: 200, epoch: 18 | loss: 0.0016411
	speed: 0.2582s/iter; left time: 1522.8050s
	iters: 300, epoch: 18 | loss: 0.0005771
	speed: 0.3316s/iter; left time: 1922.5577s
	iters: 400, epoch: 18 | loss: 0.0015450
	speed: 0.3049s/iter; left time: 1737.3663s
Epoch: 18 cost time: 133.42674851417542
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0020164
	speed: 0.8679s/iter; left time: 4798.4638s
	iters: 200, epoch: 19 | loss: 0.0051388
	speed: 0.3191s/iter; left time: 1732.2882s
	iters: 300, epoch: 19 | loss: 0.0360317
	speed: 0.2820s/iter; left time: 1502.6518s
	iters: 400, epoch: 19 | loss: 0.0055028
	speed: 0.3116s/iter; left time: 1629.3053s
Epoch: 19 cost time: 142.3506669998169
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2075253
	speed: 0.8653s/iter; left time: 4378.2054s
	iters: 200, epoch: 20 | loss: 0.0036370
	speed: 0.3285s/iter; left time: 1629.1362s
	iters: 300, epoch: 20 | loss: 0.0005575
	speed: 0.3532s/iter; left time: 1716.6487s
	iters: 400, epoch: 20 | loss: 0.5111542
	speed: 0.3259s/iter; left time: 1551.4462s
Epoch: 20 cost time: 159.14142632484436
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0144420
	speed: 0.9228s/iter; left time: 4236.6037s
	iters: 200, epoch: 21 | loss: 0.0014327
	speed: 0.3330s/iter; left time: 1495.6579s
	iters: 300, epoch: 21 | loss: 0.1921677
	speed: 0.3093s/iter; left time: 1358.1055s
	iters: 400, epoch: 21 | loss: 0.0255597
	speed: 0.2903s/iter; left time: 1245.4826s
Epoch: 21 cost time: 151.0956153869629
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0340012
	speed: 0.9892s/iter; left time: 4077.2993s
	iters: 200, epoch: 22 | loss: 0.0011920
	speed: 0.3514s/iter; left time: 1413.1463s
	iters: 300, epoch: 22 | loss: 0.0013228
	speed: 0.3779s/iter; left time: 1482.1689s
	iters: 400, epoch: 22 | loss: 0.0003456
	speed: 0.3725s/iter; left time: 1423.8091s
Epoch: 22 cost time: 170.11727905273438
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0001421
	speed: 0.9615s/iter; left time: 3512.3050s
	iters: 200, epoch: 23 | loss: 0.0002724
	speed: 0.3573s/iter; left time: 1269.5400s
	iters: 300, epoch: 23 | loss: 0.0031028
	speed: 0.3340s/iter; left time: 1153.2988s
	iters: 400, epoch: 23 | loss: 0.0009995
	speed: 0.3383s/iter; left time: 1134.2044s
Epoch: 23 cost time: 165.2061631679535
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0035084
	speed: 0.9951s/iter; left time: 3168.3791s
	iters: 200, epoch: 24 | loss: 0.0010597
	speed: 0.3544s/iter; left time: 1092.9929s
	iters: 300, epoch: 24 | loss: 0.0002598
	speed: 0.3763s/iter; left time: 1122.8002s
	iters: 400, epoch: 24 | loss: 0.0007641
	speed: 0.3651s/iter; left time: 1053.0722s
Epoch: 24 cost time: 168.54145336151123
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 880938
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8153847
	speed: 0.2328s/iter; left time: 3252.8794s
	iters: 200, epoch: 1 | loss: 0.9852441
	speed: 0.2113s/iter; left time: 2930.8224s
	iters: 300, epoch: 1 | loss: 0.5961642
	speed: 0.1987s/iter; left time: 2736.7046s
	iters: 400, epoch: 1 | loss: 0.2497365
	speed: 0.1929s/iter; left time: 2636.6770s
Epoch: 1 cost time: 97.2188069820404
Epoch: 1, Steps: 469 | Train Loss: 1.074 Vali Loss: 0.334 Vali Acc: 0.898 Test Loss: 0.334 Test Acc: 0.898
Validation loss decreased (inf --> -0.897938).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2329262
	speed: 0.7142s/iter; left time: 9642.6817s
	iters: 200, epoch: 2 | loss: 0.0818100
	speed: 0.2014s/iter; left time: 2698.8758s
	iters: 300, epoch: 2 | loss: 0.0394085
	speed: 0.1989s/iter; left time: 2645.8988s
	iters: 400, epoch: 2 | loss: 0.2945373
	speed: 0.2010s/iter; left time: 2653.6279s
Epoch: 2 cost time: 96.32812571525574
Epoch: 2, Steps: 469 | Train Loss: 0.151 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.897938 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0425980
	speed: 0.7176s/iter; left time: 9352.8201s
	iters: 200, epoch: 3 | loss: 0.3903275
	speed: 0.1957s/iter; left time: 2531.5149s
	iters: 300, epoch: 3 | loss: 0.0095082
	speed: 0.1904s/iter; left time: 2443.5270s
	iters: 400, epoch: 3 | loss: 0.0665421
	speed: 0.1940s/iter; left time: 2470.3618s
Epoch: 3 cost time: 94.01834392547607
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.963978 --> -0.973984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0281685
	speed: 0.6863s/iter; left time: 8623.0452s
	iters: 200, epoch: 4 | loss: 0.0085516
	speed: 0.1880s/iter; left time: 2342.6282s
	iters: 300, epoch: 4 | loss: 0.4287513
	speed: 0.1901s/iter; left time: 2350.4895s
	iters: 400, epoch: 4 | loss: 0.0239533
	speed: 0.2046s/iter; left time: 2509.0786s
Epoch: 4 cost time: 93.11220455169678
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0540261
	speed: 0.7143s/iter; left time: 8639.6597s
	iters: 200, epoch: 5 | loss: 0.0147735
	speed: 0.1991s/iter; left time: 2388.6966s
	iters: 300, epoch: 5 | loss: 0.0505511
	speed: 0.2027s/iter; left time: 2411.1375s
	iters: 400, epoch: 5 | loss: 0.0038174
	speed: 0.2128s/iter; left time: 2509.7412s
Epoch: 5 cost time: 97.11977243423462
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
Validation loss decreased (-0.973984 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0332386
	speed: 0.6985s/iter; left time: 8120.4895s
	iters: 200, epoch: 6 | loss: 0.0132050
	speed: 0.1912s/iter; left time: 2204.1439s
	iters: 300, epoch: 6 | loss: 0.0104009
	speed: 0.1929s/iter; left time: 2204.1410s
	iters: 400, epoch: 6 | loss: 0.3288269
	speed: 0.2073s/iter; left time: 2347.6838s
Epoch: 6 cost time: 93.13235425949097
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.974270 --> -0.982561).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1091842
	speed: 0.6764s/iter; left time: 7546.1688s
	iters: 200, epoch: 7 | loss: 0.0176162
	speed: 0.2008s/iter; left time: 2219.9920s
	iters: 300, epoch: 7 | loss: 0.0228715
	speed: 0.2057s/iter; left time: 2253.3759s
	iters: 400, epoch: 7 | loss: 0.1361550
	speed: 0.2188s/iter; left time: 2375.6016s
Epoch: 7 cost time: 96.85383152961731
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0036730
	speed: 0.7140s/iter; left time: 7631.3969s
	iters: 200, epoch: 8 | loss: 0.0230441
	speed: 0.2137s/iter; left time: 2262.2260s
	iters: 300, epoch: 8 | loss: 0.3284236
	speed: 0.2238s/iter; left time: 2347.2835s
	iters: 400, epoch: 8 | loss: 0.0012050
	speed: 0.2282s/iter; left time: 2370.7654s
Epoch: 8 cost time: 103.64728307723999
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5903551
	speed: 0.7083s/iter; left time: 7237.8339s
	iters: 200, epoch: 9 | loss: 0.0066837
	speed: 0.2016s/iter; left time: 2040.3402s
	iters: 300, epoch: 9 | loss: 0.0054719
	speed: 0.2207s/iter; left time: 2210.7477s
	iters: 400, epoch: 9 | loss: 0.0236449
	speed: 0.2213s/iter; left time: 2195.4309s
Epoch: 9 cost time: 100.03770971298218
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0011026
	speed: 0.7149s/iter; left time: 6970.7409s
	iters: 200, epoch: 10 | loss: 0.0034069
	speed: 0.2191s/iter; left time: 2114.7123s
	iters: 300, epoch: 10 | loss: 0.0064273
	speed: 0.2305s/iter; left time: 2201.1405s
	iters: 400, epoch: 10 | loss: 0.0058705
	speed: 0.2292s/iter; left time: 2166.1007s
Epoch: 10 cost time: 105.22618103027344
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0044470
	speed: 0.7272s/iter; left time: 6748.9777s
	iters: 200, epoch: 11 | loss: 0.0063527
	speed: 0.2245s/iter; left time: 2061.0474s
	iters: 300, epoch: 11 | loss: 0.0028546
	speed: 0.2303s/iter; left time: 2090.9294s
	iters: 400, epoch: 11 | loss: 0.0220830
	speed: 0.2223s/iter; left time: 1996.2078s
Epoch: 11 cost time: 104.03119468688965
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0319820
	speed: 0.6900s/iter; left time: 6080.3260s
	iters: 200, epoch: 12 | loss: 0.0127123
	speed: 0.2227s/iter; left time: 1939.9823s
	iters: 300, epoch: 12 | loss: 0.0505492
	speed: 0.2226s/iter; left time: 1916.7675s
	iters: 400, epoch: 12 | loss: 0.0014916
	speed: 0.2210s/iter; left time: 1881.0614s
Epoch: 12 cost time: 101.43259620666504
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0163725
	speed: 0.7149s/iter; left time: 5964.4368s
	iters: 200, epoch: 13 | loss: 0.0005110
	speed: 0.2296s/iter; left time: 1892.1837s
	iters: 300, epoch: 13 | loss: 0.0039516
	speed: 0.2293s/iter; left time: 1867.5717s
	iters: 400, epoch: 13 | loss: 0.0064366
	speed: 0.2250s/iter; left time: 1809.7089s
Epoch: 13 cost time: 105.07394170761108
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.983418).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0761493
	speed: 0.7147s/iter; left time: 5627.4909s
	iters: 200, epoch: 14 | loss: 0.0019061
	speed: 0.1967s/iter; left time: 1529.4287s
	iters: 300, epoch: 14 | loss: 0.0003269
	speed: 0.1828s/iter; left time: 1402.6297s
	iters: 400, epoch: 14 | loss: 0.0211580
	speed: 0.1971s/iter; left time: 1492.8036s
Epoch: 14 cost time: 91.75513172149658
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0307219
	speed: 0.6385s/iter; left time: 4727.7388s
	iters: 200, epoch: 15 | loss: 0.0678951
	speed: 0.1827s/iter; left time: 1334.9050s
	iters: 300, epoch: 15 | loss: 0.0415383
	speed: 0.1974s/iter; left time: 1422.4808s
	iters: 400, epoch: 15 | loss: 0.0367134
	speed: 0.2043s/iter; left time: 1451.2203s
Epoch: 15 cost time: 91.24061441421509
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0007908
	speed: 0.6433s/iter; left time: 4461.8268s
	iters: 200, epoch: 16 | loss: 0.0005491
	speed: 0.1804s/iter; left time: 1233.3519s
	iters: 300, epoch: 16 | loss: 0.0002539
	speed: 0.1971s/iter; left time: 1327.7332s
	iters: 400, epoch: 16 | loss: 0.0013885
	speed: 0.1897s/iter; left time: 1258.7315s
Epoch: 16 cost time: 88.12369990348816
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0005991
	speed: 0.6202s/iter; left time: 4010.8781s
	iters: 200, epoch: 17 | loss: 0.0008470
	speed: 0.1715s/iter; left time: 1091.7992s
	iters: 300, epoch: 17 | loss: 0.0236601
	speed: 0.1924s/iter; left time: 1205.8077s
	iters: 400, epoch: 17 | loss: 0.0002990
	speed: 0.1761s/iter; left time: 1085.9594s
Epoch: 17 cost time: 83.63222885131836
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0005331
	speed: 0.6022s/iter; left time: 3611.7653s
	iters: 200, epoch: 18 | loss: 0.0040836
	speed: 0.1788s/iter; left time: 1054.6738s
	iters: 300, epoch: 18 | loss: 0.0011756
	speed: 0.1991s/iter; left time: 1154.2316s
	iters: 400, epoch: 18 | loss: 0.0091472
	speed: 0.1825s/iter; left time: 1039.8624s
Epoch: 18 cost time: 85.78713965415955
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983704).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0038164
	speed: 0.6265s/iter; left time: 3463.9484s
	iters: 200, epoch: 19 | loss: 0.0608514
	speed: 0.1875s/iter; left time: 1017.8490s
	iters: 300, epoch: 19 | loss: 0.0024018
	speed: 0.1999s/iter; left time: 1065.0272s
	iters: 400, epoch: 19 | loss: 0.0006847
	speed: 0.1796s/iter; left time: 939.3491s
Epoch: 19 cost time: 87.03383088111877
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0012295
	speed: 0.6083s/iter; left time: 3077.9182s
	iters: 200, epoch: 20 | loss: 0.0016609
	speed: 0.1803s/iter; left time: 894.1361s
	iters: 300, epoch: 20 | loss: 0.0124828
	speed: 0.1834s/iter; left time: 891.4341s
	iters: 400, epoch: 20 | loss: 0.0157697
	speed: 0.1711s/iter; left time: 814.5823s
Epoch: 20 cost time: 82.44662976264954
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.983704 --> -0.984562).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0015680
	speed: 0.6047s/iter; left time: 2776.2962s
	iters: 200, epoch: 21 | loss: 0.0037968
	speed: 0.2005s/iter; left time: 900.5841s
	iters: 300, epoch: 21 | loss: 0.0002054
	speed: 0.1855s/iter; left time: 814.5523s
	iters: 400, epoch: 21 | loss: 0.0015822
	speed: 0.1967s/iter; left time: 843.9593s
Epoch: 21 cost time: 94.08184313774109
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002049
	speed: 0.6619s/iter; left time: 2728.2162s
	iters: 200, epoch: 22 | loss: 0.0004563
	speed: 0.2052s/iter; left time: 825.4399s
	iters: 300, epoch: 22 | loss: 0.0008177
	speed: 0.2112s/iter; left time: 828.4822s
	iters: 400, epoch: 22 | loss: 0.0006760
	speed: 0.1921s/iter; left time: 734.3240s
Epoch: 22 cost time: 92.9375262260437
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0002076
	speed: 0.6805s/iter; left time: 2485.9664s
	iters: 200, epoch: 23 | loss: 0.0004446
	speed: 0.1901s/iter; left time: 675.5605s
	iters: 300, epoch: 23 | loss: 0.0004905
	speed: 0.2006s/iter; left time: 692.7810s
	iters: 400, epoch: 23 | loss: 0.0007262
	speed: 0.2146s/iter; left time: 719.5325s
Epoch: 23 cost time: 94.36327123641968
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0001146
	speed: 0.6883s/iter; left time: 2191.5237s
	iters: 200, epoch: 24 | loss: 0.0012552
	speed: 0.2192s/iter; left time: 675.8849s
	iters: 300, epoch: 24 | loss: 0.0007465
	speed: 0.1977s/iter; left time: 589.9566s
	iters: 400, epoch: 24 | loss: 0.0015537
	speed: 0.2022s/iter; left time: 583.0304s
Epoch: 24 cost time: 99.72459292411804
Epoch: 24, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0009400
	speed: 0.7041s/iter; left time: 1911.7045s
	iters: 200, epoch: 25 | loss: 0.0005249
	speed: 0.2139s/iter; left time: 559.3673s
	iters: 300, epoch: 25 | loss: 0.0001248
	speed: 0.2152s/iter; left time: 541.3194s
	iters: 400, epoch: 25 | loss: 0.0001156
	speed: 0.1953s/iter; left time: 471.6490s
Epoch: 25 cost time: 95.5522096157074
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0003123
	speed: 0.6822s/iter; left time: 1532.1168s
	iters: 200, epoch: 26 | loss: 0.0011963
	speed: 0.1890s/iter; left time: 405.6607s
	iters: 300, epoch: 26 | loss: 0.0034386
	speed: 0.1971s/iter; left time: 403.3339s
	iters: 400, epoch: 26 | loss: 0.0003874
	speed: 0.2177s/iter; left time: 423.6567s
Epoch: 26 cost time: 96.38848328590393
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0449763
	speed: 0.6975s/iter; left time: 1239.4395s
	iters: 200, epoch: 27 | loss: 0.0001826
	speed: 0.2230s/iter; left time: 373.9644s
	iters: 300, epoch: 27 | loss: 0.0030363
	speed: 0.1995s/iter; left time: 314.5413s
	iters: 400, epoch: 27 | loss: 0.0005359
	speed: 0.1969s/iter; left time: 290.8663s
Epoch: 27 cost time: 99.3163332939148
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1153969
	speed: 0.7064s/iter; left time: 924.0115s
	iters: 200, epoch: 28 | loss: 0.0001992
	speed: 0.2005s/iter; left time: 242.2416s
	iters: 300, epoch: 28 | loss: 0.0001754
	speed: 0.2145s/iter; left time: 237.6616s
	iters: 400, epoch: 28 | loss: 0.1015214
	speed: 0.2002s/iter; left time: 201.7900s
Epoch: 28 cost time: 94.31414556503296
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0164836
	speed: 0.6821s/iter; left time: 572.3033s
	iters: 200, epoch: 29 | loss: 0.0475862
	speed: 0.1901s/iter; left time: 140.4787s
	iters: 300, epoch: 29 | loss: 0.0001393
	speed: 0.1940s/iter; left time: 123.9940s
	iters: 400, epoch: 29 | loss: 0.0027070
	speed: 0.1912s/iter; left time: 103.0328s
Epoch: 29 cost time: 91.44432592391968
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0034510
	speed: 0.6341s/iter; left time: 234.6003s
	iters: 200, epoch: 30 | loss: 0.0138499
	speed: 0.1927s/iter; left time: 52.0214s
	iters: 300, epoch: 30 | loss: 0.0014649
	speed: 0.1811s/iter; left time: 30.7915s
	iters: 400, epoch: 30 | loss: 0.0002970
	speed: 0.2019s/iter; left time: 14.1353s
Epoch: 30 cost time: 89.63409113883972
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 260106
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7670279
	speed: 0.1884s/iter; left time: 2632.2717s
	iters: 200, epoch: 1 | loss: 1.1527416
	speed: 0.1659s/iter; left time: 2301.7675s
	iters: 300, epoch: 1 | loss: 0.5592968
	speed: 0.1543s/iter; left time: 2125.3889s
	iters: 400, epoch: 1 | loss: 0.5651643
	speed: 0.1776s/iter; left time: 2428.5404s
Epoch: 1 cost time: 79.5197868347168
Epoch: 1, Steps: 469 | Train Loss: 1.158 Vali Loss: 0.393 Vali Acc: 0.890 Test Loss: 0.393 Test Acc: 0.890
Validation loss decreased (inf --> -0.889933).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1775956
	speed: 0.5529s/iter; left time: 7464.8705s
	iters: 200, epoch: 2 | loss: 0.2874203
	speed: 0.1687s/iter; left time: 2261.2025s
	iters: 300, epoch: 2 | loss: 0.2129153
	speed: 0.1723s/iter; left time: 2292.5705s
	iters: 400, epoch: 2 | loss: 0.1020853
	speed: 0.0956s/iter; left time: 1262.4287s
Epoch: 2 cost time: 67.1642575263977
Epoch: 2, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
Validation loss decreased (-0.889933 --> -0.960547).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0281385
	speed: 0.5258s/iter; left time: 6852.6855s
	iters: 200, epoch: 3 | loss: 0.0863451
	speed: 0.1667s/iter; left time: 2156.5352s
	iters: 300, epoch: 3 | loss: 0.1733329
	speed: 0.1472s/iter; left time: 1888.9104s
	iters: 400, epoch: 3 | loss: 0.0153119
	speed: 0.1594s/iter; left time: 2029.3701s
Epoch: 3 cost time: 74.12650108337402
Epoch: 3, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.960547 --> -0.980274).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0084467
	speed: 0.5190s/iter; left time: 6521.1771s
	iters: 200, epoch: 4 | loss: 0.0289383
	speed: 0.1691s/iter; left time: 2107.3837s
	iters: 300, epoch: 4 | loss: 0.0192384
	speed: 0.1714s/iter; left time: 2119.2107s
	iters: 400, epoch: 4 | loss: 0.0975561
	speed: 0.1520s/iter; left time: 1864.0172s
Epoch: 4 cost time: 76.45325946807861
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0931389
	speed: 0.5228s/iter; left time: 6322.9811s
	iters: 200, epoch: 5 | loss: 0.0424817
	speed: 0.1559s/iter; left time: 1870.4380s
	iters: 300, epoch: 5 | loss: 0.0728749
	speed: 0.1680s/iter; left time: 1997.9005s
	iters: 400, epoch: 5 | loss: 0.0352498
	speed: 0.1753s/iter; left time: 2067.4830s
Epoch: 5 cost time: 77.05216193199158
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0096968
	speed: 0.5259s/iter; left time: 6113.8423s
	iters: 200, epoch: 6 | loss: 0.0213997
	speed: 0.1446s/iter; left time: 1666.6948s
	iters: 300, epoch: 6 | loss: 0.0016524
	speed: 0.1140s/iter; left time: 1302.8305s
	iters: 400, epoch: 6 | loss: 0.0213988
	speed: 0.2113s/iter; left time: 2393.4013s
Epoch: 6 cost time: 75.95112466812134
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0160556
	speed: 0.7144s/iter; left time: 7970.2623s
	iters: 200, epoch: 7 | loss: 0.0025784
	speed: 0.2049s/iter; left time: 2266.0023s
	iters: 300, epoch: 7 | loss: 0.0453704
	speed: 0.2014s/iter; left time: 2206.9042s
	iters: 400, epoch: 7 | loss: 0.1960926
	speed: 0.1984s/iter; left time: 2154.2714s
Epoch: 7 cost time: 95.68968605995178
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1132936
	speed: 0.7244s/iter; left time: 7742.1205s
	iters: 200, epoch: 8 | loss: 0.0279244
	speed: 0.2250s/iter; left time: 2382.2629s
	iters: 300, epoch: 8 | loss: 0.0049527
	speed: 0.2134s/iter; left time: 2238.5883s
	iters: 400, epoch: 8 | loss: 0.0321905
	speed: 0.2094s/iter; left time: 2174.9073s
Epoch: 8 cost time: 101.4075722694397
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0346695
	speed: 0.6916s/iter; left time: 7067.2922s
	iters: 200, epoch: 9 | loss: 0.0034836
	speed: 0.2156s/iter; left time: 2181.3276s
	iters: 300, epoch: 9 | loss: 0.0103809
	speed: 0.2147s/iter; left time: 2150.6216s
	iters: 400, epoch: 9 | loss: 0.0186781
	speed: 0.2209s/iter; left time: 2190.6284s
Epoch: 9 cost time: 101.15557551383972
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.055 Vali Acc: 0.984 Test Loss: 0.055 Test Acc: 0.984
Validation loss decreased (-0.980274 --> -0.983704).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0020872
	speed: 0.7044s/iter; left time: 6867.7802s
	iters: 200, epoch: 10 | loss: 0.0123520
	speed: 0.2120s/iter; left time: 2045.8006s
	iters: 300, epoch: 10 | loss: 0.5810702
	speed: 0.2167s/iter; left time: 2069.0488s
	iters: 400, epoch: 10 | loss: 0.0027079
	speed: 0.2142s/iter; left time: 2024.2569s
Epoch: 10 cost time: 100.2791314125061
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983704 --> -0.984562).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0041229
	speed: 0.7082s/iter; left time: 6572.4780s
	iters: 200, epoch: 11 | loss: 0.0403354
	speed: 0.2119s/iter; left time: 1945.7128s
	iters: 300, epoch: 11 | loss: 0.0005992
	speed: 0.2132s/iter; left time: 1935.9662s
	iters: 400, epoch: 11 | loss: 0.0179119
	speed: 0.2239s/iter; left time: 2010.8357s
Epoch: 11 cost time: 100.63847732543945
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.984562 --> -0.984562).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0216158
	speed: 0.7117s/iter; left time: 6271.2917s
	iters: 200, epoch: 12 | loss: 0.0131788
	speed: 0.1995s/iter; left time: 1737.9793s
	iters: 300, epoch: 12 | loss: 0.0011624
	speed: 0.2092s/iter; left time: 1801.3209s
	iters: 400, epoch: 12 | loss: 0.0034552
	speed: 0.2097s/iter; left time: 1785.3116s
Epoch: 12 cost time: 97.94206523895264
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0272293
	speed: 0.7447s/iter; left time: 6213.1909s
	iters: 200, epoch: 13 | loss: 0.0079180
	speed: 0.2137s/iter; left time: 1761.7485s
	iters: 300, epoch: 13 | loss: 0.0512295
	speed: 0.2004s/iter; left time: 1632.2576s
	iters: 400, epoch: 13 | loss: 0.0007369
	speed: 0.1996s/iter; left time: 1605.4195s
Epoch: 13 cost time: 97.41113424301147
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0045784
	speed: 0.7216s/iter; left time: 5681.7841s
	iters: 200, epoch: 14 | loss: 0.0043765
	speed: 0.2251s/iter; left time: 1749.9538s
	iters: 300, epoch: 14 | loss: 0.0043692
	speed: 0.2251s/iter; left time: 1727.1386s
	iters: 400, epoch: 14 | loss: 0.0054933
	speed: 0.2094s/iter; left time: 1586.0980s
Epoch: 14 cost time: 102.5922212600708
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0037424
	speed: 0.6558s/iter; left time: 4856.4094s
	iters: 200, epoch: 15 | loss: 0.0009988
	speed: 0.2077s/iter; left time: 1517.5547s
	iters: 300, epoch: 15 | loss: 0.0052845
	speed: 0.2134s/iter; left time: 1537.4303s
	iters: 400, epoch: 15 | loss: 0.0159556
	speed: 0.2138s/iter; left time: 1519.3515s
Epoch: 15 cost time: 97.40813851356506
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0010615
	speed: 0.6659s/iter; left time: 4618.3712s
	iters: 200, epoch: 16 | loss: 0.0009022
	speed: 0.1879s/iter; left time: 1284.5979s
	iters: 300, epoch: 16 | loss: 0.0294263
	speed: 0.1948s/iter; left time: 1312.1878s
	iters: 400, epoch: 16 | loss: 0.0742991
	speed: 0.2050s/iter; left time: 1360.1850s
Epoch: 16 cost time: 91.48725438117981
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0101667
	speed: 0.6910s/iter; left time: 4468.9096s
	iters: 200, epoch: 17 | loss: 0.0042959
	speed: 0.1969s/iter; left time: 1253.8548s
	iters: 300, epoch: 17 | loss: 0.0016469
	speed: 0.1940s/iter; left time: 1215.5552s
	iters: 400, epoch: 17 | loss: 0.0003943
	speed: 0.1872s/iter; left time: 1154.1592s
Epoch: 17 cost time: 92.02886438369751
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1315786
	speed: 0.6819s/iter; left time: 4089.7635s
	iters: 200, epoch: 18 | loss: 0.0014755
	speed: 0.2052s/iter; left time: 1210.3816s
	iters: 300, epoch: 18 | loss: 0.0019363
	speed: 0.1997s/iter; left time: 1157.5820s
	iters: 400, epoch: 18 | loss: 0.0009081
	speed: 0.1964s/iter; left time: 1119.1504s
Epoch: 18 cost time: 94.26977825164795
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0072186
	speed: 0.6824s/iter; left time: 3773.1498s
	iters: 200, epoch: 19 | loss: 0.0021628
	speed: 0.2021s/iter; left time: 1097.3680s
	iters: 300, epoch: 19 | loss: 0.0298047
	speed: 0.2029s/iter; left time: 1081.3840s
	iters: 400, epoch: 19 | loss: 0.0028099
	speed: 0.1883s/iter; left time: 984.6273s
Epoch: 19 cost time: 93.79932904243469
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0636012
	speed: 0.6769s/iter; left time: 3424.9704s
	iters: 200, epoch: 20 | loss: 0.0008358
	speed: 0.2132s/iter; left time: 1057.5185s
	iters: 300, epoch: 20 | loss: 0.0049380
	speed: 0.2045s/iter; left time: 994.0111s
	iters: 400, epoch: 20 | loss: 0.4684887
	speed: 0.2038s/iter; left time: 970.1818s
Epoch: 20 cost time: 96.24920296669006
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0008508
	speed: 0.6424s/iter; left time: 2949.0597s
	iters: 200, epoch: 21 | loss: 0.0002084
	speed: 0.1997s/iter; left time: 897.0227s
	iters: 300, epoch: 21 | loss: 0.0725331
	speed: 0.2167s/iter; left time: 951.5809s
	iters: 400, epoch: 21 | loss: 0.0221219
	speed: 0.2259s/iter; left time: 969.1879s
Epoch: 21 cost time: 99.1672523021698
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 880938
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.8809500
	speed: 0.1532s/iter; left time: 2139.8972s
	iters: 200, epoch: 1 | loss: 1.1591828
	speed: 0.1380s/iter; left time: 1913.9871s
	iters: 300, epoch: 1 | loss: 0.7842879
	speed: 0.1360s/iter; left time: 1872.7816s
	iters: 400, epoch: 1 | loss: 0.4498656
	speed: 0.1506s/iter; left time: 2058.7765s
Epoch: 1 cost time: 68.48819899559021
Epoch: 1, Steps: 469 | Train Loss: 1.220 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
Validation loss decreased (inf --> -0.866777).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3503085
	speed: 0.6309s/iter; left time: 8518.7713s
	iters: 200, epoch: 2 | loss: 0.2063153
	speed: 0.1517s/iter; left time: 2032.6192s
	iters: 300, epoch: 2 | loss: 0.0895133
	speed: 0.1424s/iter; left time: 1893.6627s
	iters: 400, epoch: 2 | loss: 0.3368908
	speed: 0.1371s/iter; left time: 1809.8532s
Epoch: 2 cost time: 68.00010442733765
Epoch: 2, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.866777 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0759024
	speed: 0.5610s/iter; left time: 7311.2844s
	iters: 200, epoch: 3 | loss: 0.4097436
	speed: 0.1386s/iter; left time: 1792.7477s
	iters: 300, epoch: 3 | loss: 0.0447292
	speed: 0.1328s/iter; left time: 1704.4878s
	iters: 400, epoch: 3 | loss: 0.0314642
	speed: 0.1064s/iter; left time: 1355.2285s
Epoch: 3 cost time: 62.36911177635193
Epoch: 3, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (-0.964264 --> -0.970840).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0423596
	speed: 0.6440s/iter; left time: 8091.2593s
	iters: 200, epoch: 4 | loss: 0.0281750
	speed: 0.1584s/iter; left time: 1974.3502s
	iters: 300, epoch: 4 | loss: 0.3409203
	speed: 0.1528s/iter; left time: 1888.6300s
	iters: 400, epoch: 4 | loss: 0.0465908
	speed: 0.1522s/iter; left time: 1866.8323s
Epoch: 4 cost time: 72.93733239173889
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.966 Test Loss: 0.104 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2627921
	speed: 0.6148s/iter; left time: 7435.8496s
	iters: 200, epoch: 5 | loss: 0.0346932
	speed: 0.1440s/iter; left time: 1727.2112s
	iters: 300, epoch: 5 | loss: 0.0199769
	speed: 0.1507s/iter; left time: 1792.8950s
	iters: 400, epoch: 5 | loss: 0.0086519
	speed: 0.1518s/iter; left time: 1790.2489s
Epoch: 5 cost time: 69.67685413360596
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.970840 --> -0.975985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0392187
	speed: 0.6196s/iter; left time: 7203.1247s
	iters: 200, epoch: 6 | loss: 0.0090196
	speed: 0.1509s/iter; left time: 1738.9603s
	iters: 300, epoch: 6 | loss: 0.1591469
	speed: 0.1513s/iter; left time: 1729.0743s
	iters: 400, epoch: 6 | loss: 0.3814389
	speed: 0.1521s/iter; left time: 1722.6268s
Epoch: 6 cost time: 71.30503296852112
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.975985 --> -0.978558).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1808361
	speed: 0.6198s/iter; left time: 6914.8743s
	iters: 200, epoch: 7 | loss: 0.0198688
	speed: 0.1555s/iter; left time: 1718.8707s
	iters: 300, epoch: 7 | loss: 0.0955711
	speed: 0.1576s/iter; left time: 1726.4581s
	iters: 400, epoch: 7 | loss: 0.0706994
	speed: 0.1574s/iter; left time: 1708.8834s
Epoch: 7 cost time: 73.33081436157227
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0103706
	speed: 0.6209s/iter; left time: 6636.5369s
	iters: 200, epoch: 8 | loss: 0.1534123
	speed: 0.1429s/iter; left time: 1513.4321s
	iters: 300, epoch: 8 | loss: 0.1545889
	speed: 0.1449s/iter; left time: 1519.7617s
	iters: 400, epoch: 8 | loss: 0.0010866
	speed: 0.1448s/iter; left time: 1503.8240s
Epoch: 8 cost time: 68.27501583099365
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3154607
	speed: 0.6079s/iter; left time: 6212.5968s
	iters: 200, epoch: 9 | loss: 0.0095814
	speed: 0.1589s/iter; left time: 1607.5743s
	iters: 300, epoch: 9 | loss: 0.0365906
	speed: 0.1580s/iter; left time: 1583.2641s
	iters: 400, epoch: 9 | loss: 0.0100513
	speed: 0.1582s/iter; left time: 1569.3561s
Epoch: 9 cost time: 74.14563965797424
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0024178
	speed: 0.6417s/iter; left time: 6256.8702s
	iters: 200, epoch: 10 | loss: 0.0087595
	speed: 0.1460s/iter; left time: 1409.1770s
	iters: 300, epoch: 10 | loss: 0.0037674
	speed: 0.1410s/iter; left time: 1346.9990s
	iters: 400, epoch: 10 | loss: 0.0851984
	speed: 0.1347s/iter; left time: 1272.5508s
Epoch: 10 cost time: 66.99041819572449
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979416).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0118569
	speed: 0.5700s/iter; left time: 5289.9206s
	iters: 200, epoch: 11 | loss: 0.0063850
	speed: 0.1420s/iter; left time: 1303.9939s
	iters: 300, epoch: 11 | loss: 0.0011285
	speed: 0.1429s/iter; left time: 1297.5961s
	iters: 400, epoch: 11 | loss: 0.0156603
	speed: 0.1373s/iter; left time: 1233.3418s
Epoch: 11 cost time: 67.21075224876404
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0853863
	speed: 0.6036s/iter; left time: 5319.0750s
	iters: 200, epoch: 12 | loss: 0.0128401
	speed: 0.1443s/iter; left time: 1257.1753s
	iters: 300, epoch: 12 | loss: 0.0295747
	speed: 0.1414s/iter; left time: 1217.9924s
	iters: 400, epoch: 12 | loss: 0.0017642
	speed: 0.1439s/iter; left time: 1225.2451s
Epoch: 12 cost time: 67.60140228271484
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0041399
	speed: 0.5858s/iter; left time: 4887.6081s
	iters: 200, epoch: 13 | loss: 0.0004062
	speed: 0.1388s/iter; left time: 1144.4757s
	iters: 300, epoch: 13 | loss: 0.0019181
	speed: 0.0981s/iter; left time: 798.6647s
	iters: 400, epoch: 13 | loss: 0.0863569
	speed: 0.1190s/iter; left time: 956.8471s
Epoch: 13 cost time: 59.07974886894226
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980560).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2836048
	speed: 0.5182s/iter; left time: 4080.6716s
	iters: 200, epoch: 14 | loss: 0.0024653
	speed: 0.1186s/iter; left time: 922.0832s
	iters: 300, epoch: 14 | loss: 0.0007022
	speed: 0.1372s/iter; left time: 1053.2461s
	iters: 400, epoch: 14 | loss: 0.0097549
	speed: 0.1396s/iter; left time: 1057.5225s
Epoch: 14 cost time: 61.54034996032715
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.980560 --> -0.983990).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0025395
	speed: 0.5373s/iter; left time: 3978.9805s
	iters: 200, epoch: 15 | loss: 0.0833229
	speed: 0.1395s/iter; left time: 1019.2366s
	iters: 300, epoch: 15 | loss: 0.0137420
	speed: 0.1391s/iter; left time: 1002.0859s
	iters: 400, epoch: 15 | loss: 0.2175897
	speed: 0.1323s/iter; left time: 939.7822s
Epoch: 15 cost time: 63.140475273132324
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0039570
	speed: 0.5251s/iter; left time: 3642.3721s
	iters: 200, epoch: 16 | loss: 0.0005036
	speed: 0.1340s/iter; left time: 916.1533s
	iters: 300, epoch: 16 | loss: 0.0003499
	speed: 0.1196s/iter; left time: 805.6486s
	iters: 400, epoch: 16 | loss: 0.0005679
	speed: 0.1208s/iter; left time: 801.6060s
Epoch: 16 cost time: 59.36044502258301
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0008010
	speed: 0.5304s/iter; left time: 3430.3470s
	iters: 200, epoch: 17 | loss: 0.0003434
	speed: 0.1282s/iter; left time: 816.3947s
	iters: 300, epoch: 17 | loss: 0.0232868
	speed: 0.1267s/iter; left time: 794.0255s
	iters: 400, epoch: 17 | loss: 0.0005762
	speed: 0.1279s/iter; left time: 788.5557s
Epoch: 17 cost time: 61.78958773612976
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0007598
	speed: 0.5557s/iter; left time: 3333.1477s
	iters: 200, epoch: 18 | loss: 0.0426829
	speed: 0.1271s/iter; left time: 749.7807s
	iters: 300, epoch: 18 | loss: 0.0065830
	speed: 0.1293s/iter; left time: 749.6251s
	iters: 400, epoch: 18 | loss: 0.0016660
	speed: 0.1372s/iter; left time: 781.5234s
Epoch: 18 cost time: 61.46097922325134
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0011919
	speed: 0.5398s/iter; left time: 2984.2947s
	iters: 200, epoch: 19 | loss: 0.2847541
	speed: 0.1337s/iter; left time: 725.9382s
	iters: 300, epoch: 19 | loss: 0.0009198
	speed: 0.1416s/iter; left time: 754.7834s
	iters: 400, epoch: 19 | loss: 0.0017560
	speed: 0.1415s/iter; left time: 740.1499s
Epoch: 19 cost time: 63.96697497367859
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0015780
	speed: 0.5589s/iter; left time: 2827.7938s
	iters: 200, epoch: 20 | loss: 0.0078479
	speed: 0.1473s/iter; left time: 730.7188s
	iters: 300, epoch: 20 | loss: 0.0086197
	speed: 0.1479s/iter; left time: 718.9869s
	iters: 400, epoch: 20 | loss: 0.0009641
	speed: 0.1389s/iter; left time: 660.9890s
Epoch: 20 cost time: 67.27391028404236
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0184766
	speed: 0.5776s/iter; left time: 2651.7181s
	iters: 200, epoch: 21 | loss: 0.0143102
	speed: 0.1474s/iter; left time: 662.0235s
	iters: 300, epoch: 21 | loss: 0.0023883
	speed: 0.1301s/iter; left time: 571.1556s
	iters: 400, epoch: 21 | loss: 0.0006797
	speed: 0.1284s/iter; left time: 550.9179s
Epoch: 21 cost time: 64.69778847694397
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.051 Vali Acc: 0.984 Test Loss: 0.051 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.983990).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001833
	speed: 0.5635s/iter; left time: 2322.8442s
	iters: 200, epoch: 22 | loss: 0.0013333
	speed: 0.1293s/iter; left time: 520.2338s
	iters: 300, epoch: 22 | loss: 0.0010494
	speed: 0.1282s/iter; left time: 502.8785s
	iters: 400, epoch: 22 | loss: 0.0310351
	speed: 0.1315s/iter; left time: 502.4715s
Epoch: 22 cost time: 63.188992500305176
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0008213
	speed: 0.5882s/iter; left time: 2148.7079s
	iters: 200, epoch: 23 | loss: 0.0005852
	speed: 0.1348s/iter; left time: 478.9982s
	iters: 300, epoch: 23 | loss: 0.0004870
	speed: 0.1365s/iter; left time: 471.2718s
	iters: 400, epoch: 23 | loss: 0.0004024
	speed: 0.1475s/iter; left time: 494.7141s
Epoch: 23 cost time: 65.95248460769653
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0001721
	speed: 0.5701s/iter; left time: 1815.2667s
	iters: 200, epoch: 24 | loss: 0.0004698
	speed: 0.1320s/iter; left time: 407.0292s
	iters: 300, epoch: 24 | loss: 0.0018438
	speed: 0.1416s/iter; left time: 422.4622s
	iters: 400, epoch: 24 | loss: 0.0037970
	speed: 0.1414s/iter; left time: 407.9216s
Epoch: 24 cost time: 64.1353542804718
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0018712
	speed: 0.5394s/iter; left time: 1464.5394s
	iters: 200, epoch: 25 | loss: 0.0564227
	speed: 0.1338s/iter; left time: 350.0112s
	iters: 300, epoch: 25 | loss: 0.0001492
	speed: 0.1093s/iter; left time: 274.7744s
	iters: 400, epoch: 25 | loss: 0.0001711
	speed: 0.1541s/iter; left time: 372.1736s
Epoch: 25 cost time: 63.64400935173035
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0021179
	speed: 0.6343s/iter; left time: 1424.7400s
	iters: 200, epoch: 26 | loss: 0.0327311
	speed: 0.1467s/iter; left time: 314.9174s
	iters: 300, epoch: 26 | loss: 0.0056654
	speed: 0.1444s/iter; left time: 295.5097s
	iters: 400, epoch: 26 | loss: 0.0003229
	speed: 0.1451s/iter; left time: 282.2765s
Epoch: 26 cost time: 69.17984533309937
Epoch: 26, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.4236596
	speed: 0.5991s/iter; left time: 1064.6580s
	iters: 200, epoch: 27 | loss: 0.0001216
	speed: 0.1496s/iter; left time: 250.8275s
	iters: 300, epoch: 27 | loss: 0.0002427
	speed: 0.1460s/iter; left time: 230.2668s
	iters: 400, epoch: 27 | loss: 0.0027892
	speed: 0.1404s/iter; left time: 207.4384s
Epoch: 27 cost time: 68.20957159996033
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0005575
	speed: 0.5752s/iter; left time: 752.3609s
	iters: 200, epoch: 28 | loss: 0.0039860
	speed: 0.1557s/iter; left time: 188.0912s
	iters: 300, epoch: 28 | loss: 0.0085056
	speed: 0.1546s/iter; left time: 171.3401s
	iters: 400, epoch: 28 | loss: 0.0005878
	speed: 0.1550s/iter; left time: 156.2526s
Epoch: 28 cost time: 71.78978514671326
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0066476
	speed: 0.5998s/iter; left time: 503.1939s
	iters: 200, epoch: 29 | loss: 0.0132104
	speed: 0.1380s/iter; left time: 101.9724s
	iters: 300, epoch: 29 | loss: 0.0001796
	speed: 0.1370s/iter; left time: 87.5296s
	iters: 400, epoch: 29 | loss: 0.0006054
	speed: 0.1304s/iter; left time: 70.3125s
Epoch: 29 cost time: 64.0369987487793
Epoch: 29, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0179761
	speed: 0.5754s/iter; left time: 212.8893s
	iters: 200, epoch: 30 | loss: 0.0003409
	speed: 0.1286s/iter; left time: 34.7341s
	iters: 300, epoch: 30 | loss: 0.0038952
	speed: 0.1296s/iter; left time: 22.0260s
	iters: 400, epoch: 30 | loss: 0.0000756
	speed: 0.1276s/iter; left time: 8.9335s
Epoch: 30 cost time: 61.427743434906006
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 260106
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7197025
	speed: 0.4819s/iter; left time: 6732.5801s
	iters: 200, epoch: 1 | loss: 1.1076033
	speed: 0.4564s/iter; left time: 6330.4341s
	iters: 300, epoch: 1 | loss: 0.8734915
	speed: 0.4683s/iter; left time: 6449.0788s
	iters: 400, epoch: 1 | loss: 0.3058627
	speed: 0.4418s/iter; left time: 6039.4336s
Epoch: 1 cost time: 214.72606539726257
Epoch: 1, Steps: 469 | Train Loss: 1.117 Vali Loss: 0.317 Vali Acc: 0.909 Test Loss: 0.317 Test Acc: 0.909
Validation loss decreased (inf --> -0.909374).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0966883
	speed: 1.1490s/iter; left time: 15513.8807s
	iters: 200, epoch: 2 | loss: 0.1565288
	speed: 0.4544s/iter; left time: 6089.8758s
	iters: 300, epoch: 2 | loss: 0.0606318
	speed: 0.4613s/iter; left time: 6136.1291s
	iters: 400, epoch: 2 | loss: 0.0579034
	speed: 0.4588s/iter; left time: 6057.6222s
Epoch: 2 cost time: 215.29432654380798
Epoch: 2, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.909374 --> -0.965979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0858532
	speed: 1.1334s/iter; left time: 14771.2237s
	iters: 200, epoch: 3 | loss: 0.0361668
	speed: 0.4629s/iter; left time: 5986.5298s
	iters: 300, epoch: 3 | loss: 0.0375465
	speed: 0.4747s/iter; left time: 6091.4361s
	iters: 400, epoch: 3 | loss: 0.0298481
	speed: 0.4957s/iter; left time: 6311.9310s
Epoch: 3 cost time: 224.01877331733704
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.965979 --> -0.977701).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0081456
	speed: 1.1900s/iter; left time: 14950.6367s
	iters: 200, epoch: 4 | loss: 0.0134799
	speed: 0.5000s/iter; left time: 6231.4929s
	iters: 300, epoch: 4 | loss: 0.0236496
	speed: 0.4842s/iter; left time: 5987.0009s
	iters: 400, epoch: 4 | loss: 0.0077176
	speed: 0.4955s/iter; left time: 6077.3810s
Epoch: 4 cost time: 232.23110508918762
Epoch: 4, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0038793
	speed: 1.1825s/iter; left time: 14302.8612s
	iters: 200, epoch: 5 | loss: 0.0050541
	speed: 0.5116s/iter; left time: 6136.9965s
	iters: 300, epoch: 5 | loss: 0.0048964
	speed: 0.4823s/iter; left time: 5736.7605s
	iters: 400, epoch: 5 | loss: 0.0821023
	speed: 0.4916s/iter; left time: 5798.1695s
Epoch: 5 cost time: 232.09132766723633
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0299625
	speed: 1.1596s/iter; left time: 13482.0806s
	iters: 200, epoch: 6 | loss: 0.0845045
	speed: 0.4800s/iter; left time: 5532.0426s
	iters: 300, epoch: 6 | loss: 0.3435084
	speed: 0.4250s/iter; left time: 4856.2995s
	iters: 400, epoch: 6 | loss: 0.0530442
	speed: 0.4493s/iter; left time: 5088.7914s
Epoch: 6 cost time: 212.79163527488708
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.977701 --> -0.981131).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1722707
	speed: 1.1248s/iter; left time: 12549.1083s
	iters: 200, epoch: 7 | loss: 0.0020516
	speed: 0.4483s/iter; left time: 4957.0453s
	iters: 300, epoch: 7 | loss: 0.0751769
	speed: 0.4644s/iter; left time: 5088.4481s
	iters: 400, epoch: 7 | loss: 0.0674444
	speed: 0.4126s/iter; left time: 4479.4369s
Epoch: 7 cost time: 206.62499260902405
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981131).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0041767
	speed: 1.0625s/iter; left time: 11356.0317s
	iters: 200, epoch: 8 | loss: 0.0080513
	speed: 0.4073s/iter; left time: 4312.7914s
	iters: 300, epoch: 8 | loss: 0.0197517
	speed: 0.4540s/iter; left time: 4761.7620s
	iters: 400, epoch: 8 | loss: 0.1992923
	speed: 0.4169s/iter; left time: 4330.3247s
Epoch: 8 cost time: 198.03047156333923
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0550735
	speed: 1.0742s/iter; left time: 10977.7322s
	iters: 200, epoch: 9 | loss: 0.0450615
	speed: 0.3787s/iter; left time: 3832.1844s
	iters: 300, epoch: 9 | loss: 0.0017636
	speed: 0.4499s/iter; left time: 4507.4214s
	iters: 400, epoch: 9 | loss: 0.0031054
	speed: 0.4420s/iter; left time: 4384.1429s
Epoch: 9 cost time: 198.78784346580505
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0072153
	speed: 1.0651s/iter; left time: 10385.0209s
	iters: 200, epoch: 10 | loss: 0.0004064
	speed: 0.3958s/iter; left time: 3819.3500s
	iters: 300, epoch: 10 | loss: 0.0010472
	speed: 0.4262s/iter; left time: 4069.7368s
	iters: 400, epoch: 10 | loss: 0.0008882
	speed: 0.4563s/iter; left time: 4312.2294s
Epoch: 10 cost time: 200.51999068260193
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0012696
	speed: 1.0184s/iter; left time: 9452.0858s
	iters: 200, epoch: 11 | loss: 0.0577010
	speed: 0.3958s/iter; left time: 3633.9639s
	iters: 300, epoch: 11 | loss: 0.0049943
	speed: 0.4132s/iter; left time: 3752.0927s
	iters: 400, epoch: 11 | loss: 0.0387394
	speed: 0.4293s/iter; left time: 3855.3789s
Epoch: 11 cost time: 193.28543615341187
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.983418).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0111698
	speed: 1.0147s/iter; left time: 8941.2931s
	iters: 200, epoch: 12 | loss: 0.0153802
	speed: 0.4128s/iter; left time: 3596.7309s
	iters: 300, epoch: 12 | loss: 0.0029506
	speed: 0.4128s/iter; left time: 3555.2944s
	iters: 400, epoch: 12 | loss: 0.0073428
	speed: 0.4273s/iter; left time: 3636.9551s
Epoch: 12 cost time: 195.91131615638733
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983418 --> -0.983418).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1073134
	speed: 1.0277s/iter; left time: 8574.3797s
	iters: 200, epoch: 13 | loss: 0.0007479
	speed: 0.4216s/iter; left time: 3474.9005s
	iters: 300, epoch: 13 | loss: 0.0015547
	speed: 0.4043s/iter; left time: 3292.0067s
	iters: 400, epoch: 13 | loss: 0.0410002
	speed: 0.4262s/iter; left time: 3428.1677s
Epoch: 13 cost time: 197.42211031913757
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0026427
	speed: 1.0334s/iter; left time: 8136.8286s
	iters: 200, epoch: 14 | loss: 0.0016473
	speed: 0.4234s/iter; left time: 3291.2164s
	iters: 300, epoch: 14 | loss: 0.0247443
	speed: 0.3922s/iter; left time: 3009.5505s
	iters: 400, epoch: 14 | loss: 0.0036681
	speed: 0.4237s/iter; left time: 3209.1610s
Epoch: 14 cost time: 190.79164671897888
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0126882
	speed: 0.9732s/iter; left time: 7206.3842s
	iters: 200, epoch: 15 | loss: 0.0030036
	speed: 0.4258s/iter; left time: 3110.8111s
	iters: 300, epoch: 15 | loss: 0.0007336
	speed: 0.3590s/iter; left time: 2586.3745s
	iters: 400, epoch: 15 | loss: 0.1034881
	speed: 0.3447s/iter; left time: 2448.8922s
Epoch: 15 cost time: 173.85542249679565
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0003099
	speed: 0.9895s/iter; left time: 6863.0709s
	iters: 200, epoch: 16 | loss: 0.0010770
	speed: 0.4121s/iter; left time: 2817.3545s
	iters: 300, epoch: 16 | loss: 0.0033210
	speed: 0.3973s/iter; left time: 2676.2543s
	iters: 400, epoch: 16 | loss: 0.0037278
	speed: 0.4461s/iter; left time: 2960.6257s
Epoch: 16 cost time: 195.0873143672943
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0012791
	speed: 0.9899s/iter; left time: 6401.4411s
	iters: 200, epoch: 17 | loss: 0.0086848
	speed: 0.4484s/iter; left time: 2854.7822s
	iters: 300, epoch: 17 | loss: 0.0004968
	speed: 0.4208s/iter; left time: 2637.0442s
	iters: 400, epoch: 17 | loss: 0.0080321
	speed: 0.4039s/iter; left time: 2490.9619s
Epoch: 17 cost time: 191.73644137382507
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0111734
	speed: 1.0445s/iter; left time: 6264.8792s
	iters: 200, epoch: 18 | loss: 0.0022769
	speed: 0.4179s/iter; left time: 2464.7018s
	iters: 300, epoch: 18 | loss: 0.0005922
	speed: 0.4049s/iter; left time: 2347.7138s
	iters: 400, epoch: 18 | loss: 0.0002629
	speed: 0.4606s/iter; left time: 2624.5605s
Epoch: 18 cost time: 203.3684422969818
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0004900
	speed: 1.0925s/iter; left time: 6040.1667s
	iters: 200, epoch: 19 | loss: 0.0008401
	speed: 0.4568s/iter; left time: 2479.9609s
	iters: 300, epoch: 19 | loss: 0.0022291
	speed: 0.4699s/iter; left time: 2504.1931s
	iters: 400, epoch: 19 | loss: 0.0001708
	speed: 0.4210s/iter; left time: 2201.2686s
Epoch: 19 cost time: 207.54223561286926
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1517131
	speed: 1.1227s/iter; left time: 5680.9942s
	iters: 200, epoch: 20 | loss: 0.0002084
	speed: 0.4271s/iter; left time: 2118.5791s
	iters: 300, epoch: 20 | loss: 0.0014214
	speed: 0.4440s/iter; left time: 2158.0285s
	iters: 400, epoch: 20 | loss: 0.0005730
	speed: 0.4408s/iter; left time: 2098.1081s
Epoch: 20 cost time: 211.59693002700806
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0008789
	speed: 1.1038s/iter; left time: 5067.4339s
	iters: 200, epoch: 21 | loss: 0.0001695
	speed: 0.4396s/iter; left time: 1974.1401s
	iters: 300, epoch: 21 | loss: 0.0000799
	speed: 0.4649s/iter; left time: 2041.4337s
	iters: 400, epoch: 21 | loss: 0.0011769
	speed: 0.4127s/iter; left time: 1770.8943s
Epoch: 21 cost time: 207.59701585769653
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.983418 --> -0.985420).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0008637
	speed: 1.1241s/iter; left time: 4633.4868s
	iters: 200, epoch: 22 | loss: 0.2134319
	speed: 0.4019s/iter; left time: 1616.6075s
	iters: 300, epoch: 22 | loss: 0.0734372
	speed: 0.3877s/iter; left time: 1520.6345s
	iters: 400, epoch: 22 | loss: 0.0002353
	speed: 0.3885s/iter; left time: 1484.9722s
Epoch: 22 cost time: 187.74795627593994
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0181111
	speed: 0.8968s/iter; left time: 3276.1171s
	iters: 200, epoch: 23 | loss: 0.0009094
	speed: 0.3840s/iter; left time: 1364.1952s
	iters: 300, epoch: 23 | loss: 0.0013058
	speed: 0.3384s/iter; left time: 1168.5644s
	iters: 400, epoch: 23 | loss: 0.0005564
	speed: 0.3475s/iter; left time: 1165.1608s
Epoch: 23 cost time: 170.51464104652405
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.985420 --> -0.985420).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0006937
	speed: 0.9162s/iter; left time: 2917.1940s
	iters: 200, epoch: 24 | loss: 0.0325212
	speed: 0.3459s/iter; left time: 1066.7577s
	iters: 300, epoch: 24 | loss: 0.0011291
	speed: 0.3839s/iter; left time: 1145.5422s
	iters: 400, epoch: 24 | loss: 0.0002133
	speed: 0.3610s/iter; left time: 1041.1238s
Epoch: 24 cost time: 166.8179371356964
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0002410
	speed: 0.9183s/iter; left time: 2493.2730s
	iters: 200, epoch: 25 | loss: 0.0208411
	speed: 0.3576s/iter; left time: 935.1736s
	iters: 300, epoch: 25 | loss: 0.0104645
	speed: 0.3428s/iter; left time: 862.0762s
	iters: 400, epoch: 25 | loss: 0.0007150
	speed: 0.3842s/iter; left time: 927.9070s
Epoch: 25 cost time: 172.61550664901733
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0015377
	speed: 0.8302s/iter; left time: 1864.6669s
	iters: 200, epoch: 26 | loss: 0.0001845
	speed: 0.4693s/iter; left time: 1007.0616s
	iters: 300, epoch: 26 | loss: 0.0004580
	speed: 0.4310s/iter; left time: 881.7908s
	iters: 400, epoch: 26 | loss: 0.0000513
	speed: 0.4148s/iter; left time: 807.1939s
Epoch: 26 cost time: 191.5557346343994
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0013185
	speed: 1.0906s/iter; left time: 1937.9251s
	iters: 200, epoch: 27 | loss: 0.0029814
	speed: 0.4345s/iter; left time: 728.6093s
	iters: 300, epoch: 27 | loss: 0.0011508
	speed: 0.4388s/iter; left time: 691.9504s
	iters: 400, epoch: 27 | loss: 0.0002365
	speed: 0.3735s/iter; left time: 551.6696s
Epoch: 27 cost time: 193.65422415733337
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0001708
	speed: 1.0213s/iter; left time: 1335.8292s
	iters: 200, epoch: 28 | loss: 0.0001719
	speed: 0.4433s/iter; left time: 535.4506s
	iters: 300, epoch: 28 | loss: 0.0005187
	speed: 0.3875s/iter; left time: 429.3931s
	iters: 400, epoch: 28 | loss: 0.0087337
	speed: 0.4409s/iter; left time: 444.3991s
Epoch: 28 cost time: 202.61348032951355
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0100151
	speed: 1.0375s/iter; left time: 870.4859s
	iters: 200, epoch: 29 | loss: 0.0001554
	speed: 0.3728s/iter; left time: 275.5230s
	iters: 300, epoch: 29 | loss: 0.0005252
	speed: 0.2793s/iter; left time: 178.4596s
	iters: 400, epoch: 29 | loss: 0.0005058
	speed: 0.3431s/iter; left time: 184.9050s
Epoch: 29 cost time: 163.8868124485016
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0003324
	speed: 0.8516s/iter; left time: 315.0929s
	iters: 200, epoch: 30 | loss: 0.0549845
	speed: 0.3678s/iter; left time: 99.3080s
	iters: 300, epoch: 30 | loss: 0.0010321
	speed: 0.2978s/iter; left time: 50.6335s
	iters: 400, epoch: 30 | loss: 0.0031715
	speed: 0.3695s/iter; left time: 25.8654s
Epoch: 30 cost time: 157.58077597618103
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 441354
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9616698
	speed: 0.2429s/iter; left time: 3393.0199s
	iters: 200, epoch: 1 | loss: 1.2241298
	speed: 0.2488s/iter; left time: 3451.5409s
	iters: 300, epoch: 1 | loss: 1.1155577
	speed: 0.2256s/iter; left time: 3106.7251s
	iters: 400, epoch: 1 | loss: 0.6717795
	speed: 0.2070s/iter; left time: 2829.5450s
Epoch: 1 cost time: 108.5463194847107
Epoch: 1, Steps: 469 | Train Loss: 1.249 Vali Loss: 0.414 Vali Acc: 0.888 Test Loss: 0.414 Test Acc: 0.888
Validation loss decreased (inf --> -0.887932).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2647019
	speed: 0.6968s/iter; left time: 9407.5460s
	iters: 200, epoch: 2 | loss: 0.1541510
	speed: 0.2164s/iter; left time: 2899.9250s
	iters: 300, epoch: 2 | loss: 0.1270753
	speed: 0.2350s/iter; left time: 3125.7030s
	iters: 400, epoch: 2 | loss: 0.0791216
	speed: 0.2262s/iter; left time: 2986.6519s
Epoch: 2 cost time: 105.05941891670227
Epoch: 2, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.887932 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0641451
	speed: 0.6799s/iter; left time: 8861.4385s
	iters: 200, epoch: 3 | loss: 0.0278324
	speed: 0.2147s/iter; left time: 2777.1221s
	iters: 300, epoch: 3 | loss: 0.0098700
	speed: 0.2483s/iter; left time: 3186.0346s
	iters: 400, epoch: 3 | loss: 0.0109818
	speed: 0.1970s/iter; left time: 2507.8808s
Epoch: 3 cost time: 99.14713335037231
Epoch: 3, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
Validation loss decreased (-0.964264 --> -0.964264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0331269
	speed: 0.5953s/iter; left time: 7479.1197s
	iters: 200, epoch: 4 | loss: 0.0989961
	speed: 0.1933s/iter; left time: 2409.1102s
	iters: 300, epoch: 4 | loss: 0.0080828
	speed: 0.2038s/iter; left time: 2520.0454s
	iters: 400, epoch: 4 | loss: 0.0386609
	speed: 0.1882s/iter; left time: 2308.1061s
Epoch: 4 cost time: 91.18945121765137
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.964264 --> -0.974842).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0082064
	speed: 0.6010s/iter; left time: 7269.5478s
	iters: 200, epoch: 5 | loss: 0.1738372
	speed: 0.1699s/iter; left time: 2037.5764s
	iters: 300, epoch: 5 | loss: 0.0142804
	speed: 0.1946s/iter; left time: 2314.9040s
	iters: 400, epoch: 5 | loss: 0.0027551
	speed: 0.2086s/iter; left time: 2460.4042s
Epoch: 5 cost time: 90.8100938796997
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (-0.974842 --> -0.978558).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0277501
	speed: 0.6167s/iter; left time: 7170.0093s
	iters: 200, epoch: 6 | loss: 0.0144712
	speed: 0.2079s/iter; left time: 2396.5093s
	iters: 300, epoch: 6 | loss: 0.2169288
	speed: 0.2368s/iter; left time: 2705.4625s
	iters: 400, epoch: 6 | loss: 0.0023471
	speed: 0.2391s/iter; left time: 2708.1249s
Epoch: 6 cost time: 103.80256938934326
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0014835
	speed: 0.6695s/iter; left time: 7469.1620s
	iters: 200, epoch: 7 | loss: 0.0021070
	speed: 0.2232s/iter; left time: 2467.6176s
	iters: 300, epoch: 7 | loss: 0.0088614
	speed: 0.2241s/iter; left time: 2455.1934s
	iters: 400, epoch: 7 | loss: 0.0424277
	speed: 0.2237s/iter; left time: 2429.2061s
Epoch: 7 cost time: 105.48621463775635
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0030145
	speed: 0.6858s/iter; left time: 7329.3097s
	iters: 200, epoch: 8 | loss: 0.0040251
	speed: 0.2037s/iter; left time: 2156.4439s
	iters: 300, epoch: 8 | loss: 0.0210563
	speed: 0.2058s/iter; left time: 2157.9846s
	iters: 400, epoch: 8 | loss: 0.0303400
	speed: 0.1531s/iter; left time: 1590.2531s
Epoch: 8 cost time: 95.36528301239014
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0032453
	speed: 0.6844s/iter; left time: 6994.2228s
	iters: 200, epoch: 9 | loss: 0.0009637
	speed: 0.2314s/iter; left time: 2341.9981s
	iters: 300, epoch: 9 | loss: 0.0021045
	speed: 0.2312s/iter; left time: 2316.2364s
	iters: 400, epoch: 9 | loss: 0.0020058
	speed: 0.2247s/iter; left time: 2229.2383s
Epoch: 9 cost time: 105.52118730545044
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.980845).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0074971
	speed: 0.6474s/iter; left time: 6312.0207s
	iters: 200, epoch: 10 | loss: 0.0175952
	speed: 0.1985s/iter; left time: 1915.4822s
	iters: 300, epoch: 10 | loss: 0.0076286
	speed: 0.2047s/iter; left time: 1954.9532s
	iters: 400, epoch: 10 | loss: 0.0013268
	speed: 0.2017s/iter; left time: 1906.0578s
Epoch: 10 cost time: 95.90620136260986
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0097152
	speed: 0.5710s/iter; left time: 5299.8515s
	iters: 200, epoch: 11 | loss: 0.0017403
	speed: 0.2253s/iter; left time: 2068.3578s
	iters: 300, epoch: 11 | loss: 0.0053598
	speed: 0.2239s/iter; left time: 2033.6642s
	iters: 400, epoch: 11 | loss: 0.1020871
	speed: 0.2450s/iter; left time: 2200.7558s
Epoch: 11 cost time: 103.74600863456726
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0051129
	speed: 0.6709s/iter; left time: 5912.1416s
	iters: 200, epoch: 12 | loss: 0.0386469
	speed: 0.2076s/iter; left time: 1808.6412s
	iters: 300, epoch: 12 | loss: 0.0008857
	speed: 0.2230s/iter; left time: 1920.0626s
	iters: 400, epoch: 12 | loss: 0.0033635
	speed: 0.2081s/iter; left time: 1771.0675s
Epoch: 12 cost time: 102.19976472854614
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0035963
	speed: 0.7100s/iter; left time: 5923.7406s
	iters: 200, epoch: 13 | loss: 0.0200341
	speed: 0.2341s/iter; left time: 1929.3563s
	iters: 300, epoch: 13 | loss: 0.3674296
	speed: 0.2132s/iter; left time: 1736.1326s
	iters: 400, epoch: 13 | loss: 0.0018826
	speed: 0.2192s/iter; left time: 1763.0827s
Epoch: 13 cost time: 102.90391039848328
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0408192
	speed: 0.5958s/iter; left time: 4690.9886s
	iters: 200, epoch: 14 | loss: 0.0011642
	speed: 0.2168s/iter; left time: 1685.1960s
	iters: 300, epoch: 14 | loss: 0.0021153
	speed: 0.2044s/iter; left time: 1568.5419s
	iters: 400, epoch: 14 | loss: 0.0031935
	speed: 0.2051s/iter; left time: 1553.5222s
Epoch: 14 cost time: 96.3395516872406
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0004587
	speed: 0.5846s/iter; left time: 4329.0893s
	iters: 200, epoch: 15 | loss: 0.0032928
	speed: 0.1818s/iter; left time: 1327.9776s
	iters: 300, epoch: 15 | loss: 0.0003128
	speed: 0.2196s/iter; left time: 1582.2305s
	iters: 400, epoch: 15 | loss: 0.0093739
	speed: 0.2026s/iter; left time: 1439.6828s
Epoch: 15 cost time: 94.74960803985596
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0136298
	speed: 0.6036s/iter; left time: 4186.7997s
	iters: 200, epoch: 16 | loss: 0.0004852
	speed: 0.2087s/iter; left time: 1426.6360s
	iters: 300, epoch: 16 | loss: 0.0009528
	speed: 0.2074s/iter; left time: 1396.9580s
	iters: 400, epoch: 16 | loss: 0.0034396
	speed: 0.2352s/iter; left time: 1560.8302s
Epoch: 16 cost time: 99.40150809288025
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
Validation loss decreased (-0.980845 --> -0.983419).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0010013
	speed: 0.6829s/iter; left time: 4416.5521s
	iters: 200, epoch: 17 | loss: 0.0001303
	speed: 0.2645s/iter; left time: 1683.8377s
	iters: 300, epoch: 17 | loss: 0.5790104
	speed: 0.2254s/iter; left time: 1412.6290s
	iters: 400, epoch: 17 | loss: 0.0003898
	speed: 0.2301s/iter; left time: 1418.7659s
Epoch: 17 cost time: 112.69223093986511
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0017131
	speed: 0.7326s/iter; left time: 4394.1424s
	iters: 200, epoch: 18 | loss: 0.0002379
	speed: 0.2598s/iter; left time: 1532.5544s
	iters: 300, epoch: 18 | loss: 0.0010177
	speed: 0.2614s/iter; left time: 1515.5732s
	iters: 400, epoch: 18 | loss: 0.0490944
	speed: 0.2387s/iter; left time: 1359.9445s
Epoch: 18 cost time: 116.14181327819824
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0001020
	speed: 0.6438s/iter; left time: 3559.5346s
	iters: 200, epoch: 19 | loss: 0.0402546
	speed: 0.2107s/iter; left time: 1143.6491s
	iters: 300, epoch: 19 | loss: 0.0024786
	speed: 0.2418s/iter; left time: 1288.7940s
	iters: 400, epoch: 19 | loss: 0.0008483
	speed: 0.2267s/iter; left time: 1185.2990s
Epoch: 19 cost time: 102.59450101852417
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.983419 --> -0.985420).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0002249
	speed: 0.6628s/iter; left time: 3353.6460s
	iters: 200, epoch: 20 | loss: 0.0013795
	speed: 0.1928s/iter; left time: 956.0697s
	iters: 300, epoch: 20 | loss: 0.0706707
	speed: 0.2100s/iter; left time: 1020.7816s
	iters: 400, epoch: 20 | loss: 0.0009289
	speed: 0.2316s/iter; left time: 1102.6298s
Epoch: 20 cost time: 99.96744775772095
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0002495
	speed: 0.6819s/iter; left time: 3130.5557s
	iters: 200, epoch: 21 | loss: 0.0002946
	speed: 0.2154s/iter; left time: 967.5059s
	iters: 300, epoch: 21 | loss: 0.0068928
	speed: 0.2244s/iter; left time: 985.2372s
	iters: 400, epoch: 21 | loss: 0.0002792
	speed: 0.2432s/iter; left time: 1043.5474s
Epoch: 21 cost time: 109.31946516036987
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0003314
	speed: 0.7326s/iter; left time: 3019.7927s
	iters: 200, epoch: 22 | loss: 0.0001780
	speed: 0.2629s/iter; left time: 1057.3380s
	iters: 300, epoch: 22 | loss: 0.0006133
	speed: 0.2442s/iter; left time: 957.8619s
	iters: 400, epoch: 22 | loss: 0.0003134
	speed: 0.2451s/iter; left time: 936.8154s
Epoch: 22 cost time: 118.68640875816345
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0012776
	speed: 0.7101s/iter; left time: 2594.0877s
	iters: 200, epoch: 23 | loss: 0.0383354
	speed: 0.2566s/iter; left time: 911.6471s
	iters: 300, epoch: 23 | loss: 0.0011435
	speed: 0.2548s/iter; left time: 879.9092s
	iters: 400, epoch: 23 | loss: 0.1318079
	speed: 0.2443s/iter; left time: 819.0309s
Epoch: 23 cost time: 115.9695770740509
Epoch: 23, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0051588
	speed: 0.6845s/iter; left time: 2179.3345s
	iters: 200, epoch: 24 | loss: 0.0055406
	speed: 0.1946s/iter; left time: 600.0932s
	iters: 300, epoch: 24 | loss: 0.0004345
	speed: 0.1602s/iter; left time: 478.0343s
	iters: 400, epoch: 24 | loss: 0.0001225
	speed: 0.1850s/iter; left time: 533.6575s
Epoch: 24 cost time: 87.012619972229
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0004065
	speed: 0.5932s/iter; left time: 1610.6064s
	iters: 200, epoch: 25 | loss: 0.0098678
	speed: 0.1952s/iter; left time: 510.3832s
	iters: 300, epoch: 25 | loss: 0.0075121
	speed: 0.1651s/iter; left time: 415.2185s
	iters: 400, epoch: 25 | loss: 0.0017181
	speed: 0.1839s/iter; left time: 444.0596s
Epoch: 25 cost time: 85.35098910331726
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0001225
	speed: 0.5622s/iter; left time: 1262.7264s
	iters: 200, epoch: 26 | loss: 0.0022689
	speed: 0.2071s/iter; left time: 444.5107s
	iters: 300, epoch: 26 | loss: 0.0020218
	speed: 0.1968s/iter; left time: 402.7054s
	iters: 400, epoch: 26 | loss: 0.0048165
	speed: 0.2306s/iter; left time: 448.7734s
Epoch: 26 cost time: 96.34563946723938
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0237194
	speed: 0.6232s/iter; left time: 1107.4813s
	iters: 200, epoch: 27 | loss: 0.0001581
	speed: 0.2132s/iter; left time: 357.5864s
	iters: 300, epoch: 27 | loss: 0.0001145
	speed: 0.2271s/iter; left time: 358.1051s
	iters: 400, epoch: 27 | loss: 0.0008038
	speed: 0.2245s/iter; left time: 331.5229s
Epoch: 27 cost time: 102.95505285263062
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0020816
	speed: 0.6674s/iter; left time: 872.9642s
	iters: 200, epoch: 28 | loss: 0.0000444
	speed: 0.1964s/iter; left time: 237.2940s
	iters: 300, epoch: 28 | loss: 0.0030676
	speed: 0.2167s/iter; left time: 240.1540s
	iters: 400, epoch: 28 | loss: 0.0054341
	speed: 0.2011s/iter; left time: 202.6958s
Epoch: 28 cost time: 99.01798796653748
Epoch: 28, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000760
	speed: 0.6661s/iter; left time: 558.8270s
	iters: 200, epoch: 29 | loss: 0.0023473
	speed: 0.1924s/iter; left time: 142.1628s
	iters: 300, epoch: 29 | loss: 0.0001522
	speed: 0.1869s/iter; left time: 119.4201s
	iters: 400, epoch: 29 | loss: 0.0056637
	speed: 0.1648s/iter; left time: 88.8235s
Epoch: 29 cost time: 87.62347841262817
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 130890
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7224060
	speed: 0.2758s/iter; left time: 3852.7563s
	iters: 200, epoch: 1 | loss: 1.1460727
	speed: 0.2425s/iter; left time: 3364.3580s
	iters: 300, epoch: 1 | loss: 0.9007292
	speed: 0.2472s/iter; left time: 3404.5576s
	iters: 400, epoch: 1 | loss: 0.3249930
	speed: 0.2067s/iter; left time: 2826.4037s
Epoch: 1 cost time: 113.5017580986023
Epoch: 1, Steps: 469 | Train Loss: 1.132 Vali Loss: 0.335 Vali Acc: 0.901 Test Loss: 0.335 Test Acc: 0.901
Validation loss decreased (inf --> -0.900511).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1130307
	speed: 0.6811s/iter; left time: 9195.5459s
	iters: 200, epoch: 2 | loss: 0.1445950
	speed: 0.2742s/iter; left time: 3674.9971s
	iters: 300, epoch: 2 | loss: 0.0644815
	speed: 0.2981s/iter; left time: 3965.4059s
	iters: 400, epoch: 2 | loss: 0.0661414
	speed: 0.2571s/iter; left time: 3394.6897s
Epoch: 2 cost time: 127.8397970199585
Epoch: 2, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
Validation loss decreased (-0.900511 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0936217
	speed: 0.7502s/iter; left time: 9777.1294s
	iters: 200, epoch: 3 | loss: 0.0312827
	speed: 0.2803s/iter; left time: 3625.2486s
	iters: 300, epoch: 3 | loss: 0.0429097
	speed: 0.2978s/iter; left time: 3822.1689s
	iters: 400, epoch: 3 | loss: 0.0369845
	speed: 0.2770s/iter; left time: 3526.8122s
Epoch: 3 cost time: 132.45089960098267
Epoch: 3, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.964264 --> -0.976271).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0092514
	speed: 0.7507s/iter; left time: 9431.8729s
	iters: 200, epoch: 4 | loss: 0.0298271
	speed: 0.2656s/iter; left time: 3310.8137s
	iters: 300, epoch: 4 | loss: 0.0346246
	speed: 0.2710s/iter; left time: 3350.6774s
	iters: 400, epoch: 4 | loss: 0.0065961
	speed: 0.2418s/iter; left time: 2964.9881s
Epoch: 4 cost time: 123.99770879745483
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0053257
	speed: 0.6803s/iter; left time: 8228.5384s
	iters: 200, epoch: 5 | loss: 0.0048268
	speed: 0.2182s/iter; left time: 2617.4993s
	iters: 300, epoch: 5 | loss: 0.0051537
	speed: 0.2394s/iter; left time: 2847.0959s
	iters: 400, epoch: 5 | loss: 0.0561536
	speed: 0.2446s/iter; left time: 2885.3663s
Epoch: 5 cost time: 112.10310792922974
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.976271 --> -0.977701).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0089443
	speed: 0.6908s/iter; left time: 8031.8202s
	iters: 200, epoch: 6 | loss: 0.1589010
	speed: 0.2123s/iter; left time: 2447.0035s
	iters: 300, epoch: 6 | loss: 0.1935093
	speed: 0.2031s/iter; left time: 2320.9983s
	iters: 400, epoch: 6 | loss: 0.0189149
	speed: 0.1841s/iter; left time: 2084.7547s
Epoch: 6 cost time: 101.30301427841187
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.978844).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0120514
	speed: 0.7279s/iter; left time: 8121.4589s
	iters: 200, epoch: 7 | loss: 0.0018393
	speed: 0.2420s/iter; left time: 2675.3826s
	iters: 300, epoch: 7 | loss: 0.0635768
	speed: 0.2287s/iter; left time: 2505.8787s
	iters: 400, epoch: 7 | loss: 0.0144567
	speed: 0.2407s/iter; left time: 2612.8337s
Epoch: 7 cost time: 115.25814080238342
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0349683
	speed: 0.7138s/iter; left time: 7629.2649s
	iters: 200, epoch: 8 | loss: 0.0138632
	speed: 0.2656s/iter; left time: 2811.9802s
	iters: 300, epoch: 8 | loss: 0.0398224
	speed: 0.2480s/iter; left time: 2600.5983s
	iters: 400, epoch: 8 | loss: 0.0366071
	speed: 0.2362s/iter; left time: 2453.2987s
Epoch: 8 cost time: 117.11368179321289
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.978844 --> -0.982275).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2217309
	speed: 0.6431s/iter; left time: 6572.0475s
	iters: 200, epoch: 9 | loss: 0.0517107
	speed: 0.2304s/iter; left time: 2331.2255s
	iters: 300, epoch: 9 | loss: 0.0015063
	speed: 0.2248s/iter; left time: 2251.9958s
	iters: 400, epoch: 9 | loss: 0.0045360
	speed: 0.1961s/iter; left time: 1944.9006s
Epoch: 9 cost time: 103.13957452774048
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0056265
	speed: 0.5782s/iter; left time: 5637.3179s
	iters: 200, epoch: 10 | loss: 0.0004755
	speed: 0.2328s/iter; left time: 2246.4170s
	iters: 300, epoch: 10 | loss: 0.0010136
	speed: 0.2102s/iter; left time: 2007.4417s
	iters: 400, epoch: 10 | loss: 0.0010386
	speed: 0.2725s/iter; left time: 2574.8270s
Epoch: 10 cost time: 110.1069746017456
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0080025
	speed: 0.7412s/iter; left time: 6879.3573s
	iters: 200, epoch: 11 | loss: 0.0027118
	speed: 0.2979s/iter; left time: 2735.4700s
	iters: 300, epoch: 11 | loss: 0.0028543
	speed: 0.3028s/iter; left time: 2749.2903s
	iters: 400, epoch: 11 | loss: 0.0251371
	speed: 0.3262s/iter; left time: 2929.4579s
Epoch: 11 cost time: 142.5894763469696
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.982561).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0030126
	speed: 0.8208s/iter; left time: 7233.0429s
	iters: 200, epoch: 12 | loss: 0.1545718
	speed: 0.2740s/iter; left time: 2387.3998s
	iters: 300, epoch: 12 | loss: 0.0311148
	speed: 0.3088s/iter; left time: 2659.7709s
	iters: 400, epoch: 12 | loss: 0.0069865
	speed: 0.3188s/iter; left time: 2713.5947s
Epoch: 12 cost time: 141.53674745559692
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982561).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1871260
	speed: 0.8319s/iter; left time: 6940.9082s
	iters: 200, epoch: 13 | loss: 0.0004581
	speed: 0.2440s/iter; left time: 2011.0922s
	iters: 300, epoch: 13 | loss: 0.0022089
	speed: 0.2542s/iter; left time: 2069.7528s
	iters: 400, epoch: 13 | loss: 0.0034322
	speed: 0.2789s/iter; left time: 2243.1087s
Epoch: 13 cost time: 125.58096361160278
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0181666
	speed: 0.7538s/iter; left time: 5935.6967s
	iters: 200, epoch: 14 | loss: 0.0014020
	speed: 0.2345s/iter; left time: 1822.8225s
	iters: 300, epoch: 14 | loss: 0.0152287
	speed: 0.2659s/iter; left time: 2040.7453s
	iters: 400, epoch: 14 | loss: 0.0010112
	speed: 0.2398s/iter; left time: 1816.1633s
Epoch: 14 cost time: 119.29804801940918
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0946478
	speed: 0.7639s/iter; left time: 5656.6258s
	iters: 200, epoch: 15 | loss: 0.2399332
	speed: 0.2663s/iter; left time: 1945.5607s
	iters: 300, epoch: 15 | loss: 0.0023675
	speed: 0.2714s/iter; left time: 1955.6460s
	iters: 400, epoch: 15 | loss: 0.0979627
	speed: 0.2781s/iter; left time: 1975.5944s
Epoch: 15 cost time: 128.20472931861877
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0003849
	speed: 0.8366s/iter; left time: 5802.7554s
	iters: 200, epoch: 16 | loss: 0.0161921
	speed: 0.3193s/iter; left time: 2182.7078s
	iters: 300, epoch: 16 | loss: 0.0010121
	speed: 0.2967s/iter; left time: 1998.4746s
	iters: 400, epoch: 16 | loss: 0.0003939
	speed: 0.2764s/iter; left time: 1834.0371s
Epoch: 16 cost time: 140.81003308296204
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0017794
	speed: 0.7979s/iter; left time: 5160.0260s
	iters: 200, epoch: 17 | loss: 0.0223614
	speed: 0.2308s/iter; left time: 1469.4987s
	iters: 300, epoch: 17 | loss: 0.0014205
	speed: 0.2780s/iter; left time: 1742.1527s
	iters: 400, epoch: 17 | loss: 0.0009757
	speed: 0.2504s/iter; left time: 1544.1916s
Epoch: 17 cost time: 119.81859874725342
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0021942
	speed: 0.6711s/iter; left time: 4025.0806s
	iters: 200, epoch: 18 | loss: 0.0041423
	speed: 0.2211s/iter; left time: 1304.2432s
	iters: 300, epoch: 18 | loss: 0.0005906
	speed: 0.2008s/iter; left time: 1164.2119s
	iters: 400, epoch: 18 | loss: 0.0002838
	speed: 0.2419s/iter; left time: 1378.4006s
Epoch: 18 cost time: 101.86758732795715
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0004762
	speed: 0.4916s/iter; left time: 2717.9522s
	iters: 200, epoch: 19 | loss: 0.0049734
	speed: 0.2147s/iter; left time: 1165.3660s
	iters: 300, epoch: 19 | loss: 0.0012179
	speed: 0.1930s/iter; left time: 1028.2550s
	iters: 400, epoch: 19 | loss: 0.0001259
	speed: 0.1552s/iter; left time: 811.3786s
Epoch: 19 cost time: 86.36407423019409
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1195576
	speed: 0.6087s/iter; left time: 3080.0848s
	iters: 200, epoch: 20 | loss: 0.0001853
	speed: 0.2011s/iter; left time: 997.5194s
	iters: 300, epoch: 20 | loss: 0.0007313
	speed: 0.2401s/iter; left time: 1167.0879s
	iters: 400, epoch: 20 | loss: 0.0486861
	speed: 0.2500s/iter; left time: 1189.8187s
Epoch: 20 cost time: 106.44597101211548
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0005415
	speed: 0.6373s/iter; left time: 2925.9081s
	iters: 200, epoch: 21 | loss: 0.0001668
	speed: 0.2328s/iter; left time: 1045.2870s
	iters: 300, epoch: 21 | loss: 0.0004619
	speed: 0.2170s/iter; left time: 952.9935s
	iters: 400, epoch: 21 | loss: 0.0184762
	speed: 0.2224s/iter; left time: 954.2167s
Epoch: 21 cost time: 110.09739685058594
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.982561 --> -0.983704).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0222674
	speed: 0.6510s/iter; left time: 2683.4674s
	iters: 200, epoch: 22 | loss: 0.4563238
	speed: 0.2046s/iter; left time: 822.7017s
	iters: 300, epoch: 22 | loss: 0.0019437
	speed: 0.1961s/iter; left time: 768.9952s
	iters: 400, epoch: 22 | loss: 0.0006903
	speed: 0.1407s/iter; left time: 537.8155s
Epoch: 22 cost time: 84.58714413642883
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0126300
	speed: 0.5677s/iter; left time: 2073.7101s
	iters: 200, epoch: 23 | loss: 0.0002048
	speed: 0.2173s/iter; left time: 772.1226s
	iters: 300, epoch: 23 | loss: 0.0035403
	speed: 0.1807s/iter; left time: 624.0399s
	iters: 400, epoch: 23 | loss: 0.0003959
	speed: 0.2469s/iter; left time: 827.8090s
Epoch: 23 cost time: 100.89612030982971
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0036316
	speed: 0.6015s/iter; left time: 1915.0763s
	iters: 200, epoch: 24 | loss: 0.0134598
	speed: 0.2255s/iter; left time: 695.5508s
	iters: 300, epoch: 24 | loss: 0.0003883
	speed: 0.2181s/iter; left time: 650.7223s
	iters: 400, epoch: 24 | loss: 0.0002079
	speed: 0.2216s/iter; left time: 639.1354s
Epoch: 24 cost time: 108.05782914161682
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0027789
	speed: 0.7332s/iter; left time: 1990.7105s
	iters: 200, epoch: 25 | loss: 0.0103839
	speed: 0.2362s/iter; left time: 617.5747s
	iters: 300, epoch: 25 | loss: 0.0004275
	speed: 0.2806s/iter; left time: 705.6582s
	iters: 400, epoch: 25 | loss: 0.0050974
	speed: 0.2348s/iter; left time: 567.0474s
Epoch: 25 cost time: 116.1514401435852
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0003638
	speed: 0.7096s/iter; left time: 1593.8449s
	iters: 200, epoch: 26 | loss: 0.0003850
	speed: 0.2414s/iter; left time: 518.1429s
	iters: 300, epoch: 26 | loss: 0.0004553
	speed: 0.2161s/iter; left time: 442.1310s
	iters: 400, epoch: 26 | loss: 0.0012031
	speed: 0.2199s/iter; left time: 428.0117s
Epoch: 26 cost time: 101.09663033485413
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0021216
	speed: 0.6068s/iter; left time: 1078.3434s
	iters: 200, epoch: 27 | loss: 0.0012767
	speed: 0.2300s/iter; left time: 385.6755s
	iters: 300, epoch: 27 | loss: 0.0068742
	speed: 0.2205s/iter; left time: 347.7258s
	iters: 400, epoch: 27 | loss: 0.0016293
	speed: 0.1943s/iter; left time: 287.0143s
Epoch: 27 cost time: 109.6527669429779
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0006980
	speed: 0.6860s/iter; left time: 897.2589s
	iters: 200, epoch: 28 | loss: 0.0006514
	speed: 0.1598s/iter; left time: 193.0379s
	iters: 300, epoch: 28 | loss: 0.0006685
	speed: 0.1763s/iter; left time: 195.3686s
	iters: 400, epoch: 28 | loss: 0.0029415
	speed: 0.2007s/iter; left time: 202.2936s
Epoch: 28 cost time: 90.85750365257263
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0099476
	speed: 0.6250s/iter; left time: 524.3746s
	iters: 200, epoch: 29 | loss: 0.0081496
	speed: 0.2183s/iter; left time: 161.3123s
	iters: 300, epoch: 29 | loss: 0.0006431
	speed: 0.2339s/iter; left time: 149.4391s
	iters: 400, epoch: 29 | loss: 0.0003799
	speed: 0.2557s/iter; left time: 137.8145s
Epoch: 29 cost time: 111.36967039108276
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0001061
	speed: 0.6691s/iter; left time: 247.5489s
	iters: 200, epoch: 30 | loss: 0.0014550
	speed: 0.2349s/iter; left time: 63.4302s
	iters: 300, epoch: 30 | loss: 0.0001991
	speed: 0.2513s/iter; left time: 42.7172s
	iters: 400, epoch: 30 | loss: 0.0031667
	speed: 0.2517s/iter; left time: 17.6199s
Epoch: 30 cost time: 114.11337661743164
Epoch: 30, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 441354
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9557282
	speed: 0.1606s/iter; left time: 2243.6505s
	iters: 200, epoch: 1 | loss: 1.2217226
	speed: 0.1353s/iter; left time: 1877.0130s
	iters: 300, epoch: 1 | loss: 1.0980177
	speed: 0.1376s/iter; left time: 1894.8744s
	iters: 400, epoch: 1 | loss: 0.6681008
	speed: 0.1440s/iter; left time: 1968.4899s
Epoch: 1 cost time: 67.02539253234863
Epoch: 1, Steps: 469 | Train Loss: 1.250 Vali Loss: 0.419 Vali Acc: 0.885 Test Loss: 0.419 Test Acc: 0.885
Validation loss decreased (inf --> -0.885359).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2665006
	speed: 0.4216s/iter; left time: 5693.0002s
	iters: 200, epoch: 2 | loss: 0.1446884
	speed: 0.1261s/iter; left time: 1689.9221s
	iters: 300, epoch: 2 | loss: 0.1408140
	speed: 0.1205s/iter; left time: 1602.8773s
	iters: 400, epoch: 2 | loss: 0.1037147
	speed: 0.1559s/iter; left time: 2057.7090s
Epoch: 2 cost time: 62.05053186416626
Epoch: 2, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.885359 --> -0.963692).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0670528
	speed: 0.4729s/iter; left time: 6163.7492s
	iters: 200, epoch: 3 | loss: 0.0181157
	speed: 0.1306s/iter; left time: 1689.3599s
	iters: 300, epoch: 3 | loss: 0.0111379
	speed: 0.1222s/iter; left time: 1567.8781s
	iters: 400, epoch: 3 | loss: 0.0099937
	speed: 0.1213s/iter; left time: 1544.5221s
Epoch: 3 cost time: 59.566622257232666
Epoch: 3, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.963692 --> -0.969410).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0308581
	speed: 0.4914s/iter; left time: 6173.3681s
	iters: 200, epoch: 4 | loss: 0.0803337
	speed: 0.1356s/iter; left time: 1689.5955s
	iters: 300, epoch: 4 | loss: 0.0066867
	speed: 0.1482s/iter; left time: 1832.0543s
	iters: 400, epoch: 4 | loss: 0.0439965
	speed: 0.1498s/iter; left time: 1837.7241s
Epoch: 4 cost time: 68.61586427688599
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.969410 --> -0.976271).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0039776
	speed: 0.5159s/iter; left time: 6239.6377s
	iters: 200, epoch: 5 | loss: 0.1042531
	speed: 0.1748s/iter; left time: 2096.2111s
	iters: 300, epoch: 5 | loss: 0.0189110
	speed: 0.1560s/iter; left time: 1855.3559s
	iters: 400, epoch: 5 | loss: 0.0021223
	speed: 0.1696s/iter; left time: 2000.2627s
Epoch: 5 cost time: 76.87166666984558
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0231035
	speed: 0.5162s/iter; left time: 6001.1194s
	iters: 200, epoch: 6 | loss: 0.0124691
	speed: 0.1405s/iter; left time: 1619.4475s
	iters: 300, epoch: 6 | loss: 0.2635240
	speed: 0.1737s/iter; left time: 1984.2694s
	iters: 400, epoch: 6 | loss: 0.0027873
	speed: 0.1571s/iter; left time: 1779.5971s
Epoch: 6 cost time: 73.93496608734131
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0022004
	speed: 0.5428s/iter; left time: 6055.6895s
	iters: 200, epoch: 7 | loss: 0.0027767
	speed: 0.1464s/iter; left time: 1619.1083s
	iters: 300, epoch: 7 | loss: 0.0065397
	speed: 0.1429s/iter; left time: 1565.7621s
	iters: 400, epoch: 7 | loss: 0.0419430
	speed: 0.1553s/iter; left time: 1685.7718s
Epoch: 7 cost time: 69.34356594085693
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0191264
	speed: 0.4912s/iter; left time: 5249.8854s
	iters: 200, epoch: 8 | loss: 0.0037345
	speed: 0.1466s/iter; left time: 1551.9526s
	iters: 300, epoch: 8 | loss: 0.0294059
	speed: 0.1292s/iter; left time: 1354.5961s
	iters: 400, epoch: 8 | loss: 0.0111306
	speed: 0.1174s/iter; left time: 1219.3198s
Epoch: 8 cost time: 63.070152044296265
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.981131).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0059254
	speed: 0.4492s/iter; left time: 4590.5437s
	iters: 200, epoch: 9 | loss: 0.0013035
	speed: 0.1309s/iter; left time: 1324.0759s
	iters: 300, epoch: 9 | loss: 0.0016466
	speed: 0.1304s/iter; left time: 1306.6994s
	iters: 400, epoch: 9 | loss: 0.0013893
	speed: 0.1300s/iter; left time: 1289.7077s
Epoch: 9 cost time: 59.72022724151611
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0063746
	speed: 0.3905s/iter; left time: 3807.2801s
	iters: 200, epoch: 10 | loss: 0.2299838
	speed: 0.1194s/iter; left time: 1151.9782s
	iters: 300, epoch: 10 | loss: 0.0054199
	speed: 0.1248s/iter; left time: 1192.0500s
	iters: 400, epoch: 10 | loss: 0.0015271
	speed: 0.1344s/iter; left time: 1270.0762s
Epoch: 10 cost time: 57.80090022087097
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0026115
	speed: 0.4239s/iter; left time: 3934.4609s
	iters: 200, epoch: 11 | loss: 0.0049638
	speed: 0.1106s/iter; left time: 1014.9820s
	iters: 300, epoch: 11 | loss: 0.0084334
	speed: 0.1190s/iter; left time: 1081.0509s
	iters: 400, epoch: 11 | loss: 0.0497494
	speed: 0.1201s/iter; left time: 1078.5968s
Epoch: 11 cost time: 56.01922130584717
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0963685
	speed: 0.4605s/iter; left time: 4058.0599s
	iters: 200, epoch: 12 | loss: 0.0201113
	speed: 0.1170s/iter; left time: 1019.6406s
	iters: 300, epoch: 12 | loss: 0.0012095
	speed: 0.0837s/iter; left time: 720.5521s
	iters: 400, epoch: 12 | loss: 0.0029380
	speed: 0.0683s/iter; left time: 581.1571s
Epoch: 12 cost time: 46.28278660774231
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.981131 --> -0.983704).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0037749
	speed: 0.4708s/iter; left time: 3927.5842s
	iters: 200, epoch: 13 | loss: 0.3208261
	speed: 0.1604s/iter; left time: 1322.1947s
	iters: 300, epoch: 13 | loss: 0.6282006
	speed: 0.1557s/iter; left time: 1267.7971s
	iters: 400, epoch: 13 | loss: 0.0079948
	speed: 0.1935s/iter; left time: 1556.2098s
Epoch: 13 cost time: 81.73112368583679
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0277349
	speed: 0.6172s/iter; left time: 4859.9593s
	iters: 200, epoch: 14 | loss: 0.0011104
	speed: 0.2086s/iter; left time: 1621.8067s
	iters: 300, epoch: 14 | loss: 0.0005362
	speed: 0.1911s/iter; left time: 1466.1219s
	iters: 400, epoch: 14 | loss: 0.0024471
	speed: 0.1899s/iter; left time: 1438.4188s
Epoch: 14 cost time: 91.82604718208313
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0007384
	speed: 0.6390s/iter; left time: 4731.9946s
	iters: 200, epoch: 15 | loss: 0.0028928
	speed: 0.1879s/iter; left time: 1372.2610s
	iters: 300, epoch: 15 | loss: 0.0027219
	speed: 0.1970s/iter; left time: 1419.0795s
	iters: 400, epoch: 15 | loss: 0.0226335
	speed: 0.1910s/iter; left time: 1357.0706s
Epoch: 15 cost time: 88.43230295181274
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0070676
	speed: 0.6628s/iter; left time: 4597.2435s
	iters: 200, epoch: 16 | loss: 0.0010786
	speed: 0.1771s/iter; left time: 1210.4345s
	iters: 300, epoch: 16 | loss: 0.0010505
	speed: 0.1870s/iter; left time: 1259.5199s
	iters: 400, epoch: 16 | loss: 0.0068371
	speed: 0.1943s/iter; left time: 1289.0945s
Epoch: 16 cost time: 87.47899794578552
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0003120
	speed: 0.6510s/iter; left time: 4210.1889s
	iters: 200, epoch: 17 | loss: 0.0008186
	speed: 0.1942s/iter; left time: 1236.7366s
	iters: 300, epoch: 17 | loss: 0.5690517
	speed: 0.1805s/iter; left time: 1131.4962s
	iters: 400, epoch: 17 | loss: 0.0018730
	speed: 0.1882s/iter; left time: 1160.5337s
Epoch: 17 cost time: 90.73451924324036
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0013425
	speed: 0.6350s/iter; left time: 3808.7568s
	iters: 200, epoch: 18 | loss: 0.0007612
	speed: 0.2076s/iter; left time: 1224.3895s
	iters: 300, epoch: 18 | loss: 0.0012655
	speed: 0.1933s/iter; left time: 1120.6009s
	iters: 400, epoch: 18 | loss: 0.0030871
	speed: 0.1720s/iter; left time: 980.3274s
Epoch: 18 cost time: 89.58570051193237
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0005933
	speed: 0.5708s/iter; left time: 3155.9526s
	iters: 200, epoch: 19 | loss: 0.0789660
	speed: 0.1679s/iter; left time: 911.7693s
	iters: 300, epoch: 19 | loss: 0.0036389
	speed: 0.1892s/iter; left time: 1008.0451s
	iters: 400, epoch: 19 | loss: 0.0023110
	speed: 0.1770s/iter; left time: 925.5421s
Epoch: 19 cost time: 81.23331069946289
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0002204
	speed: 0.5892s/iter; left time: 2981.5578s
	iters: 200, epoch: 20 | loss: 0.0007276
	speed: 0.1529s/iter; left time: 758.5038s
	iters: 300, epoch: 20 | loss: 0.0352631
	speed: 0.1672s/iter; left time: 812.5806s
	iters: 400, epoch: 20 | loss: 0.0009478
	speed: 0.1782s/iter; left time: 848.0990s
Epoch: 20 cost time: 78.38449358940125
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000979
	speed: 0.6034s/iter; left time: 2770.1002s
	iters: 200, epoch: 21 | loss: 0.0099016
	speed: 0.1710s/iter; left time: 767.8517s
	iters: 300, epoch: 21 | loss: 0.0032110
	speed: 0.1556s/iter; left time: 683.0823s
	iters: 400, epoch: 21 | loss: 0.0002297
	speed: 0.1660s/iter; left time: 712.2703s
Epoch: 21 cost time: 80.66789078712463
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0696501
	speed: 0.5544s/iter; left time: 2285.1274s
	iters: 200, epoch: 22 | loss: 0.0015196
	speed: 0.1128s/iter; left time: 453.5371s
	iters: 300, epoch: 22 | loss: 0.0015088
	speed: 0.1638s/iter; left time: 642.2532s
	iters: 400, epoch: 22 | loss: 0.0015683
	speed: 0.1540s/iter; left time: 588.5037s
Epoch: 22 cost time: 68.52004075050354
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 130890
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7556413
	speed: 0.1929s/iter; left time: 2694.6239s
	iters: 200, epoch: 1 | loss: 1.2190773
	speed: 0.1696s/iter; left time: 2353.1235s
	iters: 300, epoch: 1 | loss: 1.0567329
	speed: 0.1512s/iter; left time: 2082.6974s
	iters: 400, epoch: 1 | loss: 0.6145843
	speed: 0.1738s/iter; left time: 2375.5729s
Epoch: 1 cost time: 82.13140225410461
Epoch: 1, Steps: 469 | Train Loss: 1.222 Vali Loss: 0.468 Vali Acc: 0.863 Test Loss: 0.468 Test Acc: 0.863
Validation loss decreased (inf --> -0.863060).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1996849
	speed: 0.5736s/iter; left time: 7744.6030s
	iters: 200, epoch: 2 | loss: 0.2453464
	speed: 0.1827s/iter; left time: 2449.0563s
	iters: 300, epoch: 2 | loss: 0.1376910
	speed: 0.1891s/iter; left time: 2515.2906s
	iters: 400, epoch: 2 | loss: 0.0813284
	speed: 0.1589s/iter; left time: 2098.1683s
Epoch: 2 cost time: 79.1077983379364
Epoch: 2, Steps: 469 | Train Loss: 0.230 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.863060 --> -0.953686).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1227103
	speed: 0.5293s/iter; left time: 6897.9502s
	iters: 200, epoch: 3 | loss: 0.0553001
	speed: 0.1430s/iter; left time: 1849.5420s
	iters: 300, epoch: 3 | loss: 0.0560874
	speed: 0.1365s/iter; left time: 1751.9694s
	iters: 400, epoch: 3 | loss: 0.0284382
	speed: 0.1482s/iter; left time: 1887.4141s
Epoch: 3 cost time: 70.63267493247986
Epoch: 3, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.953686 --> -0.971411).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0294665
	speed: 0.5130s/iter; left time: 6445.2491s
	iters: 200, epoch: 4 | loss: 0.0281578
	speed: 0.1416s/iter; left time: 1764.3540s
	iters: 300, epoch: 4 | loss: 0.0359101
	speed: 0.1641s/iter; left time: 2028.4287s
	iters: 400, epoch: 4 | loss: 0.0120445
	speed: 0.1557s/iter; left time: 1909.2265s
Epoch: 4 cost time: 70.14312100410461
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972555).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0274303
	speed: 0.5073s/iter; left time: 6136.0400s
	iters: 200, epoch: 5 | loss: 0.0055989
	speed: 0.1646s/iter; left time: 1974.3353s
	iters: 300, epoch: 5 | loss: 0.0067194
	speed: 0.1408s/iter; left time: 1674.8406s
	iters: 400, epoch: 5 | loss: 0.0410107
	speed: 0.1477s/iter; left time: 1741.8854s
Epoch: 5 cost time: 70.78990411758423
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0243581
	speed: 0.5220s/iter; left time: 6068.5301s
	iters: 200, epoch: 6 | loss: 0.0224105
	speed: 0.1347s/iter; left time: 1553.0298s
	iters: 300, epoch: 6 | loss: 0.2179386
	speed: 0.1513s/iter; left time: 1729.2784s
	iters: 400, epoch: 6 | loss: 0.0063356
	speed: 0.1543s/iter; left time: 1747.6419s
Epoch: 6 cost time: 69.22121596336365
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.972555 --> -0.979130).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0174705
	speed: 0.4499s/iter; left time: 5019.9048s
	iters: 200, epoch: 7 | loss: 0.0043801
	speed: 0.1458s/iter; left time: 1611.7995s
	iters: 300, epoch: 7 | loss: 0.0381791
	speed: 0.1344s/iter; left time: 1472.9719s
	iters: 400, epoch: 7 | loss: 0.0132434
	speed: 0.1250s/iter; left time: 1356.9410s
Epoch: 7 cost time: 61.437803983688354
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0057589
	speed: 0.4672s/iter; left time: 4993.6798s
	iters: 200, epoch: 8 | loss: 0.0048959
	speed: 0.1232s/iter; left time: 1304.1162s
	iters: 300, epoch: 8 | loss: 0.0102417
	speed: 0.1197s/iter; left time: 1255.3838s
	iters: 400, epoch: 8 | loss: 0.0437899
	speed: 0.1226s/iter; left time: 1273.4749s
Epoch: 8 cost time: 60.5551176071167
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0835551
	speed: 0.4503s/iter; left time: 4601.7297s
	iters: 200, epoch: 9 | loss: 0.0245021
	speed: 0.1161s/iter; left time: 1174.5341s
	iters: 300, epoch: 9 | loss: 0.0046870
	speed: 0.1349s/iter; left time: 1351.7135s
	iters: 400, epoch: 9 | loss: 0.0053755
	speed: 0.1349s/iter; left time: 1338.4975s
Epoch: 9 cost time: 59.2322142124176
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980846).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0044671
	speed: 0.4419s/iter; left time: 4308.6712s
	iters: 200, epoch: 10 | loss: 0.0012360
	speed: 0.1496s/iter; left time: 1443.2819s
	iters: 300, epoch: 10 | loss: 0.0123561
	speed: 0.1348s/iter; left time: 1287.4995s
	iters: 400, epoch: 10 | loss: 0.0016739
	speed: 0.1206s/iter; left time: 1139.9163s
Epoch: 10 cost time: 61.7639274597168
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0074157
	speed: 0.3703s/iter; left time: 3436.3340s
	iters: 200, epoch: 11 | loss: 0.0063237
	speed: 0.0562s/iter; left time: 515.9577s
	iters: 300, epoch: 11 | loss: 0.0050812
	speed: 0.1369s/iter; left time: 1243.1800s
	iters: 400, epoch: 11 | loss: 0.0347103
	speed: 0.1729s/iter; left time: 1552.7796s
Epoch: 11 cost time: 55.50776505470276
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0128075
	speed: 0.5714s/iter; left time: 5034.8337s
	iters: 200, epoch: 12 | loss: 0.1180658
	speed: 0.1663s/iter; left time: 1448.9713s
	iters: 300, epoch: 12 | loss: 0.0057182
	speed: 0.1897s/iter; left time: 1633.7137s
	iters: 400, epoch: 12 | loss: 0.0303600
	speed: 0.1850s/iter; left time: 1574.6509s
Epoch: 12 cost time: 81.13830208778381
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2006397
	speed: 0.5635s/iter; left time: 4701.0447s
	iters: 200, epoch: 13 | loss: 0.0009836
	speed: 0.1740s/iter; left time: 1434.1495s
	iters: 300, epoch: 13 | loss: 0.0010870
	speed: 0.1957s/iter; left time: 1593.2847s
	iters: 400, epoch: 13 | loss: 0.0014537
	speed: 0.1632s/iter; left time: 1312.3931s
Epoch: 13 cost time: 80.84634590148926
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0508627
	speed: 0.5834s/iter; left time: 4593.4229s
	iters: 200, epoch: 14 | loss: 0.0037889
	speed: 0.1781s/iter; left time: 1384.3654s
	iters: 300, epoch: 14 | loss: 0.0046622
	speed: 0.1821s/iter; left time: 1397.6834s
	iters: 400, epoch: 14 | loss: 0.0130749
	speed: 0.1590s/iter; left time: 1204.3644s
Epoch: 14 cost time: 80.6602463722229
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0015469
	speed: 0.5983s/iter; left time: 4430.5567s
	iters: 200, epoch: 15 | loss: 0.0067831
	speed: 0.1718s/iter; left time: 1254.7324s
	iters: 300, epoch: 15 | loss: 0.0011724
	speed: 0.1763s/iter; left time: 1270.0646s
	iters: 400, epoch: 15 | loss: 0.0201958
	speed: 0.1562s/iter; left time: 1109.7944s
Epoch: 15 cost time: 79.87770771980286
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.980846 --> -0.981417).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0010061
	speed: 0.6056s/iter; left time: 4200.3539s
	iters: 200, epoch: 16 | loss: 0.0062882
	speed: 0.1669s/iter; left time: 1141.0561s
	iters: 300, epoch: 16 | loss: 0.0092860
	speed: 0.1721s/iter; left time: 1159.1735s
	iters: 400, epoch: 16 | loss: 0.0015343
	speed: 0.1643s/iter; left time: 1090.3721s
Epoch: 16 cost time: 79.67357778549194
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.983133).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0018155
	speed: 0.5934s/iter; left time: 3837.7881s
	iters: 200, epoch: 17 | loss: 0.0303521
	speed: 0.1604s/iter; left time: 1021.3917s
	iters: 300, epoch: 17 | loss: 0.0006966
	speed: 0.1620s/iter; left time: 1015.4257s
	iters: 400, epoch: 17 | loss: 0.0021058
	speed: 0.1571s/iter; left time: 968.8970s
Epoch: 17 cost time: 74.82556700706482
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0003830
	speed: 0.5143s/iter; left time: 3084.9440s
	iters: 200, epoch: 18 | loss: 0.0034816
	speed: 0.1591s/iter; left time: 938.4156s
	iters: 300, epoch: 18 | loss: 0.0004962
	speed: 0.1692s/iter; left time: 981.2672s
	iters: 400, epoch: 18 | loss: 0.0005691
	speed: 0.1543s/iter; left time: 879.0727s
Epoch: 18 cost time: 71.44824171066284
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0007451
	speed: 0.5075s/iter; left time: 2805.9113s
	iters: 200, epoch: 19 | loss: 0.1159040
	speed: 0.1747s/iter; left time: 948.3300s
	iters: 300, epoch: 19 | loss: 0.0007047
	speed: 0.1587s/iter; left time: 845.8352s
	iters: 400, epoch: 19 | loss: 0.0005006
	speed: 0.1347s/iter; left time: 704.1880s
Epoch: 19 cost time: 71.09935784339905
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0945672
	speed: 0.5248s/iter; left time: 2655.5486s
	iters: 200, epoch: 20 | loss: 0.0030995
	speed: 0.1678s/iter; left time: 832.4898s
	iters: 300, epoch: 20 | loss: 0.0014759
	speed: 0.1421s/iter; left time: 690.5547s
	iters: 400, epoch: 20 | loss: 0.0015945
	speed: 0.1320s/iter; left time: 628.3399s
Epoch: 20 cost time: 69.64901971817017
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0015266
	speed: 0.4761s/iter; left time: 2185.9534s
	iters: 200, epoch: 21 | loss: 0.0167598
	speed: 0.1201s/iter; left time: 539.1493s
	iters: 300, epoch: 21 | loss: 0.0087591
	speed: 0.1293s/iter; left time: 567.8206s
	iters: 400, epoch: 21 | loss: 0.0132636
	speed: 0.1290s/iter; left time: 553.6285s
Epoch: 21 cost time: 61.19311881065369
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0007395
	speed: 0.4503s/iter; left time: 1856.3082s
	iters: 200, epoch: 22 | loss: 0.1397589
	speed: 0.1389s/iter; left time: 558.7646s
	iters: 300, epoch: 22 | loss: 0.0025314
	speed: 0.1506s/iter; left time: 590.8024s
	iters: 400, epoch: 22 | loss: 0.0008814
	speed: 0.1681s/iter; left time: 642.4848s
Epoch: 22 cost time: 67.59437441825867
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0060070
	speed: 0.4989s/iter; left time: 1822.5709s
	iters: 200, epoch: 23 | loss: 0.0007887
	speed: 0.1682s/iter; left time: 597.4498s
	iters: 300, epoch: 23 | loss: 0.0031716
	speed: 0.1575s/iter; left time: 543.7620s
	iters: 400, epoch: 23 | loss: 0.0105733
	speed: 0.1481s/iter; left time: 496.6544s
Epoch: 23 cost time: 71.56390428543091
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0006949
	speed: 0.5190s/iter; left time: 1652.5779s
	iters: 200, epoch: 24 | loss: 0.0053939
	speed: 0.1586s/iter; left time: 489.1267s
	iters: 300, epoch: 24 | loss: 0.0003721
	speed: 0.1480s/iter; left time: 441.7319s
	iters: 400, epoch: 24 | loss: 0.0006647
	speed: 0.1355s/iter; left time: 390.7895s
Epoch: 24 cost time: 70.7345564365387
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0004649
	speed: 0.5376s/iter; left time: 1459.5338s
	iters: 200, epoch: 25 | loss: 0.0091490
	speed: 0.1394s/iter; left time: 364.5202s
	iters: 300, epoch: 25 | loss: 0.0019377
	speed: 0.1414s/iter; left time: 355.5123s
	iters: 400, epoch: 25 | loss: 0.0009954
	speed: 0.1524s/iter; left time: 368.0211s
Epoch: 25 cost time: 70.66740584373474
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0025407
	speed: 0.5155s/iter; left time: 1157.7868s
	iters: 200, epoch: 26 | loss: 0.0057616
	speed: 0.1488s/iter; left time: 319.3484s
	iters: 300, epoch: 26 | loss: 0.0008427
	speed: 0.1491s/iter; left time: 305.0468s
	iters: 400, epoch: 26 | loss: 0.0000935
	speed: 0.1672s/iter; left time: 325.3729s
Epoch: 26 cost time: 71.49424910545349
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 441354
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0060906
	speed: 0.1297s/iter; left time: 1812.5351s
	iters: 200, epoch: 1 | loss: 1.4331639
	speed: 0.1107s/iter; left time: 1535.6321s
	iters: 300, epoch: 1 | loss: 1.2084506
	speed: 0.1025s/iter; left time: 1411.6957s
	iters: 400, epoch: 1 | loss: 0.8428901
	speed: 0.0998s/iter; left time: 1364.3471s
Epoch: 1 cost time: 51.63069796562195
Epoch: 1, Steps: 469 | Train Loss: 1.363 Vali Loss: 0.574 Vali Acc: 0.858 Test Loss: 0.574 Test Acc: 0.858
Validation loss decreased (inf --> -0.857913).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3495004
	speed: 0.3981s/iter; left time: 5374.7770s
	iters: 200, epoch: 2 | loss: 0.3108668
	speed: 0.0928s/iter; left time: 1243.9754s
	iters: 300, epoch: 2 | loss: 0.2109880
	speed: 0.1081s/iter; left time: 1437.4849s
	iters: 400, epoch: 2 | loss: 0.1518785
	speed: 0.0899s/iter; left time: 1187.1443s
Epoch: 2 cost time: 44.43312621116638
Epoch: 2, Steps: 469 | Train Loss: 0.292 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (-0.857913 --> -0.946253).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1237937
	speed: 0.3987s/iter; left time: 5196.5880s
	iters: 200, epoch: 3 | loss: 0.0367888
	speed: 0.0999s/iter; left time: 1291.8271s
	iters: 300, epoch: 3 | loss: 0.0165910
	speed: 0.1127s/iter; left time: 1446.1295s
	iters: 400, epoch: 3 | loss: 0.0129705
	speed: 0.0885s/iter; left time: 1127.3356s
Epoch: 3 cost time: 46.422279596328735
Epoch: 3, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.946253 --> -0.970268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0304829
	speed: 0.4016s/iter; left time: 5045.7945s
	iters: 200, epoch: 4 | loss: 0.1262392
	speed: 0.0992s/iter; left time: 1236.1940s
	iters: 300, epoch: 4 | loss: 0.0197518
	speed: 0.1096s/iter; left time: 1355.6752s
	iters: 400, epoch: 4 | loss: 0.0418152
	speed: 0.0937s/iter; left time: 1148.7776s
Epoch: 4 cost time: 46.359437227249146
Epoch: 4, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972555).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0108096
	speed: 0.3909s/iter; left time: 4727.3810s
	iters: 200, epoch: 5 | loss: 0.0168522
	speed: 0.0987s/iter; left time: 1184.4352s
	iters: 300, epoch: 5 | loss: 0.0101675
	speed: 0.1070s/iter; left time: 1273.1558s
	iters: 400, epoch: 5 | loss: 0.0031427
	speed: 0.0977s/iter; left time: 1152.7155s
Epoch: 5 cost time: 46.63984656333923
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0196454
	speed: 0.3940s/iter; left time: 4581.0246s
	iters: 200, epoch: 6 | loss: 0.0673485
	speed: 0.0985s/iter; left time: 1134.9168s
	iters: 300, epoch: 6 | loss: 0.4023965
	speed: 0.1063s/iter; left time: 1214.2111s
	iters: 400, epoch: 6 | loss: 0.0034985
	speed: 0.1025s/iter; left time: 1160.8115s
Epoch: 6 cost time: 46.9958930015564
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0035607
	speed: 0.3953s/iter; left time: 4410.8493s
	iters: 200, epoch: 7 | loss: 0.0039111
	speed: 0.0993s/iter; left time: 1097.7529s
	iters: 300, epoch: 7 | loss: 0.0061591
	speed: 0.1025s/iter; left time: 1122.8573s
	iters: 400, epoch: 7 | loss: 0.0629010
	speed: 0.1052s/iter; left time: 1142.4593s
Epoch: 7 cost time: 47.3141815662384
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.972555 --> -0.977987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0441436
	speed: 0.4079s/iter; left time: 4360.1504s
	iters: 200, epoch: 8 | loss: 0.0839452
	speed: 0.1084s/iter; left time: 1148.2350s
	iters: 300, epoch: 8 | loss: 0.0180316
	speed: 0.1151s/iter; left time: 1207.4302s
	iters: 400, epoch: 8 | loss: 0.0337884
	speed: 0.1174s/iter; left time: 1219.8667s
Epoch: 8 cost time: 52.67616939544678
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0079076
	speed: 0.4370s/iter; left time: 4465.2899s
	iters: 200, epoch: 9 | loss: 0.0027764
	speed: 0.1098s/iter; left time: 1111.2757s
	iters: 300, epoch: 9 | loss: 0.0012364
	speed: 0.1140s/iter; left time: 1142.3828s
	iters: 400, epoch: 9 | loss: 0.0030072
	speed: 0.1174s/iter; left time: 1164.8808s
Epoch: 9 cost time: 52.706589221954346
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0132812
	speed: 0.4371s/iter; left time: 4261.2500s
	iters: 200, epoch: 10 | loss: 0.0562470
	speed: 0.1091s/iter; left time: 1052.4524s
	iters: 300, epoch: 10 | loss: 0.0243296
	speed: 0.1099s/iter; left time: 1049.9492s
	iters: 400, epoch: 10 | loss: 0.0119721
	speed: 0.0997s/iter; left time: 941.8850s
Epoch: 10 cost time: 49.331993103027344
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0296235
	speed: 0.3985s/iter; left time: 3698.3087s
	iters: 200, epoch: 11 | loss: 0.0012053
	speed: 0.1099s/iter; left time: 1009.2602s
	iters: 300, epoch: 11 | loss: 0.0077202
	speed: 0.1016s/iter; left time: 922.6866s
	iters: 400, epoch: 11 | loss: 0.0686695
	speed: 0.1036s/iter; left time: 930.7901s
Epoch: 11 cost time: 48.930755376815796
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1790007
	speed: 0.3802s/iter; left time: 3349.8921s
	iters: 200, epoch: 12 | loss: 0.0861444
	speed: 0.0943s/iter; left time: 821.8282s
	iters: 300, epoch: 12 | loss: 0.0019915
	speed: 0.0800s/iter; left time: 688.7583s
	iters: 400, epoch: 12 | loss: 0.0069794
	speed: 0.0640s/iter; left time: 544.9508s
Epoch: 12 cost time: 35.951077699661255
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0048749
	speed: 0.3624s/iter; left time: 3023.5434s
	iters: 200, epoch: 13 | loss: 0.1727159
	speed: 0.0827s/iter; left time: 681.3948s
	iters: 300, epoch: 13 | loss: 0.2147243
	speed: 0.0930s/iter; left time: 756.9610s
	iters: 400, epoch: 13 | loss: 0.1108747
	speed: 0.0942s/iter; left time: 757.2630s
Epoch: 13 cost time: 41.90519142150879
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.977987 --> -0.981417).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0031031
	speed: 0.3825s/iter; left time: 3012.1151s
	iters: 200, epoch: 14 | loss: 0.0026538
	speed: 0.0980s/iter; left time: 761.9447s
	iters: 300, epoch: 14 | loss: 0.0011133
	speed: 0.0833s/iter; left time: 639.5956s
	iters: 400, epoch: 14 | loss: 0.0051532
	speed: 0.0866s/iter; left time: 656.1462s
Epoch: 14 cost time: 43.028247117996216
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0010827
	speed: 0.3790s/iter; left time: 2806.3449s
	iters: 200, epoch: 15 | loss: 0.0131301
	speed: 0.0797s/iter; left time: 581.8905s
	iters: 300, epoch: 15 | loss: 0.0018998
	speed: 0.0704s/iter; left time: 507.3144s
	iters: 400, epoch: 15 | loss: 0.0021725
	speed: 0.0869s/iter; left time: 617.6922s
Epoch: 15 cost time: 38.076223373413086
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0090666
	speed: 0.3145s/iter; left time: 2181.3538s
	iters: 200, epoch: 16 | loss: 0.0002406
	speed: 0.1061s/iter; left time: 725.1130s
	iters: 300, epoch: 16 | loss: 0.0225065
	speed: 0.0974s/iter; left time: 655.8482s
	iters: 400, epoch: 16 | loss: 0.0076748
	speed: 0.0807s/iter; left time: 535.5954s
Epoch: 16 cost time: 41.562225341796875
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
Validation loss decreased (-0.981417 --> -0.985706).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0019084
	speed: 0.3886s/iter; left time: 2512.9722s
	iters: 200, epoch: 17 | loss: 0.0007259
	speed: 0.0753s/iter; left time: 479.1671s
	iters: 300, epoch: 17 | loss: 0.5780035
	speed: 0.0765s/iter; left time: 479.1230s
	iters: 400, epoch: 17 | loss: 0.0023099
	speed: 0.0989s/iter; left time: 610.0328s
Epoch: 17 cost time: 41.57524275779724
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0098841
	speed: 0.3849s/iter; left time: 2308.9281s
	iters: 200, epoch: 18 | loss: 0.0020058
	speed: 0.1034s/iter; left time: 609.7323s
	iters: 300, epoch: 18 | loss: 0.0003662
	speed: 0.0956s/iter; left time: 554.2333s
	iters: 400, epoch: 18 | loss: 0.0045118
	speed: 0.0806s/iter; left time: 459.4945s
Epoch: 18 cost time: 42.350048303604126
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000256
	speed: 0.3870s/iter; left time: 2139.5413s
	iters: 200, epoch: 19 | loss: 0.0561791
	speed: 0.0767s/iter; left time: 416.4120s
	iters: 300, epoch: 19 | loss: 0.0169696
	speed: 0.0826s/iter; left time: 440.0135s
	iters: 400, epoch: 19 | loss: 0.0004415
	speed: 0.0918s/iter; left time: 479.9806s
Epoch: 19 cost time: 41.81013584136963
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0007059
	speed: 0.3830s/iter; left time: 1937.8921s
	iters: 200, epoch: 20 | loss: 0.0111236
	speed: 0.0985s/iter; left time: 488.7293s
	iters: 300, epoch: 20 | loss: 0.0339030
	speed: 0.0940s/iter; left time: 456.8278s
	iters: 400, epoch: 20 | loss: 0.0029972
	speed: 0.0824s/iter; left time: 392.4268s
Epoch: 20 cost time: 41.73338222503662
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0006001
	speed: 0.3830s/iter; left time: 1758.3591s
	iters: 200, epoch: 21 | loss: 0.0032539
	speed: 0.0771s/iter; left time: 346.3949s
	iters: 300, epoch: 21 | loss: 0.0021172
	speed: 0.0849s/iter; left time: 372.6591s
	iters: 400, epoch: 21 | loss: 0.0005860
	speed: 0.0879s/iter; left time: 377.1760s
Epoch: 21 cost time: 42.24433088302612
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.985706 --> -0.986563).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001622
	speed: 0.4273s/iter; left time: 1761.1505s
	iters: 200, epoch: 22 | loss: 0.0102083
	speed: 0.1090s/iter; left time: 438.2731s
	iters: 300, epoch: 22 | loss: 0.0042994
	speed: 0.1043s/iter; left time: 409.1346s
	iters: 400, epoch: 22 | loss: 0.0007736
	speed: 0.0957s/iter; left time: 365.5752s
Epoch: 22 cost time: 48.442869901657104
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0001477
	speed: 0.4313s/iter; left time: 1575.3685s
	iters: 200, epoch: 23 | loss: 0.0083044
	speed: 0.0968s/iter; left time: 343.7772s
	iters: 300, epoch: 23 | loss: 0.0006361
	speed: 0.1009s/iter; left time: 348.3463s
	iters: 400, epoch: 23 | loss: 0.0091378
	speed: 0.1034s/iter; left time: 346.6453s
Epoch: 23 cost time: 47.89048409461975
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0015131
	speed: 0.4234s/iter; left time: 1348.1225s
	iters: 200, epoch: 24 | loss: 0.0001434
	speed: 0.1053s/iter; left time: 324.8761s
	iters: 300, epoch: 24 | loss: 0.0003677
	speed: 0.1033s/iter; left time: 308.2370s
	iters: 400, epoch: 24 | loss: 0.0007633
	speed: 0.0975s/iter; left time: 281.3274s
Epoch: 24 cost time: 47.92957544326782
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0003891
	speed: 0.4199s/iter; left time: 1140.1362s
	iters: 200, epoch: 25 | loss: 0.0419111
	speed: 0.1001s/iter; left time: 261.7819s
	iters: 300, epoch: 25 | loss: 0.0002664
	speed: 0.0976s/iter; left time: 245.3743s
	iters: 400, epoch: 25 | loss: 0.0008628
	speed: 0.0947s/iter; left time: 228.7929s
Epoch: 25 cost time: 44.403738021850586
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000545
	speed: 0.4326s/iter; left time: 971.5260s
	iters: 200, epoch: 26 | loss: 0.0040750
	speed: 0.1217s/iter; left time: 261.2062s
	iters: 300, epoch: 26 | loss: 0.0024565
	speed: 0.1239s/iter; left time: 253.5841s
	iters: 400, epoch: 26 | loss: 0.0001902
	speed: 0.1327s/iter; left time: 258.1767s
Epoch: 26 cost time: 58.933199882507324
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0278641
	speed: 0.4705s/iter; left time: 836.1526s
	iters: 200, epoch: 27 | loss: 0.0154487
	speed: 0.0852s/iter; left time: 142.8936s
	iters: 300, epoch: 27 | loss: 0.0007834
	speed: 0.1141s/iter; left time: 179.9697s
	iters: 400, epoch: 27 | loss: 0.0003063
	speed: 0.1162s/iter; left time: 171.5564s
Epoch: 27 cost time: 50.99279308319092
Epoch: 27, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0200642
	speed: 0.4652s/iter; left time: 608.4945s
	iters: 200, epoch: 28 | loss: 0.0003291
	speed: 0.0996s/iter; left time: 120.2976s
	iters: 300, epoch: 28 | loss: 0.0015103
	speed: 0.1045s/iter; left time: 115.7820s
	iters: 400, epoch: 28 | loss: 0.0003662
	speed: 0.1010s/iter; left time: 101.7802s
Epoch: 28 cost time: 47.80426549911499
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0009911
	speed: 0.4337s/iter; left time: 363.9092s
	iters: 200, epoch: 29 | loss: 0.0006264
	speed: 0.1062s/iter; left time: 78.5042s
	iters: 300, epoch: 29 | loss: 0.0007433
	speed: 0.1068s/iter; left time: 68.2696s
	iters: 400, epoch: 29 | loss: 0.0012290
	speed: 0.0951s/iter; left time: 51.2415s
Epoch: 29 cost time: 47.244874000549316
Epoch: 29, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0009878
	speed: 0.3774s/iter; left time: 139.6293s
	iters: 200, epoch: 30 | loss: 0.0066433
	speed: 0.0972s/iter; left time: 26.2547s
	iters: 300, epoch: 30 | loss: 0.0011022
	speed: 0.1055s/iter; left time: 17.9416s
	iters: 400, epoch: 30 | loss: 0.0003037
	speed: 0.1000s/iter; left time: 7.0026s
Epoch: 30 cost time: 46.21176099777222
Epoch: 30, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 130890
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1558750
	speed: 0.1475s/iter; left time: 2060.4901s
	iters: 200, epoch: 1 | loss: 1.4562349
	speed: 0.1422s/iter; left time: 1971.9109s
	iters: 300, epoch: 1 | loss: 0.7314315
	speed: 0.1503s/iter; left time: 2069.5431s
	iters: 400, epoch: 1 | loss: 0.4396334
	speed: 0.1490s/iter; left time: 2036.7153s
Epoch: 1 cost time: 70.11548972129822
Epoch: 1, Steps: 469 | Train Loss: 1.328 Vali Loss: 0.413 Vali Acc: 0.893 Test Loss: 0.413 Test Acc: 0.893
Validation loss decreased (inf --> -0.892506).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1998869
	speed: 0.5344s/iter; left time: 7215.0300s
	iters: 200, epoch: 2 | loss: 0.1619278
	speed: 0.1333s/iter; left time: 1786.3431s
	iters: 300, epoch: 2 | loss: 0.3761449
	speed: 0.1432s/iter; left time: 1905.5083s
	iters: 400, epoch: 2 | loss: 0.0612907
	speed: 0.1480s/iter; left time: 1954.2296s
Epoch: 2 cost time: 68.04209733009338
Epoch: 2, Steps: 469 | Train Loss: 0.234 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.892506 --> -0.955116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1603165
	speed: 0.5534s/iter; left time: 7212.8312s
	iters: 200, epoch: 3 | loss: 0.0627505
	speed: 0.1343s/iter; left time: 1736.6093s
	iters: 300, epoch: 3 | loss: 0.3581197
	speed: 0.1372s/iter; left time: 1761.1690s
	iters: 400, epoch: 3 | loss: 0.0190190
	speed: 0.1405s/iter; left time: 1789.6115s
Epoch: 3 cost time: 66.43862104415894
Epoch: 3, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.955116 --> -0.964836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0909530
	speed: 0.5574s/iter; left time: 7003.5394s
	iters: 200, epoch: 4 | loss: 0.0544902
	speed: 0.1481s/iter; left time: 1846.2171s
	iters: 300, epoch: 4 | loss: 0.0115315
	speed: 0.1686s/iter; left time: 2084.0705s
	iters: 400, epoch: 4 | loss: 0.1604164
	speed: 0.1553s/iter; left time: 1905.0612s
Epoch: 4 cost time: 74.71559643745422
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.176 Vali Acc: 0.945 Test Loss: 0.176 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0421026
	speed: 0.5927s/iter; left time: 7168.5806s
	iters: 200, epoch: 5 | loss: 0.0100221
	speed: 0.1800s/iter; left time: 2158.7629s
	iters: 300, epoch: 5 | loss: 0.0358440
	speed: 0.1706s/iter; left time: 2028.9475s
	iters: 400, epoch: 5 | loss: 0.1772097
	speed: 0.1595s/iter; left time: 1881.5866s
Epoch: 5 cost time: 79.48383283615112
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.964836 --> -0.968266).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0088710
	speed: 0.5883s/iter; left time: 6839.4276s
	iters: 200, epoch: 6 | loss: 0.0099811
	speed: 0.1722s/iter; left time: 1984.4446s
	iters: 300, epoch: 6 | loss: 0.0367112
	speed: 0.1771s/iter; left time: 2023.2546s
	iters: 400, epoch: 6 | loss: 0.0263043
	speed: 0.1825s/iter; left time: 2066.5148s
Epoch: 6 cost time: 82.55609321594238
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.968266 --> -0.970554).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0287039
	speed: 0.5790s/iter; left time: 6459.9839s
	iters: 200, epoch: 7 | loss: 0.0101576
	speed: 0.1670s/iter; left time: 1846.8311s
	iters: 300, epoch: 7 | loss: 0.0880202
	speed: 0.1814s/iter; left time: 1987.4538s
	iters: 400, epoch: 7 | loss: 0.0201433
	speed: 0.1695s/iter; left time: 1840.7422s
Epoch: 7 cost time: 79.93950915336609
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.970554 --> -0.973698).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2893279
	speed: 0.5969s/iter; left time: 6379.3121s
	iters: 200, epoch: 8 | loss: 0.0057385
	speed: 0.1634s/iter; left time: 1729.6458s
	iters: 300, epoch: 8 | loss: 0.0173707
	speed: 0.1568s/iter; left time: 1644.5702s
	iters: 400, epoch: 8 | loss: 0.0067301
	speed: 0.1812s/iter; left time: 1882.7775s
Epoch: 8 cost time: 78.8052864074707
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1234319
	speed: 0.6155s/iter; left time: 6290.2605s
	iters: 200, epoch: 9 | loss: 0.0180973
	speed: 0.1564s/iter; left time: 1582.6586s
	iters: 300, epoch: 9 | loss: 0.0051948
	speed: 0.1535s/iter; left time: 1538.3689s
	iters: 400, epoch: 9 | loss: 0.4117890
	speed: 0.1431s/iter; left time: 1419.8632s
Epoch: 9 cost time: 73.69082045555115
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0159982
	speed: 0.5523s/iter; left time: 5384.9045s
	iters: 200, epoch: 10 | loss: 0.1010703
	speed: 0.1477s/iter; left time: 1425.6169s
	iters: 300, epoch: 10 | loss: 0.0264101
	speed: 0.1397s/iter; left time: 1334.3916s
	iters: 400, epoch: 10 | loss: 0.0065179
	speed: 0.1318s/iter; left time: 1245.1168s
Epoch: 10 cost time: 66.5113205909729
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.973698 --> -0.981131).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0077994
	speed: 0.5222s/iter; left time: 4846.4525s
	iters: 200, epoch: 11 | loss: 0.0039525
	speed: 0.1523s/iter; left time: 1398.1184s
	iters: 300, epoch: 11 | loss: 0.0032423
	speed: 0.1472s/iter; left time: 1337.1502s
	iters: 400, epoch: 11 | loss: 0.0027675
	speed: 0.1363s/iter; left time: 1224.3873s
Epoch: 11 cost time: 68.71529197692871
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0009124
	speed: 0.5108s/iter; left time: 4500.7593s
	iters: 200, epoch: 12 | loss: 0.3034776
	speed: 0.1505s/iter; left time: 1310.8517s
	iters: 300, epoch: 12 | loss: 0.0027075
	speed: 0.1560s/iter; left time: 1343.2928s
	iters: 400, epoch: 12 | loss: 0.0463313
	speed: 0.1464s/iter; left time: 1245.7597s
Epoch: 12 cost time: 70.83584094047546
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0041830
	speed: 0.4970s/iter; left time: 4146.2348s
	iters: 200, epoch: 13 | loss: 0.0022054
	speed: 0.1493s/iter; left time: 1230.5056s
	iters: 300, epoch: 13 | loss: 0.0025248
	speed: 0.1529s/iter; left time: 1245.0797s
	iters: 400, epoch: 13 | loss: 0.0027260
	speed: 0.1510s/iter; left time: 1214.3117s
Epoch: 13 cost time: 70.18710589408875
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.981131 --> -0.983704).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0530964
	speed: 0.5076s/iter; left time: 3996.4492s
	iters: 200, epoch: 14 | loss: 0.0348858
	speed: 0.1338s/iter; left time: 1040.2042s
	iters: 300, epoch: 14 | loss: 0.0107706
	speed: 0.1397s/iter; left time: 1071.9522s
	iters: 400, epoch: 14 | loss: 0.0699728
	speed: 0.1611s/iter; left time: 1220.0843s
Epoch: 14 cost time: 67.924076795578
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0044206
	speed: 0.5625s/iter; left time: 4165.6335s
	iters: 200, epoch: 15 | loss: 0.0430395
	speed: 0.1554s/iter; left time: 1135.2081s
	iters: 300, epoch: 15 | loss: 0.0183122
	speed: 0.1487s/iter; left time: 1071.4473s
	iters: 400, epoch: 15 | loss: 0.2687457
	speed: 0.1698s/iter; left time: 1206.2198s
Epoch: 15 cost time: 74.45144462585449
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0011968
	speed: 0.5839s/iter; left time: 4050.1072s
	iters: 200, epoch: 16 | loss: 0.0632521
	speed: 0.1569s/iter; left time: 1072.5522s
	iters: 300, epoch: 16 | loss: 0.0076987
	speed: 0.1457s/iter; left time: 981.1629s
	iters: 400, epoch: 16 | loss: 0.0039360
	speed: 0.1605s/iter; left time: 1064.9435s
Epoch: 16 cost time: 73.21144795417786
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0536327
	speed: 0.5826s/iter; left time: 3767.8602s
	iters: 200, epoch: 17 | loss: 0.0150210
	speed: 0.1727s/iter; left time: 1099.3045s
	iters: 300, epoch: 17 | loss: 0.0024369
	speed: 0.1477s/iter; left time: 925.6710s
	iters: 400, epoch: 17 | loss: 0.0061225
	speed: 0.1530s/iter; left time: 943.3226s
Epoch: 17 cost time: 74.58171510696411
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0017508
	speed: 0.5355s/iter; left time: 3212.0318s
	iters: 200, epoch: 18 | loss: 0.0025975
	speed: 0.1160s/iter; left time: 684.2660s
	iters: 300, epoch: 18 | loss: 0.0016858
	speed: 0.1493s/iter; left time: 865.8125s
	iters: 400, epoch: 18 | loss: 0.0022059
	speed: 0.1582s/iter; left time: 901.5548s
Epoch: 18 cost time: 66.34445977210999
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.983704 --> -0.983990).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0014618
	speed: 0.4953s/iter; left time: 2738.6513s
	iters: 200, epoch: 19 | loss: 0.0006117
	speed: 0.1369s/iter; left time: 742.9718s
	iters: 300, epoch: 19 | loss: 0.0044142
	speed: 0.1333s/iter; left time: 710.5390s
	iters: 400, epoch: 19 | loss: 0.0231830
	speed: 0.1323s/iter; left time: 692.0251s
Epoch: 19 cost time: 65.639888048172
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0124552
	speed: 0.4960s/iter; left time: 2509.9594s
	iters: 200, epoch: 20 | loss: 0.0013698
	speed: 0.1408s/iter; left time: 698.4156s
	iters: 300, epoch: 20 | loss: 0.0338307
	speed: 0.1474s/iter; left time: 716.2910s
	iters: 400, epoch: 20 | loss: 0.0138610
	speed: 0.1162s/iter; left time: 553.2639s
Epoch: 20 cost time: 62.0689537525177
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0129951
	speed: 0.4543s/iter; left time: 2085.7835s
	iters: 200, epoch: 21 | loss: 0.0001351
	speed: 0.1135s/iter; left time: 509.6094s
	iters: 300, epoch: 21 | loss: 0.0427146
	speed: 0.1093s/iter; left time: 479.9331s
	iters: 400, epoch: 21 | loss: 0.0118449
	speed: 0.1291s/iter; left time: 554.0618s
Epoch: 21 cost time: 57.78404998779297
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0031093
	speed: 0.4496s/iter; left time: 1853.0793s
	iters: 200, epoch: 22 | loss: 0.0098083
	speed: 0.1347s/iter; left time: 541.8668s
	iters: 300, epoch: 22 | loss: 0.0082505
	speed: 0.1247s/iter; left time: 489.2579s
	iters: 400, epoch: 22 | loss: 0.0006790
	speed: 0.1179s/iter; left time: 450.6562s
Epoch: 22 cost time: 56.90089154243469
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1539206
	speed: 0.4454s/iter; left time: 1627.0269s
	iters: 200, epoch: 23 | loss: 0.0041776
	speed: 0.1159s/iter; left time: 411.6772s
	iters: 300, epoch: 23 | loss: 0.0021640
	speed: 0.1174s/iter; left time: 405.2343s
	iters: 400, epoch: 23 | loss: 0.0044111
	speed: 0.1333s/iter; left time: 446.7951s
Epoch: 23 cost time: 58.03614950180054
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0558487
	speed: 0.4487s/iter; left time: 1428.6037s
	iters: 200, epoch: 24 | loss: 0.0036296
	speed: 0.1309s/iter; left time: 403.6454s
	iters: 300, epoch: 24 | loss: 0.0030820
	speed: 0.1211s/iter; left time: 361.4546s
	iters: 400, epoch: 24 | loss: 0.0052788
	speed: 0.1111s/iter; left time: 320.2786s
Epoch: 24 cost time: 56.584460735321045
Epoch: 24, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0009201
	speed: 0.4640s/iter; left time: 1259.8876s
	iters: 200, epoch: 25 | loss: 0.0098673
	speed: 0.1377s/iter; left time: 360.0714s
	iters: 300, epoch: 25 | loss: 0.0115714
	speed: 0.1587s/iter; left time: 399.2147s
	iters: 400, epoch: 25 | loss: 0.0244484
	speed: 0.1637s/iter; left time: 395.2630s
Epoch: 25 cost time: 69.52403807640076
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0022508
	speed: 0.5402s/iter; left time: 1213.2345s
	iters: 200, epoch: 26 | loss: 0.0012279
	speed: 0.1663s/iter; left time: 356.9465s
	iters: 300, epoch: 26 | loss: 0.0010663
	speed: 0.1467s/iter; left time: 300.1754s
	iters: 400, epoch: 26 | loss: 0.0031190
	speed: 0.1415s/iter; left time: 275.3523s
Epoch: 26 cost time: 72.39660930633545
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0012713
	speed: 0.5543s/iter; left time: 985.0799s
	iters: 200, epoch: 27 | loss: 0.0004490
	speed: 0.1493s/iter; left time: 250.4322s
	iters: 300, epoch: 27 | loss: 0.0637509
	speed: 0.1585s/iter; left time: 249.8760s
	iters: 400, epoch: 27 | loss: 0.0010950
	speed: 0.1684s/iter; left time: 248.6573s
Epoch: 27 cost time: 72.88834762573242
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0006832
	speed: 0.5440s/iter; left time: 711.6136s
	iters: 200, epoch: 28 | loss: 0.0015382
	speed: 0.1494s/iter; left time: 180.4700s
	iters: 300, epoch: 28 | loss: 0.5016997
	speed: 0.1479s/iter; left time: 163.9113s
	iters: 400, epoch: 28 | loss: 0.0124987
	speed: 0.1471s/iter; left time: 148.2702s
Epoch: 28 cost time: 71.879159450531
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.984276).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0007601
	speed: 0.5505s/iter; left time: 461.8946s
	iters: 200, epoch: 29 | loss: 0.0002039
	speed: 0.1595s/iter; left time: 117.8643s
	iters: 300, epoch: 29 | loss: 0.0005366
	speed: 0.1571s/iter; left time: 100.3970s
	iters: 400, epoch: 29 | loss: 0.0419297
	speed: 0.1471s/iter; left time: 79.2925s
Epoch: 29 cost time: 71.41932225227356
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0081950
	speed: 0.5525s/iter; left time: 204.4115s
	iters: 200, epoch: 30 | loss: 0.0005496
	speed: 0.1498s/iter; left time: 40.4581s
	iters: 300, epoch: 30 | loss: 0.0049127
	speed: 0.1411s/iter; left time: 23.9797s
	iters: 400, epoch: 30 | loss: 0.0006157
	speed: 0.1588s/iter; left time: 11.1176s
Epoch: 30 cost time: 72.74091291427612
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.984276 --> -0.987135).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9871355060034306
model parameter : 880634
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0076981
	speed: 0.1452s/iter; left time: 2028.1767s
	iters: 200, epoch: 1 | loss: 1.4180064
	speed: 0.1165s/iter; left time: 1616.0018s
	iters: 300, epoch: 1 | loss: 0.9329066
	speed: 0.1029s/iter; left time: 1417.1784s
	iters: 400, epoch: 1 | loss: 0.6790749
	speed: 0.1042s/iter; left time: 1425.1557s
Epoch: 1 cost time: 55.35747218132019
Epoch: 1, Steps: 469 | Train Loss: 1.294 Vali Loss: 0.477 Vali Acc: 0.874 Test Loss: 0.477 Test Acc: 0.874
Validation loss decreased (inf --> -0.874495).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3462888
	speed: 0.4507s/iter; left time: 6085.6855s
	iters: 200, epoch: 2 | loss: 0.2384591
	speed: 0.0878s/iter; left time: 1176.5668s
	iters: 300, epoch: 2 | loss: 0.1936386
	speed: 0.1141s/iter; left time: 1518.0400s
	iters: 400, epoch: 2 | loss: 0.1545364
	speed: 0.1159s/iter; left time: 1530.5369s
Epoch: 2 cost time: 50.55535674095154
Epoch: 2, Steps: 469 | Train Loss: 0.256 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
Validation loss decreased (-0.874495 --> -0.949112).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1194729
	speed: 0.4187s/iter; left time: 5456.3927s
	iters: 200, epoch: 3 | loss: 0.1328534
	speed: 0.1188s/iter; left time: 1536.3198s
	iters: 300, epoch: 3 | loss: 0.1313757
	speed: 0.1011s/iter; left time: 1297.6474s
	iters: 400, epoch: 3 | loss: 0.2529929
	speed: 0.0990s/iter; left time: 1260.1556s
Epoch: 3 cost time: 51.083534240722656
Epoch: 3, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.949112 --> -0.964836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0199167
	speed: 0.4206s/iter; left time: 5284.4284s
	iters: 200, epoch: 4 | loss: 0.0470867
	speed: 0.0930s/iter; left time: 1159.7392s
	iters: 300, epoch: 4 | loss: 0.0222915
	speed: 0.1015s/iter; left time: 1255.0600s
	iters: 400, epoch: 4 | loss: 0.0088993
	speed: 0.1107s/iter; left time: 1357.1610s
Epoch: 4 cost time: 49.67165184020996
Epoch: 4, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0178252
	speed: 0.4062s/iter; left time: 4912.9851s
	iters: 200, epoch: 5 | loss: 0.1548322
	speed: 0.1132s/iter; left time: 1357.5645s
	iters: 300, epoch: 5 | loss: 0.0668511
	speed: 0.1194s/iter; left time: 1419.7234s
	iters: 400, epoch: 5 | loss: 0.2697408
	speed: 0.1025s/iter; left time: 1209.4461s
Epoch: 5 cost time: 50.81544852256775
Epoch: 5, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.964836 --> -0.973126).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0077421
	speed: 0.4409s/iter; left time: 5125.4263s
	iters: 200, epoch: 6 | loss: 0.0093760
	speed: 0.1180s/iter; left time: 1360.4701s
	iters: 300, epoch: 6 | loss: 0.0063284
	speed: 0.1126s/iter; left time: 1286.6562s
	iters: 400, epoch: 6 | loss: 0.0055533
	speed: 0.1113s/iter; left time: 1261.0528s
Epoch: 6 cost time: 55.37522912025452
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0445298
	speed: 0.4582s/iter; left time: 5111.9497s
	iters: 200, epoch: 7 | loss: 0.4385891
	speed: 0.1117s/iter; left time: 1235.3335s
	iters: 300, epoch: 7 | loss: 0.0197790
	speed: 0.1068s/iter; left time: 1169.9672s
	iters: 400, epoch: 7 | loss: 0.0403784
	speed: 0.1019s/iter; left time: 1106.2190s
Epoch: 7 cost time: 49.74714016914368
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.973126 --> -0.977701).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0038256
	speed: 0.4609s/iter; left time: 4926.5888s
	iters: 200, epoch: 8 | loss: 0.0073526
	speed: 0.1255s/iter; left time: 1329.0780s
	iters: 300, epoch: 8 | loss: 0.0099538
	speed: 0.1142s/iter; left time: 1197.7188s
	iters: 400, epoch: 8 | loss: 0.2631889
	speed: 0.1113s/iter; left time: 1156.1110s
Epoch: 8 cost time: 56.68756055831909
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.977701 --> -0.981417).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0679717
	speed: 0.4890s/iter; left time: 4997.3098s
	iters: 200, epoch: 9 | loss: 0.0123212
	speed: 0.1408s/iter; left time: 1424.5163s
	iters: 300, epoch: 9 | loss: 0.0259953
	speed: 0.1153s/iter; left time: 1155.1687s
	iters: 400, epoch: 9 | loss: 0.1399951
	speed: 0.1172s/iter; left time: 1162.4146s
Epoch: 9 cost time: 59.817702770233154
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0013811
	speed: 0.5011s/iter; left time: 4885.5523s
	iters: 200, epoch: 10 | loss: 0.0233120
	speed: 0.1367s/iter; left time: 1319.0011s
	iters: 300, epoch: 10 | loss: 0.2750136
	speed: 0.1193s/iter; left time: 1139.4116s
	iters: 400, epoch: 10 | loss: 0.2062551
	speed: 0.1244s/iter; left time: 1175.5052s
Epoch: 10 cost time: 60.673983335494995
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0035293
	speed: 0.5006s/iter; left time: 4645.9882s
	iters: 200, epoch: 11 | loss: 0.0194456
	speed: 0.1344s/iter; left time: 1234.1324s
	iters: 300, epoch: 11 | loss: 0.0028947
	speed: 0.1277s/iter; left time: 1159.5938s
	iters: 400, epoch: 11 | loss: 0.0031767
	speed: 0.1276s/iter; left time: 1145.8233s
Epoch: 11 cost time: 61.43796181678772
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0013120
	speed: 0.4928s/iter; left time: 4342.9169s
	iters: 200, epoch: 12 | loss: 0.3075162
	speed: 0.1319s/iter; left time: 1148.8315s
	iters: 300, epoch: 12 | loss: 0.0040822
	speed: 0.1341s/iter; left time: 1154.8522s
	iters: 400, epoch: 12 | loss: 0.1703047
	speed: 0.1129s/iter; left time: 961.3844s
Epoch: 12 cost time: 59.016611099243164
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0424296
	speed: 0.4525s/iter; left time: 3775.5344s
	iters: 200, epoch: 13 | loss: 0.1223959
	speed: 0.1279s/iter; left time: 1054.2942s
	iters: 300, epoch: 13 | loss: 0.1600911
	speed: 0.1254s/iter; left time: 1021.3421s
	iters: 400, epoch: 13 | loss: 0.0013625
	speed: 0.1048s/iter; left time: 843.2015s
Epoch: 13 cost time: 55.94547772407532
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0051372
	speed: 0.4539s/iter; left time: 3574.1744s
	iters: 200, epoch: 14 | loss: 0.0082007
	speed: 0.1300s/iter; left time: 1010.4370s
	iters: 300, epoch: 14 | loss: 0.0009718
	speed: 0.1239s/iter; left time: 951.0939s
	iters: 400, epoch: 14 | loss: 0.0995237
	speed: 0.1067s/iter; left time: 807.7952s
Epoch: 14 cost time: 56.83605599403381
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0275640
	speed: 0.4493s/iter; left time: 3326.7814s
	iters: 200, epoch: 15 | loss: 0.0010836
	speed: 0.1153s/iter; left time: 842.0240s
	iters: 300, epoch: 15 | loss: 0.1391739
	speed: 0.1184s/iter; left time: 852.8770s
	iters: 400, epoch: 15 | loss: 0.0047984
	speed: 0.1088s/iter; left time: 772.9306s
Epoch: 15 cost time: 54.09815812110901
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982847).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0124503
	speed: 0.4312s/iter; left time: 2990.7170s
	iters: 200, epoch: 16 | loss: 0.0007775
	speed: 0.1173s/iter; left time: 801.6809s
	iters: 300, epoch: 16 | loss: 0.0023522
	speed: 0.1173s/iter; left time: 789.9168s
	iters: 400, epoch: 16 | loss: 0.0268243
	speed: 0.1172s/iter; left time: 777.8593s
Epoch: 16 cost time: 55.17634081840515
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0015401
	speed: 0.4282s/iter; left time: 2769.2867s
	iters: 200, epoch: 17 | loss: 0.0006406
	speed: 0.1175s/iter; left time: 748.4124s
	iters: 300, epoch: 17 | loss: 0.0074850
	speed: 0.1181s/iter; left time: 740.1654s
	iters: 400, epoch: 17 | loss: 0.0021038
	speed: 0.1099s/iter; left time: 677.7048s
Epoch: 17 cost time: 54.30246162414551
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.982847 --> -0.983704).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0008578
	speed: 0.4456s/iter; left time: 2672.4563s
	iters: 200, epoch: 18 | loss: 0.0009424
	speed: 0.1300s/iter; left time: 766.6960s
	iters: 300, epoch: 18 | loss: 0.0013654
	speed: 0.1308s/iter; left time: 758.5956s
	iters: 400, epoch: 18 | loss: 0.3081135
	speed: 0.1232s/iter; left time: 702.0472s
Epoch: 18 cost time: 59.003338098526
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0111352
	speed: 0.4557s/iter; left time: 2519.3919s
	iters: 200, epoch: 19 | loss: 0.0026050
	speed: 0.1330s/iter; left time: 721.9588s
	iters: 300, epoch: 19 | loss: 0.0023406
	speed: 0.1299s/iter; left time: 692.4320s
	iters: 400, epoch: 19 | loss: 0.0011525
	speed: 0.1291s/iter; left time: 675.1629s
Epoch: 19 cost time: 59.88490390777588
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0125616
	speed: 0.4482s/iter; left time: 2267.7008s
	iters: 200, epoch: 20 | loss: 0.0007403
	speed: 0.1310s/iter; left time: 649.8715s
	iters: 300, epoch: 20 | loss: 0.0072769
	speed: 0.1324s/iter; left time: 643.4649s
	iters: 400, epoch: 20 | loss: 0.0008291
	speed: 0.1280s/iter; left time: 609.4212s
Epoch: 20 cost time: 59.85499620437622
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0018775
	speed: 0.4533s/iter; left time: 2081.1592s
	iters: 200, epoch: 21 | loss: 0.0003166
	speed: 0.1182s/iter; left time: 531.0146s
	iters: 300, epoch: 21 | loss: 0.0006856
	speed: 0.1342s/iter; left time: 589.1100s
	iters: 400, epoch: 21 | loss: 0.0065705
	speed: 0.1284s/iter; left time: 550.8911s
Epoch: 21 cost time: 58.90184044837952
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0026985
	speed: 0.4747s/iter; left time: 1956.5978s
	iters: 200, epoch: 22 | loss: 0.0346580
	speed: 0.1204s/iter; left time: 484.4251s
	iters: 300, epoch: 22 | loss: 0.0020697
	speed: 0.1340s/iter; left time: 525.4350s
	iters: 400, epoch: 22 | loss: 0.0007871
	speed: 0.1336s/iter; left time: 510.4365s
Epoch: 22 cost time: 60.387301206588745
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0072753
	speed: 0.4724s/iter; left time: 1725.5243s
	iters: 200, epoch: 23 | loss: 0.0048132
	speed: 0.1226s/iter; left time: 435.4229s
	iters: 300, epoch: 23 | loss: 0.0014439
	speed: 0.1250s/iter; left time: 431.6457s
	iters: 400, epoch: 23 | loss: 0.0012962
	speed: 0.1336s/iter; left time: 447.9504s
Epoch: 23 cost time: 59.42627263069153
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0158628
	speed: 0.4746s/iter; left time: 1511.1860s
	iters: 200, epoch: 24 | loss: 0.0148868
	speed: 0.1185s/iter; left time: 365.3292s
	iters: 300, epoch: 24 | loss: 0.0005009
	speed: 0.1149s/iter; left time: 342.7205s
	iters: 400, epoch: 24 | loss: 0.0011118
	speed: 0.1180s/iter; left time: 340.4255s
Epoch: 24 cost time: 55.88117599487305
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0007389
	speed: 0.4472s/iter; left time: 1214.2467s
	iters: 200, epoch: 25 | loss: 0.0075418
	speed: 0.1010s/iter; left time: 264.0893s
	iters: 300, epoch: 25 | loss: 0.0013419
	speed: 0.1108s/iter; left time: 278.5792s
	iters: 400, epoch: 25 | loss: 0.0005211
	speed: 0.1219s/iter; left time: 294.3550s
Epoch: 25 cost time: 52.62410807609558
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1518841
	speed: 0.4446s/iter; left time: 998.6158s
	iters: 200, epoch: 26 | loss: 0.0053112
	speed: 0.1073s/iter; left time: 230.2039s
	iters: 300, epoch: 26 | loss: 0.0015961
	speed: 0.1070s/iter; left time: 218.8419s
	iters: 400, epoch: 26 | loss: 0.1335158
	speed: 0.1084s/iter; left time: 210.9706s
Epoch: 26 cost time: 50.77114391326904
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0222235
	speed: 0.3638s/iter; left time: 646.4829s
	iters: 200, epoch: 27 | loss: 0.0003814
	speed: 0.1016s/iter; left time: 170.3167s
	iters: 300, epoch: 27 | loss: 0.0011712
	speed: 0.0946s/iter; left time: 149.2470s
	iters: 400, epoch: 27 | loss: 0.0041953
	speed: 0.0955s/iter; left time: 140.9863s
Epoch: 27 cost time: 47.80739426612854
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 259658
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1594892
	speed: 0.1371s/iter; left time: 1915.1529s
	iters: 200, epoch: 1 | loss: 1.4435724
	speed: 0.1035s/iter; left time: 1435.9046s
	iters: 300, epoch: 1 | loss: 0.7447238
	speed: 0.1190s/iter; left time: 1639.1828s
	iters: 400, epoch: 1 | loss: 0.4600725
	speed: 0.1223s/iter; left time: 1671.8794s
Epoch: 1 cost time: 55.58529591560364
Epoch: 1, Steps: 469 | Train Loss: 1.337 Vali Loss: 0.425 Vali Acc: 0.886 Test Loss: 0.425 Test Acc: 0.886
Validation loss decreased (inf --> -0.886216).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2591981
	speed: 0.4304s/iter; left time: 5811.8055s
	iters: 200, epoch: 2 | loss: 0.2352584
	speed: 0.1173s/iter; left time: 1572.3767s
	iters: 300, epoch: 2 | loss: 0.3699563
	speed: 0.1203s/iter; left time: 1600.3123s
	iters: 400, epoch: 2 | loss: 0.0783294
	speed: 0.1190s/iter; left time: 1570.5951s
Epoch: 2 cost time: 58.34928894042969
Epoch: 2, Steps: 469 | Train Loss: 0.246 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
Validation loss decreased (-0.886216 --> -0.952828).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1367758
	speed: 0.4473s/iter; left time: 5829.5362s
	iters: 200, epoch: 3 | loss: 0.0688049
	speed: 0.1290s/iter; left time: 1668.6516s
	iters: 300, epoch: 3 | loss: 0.3746186
	speed: 0.1186s/iter; left time: 1521.4915s
	iters: 400, epoch: 3 | loss: 0.0252631
	speed: 0.1158s/iter; left time: 1475.0917s
Epoch: 3 cost time: 58.70462703704834
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.952828 --> -0.954544).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2013841
	speed: 0.4447s/iter; left time: 5586.7074s
	iters: 200, epoch: 4 | loss: 0.0303860
	speed: 0.1326s/iter; left time: 1653.0240s
	iters: 300, epoch: 4 | loss: 0.0137705
	speed: 0.1224s/iter; left time: 1513.3683s
	iters: 400, epoch: 4 | loss: 0.2110112
	speed: 0.1143s/iter; left time: 1401.3095s
Epoch: 4 cost time: 57.381038665771484
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0171987
	speed: 0.4442s/iter; left time: 5372.2662s
	iters: 200, epoch: 5 | loss: 0.0131934
	speed: 0.1226s/iter; left time: 1471.0662s
	iters: 300, epoch: 5 | loss: 0.0548382
	speed: 0.1327s/iter; left time: 1578.8465s
	iters: 400, epoch: 5 | loss: 0.0522491
	speed: 0.1203s/iter; left time: 1418.7486s
Epoch: 5 cost time: 57.42466855049133
Epoch: 5, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.954544 --> -0.965408).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0253728
	speed: 0.4426s/iter; left time: 5146.1345s
	iters: 200, epoch: 6 | loss: 0.0143465
	speed: 0.1198s/iter; left time: 1380.5735s
	iters: 300, epoch: 6 | loss: 0.0450036
	speed: 0.1277s/iter; left time: 1459.2175s
	iters: 400, epoch: 6 | loss: 0.1167738
	speed: 0.1260s/iter; left time: 1426.7212s
Epoch: 6 cost time: 57.87045645713806
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.965408 --> -0.974842).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0184692
	speed: 0.4464s/iter; left time: 4979.9424s
	iters: 200, epoch: 7 | loss: 0.0203848
	speed: 0.1164s/iter; left time: 1286.6547s
	iters: 300, epoch: 7 | loss: 0.0730870
	speed: 0.1153s/iter; left time: 1263.6646s
	iters: 400, epoch: 7 | loss: 0.0583369
	speed: 0.1308s/iter; left time: 1420.4392s
Epoch: 7 cost time: 57.801533460617065
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2574334
	speed: 0.4677s/iter; left time: 4999.2022s
	iters: 200, epoch: 8 | loss: 0.0112917
	speed: 0.1293s/iter; left time: 1369.0638s
	iters: 300, epoch: 8 | loss: 0.0099978
	speed: 0.1213s/iter; left time: 1272.5447s
	iters: 400, epoch: 8 | loss: 0.0047896
	speed: 0.1169s/iter; left time: 1214.5979s
Epoch: 8 cost time: 59.01292395591736
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.977129).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0626054
	speed: 0.4592s/iter; left time: 4692.5960s
	iters: 200, epoch: 9 | loss: 0.0415276
	speed: 0.1407s/iter; left time: 1424.0239s
	iters: 300, epoch: 9 | loss: 0.0034790
	speed: 0.1231s/iter; left time: 1233.0299s
	iters: 400, epoch: 9 | loss: 0.5433225
	speed: 0.1113s/iter; left time: 1104.1884s
Epoch: 9 cost time: 58.4720139503479
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0026662
	speed: 0.4623s/iter; left time: 4507.5855s
	iters: 200, epoch: 10 | loss: 0.0095683
	speed: 0.1265s/iter; left time: 1220.7863s
	iters: 300, epoch: 10 | loss: 0.0041069
	speed: 0.0920s/iter; left time: 878.9401s
	iters: 400, epoch: 10 | loss: 0.0224904
	speed: 0.0931s/iter; left time: 879.3930s
Epoch: 10 cost time: 53.56280446052551
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977987).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0033236
	speed: 0.4847s/iter; left time: 4498.4260s
	iters: 200, epoch: 11 | loss: 0.0017941
	speed: 0.1321s/iter; left time: 1213.0130s
	iters: 300, epoch: 11 | loss: 0.0035277
	speed: 0.1344s/iter; left time: 1220.4114s
	iters: 400, epoch: 11 | loss: 0.0017752
	speed: 0.1368s/iter; left time: 1228.2793s
Epoch: 11 cost time: 61.77046251296997
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0010684
	speed: 0.4917s/iter; left time: 4333.2410s
	iters: 200, epoch: 12 | loss: 0.1634234
	speed: 0.1236s/iter; left time: 1076.4428s
	iters: 300, epoch: 12 | loss: 0.0081020
	speed: 0.1252s/iter; left time: 1078.2256s
	iters: 400, epoch: 12 | loss: 0.1397440
	speed: 0.1412s/iter; left time: 1201.5645s
Epoch: 12 cost time: 63.973214864730835
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.977987 --> -0.983990).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0021132
	speed: 0.4837s/iter; left time: 4035.1254s
	iters: 200, epoch: 13 | loss: 0.0115075
	speed: 0.1433s/iter; left time: 1181.3109s
	iters: 300, epoch: 13 | loss: 0.0042092
	speed: 0.1623s/iter; left time: 1321.5767s
	iters: 400, epoch: 13 | loss: 0.0769957
	speed: 0.1402s/iter; left time: 1127.3311s
Epoch: 13 cost time: 67.4201283454895
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1708307
	speed: 0.5259s/iter; left time: 4140.6880s
	iters: 200, epoch: 14 | loss: 0.0815736
	speed: 0.1398s/iter; left time: 1086.6757s
	iters: 300, epoch: 14 | loss: 0.0319127
	speed: 0.1319s/iter; left time: 1012.3521s
	iters: 400, epoch: 14 | loss: 0.0737005
	speed: 0.1414s/iter; left time: 1070.6363s
Epoch: 14 cost time: 67.14769577980042
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0215060
	speed: 0.5225s/iter; left time: 3869.2931s
	iters: 200, epoch: 15 | loss: 0.0188472
	speed: 0.1604s/iter; left time: 1171.6933s
	iters: 300, epoch: 15 | loss: 0.0165670
	speed: 0.1521s/iter; left time: 1095.7274s
	iters: 400, epoch: 15 | loss: 0.1996502
	speed: 0.1320s/iter; left time: 938.0058s
Epoch: 15 cost time: 68.20154428482056
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0007212
	speed: 0.5272s/iter; left time: 3656.9296s
	iters: 200, epoch: 16 | loss: 0.0778106
	speed: 0.1391s/iter; left time: 950.8992s
	iters: 300, epoch: 16 | loss: 0.0040886
	speed: 0.1323s/iter; left time: 890.9177s
	iters: 400, epoch: 16 | loss: 0.0030512
	speed: 0.1518s/iter; left time: 1007.0956s
Epoch: 16 cost time: 68.7354736328125
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0148317
	speed: 0.5238s/iter; left time: 3387.1965s
	iters: 200, epoch: 17 | loss: 0.0745002
	speed: 0.1464s/iter; left time: 932.0055s
	iters: 300, epoch: 17 | loss: 0.0017787
	speed: 0.1421s/iter; left time: 890.2830s
	iters: 400, epoch: 17 | loss: 0.0507477
	speed: 0.1401s/iter; left time: 863.7132s
Epoch: 17 cost time: 67.04450869560242
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0034867
	speed: 0.5177s/iter; left time: 3105.2868s
	iters: 200, epoch: 18 | loss: 0.0019819
	speed: 0.1308s/iter; left time: 771.2825s
	iters: 300, epoch: 18 | loss: 0.0016867
	speed: 0.1482s/iter; left time: 859.4717s
	iters: 400, epoch: 18 | loss: 0.0021447
	speed: 0.1496s/iter; left time: 852.5339s
Epoch: 18 cost time: 67.16262102127075
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984848).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0027888
	speed: 0.5138s/iter; left time: 2840.8879s
	iters: 200, epoch: 19 | loss: 0.0014157
	speed: 0.1412s/iter; left time: 766.6274s
	iters: 300, epoch: 19 | loss: 0.0055124
	speed: 0.1295s/iter; left time: 690.3062s
	iters: 400, epoch: 19 | loss: 0.0027878
	speed: 0.1139s/iter; left time: 595.7507s
Epoch: 19 cost time: 61.6742467880249
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0011048
	speed: 0.4723s/iter; left time: 2389.9577s
	iters: 200, epoch: 20 | loss: 0.0029559
	speed: 0.1281s/iter; left time: 635.5270s
	iters: 300, epoch: 20 | loss: 0.0086073
	speed: 0.1372s/iter; left time: 666.7041s
	iters: 400, epoch: 20 | loss: 0.0965577
	speed: 0.1323s/iter; left time: 629.9268s
Epoch: 20 cost time: 60.16959595680237
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.984848 --> -0.985705).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0775615
	speed: 0.4743s/iter; left time: 2177.4915s
	iters: 200, epoch: 21 | loss: 0.0004595
	speed: 0.1312s/iter; left time: 589.3987s
	iters: 300, epoch: 21 | loss: 0.1896965
	speed: 0.1160s/iter; left time: 509.3862s
	iters: 400, epoch: 21 | loss: 0.0139763
	speed: 0.1167s/iter; left time: 500.7218s
Epoch: 21 cost time: 58.48467397689819
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0030844
	speed: 0.3633s/iter; left time: 1497.3499s
	iters: 200, epoch: 22 | loss: 0.0191938
	speed: 0.0976s/iter; left time: 392.5803s
	iters: 300, epoch: 22 | loss: 0.0022511
	speed: 0.1088s/iter; left time: 426.5378s
	iters: 400, epoch: 22 | loss: 0.0005671
	speed: 0.1092s/iter; left time: 417.3013s
Epoch: 22 cost time: 49.77963972091675
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0182576
	speed: 0.3937s/iter; left time: 1438.1582s
	iters: 200, epoch: 23 | loss: 0.0077765
	speed: 0.1012s/iter; left time: 359.4733s
	iters: 300, epoch: 23 | loss: 0.0285554
	speed: 0.1196s/iter; left time: 412.9412s
	iters: 400, epoch: 23 | loss: 0.0051900
	speed: 0.0999s/iter; left time: 334.8971s
Epoch: 23 cost time: 49.471861600875854
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0016106
	speed: 0.3876s/iter; left time: 1234.2723s
	iters: 200, epoch: 24 | loss: 0.0060168
	speed: 0.1326s/iter; left time: 408.8292s
	iters: 300, epoch: 24 | loss: 0.0010670
	speed: 0.1163s/iter; left time: 346.9897s
	iters: 400, epoch: 24 | loss: 0.0019685
	speed: 0.1122s/iter; left time: 323.5785s
Epoch: 24 cost time: 55.54405188560486
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0015567
	speed: 0.4490s/iter; left time: 1219.1656s
	iters: 200, epoch: 25 | loss: 0.1335756
	speed: 0.1180s/iter; left time: 308.4556s
	iters: 300, epoch: 25 | loss: 0.0040779
	speed: 0.1182s/iter; left time: 297.2904s
	iters: 400, epoch: 25 | loss: 0.0026421
	speed: 0.1228s/iter; left time: 296.5374s
Epoch: 25 cost time: 57.63983416557312
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0225836
	speed: 0.4424s/iter; left time: 993.5517s
	iters: 200, epoch: 26 | loss: 0.0033834
	speed: 0.1129s/iter; left time: 242.2667s
	iters: 300, epoch: 26 | loss: 0.0004224
	speed: 0.1138s/iter; left time: 232.7504s
	iters: 400, epoch: 26 | loss: 0.3092000
	speed: 0.1317s/iter; left time: 256.3803s
Epoch: 26 cost time: 56.6605966091156
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0005790
	speed: 0.4251s/iter; left time: 755.4288s
	iters: 200, epoch: 27 | loss: 0.0011068
	speed: 0.1128s/iter; left time: 189.2314s
	iters: 300, epoch: 27 | loss: 0.0022841
	speed: 0.1285s/iter; left time: 202.6862s
	iters: 400, epoch: 27 | loss: 0.0014172
	speed: 0.1112s/iter; left time: 164.2083s
Epoch: 27 cost time: 54.834187507629395
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0005807
	speed: 0.4190s/iter; left time: 548.0165s
	iters: 200, epoch: 28 | loss: 0.0005340
	speed: 0.1516s/iter; left time: 183.1433s
	iters: 300, epoch: 28 | loss: 0.3549992
	speed: 0.1582s/iter; left time: 175.2768s
	iters: 400, epoch: 28 | loss: 0.0016163
	speed: 0.1538s/iter; left time: 154.9930s
Epoch: 28 cost time: 70.75916600227356
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0007102
	speed: 0.5096s/iter; left time: 427.5537s
	iters: 200, epoch: 29 | loss: 0.0008616
	speed: 0.1237s/iter; left time: 91.3927s
	iters: 300, epoch: 29 | loss: 0.0009872
	speed: 0.1506s/iter; left time: 96.2479s
	iters: 400, epoch: 29 | loss: 0.0285529
	speed: 0.1570s/iter; left time: 84.6404s
Epoch: 29 cost time: 66.58537006378174
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0035777
	speed: 0.5533s/iter; left time: 204.7268s
	iters: 200, epoch: 30 | loss: 0.0003061
	speed: 0.1381s/iter; left time: 37.2885s
	iters: 300, epoch: 30 | loss: 0.0188652
	speed: 0.1293s/iter; left time: 21.9824s
	iters: 400, epoch: 30 | loss: 0.0004547
	speed: 0.1249s/iter; left time: 8.7426s
Epoch: 30 cost time: 63.196391344070435
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.985705 --> -0.986563).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 880634
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0077209
	speed: 0.1311s/iter; left time: 1831.4582s
	iters: 200, epoch: 1 | loss: 1.4135998
	speed: 0.1146s/iter; left time: 1589.9838s
	iters: 300, epoch: 1 | loss: 0.9263594
	speed: 0.1216s/iter; left time: 1675.2214s
	iters: 400, epoch: 1 | loss: 0.7121951
	speed: 0.1037s/iter; left time: 1417.3190s
Epoch: 1 cost time: 54.43091177940369
Epoch: 1, Steps: 469 | Train Loss: 1.297 Vali Loss: 0.489 Vali Acc: 0.866 Test Loss: 0.489 Test Acc: 0.866
Validation loss decreased (inf --> -0.866490).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3714419
	speed: 0.4221s/iter; left time: 5698.7498s
	iters: 200, epoch: 2 | loss: 0.2620186
	speed: 0.1174s/iter; left time: 1573.7781s
	iters: 300, epoch: 2 | loss: 0.2255838
	speed: 0.1245s/iter; left time: 1655.8195s
	iters: 400, epoch: 2 | loss: 0.1589197
	speed: 0.1162s/iter; left time: 1533.6226s
Epoch: 2 cost time: 54.27731513977051
Epoch: 2, Steps: 469 | Train Loss: 0.266 Vali Loss: 0.182 Vali Acc: 0.947 Test Loss: 0.182 Test Acc: 0.947
Validation loss decreased (-0.866490 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1231731
	speed: 0.4576s/iter; left time: 5963.3919s
	iters: 200, epoch: 3 | loss: 0.1381628
	speed: 0.1049s/iter; left time: 1356.0595s
	iters: 300, epoch: 3 | loss: 0.2206182
	speed: 0.1083s/iter; left time: 1389.4458s
	iters: 400, epoch: 3 | loss: 0.2031285
	speed: 0.1058s/iter; left time: 1347.3035s
Epoch: 3 cost time: 49.33711767196655
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (-0.946825 --> -0.965979).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0166610
	speed: 0.4558s/iter; left time: 5726.7531s
	iters: 200, epoch: 4 | loss: 0.1490733
	speed: 0.1150s/iter; left time: 1433.6006s
	iters: 300, epoch: 4 | loss: 0.0230772
	speed: 0.1258s/iter; left time: 1555.4950s
	iters: 400, epoch: 4 | loss: 0.0091426
	speed: 0.1178s/iter; left time: 1445.2553s
Epoch: 4 cost time: 54.87931942939758
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.965979 --> -0.969696).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0227079
	speed: 0.4223s/iter; left time: 5107.6057s
	iters: 200, epoch: 5 | loss: 0.2285414
	speed: 0.1066s/iter; left time: 1279.0902s
	iters: 300, epoch: 5 | loss: 0.0412727
	speed: 0.1245s/iter; left time: 1481.1476s
	iters: 400, epoch: 5 | loss: 0.3443788
	speed: 0.1137s/iter; left time: 1340.6760s
Epoch: 5 cost time: 54.00306034088135
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969696 --> -0.970268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0090101
	speed: 0.5065s/iter; left time: 5888.2290s
	iters: 200, epoch: 6 | loss: 0.0213705
	speed: 0.1205s/iter; left time: 1389.0058s
	iters: 300, epoch: 6 | loss: 0.0058075
	speed: 0.1254s/iter; left time: 1433.1154s
	iters: 400, epoch: 6 | loss: 0.0094164
	speed: 0.1107s/iter; left time: 1253.4333s
Epoch: 6 cost time: 55.963566303253174
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0496115
	speed: 0.4790s/iter; left time: 5343.8145s
	iters: 200, epoch: 7 | loss: 0.4826238
	speed: 0.1306s/iter; left time: 1444.0716s
	iters: 300, epoch: 7 | loss: 0.0223462
	speed: 0.1334s/iter; left time: 1461.5731s
	iters: 400, epoch: 7 | loss: 0.0848331
	speed: 0.1257s/iter; left time: 1364.7685s
Epoch: 7 cost time: 60.663424491882324
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975700).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0732935
	speed: 0.4855s/iter; left time: 5188.9977s
	iters: 200, epoch: 8 | loss: 0.0150476
	speed: 0.1111s/iter; left time: 1176.7569s
	iters: 300, epoch: 8 | loss: 0.0156498
	speed: 0.1143s/iter; left time: 1198.3598s
	iters: 400, epoch: 8 | loss: 0.3975584
	speed: 0.1172s/iter; left time: 1217.6744s
Epoch: 8 cost time: 54.93814516067505
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.975700 --> -0.981417).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0344934
	speed: 0.5093s/iter; left time: 5204.1096s
	iters: 200, epoch: 9 | loss: 0.0073038
	speed: 0.1328s/iter; left time: 1343.3125s
	iters: 300, epoch: 9 | loss: 0.0036259
	speed: 0.1325s/iter; left time: 1327.3708s
	iters: 400, epoch: 9 | loss: 0.0617739
	speed: 0.1120s/iter; left time: 1111.3336s
Epoch: 9 cost time: 58.44203543663025
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0011769
	speed: 0.4637s/iter; left time: 4520.7737s
	iters: 200, epoch: 10 | loss: 0.0020023
	speed: 0.1285s/iter; left time: 1240.0501s
	iters: 300, epoch: 10 | loss: 0.0507443
	speed: 0.1297s/iter; left time: 1238.7250s
	iters: 400, epoch: 10 | loss: 0.1226960
	speed: 0.1248s/iter; left time: 1179.7781s
Epoch: 10 cost time: 58.84421491622925
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0018770
	speed: 0.4983s/iter; left time: 4624.5044s
	iters: 200, epoch: 11 | loss: 0.0363054
	speed: 0.1204s/iter; left time: 1105.5372s
	iters: 300, epoch: 11 | loss: 0.0064832
	speed: 0.1177s/iter; left time: 1069.1918s
	iters: 400, epoch: 11 | loss: 0.0013136
	speed: 0.1146s/iter; left time: 1029.0815s
Epoch: 11 cost time: 55.52914023399353
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0036357
	speed: 0.4953s/iter; left time: 4364.9643s
	iters: 200, epoch: 12 | loss: 0.1116108
	speed: 0.1354s/iter; left time: 1179.6767s
	iters: 300, epoch: 12 | loss: 0.0025404
	speed: 0.1294s/iter; left time: 1114.2407s
	iters: 400, epoch: 12 | loss: 0.1106862
	speed: 0.1270s/iter; left time: 1081.1227s
Epoch: 12 cost time: 60.991291522979736
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.982275).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0050596
	speed: 0.4380s/iter; left time: 3654.3562s
	iters: 200, epoch: 13 | loss: 0.2010907
	speed: 0.0985s/iter; left time: 811.7662s
	iters: 300, epoch: 13 | loss: 0.0212734
	speed: 0.0941s/iter; left time: 766.4953s
	iters: 400, epoch: 13 | loss: 0.0024524
	speed: 0.1172s/iter; left time: 942.8616s
Epoch: 13 cost time: 49.25062108039856
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0034790
	speed: 0.4403s/iter; left time: 3467.2626s
	iters: 200, epoch: 14 | loss: 0.0187159
	speed: 0.1125s/iter; left time: 874.8555s
	iters: 300, epoch: 14 | loss: 0.0035527
	speed: 0.1011s/iter; left time: 775.7378s
	iters: 400, epoch: 14 | loss: 0.0276296
	speed: 0.0996s/iter; left time: 754.0058s
Epoch: 14 cost time: 49.40445327758789
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0205582
	speed: 0.4123s/iter; left time: 3053.3665s
	iters: 200, epoch: 15 | loss: 0.0026021
	speed: 0.1135s/iter; left time: 829.1579s
	iters: 300, epoch: 15 | loss: 0.1625811
	speed: 0.1119s/iter; left time: 806.1092s
	iters: 400, epoch: 15 | loss: 0.0389253
	speed: 0.1161s/iter; left time: 824.6079s
Epoch: 15 cost time: 53.80198955535889
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0125381
	speed: 0.4242s/iter; left time: 2942.5265s
	iters: 200, epoch: 16 | loss: 0.0048451
	speed: 0.0984s/iter; left time: 672.5806s
	iters: 300, epoch: 16 | loss: 0.0016695
	speed: 0.1047s/iter; left time: 705.2501s
	iters: 400, epoch: 16 | loss: 0.0014182
	speed: 0.0950s/iter; left time: 630.4693s
Epoch: 16 cost time: 47.68398952484131
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.982275 --> -0.984276).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0060041
	speed: 0.4469s/iter; left time: 2890.1138s
	iters: 200, epoch: 17 | loss: 0.0003023
	speed: 0.1141s/iter; left time: 726.7694s
	iters: 300, epoch: 17 | loss: 0.0084185
	speed: 0.1121s/iter; left time: 702.3394s
	iters: 400, epoch: 17 | loss: 0.0014996
	speed: 0.1045s/iter; left time: 644.4150s
Epoch: 17 cost time: 51.70300531387329
Epoch: 17, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
Validation loss decreased (-0.984276 --> -0.987421).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0006600
	speed: 0.3922s/iter; left time: 2352.4720s
	iters: 200, epoch: 18 | loss: 0.0049018
	speed: 0.1114s/iter; left time: 657.0433s
	iters: 300, epoch: 18 | loss: 0.0017891
	speed: 0.1166s/iter; left time: 676.0753s
	iters: 400, epoch: 18 | loss: 0.0007359
	speed: 0.0976s/iter; left time: 555.9169s
Epoch: 18 cost time: 50.154831647872925
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1309779
	speed: 0.4393s/iter; left time: 2428.7457s
	iters: 200, epoch: 19 | loss: 0.0077855
	speed: 0.1061s/iter; left time: 575.9491s
	iters: 300, epoch: 19 | loss: 0.0083413
	speed: 0.1004s/iter; left time: 535.0313s
	iters: 400, epoch: 19 | loss: 0.0057177
	speed: 0.1073s/iter; left time: 561.2534s
Epoch: 19 cost time: 49.517666816711426
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0028250
	speed: 0.3664s/iter; left time: 1854.1493s
	iters: 200, epoch: 20 | loss: 0.0012276
	speed: 0.0675s/iter; left time: 334.6443s
	iters: 300, epoch: 20 | loss: 0.0079877
	speed: 0.0994s/iter; left time: 482.9344s
	iters: 400, epoch: 20 | loss: 0.0006465
	speed: 0.1061s/iter; left time: 505.1806s
Epoch: 20 cost time: 41.86332941055298
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0025010
	speed: 0.3871s/iter; left time: 1777.0144s
	iters: 200, epoch: 21 | loss: 0.0004403
	speed: 0.0580s/iter; left time: 260.2924s
	iters: 300, epoch: 21 | loss: 0.0011646
	speed: 0.0682s/iter; left time: 299.6017s
	iters: 400, epoch: 21 | loss: 0.0058715
	speed: 0.0752s/iter; left time: 322.7862s
Epoch: 21 cost time: 36.44668245315552
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0128717
	speed: 0.3611s/iter; left time: 1488.3866s
	iters: 200, epoch: 22 | loss: 0.0010507
	speed: 0.1019s/iter; left time: 409.6841s
	iters: 300, epoch: 22 | loss: 0.0006576
	speed: 0.1035s/iter; left time: 405.8533s
	iters: 400, epoch: 22 | loss: 0.0048040
	speed: 0.1054s/iter; left time: 402.9501s
Epoch: 22 cost time: 46.93519902229309
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0041019
	speed: 0.3773s/iter; left time: 1378.1576s
	iters: 200, epoch: 23 | loss: 0.0049373
	speed: 0.1065s/iter; left time: 378.4593s
	iters: 300, epoch: 23 | loss: 0.0014912
	speed: 0.1048s/iter; left time: 361.9282s
	iters: 400, epoch: 23 | loss: 0.0019137
	speed: 0.1067s/iter; left time: 357.8850s
Epoch: 23 cost time: 48.1694495677948
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0022022
	speed: 0.3654s/iter; left time: 1163.5721s
	iters: 200, epoch: 24 | loss: 0.3190919
	speed: 0.1102s/iter; left time: 339.8806s
	iters: 300, epoch: 24 | loss: 0.0006572
	speed: 0.1100s/iter; left time: 328.3308s
	iters: 400, epoch: 24 | loss: 0.0009301
	speed: 0.0730s/iter; left time: 210.5443s
Epoch: 24 cost time: 45.242512941360474
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0005096
	speed: 0.3219s/iter; left time: 874.0837s
	iters: 200, epoch: 25 | loss: 0.0039894
	speed: 0.0903s/iter; left time: 236.2046s
	iters: 300, epoch: 25 | loss: 0.0006897
	speed: 0.0842s/iter; left time: 211.8204s
	iters: 400, epoch: 25 | loss: 0.0015208
	speed: 0.0774s/iter; left time: 187.0291s
Epoch: 25 cost time: 39.69550132751465
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0501654
	speed: 0.3258s/iter; left time: 731.7617s
	iters: 200, epoch: 26 | loss: 0.1496903
	speed: 0.0918s/iter; left time: 197.0330s
	iters: 300, epoch: 26 | loss: 0.0014034
	speed: 0.0770s/iter; left time: 157.5667s
	iters: 400, epoch: 26 | loss: 0.0050497
	speed: 0.0646s/iter; left time: 125.6995s
Epoch: 26 cost time: 37.39333248138428
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0143286
	speed: 0.3294s/iter; left time: 585.2810s
	iters: 200, epoch: 27 | loss: 0.0002611
	speed: 0.0891s/iter; left time: 149.5018s
	iters: 300, epoch: 27 | loss: 0.1374790
	speed: 0.0666s/iter; left time: 105.0077s
	iters: 400, epoch: 27 | loss: 0.0400567
	speed: 0.0873s/iter; left time: 128.9266s
Epoch: 27 cost time: 39.690640687942505
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9874213836477987
model parameter : 259658
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1740224
	speed: 0.1293s/iter; left time: 1806.2722s
	iters: 200, epoch: 1 | loss: 1.5344630
	speed: 0.1093s/iter; left time: 1515.7357s
	iters: 300, epoch: 1 | loss: 0.9878634
	speed: 0.1288s/iter; left time: 1773.8453s
	iters: 400, epoch: 1 | loss: 0.6717344
	speed: 0.1244s/iter; left time: 1700.1232s
Epoch: 1 cost time: 57.3696722984314
Epoch: 1, Steps: 469 | Train Loss: 1.465 Vali Loss: 0.593 Vali Acc: 0.836 Test Loss: 0.593 Test Acc: 0.836
Validation loss decreased (inf --> -0.835900).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3226507
	speed: 0.3844s/iter; left time: 5189.6993s
	iters: 200, epoch: 2 | loss: 0.2517664
	speed: 0.1333s/iter; left time: 1786.7491s
	iters: 300, epoch: 2 | loss: 0.5359240
	speed: 0.1270s/iter; left time: 1689.6372s
	iters: 400, epoch: 2 | loss: 0.1152712
	speed: 0.1043s/iter; left time: 1377.1704s
Epoch: 2 cost time: 53.99733328819275
Epoch: 2, Steps: 469 | Train Loss: 0.341 Vali Loss: 0.252 Vali Acc: 0.928 Test Loss: 0.252 Test Acc: 0.928
Validation loss decreased (-0.835900 --> -0.928242).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1582174
	speed: 0.3323s/iter; left time: 4331.2064s
	iters: 200, epoch: 3 | loss: 0.1513280
	speed: 0.0971s/iter; left time: 1256.3960s
	iters: 300, epoch: 3 | loss: 0.4579711
	speed: 0.0705s/iter; left time: 904.2738s
	iters: 400, epoch: 3 | loss: 0.0516968
	speed: 0.0698s/iter; left time: 889.3254s
Epoch: 3 cost time: 39.55265498161316
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
Validation loss decreased (-0.928242 --> -0.945967).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2547171
	speed: 0.3391s/iter; left time: 4261.0221s
	iters: 200, epoch: 4 | loss: 0.0653370
	speed: 0.0712s/iter; left time: 887.3672s
	iters: 300, epoch: 4 | loss: 0.0426244
	speed: 0.0763s/iter; left time: 943.1391s
	iters: 400, epoch: 4 | loss: 0.3108824
	speed: 0.0764s/iter; left time: 937.3797s
Epoch: 4 cost time: 39.11072111129761
Epoch: 4, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
Validation loss decreased (-0.945967 --> -0.954544).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0564534
	speed: 0.3426s/iter; left time: 4143.5254s
	iters: 200, epoch: 5 | loss: 0.0201298
	speed: 0.0681s/iter; left time: 817.1478s
	iters: 300, epoch: 5 | loss: 0.0276343
	speed: 0.0810s/iter; left time: 963.3741s
	iters: 400, epoch: 5 | loss: 0.1884407
	speed: 0.1301s/iter; left time: 1534.9954s
Epoch: 5 cost time: 45.216129302978516
Epoch: 5, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
Validation loss decreased (-0.954544 --> -0.957689).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0286674
	speed: 0.4004s/iter; left time: 4654.5902s
	iters: 200, epoch: 6 | loss: 0.0389575
	speed: 0.1196s/iter; left time: 1378.8886s
	iters: 300, epoch: 6 | loss: 0.1720485
	speed: 0.1332s/iter; left time: 1521.9683s
	iters: 400, epoch: 6 | loss: 0.0635203
	speed: 0.1202s/iter; left time: 1361.6667s
Epoch: 6 cost time: 55.60570979118347
Epoch: 6, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.957689 --> -0.974556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0390845
	speed: 0.3644s/iter; left time: 4065.2053s
	iters: 200, epoch: 7 | loss: 0.0182017
	speed: 0.0627s/iter; left time: 692.7819s
	iters: 300, epoch: 7 | loss: 0.2051826
	speed: 0.0666s/iter; left time: 729.6131s
	iters: 400, epoch: 7 | loss: 0.0200889
	speed: 0.1278s/iter; left time: 1387.9782s
Epoch: 7 cost time: 46.43772768974304
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0100576
	speed: 0.3978s/iter; left time: 4251.3348s
	iters: 200, epoch: 8 | loss: 0.0312884
	speed: 0.0785s/iter; left time: 830.8081s
	iters: 300, epoch: 8 | loss: 0.0423818
	speed: 0.0825s/iter; left time: 865.6994s
	iters: 400, epoch: 8 | loss: 0.0062920
	speed: 0.0993s/iter; left time: 1031.1174s
Epoch: 8 cost time: 42.29441809654236
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.975414).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2401176
	speed: 0.3791s/iter; left time: 3873.9273s
	iters: 200, epoch: 9 | loss: 0.0119041
	speed: 0.0848s/iter; left time: 858.1854s
	iters: 300, epoch: 9 | loss: 0.1229705
	speed: 0.0769s/iter; left time: 770.0343s
	iters: 400, epoch: 9 | loss: 0.4399679
	speed: 0.0856s/iter; left time: 849.5342s
Epoch: 9 cost time: 42.24793219566345
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0050742
	speed: 0.3952s/iter; left time: 3853.2512s
	iters: 200, epoch: 10 | loss: 0.0283857
	speed: 0.0884s/iter; left time: 852.9063s
	iters: 300, epoch: 10 | loss: 0.0433934
	speed: 0.0789s/iter; left time: 753.6274s
	iters: 400, epoch: 10 | loss: 0.0012799
	speed: 0.0861s/iter; left time: 813.9124s
Epoch: 10 cost time: 42.845786809921265
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0037226
	speed: 0.4325s/iter; left time: 4014.0702s
	iters: 200, epoch: 11 | loss: 0.0418193
	speed: 0.1295s/iter; left time: 1189.3430s
	iters: 300, epoch: 11 | loss: 0.0018046
	speed: 0.1176s/iter; left time: 1067.6071s
	iters: 400, epoch: 11 | loss: 0.0012144
	speed: 0.1175s/iter; left time: 1055.4264s
Epoch: 11 cost time: 58.25281095504761
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0020005
	speed: 0.4615s/iter; left time: 4067.1390s
	iters: 200, epoch: 12 | loss: 0.0262157
	speed: 0.1475s/iter; left time: 1284.9407s
	iters: 300, epoch: 12 | loss: 0.0060134
	speed: 0.1261s/iter; left time: 1085.5575s
	iters: 400, epoch: 12 | loss: 0.0660866
	speed: 0.1325s/iter; left time: 1127.6767s
Epoch: 12 cost time: 65.17823028564453
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0013706
	speed: 0.5055s/iter; left time: 4217.0421s
	iters: 200, epoch: 13 | loss: 0.0075022
	speed: 0.1211s/iter; left time: 998.4810s
	iters: 300, epoch: 13 | loss: 0.0084186
	speed: 0.0959s/iter; left time: 780.5235s
	iters: 400, epoch: 13 | loss: 0.0304064
	speed: 0.1036s/iter; left time: 833.1831s
Epoch: 13 cost time: 54.790305376052856
Epoch: 13, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.975414 --> -0.978844).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0359532
	speed: 0.4111s/iter; left time: 3236.8823s
	iters: 200, epoch: 14 | loss: 0.0034803
	speed: 0.1216s/iter; left time: 945.2744s
	iters: 300, epoch: 14 | loss: 0.0098505
	speed: 0.1022s/iter; left time: 784.6485s
	iters: 400, epoch: 14 | loss: 0.0297113
	speed: 0.0968s/iter; left time: 733.4884s
Epoch: 14 cost time: 51.950836181640625
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979988).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0132534
	speed: 0.4061s/iter; left time: 3007.1334s
	iters: 200, epoch: 15 | loss: 0.0046573
	speed: 0.1226s/iter; left time: 895.5284s
	iters: 300, epoch: 15 | loss: 0.0105864
	speed: 0.1163s/iter; left time: 837.6271s
	iters: 400, epoch: 15 | loss: 0.0868300
	speed: 0.0974s/iter; left time: 692.3176s
Epoch: 15 cost time: 52.60127806663513
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0103710
	speed: 0.4062s/iter; left time: 2817.2448s
	iters: 200, epoch: 16 | loss: 0.0126670
	speed: 0.1461s/iter; left time: 998.4452s
	iters: 300, epoch: 16 | loss: 0.0157572
	speed: 0.1526s/iter; left time: 1027.9653s
	iters: 400, epoch: 16 | loss: 0.0127197
	speed: 0.1240s/iter; left time: 823.1586s
Epoch: 16 cost time: 65.86880779266357
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0142276
	speed: 0.4751s/iter; left time: 3072.2697s
	iters: 200, epoch: 17 | loss: 0.0100877
	speed: 0.1583s/iter; left time: 1007.5815s
	iters: 300, epoch: 17 | loss: 0.0237077
	speed: 0.1408s/iter; left time: 882.1751s
	iters: 400, epoch: 17 | loss: 0.0794705
	speed: 0.1305s/iter; left time: 805.0636s
Epoch: 17 cost time: 67.28696918487549
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.980274).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0071525
	speed: 0.4857s/iter; left time: 2913.3365s
	iters: 200, epoch: 18 | loss: 0.0011097
	speed: 0.1510s/iter; left time: 890.7485s
	iters: 300, epoch: 18 | loss: 0.0314204
	speed: 0.1353s/iter; left time: 784.6690s
	iters: 400, epoch: 18 | loss: 0.0020282
	speed: 0.0885s/iter; left time: 504.5279s
Epoch: 18 cost time: 58.04533243179321
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981703).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0024600
	speed: 0.3521s/iter; left time: 1946.9501s
	iters: 200, epoch: 19 | loss: 0.0031292
	speed: 0.1202s/iter; left time: 652.7823s
	iters: 300, epoch: 19 | loss: 0.0535182
	speed: 0.1197s/iter; left time: 638.1070s
	iters: 400, epoch: 19 | loss: 0.0027537
	speed: 0.0829s/iter; left time: 433.5176s
Epoch: 19 cost time: 50.688491106033325
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0007416
	speed: 0.3671s/iter; left time: 1857.4755s
	iters: 200, epoch: 20 | loss: 0.0024150
	speed: 0.1188s/iter; left time: 589.0576s
	iters: 300, epoch: 20 | loss: 0.0105491
	speed: 0.1149s/iter; left time: 558.3374s
	iters: 400, epoch: 20 | loss: 0.1485655
	speed: 0.1013s/iter; left time: 482.3156s
Epoch: 20 cost time: 51.97286820411682
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0696600
	speed: 0.3585s/iter; left time: 1645.7872s
	iters: 200, epoch: 21 | loss: 0.0003532
	speed: 0.1363s/iter; left time: 612.1457s
	iters: 300, epoch: 21 | loss: 0.0156874
	speed: 0.1451s/iter; left time: 637.1239s
	iters: 400, epoch: 21 | loss: 0.0097866
	speed: 0.1233s/iter; left time: 529.2287s
Epoch: 21 cost time: 61.204450607299805
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0338442
	speed: 0.4504s/iter; left time: 1856.4582s
	iters: 200, epoch: 22 | loss: 0.0100140
	speed: 0.1400s/iter; left time: 563.1232s
	iters: 300, epoch: 22 | loss: 0.0030007
	speed: 0.1453s/iter; left time: 569.7828s
	iters: 400, epoch: 22 | loss: 0.0030461
	speed: 0.1280s/iter; left time: 489.0506s
Epoch: 22 cost time: 64.16997647285461
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1805729
	speed: 0.4413s/iter; left time: 1612.1175s
	iters: 200, epoch: 23 | loss: 0.0819664
	speed: 0.1456s/iter; left time: 517.4187s
	iters: 300, epoch: 23 | loss: 0.0034668
	speed: 0.1376s/iter; left time: 475.0609s
	iters: 400, epoch: 23 | loss: 0.0061200
	speed: 0.1331s/iter; left time: 446.2393s
Epoch: 23 cost time: 61.99822688102722
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.981703 --> -0.982275).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0008950
	speed: 0.3567s/iter; left time: 1135.5809s
	iters: 200, epoch: 24 | loss: 0.0009794
	speed: 0.1151s/iter; left time: 355.0415s
	iters: 300, epoch: 24 | loss: 0.0013018
	speed: 0.1236s/iter; left time: 368.9147s
	iters: 400, epoch: 24 | loss: 0.0087752
	speed: 0.0973s/iter; left time: 280.6415s
Epoch: 24 cost time: 51.27250528335571
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0050152
	speed: 0.3506s/iter; left time: 951.7573s
	iters: 200, epoch: 25 | loss: 0.0006926
	speed: 0.1217s/iter; left time: 318.2255s
	iters: 300, epoch: 25 | loss: 0.0026031
	speed: 0.1138s/iter; left time: 286.3136s
	iters: 400, epoch: 25 | loss: 0.0124858
	speed: 0.1059s/iter; left time: 255.7148s
Epoch: 25 cost time: 49.90995192527771
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0022963
	speed: 0.3329s/iter; left time: 747.6891s
	iters: 200, epoch: 26 | loss: 0.0034723
	speed: 0.1219s/iter; left time: 261.6801s
	iters: 300, epoch: 26 | loss: 0.0001059
	speed: 0.1425s/iter; left time: 291.4937s
	iters: 400, epoch: 26 | loss: 0.0130812
	speed: 0.1433s/iter; left time: 278.8318s
Epoch: 26 cost time: 59.62677478790283
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0009270
	speed: 0.4502s/iter; left time: 800.0298s
	iters: 200, epoch: 27 | loss: 0.0001292
	speed: 0.1446s/iter; left time: 242.5419s
	iters: 300, epoch: 27 | loss: 0.0004899
	speed: 0.1491s/iter; left time: 235.1317s
	iters: 400, epoch: 27 | loss: 0.0005212
	speed: 0.1503s/iter; left time: 222.0420s
Epoch: 27 cost time: 67.11624908447266
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983132).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0172748
	speed: 0.4395s/iter; left time: 574.9258s
	iters: 200, epoch: 28 | loss: 0.0005266
	speed: 0.1529s/iter; left time: 184.6851s
	iters: 300, epoch: 28 | loss: 0.1897621
	speed: 0.1425s/iter; left time: 157.8830s
	iters: 400, epoch: 28 | loss: 0.0003271
	speed: 0.1505s/iter; left time: 151.6983s
Epoch: 28 cost time: 65.89394640922546
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0005624
	speed: 0.3782s/iter; left time: 317.2716s
	iters: 200, epoch: 29 | loss: 0.0001945
	speed: 0.1202s/iter; left time: 88.8145s
	iters: 300, epoch: 29 | loss: 0.0008909
	speed: 0.1293s/iter; left time: 82.6136s
	iters: 400, epoch: 29 | loss: 0.1582044
	speed: 0.1183s/iter; left time: 63.7525s
Epoch: 29 cost time: 53.969783544540405
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0140308
	speed: 0.3638s/iter; left time: 134.6144s
	iters: 200, epoch: 30 | loss: 0.0005183
	speed: 0.1135s/iter; left time: 30.6570s
	iters: 300, epoch: 30 | loss: 0.0277151
	speed: 0.1187s/iter; left time: 20.1809s
	iters: 400, epoch: 30 | loss: 0.0009568
	speed: 0.1299s/iter; left time: 9.0905s
Epoch: 30 cost time: 54.219297885894775
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 880634
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0621853
	speed: 0.1227s/iter; left time: 1714.9042s
	iters: 200, epoch: 1 | loss: 1.5662402
	speed: 0.1085s/iter; left time: 1505.0991s
	iters: 300, epoch: 1 | loss: 1.1684062
	speed: 0.1196s/iter; left time: 1646.6904s
	iters: 400, epoch: 1 | loss: 0.9057699
	speed: 0.1038s/iter; left time: 1419.2885s
Epoch: 1 cost time: 51.98938226699829
Epoch: 1, Steps: 469 | Train Loss: 1.459 Vali Loss: 0.668 Vali Acc: 0.821 Test Loss: 0.668 Test Acc: 0.821
Validation loss decreased (inf --> -0.820748).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7692950
	speed: 0.3725s/iter; left time: 5029.6532s
	iters: 200, epoch: 2 | loss: 0.4266449
	speed: 0.1177s/iter; left time: 1577.8682s
	iters: 300, epoch: 2 | loss: 0.3584268
	speed: 0.1141s/iter; left time: 1517.5565s
	iters: 400, epoch: 2 | loss: 0.2043113
	speed: 0.1196s/iter; left time: 1579.0177s
Epoch: 2 cost time: 53.235103607177734
Epoch: 2, Steps: 469 | Train Loss: 0.388 Vali Loss: 0.276 Vali Acc: 0.894 Test Loss: 0.276 Test Acc: 0.894
Validation loss decreased (-0.820748 --> -0.894223).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1553807
	speed: 0.3872s/iter; left time: 5046.5515s
	iters: 200, epoch: 3 | loss: 0.2047312
	speed: 0.0943s/iter; left time: 1219.9627s
	iters: 300, epoch: 3 | loss: 0.2605489
	speed: 0.1200s/iter; left time: 1539.9319s
	iters: 400, epoch: 3 | loss: 0.2530825
	speed: 0.1144s/iter; left time: 1456.3154s
Epoch: 3 cost time: 50.543508529663086
Epoch: 3, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.894223 --> -0.953686).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0591424
	speed: 0.3837s/iter; left time: 4820.4757s
	iters: 200, epoch: 4 | loss: 0.2006493
	speed: 0.0737s/iter; left time: 919.1237s
	iters: 300, epoch: 4 | loss: 0.0304463
	speed: 0.0719s/iter; left time: 888.6135s
	iters: 400, epoch: 4 | loss: 0.0282077
	speed: 0.0782s/iter; left time: 958.5160s
Epoch: 4 cost time: 37.086843967437744
Epoch: 4, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.953686 --> -0.957117).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0494865
	speed: 0.3673s/iter; left time: 4442.1501s
	iters: 200, epoch: 5 | loss: 0.0974957
	speed: 0.0712s/iter; left time: 853.5672s
	iters: 300, epoch: 5 | loss: 0.1072781
	speed: 0.0680s/iter; left time: 809.3588s
	iters: 400, epoch: 5 | loss: 0.1084493
	speed: 0.0747s/iter; left time: 881.2137s
Epoch: 5 cost time: 35.99709129333496
Epoch: 5, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
Validation loss decreased (-0.957117 --> -0.963121).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0534986
	speed: 0.3399s/iter; left time: 3951.6588s
	iters: 200, epoch: 6 | loss: 0.0283321
	speed: 0.0942s/iter; left time: 1085.7129s
	iters: 300, epoch: 6 | loss: 0.0554742
	speed: 0.0849s/iter; left time: 970.0920s
	iters: 400, epoch: 6 | loss: 0.0090898
	speed: 0.0726s/iter; left time: 822.1990s
Epoch: 6 cost time: 39.7306649684906
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.963121 --> -0.965122).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0933341
	speed: 0.3196s/iter; left time: 3565.7585s
	iters: 200, epoch: 7 | loss: 0.5768811
	speed: 0.1143s/iter; left time: 1263.4310s
	iters: 300, epoch: 7 | loss: 0.0839085
	speed: 0.1141s/iter; left time: 1250.0677s
	iters: 400, epoch: 7 | loss: 0.0124113
	speed: 0.1077s/iter; left time: 1168.9535s
Epoch: 7 cost time: 50.570290327072144
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.965122 --> -0.969410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0042268
	speed: 0.3851s/iter; left time: 4116.0548s
	iters: 200, epoch: 8 | loss: 0.0819882
	speed: 0.1122s/iter; left time: 1187.7974s
	iters: 300, epoch: 8 | loss: 0.0049981
	speed: 0.1196s/iter; left time: 1254.6937s
	iters: 400, epoch: 8 | loss: 0.0848545
	speed: 0.1148s/iter; left time: 1192.6488s
Epoch: 8 cost time: 53.01084065437317
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.969410 --> -0.979702).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0425170
	speed: 0.3798s/iter; left time: 3880.9373s
	iters: 200, epoch: 9 | loss: 0.0466435
	speed: 0.0831s/iter; left time: 841.1302s
	iters: 300, epoch: 9 | loss: 0.0395997
	speed: 0.0945s/iter; left time: 946.6618s
	iters: 400, epoch: 9 | loss: 0.0240428
	speed: 0.0831s/iter; left time: 824.4014s
Epoch: 9 cost time: 39.165982246398926
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0116224
	speed: 0.2647s/iter; left time: 2581.0974s
	iters: 200, epoch: 10 | loss: 0.0559544
	speed: 0.0685s/iter; left time: 660.5850s
	iters: 300, epoch: 10 | loss: 0.1603094
	speed: 0.0575s/iter; left time: 549.5722s
	iters: 400, epoch: 10 | loss: 0.2395087
	speed: 0.0583s/iter; left time: 551.3204s
Epoch: 10 cost time: 30.983365535736084
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0022579
	speed: 0.2740s/iter; left time: 2542.9107s
	iters: 200, epoch: 11 | loss: 0.0033061
	speed: 0.0519s/iter; left time: 476.5498s
	iters: 300, epoch: 11 | loss: 0.0120259
	speed: 0.0573s/iter; left time: 520.2132s
	iters: 400, epoch: 11 | loss: 0.0070662
	speed: 0.0817s/iter; left time: 733.8371s
Epoch: 11 cost time: 30.48244881629944
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0057256
	speed: 0.2714s/iter; left time: 2391.9962s
	iters: 200, epoch: 12 | loss: 0.1498767
	speed: 0.0718s/iter; left time: 625.8626s
	iters: 300, epoch: 12 | loss: 0.0186166
	speed: 0.0888s/iter; left time: 764.6133s
	iters: 400, epoch: 12 | loss: 0.2218512
	speed: 0.0682s/iter; left time: 580.1805s
Epoch: 12 cost time: 32.6101496219635
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0163163
	speed: 0.2980s/iter; left time: 2486.2006s
	iters: 200, epoch: 13 | loss: 0.4203269
	speed: 0.1010s/iter; left time: 832.7660s
	iters: 300, epoch: 13 | loss: 0.0400652
	speed: 0.0784s/iter; left time: 638.4471s
	iters: 400, epoch: 13 | loss: 0.0022368
	speed: 0.0782s/iter; left time: 628.6115s
Epoch: 13 cost time: 42.931398153305054
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0065386
	speed: 0.3632s/iter; left time: 2859.6188s
	iters: 200, epoch: 14 | loss: 0.0029756
	speed: 0.0773s/iter; left time: 600.6575s
	iters: 300, epoch: 14 | loss: 0.0021907
	speed: 0.0932s/iter; left time: 714.8442s
	iters: 400, epoch: 14 | loss: 0.1414572
	speed: 0.1077s/iter; left time: 815.7158s
Epoch: 14 cost time: 43.528992891311646
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981417).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0495958
	speed: 0.3467s/iter; left time: 2567.3217s
	iters: 200, epoch: 15 | loss: 0.0086779
	speed: 0.1087s/iter; left time: 793.9024s
	iters: 300, epoch: 15 | loss: 0.0782471
	speed: 0.0925s/iter; left time: 666.1051s
	iters: 400, epoch: 15 | loss: 0.0012083
	speed: 0.0746s/iter; left time: 530.3064s
Epoch: 15 cost time: 43.0323326587677
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.981417 --> -0.985134).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0113299
	speed: 0.3168s/iter; left time: 2197.4940s
	iters: 200, epoch: 16 | loss: 0.0017094
	speed: 0.0597s/iter; left time: 407.8293s
	iters: 300, epoch: 16 | loss: 0.0035823
	speed: 0.0539s/iter; left time: 362.7896s
	iters: 400, epoch: 16 | loss: 0.0030755
	speed: 0.0675s/iter; left time: 447.9898s
Epoch: 16 cost time: 32.26080918312073
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0017508
	speed: 0.2900s/iter; left time: 1875.4427s
	iters: 200, epoch: 17 | loss: 0.0049964
	speed: 0.0548s/iter; left time: 348.7156s
	iters: 300, epoch: 17 | loss: 0.0283576
	speed: 0.0851s/iter; left time: 533.0627s
	iters: 400, epoch: 17 | loss: 0.0009364
	speed: 0.0865s/iter; left time: 533.7100s
Epoch: 17 cost time: 32.935458183288574
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0022605
	speed: 0.2770s/iter; left time: 1661.5137s
	iters: 200, epoch: 18 | loss: 0.0055190
	speed: 0.0864s/iter; left time: 509.4593s
	iters: 300, epoch: 18 | loss: 0.0049505
	speed: 0.0652s/iter; left time: 378.2823s
	iters: 400, epoch: 18 | loss: 0.0012775
	speed: 0.0540s/iter; left time: 307.4975s
Epoch: 18 cost time: 33.200517892837524
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0101178
	speed: 0.3283s/iter; left time: 1814.9532s
	iters: 200, epoch: 19 | loss: 0.0040107
	speed: 0.0865s/iter; left time: 469.4603s
	iters: 300, epoch: 19 | loss: 0.0037936
	speed: 0.0791s/iter; left time: 421.3333s
	iters: 400, epoch: 19 | loss: 0.0168503
	speed: 0.0927s/iter; left time: 484.5509s
Epoch: 19 cost time: 43.805872678756714
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0081373
	speed: 0.3591s/iter; left time: 1816.8971s
	iters: 200, epoch: 20 | loss: 0.0674891
	speed: 0.0899s/iter; left time: 445.8486s
	iters: 300, epoch: 20 | loss: 0.0522495
	speed: 0.1020s/iter; left time: 495.5529s
	iters: 400, epoch: 20 | loss: 0.0008246
	speed: 0.0850s/iter; left time: 404.7971s
Epoch: 20 cost time: 41.90008211135864
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0070759
	speed: 0.3442s/iter; left time: 1580.2795s
	iters: 200, epoch: 21 | loss: 0.0003893
	speed: 0.0948s/iter; left time: 425.7859s
	iters: 300, epoch: 21 | loss: 0.0009673
	speed: 0.0771s/iter; left time: 338.7126s
	iters: 400, epoch: 21 | loss: 0.0118526
	speed: 0.0765s/iter; left time: 328.1700s
Epoch: 21 cost time: 38.75403332710266
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0026764
	speed: 0.1887s/iter; left time: 777.9850s
	iters: 200, epoch: 22 | loss: 0.0071104
	speed: 0.0352s/iter; left time: 141.4359s
	iters: 300, epoch: 22 | loss: 0.0007420
	speed: 0.0669s/iter; left time: 262.2841s
	iters: 400, epoch: 22 | loss: 0.0006404
	speed: 0.0820s/iter; left time: 313.4671s
Epoch: 22 cost time: 27.988108158111572
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3377452
	speed: 0.2751s/iter; left time: 1004.8530s
	iters: 200, epoch: 23 | loss: 0.0434226
	speed: 0.0867s/iter; left time: 308.0766s
	iters: 300, epoch: 23 | loss: 0.0026904
	speed: 0.0854s/iter; left time: 294.9796s
	iters: 400, epoch: 23 | loss: 0.0023688
	speed: 0.0676s/iter; left time: 226.8031s
Epoch: 23 cost time: 35.25032711029053
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0021902
	speed: 0.2997s/iter; left time: 954.2751s
	iters: 200, epoch: 24 | loss: 0.2011158
	speed: 0.0737s/iter; left time: 227.1894s
	iters: 300, epoch: 24 | loss: 0.0017363
	speed: 0.0689s/iter; left time: 205.7300s
	iters: 400, epoch: 24 | loss: 0.0011263
	speed: 0.0654s/iter; left time: 188.6122s
Epoch: 24 cost time: 35.2151734828949
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0010139
	speed: 0.3651s/iter; left time: 991.2185s
	iters: 200, epoch: 25 | loss: 0.1101402
	speed: 0.0886s/iter; left time: 231.6978s
	iters: 300, epoch: 25 | loss: 0.0016106
	speed: 0.0843s/iter; left time: 211.9466s
	iters: 400, epoch: 25 | loss: 0.0007749
	speed: 0.1009s/iter; left time: 243.7515s
Epoch: 25 cost time: 44.168715476989746
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 259658
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0704594
	speed: 0.3144s/iter; left time: 4392.7925s
	iters: 200, epoch: 1 | loss: 1.6487148
	speed: 0.2806s/iter; left time: 3892.2472s
	iters: 300, epoch: 1 | loss: 1.3360571
	speed: 0.2117s/iter; left time: 2915.5883s
	iters: 400, epoch: 1 | loss: 0.5714546
	speed: 0.2191s/iter; left time: 2995.4227s
Epoch: 1 cost time: 115.68204617500305
Epoch: 1, Steps: 469 | Train Loss: 1.405 Vali Loss: 0.617 Vali Acc: 0.854 Test Loss: 0.617 Test Acc: 0.854
Validation loss decreased (inf --> -0.854196).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3316242
	speed: 0.5284s/iter; left time: 7134.9052s
	iters: 200, epoch: 2 | loss: 0.3262703
	speed: 0.2263s/iter; left time: 3032.9699s
	iters: 300, epoch: 2 | loss: 0.3491905
	speed: 0.2220s/iter; left time: 2953.4691s
	iters: 400, epoch: 2 | loss: 0.1904718
	speed: 0.2407s/iter; left time: 3177.5007s
Epoch: 2 cost time: 106.12136793136597
Epoch: 2, Steps: 469 | Train Loss: 0.325 Vali Loss: 0.226 Vali Acc: 0.938 Test Loss: 0.226 Test Acc: 0.938
Validation loss decreased (-0.854196 --> -0.937676).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1130038
	speed: 0.7457s/iter; left time: 9718.5558s
	iters: 200, epoch: 3 | loss: 0.0568287
	speed: 0.3310s/iter; left time: 4280.5650s
	iters: 300, epoch: 3 | loss: 0.2682909
	speed: 0.2788s/iter; left time: 3578.2724s
	iters: 400, epoch: 3 | loss: 0.3664382
	speed: 0.3257s/iter; left time: 4147.5630s
Epoch: 3 cost time: 144.78525280952454
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
Validation loss decreased (-0.937676 --> -0.958260).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1619794
	speed: 0.6486s/iter; left time: 8148.7316s
	iters: 200, epoch: 4 | loss: 0.0131727
	speed: 0.2344s/iter; left time: 2921.3553s
	iters: 300, epoch: 4 | loss: 0.1858891
	speed: 0.2253s/iter; left time: 2785.0442s
	iters: 400, epoch: 4 | loss: 0.0188625
	speed: 0.2174s/iter; left time: 2666.7458s
Epoch: 4 cost time: 104.52805590629578
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
Validation loss decreased (-0.958260 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0445196
	speed: 0.5979s/iter; left time: 7231.3135s
	iters: 200, epoch: 5 | loss: 0.0140002
	speed: 0.2775s/iter; left time: 3329.1020s
	iters: 300, epoch: 5 | loss: 0.0080310
	speed: 0.3271s/iter; left time: 3891.2135s
	iters: 400, epoch: 5 | loss: 0.1432388
	speed: 0.2860s/iter; left time: 3373.6950s
Epoch: 5 cost time: 133.9747302532196
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.969124 --> -0.972841).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0121375
	speed: 0.7976s/iter; left time: 9273.2691s
	iters: 200, epoch: 6 | loss: 0.0134889
	speed: 0.3072s/iter; left time: 3540.2366s
	iters: 300, epoch: 6 | loss: 0.0214508
	speed: 0.2277s/iter; left time: 2601.8998s
	iters: 400, epoch: 6 | loss: 0.0124143
	speed: 0.2452s/iter; left time: 2776.8902s
Epoch: 6 cost time: 124.44179439544678
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0476612
	speed: 0.5621s/iter; left time: 6271.8255s
	iters: 200, epoch: 7 | loss: 0.0025622
	speed: 0.1808s/iter; left time: 1998.7133s
	iters: 300, epoch: 7 | loss: 0.0131953
	speed: 0.0974s/iter; left time: 1066.9589s
	iters: 400, epoch: 7 | loss: 0.0269498
	speed: 0.1688s/iter; left time: 1832.3778s
Epoch: 7 cost time: 76.28923916816711
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0361299
	speed: 0.6131s/iter; left time: 6552.8907s
	iters: 200, epoch: 8 | loss: 0.0037821
	speed: 0.2692s/iter; left time: 2850.7868s
	iters: 300, epoch: 8 | loss: 0.0374910
	speed: 0.2516s/iter; left time: 2638.5089s
	iters: 400, epoch: 8 | loss: 0.0019152
	speed: 0.2449s/iter; left time: 2544.1819s
Epoch: 8 cost time: 121.59400248527527
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2157538
	speed: 0.5322s/iter; left time: 5438.7066s
	iters: 200, epoch: 9 | loss: 0.2879511
	speed: 0.1715s/iter; left time: 1735.6031s
	iters: 300, epoch: 9 | loss: 0.0128657
	speed: 0.1536s/iter; left time: 1538.8265s
	iters: 400, epoch: 9 | loss: 0.0013871
	speed: 0.1382s/iter; left time: 1370.4708s
Epoch: 9 cost time: 72.27034950256348
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.974270 --> -0.983418).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0099769
	speed: 0.4470s/iter; left time: 4358.2049s
	iters: 200, epoch: 10 | loss: 0.0417227
	speed: 0.1635s/iter; left time: 1577.8917s
	iters: 300, epoch: 10 | loss: 0.0047778
	speed: 0.1493s/iter; left time: 1426.2610s
	iters: 400, epoch: 10 | loss: 0.0123441
	speed: 0.2230s/iter; left time: 2107.1837s
Epoch: 10 cost time: 85.43833637237549
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5872737
	speed: 0.6096s/iter; left time: 5657.6707s
	iters: 200, epoch: 11 | loss: 0.0622780
	speed: 0.2224s/iter; left time: 2042.1391s
	iters: 300, epoch: 11 | loss: 0.0083895
	speed: 0.2218s/iter; left time: 2014.0426s
	iters: 400, epoch: 11 | loss: 0.0040625
	speed: 0.2309s/iter; left time: 2073.6357s
Epoch: 11 cost time: 101.99759650230408
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0017798
	speed: 0.4403s/iter; left time: 3880.1210s
	iters: 200, epoch: 12 | loss: 0.0041548
	speed: 0.1432s/iter; left time: 1247.3266s
	iters: 300, epoch: 12 | loss: 0.0174893
	speed: 0.1061s/iter; left time: 914.0070s
	iters: 400, epoch: 12 | loss: 0.0047817
	speed: 0.1583s/iter; left time: 1347.5951s
Epoch: 12 cost time: 67.29954719543457
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0065758
	speed: 0.4554s/iter; left time: 3799.3429s
	iters: 200, epoch: 13 | loss: 0.0037422
	speed: 0.2411s/iter; left time: 1987.1569s
	iters: 300, epoch: 13 | loss: 0.0025601
	speed: 0.2389s/iter; left time: 1945.5093s
	iters: 400, epoch: 13 | loss: 0.0011266
	speed: 0.2344s/iter; left time: 1884.8793s
Epoch: 13 cost time: 100.91740083694458
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0121021
	speed: 0.5945s/iter; left time: 4681.2622s
	iters: 200, epoch: 14 | loss: 0.0059670
	speed: 0.2412s/iter; left time: 1875.4723s
	iters: 300, epoch: 14 | loss: 0.0844032
	speed: 0.1289s/iter; left time: 988.9885s
	iters: 400, epoch: 14 | loss: 0.0016126
	speed: 0.1111s/iter; left time: 841.5151s
Epoch: 14 cost time: 78.20209741592407
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0006356
	speed: 0.5095s/iter; left time: 3772.5233s
	iters: 200, epoch: 15 | loss: 0.0007408
	speed: 0.1833s/iter; left time: 1338.7430s
	iters: 300, epoch: 15 | loss: 0.0135565
	speed: 0.2910s/iter; left time: 2096.7069s
	iters: 400, epoch: 15 | loss: 0.0015389
	speed: 0.1879s/iter; left time: 1334.7560s
Epoch: 15 cost time: 101.52441239356995
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0048485
	speed: 0.6148s/iter; left time: 4264.2294s
	iters: 200, epoch: 16 | loss: 0.0044781
	speed: 0.2520s/iter; left time: 1722.8114s
	iters: 300, epoch: 16 | loss: 0.0043772
	speed: 0.2240s/iter; left time: 1508.7131s
	iters: 400, epoch: 16 | loss: 0.0024366
	speed: 0.1077s/iter; left time: 714.3876s
Epoch: 16 cost time: 101.68209385871887
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0013664
	speed: 0.8018s/iter; left time: 5185.4773s
	iters: 200, epoch: 17 | loss: 0.0005633
	speed: 0.3708s/iter; left time: 2360.9775s
	iters: 300, epoch: 17 | loss: 0.2017046
	speed: 0.3594s/iter; left time: 2252.1649s
	iters: 400, epoch: 17 | loss: 0.0666393
	speed: 0.3474s/iter; left time: 2142.3842s
Epoch: 17 cost time: 169.92482495307922
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0018688
	speed: 0.8932s/iter; left time: 5357.4159s
	iters: 200, epoch: 18 | loss: 0.0011838
	speed: 0.3476s/iter; left time: 2050.3768s
	iters: 300, epoch: 18 | loss: 0.0018104
	speed: 0.2517s/iter; left time: 1459.3712s
	iters: 400, epoch: 18 | loss: 0.0020794
	speed: 0.2938s/iter; left time: 1673.8005s
Epoch: 18 cost time: 140.7804410457611
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0064630
	speed: 0.6692s/iter; left time: 3699.8017s
	iters: 200, epoch: 19 | loss: 0.2079293
	speed: 0.2238s/iter; left time: 1215.2243s
	iters: 300, epoch: 19 | loss: 0.0051609
	speed: 0.2929s/iter; left time: 1560.7238s
	iters: 400, epoch: 19 | loss: 0.0008583
	speed: 0.2506s/iter; left time: 1310.5193s
Epoch: 19 cost time: 120.71024060249329
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 440762
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1136980
	speed: 0.2139s/iter; left time: 2988.3546s
	iters: 200, epoch: 1 | loss: 1.6855656
	speed: 0.2251s/iter; left time: 3121.6687s
	iters: 300, epoch: 1 | loss: 1.1346363
	speed: 0.2487s/iter; left time: 3425.1167s
	iters: 400, epoch: 1 | loss: 0.5624439
	speed: 0.2095s/iter; left time: 2863.9412s
Epoch: 1 cost time: 103.70238542556763
Epoch: 1, Steps: 469 | Train Loss: 1.490 Vali Loss: 0.643 Vali Acc: 0.859 Test Loss: 0.643 Test Acc: 0.859
Validation loss decreased (inf --> -0.859056).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3802104
	speed: 0.4817s/iter; left time: 6503.6354s
	iters: 200, epoch: 2 | loss: 0.2922297
	speed: 0.2158s/iter; left time: 2892.5410s
	iters: 300, epoch: 2 | loss: 0.5787714
	speed: 0.1769s/iter; left time: 2353.4297s
	iters: 400, epoch: 2 | loss: 0.2886192
	speed: 0.2174s/iter; left time: 2869.8816s
Epoch: 2 cost time: 85.94250750541687
Epoch: 2, Steps: 469 | Train Loss: 0.352 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
Validation loss decreased (-0.859056 --> -0.910804).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2408802
	speed: 0.4825s/iter; left time: 6288.7439s
	iters: 200, epoch: 3 | loss: 0.0969498
	speed: 0.1068s/iter; left time: 1381.3163s
	iters: 300, epoch: 3 | loss: 0.2600453
	speed: 0.1365s/iter; left time: 1751.7965s
	iters: 400, epoch: 3 | loss: 0.0594489
	speed: 0.1374s/iter; left time: 1748.9706s
Epoch: 3 cost time: 61.10659861564636
Epoch: 3, Steps: 469 | Train Loss: 0.160 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.910804 --> -0.951971).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6015908
	speed: 0.3908s/iter; left time: 4910.0110s
	iters: 200, epoch: 4 | loss: 0.3032878
	speed: 0.1352s/iter; left time: 1685.7334s
	iters: 300, epoch: 4 | loss: 0.0097530
	speed: 0.1598s/iter; left time: 1975.5907s
	iters: 400, epoch: 4 | loss: 0.2461832
	speed: 0.1114s/iter; left time: 1366.5074s
Epoch: 4 cost time: 61.684157371520996
Epoch: 4, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1550459
	speed: 0.3943s/iter; left time: 4769.5379s
	iters: 200, epoch: 5 | loss: 0.1381788
	speed: 0.2163s/iter; left time: 2594.9537s
	iters: 300, epoch: 5 | loss: 0.0799854
	speed: 0.1731s/iter; left time: 2059.5625s
	iters: 400, epoch: 5 | loss: 0.0208418
	speed: 0.2121s/iter; left time: 2501.8309s
Epoch: 5 cost time: 83.66157603263855
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
Validation loss decreased (-0.951971 --> -0.958261).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0112419
	speed: 0.5553s/iter; left time: 6455.5102s
	iters: 200, epoch: 6 | loss: 0.0453395
	speed: 0.1848s/iter; left time: 2129.4603s
	iters: 300, epoch: 6 | loss: 0.0077700
	speed: 0.2138s/iter; left time: 2443.4124s
	iters: 400, epoch: 6 | loss: 0.0099112
	speed: 0.1749s/iter; left time: 1980.9422s
Epoch: 6 cost time: 93.0035171508789
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.958261 --> -0.975414).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0757937
	speed: 0.5734s/iter; left time: 6397.4163s
	iters: 200, epoch: 7 | loss: 0.0736168
	speed: 0.1988s/iter; left time: 2197.8017s
	iters: 300, epoch: 7 | loss: 0.0657477
	speed: 0.1445s/iter; left time: 1583.4983s
	iters: 400, epoch: 7 | loss: 0.0591398
	speed: 0.1631s/iter; left time: 1771.0416s
Epoch: 7 cost time: 79.18913221359253
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0039294
	speed: 0.4195s/iter; left time: 4483.2107s
	iters: 200, epoch: 8 | loss: 0.1958555
	speed: 0.1179s/iter; left time: 1248.2310s
	iters: 300, epoch: 8 | loss: 0.2281825
	speed: 0.1653s/iter; left time: 1733.7848s
	iters: 400, epoch: 8 | loss: 0.0587828
	speed: 0.1190s/iter; left time: 1236.2377s
Epoch: 8 cost time: 62.25809335708618
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1026864
	speed: 0.4145s/iter; left time: 4235.5422s
	iters: 200, epoch: 9 | loss: 0.0729886
	speed: 0.1475s/iter; left time: 1492.1741s
	iters: 300, epoch: 9 | loss: 0.0050508
	speed: 0.1425s/iter; left time: 1427.6184s
	iters: 400, epoch: 9 | loss: 0.0052337
	speed: 0.1365s/iter; left time: 1353.7357s
Epoch: 9 cost time: 70.27863025665283
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0096906
	speed: 0.5833s/iter; left time: 5687.4784s
	iters: 200, epoch: 10 | loss: 0.0310229
	speed: 0.1931s/iter; left time: 1863.4188s
	iters: 300, epoch: 10 | loss: 0.0077117
	speed: 0.1913s/iter; left time: 1826.4491s
	iters: 400, epoch: 10 | loss: 0.0787112
	speed: 0.2029s/iter; left time: 1917.3271s
Epoch: 10 cost time: 92.85579442977905
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0129815
	speed: 0.5345s/iter; left time: 4960.9050s
	iters: 200, epoch: 11 | loss: 0.0039282
	speed: 0.1976s/iter; left time: 1814.1717s
	iters: 300, epoch: 11 | loss: 0.0400600
	speed: 0.1786s/iter; left time: 1622.1213s
	iters: 400, epoch: 11 | loss: 0.0035541
	speed: 0.1931s/iter; left time: 1733.8079s
Epoch: 11 cost time: 88.61432123184204
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
Validation loss decreased (-0.975414 --> -0.975414).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0032880
	speed: 0.4946s/iter; left time: 4358.5833s
	iters: 200, epoch: 12 | loss: 0.0229706
	speed: 0.1115s/iter; left time: 971.6548s
	iters: 300, epoch: 12 | loss: 0.0191593
	speed: 0.1292s/iter; left time: 1112.4483s
	iters: 400, epoch: 12 | loss: 0.0288240
	speed: 0.1510s/iter; left time: 1284.9406s
Epoch: 12 cost time: 63.2388551235199
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.975414 --> -0.976843).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0028776
	speed: 0.4035s/iter; left time: 3366.5142s
	iters: 200, epoch: 13 | loss: 0.0021237
	speed: 0.1131s/iter; left time: 932.3226s
	iters: 300, epoch: 13 | loss: 0.3433261
	speed: 0.1683s/iter; left time: 1370.0692s
	iters: 400, epoch: 13 | loss: 0.0090100
	speed: 0.1169s/iter; left time: 940.4670s
Epoch: 13 cost time: 60.97969126701355
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0030614
	speed: 0.3988s/iter; left time: 3140.1391s
	iters: 200, epoch: 14 | loss: 0.0011204
	speed: 0.2215s/iter; left time: 1722.0914s
	iters: 300, epoch: 14 | loss: 0.0210011
	speed: 0.1874s/iter; left time: 1438.2432s
	iters: 400, epoch: 14 | loss: 0.0010749
	speed: 0.2177s/iter; left time: 1648.6555s
Epoch: 14 cost time: 93.38850522041321
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.978273).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0166285
	speed: 0.5924s/iter; left time: 4386.8016s
	iters: 200, epoch: 15 | loss: 0.0356663
	speed: 0.2087s/iter; left time: 1524.2254s
	iters: 300, epoch: 15 | loss: 0.0151803
	speed: 0.1821s/iter; left time: 1311.6713s
	iters: 400, epoch: 15 | loss: 0.0035663
	speed: 0.2398s/iter; left time: 1703.5465s
Epoch: 15 cost time: 101.79998826980591
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.978273 --> -0.980845).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0041222
	speed: 0.6602s/iter; left time: 4578.9648s
	iters: 200, epoch: 16 | loss: 0.0083241
	speed: 0.1964s/iter; left time: 1342.5960s
	iters: 300, epoch: 16 | loss: 0.0287140
	speed: 0.1700s/iter; left time: 1145.0436s
	iters: 400, epoch: 16 | loss: 0.2984407
	speed: 0.2118s/iter; left time: 1405.5093s
Epoch: 16 cost time: 95.55890607833862
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.980845).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0015393
	speed: 0.5445s/iter; left time: 3521.5135s
	iters: 200, epoch: 17 | loss: 0.0074687
	speed: 0.1494s/iter; left time: 951.5058s
	iters: 300, epoch: 17 | loss: 0.0052784
	speed: 0.1800s/iter; left time: 1127.9841s
	iters: 400, epoch: 17 | loss: 0.0014139
	speed: 0.2153s/iter; left time: 1327.4578s
Epoch: 17 cost time: 87.11516261100769
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0055774
	speed: 0.5488s/iter; left time: 3291.7527s
	iters: 200, epoch: 18 | loss: 0.0022999
	speed: 0.1538s/iter; left time: 907.2764s
	iters: 300, epoch: 18 | loss: 0.0145872
	speed: 0.1974s/iter; left time: 1144.6903s
	iters: 400, epoch: 18 | loss: 0.0446783
	speed: 0.2624s/iter; left time: 1495.2447s
Epoch: 18 cost time: 97.03824496269226
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0888009
	speed: 0.6399s/iter; left time: 3538.0550s
	iters: 200, epoch: 19 | loss: 0.0015866
	speed: 0.2242s/iter; left time: 1217.1945s
	iters: 300, epoch: 19 | loss: 0.0008604
	speed: 0.2408s/iter; left time: 1283.1739s
	iters: 400, epoch: 19 | loss: 0.0017266
	speed: 0.2435s/iter; left time: 1273.2213s
Epoch: 19 cost time: 111.1325581073761
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0315255
	speed: 0.6590s/iter; left time: 3334.5055s
	iters: 200, epoch: 20 | loss: 0.0010980
	speed: 0.2089s/iter; left time: 1036.0547s
	iters: 300, epoch: 20 | loss: 0.0040586
	speed: 0.2587s/iter; left time: 1257.4634s
	iters: 400, epoch: 20 | loss: 0.0020865
	speed: 0.2255s/iter; left time: 1073.4003s
Epoch: 20 cost time: 105.69180035591125
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.980845 --> -0.982846).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0010280
	speed: 0.5189s/iter; left time: 2382.3222s
	iters: 200, epoch: 21 | loss: 0.0020797
	speed: 0.1686s/iter; left time: 756.9827s
	iters: 300, epoch: 21 | loss: 0.0005905
	speed: 0.1476s/iter; left time: 648.2058s
	iters: 400, epoch: 21 | loss: 0.0008154
	speed: 0.0930s/iter; left time: 399.1296s
Epoch: 21 cost time: 69.43285059928894
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0024181
	speed: 0.4085s/iter; left time: 1683.7647s
	iters: 200, epoch: 22 | loss: 0.0015111
	speed: 0.1338s/iter; left time: 538.3100s
	iters: 300, epoch: 22 | loss: 0.9472963
	speed: 0.1157s/iter; left time: 453.6930s
	iters: 400, epoch: 22 | loss: 0.0063606
	speed: 0.1420s/iter; left time: 542.7196s
Epoch: 22 cost time: 58.01057720184326
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0070414
	speed: 0.4522s/iter; left time: 1651.9983s
	iters: 200, epoch: 23 | loss: 0.0009401
	speed: 0.2070s/iter; left time: 735.4481s
	iters: 300, epoch: 23 | loss: 0.0020390
	speed: 0.1680s/iter; left time: 580.1727s
	iters: 400, epoch: 23 | loss: 0.0137878
	speed: 0.2011s/iter; left time: 674.3389s
Epoch: 23 cost time: 84.89679861068726
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0004435
	speed: 0.4987s/iter; left time: 1587.9805s
	iters: 200, epoch: 24 | loss: 0.0031730
	speed: 0.1947s/iter; left time: 600.5435s
	iters: 300, epoch: 24 | loss: 0.0051568
	speed: 0.1838s/iter; left time: 548.5746s
	iters: 400, epoch: 24 | loss: 0.0014793
	speed: 0.1849s/iter; left time: 533.3116s
Epoch: 24 cost time: 85.89978647232056
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0192261
	speed: 0.5329s/iter; left time: 1446.8150s
	iters: 200, epoch: 25 | loss: 0.0018565
	speed: 0.1284s/iter; left time: 335.8027s
	iters: 300, epoch: 25 | loss: 0.0005040
	speed: 0.1292s/iter; left time: 324.9705s
	iters: 400, epoch: 25 | loss: 0.0011534
	speed: 0.1320s/iter; left time: 318.6702s
Epoch: 25 cost time: 65.76031708717346
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0032021
	speed: 0.3915s/iter; left time: 879.3834s
	iters: 200, epoch: 26 | loss: 0.0020295
	speed: 0.1491s/iter; left time: 319.9994s
	iters: 300, epoch: 26 | loss: 0.0052975
	speed: 0.1045s/iter; left time: 213.7748s
	iters: 400, epoch: 26 | loss: 0.0047280
	speed: 0.1408s/iter; left time: 274.0445s
Epoch: 26 cost time: 59.87543845176697
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0128937
	speed: 0.4108s/iter; left time: 729.9517s
	iters: 200, epoch: 27 | loss: 0.0034017
	speed: 0.1279s/iter; left time: 214.5479s
	iters: 300, epoch: 27 | loss: 0.0004068
	speed: 0.1266s/iter; left time: 199.6125s
	iters: 400, epoch: 27 | loss: 0.0058158
	speed: 0.1615s/iter; left time: 238.5891s
Epoch: 27 cost time: 68.3201916217804
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0032157
	speed: 0.4773s/iter; left time: 624.3352s
	iters: 200, epoch: 28 | loss: 0.0240181
	speed: 0.2036s/iter; left time: 246.0018s
	iters: 300, epoch: 28 | loss: 0.0011840
	speed: 0.1869s/iter; left time: 207.0600s
	iters: 400, epoch: 28 | loss: 0.0156576
	speed: 0.2093s/iter; left time: 210.9811s
Epoch: 28 cost time: 86.80225610733032
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0013802
	speed: 0.5480s/iter; left time: 459.7318s
	iters: 200, epoch: 29 | loss: 0.0030352
	speed: 0.2144s/iter; left time: 158.4654s
	iters: 300, epoch: 29 | loss: 0.0026442
	speed: 0.1818s/iter; left time: 116.1626s
	iters: 400, epoch: 29 | loss: 0.0011842
	speed: 0.1948s/iter; left time: 104.9844s
Epoch: 29 cost time: 92.8099000453949
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0013101
	speed: 0.5060s/iter; left time: 187.2073s
	iters: 200, epoch: 30 | loss: 0.0015447
	speed: 0.1555s/iter; left time: 41.9823s
	iters: 300, epoch: 30 | loss: 0.2139965
	speed: 0.1545s/iter; left time: 26.2689s
	iters: 400, epoch: 30 | loss: 0.0092087
	speed: 0.1432s/iter; left time: 10.0274s
Epoch: 30 cost time: 72.49180459976196
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 130250
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0674241
	speed: 0.1923s/iter; left time: 2686.1089s
	iters: 200, epoch: 1 | loss: 1.6519536
	speed: 0.1489s/iter; left time: 2065.4453s
	iters: 300, epoch: 1 | loss: 1.3588852
	speed: 0.1667s/iter; left time: 2294.9884s
	iters: 400, epoch: 1 | loss: 0.5680088
	speed: 0.1500s/iter; left time: 2051.2109s
Epoch: 1 cost time: 74.59747624397278
Epoch: 1, Steps: 469 | Train Loss: 1.411 Vali Loss: 0.623 Vali Acc: 0.854 Test Loss: 0.623 Test Acc: 0.854
Validation loss decreased (inf --> -0.853624).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3585958
	speed: 0.5221s/iter; left time: 7049.7583s
	iters: 200, epoch: 2 | loss: 0.3333538
	speed: 0.2205s/iter; left time: 2955.6181s
	iters: 300, epoch: 2 | loss: 0.2911469
	speed: 0.2251s/iter; left time: 2994.1478s
	iters: 400, epoch: 2 | loss: 0.1680073
	speed: 0.1965s/iter; left time: 2594.4499s
Epoch: 2 cost time: 102.144113779068
Epoch: 2, Steps: 469 | Train Loss: 0.337 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
Validation loss decreased (-0.853624 --> -0.927385).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1475534
	speed: 0.6217s/iter; left time: 8102.0841s
	iters: 200, epoch: 3 | loss: 0.0616448
	speed: 0.2039s/iter; left time: 2636.6010s
	iters: 300, epoch: 3 | loss: 0.2507127
	speed: 0.2337s/iter; left time: 2999.1623s
	iters: 400, epoch: 3 | loss: 0.4100002
	speed: 0.2054s/iter; left time: 2615.6511s
Epoch: 3 cost time: 103.30432844161987
Epoch: 3, Steps: 469 | Train Loss: 0.146 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.927385 --> -0.955401).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1691110
	speed: 0.4630s/iter; left time: 5817.3599s
	iters: 200, epoch: 4 | loss: 0.0265521
	speed: 0.1077s/iter; left time: 1341.9169s
	iters: 300, epoch: 4 | loss: 0.1234281
	speed: 0.1326s/iter; left time: 1639.8809s
	iters: 400, epoch: 4 | loss: 0.0184478
	speed: 0.1432s/iter; left time: 1755.9334s
Epoch: 4 cost time: 56.17441201210022
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.955401 --> -0.967981).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0373554
	speed: 0.3965s/iter; left time: 4795.1893s
	iters: 200, epoch: 5 | loss: 0.0206760
	speed: 0.1391s/iter; left time: 1668.6703s
	iters: 300, epoch: 5 | loss: 0.0124442
	speed: 0.1332s/iter; left time: 1583.9014s
	iters: 400, epoch: 5 | loss: 0.0655748
	speed: 0.1474s/iter; left time: 1738.4993s
Epoch: 5 cost time: 63.56206560134888
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0402659
	speed: 0.3856s/iter; left time: 4482.8882s
	iters: 200, epoch: 6 | loss: 0.0130490
	speed: 0.1857s/iter; left time: 2140.9090s
	iters: 300, epoch: 6 | loss: 0.0265278
	speed: 0.1963s/iter; left time: 2242.8878s
	iters: 400, epoch: 6 | loss: 0.0302946
	speed: 0.1752s/iter; left time: 1984.1858s
Epoch: 6 cost time: 79.91370487213135
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.967981 --> -0.972555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0612134
	speed: 0.4990s/iter; left time: 5567.5828s
	iters: 200, epoch: 7 | loss: 0.0027524
	speed: 0.1657s/iter; left time: 1832.6832s
	iters: 300, epoch: 7 | loss: 0.0258716
	speed: 0.1822s/iter; left time: 1996.7555s
	iters: 400, epoch: 7 | loss: 0.0471504
	speed: 0.1723s/iter; left time: 1871.0805s
Epoch: 7 cost time: 79.29607200622559
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.973984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0253175
	speed: 0.4812s/iter; left time: 5143.4615s
	iters: 200, epoch: 8 | loss: 0.0046405
	speed: 0.1521s/iter; left time: 1610.2240s
	iters: 300, epoch: 8 | loss: 0.0057319
	speed: 0.1266s/iter; left time: 1327.2829s
	iters: 400, epoch: 8 | loss: 0.0030706
	speed: 0.1193s/iter; left time: 1239.0345s
Epoch: 8 cost time: 65.21959447860718
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.973984 --> -0.978272).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1958619
	speed: 0.3859s/iter; left time: 3943.2881s
	iters: 200, epoch: 9 | loss: 0.2273912
	speed: 0.1126s/iter; left time: 1138.9061s
	iters: 300, epoch: 9 | loss: 0.0172029
	speed: 0.1291s/iter; left time: 1293.2435s
	iters: 400, epoch: 9 | loss: 0.0024806
	speed: 0.1007s/iter; left time: 999.0151s
Epoch: 9 cost time: 56.807578563690186
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.978272 --> -0.981703).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0038623
	speed: 0.3922s/iter; left time: 3824.3096s
	iters: 200, epoch: 10 | loss: 0.0054316
	speed: 0.1264s/iter; left time: 1219.9053s
	iters: 300, epoch: 10 | loss: 0.0108821
	speed: 0.0975s/iter; left time: 931.0030s
	iters: 400, epoch: 10 | loss: 0.0363124
	speed: 0.1749s/iter; left time: 1653.2524s
Epoch: 10 cost time: 63.452423334121704
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3590999
	speed: 0.4921s/iter; left time: 4567.4272s
	iters: 200, epoch: 11 | loss: 0.0739707
	speed: 0.1739s/iter; left time: 1596.2856s
	iters: 300, epoch: 11 | loss: 0.0104804
	speed: 0.1718s/iter; left time: 1560.0831s
	iters: 400, epoch: 11 | loss: 0.0146585
	speed: 0.1670s/iter; left time: 1499.7246s
Epoch: 11 cost time: 81.36949372291565
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0022497
	speed: 0.4416s/iter; left time: 3891.7131s
	iters: 200, epoch: 12 | loss: 0.0106918
	speed: 0.2430s/iter; left time: 2117.2402s
	iters: 300, epoch: 12 | loss: 0.0034118
	speed: 0.1999s/iter; left time: 1721.9432s
	iters: 400, epoch: 12 | loss: 0.0056370
	speed: 0.2112s/iter; left time: 1798.0378s
Epoch: 12 cost time: 90.54728484153748
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.983133).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0028831
	speed: 0.4967s/iter; left time: 4143.7027s
	iters: 200, epoch: 13 | loss: 0.0034444
	speed: 0.1489s/iter; left time: 1227.1366s
	iters: 300, epoch: 13 | loss: 0.0202351
	speed: 0.1146s/iter; left time: 933.4010s
	iters: 400, epoch: 13 | loss: 0.0017705
	speed: 0.1609s/iter; left time: 1294.2000s
Epoch: 13 cost time: 72.67392373085022
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0229805
	speed: 0.4871s/iter; left time: 3835.5953s
	iters: 200, epoch: 14 | loss: 0.0022378
	speed: 0.1552s/iter; left time: 1206.2256s
	iters: 300, epoch: 14 | loss: 0.0118210
	speed: 0.1436s/iter; left time: 1101.6457s
	iters: 400, epoch: 14 | loss: 0.0017941
	speed: 0.1794s/iter; left time: 1358.8876s
Epoch: 14 cost time: 79.39809203147888
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.983133 --> -0.985420).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0004847
	speed: 0.5916s/iter; left time: 4380.6364s
	iters: 200, epoch: 15 | loss: 0.0033396
	speed: 0.1961s/iter; left time: 1432.8273s
	iters: 300, epoch: 15 | loss: 0.1784827
	speed: 0.2315s/iter; left time: 1667.6735s
	iters: 400, epoch: 15 | loss: 0.0029049
	speed: 0.2257s/iter; left time: 1603.7111s
Epoch: 15 cost time: 103.23164319992065
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0656336
	speed: 0.5852s/iter; left time: 4059.0719s
	iters: 200, epoch: 16 | loss: 0.0037903
	speed: 0.2187s/iter; left time: 1495.1424s
	iters: 300, epoch: 16 | loss: 0.0154343
	speed: 0.2350s/iter; left time: 1582.9031s
	iters: 400, epoch: 16 | loss: 0.0038136
	speed: 0.1985s/iter; left time: 1317.2606s
Epoch: 16 cost time: 104.05359745025635
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0023241
	speed: 0.5043s/iter; left time: 3261.3513s
	iters: 200, epoch: 17 | loss: 0.0154309
	speed: 0.1759s/iter; left time: 1120.2418s
	iters: 300, epoch: 17 | loss: 0.0703113
	speed: 0.1693s/iter; left time: 1060.7753s
	iters: 400, epoch: 17 | loss: 0.0049276
	speed: 0.1315s/iter; left time: 811.0314s
Epoch: 17 cost time: 73.15571999549866
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0018157
	speed: 0.4657s/iter; left time: 2793.3096s
	iters: 200, epoch: 18 | loss: 0.0029367
	speed: 0.1867s/iter; left time: 1101.2780s
	iters: 300, epoch: 18 | loss: 0.0016587
	speed: 0.1701s/iter; left time: 986.4561s
	iters: 400, epoch: 18 | loss: 0.0025686
	speed: 0.1301s/iter; left time: 741.5170s
Epoch: 18 cost time: 76.01654529571533
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0022274
	speed: 0.4945s/iter; left time: 2734.1080s
	iters: 200, epoch: 19 | loss: 0.1498093
	speed: 0.1790s/iter; left time: 971.9595s
	iters: 300, epoch: 19 | loss: 0.0016905
	speed: 0.1549s/iter; left time: 825.5369s
	iters: 400, epoch: 19 | loss: 0.0007842
	speed: 0.1848s/iter; left time: 966.1422s
Epoch: 19 cost time: 80.67689228057861
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0039093
	speed: 0.5294s/iter; left time: 2678.6714s
	iters: 200, epoch: 20 | loss: 0.0492357
	speed: 0.1795s/iter; left time: 890.4650s
	iters: 300, epoch: 20 | loss: 0.0003086
	speed: 0.2038s/iter; left time: 990.2580s
	iters: 400, epoch: 20 | loss: 0.0010818
	speed: 0.1601s/iter; left time: 762.2850s
Epoch: 20 cost time: 86.42724967002869
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0005767
	speed: 0.5150s/iter; left time: 2364.3057s
	iters: 200, epoch: 21 | loss: 0.0010851
	speed: 0.1364s/iter; left time: 612.4638s
	iters: 300, epoch: 21 | loss: 0.0123788
	speed: 0.1255s/iter; left time: 551.2114s
	iters: 400, epoch: 21 | loss: 0.1846346
	speed: 0.1113s/iter; left time: 477.5061s
Epoch: 21 cost time: 63.204577684402466
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1977222
	speed: 0.3619s/iter; left time: 1491.8567s
	iters: 200, epoch: 22 | loss: 0.0029926
	speed: 0.1263s/iter; left time: 508.0199s
	iters: 300, epoch: 22 | loss: 0.0006269
	speed: 0.0990s/iter; left time: 388.2262s
	iters: 400, epoch: 22 | loss: 0.1156611
	speed: 0.1238s/iter; left time: 473.1315s
Epoch: 22 cost time: 54.71711230278015
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0006219
	speed: 0.3813s/iter; left time: 1392.7129s
	iters: 200, epoch: 23 | loss: 0.0044723
	speed: 0.1095s/iter; left time: 388.8860s
	iters: 300, epoch: 23 | loss: 0.0006625
	speed: 0.1366s/iter; left time: 471.7249s
	iters: 400, epoch: 23 | loss: 0.0045207
	speed: 0.1308s/iter; left time: 438.6043s
Epoch: 23 cost time: 63.81140494346619
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0004632
	speed: 0.5249s/iter; left time: 1671.4333s
	iters: 200, epoch: 24 | loss: 0.0018124
	speed: 0.1743s/iter; left time: 537.5974s
	iters: 300, epoch: 24 | loss: 0.0007445
	speed: 0.1870s/iter; left time: 557.9043s
	iters: 400, epoch: 24 | loss: 0.0014781
	speed: 0.1786s/iter; left time: 514.9450s
Epoch: 24 cost time: 85.60182356834412
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 440762
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1128690
	speed: 0.1414s/iter; left time: 1975.2981s
	iters: 200, epoch: 1 | loss: 1.6896658
	speed: 0.1313s/iter; left time: 1821.6965s
	iters: 300, epoch: 1 | loss: 1.1343074
	speed: 0.1181s/iter; left time: 1626.2477s
	iters: 400, epoch: 1 | loss: 0.5633891
	speed: 0.1397s/iter; left time: 1910.2409s
Epoch: 1 cost time: 61.45789837837219
Epoch: 1, Steps: 469 | Train Loss: 1.492 Vali Loss: 0.644 Vali Acc: 0.859 Test Loss: 0.644 Test Acc: 0.859
Validation loss decreased (inf --> -0.858770).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3857034
	speed: 0.3420s/iter; left time: 4617.5281s
	iters: 200, epoch: 2 | loss: 0.2862156
	speed: 0.0713s/iter; left time: 955.8731s
	iters: 300, epoch: 2 | loss: 0.5957508
	speed: 0.0933s/iter; left time: 1241.4322s
	iters: 400, epoch: 2 | loss: 0.3427089
	speed: 0.0935s/iter; left time: 1234.4509s
Epoch: 2 cost time: 41.05017399787903
Epoch: 2, Steps: 469 | Train Loss: 0.358 Vali Loss: 0.272 Vali Acc: 0.903 Test Loss: 0.272 Test Acc: 0.903
Validation loss decreased (-0.858770 --> -0.902799).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2226757
	speed: 0.2774s/iter; left time: 3615.6854s
	iters: 200, epoch: 3 | loss: 0.0910304
	speed: 0.0545s/iter; left time: 704.3985s
	iters: 300, epoch: 3 | loss: 0.2245378
	speed: 0.1239s/iter; left time: 1589.6598s
	iters: 400, epoch: 3 | loss: 0.0581123
	speed: 0.0942s/iter; left time: 1200.0068s
Epoch: 3 cost time: 39.389384269714355
Epoch: 3, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
Validation loss decreased (-0.902799 --> -0.943394).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4960996
	speed: 0.3416s/iter; left time: 4291.7100s
	iters: 200, epoch: 4 | loss: 0.3067719
	speed: 0.0836s/iter; left time: 1042.5691s
	iters: 300, epoch: 4 | loss: 0.0088675
	speed: 0.1131s/iter; left time: 1398.0809s
	iters: 400, epoch: 4 | loss: 0.2525872
	speed: 0.1026s/iter; left time: 1258.4560s
Epoch: 4 cost time: 49.15632915496826
Epoch: 4, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0672285
	speed: 0.4213s/iter; left time: 5095.2392s
	iters: 200, epoch: 5 | loss: 0.1591823
	speed: 0.1420s/iter; left time: 1702.9867s
	iters: 300, epoch: 5 | loss: 0.0564762
	speed: 0.1682s/iter; left time: 2000.3049s
	iters: 400, epoch: 5 | loss: 0.0163709
	speed: 0.1457s/iter; left time: 1718.0055s
Epoch: 5 cost time: 68.98304843902588
Epoch: 5, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.207 Vali Acc: 0.932 Test Loss: 0.207 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0118732
	speed: 0.4810s/iter; left time: 5591.7985s
	iters: 200, epoch: 6 | loss: 0.0646233
	speed: 0.1523s/iter; left time: 1755.5367s
	iters: 300, epoch: 6 | loss: 0.0087911
	speed: 0.1615s/iter; left time: 1845.7495s
	iters: 400, epoch: 6 | loss: 0.0089990
	speed: 0.1443s/iter; left time: 1634.1971s
Epoch: 6 cost time: 71.1961600780487
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.943394 --> -0.969696).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1792372
	speed: 0.4692s/iter; left time: 5235.1319s
	iters: 200, epoch: 7 | loss: 0.0262467
	speed: 0.1669s/iter; left time: 1845.1239s
	iters: 300, epoch: 7 | loss: 0.0589984
	speed: 0.1543s/iter; left time: 1690.6947s
	iters: 400, epoch: 7 | loss: 0.0582421
	speed: 0.1108s/iter; left time: 1203.1023s
Epoch: 7 cost time: 67.37197589874268
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0086939
	speed: 0.4025s/iter; left time: 4302.2042s
	iters: 200, epoch: 8 | loss: 0.0998627
	speed: 0.1444s/iter; left time: 1529.2386s
	iters: 300, epoch: 8 | loss: 0.2662821
	speed: 0.0983s/iter; left time: 1030.5302s
	iters: 400, epoch: 8 | loss: 0.0710790
	speed: 0.1043s/iter; left time: 1083.0458s
Epoch: 8 cost time: 55.66551995277405
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.971411).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0687483
	speed: 0.4146s/iter; left time: 4236.7982s
	iters: 200, epoch: 9 | loss: 0.0815524
	speed: 0.1279s/iter; left time: 1294.4893s
	iters: 300, epoch: 9 | loss: 0.0561718
	speed: 0.1038s/iter; left time: 1040.2881s
	iters: 400, epoch: 9 | loss: 0.0101747
	speed: 0.1183s/iter; left time: 1172.9648s
Epoch: 9 cost time: 57.356342792510986
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971697).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0093004
	speed: 0.3955s/iter; left time: 3856.4746s
	iters: 200, epoch: 10 | loss: 0.0147376
	speed: 0.1272s/iter; left time: 1227.7627s
	iters: 300, epoch: 10 | loss: 0.0153442
	speed: 0.1448s/iter; left time: 1382.5540s
	iters: 400, epoch: 10 | loss: 0.0022970
	speed: 0.1494s/iter; left time: 1412.0580s
Epoch: 10 cost time: 65.85533618927002
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.973984).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0090311
	speed: 0.5039s/iter; left time: 4676.3237s
	iters: 200, epoch: 11 | loss: 0.0015560
	speed: 0.1526s/iter; left time: 1401.0152s
	iters: 300, epoch: 11 | loss: 0.1605886
	speed: 0.1472s/iter; left time: 1337.1064s
	iters: 400, epoch: 11 | loss: 0.0085297
	speed: 0.1708s/iter; left time: 1534.2191s
Epoch: 11 cost time: 74.33179831504822
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975128).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0049948
	speed: 0.4865s/iter; left time: 4287.2949s
	iters: 200, epoch: 12 | loss: 0.0238834
	speed: 0.1533s/iter; left time: 1335.1666s
	iters: 300, epoch: 12 | loss: 0.0021216
	speed: 0.1382s/iter; left time: 1190.4141s
	iters: 400, epoch: 12 | loss: 0.1766386
	speed: 0.1147s/iter; left time: 976.0664s
Epoch: 12 cost time: 65.85668277740479
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0035138
	speed: 0.4301s/iter; left time: 3587.9679s
	iters: 200, epoch: 13 | loss: 0.0011555
	speed: 0.0965s/iter; left time: 795.7745s
	iters: 300, epoch: 13 | loss: 0.2870744
	speed: 0.0862s/iter; left time: 701.5930s
	iters: 400, epoch: 13 | loss: 0.0035548
	speed: 0.1175s/iter; left time: 945.3169s
Epoch: 13 cost time: 50.39017605781555
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.977415).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0230093
	speed: 0.2912s/iter; left time: 2292.7710s
	iters: 200, epoch: 14 | loss: 0.0027035
	speed: 0.0741s/iter; left time: 575.8950s
	iters: 300, epoch: 14 | loss: 0.0280176
	speed: 0.1041s/iter; left time: 799.1614s
	iters: 400, epoch: 14 | loss: 0.0026609
	speed: 0.0736s/iter; left time: 557.5234s
Epoch: 14 cost time: 36.31611633300781
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0058281
	speed: 0.2877s/iter; left time: 2130.7574s
	iters: 200, epoch: 15 | loss: 0.0036261
	speed: 0.1023s/iter; left time: 747.0456s
	iters: 300, epoch: 15 | loss: 0.0039151
	speed: 0.0802s/iter; left time: 577.4816s
	iters: 400, epoch: 15 | loss: 0.0019875
	speed: 0.0772s/iter; left time: 548.4426s
Epoch: 15 cost time: 40.76219344139099
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981703).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0028486
	speed: 0.3322s/iter; left time: 2303.8617s
	iters: 200, epoch: 16 | loss: 0.0167509
	speed: 0.1174s/iter; left time: 802.3213s
	iters: 300, epoch: 16 | loss: 0.0028425
	speed: 0.1260s/iter; left time: 848.4019s
	iters: 400, epoch: 16 | loss: 0.2189258
	speed: 0.1248s/iter; left time: 827.9427s
Epoch: 16 cost time: 55.314268589019775
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.981703 --> -0.984848).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0023242
	speed: 0.4019s/iter; left time: 2598.8388s
	iters: 200, epoch: 17 | loss: 0.0349797
	speed: 0.1220s/iter; left time: 776.7138s
	iters: 300, epoch: 17 | loss: 0.0037373
	speed: 0.1295s/iter; left time: 811.4390s
	iters: 400, epoch: 17 | loss: 0.0007353
	speed: 0.1227s/iter; left time: 756.5841s
Epoch: 17 cost time: 59.01401352882385
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0028590
	speed: 0.4065s/iter; left time: 2437.9152s
	iters: 200, epoch: 18 | loss: 0.0013778
	speed: 0.1267s/iter; left time: 747.2375s
	iters: 300, epoch: 18 | loss: 0.0010624
	speed: 0.1224s/iter; left time: 709.8628s
	iters: 400, epoch: 18 | loss: 0.0338479
	speed: 0.1323s/iter; left time: 754.0346s
Epoch: 18 cost time: 59.169793367385864
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1256797
	speed: 0.3547s/iter; left time: 1961.1340s
	iters: 200, epoch: 19 | loss: 0.0011913
	speed: 0.0874s/iter; left time: 474.5838s
	iters: 300, epoch: 19 | loss: 0.0010499
	speed: 0.0634s/iter; left time: 337.6021s
	iters: 400, epoch: 19 | loss: 0.0017076
	speed: 0.0560s/iter; left time: 292.9128s
Epoch: 19 cost time: 36.07113742828369
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0132014
	speed: 0.3512s/iter; left time: 1777.1707s
	iters: 200, epoch: 20 | loss: 0.0020094
	speed: 0.0992s/iter; left time: 492.1301s
	iters: 300, epoch: 20 | loss: 0.0234551
	speed: 0.0779s/iter; left time: 378.6862s
	iters: 400, epoch: 20 | loss: 0.0044160
	speed: 0.1106s/iter; left time: 526.2365s
Epoch: 20 cost time: 46.129833936691284
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0422865
	speed: 0.3423s/iter; left time: 1571.5948s
	iters: 200, epoch: 21 | loss: 0.0005679
	speed: 0.0900s/iter; left time: 404.3839s
	iters: 300, epoch: 21 | loss: 0.0011030
	speed: 0.1056s/iter; left time: 463.7489s
	iters: 400, epoch: 21 | loss: 0.0006098
	speed: 0.0707s/iter; left time: 303.1754s
Epoch: 21 cost time: 42.03703212738037
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0011931
	speed: 0.3681s/iter; left time: 1517.3014s
	iters: 200, epoch: 22 | loss: 0.0010252
	speed: 0.1434s/iter; left time: 576.7655s
	iters: 300, epoch: 22 | loss: 0.4238119
	speed: 0.1240s/iter; left time: 486.4127s
	iters: 400, epoch: 22 | loss: 0.0059479
	speed: 0.1519s/iter; left time: 580.6391s
Epoch: 22 cost time: 63.912556886672974
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0048619
	speed: 0.4161s/iter; left time: 1519.9924s
	iters: 200, epoch: 23 | loss: 0.0007942
	speed: 0.1499s/iter; left time: 532.4201s
	iters: 300, epoch: 23 | loss: 0.0029188
	speed: 0.1256s/iter; left time: 433.7676s
	iters: 400, epoch: 23 | loss: 0.0090030
	speed: 0.1399s/iter; left time: 468.9740s
Epoch: 23 cost time: 63.61730909347534
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0097331
	speed: 0.4359s/iter; left time: 1388.0333s
	iters: 200, epoch: 24 | loss: 0.0007233
	speed: 0.1267s/iter; left time: 390.8374s
	iters: 300, epoch: 24 | loss: 0.0011281
	speed: 0.1455s/iter; left time: 434.2299s
	iters: 400, epoch: 24 | loss: 0.0010609
	speed: 0.1172s/iter; left time: 337.9925s
Epoch: 24 cost time: 63.380658864974976
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0063374
	speed: 0.3747s/iter; left time: 1017.2160s
	iters: 200, epoch: 25 | loss: 0.0010916
	speed: 0.0637s/iter; left time: 166.5283s
	iters: 300, epoch: 25 | loss: 0.0005317
	speed: 0.0686s/iter; left time: 172.6225s
	iters: 400, epoch: 25 | loss: 0.0020112
	speed: 0.0932s/iter; left time: 224.9817s
Epoch: 25 cost time: 37.61829614639282
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0026060
	speed: 0.3145s/iter; left time: 706.4432s
	iters: 200, epoch: 26 | loss: 0.0039080
	speed: 0.0656s/iter; left time: 140.8143s
	iters: 300, epoch: 26 | loss: 0.0315054
	speed: 0.0909s/iter; left time: 186.0711s
	iters: 400, epoch: 26 | loss: 0.0088282
	speed: 0.0848s/iter; left time: 165.0823s
Epoch: 26 cost time: 39.07608079910278
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 130250
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1009126
	speed: 0.0975s/iter; left time: 1362.2892s
	iters: 200, epoch: 1 | loss: 1.7507941
	speed: 0.0671s/iter; left time: 931.3893s
	iters: 300, epoch: 1 | loss: 1.4671769
	speed: 0.0759s/iter; left time: 1045.1826s
	iters: 400, epoch: 1 | loss: 0.6844715
	speed: 0.1102s/iter; left time: 1506.4418s
Epoch: 1 cost time: 41.58103704452515
Epoch: 1, Steps: 469 | Train Loss: 1.503 Vali Loss: 0.753 Vali Acc: 0.812 Test Loss: 0.753 Test Acc: 0.812
Validation loss decreased (inf --> -0.811885).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4001226
	speed: 0.3463s/iter; left time: 4675.9449s
	iters: 200, epoch: 2 | loss: 0.4842886
	speed: 0.1069s/iter; left time: 1433.0433s
	iters: 300, epoch: 2 | loss: 0.2154607
	speed: 0.1044s/iter; left time: 1388.4792s
	iters: 400, epoch: 2 | loss: 0.2236183
	speed: 0.1018s/iter; left time: 1344.1509s
Epoch: 2 cost time: 48.778608560562134
Epoch: 2, Steps: 469 | Train Loss: 0.422 Vali Loss: 0.318 Vali Acc: 0.903 Test Loss: 0.318 Test Acc: 0.903
Validation loss decreased (-0.811885 --> -0.903370).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1840041
	speed: 0.3580s/iter; left time: 4665.9872s
	iters: 200, epoch: 3 | loss: 0.0865489
	speed: 0.1022s/iter; left time: 1321.7861s
	iters: 300, epoch: 3 | loss: 0.2355849
	speed: 0.0986s/iter; left time: 1264.9413s
	iters: 400, epoch: 3 | loss: 0.3495805
	speed: 0.1118s/iter; left time: 1423.2526s
Epoch: 3 cost time: 49.03661012649536
Epoch: 3, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.903370 --> -0.957403).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1689119
	speed: 0.3487s/iter; left time: 4380.6638s
	iters: 200, epoch: 4 | loss: 0.0609137
	speed: 0.1024s/iter; left time: 1276.5213s
	iters: 300, epoch: 4 | loss: 0.1537465
	speed: 0.1061s/iter; left time: 1312.3334s
	iters: 400, epoch: 4 | loss: 0.0356218
	speed: 0.1002s/iter; left time: 1229.1317s
Epoch: 4 cost time: 45.926337480545044
Epoch: 4, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.957403 --> -0.961977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0494796
	speed: 0.2593s/iter; left time: 3136.3556s
	iters: 200, epoch: 5 | loss: 0.0804235
	speed: 0.0695s/iter; left time: 833.2185s
	iters: 300, epoch: 5 | loss: 0.0080130
	speed: 0.0530s/iter; left time: 630.1760s
	iters: 400, epoch: 5 | loss: 0.0329432
	speed: 0.0626s/iter; left time: 738.6511s
Epoch: 5 cost time: 34.07754707336426
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.963 Test Loss: 0.108 Test Acc: 0.963
Validation loss decreased (-0.961977 --> -0.962835).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0208081
	speed: 0.3787s/iter; left time: 4402.2349s
	iters: 200, epoch: 6 | loss: 0.0391471
	speed: 0.0701s/iter; left time: 808.2728s
	iters: 300, epoch: 6 | loss: 0.0346772
	speed: 0.0964s/iter; left time: 1101.5647s
	iters: 400, epoch: 6 | loss: 0.0467123
	speed: 0.1296s/iter; left time: 1468.3762s
Epoch: 6 cost time: 46.51374673843384
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
Validation loss decreased (-0.962835 --> -0.971697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0662849
	speed: 0.3461s/iter; left time: 3861.6305s
	iters: 200, epoch: 7 | loss: 0.0039003
	speed: 0.1303s/iter; left time: 1440.7962s
	iters: 300, epoch: 7 | loss: 0.0322480
	speed: 0.1129s/iter; left time: 1236.6607s
	iters: 400, epoch: 7 | loss: 0.0539754
	speed: 0.0909s/iter; left time: 986.8244s
Epoch: 7 cost time: 49.32924938201904
Epoch: 7, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0806992
	speed: 0.4189s/iter; left time: 4476.7972s
	iters: 200, epoch: 8 | loss: 0.0050417
	speed: 0.1271s/iter; left time: 1345.5671s
	iters: 300, epoch: 8 | loss: 0.0234936
	speed: 0.1216s/iter; left time: 1275.4234s
	iters: 400, epoch: 8 | loss: 0.0045504
	speed: 0.1397s/iter; left time: 1451.3073s
Epoch: 8 cost time: 64.8986086845398
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.971697 --> -0.977987).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2076142
	speed: 0.4428s/iter; left time: 4524.9589s
	iters: 200, epoch: 9 | loss: 0.2294769
	speed: 0.1406s/iter; left time: 1423.0618s
	iters: 300, epoch: 9 | loss: 0.0248915
	speed: 0.1515s/iter; left time: 1517.7245s
	iters: 400, epoch: 9 | loss: 0.0141898
	speed: 0.1326s/iter; left time: 1315.3808s
Epoch: 9 cost time: 63.34179329872131
Epoch: 9, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0133140
	speed: 0.4540s/iter; left time: 4426.2898s
	iters: 200, epoch: 10 | loss: 0.0068739
	speed: 0.1355s/iter; left time: 1307.4093s
	iters: 300, epoch: 10 | loss: 0.0180090
	speed: 0.1240s/iter; left time: 1184.2813s
	iters: 400, epoch: 10 | loss: 0.0194783
	speed: 0.1331s/iter; left time: 1257.8575s
Epoch: 10 cost time: 65.53062891960144
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.977987 --> -0.979130).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3836438
	speed: 0.4317s/iter; left time: 4006.2497s
	iters: 200, epoch: 11 | loss: 0.1159416
	speed: 0.0946s/iter; left time: 868.8053s
	iters: 300, epoch: 11 | loss: 0.0086006
	speed: 0.1308s/iter; left time: 1187.4996s
	iters: 400, epoch: 11 | loss: 0.0032580
	speed: 0.1139s/iter; left time: 1022.6411s
Epoch: 11 cost time: 50.79986500740051
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0082472
	speed: 0.3694s/iter; left time: 3254.9246s
	iters: 200, epoch: 12 | loss: 0.0078354
	speed: 0.1221s/iter; left time: 1063.9343s
	iters: 300, epoch: 12 | loss: 0.0037506
	speed: 0.0954s/iter; left time: 821.1602s
	iters: 400, epoch: 12 | loss: 0.0054018
	speed: 0.0790s/iter; left time: 672.2827s
Epoch: 12 cost time: 48.638938903808594
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0089743
	speed: 0.3686s/iter; left time: 3075.6133s
	iters: 200, epoch: 13 | loss: 0.0034874
	speed: 0.0911s/iter; left time: 750.7396s
	iters: 300, epoch: 13 | loss: 0.0109816
	speed: 0.0899s/iter; left time: 732.4410s
	iters: 400, epoch: 13 | loss: 0.0071662
	speed: 0.1201s/iter; left time: 965.9350s
Epoch: 13 cost time: 49.37385106086731
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0821319
	speed: 0.3591s/iter; left time: 2827.4230s
	iters: 200, epoch: 14 | loss: 0.0036972
	speed: 0.0841s/iter; left time: 653.6727s
	iters: 300, epoch: 14 | loss: 0.2330185
	speed: 0.1218s/iter; left time: 934.3904s
	iters: 400, epoch: 14 | loss: 0.0036314
	speed: 0.1154s/iter; left time: 874.0261s
Epoch: 14 cost time: 47.8495671749115
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.979130 --> -0.982847).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0007330
	speed: 0.3864s/iter; left time: 2861.4221s
	iters: 200, epoch: 15 | loss: 0.0096919
	speed: 0.1133s/iter; left time: 827.7843s
	iters: 300, epoch: 15 | loss: 0.0114468
	speed: 0.1022s/iter; left time: 736.2297s
	iters: 400, epoch: 15 | loss: 0.0015704
	speed: 0.0718s/iter; left time: 510.4703s
Epoch: 15 cost time: 46.28861904144287
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0022501
	speed: 0.2283s/iter; left time: 1583.8129s
	iters: 200, epoch: 16 | loss: 0.0526585
	speed: 0.0973s/iter; left time: 665.1568s
	iters: 300, epoch: 16 | loss: 0.0034766
	speed: 0.0936s/iter; left time: 630.1916s
	iters: 400, epoch: 16 | loss: 0.0030675
	speed: 0.1265s/iter; left time: 839.6692s
Epoch: 16 cost time: 46.3264901638031
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0036284
	speed: 0.3529s/iter; left time: 2282.0403s
	iters: 200, epoch: 17 | loss: 0.0063490
	speed: 0.1297s/iter; left time: 825.5916s
	iters: 300, epoch: 17 | loss: 0.2293375
	speed: 0.1287s/iter; left time: 806.4328s
	iters: 400, epoch: 17 | loss: 0.0268775
	speed: 0.0939s/iter; left time: 578.9144s
Epoch: 17 cost time: 51.71337413787842
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0017547
	speed: 0.3145s/iter; left time: 1886.5872s
	iters: 200, epoch: 18 | loss: 0.0019055
	speed: 0.0685s/iter; left time: 403.9121s
	iters: 300, epoch: 18 | loss: 0.0015519
	speed: 0.0687s/iter; left time: 398.0773s
	iters: 400, epoch: 18 | loss: 0.0124677
	speed: 0.0602s/iter; left time: 343.1346s
Epoch: 18 cost time: 33.7550630569458
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0067159
	speed: 0.2834s/iter; left time: 1567.1461s
	iters: 200, epoch: 19 | loss: 0.0282113
	speed: 0.0673s/iter; left time: 365.4946s
	iters: 300, epoch: 19 | loss: 0.0084788
	speed: 0.0578s/iter; left time: 307.8833s
	iters: 400, epoch: 19 | loss: 0.0079856
	speed: 0.0696s/iter; left time: 363.7035s
Epoch: 19 cost time: 34.334174394607544
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0028415
	speed: 0.3422s/iter; left time: 1731.4716s
	iters: 200, epoch: 20 | loss: 0.0405802
	speed: 0.0925s/iter; left time: 458.9040s
	iters: 300, epoch: 20 | loss: 0.0044100
	speed: 0.1333s/iter; left time: 647.6061s
	iters: 400, epoch: 20 | loss: 0.0012867
	speed: 0.1282s/iter; left time: 610.0215s
Epoch: 20 cost time: 52.407150983810425
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0005017
	speed: 0.3658s/iter; left time: 1679.6153s
	iters: 200, epoch: 21 | loss: 0.0012839
	speed: 0.1295s/iter; left time: 581.7313s
	iters: 300, epoch: 21 | loss: 0.0365831
	speed: 0.0954s/iter; left time: 418.9287s
	iters: 400, epoch: 21 | loss: 0.0056066
	speed: 0.0567s/iter; left time: 243.3809s
Epoch: 21 cost time: 45.35182046890259
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0055781
	speed: 0.3056s/iter; left time: 1259.7271s
	iters: 200, epoch: 22 | loss: 0.0023454
	speed: 0.0609s/iter; left time: 245.0288s
	iters: 300, epoch: 22 | loss: 0.0092889
	speed: 0.0622s/iter; left time: 244.0329s
	iters: 400, epoch: 22 | loss: 0.3678384
	speed: 0.0633s/iter; left time: 242.0982s
Epoch: 22 cost time: 33.324862480163574
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0015408
	speed: 0.1794s/iter; left time: 655.4638s
	iters: 200, epoch: 23 | loss: 0.0017239
	speed: 0.0358s/iter; left time: 127.0292s
	iters: 300, epoch: 23 | loss: 0.0077565
	speed: 0.0721s/iter; left time: 249.0084s
	iters: 400, epoch: 23 | loss: 0.0009647
	speed: 0.0693s/iter; left time: 232.4741s
Epoch: 23 cost time: 26.73220729827881
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0007712
	speed: 0.3115s/iter; left time: 991.9240s
	iters: 200, epoch: 24 | loss: 0.0482973
	speed: 0.0741s/iter; left time: 228.5180s
	iters: 300, epoch: 24 | loss: 0.0005221
	speed: 0.0775s/iter; left time: 231.4028s
	iters: 400, epoch: 24 | loss: 0.0017781
	speed: 0.1016s/iter; left time: 292.9202s
Epoch: 24 cost time: 42.997432470321655
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 440762
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1220191
	speed: 0.0515s/iter; left time: 719.1879s
	iters: 200, epoch: 1 | loss: 1.7169354
	speed: 0.0366s/iter; left time: 507.3935s
	iters: 300, epoch: 1 | loss: 1.2809341
	speed: 0.0435s/iter; left time: 598.6511s
	iters: 400, epoch: 1 | loss: 0.7446518
	speed: 0.0470s/iter; left time: 641.8646s
Epoch: 1 cost time: 21.44930648803711
Epoch: 1, Steps: 469 | Train Loss: 1.589 Vali Loss: 0.882 Vali Acc: 0.792 Test Loss: 0.882 Test Acc: 0.792
Validation loss decreased (inf --> -0.791586).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5956154
	speed: 0.1750s/iter; left time: 2363.4424s
	iters: 200, epoch: 2 | loss: 0.4931696
	speed: 0.0368s/iter; left time: 493.4088s
	iters: 300, epoch: 2 | loss: 0.6101319
	speed: 0.0510s/iter; left time: 678.6075s
	iters: 400, epoch: 2 | loss: 0.5403503
	speed: 0.0492s/iter; left time: 650.1521s
Epoch: 2 cost time: 20.000094175338745
Epoch: 2, Steps: 469 | Train Loss: 0.530 Vali Loss: 0.375 Vali Acc: 0.880 Test Loss: 0.375 Test Acc: 0.880
Validation loss decreased (-0.791586 --> -0.879928).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2072767
	speed: 0.1725s/iter; left time: 2248.5668s
	iters: 200, epoch: 3 | loss: 0.2202537
	speed: 0.0521s/iter; left time: 673.9706s
	iters: 300, epoch: 3 | loss: 0.2754931
	speed: 0.0616s/iter; left time: 790.2637s
	iters: 400, epoch: 3 | loss: 0.0918365
	speed: 0.0528s/iter; left time: 671.9843s
Epoch: 3 cost time: 24.91807270050049
Epoch: 3, Steps: 469 | Train Loss: 0.244 Vali Loss: 0.226 Vali Acc: 0.931 Test Loss: 0.226 Test Acc: 0.931
Validation loss decreased (-0.879928 --> -0.931387).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5809619
	speed: 0.2499s/iter; left time: 3140.0217s
	iters: 200, epoch: 4 | loss: 0.2938109
	speed: 0.0526s/iter; left time: 655.2221s
	iters: 300, epoch: 4 | loss: 0.0191205
	speed: 0.0501s/iter; left time: 619.5439s
	iters: 400, epoch: 4 | loss: 0.2106300
	speed: 0.0591s/iter; left time: 724.7721s
Epoch: 4 cost time: 27.95897889137268
Epoch: 4, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.194 Vali Acc: 0.935 Test Loss: 0.194 Test Acc: 0.935
Validation loss decreased (-0.931387 --> -0.935104).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1624015
	speed: 0.2467s/iter; left time: 2983.9454s
	iters: 200, epoch: 5 | loss: 0.2284974
	speed: 0.0554s/iter; left time: 664.9163s
	iters: 300, epoch: 5 | loss: 0.1397730
	speed: 0.0679s/iter; left time: 807.1089s
	iters: 400, epoch: 5 | loss: 0.1730754
	speed: 0.0471s/iter; left time: 555.5839s
Epoch: 5 cost time: 25.036054849624634
Epoch: 5, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
Validation loss decreased (-0.935104 --> -0.937677).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0623987
	speed: 0.1726s/iter; left time: 2006.9565s
	iters: 200, epoch: 6 | loss: 0.0256660
	speed: 0.0556s/iter; left time: 640.3858s
	iters: 300, epoch: 6 | loss: 0.0144607
	speed: 0.0388s/iter; left time: 443.3011s
	iters: 400, epoch: 6 | loss: 0.0282854
	speed: 0.0341s/iter; left time: 386.2591s
Epoch: 6 cost time: 20.188440084457397
Epoch: 6, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
Validation loss decreased (-0.937677 --> -0.961119).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0915885
	speed: 0.1851s/iter; left time: 2065.4698s
	iters: 200, epoch: 7 | loss: 0.0267308
	speed: 0.0369s/iter; left time: 408.2750s
	iters: 300, epoch: 7 | loss: 0.0761815
	speed: 0.0339s/iter; left time: 371.6034s
	iters: 400, epoch: 7 | loss: 0.0561984
	speed: 0.0354s/iter; left time: 383.9469s
Epoch: 7 cost time: 18.865108489990234
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.961119 --> -0.965408).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0042831
	speed: 0.2109s/iter; left time: 2253.6670s
	iters: 200, epoch: 8 | loss: 0.1477435
	speed: 0.0512s/iter; left time: 541.9052s
	iters: 300, epoch: 8 | loss: 0.2775365
	speed: 0.0580s/iter; left time: 608.5789s
	iters: 400, epoch: 8 | loss: 0.0228151
	speed: 0.0745s/iter; left time: 773.9544s
Epoch: 8 cost time: 29.253188848495483
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1516038
	speed: 0.2364s/iter; left time: 2415.5426s
	iters: 200, epoch: 9 | loss: 0.1336349
	speed: 0.0736s/iter; left time: 744.4571s
	iters: 300, epoch: 9 | loss: 0.0501189
	speed: 0.0645s/iter; left time: 645.8025s
	iters: 400, epoch: 9 | loss: 0.0126786
	speed: 0.0511s/iter; left time: 507.1115s
Epoch: 9 cost time: 28.497952461242676
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.965408 --> -0.971125).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0074128
	speed: 0.2319s/iter; left time: 2261.1833s
	iters: 200, epoch: 10 | loss: 0.0247400
	speed: 0.0385s/iter; left time: 371.0905s
	iters: 300, epoch: 10 | loss: 0.0115438
	speed: 0.0345s/iter; left time: 329.0473s
	iters: 400, epoch: 10 | loss: 0.0063226
	speed: 0.0350s/iter; left time: 330.3757s
Epoch: 10 cost time: 18.573030948638916
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0106373
	speed: 0.1889s/iter; left time: 1753.1618s
	iters: 200, epoch: 11 | loss: 0.0067008
	speed: 0.0352s/iter; left time: 323.1533s
	iters: 300, epoch: 11 | loss: 0.0232660
	speed: 0.0370s/iter; left time: 336.0731s
	iters: 400, epoch: 11 | loss: 0.0140379
	speed: 0.0545s/iter; left time: 489.2336s
Epoch: 11 cost time: 20.471193552017212
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.971125 --> -0.972841).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0339331
	speed: 0.1752s/iter; left time: 1543.5971s
	iters: 200, epoch: 12 | loss: 0.0405130
	speed: 0.0453s/iter; left time: 394.4399s
	iters: 300, epoch: 12 | loss: 0.0019125
	speed: 0.0520s/iter; left time: 448.2148s
	iters: 400, epoch: 12 | loss: 0.1159785
	speed: 0.0469s/iter; left time: 399.0594s
Epoch: 12 cost time: 22.23478078842163
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1714920
	speed: 0.2427s/iter; left time: 2025.1390s
	iters: 200, epoch: 13 | loss: 0.0122728
	speed: 0.0616s/iter; left time: 507.6617s
	iters: 300, epoch: 13 | loss: 0.3529677
	speed: 0.0567s/iter; left time: 461.8290s
	iters: 400, epoch: 13 | loss: 0.0039838
	speed: 0.0511s/iter; left time: 410.9184s
Epoch: 13 cost time: 27.60874652862549
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0176443
	speed: 0.1844s/iter; left time: 1452.1319s
	iters: 200, epoch: 14 | loss: 0.0205607
	speed: 0.0350s/iter; left time: 272.4238s
	iters: 300, epoch: 14 | loss: 0.0052225
	speed: 0.0667s/iter; left time: 512.0052s
	iters: 400, epoch: 14 | loss: 0.0009765
	speed: 0.0852s/iter; left time: 645.2422s
Epoch: 14 cost time: 28.356479167938232
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.972841 --> -0.977129).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0118585
	speed: 0.2429s/iter; left time: 1798.7282s
	iters: 200, epoch: 15 | loss: 0.0082623
	speed: 0.0657s/iter; left time: 479.9133s
	iters: 300, epoch: 15 | loss: 0.0165741
	speed: 0.0541s/iter; left time: 389.6994s
	iters: 400, epoch: 15 | loss: 0.0203981
	speed: 0.0436s/iter; left time: 309.4329s
Epoch: 15 cost time: 25.537973880767822
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0013506
	speed: 0.2479s/iter; left time: 1719.2248s
	iters: 200, epoch: 16 | loss: 0.1813699
	speed: 0.0476s/iter; left time: 325.5213s
	iters: 300, epoch: 16 | loss: 0.0058551
	speed: 0.0465s/iter; left time: 313.3586s
	iters: 400, epoch: 16 | loss: 0.0244148
	speed: 0.0512s/iter; left time: 339.9614s
Epoch: 16 cost time: 27.54473638534546
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0052783
	speed: 0.2567s/iter; left time: 1660.1173s
	iters: 200, epoch: 17 | loss: 0.0186481
	speed: 0.0593s/iter; left time: 377.5494s
	iters: 300, epoch: 17 | loss: 0.1718291
	speed: 0.0880s/iter; left time: 551.4869s
	iters: 400, epoch: 17 | loss: 0.0029949
	speed: 0.0927s/iter; left time: 571.5878s
Epoch: 17 cost time: 34.84305548667908
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0056162
	speed: 0.3093s/iter; left time: 1855.0108s
	iters: 200, epoch: 18 | loss: 0.0058125
	speed: 0.0933s/iter; left time: 550.3609s
	iters: 300, epoch: 18 | loss: 0.0036781
	speed: 0.0843s/iter; left time: 488.5397s
	iters: 400, epoch: 18 | loss: 0.0337585
	speed: 0.0742s/iter; left time: 422.7755s
Epoch: 18 cost time: 38.48395562171936
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0896418
	speed: 0.3222s/iter; left time: 1781.3424s
	iters: 200, epoch: 19 | loss: 0.0043048
	speed: 0.0660s/iter; left time: 358.0722s
	iters: 300, epoch: 19 | loss: 0.0060833
	speed: 0.0512s/iter; left time: 272.6684s
	iters: 400, epoch: 19 | loss: 0.0070460
	speed: 0.0636s/iter; left time: 332.6165s
Epoch: 19 cost time: 31.89447784423828
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.977129 --> -0.982275).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0145554
	speed: 0.2454s/iter; left time: 1241.6615s
	iters: 200, epoch: 20 | loss: 0.0025386
	speed: 0.0586s/iter; left time: 290.4749s
	iters: 300, epoch: 20 | loss: 0.0104582
	speed: 0.0762s/iter; left time: 370.1087s
	iters: 400, epoch: 20 | loss: 0.0038244
	speed: 0.0650s/iter; left time: 309.2776s
Epoch: 20 cost time: 28.299273014068604
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0003752
	speed: 0.2341s/iter; left time: 1074.6618s
	iters: 200, epoch: 21 | loss: 0.0027220
	speed: 0.0727s/iter; left time: 326.2772s
	iters: 300, epoch: 21 | loss: 0.0004893
	speed: 0.0505s/iter; left time: 221.5470s
	iters: 400, epoch: 21 | loss: 0.0015444
	speed: 0.0526s/iter; left time: 225.8025s
Epoch: 21 cost time: 28.987502813339233
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0102103
	speed: 0.2825s/iter; left time: 1164.6361s
	iters: 200, epoch: 22 | loss: 0.0035622
	speed: 0.0769s/iter; left time: 309.3251s
	iters: 300, epoch: 22 | loss: 0.7192662
	speed: 0.0680s/iter; left time: 266.7336s
	iters: 400, epoch: 22 | loss: 0.0050083
	speed: 0.0836s/iter; left time: 319.3376s
Epoch: 22 cost time: 38.223509788513184
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0032241
	speed: 0.3085s/iter; left time: 1126.9945s
	iters: 200, epoch: 23 | loss: 0.0148643
	speed: 0.0861s/iter; left time: 306.0278s
	iters: 300, epoch: 23 | loss: 0.0071405
	speed: 0.0996s/iter; left time: 343.8677s
	iters: 400, epoch: 23 | loss: 0.1800775
	speed: 0.0746s/iter; left time: 250.0971s
Epoch: 23 cost time: 37.80713129043579
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0398415
	speed: 0.2941s/iter; left time: 936.4583s
	iters: 200, epoch: 24 | loss: 0.0106446
	speed: 0.0542s/iter; left time: 167.3004s
	iters: 300, epoch: 24 | loss: 0.0090919
	speed: 0.0505s/iter; left time: 150.7831s
	iters: 400, epoch: 24 | loss: 0.0040371
	speed: 0.0551s/iter; left time: 158.9600s
Epoch: 24 cost time: 27.84219741821289
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0788875
	speed: 0.2549s/iter; left time: 691.9967s
	iters: 200, epoch: 25 | loss: 0.0017949
	speed: 0.0499s/iter; left time: 130.3732s
	iters: 300, epoch: 25 | loss: 0.0002652
	speed: 0.0518s/iter; left time: 130.3006s
	iters: 400, epoch: 25 | loss: 0.0007517
	speed: 0.0712s/iter; left time: 171.9848s
Epoch: 25 cost time: 28.331226348876953
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0021671
	speed: 0.2367s/iter; left time: 531.6812s
	iters: 200, epoch: 26 | loss: 0.0048917
	speed: 0.0702s/iter; left time: 150.7343s
	iters: 300, epoch: 26 | loss: 0.0623029
	speed: 0.0782s/iter; left time: 159.9820s
	iters: 400, epoch: 26 | loss: 0.0367223
	speed: 0.0708s/iter; left time: 137.7283s
Epoch: 26 cost time: 31.52917742729187
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0170970
	speed: 0.2986s/iter; left time: 530.6703s
	iters: 200, epoch: 27 | loss: 0.0098453
	speed: 0.0709s/iter; left time: 118.8425s
	iters: 300, epoch: 27 | loss: 0.0014349
	speed: 0.0694s/iter; left time: 109.3839s
	iters: 400, epoch: 27 | loss: 0.0013861
	speed: 0.0695s/iter; left time: 102.6974s
Epoch: 27 cost time: 34.865575313568115
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0228148
	speed: 0.3011s/iter; left time: 393.7868s
	iters: 200, epoch: 28 | loss: 0.0015143
	speed: 0.0660s/iter; left time: 79.6685s
	iters: 300, epoch: 28 | loss: 0.0005446
	speed: 0.0792s/iter; left time: 87.7700s
	iters: 400, epoch: 28 | loss: 0.0096254
	speed: 0.0887s/iter; left time: 89.3806s
Epoch: 28 cost time: 34.62030839920044
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0006649
	speed: 0.2223s/iter; left time: 186.5218s
	iters: 200, epoch: 29 | loss: 0.0595618
	speed: 0.0456s/iter; left time: 33.6638s
	iters: 300, epoch: 29 | loss: 0.0040600
	speed: 0.0290s/iter; left time: 18.5628s
	iters: 400, epoch: 29 | loss: 0.0049726
	speed: 0.0290s/iter; left time: 15.6430s
Epoch: 29 cost time: 17.793395519256592
Epoch: 29, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 130250
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2196207
	speed: 0.1372s/iter; left time: 1916.9303s
	iters: 200, epoch: 1 | loss: 1.7097019
	speed: 0.1573s/iter; left time: 2182.2633s
	iters: 300, epoch: 1 | loss: 1.2501823
	speed: 0.1700s/iter; left time: 2340.9058s
	iters: 400, epoch: 1 | loss: 0.8416860
	speed: 0.1871s/iter; left time: 2558.2171s
Epoch: 1 cost time: 77.56305193901062
Epoch: 1, Steps: 469 | Train Loss: 1.556 Vali Loss: 0.712 Vali Acc: 0.836 Test Loss: 0.712 Test Acc: 0.836
Validation loss decreased (inf --> -0.836471).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3817472
	speed: 0.4537s/iter; left time: 6126.0646s
	iters: 200, epoch: 2 | loss: 0.5138299
	speed: 0.1097s/iter; left time: 1469.9707s
	iters: 300, epoch: 2 | loss: 0.5428803
	speed: 0.1203s/iter; left time: 1600.1875s
	iters: 400, epoch: 2 | loss: 0.2050550
	speed: 0.1069s/iter; left time: 1411.5031s
Epoch: 2 cost time: 57.491896629333496
Epoch: 2, Steps: 469 | Train Loss: 0.380 Vali Loss: 0.247 Vali Acc: 0.920 Test Loss: 0.247 Test Acc: 0.920
Validation loss decreased (-0.836471 --> -0.919666).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1449947
	speed: 0.3512s/iter; left time: 4577.3911s
	iters: 200, epoch: 3 | loss: 0.1181806
	speed: 0.1748s/iter; left time: 2260.8032s
	iters: 300, epoch: 3 | loss: 0.2264012
	speed: 0.1707s/iter; left time: 2190.5503s
	iters: 400, epoch: 3 | loss: 0.0214642
	speed: 0.1807s/iter; left time: 2301.0565s
Epoch: 3 cost time: 77.05858993530273
Epoch: 3, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
Validation loss decreased (-0.919666 --> -0.955687).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1139629
	speed: 0.4560s/iter; left time: 5728.6582s
	iters: 200, epoch: 4 | loss: 0.0592999
	speed: 0.1048s/iter; left time: 1305.7975s
	iters: 300, epoch: 4 | loss: 0.0277868
	speed: 0.1202s/iter; left time: 1485.7231s
	iters: 400, epoch: 4 | loss: 0.0959813
	speed: 0.1142s/iter; left time: 1399.9916s
Epoch: 4 cost time: 56.51754117012024
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0229121
	speed: 0.3225s/iter; left time: 3900.7579s
	iters: 200, epoch: 5 | loss: 0.0614599
	speed: 0.1122s/iter; left time: 1345.8686s
	iters: 300, epoch: 5 | loss: 0.0288478
	speed: 0.1420s/iter; left time: 1689.0177s
	iters: 400, epoch: 5 | loss: 0.0163932
	speed: 0.2149s/iter; left time: 2534.9361s
Epoch: 5 cost time: 72.71855592727661
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.955687 --> -0.974842).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0492598
	speed: 0.5580s/iter; left time: 6486.9327s
	iters: 200, epoch: 6 | loss: 0.0103780
	speed: 0.1658s/iter; left time: 1911.0623s
	iters: 300, epoch: 6 | loss: 0.1175574
	speed: 0.1338s/iter; left time: 1528.7408s
	iters: 400, epoch: 6 | loss: 0.0224697
	speed: 0.1375s/iter; left time: 1557.8342s
Epoch: 6 cost time: 73.21365904808044
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0241007
	speed: 0.4388s/iter; left time: 4895.5788s
	iters: 200, epoch: 7 | loss: 0.0877593
	speed: 0.1893s/iter; left time: 2092.8734s
	iters: 300, epoch: 7 | loss: 0.0197014
	speed: 0.2014s/iter; left time: 2207.2689s
	iters: 400, epoch: 7 | loss: 0.0391584
	speed: 0.2139s/iter; left time: 2321.9645s
Epoch: 7 cost time: 92.85066843032837
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0369190
	speed: 0.5454s/iter; left time: 5828.8120s
	iters: 200, epoch: 8 | loss: 0.1054371
	speed: 0.1472s/iter; left time: 1558.6965s
	iters: 300, epoch: 8 | loss: 0.0014634
	speed: 0.1386s/iter; left time: 1454.0543s
	iters: 400, epoch: 8 | loss: 0.0843600
	speed: 0.1324s/iter; left time: 1375.1122s
Epoch: 8 cost time: 70.44501423835754
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1161757
	speed: 0.4152s/iter; left time: 4243.0792s
	iters: 200, epoch: 9 | loss: 0.0755317
	speed: 0.1994s/iter; left time: 2017.7223s
	iters: 300, epoch: 9 | loss: 0.0690476
	speed: 0.2123s/iter; left time: 2126.7426s
	iters: 400, epoch: 9 | loss: 0.0010833
	speed: 0.1565s/iter; left time: 1552.1932s
Epoch: 9 cost time: 80.37888360023499
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.975699 --> -0.980845).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1109625
	speed: 0.3708s/iter; left time: 3615.5097s
	iters: 200, epoch: 10 | loss: 0.0151875
	speed: 0.1075s/iter; left time: 1037.6649s
	iters: 300, epoch: 10 | loss: 0.0891399
	speed: 0.1037s/iter; left time: 989.8844s
	iters: 400, epoch: 10 | loss: 0.0337739
	speed: 0.0831s/iter; left time: 785.5819s
Epoch: 10 cost time: 48.76625847816467
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0270685
	speed: 0.3183s/iter; left time: 2954.2389s
	iters: 200, epoch: 11 | loss: 0.0176991
	speed: 0.0946s/iter; left time: 868.3520s
	iters: 300, epoch: 11 | loss: 0.0026176
	speed: 0.1510s/iter; left time: 1370.8594s
	iters: 400, epoch: 11 | loss: 0.0028331
	speed: 0.1563s/iter; left time: 1403.4578s
Epoch: 11 cost time: 59.50997567176819
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0018223
	speed: 0.4181s/iter; left time: 3684.0704s
	iters: 200, epoch: 12 | loss: 0.0027399
	speed: 0.1282s/iter; left time: 1116.8686s
	iters: 300, epoch: 12 | loss: 0.0019198
	speed: 0.0889s/iter; left time: 765.5248s
	iters: 400, epoch: 12 | loss: 0.0034153
	speed: 0.0854s/iter; left time: 726.7776s
Epoch: 12 cost time: 52.60054135322571
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0101668
	speed: 0.2967s/iter; left time: 2475.6044s
	iters: 200, epoch: 13 | loss: 0.0048140
	speed: 0.0970s/iter; left time: 799.3800s
	iters: 300, epoch: 13 | loss: 0.0059683
	speed: 0.0799s/iter; left time: 650.6522s
	iters: 400, epoch: 13 | loss: 0.0019114
	speed: 0.1352s/iter; left time: 1087.7225s
Epoch: 13 cost time: 50.982136487960815
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0028542
	speed: 0.3672s/iter; left time: 2891.0054s
	iters: 200, epoch: 14 | loss: 0.0008587
	speed: 0.2199s/iter; left time: 1709.2208s
	iters: 300, epoch: 14 | loss: 0.0006609
	speed: 0.1760s/iter; left time: 1350.3781s
	iters: 400, epoch: 14 | loss: 0.0157108
	speed: 0.1278s/iter; left time: 968.1717s
Epoch: 14 cost time: 68.8567566871643
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0006286
	speed: 0.3309s/iter; left time: 2450.4845s
	iters: 200, epoch: 15 | loss: 0.0012296
	speed: 0.1401s/iter; left time: 1023.7526s
	iters: 300, epoch: 15 | loss: 0.0061845
	speed: 0.1252s/iter; left time: 902.4242s
	iters: 400, epoch: 15 | loss: 0.0032524
	speed: 0.1206s/iter; left time: 857.0193s
Epoch: 15 cost time: 62.868290185928345
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0508993
	speed: 0.5340s/iter; left time: 3704.0211s
	iters: 200, epoch: 16 | loss: 0.0062265
	speed: 0.2105s/iter; left time: 1438.8785s
	iters: 300, epoch: 16 | loss: 0.0275242
	speed: 0.1894s/iter; left time: 1275.6943s
	iters: 400, epoch: 16 | loss: 0.0020717
	speed: 0.1648s/iter; left time: 1093.4479s
Epoch: 16 cost time: 84.58123683929443
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0044974
	speed: 0.3727s/iter; left time: 2410.0040s
	iters: 200, epoch: 17 | loss: 0.0080381
	speed: 0.1028s/iter; left time: 654.5002s
	iters: 300, epoch: 17 | loss: 0.0011158
	speed: 0.1471s/iter; left time: 921.9460s
	iters: 400, epoch: 17 | loss: 0.0035709
	speed: 0.1123s/iter; left time: 692.7765s
Epoch: 17 cost time: 59.91127324104309
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1676598
	speed: 0.5198s/iter; left time: 3117.9250s
	iters: 200, epoch: 18 | loss: 0.0051067
	speed: 0.1744s/iter; left time: 1028.3530s
	iters: 300, epoch: 18 | loss: 0.0515947
	speed: 0.2272s/iter; left time: 1317.5169s
	iters: 400, epoch: 18 | loss: 0.0011926
	speed: 0.1808s/iter; left time: 1030.0779s
Epoch: 18 cost time: 90.85752439498901
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0171243
	speed: 0.4008s/iter; left time: 2215.7996s
	iters: 200, epoch: 19 | loss: 0.0036262
	speed: 0.1066s/iter; left time: 578.5243s
	iters: 300, epoch: 19 | loss: 0.0023849
	speed: 0.1529s/iter; left time: 814.9235s
	iters: 400, epoch: 19 | loss: 0.0037973
	speed: 0.0991s/iter; left time: 518.2125s
Epoch: 19 cost time: 59.608031034469604
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.982275).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0107511
	speed: 0.4830s/iter; left time: 2443.9652s
	iters: 200, epoch: 20 | loss: 0.0634717
	speed: 0.1981s/iter; left time: 982.5927s
	iters: 300, epoch: 20 | loss: 0.0011408
	speed: 0.2201s/iter; left time: 1069.5299s
	iters: 400, epoch: 20 | loss: 0.0053917
	speed: 0.1819s/iter; left time: 865.9975s
Epoch: 20 cost time: 91.9725570678711
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0316063
	speed: 0.4353s/iter; left time: 1998.5193s
	iters: 200, epoch: 21 | loss: 0.0007721
	speed: 0.0967s/iter; left time: 434.1471s
	iters: 300, epoch: 21 | loss: 0.0371073
	speed: 0.1045s/iter; left time: 458.8479s
	iters: 400, epoch: 21 | loss: 0.0006102
	speed: 0.1262s/iter; left time: 541.5582s
Epoch: 21 cost time: 55.599655866622925
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983418).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0011943
	speed: 0.3536s/iter; left time: 1457.7068s
	iters: 200, epoch: 22 | loss: 0.0020488
	speed: 0.1586s/iter; left time: 637.8137s
	iters: 300, epoch: 22 | loss: 0.0006107
	speed: 0.0818s/iter; left time: 320.7163s
	iters: 400, epoch: 22 | loss: 0.0067234
	speed: 0.0753s/iter; left time: 287.6307s
Epoch: 22 cost time: 49.18319582939148
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0200647
	speed: 0.5372s/iter; left time: 1962.2379s
	iters: 200, epoch: 23 | loss: 0.0104435
	speed: 0.2787s/iter; left time: 990.3505s
	iters: 300, epoch: 23 | loss: 0.0016317
	speed: 0.2845s/iter; left time: 982.3326s
	iters: 400, epoch: 23 | loss: 0.0022708
	speed: 0.3015s/iter; left time: 1010.9654s
Epoch: 23 cost time: 135.070054769516
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0314424
	speed: 0.7142s/iter; left time: 2274.0769s
	iters: 200, epoch: 24 | loss: 0.0016730
	speed: 0.2680s/iter; left time: 826.5178s
	iters: 300, epoch: 24 | loss: 0.1692847
	speed: 0.2107s/iter; left time: 628.7094s
	iters: 400, epoch: 24 | loss: 0.0051046
	speed: 0.2473s/iter; left time: 713.3058s
Epoch: 24 cost time: 120.09826850891113
Epoch: 24, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0011129
	speed: 0.5572s/iter; left time: 1512.8525s
	iters: 200, epoch: 25 | loss: 0.0018328
	speed: 0.1786s/iter; left time: 467.1483s
	iters: 300, epoch: 25 | loss: 0.0009482
	speed: 0.1585s/iter; left time: 398.6983s
	iters: 400, epoch: 25 | loss: 0.3890685
	speed: 0.1804s/iter; left time: 435.7828s
Epoch: 25 cost time: 80.36603689193726
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0130916
	speed: 0.4819s/iter; left time: 1082.4026s
	iters: 200, epoch: 26 | loss: 0.2227148
	speed: 0.1532s/iter; left time: 328.7822s
	iters: 300, epoch: 26 | loss: 0.0006332
	speed: 0.1777s/iter; left time: 363.5511s
	iters: 400, epoch: 26 | loss: 0.0005458
	speed: 0.1586s/iter; left time: 308.7291s
Epoch: 26 cost time: 79.43824815750122
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0231543
	speed: 0.4745s/iter; left time: 843.2485s
	iters: 200, epoch: 27 | loss: 0.0029931
	speed: 0.2347s/iter; left time: 393.6439s
	iters: 300, epoch: 27 | loss: 0.0027439
	speed: 0.4570s/iter; left time: 720.7354s
	iters: 400, epoch: 27 | loss: 0.0009068
	speed: 0.4479s/iter; left time: 661.5889s
Epoch: 27 cost time: 158.32446670532227
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0033805
	speed: 1.0642s/iter; left time: 1391.9876s
	iters: 200, epoch: 28 | loss: 0.0006133
	speed: 0.4737s/iter; left time: 572.2756s
	iters: 300, epoch: 28 | loss: 0.0005276
	speed: 0.4460s/iter; left time: 494.1867s
	iters: 400, epoch: 28 | loss: 0.0054074
	speed: 0.4982s/iter; left time: 502.2199s
Epoch: 28 cost time: 225.43161273002625
Epoch: 28, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0005138
	speed: 1.0883s/iter; left time: 913.0957s
	iters: 200, epoch: 29 | loss: 0.0016008
	speed: 0.4956s/iter; left time: 366.2620s
	iters: 300, epoch: 29 | loss: 0.0029576
	speed: 0.4523s/iter; left time: 289.0256s
	iters: 400, epoch: 29 | loss: 0.0013767
	speed: 0.4031s/iter; left time: 217.2843s
Epoch: 29 cost time: 204.63897156715393
Epoch: 29, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0267687
	speed: 1.0019s/iter; left time: 370.6927s
	iters: 200, epoch: 30 | loss: 0.0091894
	speed: 0.3901s/iter; left time: 105.3402s
	iters: 300, epoch: 30 | loss: 0.0381686
	speed: 0.4184s/iter; left time: 71.1295s
	iters: 400, epoch: 30 | loss: 0.0008789
	speed: 0.4460s/iter; left time: 31.2194s
Epoch: 30 cost time: 197.8293685913086
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 220826
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2062728
	speed: 0.2788s/iter; left time: 3894.9679s
	iters: 200, epoch: 1 | loss: 1.6840326
	speed: 0.2713s/iter; left time: 3763.7622s
	iters: 300, epoch: 1 | loss: 1.3324146
	speed: 0.2529s/iter; left time: 3482.6466s
	iters: 400, epoch: 1 | loss: 0.7884394
	speed: 0.2220s/iter; left time: 3035.3813s
Epoch: 1 cost time: 121.64826703071594
Epoch: 1, Steps: 469 | Train Loss: 1.545 Vali Loss: 0.711 Vali Acc: 0.835 Test Loss: 0.711 Test Acc: 0.835
Validation loss decreased (inf --> -0.835041).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3453375
	speed: 0.7808s/iter; left time: 10541.7233s
	iters: 200, epoch: 2 | loss: 0.4748082
	speed: 0.2992s/iter; left time: 4009.6677s
	iters: 300, epoch: 2 | loss: 0.2206006
	speed: 0.2792s/iter; left time: 3714.1284s
	iters: 400, epoch: 2 | loss: 0.2172065
	speed: 0.2664s/iter; left time: 3516.6526s
Epoch: 2 cost time: 136.1650698184967
Epoch: 2, Steps: 469 | Train Loss: 0.410 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
Validation loss decreased (-0.835041 --> -0.914520).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1930846
	speed: 0.8047s/iter; left time: 10487.8726s
	iters: 200, epoch: 3 | loss: 0.1009350
	speed: 0.2777s/iter; left time: 3591.1060s
	iters: 300, epoch: 3 | loss: 0.0299936
	speed: 0.2788s/iter; left time: 3577.7512s
	iters: 400, epoch: 3 | loss: 0.1726861
	speed: 0.2859s/iter; left time: 3639.7719s
Epoch: 3 cost time: 135.15854907035828
Epoch: 3, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
Validation loss decreased (-0.914520 --> -0.955116).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1277302
	speed: 0.7899s/iter; left time: 9924.0832s
	iters: 200, epoch: 4 | loss: 0.0721643
	speed: 0.2798s/iter; left time: 3487.5267s
	iters: 300, epoch: 4 | loss: 0.1773773
	speed: 0.2918s/iter; left time: 3607.4235s
	iters: 400, epoch: 4 | loss: 0.0601175
	speed: 0.2801s/iter; left time: 3434.9372s
Epoch: 4 cost time: 131.7510871887207
Epoch: 4, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (-0.955116 --> -0.964264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0153343
	speed: 0.6868s/iter; left time: 8307.2283s
	iters: 200, epoch: 5 | loss: 0.3078132
	speed: 0.1924s/iter; left time: 2307.5367s
	iters: 300, epoch: 5 | loss: 0.1370120
	speed: 0.2848s/iter; left time: 3387.2452s
	iters: 400, epoch: 5 | loss: 0.0808094
	speed: 0.2892s/iter; left time: 3411.3931s
Epoch: 5 cost time: 118.01885962486267
Epoch: 5, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
Validation loss decreased (-0.964264 --> -0.967409).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0133469
	speed: 0.7073s/iter; left time: 8222.9436s
	iters: 200, epoch: 6 | loss: 0.0067635
	speed: 0.2434s/iter; left time: 2805.6470s
	iters: 300, epoch: 6 | loss: 0.2479283
	speed: 0.2870s/iter; left time: 3279.5959s
	iters: 400, epoch: 6 | loss: 0.1160543
	speed: 0.2890s/iter; left time: 3272.6584s
Epoch: 6 cost time: 123.5508406162262
Epoch: 6, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.968552).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0145230
	speed: 0.7061s/iter; left time: 7877.8406s
	iters: 200, epoch: 7 | loss: 0.0041013
	speed: 0.2810s/iter; left time: 3106.7548s
	iters: 300, epoch: 7 | loss: 0.0196236
	speed: 0.2759s/iter; left time: 3023.4148s
	iters: 400, epoch: 7 | loss: 0.1435444
	speed: 0.2898s/iter; left time: 3146.6739s
Epoch: 7 cost time: 131.64930653572083
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1278245
	speed: 0.8010s/iter; left time: 8560.5766s
	iters: 200, epoch: 8 | loss: 0.1917193
	speed: 0.3147s/iter; left time: 3332.2019s
	iters: 300, epoch: 8 | loss: 0.0033921
	speed: 0.2964s/iter; left time: 3108.6487s
	iters: 400, epoch: 8 | loss: 0.0337446
	speed: 0.2786s/iter; left time: 2894.4261s
Epoch: 8 cost time: 141.16596388816833
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.968552 --> -0.977415).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0305457
	speed: 0.8031s/iter; left time: 8206.8992s
	iters: 200, epoch: 9 | loss: 0.0297834
	speed: 0.3081s/iter; left time: 3117.5620s
	iters: 300, epoch: 9 | loss: 0.0141363
	speed: 0.2892s/iter; left time: 2897.8023s
	iters: 400, epoch: 9 | loss: 0.0103229
	speed: 0.2736s/iter; left time: 2713.7534s
Epoch: 9 cost time: 139.0679485797882
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.979130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0544582
	speed: 0.8163s/iter; left time: 7958.4656s
	iters: 200, epoch: 10 | loss: 0.0094403
	speed: 0.2909s/iter; left time: 2807.1908s
	iters: 300, epoch: 10 | loss: 0.0154553
	speed: 0.2734s/iter; left time: 2610.8827s
	iters: 400, epoch: 10 | loss: 0.1169161
	speed: 0.2457s/iter; left time: 2322.1910s
Epoch: 10 cost time: 128.51517987251282
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0441961
	speed: 0.6893s/iter; left time: 6397.0061s
	iters: 200, epoch: 11 | loss: 0.0029894
	speed: 0.2329s/iter; left time: 2138.5597s
	iters: 300, epoch: 11 | loss: 0.0208653
	speed: 0.2368s/iter; left time: 2150.1646s
	iters: 400, epoch: 11 | loss: 0.0956858
	speed: 0.2668s/iter; left time: 2395.8307s
Epoch: 11 cost time: 116.8950867652893
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0019172
	speed: 0.6763s/iter; left time: 5959.3748s
	iters: 200, epoch: 12 | loss: 0.0081339
	speed: 0.2340s/iter; left time: 2038.5249s
	iters: 300, epoch: 12 | loss: 0.0557988
	speed: 0.2525s/iter; left time: 2174.7849s
	iters: 400, epoch: 12 | loss: 0.0332837
	speed: 0.2648s/iter; left time: 2254.1577s
Epoch: 12 cost time: 116.43244743347168
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0079070
	speed: 0.6647s/iter; left time: 5545.2056s
	iters: 200, epoch: 13 | loss: 0.0116025
	speed: 0.2397s/iter; left time: 1976.1822s
	iters: 300, epoch: 13 | loss: 0.0453201
	speed: 0.2620s/iter; left time: 2133.7989s
	iters: 400, epoch: 13 | loss: 0.0184476
	speed: 0.2884s/iter; left time: 2319.7781s
Epoch: 13 cost time: 120.08373165130615
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0321192
	speed: 0.7726s/iter; left time: 6083.7925s
	iters: 200, epoch: 14 | loss: 0.0332601
	speed: 0.3335s/iter; left time: 2592.6332s
	iters: 300, epoch: 14 | loss: 0.0087449
	speed: 0.3186s/iter; left time: 2445.1431s
	iters: 400, epoch: 14 | loss: 0.0091770
	speed: 0.3205s/iter; left time: 2427.6753s
Epoch: 14 cost time: 146.44590020179749
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0175244
	speed: 0.7966s/iter; left time: 5899.1882s
	iters: 200, epoch: 15 | loss: 0.0146454
	speed: 0.2431s/iter; left time: 1775.8820s
	iters: 300, epoch: 15 | loss: 0.1160975
	speed: 0.2697s/iter; left time: 1942.9715s
	iters: 400, epoch: 15 | loss: 0.0010693
	speed: 0.2829s/iter; left time: 2010.3094s
Epoch: 15 cost time: 128.05894231796265
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0016265
	speed: 0.7510s/iter; left time: 5209.2704s
	iters: 200, epoch: 16 | loss: 0.0094176
	speed: 0.2691s/iter; left time: 1839.3329s
	iters: 300, epoch: 16 | loss: 0.0016825
	speed: 0.2564s/iter; left time: 1727.2209s
	iters: 400, epoch: 16 | loss: 0.0035093
	speed: 0.2299s/iter; left time: 1525.8460s
Epoch: 16 cost time: 121.39180612564087
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0128034
	speed: 0.6786s/iter; left time: 4388.2809s
	iters: 200, epoch: 17 | loss: 0.0080564
	speed: 0.2288s/iter; left time: 1456.7013s
	iters: 300, epoch: 17 | loss: 0.0215716
	speed: 0.2428s/iter; left time: 1521.4708s
	iters: 400, epoch: 17 | loss: 0.0025523
	speed: 0.2312s/iter; left time: 1425.8405s
Epoch: 17 cost time: 112.2183883190155
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.981417).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0032066
	speed: 0.6502s/iter; left time: 3899.7263s
	iters: 200, epoch: 18 | loss: 0.0061708
	speed: 0.2394s/iter; left time: 1412.1172s
	iters: 300, epoch: 18 | loss: 0.0043882
	speed: 0.2260s/iter; left time: 1310.5485s
	iters: 400, epoch: 18 | loss: 0.0282640
	speed: 0.2395s/iter; left time: 1364.7373s
Epoch: 18 cost time: 109.74140810966492
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0030193
	speed: 0.6472s/iter; left time: 3578.1787s
	iters: 200, epoch: 19 | loss: 0.0052475
	speed: 0.2408s/iter; left time: 1307.4857s
	iters: 300, epoch: 19 | loss: 0.1408068
	speed: 0.2191s/iter; left time: 1167.6308s
	iters: 400, epoch: 19 | loss: 0.0005867
	speed: 0.2773s/iter; left time: 1450.0948s
Epoch: 19 cost time: 115.76888942718506
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0441934
	speed: 0.6520s/iter; left time: 3299.3263s
	iters: 200, epoch: 20 | loss: 0.0006468
	speed: 0.3245s/iter; left time: 1609.3673s
	iters: 300, epoch: 20 | loss: 0.0027572
	speed: 0.2965s/iter; left time: 1440.8011s
	iters: 400, epoch: 20 | loss: 0.0587361
	speed: 0.2401s/iter; left time: 1142.6800s
Epoch: 20 cost time: 124.09968304634094
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0004930
	speed: 0.7571s/iter; left time: 3475.6899s
	iters: 200, epoch: 21 | loss: 0.0161786
	speed: 0.2675s/iter; left time: 1201.2017s
	iters: 300, epoch: 21 | loss: 0.0018265
	speed: 0.2469s/iter; left time: 1084.1528s
	iters: 400, epoch: 21 | loss: 0.0035154
	speed: 0.3002s/iter; left time: 1288.0367s
Epoch: 21 cost time: 128.7040889263153
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0004648
	speed: 0.7381s/iter; left time: 3042.4404s
	iters: 200, epoch: 22 | loss: 0.0176242
	speed: 0.2915s/iter; left time: 1172.3206s
	iters: 300, epoch: 22 | loss: 0.0099270
	speed: 0.2602s/iter; left time: 1020.4102s
	iters: 400, epoch: 22 | loss: 0.0065989
	speed: 0.2104s/iter; left time: 804.0789s
Epoch: 22 cost time: 123.60008502006531
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0140359
	speed: 0.6817s/iter; left time: 2490.2747s
	iters: 200, epoch: 23 | loss: 0.0007701
	speed: 0.2263s/iter; left time: 803.9791s
	iters: 300, epoch: 23 | loss: 0.0023496
	speed: 0.2618s/iter; left time: 904.0227s
	iters: 400, epoch: 23 | loss: 0.0945541
	speed: 0.2581s/iter; left time: 865.2524s
Epoch: 23 cost time: 111.72207999229431
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.982561).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0018541
	speed: 0.6633s/iter; left time: 2111.8956s
	iters: 200, epoch: 24 | loss: 0.0098671
	speed: 0.2531s/iter; left time: 780.4068s
	iters: 300, epoch: 24 | loss: 0.0206504
	speed: 0.2217s/iter; left time: 661.4530s
	iters: 400, epoch: 24 | loss: 0.0030911
	speed: 0.2332s/iter; left time: 672.4243s
Epoch: 24 cost time: 114.4901351928711
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.982561 --> -0.984848).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0004337
	speed: 0.6694s/iter; left time: 1817.4755s
	iters: 200, epoch: 25 | loss: 0.0015002
	speed: 0.2492s/iter; left time: 651.5697s
	iters: 300, epoch: 25 | loss: 0.0008035
	speed: 0.2756s/iter; left time: 693.0107s
	iters: 400, epoch: 25 | loss: 0.0006503
	speed: 0.2940s/iter; left time: 710.1176s
Epoch: 25 cost time: 123.20068192481995
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0095593
	speed: 0.7939s/iter; left time: 1783.1335s
	iters: 200, epoch: 26 | loss: 0.0003886
	speed: 0.2747s/iter; left time: 589.5594s
	iters: 300, epoch: 26 | loss: 0.0590052
	speed: 0.2908s/iter; left time: 594.9609s
	iters: 400, epoch: 26 | loss: 0.0007476
	speed: 0.3004s/iter; left time: 584.6221s
Epoch: 26 cost time: 139.65753269195557
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0023628
	speed: 0.7966s/iter; left time: 1415.6198s
	iters: 200, epoch: 27 | loss: 0.1561910
	speed: 0.3094s/iter; left time: 518.9227s
	iters: 300, epoch: 27 | loss: 0.0063028
	speed: 0.2871s/iter; left time: 452.7427s
	iters: 400, epoch: 27 | loss: 0.0035568
	speed: 0.2841s/iter; left time: 419.6833s
Epoch: 27 cost time: 138.83619093894958
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0038472
	speed: 0.7786s/iter; left time: 1018.4488s
	iters: 200, epoch: 28 | loss: 0.0005626
	speed: 0.2810s/iter; left time: 339.4079s
	iters: 300, epoch: 28 | loss: 0.0094829
	speed: 0.2886s/iter; left time: 319.7799s
	iters: 400, epoch: 28 | loss: 0.0001996
	speed: 0.2670s/iter; left time: 269.1842s
Epoch: 28 cost time: 127.62632608413696
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0049332
	speed: 0.7207s/iter; left time: 604.6433s
	iters: 200, epoch: 29 | loss: 0.0549111
	speed: 0.2525s/iter; left time: 186.6314s
	iters: 300, epoch: 29 | loss: 0.0021084
	speed: 0.2483s/iter; left time: 158.6527s
	iters: 400, epoch: 29 | loss: 0.0005645
	speed: 0.2525s/iter; left time: 136.1040s
Epoch: 29 cost time: 124.23116087913513
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0024004
	speed: 0.7010s/iter; left time: 259.3830s
	iters: 200, epoch: 30 | loss: 0.0039467
	speed: 0.2715s/iter; left time: 73.3134s
	iters: 300, epoch: 30 | loss: 0.0015188
	speed: 0.2738s/iter; left time: 46.5474s
	iters: 400, epoch: 30 | loss: 0.1230976
	speed: 0.2532s/iter; left time: 17.7229s
Epoch: 30 cost time: 118.96764492988586
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 65546
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2172599
	speed: 0.2819s/iter; left time: 3938.7697s
	iters: 200, epoch: 1 | loss: 1.7169306
	speed: 0.2549s/iter; left time: 3536.1518s
	iters: 300, epoch: 1 | loss: 1.2617639
	speed: 0.2228s/iter; left time: 3068.0697s
	iters: 400, epoch: 1 | loss: 0.8245580
	speed: 0.2750s/iter; left time: 3759.7809s
Epoch: 1 cost time: 120.0823564529419
Epoch: 1, Steps: 469 | Train Loss: 1.559 Vali Loss: 0.717 Vali Acc: 0.838 Test Loss: 0.717 Test Acc: 0.838
Validation loss decreased (inf --> -0.837900).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3915573
	speed: 0.6930s/iter; left time: 9356.8816s
	iters: 200, epoch: 2 | loss: 0.4798338
	speed: 0.2199s/iter; left time: 2946.4731s
	iters: 300, epoch: 2 | loss: 0.5802696
	speed: 0.2639s/iter; left time: 3510.7067s
	iters: 400, epoch: 2 | loss: 0.2122919
	speed: 0.2401s/iter; left time: 3169.3910s
Epoch: 2 cost time: 115.26805686950684
Epoch: 2, Steps: 469 | Train Loss: 0.385 Vali Loss: 0.262 Vali Acc: 0.918 Test Loss: 0.262 Test Acc: 0.918
Validation loss decreased (-0.837900 --> -0.918236).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1651471
	speed: 0.6751s/iter; left time: 8799.1666s
	iters: 200, epoch: 3 | loss: 0.1761185
	speed: 0.2571s/iter; left time: 3324.5173s
	iters: 300, epoch: 3 | loss: 0.2288369
	speed: 0.2363s/iter; left time: 3032.0321s
	iters: 400, epoch: 3 | loss: 0.0245446
	speed: 0.2561s/iter; left time: 3261.4792s
Epoch: 3 cost time: 117.51408314704895
Epoch: 3, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
Validation loss decreased (-0.918236 --> -0.948826).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2088047
	speed: 0.6650s/iter; left time: 8355.2111s
	iters: 200, epoch: 4 | loss: 0.0639764
	speed: 0.1674s/iter; left time: 2086.7295s
	iters: 300, epoch: 4 | loss: 0.0341750
	speed: 0.2231s/iter; left time: 2758.4476s
	iters: 400, epoch: 4 | loss: 0.1081986
	speed: 0.2102s/iter; left time: 2577.3474s
Epoch: 4 cost time: 99.34343671798706
Epoch: 4, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0319772
	speed: 0.5531s/iter; left time: 6689.7144s
	iters: 200, epoch: 5 | loss: 0.0342350
	speed: 0.2164s/iter; left time: 2595.9131s
	iters: 300, epoch: 5 | loss: 0.0430163
	speed: 0.1941s/iter; left time: 2308.5164s
	iters: 400, epoch: 5 | loss: 0.0268464
	speed: 0.2134s/iter; left time: 2516.5491s
Epoch: 5 cost time: 94.7941267490387
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.948826 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0248530
	speed: 0.5711s/iter; left time: 6640.0185s
	iters: 200, epoch: 6 | loss: 0.0725180
	speed: 0.1908s/iter; left time: 2199.6836s
	iters: 300, epoch: 6 | loss: 0.1158378
	speed: 0.2247s/iter; left time: 2567.2263s
	iters: 400, epoch: 6 | loss: 0.0124490
	speed: 0.1632s/iter; left time: 1848.5105s
Epoch: 6 cost time: 88.82290649414062
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.973984).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0437243
	speed: 0.5345s/iter; left time: 5963.0445s
	iters: 200, epoch: 7 | loss: 0.0783155
	speed: 0.2482s/iter; left time: 2744.6434s
	iters: 300, epoch: 7 | loss: 0.0394772
	speed: 0.2843s/iter; left time: 3114.9562s
	iters: 400, epoch: 7 | loss: 0.1116511
	speed: 0.2249s/iter; left time: 2442.0139s
Epoch: 7 cost time: 119.62810730934143
Epoch: 7, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0281585
	speed: 0.7150s/iter; left time: 7641.5804s
	iters: 200, epoch: 8 | loss: 0.0813570
	speed: 0.2700s/iter; left time: 2858.4460s
	iters: 300, epoch: 8 | loss: 0.0025571
	speed: 0.2585s/iter; left time: 2711.5635s
	iters: 400, epoch: 8 | loss: 0.0546051
	speed: 0.2955s/iter; left time: 3069.6856s
Epoch: 8 cost time: 124.36270332336426
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1797728
	speed: 0.7213s/iter; left time: 7370.9828s
	iters: 200, epoch: 9 | loss: 0.0635760
	speed: 0.2850s/iter; left time: 2883.7609s
	iters: 300, epoch: 9 | loss: 0.0152477
	speed: 0.2669s/iter; left time: 2674.2094s
	iters: 400, epoch: 9 | loss: 0.0022664
	speed: 0.2609s/iter; left time: 2588.2376s
Epoch: 9 cost time: 130.6429946422577
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.973984 --> -0.981989).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2613185
	speed: 0.6967s/iter; left time: 6792.4566s
	iters: 200, epoch: 10 | loss: 0.0340158
	speed: 0.2300s/iter; left time: 2219.9764s
	iters: 300, epoch: 10 | loss: 0.2139867
	speed: 0.2247s/iter; left time: 2145.6699s
	iters: 400, epoch: 10 | loss: 0.0775385
	speed: 0.2378s/iter; left time: 2247.6790s
Epoch: 10 cost time: 107.73284077644348
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0113777
	speed: 0.6174s/iter; left time: 5730.2205s
	iters: 200, epoch: 11 | loss: 0.0972838
	speed: 0.2380s/iter; left time: 2184.6779s
	iters: 300, epoch: 11 | loss: 0.0029813
	speed: 0.2308s/iter; left time: 2096.3075s
	iters: 400, epoch: 11 | loss: 0.0037405
	speed: 0.2122s/iter; left time: 1905.9080s
Epoch: 11 cost time: 109.6714174747467
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0108723
	speed: 0.6844s/iter; left time: 6031.3227s
	iters: 200, epoch: 12 | loss: 0.0015800
	speed: 0.1792s/iter; left time: 1561.2403s
	iters: 300, epoch: 12 | loss: 0.0063994
	speed: 0.2020s/iter; left time: 1740.0396s
	iters: 400, epoch: 12 | loss: 0.0219960
	speed: 0.2260s/iter; left time: 1923.3969s
Epoch: 12 cost time: 99.24015188217163
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0398797
	speed: 0.5767s/iter; left time: 4811.0410s
	iters: 200, epoch: 13 | loss: 0.0041232
	speed: 0.2617s/iter; left time: 2156.8991s
	iters: 300, epoch: 13 | loss: 0.0070417
	speed: 0.2595s/iter; left time: 2112.7059s
	iters: 400, epoch: 13 | loss: 0.0043950
	speed: 0.2589s/iter; left time: 2082.0299s
Epoch: 13 cost time: 118.36544704437256
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0067117
	speed: 0.6198s/iter; left time: 4880.5086s
	iters: 200, epoch: 14 | loss: 0.0017662
	speed: 0.2137s/iter; left time: 1661.3061s
	iters: 300, epoch: 14 | loss: 0.0003742
	speed: 0.2184s/iter; left time: 1675.8149s
	iters: 400, epoch: 14 | loss: 0.0052906
	speed: 0.2061s/iter; left time: 1560.7298s
Epoch: 14 cost time: 97.86530232429504
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.982847).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0026516
	speed: 0.6016s/iter; left time: 4454.8751s
	iters: 200, epoch: 15 | loss: 0.0008443
	speed: 0.2070s/iter; left time: 1512.4401s
	iters: 300, epoch: 15 | loss: 0.0338951
	speed: 0.2146s/iter; left time: 1546.0799s
	iters: 400, epoch: 15 | loss: 0.0022032
	speed: 0.2242s/iter; left time: 1592.9239s
Epoch: 15 cost time: 101.7186951637268
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0190136
	speed: 0.5217s/iter; left time: 3618.2724s
	iters: 200, epoch: 16 | loss: 0.0145703
	speed: 0.1780s/iter; left time: 1216.6976s
	iters: 300, epoch: 16 | loss: 0.0150902
	speed: 0.1349s/iter; left time: 908.5825s
	iters: 400, epoch: 16 | loss: 0.0013008
	speed: 0.1702s/iter; left time: 1129.1300s
Epoch: 16 cost time: 75.93623614311218
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0093073
	speed: 0.5620s/iter; left time: 3634.2636s
	iters: 200, epoch: 17 | loss: 0.0024280
	speed: 0.2126s/iter; left time: 1353.6757s
	iters: 300, epoch: 17 | loss: 0.0045277
	speed: 0.2445s/iter; left time: 1532.1086s
	iters: 400, epoch: 17 | loss: 0.0062980
	speed: 0.2045s/iter; left time: 1260.9617s
Epoch: 17 cost time: 107.2490029335022
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2125094
	speed: 0.6096s/iter; left time: 3656.1984s
	iters: 200, epoch: 18 | loss: 0.0029437
	speed: 0.2458s/iter; left time: 1449.6337s
	iters: 300, epoch: 18 | loss: 0.0024654
	speed: 0.1800s/iter; left time: 1043.6522s
	iters: 400, epoch: 18 | loss: 0.0017197
	speed: 0.1993s/iter; left time: 1135.7299s
Epoch: 18 cost time: 106.0584557056427
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0039465
	speed: 0.8012s/iter; left time: 4429.9503s
	iters: 200, epoch: 19 | loss: 0.0073253
	speed: 0.3588s/iter; left time: 1947.6947s
	iters: 300, epoch: 19 | loss: 0.0012296
	speed: 0.3226s/iter; left time: 1719.2286s
	iters: 400, epoch: 19 | loss: 0.0024414
	speed: 0.3310s/iter; left time: 1730.6150s
Epoch: 19 cost time: 152.32205033302307
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0124417
	speed: 0.8563s/iter; left time: 4332.7780s
	iters: 200, epoch: 20 | loss: 0.0689050
	speed: 0.3384s/iter; left time: 1678.4509s
	iters: 300, epoch: 20 | loss: 0.0012935
	speed: 0.3449s/iter; left time: 1676.4487s
	iters: 400, epoch: 20 | loss: 0.0050296
	speed: 0.3187s/iter; left time: 1516.9843s
Epoch: 20 cost time: 155.15898966789246
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0112159
	speed: 0.8828s/iter; left time: 4052.9606s
	iters: 200, epoch: 21 | loss: 0.0006611
	speed: 0.3092s/iter; left time: 1388.6529s
	iters: 300, epoch: 21 | loss: 0.0090035
	speed: 0.3666s/iter; left time: 1609.9445s
	iters: 400, epoch: 21 | loss: 0.0110556
	speed: 0.3129s/iter; left time: 1342.5145s
Epoch: 21 cost time: 156.26993799209595
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0005899
	speed: 0.8177s/iter; left time: 3370.7181s
	iters: 200, epoch: 22 | loss: 0.0251974
	speed: 0.3062s/iter; left time: 1231.5877s
	iters: 300, epoch: 22 | loss: 0.0004780
	speed: 0.2854s/iter; left time: 1119.1583s
	iters: 400, epoch: 22 | loss: 0.0047504
	speed: 0.3304s/iter; left time: 1262.7928s
Epoch: 22 cost time: 138.83913040161133
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2180421
	speed: 0.7855s/iter; left time: 2869.5638s
	iters: 200, epoch: 23 | loss: 0.0061931
	speed: 0.2621s/iter; left time: 931.1953s
	iters: 300, epoch: 23 | loss: 0.0021492
	speed: 0.3128s/iter; left time: 1079.9590s
	iters: 400, epoch: 23 | loss: 0.0006195
	speed: 0.2975s/iter; left time: 997.4236s
Epoch: 23 cost time: 142.15442490577698
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0053116
	speed: 0.7992s/iter; left time: 2544.5394s
	iters: 200, epoch: 24 | loss: 0.0014021
	speed: 0.3020s/iter; left time: 931.4105s
	iters: 300, epoch: 24 | loss: 0.0141331
	speed: 0.2510s/iter; left time: 749.0515s
	iters: 400, epoch: 24 | loss: 0.0008534
	speed: 0.2644s/iter; left time: 762.4554s
Epoch: 24 cost time: 135.10025691986084
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 220826
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2092454
	speed: 0.2158s/iter; left time: 3014.5444s
	iters: 200, epoch: 1 | loss: 1.6833743
	speed: 0.2186s/iter; left time: 3032.7731s
	iters: 300, epoch: 1 | loss: 1.3340420
	speed: 0.1906s/iter; left time: 2625.4227s
	iters: 400, epoch: 1 | loss: 0.7868708
	speed: 0.1869s/iter; left time: 2554.9585s
Epoch: 1 cost time: 97.0375030040741
Epoch: 1, Steps: 469 | Train Loss: 1.547 Vali Loss: 0.714 Vali Acc: 0.833 Test Loss: 0.714 Test Acc: 0.833
Validation loss decreased (inf --> -0.833326).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3441129
	speed: 0.6362s/iter; left time: 8589.8156s
	iters: 200, epoch: 2 | loss: 0.4766396
	speed: 0.1953s/iter; left time: 2616.7513s
	iters: 300, epoch: 2 | loss: 0.2372496
	speed: 0.1868s/iter; left time: 2484.9906s
	iters: 400, epoch: 2 | loss: 0.2299076
	speed: 0.2315s/iter; left time: 3056.9033s
Epoch: 2 cost time: 96.29129600524902
Epoch: 2, Steps: 469 | Train Loss: 0.418 Vali Loss: 0.264 Vali Acc: 0.910 Test Loss: 0.264 Test Acc: 0.910
Validation loss decreased (-0.833326 --> -0.909946).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2013465
	speed: 0.5989s/iter; left time: 7805.3686s
	iters: 200, epoch: 3 | loss: 0.1145149
	speed: 0.2050s/iter; left time: 2651.6020s
	iters: 300, epoch: 3 | loss: 0.0409531
	speed: 0.2313s/iter; left time: 2967.8244s
	iters: 400, epoch: 3 | loss: 0.1658813
	speed: 0.1833s/iter; left time: 2334.3491s
Epoch: 3 cost time: 94.83671879768372
Epoch: 3, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.147 Vali Acc: 0.952 Test Loss: 0.147 Test Acc: 0.952
Validation loss decreased (-0.909946 --> -0.951971).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1926541
	speed: 0.6088s/iter; left time: 7649.1684s
	iters: 200, epoch: 4 | loss: 0.0792230
	speed: 0.2230s/iter; left time: 2779.7738s
	iters: 300, epoch: 4 | loss: 0.1607050
	speed: 0.1544s/iter; left time: 1909.5109s
	iters: 400, epoch: 4 | loss: 0.0809772
	speed: 0.1646s/iter; left time: 2018.2967s
Epoch: 4 cost time: 89.33814573287964
Epoch: 4, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
Validation loss decreased (-0.951971 --> -0.965979).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0213152
	speed: 0.5711s/iter; left time: 6907.6407s
	iters: 200, epoch: 5 | loss: 0.3680157
	speed: 0.1686s/iter; left time: 2021.7598s
	iters: 300, epoch: 5 | loss: 0.0858983
	speed: 0.1702s/iter; left time: 2025.0340s
	iters: 400, epoch: 5 | loss: 0.0483106
	speed: 0.2127s/iter; left time: 2508.4005s
Epoch: 5 cost time: 85.15399050712585
Epoch: 5, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.965979 --> -0.967981).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0088659
	speed: 0.5422s/iter; left time: 6303.9194s
	iters: 200, epoch: 6 | loss: 0.0098954
	speed: 0.1785s/iter; left time: 2057.6152s
	iters: 300, epoch: 6 | loss: 0.2432954
	speed: 0.2032s/iter; left time: 2322.0554s
	iters: 400, epoch: 6 | loss: 0.0276129
	speed: 0.1617s/iter; left time: 1831.1931s
Epoch: 6 cost time: 83.4406807422638
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.967981 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0127016
	speed: 0.5526s/iter; left time: 6165.6864s
	iters: 200, epoch: 7 | loss: 0.0102831
	speed: 0.1911s/iter; left time: 2112.7237s
	iters: 300, epoch: 7 | loss: 0.0188989
	speed: 0.1633s/iter; left time: 1789.1640s
	iters: 400, epoch: 7 | loss: 0.2839509
	speed: 0.1599s/iter; left time: 1736.0392s
Epoch: 7 cost time: 84.55552673339844
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1261929
	speed: 0.5674s/iter; left time: 6064.5369s
	iters: 200, epoch: 8 | loss: 0.2446757
	speed: 0.1744s/iter; left time: 1846.1815s
	iters: 300, epoch: 8 | loss: 0.0040164
	speed: 0.1961s/iter; left time: 2056.4622s
	iters: 400, epoch: 8 | loss: 0.0696109
	speed: 0.2253s/iter; left time: 2340.6769s
Epoch: 8 cost time: 90.82692074775696
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.973412 --> -0.978844).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0686940
	speed: 0.6063s/iter; left time: 6196.1342s
	iters: 200, epoch: 9 | loss: 0.0306823
	speed: 0.2013s/iter; left time: 2036.9316s
	iters: 300, epoch: 9 | loss: 0.0203197
	speed: 0.2199s/iter; left time: 2203.3637s
	iters: 400, epoch: 9 | loss: 0.0128500
	speed: 0.1915s/iter; left time: 1899.8756s
Epoch: 9 cost time: 95.58239507675171
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0616837
	speed: 0.4850s/iter; left time: 4728.9997s
	iters: 200, epoch: 10 | loss: 0.0163250
	speed: 0.1964s/iter; left time: 1895.4295s
	iters: 300, epoch: 10 | loss: 0.0251146
	speed: 0.1559s/iter; left time: 1488.9203s
	iters: 400, epoch: 10 | loss: 0.0863719
	speed: 0.2109s/iter; left time: 1993.3764s
Epoch: 10 cost time: 81.21113085746765
Epoch: 10, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0565030
	speed: 0.5620s/iter; left time: 5216.1772s
	iters: 200, epoch: 11 | loss: 0.0039563
	speed: 0.1808s/iter; left time: 1659.6888s
	iters: 300, epoch: 11 | loss: 0.0388647
	speed: 0.1767s/iter; left time: 1604.3341s
	iters: 400, epoch: 11 | loss: 0.0309691
	speed: 0.2019s/iter; left time: 1812.8183s
Epoch: 11 cost time: 86.12214756011963
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0083597
	speed: 0.5398s/iter; left time: 4756.8170s
	iters: 200, epoch: 12 | loss: 0.0069859
	speed: 0.1681s/iter; left time: 1464.2612s
	iters: 300, epoch: 12 | loss: 0.0284591
	speed: 0.1711s/iter; left time: 1473.5738s
	iters: 400, epoch: 12 | loss: 0.0429008
	speed: 0.1425s/iter; left time: 1212.9202s
Epoch: 12 cost time: 75.99800276756287
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0568951
	speed: 0.4926s/iter; left time: 4110.1080s
	iters: 200, epoch: 13 | loss: 0.0078369
	speed: 0.1601s/iter; left time: 1319.3276s
	iters: 300, epoch: 13 | loss: 0.0214559
	speed: 0.1680s/iter; left time: 1368.0545s
	iters: 400, epoch: 13 | loss: 0.0072567
	speed: 0.1223s/iter; left time: 983.3759s
Epoch: 13 cost time: 73.19180941581726
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0772560
	speed: 0.5251s/iter; left time: 4134.6746s
	iters: 200, epoch: 14 | loss: 0.0706986
	speed: 0.1571s/iter; left time: 1221.3531s
	iters: 300, epoch: 14 | loss: 0.0155195
	speed: 0.1565s/iter; left time: 1200.8258s
	iters: 400, epoch: 14 | loss: 0.0070040
	speed: 0.1449s/iter; left time: 1097.5391s
Epoch: 14 cost time: 74.49007177352905
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0358675
	speed: 0.5030s/iter; left time: 3724.6542s
	iters: 200, epoch: 15 | loss: 0.0273377
	speed: 0.1795s/iter; left time: 1311.2759s
	iters: 300, epoch: 15 | loss: 0.1078918
	speed: 0.1490s/iter; left time: 1073.5801s
	iters: 400, epoch: 15 | loss: 0.0010949
	speed: 0.2085s/iter; left time: 1481.6724s
Epoch: 15 cost time: 88.60710501670837
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0012085
	speed: 0.5669s/iter; left time: 3931.6838s
	iters: 200, epoch: 16 | loss: 0.0138029
	speed: 0.1951s/iter; left time: 1334.0049s
	iters: 300, epoch: 16 | loss: 0.0016859
	speed: 0.2004s/iter; left time: 1350.0779s
	iters: 400, epoch: 16 | loss: 0.0023685
	speed: 0.2020s/iter; left time: 1340.7282s
Epoch: 16 cost time: 93.69309115409851
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0632565
	speed: 0.6039s/iter; left time: 3905.2654s
	iters: 200, epoch: 17 | loss: 0.0291661
	speed: 0.2173s/iter; left time: 1383.2970s
	iters: 300, epoch: 17 | loss: 0.0439666
	speed: 0.2178s/iter; left time: 1365.0760s
	iters: 400, epoch: 17 | loss: 0.0023057
	speed: 0.1752s/iter; left time: 1080.4501s
Epoch: 17 cost time: 93.33711171150208
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.979416 --> -0.983990).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0028248
	speed: 0.6198s/iter; left time: 3717.4184s
	iters: 200, epoch: 18 | loss: 0.0355445
	speed: 0.2137s/iter; left time: 1260.6084s
	iters: 300, epoch: 18 | loss: 0.0130039
	speed: 0.2061s/iter; left time: 1195.1259s
	iters: 400, epoch: 18 | loss: 0.0376074
	speed: 0.2056s/iter; left time: 1171.7777s
Epoch: 18 cost time: 95.30604076385498
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0018810
	speed: 0.5826s/iter; left time: 3221.4349s
	iters: 200, epoch: 19 | loss: 0.0045056
	speed: 0.1644s/iter; left time: 892.3188s
	iters: 300, epoch: 19 | loss: 0.1470851
	speed: 0.1929s/iter; left time: 1027.7023s
	iters: 400, epoch: 19 | loss: 0.0016555
	speed: 0.1944s/iter; left time: 1016.4557s
Epoch: 19 cost time: 86.370689868927
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0086578
	speed: 0.5706s/iter; left time: 2887.2153s
	iters: 200, epoch: 20 | loss: 0.0007002
	speed: 0.1424s/iter; left time: 706.2405s
	iters: 300, epoch: 20 | loss: 0.0058262
	speed: 0.1558s/iter; left time: 757.3471s
	iters: 400, epoch: 20 | loss: 0.0888895
	speed: 0.1755s/iter; left time: 835.6159s
Epoch: 20 cost time: 80.03314065933228
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0009556
	speed: 0.5087s/iter; left time: 2335.5998s
	iters: 200, epoch: 21 | loss: 0.0146986
	speed: 0.1812s/iter; left time: 813.6255s
	iters: 300, epoch: 21 | loss: 0.0018020
	speed: 0.1322s/iter; left time: 580.6133s
	iters: 400, epoch: 21 | loss: 0.0020312
	speed: 0.1681s/iter; left time: 721.1488s
Epoch: 21 cost time: 77.17401123046875
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0005896
	speed: 0.4910s/iter; left time: 2024.0468s
	iters: 200, epoch: 22 | loss: 0.0289285
	speed: 0.1756s/iter; left time: 706.4299s
	iters: 300, epoch: 22 | loss: 0.0052248
	speed: 0.1760s/iter; left time: 690.1737s
	iters: 400, epoch: 22 | loss: 0.0212546
	speed: 0.1370s/iter; left time: 523.5714s
Epoch: 22 cost time: 75.06183695793152
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1308196
	speed: 0.5142s/iter; left time: 1878.4833s
	iters: 200, epoch: 23 | loss: 0.0007922
	speed: 0.1578s/iter; left time: 560.7771s
	iters: 300, epoch: 23 | loss: 0.0168016
	speed: 0.1756s/iter; left time: 606.4394s
	iters: 400, epoch: 23 | loss: 0.0111202
	speed: 0.1660s/iter; left time: 556.5376s
Epoch: 23 cost time: 74.91545009613037
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0095258
	speed: 0.4845s/iter; left time: 1542.6975s
	iters: 200, epoch: 24 | loss: 0.0349304
	speed: 0.1753s/iter; left time: 540.5436s
	iters: 300, epoch: 24 | loss: 0.1026611
	speed: 0.1879s/iter; left time: 560.8245s
	iters: 400, epoch: 24 | loss: 0.0007623
	speed: 0.1957s/iter; left time: 564.3295s
Epoch: 24 cost time: 84.43743538856506
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0004539
	speed: 0.5776s/iter; left time: 1568.1697s
	iters: 200, epoch: 25 | loss: 0.0006073
	speed: 0.1636s/iter; left time: 427.8481s
	iters: 300, epoch: 25 | loss: 0.0010370
	speed: 0.1796s/iter; left time: 451.8131s
	iters: 400, epoch: 25 | loss: 0.0004468
	speed: 0.1416s/iter; left time: 341.8767s
Epoch: 25 cost time: 76.08460521697998
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0022648
	speed: 0.4375s/iter; left time: 982.6181s
	iters: 200, epoch: 26 | loss: 0.0002419
	speed: 0.1653s/iter; left time: 354.6500s
	iters: 300, epoch: 26 | loss: 0.0741599
	speed: 0.1479s/iter; left time: 302.6010s
	iters: 400, epoch: 26 | loss: 0.0023861
	speed: 0.1480s/iter; left time: 288.0963s
Epoch: 26 cost time: 72.39961814880371
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0022164
	speed: 0.4840s/iter; left time: 860.1254s
	iters: 200, epoch: 27 | loss: 0.0834048
	speed: 0.1376s/iter; left time: 230.7336s
	iters: 300, epoch: 27 | loss: 0.0043190
	speed: 0.1690s/iter; left time: 266.5294s
	iters: 400, epoch: 27 | loss: 0.0017613
	speed: 0.1462s/iter; left time: 215.8999s
Epoch: 27 cost time: 71.27495074272156
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.984276).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0321024
	speed: 0.4370s/iter; left time: 571.5338s
	iters: 200, epoch: 28 | loss: 0.0012835
	speed: 0.1317s/iter; left time: 159.0670s
	iters: 300, epoch: 28 | loss: 0.0050238
	speed: 0.1337s/iter; left time: 148.1557s
	iters: 400, epoch: 28 | loss: 0.0001993
	speed: 0.1347s/iter; left time: 135.7319s
Epoch: 28 cost time: 61.944525480270386
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0026198
	speed: 0.4260s/iter; left time: 357.3873s
	iters: 200, epoch: 29 | loss: 0.0047479
	speed: 0.1292s/iter; left time: 95.4894s
	iters: 300, epoch: 29 | loss: 0.0029564
	speed: 0.1098s/iter; left time: 70.1624s
	iters: 400, epoch: 29 | loss: 0.0002849
	speed: 0.1462s/iter; left time: 78.7971s
Epoch: 29 cost time: 59.07147455215454
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0123989
	speed: 0.4111s/iter; left time: 152.1211s
	iters: 200, epoch: 30 | loss: 0.0025381
	speed: 0.1362s/iter; left time: 36.7780s
	iters: 300, epoch: 30 | loss: 0.0033858
	speed: 0.1282s/iter; left time: 21.8017s
	iters: 400, epoch: 30 | loss: 0.0122514
	speed: 0.1320s/iter; left time: 9.2423s
Epoch: 30 cost time: 61.2449004650116
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 65546
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2257786
	speed: 0.1458s/iter; left time: 2037.0696s
	iters: 200, epoch: 1 | loss: 1.7471156
	speed: 0.1475s/iter; left time: 2045.8826s
	iters: 300, epoch: 1 | loss: 1.3811128
	speed: 0.1069s/iter; left time: 1471.8872s
	iters: 400, epoch: 1 | loss: 1.0506936
	speed: 0.1376s/iter; left time: 1880.5981s
Epoch: 1 cost time: 63.53821325302124
Epoch: 1, Steps: 469 | Train Loss: 1.629 Vali Loss: 0.861 Vali Acc: 0.803 Test Loss: 0.861 Test Acc: 0.803
Validation loss decreased (inf --> -0.803022).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4840055
	speed: 0.4530s/iter; left time: 6115.9876s
	iters: 200, epoch: 2 | loss: 0.5622981
	speed: 0.1434s/iter; left time: 1922.2457s
	iters: 300, epoch: 2 | loss: 0.6462596
	speed: 0.1525s/iter; left time: 2027.8981s
	iters: 400, epoch: 2 | loss: 0.2422797
	speed: 0.1519s/iter; left time: 2005.1530s
Epoch: 2 cost time: 69.3735363483429
Epoch: 2, Steps: 469 | Train Loss: 0.506 Vali Loss: 0.341 Vali Acc: 0.906 Test Loss: 0.341 Test Acc: 0.906
Validation loss decreased (-0.803022 --> -0.906229).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3573415
	speed: 0.4908s/iter; left time: 6396.8870s
	iters: 200, epoch: 3 | loss: 0.1367873
	speed: 0.1524s/iter; left time: 1971.3250s
	iters: 300, epoch: 3 | loss: 0.3340855
	speed: 0.1577s/iter; left time: 2023.4114s
	iters: 400, epoch: 3 | loss: 0.0424543
	speed: 0.1347s/iter; left time: 1714.5636s
Epoch: 3 cost time: 70.72434735298157
Epoch: 3, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.204 Vali Acc: 0.927 Test Loss: 0.204 Test Acc: 0.927
Validation loss decreased (-0.906229 --> -0.927099).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1023649
	speed: 0.5087s/iter; left time: 6390.9846s
	iters: 200, epoch: 4 | loss: 0.1442349
	speed: 0.1423s/iter; left time: 1773.2910s
	iters: 300, epoch: 4 | loss: 0.0811224
	speed: 0.1383s/iter; left time: 1709.6351s
	iters: 400, epoch: 4 | loss: 0.2414578
	speed: 0.1667s/iter; left time: 2044.2612s
Epoch: 4 cost time: 70.39934134483337
Epoch: 4, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.927099 --> -0.949112).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0680877
	speed: 0.4212s/iter; left time: 5093.8202s
	iters: 200, epoch: 5 | loss: 0.0488120
	speed: 0.1478s/iter; left time: 1773.1908s
	iters: 300, epoch: 5 | loss: 0.0371800
	speed: 0.1376s/iter; left time: 1637.1181s
	iters: 400, epoch: 5 | loss: 0.0148101
	speed: 0.1319s/iter; left time: 1555.3967s
Epoch: 5 cost time: 62.77221083641052
Epoch: 5, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
Validation loss decreased (-0.949112 --> -0.959118).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0621423
	speed: 0.4665s/iter; left time: 5423.8382s
	iters: 200, epoch: 6 | loss: 0.0176664
	speed: 0.1447s/iter; left time: 1667.9890s
	iters: 300, epoch: 6 | loss: 0.1397337
	speed: 0.1141s/iter; left time: 1303.8412s
	iters: 400, epoch: 6 | loss: 0.0235172
	speed: 0.0958s/iter; left time: 1084.7970s
Epoch: 6 cost time: 54.224714279174805
Epoch: 6, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.959118 --> -0.973127).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0914322
	speed: 0.3080s/iter; left time: 3436.1812s
	iters: 200, epoch: 7 | loss: 0.0766825
	speed: 0.0924s/iter; left time: 1022.2101s
	iters: 300, epoch: 7 | loss: 0.0554403
	speed: 0.0955s/iter; left time: 1046.1035s
	iters: 400, epoch: 7 | loss: 0.1085678
	speed: 0.0824s/iter; left time: 895.0388s
Epoch: 7 cost time: 43.99946475028992
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0518694
	speed: 0.3441s/iter; left time: 3677.5205s
	iters: 200, epoch: 8 | loss: 0.0186144
	speed: 0.0879s/iter; left time: 930.4001s
	iters: 300, epoch: 8 | loss: 0.0181017
	speed: 0.1006s/iter; left time: 1055.2930s
	iters: 400, epoch: 8 | loss: 0.0335340
	speed: 0.0892s/iter; left time: 926.3667s
Epoch: 8 cost time: 44.133676528930664
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1284698
	speed: 0.3153s/iter; left time: 3221.7915s
	iters: 200, epoch: 9 | loss: 0.1411535
	speed: 0.1012s/iter; left time: 1024.4963s
	iters: 300, epoch: 9 | loss: 0.0658790
	speed: 0.0840s/iter; left time: 841.8158s
	iters: 400, epoch: 9 | loss: 0.0053091
	speed: 0.1071s/iter; left time: 1062.0765s
Epoch: 9 cost time: 43.603267669677734
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.973127 --> -0.982275).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5613837
	speed: 0.3252s/iter; left time: 3171.0037s
	iters: 200, epoch: 10 | loss: 0.0303091
	speed: 0.0885s/iter; left time: 854.4068s
	iters: 300, epoch: 10 | loss: 0.2419506
	speed: 0.0971s/iter; left time: 927.5193s
	iters: 400, epoch: 10 | loss: 0.0553487
	speed: 0.0853s/iter; left time: 805.8706s
Epoch: 10 cost time: 44.787787437438965
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0446624
	speed: 0.3378s/iter; left time: 3134.9857s
	iters: 200, epoch: 11 | loss: 0.1362880
	speed: 0.1015s/iter; left time: 931.6637s
	iters: 300, epoch: 11 | loss: 0.0017738
	speed: 0.0933s/iter; left time: 847.4850s
	iters: 400, epoch: 11 | loss: 0.0026933
	speed: 0.1191s/iter; left time: 1069.4846s
Epoch: 11 cost time: 49.4457061290741
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0862585
	speed: 0.4624s/iter; left time: 4074.6229s
	iters: 200, epoch: 12 | loss: 0.0034141
	speed: 0.2047s/iter; left time: 1783.2953s
	iters: 300, epoch: 12 | loss: 0.0043675
	speed: 0.1794s/iter; left time: 1544.9564s
	iters: 400, epoch: 12 | loss: 0.0137903
	speed: 0.1682s/iter; left time: 1431.5075s
Epoch: 12 cost time: 87.34561038017273
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0054155
	speed: 0.5909s/iter; left time: 4930.0772s
	iters: 200, epoch: 13 | loss: 0.0403693
	speed: 0.2055s/iter; left time: 1693.8540s
	iters: 300, epoch: 13 | loss: 0.0728218
	speed: 0.1729s/iter; left time: 1407.7402s
	iters: 400, epoch: 13 | loss: 0.0025267
	speed: 0.1688s/iter; left time: 1357.7295s
Epoch: 13 cost time: 87.1019434928894
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0305517
	speed: 0.5987s/iter; left time: 4713.9524s
	iters: 200, epoch: 14 | loss: 0.0008008
	speed: 0.1971s/iter; left time: 1532.4327s
	iters: 300, epoch: 14 | loss: 0.0092327
	speed: 0.1692s/iter; left time: 1298.5660s
	iters: 400, epoch: 14 | loss: 0.0108347
	speed: 0.1706s/iter; left time: 1292.2078s
Epoch: 14 cost time: 86.4888482093811
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983418).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0114595
	speed: 0.6070s/iter; left time: 4494.7547s
	iters: 200, epoch: 15 | loss: 0.0012993
	speed: 0.1933s/iter; left time: 1411.9126s
	iters: 300, epoch: 15 | loss: 0.0048324
	speed: 0.1671s/iter; left time: 1204.1139s
	iters: 400, epoch: 15 | loss: 0.0008969
	speed: 0.1338s/iter; left time: 950.5709s
Epoch: 15 cost time: 81.48674440383911
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
Validation loss decreased (-0.983418 --> -0.987421).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0478967
	speed: 0.5556s/iter; left time: 3853.3102s
	iters: 200, epoch: 16 | loss: 0.0062273
	speed: 0.1726s/iter; left time: 1179.7396s
	iters: 300, epoch: 16 | loss: 0.0091800
	speed: 0.1585s/iter; left time: 1067.3661s
	iters: 400, epoch: 16 | loss: 0.0143396
	speed: 0.1486s/iter; left time: 986.2195s
Epoch: 16 cost time: 76.75954127311707
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0081777
	speed: 0.5413s/iter; left time: 3500.4189s
	iters: 200, epoch: 17 | loss: 0.0024265
	speed: 0.1709s/iter; left time: 1088.0246s
	iters: 300, epoch: 17 | loss: 0.0028131
	speed: 0.1591s/iter; left time: 997.3377s
	iters: 400, epoch: 17 | loss: 0.0130982
	speed: 0.1636s/iter; left time: 1008.9701s
Epoch: 17 cost time: 76.78968977928162
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3158439
	speed: 0.5322s/iter; left time: 3191.8753s
	iters: 200, epoch: 18 | loss: 0.0008467
	speed: 0.1689s/iter; left time: 996.3891s
	iters: 300, epoch: 18 | loss: 0.0757670
	speed: 0.1727s/iter; left time: 1001.5687s
	iters: 400, epoch: 18 | loss: 0.0011493
	speed: 0.1639s/iter; left time: 933.7889s
Epoch: 18 cost time: 77.43832993507385
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0096119
	speed: 0.5278s/iter; left time: 2918.3087s
	iters: 200, epoch: 19 | loss: 0.0660532
	speed: 0.1585s/iter; left time: 860.6809s
	iters: 300, epoch: 19 | loss: 0.0011010
	speed: 0.1825s/iter; left time: 972.3381s
	iters: 400, epoch: 19 | loss: 0.0026078
	speed: 0.1628s/iter; left time: 851.2648s
Epoch: 19 cost time: 76.69933032989502
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.050 Vali Acc: 0.987 Test Loss: 0.050 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0243293
	speed: 0.4990s/iter; left time: 2525.1518s
	iters: 200, epoch: 20 | loss: 0.0158780
	speed: 0.1718s/iter; left time: 851.9767s
	iters: 300, epoch: 20 | loss: 0.0040302
	speed: 0.1911s/iter; left time: 928.9339s
	iters: 400, epoch: 20 | loss: 0.0116733
	speed: 0.1690s/iter; left time: 804.2709s
Epoch: 20 cost time: 76.79150557518005
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.054 Vali Acc: 0.984 Test Loss: 0.054 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0160374
	speed: 0.5219s/iter; left time: 2396.2471s
	iters: 200, epoch: 21 | loss: 0.0017423
	speed: 0.1677s/iter; left time: 753.1129s
	iters: 300, epoch: 21 | loss: 0.0081270
	speed: 0.1529s/iter; left time: 671.3902s
	iters: 400, epoch: 21 | loss: 0.0460193
	speed: 0.1597s/iter; left time: 685.4517s
Epoch: 21 cost time: 73.70796060562134
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0023185
	speed: 0.4902s/iter; left time: 2020.4642s
	iters: 200, epoch: 22 | loss: 0.0076893
	speed: 0.0949s/iter; left time: 381.6961s
	iters: 300, epoch: 22 | loss: 0.0013621
	speed: 0.1008s/iter; left time: 395.4921s
	iters: 400, epoch: 22 | loss: 0.0781467
	speed: 0.1419s/iter; left time: 542.3544s
Epoch: 22 cost time: 58.100703954696655
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.1387806
	speed: 0.4686s/iter; left time: 1711.6289s
	iters: 200, epoch: 23 | loss: 0.0038475
	speed: 0.1517s/iter; left time: 538.8126s
	iters: 300, epoch: 23 | loss: 0.0300268
	speed: 0.1532s/iter; left time: 529.1149s
	iters: 400, epoch: 23 | loss: 0.0048726
	speed: 0.1278s/iter; left time: 428.3876s
Epoch: 23 cost time: 68.12510442733765
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0043135
	speed: 0.4737s/iter; left time: 1508.2190s
	iters: 200, epoch: 24 | loss: 0.0018561
	speed: 0.1521s/iter; left time: 468.9431s
	iters: 300, epoch: 24 | loss: 0.5770203
	speed: 0.1397s/iter; left time: 416.8335s
	iters: 400, epoch: 24 | loss: 0.0011064
	speed: 0.1150s/iter; left time: 331.6081s
Epoch: 24 cost time: 63.49949908256531
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.051 Vali Acc: 0.988 Test Loss: 0.051 Test Acc: 0.988
Validation loss decreased (-0.987421 --> -0.987993).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0007193
	speed: 0.4115s/iter; left time: 1117.2235s
	iters: 200, epoch: 25 | loss: 0.0088312
	speed: 0.1283s/iter; left time: 335.6163s
	iters: 300, epoch: 25 | loss: 0.0037152
	speed: 0.1112s/iter; left time: 279.5968s
	iters: 400, epoch: 25 | loss: 0.2733034
	speed: 0.0985s/iter; left time: 237.9579s
Epoch: 25 cost time: 54.44998264312744
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0021609
	speed: 0.4129s/iter; left time: 927.4011s
	iters: 200, epoch: 26 | loss: 0.0646588
	speed: 0.1276s/iter; left time: 273.8475s
	iters: 300, epoch: 26 | loss: 0.0008373
	speed: 0.1104s/iter; left time: 225.9629s
	iters: 400, epoch: 26 | loss: 0.0036115
	speed: 0.0992s/iter; left time: 193.1238s
Epoch: 26 cost time: 54.832056283950806
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0584610
	speed: 0.4201s/iter; left time: 746.5417s
	iters: 200, epoch: 27 | loss: 0.0060906
	speed: 0.1296s/iter; left time: 217.3474s
	iters: 300, epoch: 27 | loss: 0.0006605
	speed: 0.1236s/iter; left time: 194.8934s
	iters: 400, epoch: 27 | loss: 0.0114039
	speed: 0.1247s/iter; left time: 184.2173s
Epoch: 27 cost time: 60.7940616607666
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0068711
	speed: 0.4938s/iter; left time: 645.8456s
	iters: 200, epoch: 28 | loss: 0.0007303
	speed: 0.1416s/iter; left time: 171.0465s
	iters: 300, epoch: 28 | loss: 0.0020032
	speed: 0.1201s/iter; left time: 133.1054s
	iters: 400, epoch: 28 | loss: 0.0029712
	speed: 0.1312s/iter; left time: 132.2200s
Epoch: 28 cost time: 66.18519496917725
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0003417
	speed: 0.2996s/iter; left time: 251.3380s
	iters: 200, epoch: 29 | loss: 0.0026941
	speed: 0.1323s/iter; left time: 97.7683s
	iters: 300, epoch: 29 | loss: 0.0019357
	speed: 0.0968s/iter; left time: 61.8833s
	iters: 400, epoch: 29 | loss: 0.0010966
	speed: 0.0993s/iter; left time: 53.5385s
Epoch: 29 cost time: 46.86100459098816
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0096828
	speed: 0.3534s/iter; left time: 130.7763s
	iters: 200, epoch: 30 | loss: 0.0006251
	speed: 0.0849s/iter; left time: 22.9198s
	iters: 300, epoch: 30 | loss: 0.0222563
	speed: 0.0685s/iter; left time: 11.6390s
	iters: 400, epoch: 30 | loss: 0.0018179
	speed: 0.1092s/iter; left time: 7.6439s
Epoch: 30 cost time: 44.38299250602722
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9879931389365352
model parameter : 220826
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2193065
	speed: 0.0848s/iter; left time: 1185.4118s
	iters: 200, epoch: 1 | loss: 1.7065583
	speed: 0.0768s/iter; left time: 1065.8084s
	iters: 300, epoch: 1 | loss: 1.3979713
	speed: 0.0679s/iter; left time: 935.5027s
	iters: 400, epoch: 1 | loss: 0.8991398
	speed: 0.0654s/iter; left time: 894.2172s
Epoch: 1 cost time: 35.21899652481079
Epoch: 1, Steps: 469 | Train Loss: 1.596 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
Validation loss decreased (inf --> -0.803308).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4884788
	speed: 0.3009s/iter; left time: 4062.6864s
	iters: 200, epoch: 2 | loss: 0.4714851
	speed: 0.0747s/iter; left time: 1000.7566s
	iters: 300, epoch: 2 | loss: 0.3886143
	speed: 0.0831s/iter; left time: 1105.3514s
	iters: 400, epoch: 2 | loss: 0.3074854
	speed: 0.0925s/iter; left time: 1220.6724s
Epoch: 2 cost time: 40.19171643257141
Epoch: 2, Steps: 469 | Train Loss: 0.535 Vali Loss: 0.364 Vali Acc: 0.897 Test Loss: 0.364 Test Acc: 0.897
Validation loss decreased (-0.803308 --> -0.897080).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2696350
	speed: 0.3488s/iter; left time: 4545.5268s
	iters: 200, epoch: 3 | loss: 0.2045701
	speed: 0.1022s/iter; left time: 1322.0435s
	iters: 300, epoch: 3 | loss: 0.1079099
	speed: 0.0752s/iter; left time: 965.0539s
	iters: 400, epoch: 3 | loss: 0.2164572
	speed: 0.0778s/iter; left time: 990.2340s
Epoch: 3 cost time: 42.95049238204956
Epoch: 3, Steps: 469 | Train Loss: 0.253 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.897080 --> -0.929958).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0908390
	speed: 0.3353s/iter; left time: 4212.2927s
	iters: 200, epoch: 4 | loss: 0.2547233
	speed: 0.1126s/iter; left time: 1403.7440s
	iters: 300, epoch: 4 | loss: 0.1233131
	speed: 0.0888s/iter; left time: 1097.3214s
	iters: 400, epoch: 4 | loss: 0.1207890
	speed: 0.0719s/iter; left time: 881.7315s
Epoch: 4 cost time: 40.690460443496704
Epoch: 4, Steps: 469 | Train Loss: 0.161 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.929958 --> -0.949970).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0155620
	speed: 0.3315s/iter; left time: 4009.0150s
	iters: 200, epoch: 5 | loss: 0.4226132
	speed: 0.0640s/iter; left time: 768.2109s
	iters: 300, epoch: 5 | loss: 0.1153907
	speed: 0.0342s/iter; left time: 406.5196s
	iters: 400, epoch: 5 | loss: 0.0849110
	speed: 0.0385s/iter; left time: 453.7157s
Epoch: 5 cost time: 23.321927309036255
Epoch: 5, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.949970 --> -0.958832).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0256030
	speed: 0.3130s/iter; left time: 3638.6723s
	iters: 200, epoch: 6 | loss: 0.0447284
	speed: 0.0827s/iter; left time: 952.7482s
	iters: 300, epoch: 6 | loss: 0.1149116
	speed: 0.0645s/iter; left time: 736.6287s
	iters: 400, epoch: 6 | loss: 0.0571592
	speed: 0.0679s/iter; left time: 769.0369s
Epoch: 6 cost time: 36.40424609184265
Epoch: 6, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.149 Vali Acc: 0.953 Test Loss: 0.149 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0157266
	speed: 0.3343s/iter; left time: 3730.2393s
	iters: 200, epoch: 7 | loss: 0.0197588
	speed: 0.0642s/iter; left time: 709.4425s
	iters: 300, epoch: 7 | loss: 0.0999844
	speed: 0.0860s/iter; left time: 942.1934s
	iters: 400, epoch: 7 | loss: 0.1029527
	speed: 0.0789s/iter; left time: 856.6062s
Epoch: 7 cost time: 36.65853786468506
Epoch: 7, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1490518
	speed: 0.3421s/iter; left time: 3656.0478s
	iters: 200, epoch: 8 | loss: 0.1129418
	speed: 0.0658s/iter; left time: 696.9583s
	iters: 300, epoch: 8 | loss: 0.0258143
	speed: 0.0663s/iter; left time: 695.0942s
	iters: 400, epoch: 8 | loss: 0.0689095
	speed: 0.0956s/iter; left time: 993.5479s
Epoch: 8 cost time: 39.27183175086975
Epoch: 8, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.958832 --> -0.973698).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1235901
	speed: 0.3837s/iter; left time: 3921.4154s
	iters: 200, epoch: 9 | loss: 0.1431508
	speed: 0.1029s/iter; left time: 1040.9224s
	iters: 300, epoch: 9 | loss: 0.0198016
	speed: 0.1145s/iter; left time: 1146.7334s
	iters: 400, epoch: 9 | loss: 0.0191128
	speed: 0.1088s/iter; left time: 1079.3854s
Epoch: 9 cost time: 49.038177728652954
Epoch: 9, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1271558
	speed: 0.3582s/iter; left time: 3492.7496s
	iters: 200, epoch: 10 | loss: 0.0593122
	speed: 0.1076s/iter; left time: 1038.4389s
	iters: 300, epoch: 10 | loss: 0.0297981
	speed: 0.1002s/iter; left time: 957.3503s
	iters: 400, epoch: 10 | loss: 0.0453855
	speed: 0.0806s/iter; left time: 761.5383s
Epoch: 10 cost time: 43.833099365234375
Epoch: 10, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1577427
	speed: 0.3571s/iter; left time: 3314.6741s
	iters: 200, epoch: 11 | loss: 0.0247287
	speed: 0.1124s/iter; left time: 1031.6509s
	iters: 300, epoch: 11 | loss: 0.0684838
	speed: 0.0763s/iter; left time: 692.6912s
	iters: 400, epoch: 11 | loss: 0.0696063
	speed: 0.0653s/iter; left time: 586.8375s
Epoch: 11 cost time: 40.440590143203735
Epoch: 11, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0062924
	speed: 0.3063s/iter; left time: 2698.6815s
	iters: 200, epoch: 12 | loss: 0.0109271
	speed: 0.0818s/iter; left time: 712.4987s
	iters: 300, epoch: 12 | loss: 0.0472434
	speed: 0.0763s/iter; left time: 657.4240s
	iters: 400, epoch: 12 | loss: 0.0102707
	speed: 0.0602s/iter; left time: 512.1104s
Epoch: 12 cost time: 35.12772464752197
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0455351
	speed: 0.3111s/iter; left time: 2595.7507s
	iters: 200, epoch: 13 | loss: 0.0250131
	speed: 0.0653s/iter; left time: 538.2050s
	iters: 300, epoch: 13 | loss: 0.0158007
	speed: 0.0653s/iter; left time: 531.4904s
	iters: 400, epoch: 13 | loss: 0.0145123
	speed: 0.0728s/iter; left time: 585.4930s
Epoch: 13 cost time: 34.12486171722412
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1303664
	speed: 0.3133s/iter; left time: 2467.1431s
	iters: 200, epoch: 14 | loss: 0.0435359
	speed: 0.0621s/iter; left time: 482.9001s
	iters: 300, epoch: 14 | loss: 0.0065401
	speed: 0.0632s/iter; left time: 484.9645s
	iters: 400, epoch: 14 | loss: 0.0292388
	speed: 0.0758s/iter; left time: 574.0342s
Epoch: 14 cost time: 33.97280311584473
Epoch: 14, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0328012
	speed: 0.3253s/iter; left time: 2408.7664s
	iters: 200, epoch: 15 | loss: 0.1178377
	speed: 0.0933s/iter; left time: 681.6529s
	iters: 300, epoch: 15 | loss: 0.1198651
	speed: 0.0728s/iter; left time: 524.6229s
	iters: 400, epoch: 15 | loss: 0.0603952
	speed: 0.1017s/iter; left time: 722.7805s
Epoch: 15 cost time: 42.435181856155396
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0016235
	speed: 0.3486s/iter; left time: 2417.7726s
	iters: 200, epoch: 16 | loss: 0.0140969
	speed: 0.0958s/iter; left time: 654.9454s
	iters: 300, epoch: 16 | loss: 0.0030581
	speed: 0.1075s/iter; left time: 724.1143s
	iters: 400, epoch: 16 | loss: 0.0040661
	speed: 0.1015s/iter; left time: 673.3579s
Epoch: 16 cost time: 44.89567685127258
Epoch: 16, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.974556).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0174003
	speed: 0.3320s/iter; left time: 2146.7733s
	iters: 200, epoch: 17 | loss: 0.0665372
	speed: 0.1052s/iter; left time: 669.6774s
	iters: 300, epoch: 17 | loss: 0.0313068
	speed: 0.1094s/iter; left time: 685.6597s
	iters: 400, epoch: 17 | loss: 0.0032336
	speed: 0.0821s/iter; left time: 506.1808s
Epoch: 17 cost time: 44.04088377952576
Epoch: 17, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0034249
	speed: 0.3162s/iter; left time: 1896.5263s
	iters: 200, epoch: 18 | loss: 0.0100661
	speed: 0.0872s/iter; left time: 514.5262s
	iters: 300, epoch: 18 | loss: 0.0033250
	speed: 0.0702s/iter; left time: 407.1523s
	iters: 400, epoch: 18 | loss: 0.0873375
	speed: 0.0651s/iter; left time: 370.9746s
Epoch: 18 cost time: 35.50629949569702
Epoch: 18, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975985).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0020231
	speed: 0.3099s/iter; left time: 1713.2083s
	iters: 200, epoch: 19 | loss: 0.0059740
	speed: 0.0662s/iter; left time: 359.2371s
	iters: 300, epoch: 19 | loss: 0.0439095
	speed: 0.0623s/iter; left time: 332.0471s
	iters: 400, epoch: 19 | loss: 0.0010409
	speed: 0.0621s/iter; left time: 324.9080s
Epoch: 19 cost time: 33.25109314918518
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0476801
	speed: 0.3120s/iter; left time: 1578.5778s
	iters: 200, epoch: 20 | loss: 0.0024454
	speed: 0.0700s/iter; left time: 347.0024s
	iters: 300, epoch: 20 | loss: 0.0087213
	speed: 0.0612s/iter; left time: 297.2929s
	iters: 400, epoch: 20 | loss: 0.1471828
	speed: 0.0615s/iter; left time: 292.7478s
Epoch: 20 cost time: 32.99631142616272
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0019704
	speed: 0.3090s/iter; left time: 1418.5564s
	iters: 200, epoch: 21 | loss: 0.1374771
	speed: 0.0585s/iter; left time: 262.6533s
	iters: 300, epoch: 21 | loss: 0.0114966
	speed: 0.0885s/iter; left time: 388.7992s
	iters: 400, epoch: 21 | loss: 0.0012286
	speed: 0.0932s/iter; left time: 399.8641s
Epoch: 21 cost time: 37.48497152328491
Epoch: 21, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0019614
	speed: 0.3571s/iter; left time: 1472.1317s
	iters: 200, epoch: 22 | loss: 0.0933709
	speed: 0.0829s/iter; left time: 333.3402s
	iters: 300, epoch: 22 | loss: 0.0326699
	speed: 0.0920s/iter; left time: 360.9151s
	iters: 400, epoch: 22 | loss: 0.0060974
	speed: 0.1105s/iter; left time: 422.4676s
Epoch: 22 cost time: 44.27065706253052
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0866200
	speed: 0.3364s/iter; left time: 1229.0276s
	iters: 200, epoch: 23 | loss: 0.0123164
	speed: 0.0915s/iter; left time: 325.0583s
	iters: 300, epoch: 23 | loss: 0.0117666
	speed: 0.1023s/iter; left time: 353.1637s
	iters: 400, epoch: 23 | loss: 0.1041986
	speed: 0.1079s/iter; left time: 361.8209s
Epoch: 23 cost time: 45.87072491645813
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0007776
	speed: 0.3245s/iter; left time: 1033.3136s
	iters: 200, epoch: 24 | loss: 0.0378628
	speed: 0.0539s/iter; left time: 166.2117s
	iters: 300, epoch: 24 | loss: 0.0811215
	speed: 0.0283s/iter; left time: 84.4195s
	iters: 400, epoch: 24 | loss: 0.0116459
	speed: 0.0286s/iter; left time: 82.4770s
Epoch: 24 cost time: 22.002789974212646
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0004529
	speed: 0.1743s/iter; left time: 473.1336s
	iters: 200, epoch: 25 | loss: 0.0022945
	speed: 0.0395s/iter; left time: 103.3062s
	iters: 300, epoch: 25 | loss: 0.0123782
	speed: 0.0788s/iter; left time: 198.1810s
	iters: 400, epoch: 25 | loss: 0.0029886
	speed: 0.0530s/iter; left time: 127.9301s
Epoch: 25 cost time: 24.659547328948975
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0007138
	speed: 0.2261s/iter; left time: 507.8649s
	iters: 200, epoch: 26 | loss: 0.0004610
	speed: 0.0522s/iter; left time: 112.0225s
	iters: 300, epoch: 26 | loss: 0.0026378
	speed: 0.0744s/iter; left time: 152.2835s
	iters: 400, epoch: 26 | loss: 0.0036015
	speed: 0.0543s/iter; left time: 105.6958s
Epoch: 26 cost time: 26.439496517181396
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0036051
	speed: 0.2303s/iter; left time: 409.2985s
	iters: 200, epoch: 27 | loss: 0.0059270
	speed: 0.0590s/iter; left time: 98.8867s
	iters: 300, epoch: 27 | loss: 0.0069446
	speed: 0.0598s/iter; left time: 94.3400s
	iters: 400, epoch: 27 | loss: 0.0056797
	speed: 0.0551s/iter; left time: 81.3226s
Epoch: 27 cost time: 26.561047315597534
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0101417
	speed: 0.2615s/iter; left time: 341.9914s
	iters: 200, epoch: 28 | loss: 0.0014255
	speed: 0.0859s/iter; left time: 103.8015s
	iters: 300, epoch: 28 | loss: 0.0014102
	speed: 0.0598s/iter; left time: 66.2973s
	iters: 400, epoch: 28 | loss: 0.0010456
	speed: 0.0779s/iter; left time: 78.5026s
Epoch: 28 cost time: 36.705517530441284
Epoch: 28, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 65546
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2051549
	speed: 0.4248s/iter; left time: 5935.2208s
	iters: 200, epoch: 1 | loss: 0.2742312
	speed: 0.4136s/iter; left time: 5737.1674s
	iters: 300, epoch: 1 | loss: 0.0481509
	speed: 0.4122s/iter; left time: 5676.7431s
	iters: 400, epoch: 1 | loss: 0.1057450
	speed: 0.3773s/iter; left time: 5158.1878s
Epoch: 1 cost time: 189.3382706642151
Epoch: 1, Steps: 469 | Train Loss: 0.331 Vali Loss: 0.125 Vali Acc: 0.958 Test Loss: 0.125 Test Acc: 0.958
Validation loss decreased (inf --> -0.958261).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0051114
	speed: 1.0864s/iter; left time: 14668.8847s
	iters: 200, epoch: 2 | loss: 0.2720479
	speed: 0.3705s/iter; left time: 4965.2002s
	iters: 300, epoch: 2 | loss: 0.0365231
	speed: 0.3668s/iter; left time: 4878.7010s
	iters: 400, epoch: 2 | loss: 0.0349008
	speed: 0.3677s/iter; left time: 4854.3882s
Epoch: 2 cost time: 175.44968819618225
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.958261 --> -0.961691).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018949
	speed: 1.2443s/iter; left time: 16216.4993s
	iters: 200, epoch: 3 | loss: 0.0054125
	speed: 0.4183s/iter; left time: 5409.4244s
	iters: 300, epoch: 3 | loss: 0.0011753
	speed: 0.4104s/iter; left time: 5266.6559s
	iters: 400, epoch: 3 | loss: 0.0570827
	speed: 0.4085s/iter; left time: 5201.9108s
Epoch: 3 cost time: 193.37818837165833
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.961691 --> -0.973984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0421963
	speed: 1.1356s/iter; left time: 14267.6584s
	iters: 200, epoch: 4 | loss: 0.0133877
	speed: 0.3780s/iter; left time: 4711.7187s
	iters: 300, epoch: 4 | loss: 0.2955953
	speed: 0.3744s/iter; left time: 4629.1007s
	iters: 400, epoch: 4 | loss: 0.0736639
	speed: 0.3648s/iter; left time: 4474.2205s
Epoch: 4 cost time: 175.09359860420227
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0017244
	speed: 1.1061s/iter; left time: 13378.5956s
	iters: 200, epoch: 5 | loss: 0.1862016
	speed: 0.3632s/iter; left time: 4356.5943s
	iters: 300, epoch: 5 | loss: 0.2321986
	speed: 0.3633s/iter; left time: 4321.3754s
	iters: 400, epoch: 5 | loss: 0.0012329
	speed: 0.3691s/iter; left time: 4353.9746s
Epoch: 5 cost time: 170.1321051120758
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0105728
	speed: 1.0071s/iter; left time: 11708.9029s
	iters: 200, epoch: 6 | loss: 0.0045925
	speed: 0.3306s/iter; left time: 3810.1088s
	iters: 300, epoch: 6 | loss: 0.0005824
	speed: 0.3271s/iter; left time: 3737.5004s
	iters: 400, epoch: 6 | loss: 0.0104039
	speed: 0.3227s/iter; left time: 3655.2094s
Epoch: 6 cost time: 153.40212869644165
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.976271).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005048
	speed: 1.0251s/iter; left time: 11437.2973s
	iters: 200, epoch: 7 | loss: 0.0004163
	speed: 0.4544s/iter; left time: 5024.4387s
	iters: 300, epoch: 7 | loss: 0.0047592
	speed: 0.4926s/iter; left time: 5396.9683s
	iters: 400, epoch: 7 | loss: 0.0007866
	speed: 0.4582s/iter; left time: 4975.1395s
Epoch: 7 cost time: 213.28902959823608
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003758
	speed: 1.3971s/iter; left time: 14932.0716s
	iters: 200, epoch: 8 | loss: 0.0002996
	speed: 0.4334s/iter; left time: 4588.6534s
	iters: 300, epoch: 8 | loss: 0.0016810
	speed: 0.4206s/iter; left time: 4411.0701s
	iters: 400, epoch: 8 | loss: 0.0075671
	speed: 0.4485s/iter; left time: 4659.1659s
Epoch: 8 cost time: 205.3391363620758
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.981417).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0466738
	speed: 1.2850s/iter; left time: 13131.1072s
	iters: 200, epoch: 9 | loss: 0.0047610
	speed: 0.4535s/iter; left time: 4588.9504s
	iters: 300, epoch: 9 | loss: 0.0000627
	speed: 0.4688s/iter; left time: 4697.3250s
	iters: 400, epoch: 9 | loss: 0.0151144
	speed: 0.4624s/iter; left time: 4586.1482s
Epoch: 9 cost time: 214.98625659942627
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1434250
	speed: 1.4229s/iter; left time: 13873.4672s
	iters: 200, epoch: 10 | loss: 0.0004605
	speed: 0.4543s/iter; left time: 4384.2891s
	iters: 300, epoch: 10 | loss: 0.0007900
	speed: 0.4476s/iter; left time: 4274.7082s
	iters: 400, epoch: 10 | loss: 0.0157872
	speed: 0.4243s/iter; left time: 4009.8412s
Epoch: 10 cost time: 210.3940305709839
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0059124
	speed: 1.2109s/iter; left time: 11238.5915s
	iters: 200, epoch: 11 | loss: 0.0012538
	speed: 0.4192s/iter; left time: 3848.6398s
	iters: 300, epoch: 11 | loss: 0.0005513
	speed: 0.3967s/iter; left time: 3602.8283s
	iters: 400, epoch: 11 | loss: 0.0131453
	speed: 0.4583s/iter; left time: 4115.7534s
Epoch: 11 cost time: 196.01620531082153
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001133
	speed: 1.3260s/iter; left time: 11684.7663s
	iters: 200, epoch: 12 | loss: 0.0000741
	speed: 0.4441s/iter; left time: 3869.1338s
	iters: 300, epoch: 12 | loss: 0.0001793
	speed: 0.4626s/iter; left time: 3983.9858s
	iters: 400, epoch: 12 | loss: 0.0003269
	speed: 0.4026s/iter; left time: 3427.0458s
Epoch: 12 cost time: 205.35966157913208
Epoch: 12, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0039804
	speed: 1.1336s/iter; left time: 9458.0202s
	iters: 200, epoch: 13 | loss: 0.0000910
	speed: 0.3533s/iter; left time: 2912.4695s
	iters: 300, epoch: 13 | loss: 0.0033298
	speed: 0.3449s/iter; left time: 2808.1166s
	iters: 400, epoch: 13 | loss: 0.0022925
	speed: 0.3459s/iter; left time: 2781.9659s
Epoch: 13 cost time: 163.6623456478119
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0001269
	speed: 1.1274s/iter; left time: 8877.4759s
	iters: 200, epoch: 14 | loss: 0.0015487
	speed: 0.3845s/iter; left time: 2989.3141s
	iters: 300, epoch: 14 | loss: 0.0000931
	speed: 0.3883s/iter; left time: 2979.9389s
	iters: 400, epoch: 14 | loss: 0.0082711
	speed: 0.3941s/iter; left time: 2985.2243s
Epoch: 14 cost time: 183.16149926185608
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0041297
	speed: 1.0654s/iter; left time: 7889.5616s
	iters: 200, epoch: 15 | loss: 0.0010194
	speed: 0.3431s/iter; left time: 2506.1011s
	iters: 300, epoch: 15 | loss: 0.0004715
	speed: 0.3468s/iter; left time: 2498.4766s
	iters: 400, epoch: 15 | loss: 0.0147516
	speed: 0.4021s/iter; left time: 2856.7867s
Epoch: 15 cost time: 172.66507291793823
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0023360
	speed: 1.2534s/iter; left time: 8693.3475s
	iters: 200, epoch: 16 | loss: 0.0021924
	speed: 0.4481s/iter; left time: 3063.2465s
	iters: 300, epoch: 16 | loss: 0.0001486
	speed: 0.4350s/iter; left time: 2929.8316s
	iters: 400, epoch: 16 | loss: 0.0001738
	speed: 0.4404s/iter; left time: 2922.5739s
Epoch: 16 cost time: 210.57589292526245
Epoch: 16, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0001612
	speed: 1.3145s/iter; left time: 8501.0327s
	iters: 200, epoch: 17 | loss: 0.0001661
	speed: 0.3925s/iter; left time: 2498.9947s
	iters: 300, epoch: 17 | loss: 0.0052822
	speed: 0.3933s/iter; left time: 2464.9257s
	iters: 400, epoch: 17 | loss: 0.0084385
	speed: 0.4099s/iter; left time: 2527.9290s
Epoch: 17 cost time: 191.22843718528748
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0003746
	speed: 1.1993s/iter; left time: 7193.6987s
	iters: 200, epoch: 18 | loss: 0.0007433
	speed: 0.3934s/iter; left time: 2320.2522s
	iters: 300, epoch: 18 | loss: 0.0002188
	speed: 0.4120s/iter; left time: 2388.7449s
	iters: 400, epoch: 18 | loss: 0.0099112
	speed: 0.4186s/iter; left time: 2385.2725s
Epoch: 18 cost time: 188.0246925354004
Epoch: 18, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 37502986
model size : 145.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3259290
	speed: 0.1883s/iter; left time: 2630.9073s
	iters: 200, epoch: 1 | loss: 0.0672725
	speed: 0.1618s/iter; left time: 2244.7619s
	iters: 300, epoch: 1 | loss: 0.2803310
	speed: 0.1495s/iter; left time: 2059.2206s
	iters: 400, epoch: 1 | loss: 0.0131492
	speed: 0.1632s/iter; left time: 2230.5770s
Epoch: 1 cost time: 78.30825686454773
Epoch: 1, Steps: 469 | Train Loss: 0.334 Vali Loss: 0.171 Vali Acc: 0.947 Test Loss: 0.171 Test Acc: 0.947
Validation loss decreased (inf --> -0.947397).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1556506
	speed: 0.5548s/iter; left time: 7491.3706s
	iters: 200, epoch: 2 | loss: 0.0161280
	speed: 0.1201s/iter; left time: 1609.2498s
	iters: 300, epoch: 2 | loss: 0.0041473
	speed: 0.1451s/iter; left time: 1930.0554s
	iters: 400, epoch: 2 | loss: 0.0024843
	speed: 0.1368s/iter; left time: 1806.3480s
Epoch: 2 cost time: 65.78776693344116
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0033384
	speed: 0.4834s/iter; left time: 6300.5210s
	iters: 200, epoch: 3 | loss: 0.2458081
	speed: 0.1348s/iter; left time: 1743.4265s
	iters: 300, epoch: 3 | loss: 0.0073425
	speed: 0.1465s/iter; left time: 1880.3977s
	iters: 400, epoch: 3 | loss: 0.0186331
	speed: 0.1341s/iter; left time: 1706.9819s
Epoch: 3 cost time: 65.59271311759949
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.947397 --> -0.971125).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0145605
	speed: 0.4753s/iter; left time: 5971.5050s
	iters: 200, epoch: 4 | loss: 0.0023802
	speed: 0.1243s/iter; left time: 1549.7914s
	iters: 300, epoch: 4 | loss: 0.0010414
	speed: 0.1251s/iter; left time: 1546.7089s
	iters: 400, epoch: 4 | loss: 0.0018133
	speed: 0.1157s/iter; left time: 1419.0416s
Epoch: 4 cost time: 57.455920696258545
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.971125 --> -0.976557).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1482708
	speed: 0.4120s/iter; left time: 4982.8000s
	iters: 200, epoch: 5 | loss: 0.0446879
	speed: 0.1261s/iter; left time: 1512.5653s
	iters: 300, epoch: 5 | loss: 0.0322080
	speed: 0.1211s/iter; left time: 1440.3914s
	iters: 400, epoch: 5 | loss: 0.0003363
	speed: 0.1146s/iter; left time: 1351.8828s
Epoch: 5 cost time: 56.94836115837097
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978844).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0007484
	speed: 0.4129s/iter; left time: 4800.7558s
	iters: 200, epoch: 6 | loss: 0.0005995
	speed: 0.1259s/iter; left time: 1450.7186s
	iters: 300, epoch: 6 | loss: 0.0263984
	speed: 0.1196s/iter; left time: 1366.4704s
	iters: 400, epoch: 6 | loss: 0.0030023
	speed: 0.1134s/iter; left time: 1284.8053s
Epoch: 6 cost time: 56.81831073760986
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0132691
	speed: 0.4115s/iter; left time: 4591.0653s
	iters: 200, epoch: 7 | loss: 0.0001838
	speed: 0.1237s/iter; left time: 1367.9944s
	iters: 300, epoch: 7 | loss: 0.0014546
	speed: 0.1201s/iter; left time: 1316.3092s
	iters: 400, epoch: 7 | loss: 0.0003451
	speed: 0.1132s/iter; left time: 1228.5896s
Epoch: 7 cost time: 57.108076095581055
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.981131).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000664
	speed: 0.4114s/iter; left time: 4397.1819s
	iters: 200, epoch: 8 | loss: 0.0170093
	speed: 0.1578s/iter; left time: 1670.6696s
	iters: 300, epoch: 8 | loss: 0.0021591
	speed: 0.1340s/iter; left time: 1405.7356s
	iters: 400, epoch: 8 | loss: 0.1170081
	speed: 0.1480s/iter; left time: 1537.7858s
Epoch: 8 cost time: 67.1118688583374
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0067049
	speed: 0.5101s/iter; left time: 5212.3778s
	iters: 200, epoch: 9 | loss: 0.0078285
	speed: 0.1406s/iter; left time: 1423.1592s
	iters: 300, epoch: 9 | loss: 0.0000756
	speed: 0.1505s/iter; left time: 1507.5278s
	iters: 400, epoch: 9 | loss: 0.0017107
	speed: 0.1409s/iter; left time: 1397.2768s
Epoch: 9 cost time: 68.54364848136902
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0005111
	speed: 0.5193s/iter; left time: 5063.4926s
	iters: 200, epoch: 10 | loss: 0.0005046
	speed: 0.1357s/iter; left time: 1309.4953s
	iters: 300, epoch: 10 | loss: 0.0002655
	speed: 0.1436s/iter; left time: 1371.0876s
	iters: 400, epoch: 10 | loss: 0.0001718
	speed: 0.1436s/iter; left time: 1356.9115s
Epoch: 10 cost time: 67.66853904724121
Epoch: 10, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0002775
	speed: 0.5094s/iter; left time: 4727.5332s
	iters: 200, epoch: 11 | loss: 0.0003239
	speed: 0.1548s/iter; left time: 1420.9073s
	iters: 300, epoch: 11 | loss: 0.0008378
	speed: 0.1363s/iter; left time: 1237.7006s
	iters: 400, epoch: 11 | loss: 0.6643612
	speed: 0.1557s/iter; left time: 1397.9460s
Epoch: 11 cost time: 69.12577056884766
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0534973
	speed: 0.4435s/iter; left time: 3908.4134s
	iters: 200, epoch: 12 | loss: 0.0031015
	speed: 0.1256s/iter; left time: 1094.5043s
	iters: 300, epoch: 12 | loss: 0.0001484
	speed: 0.1410s/iter; left time: 1213.9708s
	iters: 400, epoch: 12 | loss: 0.0282623
	speed: 0.1192s/iter; left time: 1014.7013s
Epoch: 12 cost time: 60.26927399635315
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1020664
	speed: 0.4534s/iter; left time: 3782.7079s
	iters: 200, epoch: 13 | loss: 0.0008762
	speed: 0.1272s/iter; left time: 1048.4310s
	iters: 300, epoch: 13 | loss: 0.0003415
	speed: 0.1271s/iter; left time: 1035.1760s
	iters: 400, epoch: 13 | loss: 0.0005914
	speed: 0.1330s/iter; left time: 1069.5472s
Epoch: 13 cost time: 61.68733477592468
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0001326
	speed: 0.4409s/iter; left time: 3471.9912s
	iters: 200, epoch: 14 | loss: 0.0000485
	speed: 0.1360s/iter; left time: 1057.0757s
	iters: 300, epoch: 14 | loss: 0.0010720
	speed: 0.1240s/iter; left time: 951.1927s
	iters: 400, epoch: 14 | loss: 0.0001206
	speed: 0.1350s/iter; left time: 1022.6882s
Epoch: 14 cost time: 61.68419528007507
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0004481
	speed: 0.4392s/iter; left time: 3252.2734s
	iters: 200, epoch: 15 | loss: 0.0000310
	speed: 0.1306s/iter; left time: 953.7421s
	iters: 300, epoch: 15 | loss: 0.0011848
	speed: 0.1373s/iter; left time: 989.4692s
	iters: 400, epoch: 15 | loss: 0.0002733
	speed: 0.1190s/iter; left time: 845.7528s
Epoch: 15 cost time: 61.13255429267883
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0007743
	speed: 0.4584s/iter; left time: 3179.2356s
	iters: 200, epoch: 16 | loss: 0.0015152
	speed: 0.1364s/iter; left time: 932.3829s
	iters: 300, epoch: 16 | loss: 0.0065920
	speed: 0.1285s/iter; left time: 865.4642s
	iters: 400, epoch: 16 | loss: 0.0007587
	speed: 0.1406s/iter; left time: 932.9249s
Epoch: 16 cost time: 63.20110607147217
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000571
	speed: 0.4640s/iter; left time: 3000.9689s
	iters: 200, epoch: 17 | loss: 0.1993975
	speed: 0.1343s/iter; left time: 854.9747s
	iters: 300, epoch: 17 | loss: 0.0019068
	speed: 0.1235s/iter; left time: 773.7020s
	iters: 400, epoch: 17 | loss: 0.0001238
	speed: 0.1332s/iter; left time: 821.2928s
Epoch: 17 cost time: 61.12163853645325
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 11024906
model size : 44.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2120760
	speed: 0.2851s/iter; left time: 3983.8174s
	iters: 200, epoch: 1 | loss: 0.2651903
	speed: 0.2743s/iter; left time: 3805.1506s
	iters: 300, epoch: 1 | loss: 0.0427791
	speed: 0.2698s/iter; left time: 3715.2249s
	iters: 400, epoch: 1 | loss: 0.1396843
	speed: 0.2235s/iter; left time: 3055.8816s
Epoch: 1 cost time: 124.79481625556946
Epoch: 1, Steps: 469 | Train Loss: 0.344 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
Validation loss decreased (inf --> -0.951399).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0202448
	speed: 0.8812s/iter; left time: 11897.8423s
	iters: 200, epoch: 2 | loss: 0.2179057
	speed: 0.2863s/iter; left time: 3836.9067s
	iters: 300, epoch: 2 | loss: 0.0321522
	speed: 0.2882s/iter; left time: 3833.4520s
	iters: 400, epoch: 2 | loss: 0.0217220
	speed: 0.2910s/iter; left time: 3841.4309s
Epoch: 2 cost time: 136.51230716705322
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.951399 --> -0.969696).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0070414
	speed: 0.8962s/iter; left time: 11680.0232s
	iters: 200, epoch: 3 | loss: 0.0101769
	speed: 0.2937s/iter; left time: 3798.8614s
	iters: 300, epoch: 3 | loss: 0.0030410
	speed: 0.2882s/iter; left time: 3698.5340s
	iters: 400, epoch: 3 | loss: 0.0021885
	speed: 0.2892s/iter; left time: 3681.8516s
Epoch: 3 cost time: 136.85990738868713
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.969696 --> -0.973413).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0121500
	speed: 1.0043s/iter; left time: 12617.7024s
	iters: 200, epoch: 4 | loss: 0.0174012
	speed: 0.3152s/iter; left time: 3929.2178s
	iters: 300, epoch: 4 | loss: 0.0016193
	speed: 0.3272s/iter; left time: 4046.0739s
	iters: 400, epoch: 4 | loss: 0.0166486
	speed: 0.3149s/iter; left time: 3862.1688s
Epoch: 4 cost time: 151.7593343257904
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0018042
	speed: 0.9590s/iter; left time: 11598.9611s
	iters: 200, epoch: 5 | loss: 0.0014532
	speed: 0.3161s/iter; left time: 3792.0184s
	iters: 300, epoch: 5 | loss: 0.0092420
	speed: 0.2977s/iter; left time: 3540.6871s
	iters: 400, epoch: 5 | loss: 0.0003656
	speed: 0.3156s/iter; left time: 3722.9203s
Epoch: 5 cost time: 141.95761013031006
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1076635
	speed: 0.8241s/iter; left time: 9581.5611s
	iters: 200, epoch: 6 | loss: 0.0035046
	speed: 0.2302s/iter; left time: 2653.2907s
	iters: 300, epoch: 6 | loss: 0.0004129
	speed: 0.2399s/iter; left time: 2740.5544s
	iters: 400, epoch: 6 | loss: 0.0004261
	speed: 0.2381s/iter; left time: 2697.0649s
Epoch: 6 cost time: 112.65592193603516
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
Validation loss decreased (-0.973413 --> -0.973984).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0076272
	speed: 0.7292s/iter; left time: 8135.7725s
	iters: 200, epoch: 7 | loss: 0.0007050
	speed: 0.2362s/iter; left time: 2611.4352s
	iters: 300, epoch: 7 | loss: 0.0024418
	speed: 0.2376s/iter; left time: 2602.9765s
	iters: 400, epoch: 7 | loss: 0.0006531
	speed: 0.2391s/iter; left time: 2595.7312s
Epoch: 7 cost time: 111.92199230194092
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003981
	speed: 0.7813s/iter; left time: 8350.7903s
	iters: 200, epoch: 8 | loss: 0.0018735
	speed: 0.2714s/iter; left time: 2873.9774s
	iters: 300, epoch: 8 | loss: 0.0026797
	speed: 0.2725s/iter; left time: 2858.3852s
	iters: 400, epoch: 8 | loss: 0.0006722
	speed: 0.2696s/iter; left time: 2800.3493s
Epoch: 8 cost time: 126.95889568328857
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.977129).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1434703
	speed: 0.8533s/iter; left time: 8720.3206s
	iters: 200, epoch: 9 | loss: 0.0013878
	speed: 0.2861s/iter; left time: 2895.3083s
	iters: 300, epoch: 9 | loss: 0.0001555
	speed: 0.2972s/iter; left time: 2977.6412s
	iters: 400, epoch: 9 | loss: 0.1312780
	speed: 0.2919s/iter; left time: 2895.3230s
Epoch: 9 cost time: 136.35791063308716
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0007145
	speed: 0.8294s/iter; left time: 8086.8798s
	iters: 200, epoch: 10 | loss: 0.0007570
	speed: 0.2560s/iter; left time: 2470.7963s
	iters: 300, epoch: 10 | loss: 0.0000211
	speed: 0.2565s/iter; left time: 2450.0494s
	iters: 400, epoch: 10 | loss: 0.0063156
	speed: 0.2634s/iter; left time: 2488.7226s
Epoch: 10 cost time: 121.47896528244019
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0058512
	speed: 0.7934s/iter; left time: 7363.5706s
	iters: 200, epoch: 11 | loss: 0.0004130
	speed: 0.2645s/iter; left time: 2428.1439s
	iters: 300, epoch: 11 | loss: 0.0011910
	speed: 0.2580s/iter; left time: 2343.3383s
	iters: 400, epoch: 11 | loss: 0.0008378
	speed: 0.2544s/iter; left time: 2285.1347s
Epoch: 11 cost time: 122.50262784957886
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.977129 --> -0.983418).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001746
	speed: 0.8489s/iter; left time: 7480.4353s
	iters: 200, epoch: 12 | loss: 0.0001156
	speed: 0.2799s/iter; left time: 2438.1005s
	iters: 300, epoch: 12 | loss: 0.0001908
	speed: 0.2582s/iter; left time: 2223.5192s
	iters: 400, epoch: 12 | loss: 0.0000490
	speed: 0.2576s/iter; left time: 2192.8984s
Epoch: 12 cost time: 126.87411117553711
Epoch: 12, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006971
	speed: 0.7852s/iter; left time: 6550.5071s
	iters: 200, epoch: 13 | loss: 0.0002794
	speed: 0.2582s/iter; left time: 2128.1699s
	iters: 300, epoch: 13 | loss: 0.0011146
	speed: 0.2589s/iter; left time: 2108.4183s
	iters: 400, epoch: 13 | loss: 0.0027931
	speed: 0.2590s/iter; left time: 2083.5184s
Epoch: 13 cost time: 121.92848420143127
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002047
	speed: 0.7655s/iter; left time: 6027.7605s
	iters: 200, epoch: 14 | loss: 0.0006198
	speed: 0.2281s/iter; left time: 1773.6103s
	iters: 300, epoch: 14 | loss: 0.0002600
	speed: 0.2278s/iter; left time: 1748.4852s
	iters: 400, epoch: 14 | loss: 0.0000927
	speed: 0.2288s/iter; left time: 1733.2507s
Epoch: 14 cost time: 108.43633437156677
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0312268
	speed: 0.6738s/iter; left time: 4989.8061s
	iters: 200, epoch: 15 | loss: 0.0003987
	speed: 0.2351s/iter; left time: 1717.7385s
	iters: 300, epoch: 15 | loss: 0.0832136
	speed: 0.2373s/iter; left time: 1709.6584s
	iters: 400, epoch: 15 | loss: 0.0000642
	speed: 0.2377s/iter; left time: 1688.5555s
Epoch: 15 cost time: 110.80037260055542
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.984276).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0012615
	speed: 0.7275s/iter; left time: 5045.9333s
	iters: 200, epoch: 16 | loss: 0.0011824
	speed: 0.2608s/iter; left time: 1782.7565s
	iters: 300, epoch: 16 | loss: 0.0001244
	speed: 0.2694s/iter; left time: 1814.5778s
	iters: 400, epoch: 16 | loss: 0.0002117
	speed: 0.2686s/iter; left time: 1782.1008s
Epoch: 16 cost time: 121.92996430397034
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0004437
	speed: 0.8150s/iter; left time: 5270.8174s
	iters: 200, epoch: 17 | loss: 0.0002357
	speed: 0.2691s/iter; left time: 1713.1481s
	iters: 300, epoch: 17 | loss: 0.0002881
	speed: 0.2695s/iter; left time: 1688.9669s
	iters: 400, epoch: 17 | loss: 0.0024937
	speed: 0.2664s/iter; left time: 1642.9717s
Epoch: 17 cost time: 125.50927829742432
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000377
	speed: 0.7753s/iter; left time: 4650.2174s
	iters: 200, epoch: 18 | loss: 0.0000687
	speed: 0.2305s/iter; left time: 1359.6490s
	iters: 300, epoch: 18 | loss: 0.0001315
	speed: 0.2160s/iter; left time: 1252.0970s
	iters: 400, epoch: 18 | loss: 0.0373592
	speed: 0.2167s/iter; left time: 1234.9932s
Epoch: 18 cost time: 105.70931077003479
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000874
	speed: 0.6557s/iter; left time: 3625.1878s
	iters: 200, epoch: 19 | loss: 0.0002865
	speed: 0.2123s/iter; left time: 1152.3568s
	iters: 300, epoch: 19 | loss: 0.0003100
	speed: 0.2152s/iter; left time: 1146.7257s
	iters: 400, epoch: 19 | loss: 0.0001933
	speed: 0.2164s/iter; left time: 1131.6669s
Epoch: 19 cost time: 101.26465964317322
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0013106
	speed: 0.6516s/iter; left time: 3297.0852s
	iters: 200, epoch: 20 | loss: 0.0010150
	speed: 0.2512s/iter; left time: 1245.7156s
	iters: 300, epoch: 20 | loss: 0.0001490
	speed: 0.2715s/iter; left time: 1319.2796s
	iters: 400, epoch: 20 | loss: 0.0065118
	speed: 0.3045s/iter; left time: 1449.5418s
Epoch: 20 cost time: 123.94893169403076
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0005024
	speed: 0.9094s/iter; left time: 4174.9414s
	iters: 200, epoch: 21 | loss: 0.0000382
	speed: 0.3035s/iter; left time: 1362.8052s
	iters: 300, epoch: 21 | loss: 0.0029493
	speed: 0.2893s/iter; left time: 1270.5179s
	iters: 400, epoch: 21 | loss: 0.0002161
	speed: 0.3055s/iter; left time: 1311.0738s
Epoch: 21 cost time: 140.1247043609619
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0003163
	speed: 0.9096s/iter; left time: 3749.5536s
	iters: 200, epoch: 22 | loss: 0.0001969
	speed: 0.3042s/iter; left time: 1223.5999s
	iters: 300, epoch: 22 | loss: 0.0000449
	speed: 0.2833s/iter; left time: 1111.0804s
	iters: 400, epoch: 22 | loss: 0.0069441
	speed: 0.2744s/iter; left time: 1048.6532s
Epoch: 22 cost time: 134.28362607955933
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0013937
	speed: 0.8049s/iter; left time: 2940.3617s
	iters: 200, epoch: 23 | loss: 0.0003688
	speed: 0.2684s/iter; left time: 953.4968s
	iters: 300, epoch: 23 | loss: 0.0000300
	speed: 0.2589s/iter; left time: 893.8158s
	iters: 400, epoch: 23 | loss: 0.0002564
	speed: 0.2708s/iter; left time: 907.9559s
Epoch: 23 cost time: 124.49254965782166
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0003897
	speed: 0.8036s/iter; left time: 2558.5875s
	iters: 200, epoch: 24 | loss: 0.0025106
	speed: 0.2498s/iter; left time: 770.4080s
	iters: 300, epoch: 24 | loss: 0.0013373
	speed: 0.2231s/iter; left time: 665.8213s
	iters: 400, epoch: 24 | loss: 0.1099744
	speed: 0.2318s/iter; left time: 668.5701s
Epoch: 24 cost time: 115.61636662483215
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0004065
	speed: 0.7989s/iter; left time: 2169.0412s
	iters: 200, epoch: 25 | loss: 0.0001447
	speed: 0.2622s/iter; left time: 685.6387s
	iters: 300, epoch: 25 | loss: 0.0919037
	speed: 0.2655s/iter; left time: 667.7291s
	iters: 400, epoch: 25 | loss: 0.0002658
	speed: 0.2664s/iter; left time: 643.4098s
Epoch: 25 cost time: 124.40969204902649
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 37502986
model size : 145.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3372236
	speed: 0.1084s/iter; left time: 1514.3478s
	iters: 200, epoch: 1 | loss: 0.0762218
	speed: 0.0958s/iter; left time: 1328.8143s
	iters: 300, epoch: 1 | loss: 0.2898008
	speed: 0.0919s/iter; left time: 1265.0552s
	iters: 400, epoch: 1 | loss: 0.0128822
	speed: 0.0961s/iter; left time: 1313.4029s
Epoch: 1 cost time: 46.368685483932495
Epoch: 1, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.165 Vali Acc: 0.942 Test Loss: 0.165 Test Acc: 0.942
Validation loss decreased (inf --> -0.942251).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1157806
	speed: 0.3324s/iter; left time: 4487.7604s
	iters: 200, epoch: 2 | loss: 0.0292196
	speed: 0.0775s/iter; left time: 1038.5391s
	iters: 300, epoch: 2 | loss: 0.0070164
	speed: 0.0833s/iter; left time: 1108.2768s
	iters: 400, epoch: 2 | loss: 0.0019182
	speed: 0.0826s/iter; left time: 1091.0960s
Epoch: 2 cost time: 38.20541548728943
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.942251 --> -0.970554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0022004
	speed: 0.2689s/iter; left time: 3505.2152s
	iters: 200, epoch: 3 | loss: 0.2178213
	speed: 0.0941s/iter; left time: 1216.4023s
	iters: 300, epoch: 3 | loss: 0.0156577
	speed: 0.0863s/iter; left time: 1107.9352s
	iters: 400, epoch: 3 | loss: 0.4216862
	speed: 0.0832s/iter; left time: 1059.1949s
Epoch: 3 cost time: 40.64586925506592
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.970554 --> -0.974842).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0018060
	speed: 0.3245s/iter; left time: 4077.1738s
	iters: 200, epoch: 4 | loss: 0.0049115
	speed: 0.0960s/iter; left time: 1196.0210s
	iters: 300, epoch: 4 | loss: 0.0008466
	speed: 0.0817s/iter; left time: 1010.3669s
	iters: 400, epoch: 4 | loss: 0.0006440
	speed: 0.0841s/iter; left time: 1031.7669s
Epoch: 4 cost time: 42.009422063827515
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0088277
	speed: 0.3265s/iter; left time: 3949.2197s
	iters: 200, epoch: 5 | loss: 0.0109419
	speed: 0.0925s/iter; left time: 1109.1301s
	iters: 300, epoch: 5 | loss: 0.0009229
	speed: 0.0843s/iter; left time: 1002.6263s
	iters: 400, epoch: 5 | loss: 0.0229542
	speed: 0.0867s/iter; left time: 1022.1297s
Epoch: 5 cost time: 42.41199493408203
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0008355
	speed: 0.3249s/iter; left time: 3776.9165s
	iters: 200, epoch: 6 | loss: 0.0006158
	speed: 0.0905s/iter; left time: 1042.9870s
	iters: 300, epoch: 6 | loss: 0.0122389
	speed: 0.0846s/iter; left time: 966.5232s
	iters: 400, epoch: 6 | loss: 0.0470019
	speed: 0.0904s/iter; left time: 1024.3090s
Epoch: 6 cost time: 43.04225397109985
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.974842 --> -0.978272).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0020747
	speed: 0.3640s/iter; left time: 4061.1117s
	iters: 200, epoch: 7 | loss: 0.0005581
	speed: 0.0986s/iter; left time: 1090.1916s
	iters: 300, epoch: 7 | loss: 0.0002738
	speed: 0.0991s/iter; left time: 1085.4363s
	iters: 400, epoch: 7 | loss: 0.0022028
	speed: 0.1092s/iter; left time: 1185.4249s
Epoch: 7 cost time: 49.28058695793152
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003829
	speed: 0.3822s/iter; left time: 4085.0226s
	iters: 200, epoch: 8 | loss: 0.0099030
	speed: 0.0981s/iter; left time: 1038.6492s
	iters: 300, epoch: 8 | loss: 0.0256225
	speed: 0.1019s/iter; left time: 1069.0927s
	iters: 400, epoch: 8 | loss: 0.0271239
	speed: 0.1110s/iter; left time: 1152.8736s
Epoch: 8 cost time: 48.54852485656738
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003673
	speed: 0.3753s/iter; left time: 3835.2753s
	iters: 200, epoch: 9 | loss: 0.0032488
	speed: 0.0983s/iter; left time: 994.6475s
	iters: 300, epoch: 9 | loss: 0.0002177
	speed: 0.1091s/iter; left time: 1093.2435s
	iters: 400, epoch: 9 | loss: 0.0042631
	speed: 0.1044s/iter; left time: 1035.6666s
Epoch: 9 cost time: 48.313753843307495
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0004719
	speed: 0.3811s/iter; left time: 3716.0512s
	iters: 200, epoch: 10 | loss: 0.0006839
	speed: 0.1039s/iter; left time: 1002.5679s
	iters: 300, epoch: 10 | loss: 0.0004123
	speed: 0.1104s/iter; left time: 1054.1324s
	iters: 400, epoch: 10 | loss: 0.0048491
	speed: 0.0978s/iter; left time: 924.5383s
Epoch: 10 cost time: 48.03500819206238
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0004570
	speed: 0.3737s/iter; left time: 3468.3799s
	iters: 200, epoch: 11 | loss: 0.0022288
	speed: 0.0977s/iter; left time: 897.0061s
	iters: 300, epoch: 11 | loss: 0.0150740
	speed: 0.0917s/iter; left time: 832.8036s
	iters: 400, epoch: 11 | loss: 0.0305262
	speed: 0.0839s/iter; left time: 753.4914s
Epoch: 11 cost time: 43.223581075668335
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0010909
	speed: 0.3168s/iter; left time: 2791.5977s
	iters: 200, epoch: 12 | loss: 0.0847866
	speed: 0.0845s/iter; left time: 736.3226s
	iters: 300, epoch: 12 | loss: 0.0000808
	speed: 0.0677s/iter; left time: 583.4624s
	iters: 400, epoch: 12 | loss: 0.2044216
	speed: 0.0786s/iter; left time: 669.3200s
Epoch: 12 cost time: 37.163129568099976
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7123886
	speed: 0.2750s/iter; left time: 2294.6582s
	iters: 200, epoch: 13 | loss: 0.0001655
	speed: 0.0766s/iter; left time: 631.2077s
	iters: 300, epoch: 13 | loss: 0.0000975
	speed: 0.0828s/iter; left time: 674.0670s
	iters: 400, epoch: 13 | loss: 0.0004650
	speed: 0.0723s/iter; left time: 581.1262s
Epoch: 13 cost time: 36.40796995162964
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0005604
	speed: 0.2771s/iter; left time: 2182.0796s
	iters: 200, epoch: 14 | loss: 0.0002636
	speed: 0.0781s/iter; left time: 607.2644s
	iters: 300, epoch: 14 | loss: 0.0117241
	speed: 0.0749s/iter; left time: 574.7842s
	iters: 400, epoch: 14 | loss: 0.0000781
	speed: 0.0830s/iter; left time: 628.9371s
Epoch: 14 cost time: 37.15423917770386
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0002508
	speed: 0.2719s/iter; left time: 2013.4925s
	iters: 200, epoch: 15 | loss: 0.0000113
	speed: 0.0808s/iter; left time: 589.9272s
	iters: 300, epoch: 15 | loss: 0.0000496
	speed: 0.0790s/iter; left time: 569.1911s
	iters: 400, epoch: 15 | loss: 0.0011977
	speed: 0.0750s/iter; left time: 532.9111s
Epoch: 15 cost time: 36.94208884239197
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0044105
	speed: 0.2914s/iter; left time: 2021.3002s
	iters: 200, epoch: 16 | loss: 0.0017988
	speed: 0.0871s/iter; left time: 595.7117s
	iters: 300, epoch: 16 | loss: 0.0005431
	speed: 0.0933s/iter; left time: 628.5123s
	iters: 400, epoch: 16 | loss: 0.0003101
	speed: 0.0939s/iter; left time: 622.8102s
Epoch: 16 cost time: 43.329736948013306
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000369
	speed: 0.3298s/iter; left time: 2132.8975s
	iters: 200, epoch: 17 | loss: 0.0001939
	speed: 0.0938s/iter; left time: 597.1602s
	iters: 300, epoch: 17 | loss: 0.0387934
	speed: 0.0886s/iter; left time: 555.3192s
	iters: 400, epoch: 17 | loss: 0.0000741
	speed: 0.0942s/iter; left time: 580.7143s
Epoch: 17 cost time: 43.60756850242615
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000782
	speed: 0.3328s/iter; left time: 1996.2111s
	iters: 200, epoch: 18 | loss: 0.0025460
	speed: 0.0931s/iter; left time: 549.1664s
	iters: 300, epoch: 18 | loss: 0.0004984
	speed: 0.0933s/iter; left time: 540.8608s
	iters: 400, epoch: 18 | loss: 0.0010278
	speed: 0.0887s/iter; left time: 505.3428s
Epoch: 18 cost time: 43.38970685005188
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.981417).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0002113
	speed: 0.3395s/iter; left time: 1877.3410s
	iters: 200, epoch: 19 | loss: 0.0059668
	speed: 0.0891s/iter; left time: 483.7988s
	iters: 300, epoch: 19 | loss: 0.0004006
	speed: 0.0934s/iter; left time: 497.9406s
	iters: 400, epoch: 19 | loss: 0.0000944
	speed: 0.0899s/iter; left time: 470.3321s
Epoch: 19 cost time: 43.18381452560425
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.983418).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001359
	speed: 0.3296s/iter; left time: 1667.5408s
	iters: 200, epoch: 20 | loss: 0.0000995
	speed: 0.0802s/iter; left time: 397.8320s
	iters: 300, epoch: 20 | loss: 0.0006228
	speed: 0.0929s/iter; left time: 451.3276s
	iters: 400, epoch: 20 | loss: 0.0002036
	speed: 0.0833s/iter; left time: 396.7252s
Epoch: 20 cost time: 40.28013038635254
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000359
	speed: 0.2921s/iter; left time: 1341.1163s
	iters: 200, epoch: 21 | loss: 0.0001363
	speed: 0.0878s/iter; left time: 394.4361s
	iters: 300, epoch: 21 | loss: 0.0005212
	speed: 0.0786s/iter; left time: 345.1770s
	iters: 400, epoch: 21 | loss: 0.0000706
	speed: 0.0829s/iter; left time: 355.6026s
Epoch: 21 cost time: 39.51150059700012
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0010251
	speed: 0.2957s/iter; left time: 1218.7661s
	iters: 200, epoch: 22 | loss: 0.0008249
	speed: 0.0784s/iter; left time: 315.3370s
	iters: 300, epoch: 22 | loss: 0.0001902
	speed: 0.0861s/iter; left time: 337.5028s
	iters: 400, epoch: 22 | loss: 0.0000407
	speed: 0.0823s/iter; left time: 314.7068s
Epoch: 22 cost time: 38.70873498916626
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0480928
	speed: 0.2859s/iter; left time: 1044.2413s
	iters: 200, epoch: 23 | loss: 0.0109517
	speed: 0.0885s/iter; left time: 314.3480s
	iters: 300, epoch: 23 | loss: 0.0026189
	speed: 0.0785s/iter; left time: 271.0930s
	iters: 400, epoch: 23 | loss: 0.0008065
	speed: 0.0834s/iter; left time: 279.6044s
Epoch: 23 cost time: 39.60201334953308
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0001199
	speed: 0.2946s/iter; left time: 937.8873s
	iters: 200, epoch: 24 | loss: 0.0003656
	speed: 0.0783s/iter; left time: 241.3515s
	iters: 300, epoch: 24 | loss: 0.0006122
	speed: 0.0881s/iter; left time: 262.7608s
	iters: 400, epoch: 24 | loss: 0.0008892
	speed: 0.0810s/iter; left time: 233.5685s
Epoch: 24 cost time: 38.69434428215027
Epoch: 24, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.8506739
	speed: 0.2897s/iter; left time: 786.5761s
	iters: 200, epoch: 25 | loss: 0.0004045
	speed: 0.0946s/iter; left time: 247.4254s
	iters: 300, epoch: 25 | loss: 0.0000461
	speed: 0.0913s/iter; left time: 229.6466s
	iters: 400, epoch: 25 | loss: 0.0003120
	speed: 0.0969s/iter; left time: 234.0995s
Epoch: 25 cost time: 43.53857946395874
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0001016
	speed: 0.3513s/iter; left time: 789.0418s
	iters: 200, epoch: 26 | loss: 0.0000828
	speed: 0.0934s/iter; left time: 200.3591s
	iters: 300, epoch: 26 | loss: 0.0000329
	speed: 0.1015s/iter; left time: 207.7602s
	iters: 400, epoch: 26 | loss: 0.2984071
	speed: 0.0915s/iter; left time: 178.1357s
Epoch: 26 cost time: 44.680845499038696
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0003881
	speed: 0.3426s/iter; left time: 608.7202s
	iters: 200, epoch: 27 | loss: 0.0010575
	speed: 0.0792s/iter; left time: 132.8153s
	iters: 300, epoch: 27 | loss: 0.0000555
	speed: 0.0915s/iter; left time: 144.3646s
	iters: 400, epoch: 27 | loss: 0.0004883
	speed: 0.0856s/iter; left time: 126.3782s
Epoch: 27 cost time: 41.20880174636841
Epoch: 27, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0167173
	speed: 0.3178s/iter; left time: 415.7365s
	iters: 200, epoch: 28 | loss: 0.0005439
	speed: 0.0855s/iter; left time: 103.2904s
	iters: 300, epoch: 28 | loss: 0.0003314
	speed: 0.0915s/iter; left time: 101.3590s
	iters: 400, epoch: 28 | loss: 0.0001379
	speed: 0.0857s/iter; left time: 86.3772s
Epoch: 28 cost time: 41.59940695762634
Epoch: 28, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0056526
	speed: 0.3192s/iter; left time: 267.8334s
	iters: 200, epoch: 29 | loss: 0.0000655
	speed: 0.0879s/iter; left time: 64.9474s
	iters: 300, epoch: 29 | loss: 0.0000160
	speed: 0.0892s/iter; left time: 57.0179s
	iters: 400, epoch: 29 | loss: 0.0171157
	speed: 0.0862s/iter; left time: 46.4675s
Epoch: 29 cost time: 41.7058801651001
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 11024906
model size : 44.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2784206
	speed: 0.1399s/iter; left time: 1954.6156s
	iters: 200, epoch: 1 | loss: 0.3349401
	speed: 0.1251s/iter; left time: 1735.9536s
	iters: 300, epoch: 1 | loss: 0.0797331
	speed: 0.1284s/iter; left time: 1768.8365s
	iters: 400, epoch: 1 | loss: 0.1095780
	speed: 0.1231s/iter; left time: 1682.5822s
Epoch: 1 cost time: 60.62108778953552
Epoch: 1, Steps: 469 | Train Loss: 0.371 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (inf --> -0.944252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0081579
	speed: 0.3942s/iter; left time: 5322.2313s
	iters: 200, epoch: 2 | loss: 0.0397098
	speed: 0.1332s/iter; left time: 1785.4742s
	iters: 300, epoch: 2 | loss: 0.0104792
	speed: 0.1481s/iter; left time: 1970.0866s
	iters: 400, epoch: 2 | loss: 0.0173302
	speed: 0.1417s/iter; left time: 1870.0754s
Epoch: 2 cost time: 64.89020013809204
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.944252 --> -0.970839).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0151795
	speed: 0.4821s/iter; left time: 6283.6509s
	iters: 200, epoch: 3 | loss: 0.0102236
	speed: 0.1445s/iter; left time: 1869.4597s
	iters: 300, epoch: 3 | loss: 0.0326612
	speed: 0.1490s/iter; left time: 1911.8243s
	iters: 400, epoch: 3 | loss: 0.0026956
	speed: 0.1413s/iter; left time: 1799.1103s
Epoch: 3 cost time: 69.55570340156555
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0153616
	speed: 0.5276s/iter; left time: 6629.2768s
	iters: 200, epoch: 4 | loss: 0.0064822
	speed: 0.1603s/iter; left time: 1997.4027s
	iters: 300, epoch: 4 | loss: 0.0714664
	speed: 0.1707s/iter; left time: 2109.9435s
	iters: 400, epoch: 4 | loss: 0.0058187
	speed: 0.1609s/iter; left time: 1973.3406s
Epoch: 4 cost time: 77.87795829772949
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018675
	speed: 0.5405s/iter; left time: 6537.5552s
	iters: 200, epoch: 5 | loss: 0.2411242
	speed: 0.1605s/iter; left time: 1924.7345s
	iters: 300, epoch: 5 | loss: 0.0532854
	speed: 0.1713s/iter; left time: 2038.0238s
	iters: 400, epoch: 5 | loss: 0.0004391
	speed: 0.1606s/iter; left time: 1894.6543s
Epoch: 5 cost time: 78.36853885650635
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.143 Vali Acc: 0.958 Test Loss: 0.143 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0065805
	speed: 0.5397s/iter; left time: 6274.6497s
	iters: 200, epoch: 6 | loss: 0.0024120
	speed: 0.1606s/iter; left time: 1851.3447s
	iters: 300, epoch: 6 | loss: 0.0004053
	speed: 0.1709s/iter; left time: 1953.0233s
	iters: 400, epoch: 6 | loss: 0.0019404
	speed: 0.1600s/iter; left time: 1811.8846s
Epoch: 6 cost time: 77.83912372589111
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003249
	speed: 0.4936s/iter; left time: 5507.0456s
	iters: 200, epoch: 7 | loss: 0.0420120
	speed: 0.1421s/iter; left time: 1571.3360s
	iters: 300, epoch: 7 | loss: 0.0018042
	speed: 0.1503s/iter; left time: 1647.3443s
	iters: 400, epoch: 7 | loss: 0.0005693
	speed: 0.1434s/iter; left time: 1556.5086s
Epoch: 7 cost time: 69.10366725921631
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0822623
	speed: 0.4689s/iter; left time: 5011.3700s
	iters: 200, epoch: 8 | loss: 0.0222254
	speed: 0.1420s/iter; left time: 1503.7133s
	iters: 300, epoch: 8 | loss: 0.0010005
	speed: 0.1423s/iter; left time: 1492.2273s
	iters: 400, epoch: 8 | loss: 0.0005610
	speed: 0.1129s/iter; left time: 1173.2217s
Epoch: 8 cost time: 64.34006094932556
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0938269
	speed: 0.4113s/iter; left time: 4203.1361s
	iters: 200, epoch: 9 | loss: 0.0252252
	speed: 0.1362s/iter; left time: 1378.6806s
	iters: 300, epoch: 9 | loss: 0.0001011
	speed: 0.1304s/iter; left time: 1306.3611s
	iters: 400, epoch: 9 | loss: 0.0196506
	speed: 0.1309s/iter; left time: 1298.1053s
Epoch: 9 cost time: 61.91604018211365
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0006432
	speed: 0.4104s/iter; left time: 4001.6335s
	iters: 200, epoch: 10 | loss: 0.0001311
	speed: 0.1516s/iter; left time: 1462.8203s
	iters: 300, epoch: 10 | loss: 0.0017293
	speed: 0.1461s/iter; left time: 1394.8772s
	iters: 400, epoch: 10 | loss: 0.0001926
	speed: 0.1510s/iter; left time: 1427.4181s
Epoch: 10 cost time: 68.13696360588074
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.970839 --> -0.976271).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0042183
	speed: 0.4875s/iter; left time: 4524.8033s
	iters: 200, epoch: 11 | loss: 0.0003524
	speed: 0.1499s/iter; left time: 1376.0515s
	iters: 300, epoch: 11 | loss: 0.0012119
	speed: 0.1482s/iter; left time: 1345.5455s
	iters: 400, epoch: 11 | loss: 0.0006881
	speed: 0.1526s/iter; left time: 1370.2829s
Epoch: 11 cost time: 70.62764501571655
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001575
	speed: 0.4767s/iter; left time: 4200.4588s
	iters: 200, epoch: 12 | loss: 0.1870504
	speed: 0.1470s/iter; left time: 1280.6732s
	iters: 300, epoch: 12 | loss: 0.0000901
	speed: 0.1507s/iter; left time: 1298.1667s
	iters: 400, epoch: 12 | loss: 0.0003715
	speed: 0.1491s/iter; left time: 1268.7835s
Epoch: 12 cost time: 70.44770193099976
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0027376
	speed: 0.4833s/iter; left time: 4032.3703s
	iters: 200, epoch: 13 | loss: 0.0003001
	speed: 0.1467s/iter; left time: 1209.6009s
	iters: 300, epoch: 13 | loss: 0.0000717
	speed: 0.1444s/iter; left time: 1176.0335s
	iters: 400, epoch: 13 | loss: 0.0000604
	speed: 0.1353s/iter; left time: 1088.4737s
Epoch: 13 cost time: 69.41137838363647
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0017841
	speed: 0.4490s/iter; left time: 3535.2909s
	iters: 200, epoch: 14 | loss: 0.1475175
	speed: 0.1439s/iter; left time: 1118.9451s
	iters: 300, epoch: 14 | loss: 0.0060440
	speed: 0.1337s/iter; left time: 1026.1069s
	iters: 400, epoch: 14 | loss: 0.0004572
	speed: 0.1452s/iter; left time: 1099.5844s
Epoch: 14 cost time: 65.22756385803223
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.980274).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0021041
	speed: 0.4558s/iter; left time: 3375.4031s
	iters: 200, epoch: 15 | loss: 0.0001535
	speed: 0.1344s/iter; left time: 981.4337s
	iters: 300, epoch: 15 | loss: 0.0169497
	speed: 0.1444s/iter; left time: 1040.4295s
	iters: 400, epoch: 15 | loss: 0.0001645
	speed: 0.1336s/iter; left time: 949.3262s
Epoch: 15 cost time: 66.38848662376404
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0009638
	speed: 0.4496s/iter; left time: 3118.3569s
	iters: 200, epoch: 16 | loss: 0.0675201
	speed: 0.1446s/iter; left time: 988.4154s
	iters: 300, epoch: 16 | loss: 0.0003646
	speed: 0.1342s/iter; left time: 904.0238s
	iters: 400, epoch: 16 | loss: 0.0051866
	speed: 0.1455s/iter; left time: 965.5071s
Epoch: 16 cost time: 66.5917694568634
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981703).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0001810
	speed: 0.5195s/iter; left time: 3359.4001s
	iters: 200, epoch: 17 | loss: 0.0029169
	speed: 0.1522s/iter; left time: 968.9419s
	iters: 300, epoch: 17 | loss: 0.0010725
	speed: 0.1630s/iter; left time: 1021.2568s
	iters: 400, epoch: 17 | loss: 0.0041389
	speed: 0.1523s/iter; left time: 938.9890s
Epoch: 17 cost time: 74.6026439666748
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0012014
	speed: 0.5106s/iter; left time: 3062.4761s
	iters: 200, epoch: 18 | loss: 0.1535465
	speed: 0.1467s/iter; left time: 865.4270s
	iters: 300, epoch: 18 | loss: 0.0584905
	speed: 0.1429s/iter; left time: 828.2452s
	iters: 400, epoch: 18 | loss: 0.0004540
	speed: 0.1413s/iter; left time: 804.9873s
Epoch: 18 cost time: 69.11426520347595
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0035499
	speed: 0.4693s/iter; left time: 2594.5587s
	iters: 200, epoch: 19 | loss: 0.0005413
	speed: 0.1449s/iter; left time: 786.6697s
	iters: 300, epoch: 19 | loss: 0.0003785
	speed: 0.1471s/iter; left time: 783.8687s
	iters: 400, epoch: 19 | loss: 0.0003249
	speed: 0.1436s/iter; left time: 750.6939s
Epoch: 19 cost time: 68.48720788955688
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0006891
	speed: 0.4139s/iter; left time: 2094.5428s
	iters: 200, epoch: 20 | loss: 0.0001879
	speed: 0.1252s/iter; left time: 620.7956s
	iters: 300, epoch: 20 | loss: 0.0012590
	speed: 0.1294s/iter; left time: 628.9942s
	iters: 400, epoch: 20 | loss: 0.0004219
	speed: 0.1244s/iter; left time: 592.0419s
Epoch: 20 cost time: 60.06151819229126
Epoch: 20, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000940
	speed: 0.4045s/iter; left time: 1856.9108s
	iters: 200, epoch: 21 | loss: 0.0000595
	speed: 0.1266s/iter; left time: 568.3905s
	iters: 300, epoch: 21 | loss: 0.0169537
	speed: 0.1263s/iter; left time: 554.7031s
	iters: 400, epoch: 21 | loss: 0.0062037
	speed: 0.1234s/iter; left time: 529.5709s
Epoch: 21 cost time: 59.78929281234741
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0001532
	speed: 0.4050s/iter; left time: 1669.3111s
	iters: 200, epoch: 22 | loss: 0.0013454
	speed: 0.1273s/iter; left time: 511.9817s
	iters: 300, epoch: 22 | loss: 0.0001386
	speed: 0.1218s/iter; left time: 477.6737s
	iters: 400, epoch: 22 | loss: 0.0002671
	speed: 0.1225s/iter; left time: 468.2970s
Epoch: 22 cost time: 59.020689249038696
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0039534
	speed: 0.4093s/iter; left time: 1495.2372s
	iters: 200, epoch: 23 | loss: 0.0000811
	speed: 0.1305s/iter; left time: 463.6236s
	iters: 300, epoch: 23 | loss: 0.0001166
	speed: 0.1326s/iter; left time: 457.9620s
	iters: 400, epoch: 23 | loss: 0.0049557
	speed: 0.1347s/iter; left time: 451.5278s
Epoch: 23 cost time: 61.23204278945923
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0004541
	speed: 0.4245s/iter; left time: 1351.7203s
	iters: 200, epoch: 24 | loss: 0.0128172
	speed: 0.1350s/iter; left time: 416.4843s
	iters: 300, epoch: 24 | loss: 0.1730645
	speed: 0.1273s/iter; left time: 379.8564s
	iters: 400, epoch: 24 | loss: 0.0495121
	speed: 0.1277s/iter; left time: 368.3032s
Epoch: 24 cost time: 58.35101056098938
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0008564
	speed: 0.2886s/iter; left time: 783.6632s
	iters: 200, epoch: 25 | loss: 0.0002356
	speed: 0.1252s/iter; left time: 327.3792s
	iters: 300, epoch: 25 | loss: 0.0030761
	speed: 0.1241s/iter; left time: 312.0849s
	iters: 400, epoch: 25 | loss: 0.0011198
	speed: 0.1284s/iter; left time: 310.1894s
Epoch: 25 cost time: 58.704867124557495
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0001178
	speed: 0.3836s/iter; left time: 861.4607s
	iters: 200, epoch: 26 | loss: 0.0005567
	speed: 0.1308s/iter; left time: 280.6333s
	iters: 300, epoch: 26 | loss: 0.0017432
	speed: 0.1222s/iter; left time: 250.0659s
	iters: 400, epoch: 26 | loss: 0.0005368
	speed: 0.1322s/iter; left time: 257.2919s
Epoch: 26 cost time: 59.86990666389465
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 37502986
model size : 145.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5775318
	speed: 0.0527s/iter; left time: 736.7306s
	iters: 200, epoch: 1 | loss: 0.0658586
	speed: 0.0348s/iter; left time: 483.0473s
	iters: 300, epoch: 1 | loss: 0.3252678
	speed: 0.0336s/iter; left time: 462.8692s
	iters: 400, epoch: 1 | loss: 0.0162207
	speed: 0.0334s/iter; left time: 456.3705s
Epoch: 1 cost time: 17.9018874168396
Epoch: 1, Steps: 469 | Train Loss: 0.378 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
Validation loss decreased (inf --> -0.958260).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0442049
	speed: 0.1300s/iter; left time: 1755.6244s
	iters: 200, epoch: 2 | loss: 0.0511055
	speed: 0.0347s/iter; left time: 465.0361s
	iters: 300, epoch: 2 | loss: 0.0147418
	speed: 0.0340s/iter; left time: 451.6443s
	iters: 400, epoch: 2 | loss: 0.0036332
	speed: 0.0342s/iter; left time: 451.5333s
Epoch: 2 cost time: 16.727437019348145
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
Validation loss decreased (-0.958260 --> -0.966837).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0042749
	speed: 0.1341s/iter; left time: 1747.4701s
	iters: 200, epoch: 3 | loss: 0.1527509
	speed: 0.0347s/iter; left time: 449.2540s
	iters: 300, epoch: 3 | loss: 0.0340068
	speed: 0.0340s/iter; left time: 436.0694s
	iters: 400, epoch: 3 | loss: 0.1651067
	speed: 0.0342s/iter; left time: 436.0455s
Epoch: 3 cost time: 16.72043013572693
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0867028
	speed: 0.1385s/iter; left time: 1740.1128s
	iters: 200, epoch: 4 | loss: 0.0008225
	speed: 0.0394s/iter; left time: 491.1309s
	iters: 300, epoch: 4 | loss: 0.0009382
	speed: 0.0388s/iter; left time: 479.7130s
	iters: 400, epoch: 4 | loss: 0.0658605
	speed: 0.0384s/iter; left time: 470.9618s
Epoch: 4 cost time: 18.858867645263672
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.942 Test Loss: 0.176 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0085163
	speed: 0.1465s/iter; left time: 1771.9975s
	iters: 200, epoch: 5 | loss: 0.0104139
	speed: 0.0396s/iter; left time: 475.4164s
	iters: 300, epoch: 5 | loss: 0.0045403
	speed: 0.0387s/iter; left time: 459.9884s
	iters: 400, epoch: 5 | loss: 0.0080045
	speed: 0.0385s/iter; left time: 453.6159s
Epoch: 5 cost time: 18.860493659973145
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0007956
	speed: 0.1485s/iter; left time: 1726.8000s
	iters: 200, epoch: 6 | loss: 0.0070616
	speed: 0.0402s/iter; left time: 463.5144s
	iters: 300, epoch: 6 | loss: 0.1246732
	speed: 0.0382s/iter; left time: 436.7804s
	iters: 400, epoch: 6 | loss: 0.0031039
	speed: 0.0391s/iter; left time: 442.9993s
Epoch: 6 cost time: 19.055679082870483
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2990724
	speed: 0.1469s/iter; left time: 1639.1577s
	iters: 200, epoch: 7 | loss: 0.0002031
	speed: 0.0397s/iter; left time: 439.3703s
	iters: 300, epoch: 7 | loss: 0.0002584
	speed: 0.0389s/iter; left time: 426.3570s
	iters: 400, epoch: 7 | loss: 0.0003324
	speed: 0.0396s/iter; left time: 429.5837s
Epoch: 7 cost time: 18.93986201286316
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.966837 --> -0.979416).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003056
	speed: 0.1205s/iter; left time: 1288.1361s
	iters: 200, epoch: 8 | loss: 0.0270649
	speed: 0.0399s/iter; left time: 422.3579s
	iters: 300, epoch: 8 | loss: 0.0001515
	speed: 0.0420s/iter; left time: 440.3754s
	iters: 400, epoch: 8 | loss: 0.1147692
	speed: 0.0400s/iter; left time: 415.5841s
Epoch: 8 cost time: 18.35621666908264
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001843
	speed: 0.1513s/iter; left time: 1545.6423s
	iters: 200, epoch: 9 | loss: 0.4626193
	speed: 0.0417s/iter; left time: 422.3350s
	iters: 300, epoch: 9 | loss: 0.0007780
	speed: 0.0387s/iter; left time: 387.4514s
	iters: 400, epoch: 9 | loss: 0.0402509
	speed: 0.0395s/iter; left time: 391.9822s
Epoch: 9 cost time: 19.46184778213501
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0226786
	speed: 0.1460s/iter; left time: 1423.0711s
	iters: 200, epoch: 10 | loss: 0.0010832
	speed: 0.0379s/iter; left time: 365.4719s
	iters: 300, epoch: 10 | loss: 0.0001312
	speed: 0.0399s/iter; left time: 381.4039s
	iters: 400, epoch: 10 | loss: 0.0049689
	speed: 0.0425s/iter; left time: 401.1599s
Epoch: 10 cost time: 19.090967655181885
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.981703).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0004278
	speed: 0.1559s/iter; left time: 1446.4694s
	iters: 200, epoch: 11 | loss: 0.0086511
	speed: 0.0422s/iter; left time: 387.7913s
	iters: 300, epoch: 11 | loss: 0.0527603
	speed: 0.0395s/iter; left time: 358.9191s
	iters: 400, epoch: 11 | loss: 0.0003646
	speed: 0.0389s/iter; left time: 349.6151s
Epoch: 11 cost time: 19.28545904159546
Epoch: 11, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0129048
	speed: 0.1507s/iter; left time: 1327.9079s
	iters: 200, epoch: 12 | loss: 0.0018997
	speed: 0.0442s/iter; left time: 384.6872s
	iters: 300, epoch: 12 | loss: 0.0001819
	speed: 0.0444s/iter; left time: 382.2804s
	iters: 400, epoch: 12 | loss: 0.0036619
	speed: 0.0469s/iter; left time: 399.4482s
Epoch: 12 cost time: 21.29717183113098
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0004451
	speed: 0.1705s/iter; left time: 1422.7059s
	iters: 200, epoch: 13 | loss: 0.0000748
	speed: 0.0479s/iter; left time: 394.9947s
	iters: 300, epoch: 13 | loss: 0.0001953
	speed: 0.0491s/iter; left time: 399.5533s
	iters: 400, epoch: 13 | loss: 0.0000974
	speed: 0.0461s/iter; left time: 371.1125s
Epoch: 13 cost time: 22.261706113815308
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001966
	speed: 0.1781s/iter; left time: 1402.6519s
	iters: 200, epoch: 14 | loss: 0.0000828
	speed: 0.0444s/iter; left time: 344.9508s
	iters: 300, epoch: 14 | loss: 0.0034348
	speed: 0.0433s/iter; left time: 332.0443s
	iters: 400, epoch: 14 | loss: 0.0001198
	speed: 0.0455s/iter; left time: 344.7923s
Epoch: 14 cost time: 21.868086099624634
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002436
	speed: 0.1735s/iter; left time: 1284.8944s
	iters: 200, epoch: 15 | loss: 0.0000283
	speed: 0.0461s/iter; left time: 336.8534s
	iters: 300, epoch: 15 | loss: 0.0005197
	speed: 0.0501s/iter; left time: 360.8846s
	iters: 400, epoch: 15 | loss: 0.0001319
	speed: 0.0495s/iter; left time: 351.3698s
Epoch: 15 cost time: 22.46143937110901
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0024301
	speed: 0.1604s/iter; left time: 1112.2555s
	iters: 200, epoch: 16 | loss: 0.0003737
	speed: 0.0403s/iter; left time: 275.3257s
	iters: 300, epoch: 16 | loss: 0.2836843
	speed: 0.0387s/iter; left time: 260.6227s
	iters: 400, epoch: 16 | loss: 0.0001531
	speed: 0.0404s/iter; left time: 268.1721s
Epoch: 16 cost time: 19.427079916000366
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3419044
	speed: 0.1506s/iter; left time: 974.1118s
	iters: 200, epoch: 17 | loss: 0.0084786
	speed: 0.0382s/iter; left time: 242.9050s
	iters: 300, epoch: 17 | loss: 0.0003855
	speed: 0.0422s/iter; left time: 264.5107s
	iters: 400, epoch: 17 | loss: 0.0001500
	speed: 0.0413s/iter; left time: 254.5143s
Epoch: 17 cost time: 18.98241925239563
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0001372
	speed: 0.1485s/iter; left time: 890.4126s
	iters: 200, epoch: 18 | loss: 0.0001348
	speed: 0.0420s/iter; left time: 247.7426s
	iters: 300, epoch: 18 | loss: 0.0007241
	speed: 0.0392s/iter; left time: 227.3426s
	iters: 400, epoch: 18 | loss: 0.0017416
	speed: 0.0386s/iter; left time: 219.7538s
Epoch: 18 cost time: 19.102930784225464
Epoch: 18, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000975
	speed: 0.1520s/iter; left time: 840.2493s
	iters: 200, epoch: 19 | loss: 0.5607427
	speed: 0.0383s/iter; left time: 207.8998s
	iters: 300, epoch: 19 | loss: 0.0002418
	speed: 0.0388s/iter; left time: 206.5861s
	iters: 400, epoch: 19 | loss: 0.0054722
	speed: 0.0422s/iter; left time: 220.7050s
Epoch: 19 cost time: 19.238450527191162
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.938 Test Loss: 0.259 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0008802
	speed: 0.1510s/iter; left time: 763.9567s
	iters: 200, epoch: 20 | loss: 0.0015399
	speed: 0.0503s/iter; left time: 249.5128s
	iters: 300, epoch: 20 | loss: 0.0002927
	speed: 0.0502s/iter; left time: 244.0212s
	iters: 400, epoch: 20 | loss: 0.0010046
	speed: 0.0449s/iter; left time: 213.8591s
Epoch: 20 cost time: 21.705015420913696
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 11024906
model size : 44.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1793994
	speed: 0.2020s/iter; left time: 2822.2644s
	iters: 200, epoch: 1 | loss: 0.0918105
	speed: 0.1939s/iter; left time: 2688.9618s
	iters: 300, epoch: 1 | loss: 0.0256360
	speed: 0.1914s/iter; left time: 2635.5098s
	iters: 400, epoch: 1 | loss: 0.0309095
	speed: 0.1857s/iter; left time: 2539.1161s
Epoch: 1 cost time: 88.05412817001343
Epoch: 1, Steps: 469 | Train Loss: 0.350 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (inf --> -0.972841).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0101840
	speed: 0.4735s/iter; left time: 6392.5806s
	iters: 200, epoch: 2 | loss: 0.0478365
	speed: 0.1509s/iter; left time: 2021.7597s
	iters: 300, epoch: 2 | loss: 0.0054630
	speed: 0.1477s/iter; left time: 1964.5637s
	iters: 400, epoch: 2 | loss: 0.0599869
	speed: 0.1478s/iter; left time: 1950.6440s
Epoch: 2 cost time: 69.7479772567749
Epoch: 2, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0021109
	speed: 0.4651s/iter; left time: 6061.6061s
	iters: 200, epoch: 3 | loss: 0.0052318
	speed: 0.1598s/iter; left time: 2066.7824s
	iters: 300, epoch: 3 | loss: 0.0302878
	speed: 0.1792s/iter; left time: 2299.2123s
	iters: 400, epoch: 3 | loss: 0.0712391
	speed: 0.1754s/iter; left time: 2233.2945s
Epoch: 3 cost time: 78.65623879432678
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0071178
	speed: 0.5525s/iter; left time: 6942.1337s
	iters: 200, epoch: 4 | loss: 0.2135204
	speed: 0.1737s/iter; left time: 2165.5754s
	iters: 300, epoch: 4 | loss: 0.0013433
	speed: 0.1635s/iter; left time: 2021.3797s
	iters: 400, epoch: 4 | loss: 0.0125146
	speed: 0.1482s/iter; left time: 1817.0827s
Epoch: 4 cost time: 76.06880140304565
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0522922
	speed: 0.4604s/iter; left time: 5568.1686s
	iters: 200, epoch: 5 | loss: 0.0007647
	speed: 0.1463s/iter; left time: 1754.3757s
	iters: 300, epoch: 5 | loss: 0.0013878
	speed: 0.1482s/iter; left time: 1762.5151s
	iters: 400, epoch: 5 | loss: 0.0006055
	speed: 0.1468s/iter; left time: 1731.4918s
Epoch: 5 cost time: 68.7991111278534
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0003115
	speed: 0.4917s/iter; left time: 5716.6597s
	iters: 200, epoch: 6 | loss: 0.0026783
	speed: 0.1543s/iter; left time: 1778.9220s
	iters: 300, epoch: 6 | loss: 0.0033181
	speed: 0.1842s/iter; left time: 2104.5341s
	iters: 400, epoch: 6 | loss: 0.4570089
	speed: 0.1843s/iter; left time: 2086.8459s
Epoch: 6 cost time: 82.26899337768555
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0034899
	speed: 0.5798s/iter; left time: 6468.4519s
	iters: 200, epoch: 7 | loss: 0.0007204
	speed: 0.1540s/iter; left time: 1703.0345s
	iters: 300, epoch: 7 | loss: 0.0047452
	speed: 0.1569s/iter; left time: 1719.4613s
	iters: 400, epoch: 7 | loss: 0.0030117
	speed: 0.1576s/iter; left time: 1711.1377s
Epoch: 7 cost time: 75.2396731376648
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0002643
	speed: 0.4833s/iter; left time: 5165.7262s
	iters: 200, epoch: 8 | loss: 0.2500739
	speed: 0.1582s/iter; left time: 1675.3102s
	iters: 300, epoch: 8 | loss: 0.0005844
	speed: 0.1570s/iter; left time: 1646.3464s
	iters: 400, epoch: 8 | loss: 0.0013525
	speed: 0.1506s/iter; left time: 1564.6272s
Epoch: 8 cost time: 73.56044149398804
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0001914
	speed: 0.5661s/iter; left time: 5784.7103s
	iters: 200, epoch: 9 | loss: 0.0004635
	speed: 0.1872s/iter; left time: 1894.6725s
	iters: 300, epoch: 9 | loss: 0.0001609
	speed: 0.1852s/iter; left time: 1855.0977s
	iters: 400, epoch: 9 | loss: 0.0005661
	speed: 0.1805s/iter; left time: 1790.4710s
Epoch: 9 cost time: 86.55322742462158
Epoch: 9, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000894
	speed: 0.5360s/iter; left time: 5226.1893s
	iters: 200, epoch: 10 | loss: 0.0140789
	speed: 0.1561s/iter; left time: 1506.7293s
	iters: 300, epoch: 10 | loss: 0.0003250
	speed: 0.1492s/iter; left time: 1424.7241s
	iters: 400, epoch: 10 | loss: 0.0013758
	speed: 0.1321s/iter; left time: 1247.8783s
Epoch: 10 cost time: 69.41723704338074
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0001117
	speed: 0.4502s/iter; left time: 4178.1383s
	iters: 200, epoch: 11 | loss: 0.0009156
	speed: 0.1444s/iter; left time: 1326.1709s
	iters: 300, epoch: 11 | loss: 0.0010087
	speed: 0.1518s/iter; left time: 1378.1807s
	iters: 400, epoch: 11 | loss: 0.0009677
	speed: 0.1686s/iter; left time: 1514.2225s
Epoch: 11 cost time: 72.487557888031
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 18758154
model size : 74.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3537620
	speed: 0.0693s/iter; left time: 967.7856s
	iters: 200, epoch: 1 | loss: 0.1624419
	speed: 0.0561s/iter; left time: 777.6708s
	iters: 300, epoch: 1 | loss: 0.0374802
	speed: 0.0593s/iter; left time: 816.4087s
	iters: 400, epoch: 1 | loss: 0.5184311
	speed: 0.0555s/iter; left time: 758.3340s
Epoch: 1 cost time: 28.017895936965942
Epoch: 1, Steps: 469 | Train Loss: 0.371 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
Validation loss decreased (inf --> -0.965694).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0766819
	speed: 0.1922s/iter; left time: 2595.2955s
	iters: 200, epoch: 2 | loss: 0.0320007
	speed: 0.0516s/iter; left time: 691.9358s
	iters: 300, epoch: 2 | loss: 0.0160556
	speed: 0.0474s/iter; left time: 629.8830s
	iters: 400, epoch: 2 | loss: 0.0431072
	speed: 0.0498s/iter; left time: 657.6105s
Epoch: 2 cost time: 23.81143069267273
Epoch: 2, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0727450
	speed: 0.1828s/iter; left time: 2382.8048s
	iters: 200, epoch: 3 | loss: 0.0064601
	speed: 0.0471s/iter; left time: 609.3547s
	iters: 300, epoch: 3 | loss: 0.0040526
	speed: 0.0472s/iter; left time: 606.0591s
	iters: 400, epoch: 3 | loss: 0.0138929
	speed: 0.0525s/iter; left time: 667.9350s
Epoch: 3 cost time: 23.442222356796265
Epoch: 3, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.965694 --> -0.968267).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0077168
	speed: 0.1794s/iter; left time: 2253.8259s
	iters: 200, epoch: 4 | loss: 0.0022439
	speed: 0.0491s/iter; left time: 611.9794s
	iters: 300, epoch: 4 | loss: 0.0342904
	speed: 0.0515s/iter; left time: 636.2982s
	iters: 400, epoch: 4 | loss: 0.0014147
	speed: 0.0470s/iter; left time: 576.0088s
Epoch: 4 cost time: 23.139925241470337
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0173845
	speed: 0.1869s/iter; left time: 2260.9183s
	iters: 200, epoch: 5 | loss: 0.0777557
	speed: 0.0576s/iter; left time: 690.3424s
	iters: 300, epoch: 5 | loss: 0.0023680
	speed: 0.0579s/iter; left time: 689.3000s
	iters: 400, epoch: 5 | loss: 0.0017718
	speed: 0.0583s/iter; left time: 687.8316s
Epoch: 5 cost time: 27.541894674301147
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.968267 --> -0.971697).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0913081
	speed: 0.2078s/iter; left time: 2415.6512s
	iters: 200, epoch: 6 | loss: 0.2147629
	speed: 0.0570s/iter; left time: 656.5729s
	iters: 300, epoch: 6 | loss: 0.0005427
	speed: 0.0558s/iter; left time: 637.5439s
	iters: 400, epoch: 6 | loss: 0.0791401
	speed: 0.0496s/iter; left time: 561.3200s
Epoch: 6 cost time: 26.290311574935913
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.188 Vali Acc: 0.947 Test Loss: 0.188 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0024224
	speed: 0.2101s/iter; left time: 2343.9727s
	iters: 200, epoch: 7 | loss: 0.0001380
	speed: 0.0566s/iter; left time: 625.5664s
	iters: 300, epoch: 7 | loss: 0.0045966
	speed: 0.0612s/iter; left time: 670.7906s
	iters: 400, epoch: 7 | loss: 0.0000579
	speed: 0.0582s/iter; left time: 631.6865s
Epoch: 7 cost time: 27.85819435119629
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.971697 --> -0.975699).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6967131
	speed: 0.1883s/iter; left time: 2012.2370s
	iters: 200, epoch: 8 | loss: 0.0069562
	speed: 0.0505s/iter; left time: 534.4832s
	iters: 300, epoch: 8 | loss: 0.0002598
	speed: 0.0486s/iter; left time: 510.1312s
	iters: 400, epoch: 8 | loss: 0.0043991
	speed: 0.0534s/iter; left time: 554.6632s
Epoch: 8 cost time: 24.125957489013672
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0006021
	speed: 0.1844s/iter; left time: 1884.2628s
	iters: 200, epoch: 9 | loss: 0.0113950
	speed: 0.0506s/iter; left time: 511.9690s
	iters: 300, epoch: 9 | loss: 0.0016206
	speed: 0.0520s/iter; left time: 520.9266s
	iters: 400, epoch: 9 | loss: 0.0338806
	speed: 0.0483s/iter; left time: 478.6547s
Epoch: 9 cost time: 24.00793743133545
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977986).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0200616
	speed: 0.1898s/iter; left time: 1851.0027s
	iters: 200, epoch: 10 | loss: 0.0031900
	speed: 0.0484s/iter; left time: 467.1521s
	iters: 300, epoch: 10 | loss: 0.0082689
	speed: 0.0535s/iter; left time: 510.9161s
	iters: 400, epoch: 10 | loss: 0.1321802
	speed: 0.0508s/iter; left time: 479.7735s
Epoch: 10 cost time: 24.121105909347534
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0013139
	speed: 0.1967s/iter; left time: 1825.2125s
	iters: 200, epoch: 11 | loss: 0.0000202
	speed: 0.0597s/iter; left time: 547.8253s
	iters: 300, epoch: 11 | loss: 0.0008056
	speed: 0.0564s/iter; left time: 512.0926s
	iters: 400, epoch: 11 | loss: 0.0012599
	speed: 0.0601s/iter; left time: 539.6208s
Epoch: 11 cost time: 27.80705738067627
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0011428
	speed: 0.2016s/iter; left time: 1776.6530s
	iters: 200, epoch: 12 | loss: 0.0013635
	speed: 0.0590s/iter; left time: 514.0184s
	iters: 300, epoch: 12 | loss: 0.0013189
	speed: 0.0594s/iter; left time: 511.4261s
	iters: 400, epoch: 12 | loss: 0.0004270
	speed: 0.0575s/iter; left time: 489.6775s
Epoch: 12 cost time: 27.44661593437195
Epoch: 12, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.977986 --> -0.980559).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0017115
	speed: 0.2119s/iter; left time: 1767.7822s
	iters: 200, epoch: 13 | loss: 0.0020680
	speed: 0.0566s/iter; left time: 466.3776s
	iters: 300, epoch: 13 | loss: 0.0000489
	speed: 0.0601s/iter; left time: 489.0827s
	iters: 400, epoch: 13 | loss: 0.1957168
	speed: 0.0614s/iter; left time: 493.8442s
Epoch: 13 cost time: 27.67668104171753
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002127
	speed: 0.1798s/iter; left time: 1415.9175s
	iters: 200, epoch: 14 | loss: 0.0001231
	speed: 0.0501s/iter; left time: 389.6314s
	iters: 300, epoch: 14 | loss: 0.0004717
	speed: 0.0438s/iter; left time: 336.1469s
	iters: 400, epoch: 14 | loss: 0.0020113
	speed: 0.0479s/iter; left time: 362.7199s
Epoch: 14 cost time: 22.834879159927368
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0082998
	speed: 0.1726s/iter; left time: 1277.8801s
	iters: 200, epoch: 15 | loss: 0.0001066
	speed: 0.0451s/iter; left time: 329.7219s
	iters: 300, epoch: 15 | loss: 0.0000939
	speed: 0.0486s/iter; left time: 349.9815s
	iters: 400, epoch: 15 | loss: 0.0020033
	speed: 0.0469s/iter; left time: 333.5479s
Epoch: 15 cost time: 22.223238945007324
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002835
	speed: 0.1749s/iter; left time: 1213.4523s
	iters: 200, epoch: 16 | loss: 0.0003912
	speed: 0.0469s/iter; left time: 320.7145s
	iters: 300, epoch: 16 | loss: 0.0000642
	speed: 0.0490s/iter; left time: 330.1347s
	iters: 400, epoch: 16 | loss: 0.1709909
	speed: 0.0488s/iter; left time: 323.9513s
Epoch: 16 cost time: 23.366177320480347
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000438
	speed: 0.1908s/iter; left time: 1234.0935s
	iters: 200, epoch: 17 | loss: 0.0002354
	speed: 0.0544s/iter; left time: 346.3072s
	iters: 300, epoch: 17 | loss: 0.0009319
	speed: 0.0532s/iter; left time: 333.2862s
	iters: 400, epoch: 17 | loss: 0.0000408
	speed: 0.0571s/iter; left time: 352.0239s
Epoch: 17 cost time: 26.034133672714233
Epoch: 17, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0115821
	speed: 0.1930s/iter; left time: 1157.4482s
	iters: 200, epoch: 18 | loss: 0.0001770
	speed: 0.0562s/iter; left time: 331.1747s
	iters: 300, epoch: 18 | loss: 0.0002588
	speed: 0.0541s/iter; left time: 313.7899s
	iters: 400, epoch: 18 | loss: 0.0000219
	speed: 0.0583s/iter; left time: 331.9867s
Epoch: 18 cost time: 26.45532250404358
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.981131).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0179831
	speed: 0.1929s/iter; left time: 1066.3138s
	iters: 200, epoch: 19 | loss: 0.0001497
	speed: 0.0575s/iter; left time: 312.2889s
	iters: 300, epoch: 19 | loss: 0.0000338
	speed: 0.0557s/iter; left time: 297.0030s
	iters: 400, epoch: 19 | loss: 0.0001782
	speed: 0.0498s/iter; left time: 260.3437s
Epoch: 19 cost time: 25.584463357925415
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.981131 --> -0.981703).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001801
	speed: 0.1816s/iter; left time: 918.8675s
	iters: 200, epoch: 20 | loss: 0.1308076
	speed: 0.0489s/iter; left time: 242.6920s
	iters: 300, epoch: 20 | loss: 0.0003636
	speed: 0.0491s/iter; left time: 238.7959s
	iters: 400, epoch: 20 | loss: 0.0032815
	speed: 0.0467s/iter; left time: 222.4297s
Epoch: 20 cost time: 22.909989833831787
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3263398
	speed: 0.1725s/iter; left time: 792.1572s
	iters: 200, epoch: 21 | loss: 0.0002941
	speed: 0.0462s/iter; left time: 207.3418s
	iters: 300, epoch: 21 | loss: 0.0000995
	speed: 0.0500s/iter; left time: 219.4586s
	iters: 400, epoch: 21 | loss: 0.0000667
	speed: 0.0453s/iter; left time: 194.2172s
Epoch: 21 cost time: 22.599135160446167
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0001058
	speed: 0.1744s/iter; left time: 718.7344s
	iters: 200, epoch: 22 | loss: 0.0067996
	speed: 0.0477s/iter; left time: 191.7469s
	iters: 300, epoch: 22 | loss: 0.0000115
	speed: 0.0471s/iter; left time: 184.6515s
	iters: 400, epoch: 22 | loss: 0.0002188
	speed: 0.0490s/iter; left time: 187.2965s
Epoch: 22 cost time: 23.120814085006714
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000455
	speed: 0.2230s/iter; left time: 814.5823s
	iters: 200, epoch: 23 | loss: 0.0003289
	speed: 0.0652s/iter; left time: 231.6387s
	iters: 300, epoch: 23 | loss: 0.0001576
	speed: 0.0698s/iter; left time: 241.0910s
	iters: 400, epoch: 23 | loss: 0.0000658
	speed: 0.0651s/iter; left time: 218.3941s
Epoch: 23 cost time: 31.013023614883423
Epoch: 23, Steps: 469 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982846).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000236
	speed: 0.2344s/iter; left time: 746.2213s
	iters: 200, epoch: 24 | loss: 0.0001560
	speed: 0.0646s/iter; left time: 199.3317s
	iters: 300, epoch: 24 | loss: 0.0000129
	speed: 0.0695s/iter; left time: 207.3756s
	iters: 400, epoch: 24 | loss: 0.0000860
	speed: 0.0651s/iter; left time: 187.8824s
Epoch: 24 cost time: 30.84601855278015
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0016936
	speed: 0.2329s/iter; left time: 632.2669s
	iters: 200, epoch: 25 | loss: 0.0318927
	speed: 0.0653s/iter; left time: 170.8210s
	iters: 300, epoch: 25 | loss: 0.2530482
	speed: 0.0621s/iter; left time: 156.1323s
	iters: 400, epoch: 25 | loss: 0.0000927
	speed: 0.0574s/iter; left time: 138.5666s
Epoch: 25 cost time: 28.993398666381836
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000489
	speed: 0.2093s/iter; left time: 470.1421s
	iters: 200, epoch: 26 | loss: 0.4183109
	speed: 0.0565s/iter; left time: 121.2166s
	iters: 300, epoch: 26 | loss: 0.0003567
	speed: 0.0598s/iter; left time: 122.2702s
	iters: 400, epoch: 26 | loss: 0.0012266
	speed: 0.0555s/iter; left time: 108.0486s
Epoch: 26 cost time: 26.893745183944702
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0002158
	speed: 0.2039s/iter; left time: 362.3148s
	iters: 200, epoch: 27 | loss: 0.0004186
	speed: 0.0540s/iter; left time: 90.5922s
	iters: 300, epoch: 27 | loss: 0.2020253
	speed: 0.0616s/iter; left time: 97.0672s
	iters: 400, epoch: 27 | loss: 0.0000787
	speed: 0.0575s/iter; left time: 84.9866s
Epoch: 27 cost time: 27.029975175857544
Epoch: 27, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982846 --> -0.983418).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000773
	speed: 0.2096s/iter; left time: 274.1959s
	iters: 200, epoch: 28 | loss: 0.0081741
	speed: 0.0547s/iter; left time: 66.0773s
	iters: 300, epoch: 28 | loss: 0.0002003
	speed: 0.0585s/iter; left time: 64.8034s
	iters: 400, epoch: 28 | loss: 0.0025492
	speed: 0.0669s/iter; left time: 67.4801s
Epoch: 28 cost time: 28.43004083633423
Epoch: 28, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0004803
	speed: 0.2358s/iter; left time: 197.8024s
	iters: 200, epoch: 29 | loss: 0.0002199
	speed: 0.0635s/iter; left time: 46.9461s
	iters: 300, epoch: 29 | loss: 0.0000351
	speed: 0.0701s/iter; left time: 44.8213s
	iters: 400, epoch: 29 | loss: 0.0015963
	speed: 0.0693s/iter; left time: 37.3739s
Epoch: 29 cost time: 31.562668561935425
Epoch: 29, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0017750
	speed: 0.2026s/iter; left time: 74.9504s
	iters: 200, epoch: 30 | loss: 0.0000503
	speed: 0.0547s/iter; left time: 14.7815s
	iters: 300, epoch: 30 | loss: 0.0000729
	speed: 0.0599s/iter; left time: 10.1835s
	iters: 400, epoch: 30 | loss: 0.0000336
	speed: 0.0570s/iter; left time: 3.9913s
Epoch: 30 cost time: 26.31709909439087
Epoch: 30, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 5518858
model size : 23.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1767212
	speed: 0.1217s/iter; left time: 1699.6540s
	iters: 200, epoch: 1 | loss: 0.0986104
	speed: 0.1020s/iter; left time: 1415.2168s
	iters: 300, epoch: 1 | loss: 0.0243519
	speed: 0.1069s/iter; left time: 1472.3904s
	iters: 400, epoch: 1 | loss: 0.0348959
	speed: 0.0992s/iter; left time: 1356.4917s
Epoch: 1 cost time: 50.56039643287659
Epoch: 1, Steps: 469 | Train Loss: 0.359 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (inf --> -0.966837).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0082071
	speed: 0.3405s/iter; left time: 4597.8647s
	iters: 200, epoch: 2 | loss: 0.1396552
	speed: 0.1059s/iter; left time: 1419.7835s
	iters: 300, epoch: 2 | loss: 0.0025857
	speed: 0.1004s/iter; left time: 1335.8299s
	iters: 400, epoch: 2 | loss: 0.0108324
	speed: 0.1065s/iter; left time: 1405.6619s
Epoch: 2 cost time: 48.76842141151428
Epoch: 2, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.966837 --> -0.969982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034617
	speed: 0.3874s/iter; left time: 5048.5505s
	iters: 200, epoch: 3 | loss: 0.0045883
	speed: 0.1202s/iter; left time: 1554.6640s
	iters: 300, epoch: 3 | loss: 0.0088947
	speed: 0.1191s/iter; left time: 1528.5109s
	iters: 400, epoch: 3 | loss: 0.0097750
	speed: 0.1231s/iter; left time: 1568.0465s
Epoch: 3 cost time: 57.17432475090027
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.969982 --> -0.979702).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0284533
	speed: 0.3986s/iter; left time: 5007.9623s
	iters: 200, epoch: 4 | loss: 0.0633541
	speed: 0.1187s/iter; left time: 1479.6925s
	iters: 300, epoch: 4 | loss: 0.0285098
	speed: 0.1150s/iter; left time: 1421.6343s
	iters: 400, epoch: 4 | loss: 0.0053545
	speed: 0.1054s/iter; left time: 1292.4320s
Epoch: 4 cost time: 53.73854398727417
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0109225
	speed: 0.3374s/iter; left time: 4080.4713s
	iters: 200, epoch: 5 | loss: 0.0106625
	speed: 0.1045s/iter; left time: 1253.7719s
	iters: 300, epoch: 5 | loss: 0.0033913
	speed: 0.0980s/iter; left time: 1165.5540s
	iters: 400, epoch: 5 | loss: 0.0010268
	speed: 0.0894s/iter; left time: 1053.9761s
Epoch: 5 cost time: 48.059226512908936
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0002065
	speed: 0.3629s/iter; left time: 4219.6361s
	iters: 200, epoch: 6 | loss: 0.0001774
	speed: 0.1139s/iter; left time: 1312.9784s
	iters: 300, epoch: 6 | loss: 0.0895356
	speed: 0.0974s/iter; left time: 1112.4805s
	iters: 400, epoch: 6 | loss: 0.0576915
	speed: 0.1204s/iter; left time: 1363.3691s
Epoch: 6 cost time: 51.76714015007019
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0006701
	speed: 0.3739s/iter; left time: 4171.2023s
	iters: 200, epoch: 7 | loss: 0.0006551
	speed: 0.1124s/iter; left time: 1242.6638s
	iters: 300, epoch: 7 | loss: 0.0327416
	speed: 0.0868s/iter; left time: 950.7490s
	iters: 400, epoch: 7 | loss: 0.0005945
	speed: 0.0876s/iter; left time: 950.6875s
Epoch: 7 cost time: 49.447863817214966
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002556
	speed: 0.4833s/iter; left time: 5165.3634s
	iters: 200, epoch: 8 | loss: 0.0954867
	speed: 0.1451s/iter; left time: 1536.3490s
	iters: 300, epoch: 8 | loss: 0.0027720
	speed: 0.1519s/iter; left time: 1593.6220s
	iters: 400, epoch: 8 | loss: 0.0022725
	speed: 0.1456s/iter; left time: 1512.7909s
Epoch: 8 cost time: 70.20914316177368
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007089
	speed: 0.4949s/iter; left time: 5057.3987s
	iters: 200, epoch: 9 | loss: 0.0008761
	speed: 0.1485s/iter; left time: 1502.3324s
	iters: 300, epoch: 9 | loss: 0.1747923
	speed: 0.1408s/iter; left time: 1410.2138s
	iters: 400, epoch: 9 | loss: 0.0001972
	speed: 0.1189s/iter; left time: 1179.5832s
Epoch: 9 cost time: 63.54427647590637
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000639
	speed: 0.3827s/iter; left time: 3731.3110s
	iters: 200, epoch: 10 | loss: 0.0085560
	speed: 0.1117s/iter; left time: 1078.2416s
	iters: 300, epoch: 10 | loss: 0.0000993
	speed: 0.1131s/iter; left time: 1080.3207s
	iters: 400, epoch: 10 | loss: 0.3137964
	speed: 0.1135s/iter; left time: 1072.1474s
Epoch: 10 cost time: 53.28285551071167
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0086319
	speed: 0.3807s/iter; left time: 3533.7324s
	iters: 200, epoch: 11 | loss: 0.0001144
	speed: 0.1139s/iter; left time: 1045.3411s
	iters: 300, epoch: 11 | loss: 0.0001051
	speed: 0.1111s/iter; left time: 1008.6026s
	iters: 400, epoch: 11 | loss: 0.0023240
	speed: 0.1132s/iter; left time: 1016.8809s
Epoch: 11 cost time: 54.87404465675354
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0012128
	speed: 0.4584s/iter; left time: 4039.8603s
	iters: 200, epoch: 12 | loss: 0.0003148
	speed: 0.1404s/iter; left time: 1223.2448s
	iters: 300, epoch: 12 | loss: 0.0016439
	speed: 0.1396s/iter; left time: 1202.0144s
	iters: 400, epoch: 12 | loss: 0.0008334
	speed: 0.1372s/iter; left time: 1167.5784s
Epoch: 12 cost time: 65.64556121826172
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0001831
	speed: 0.4651s/iter; left time: 3880.5376s
	iters: 200, epoch: 13 | loss: 0.0004512
	speed: 0.1361s/iter; left time: 1121.5045s
	iters: 300, epoch: 13 | loss: 0.0001650
	speed: 0.1415s/iter; left time: 1151.8352s
	iters: 400, epoch: 13 | loss: 0.0002235
	speed: 0.1189s/iter; left time: 956.4764s
Epoch: 13 cost time: 61.62465023994446
Epoch: 13, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 18758154
model size : 74.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3739077
	speed: 0.0533s/iter; left time: 745.1740s
	iters: 200, epoch: 1 | loss: 0.1457538
	speed: 0.0394s/iter; left time: 546.1740s
	iters: 300, epoch: 1 | loss: 0.0391990
	speed: 0.0450s/iter; left time: 619.5179s
	iters: 400, epoch: 1 | loss: 0.5240802
	speed: 0.0433s/iter; left time: 592.0532s
Epoch: 1 cost time: 21.108640909194946
Epoch: 1, Steps: 469 | Train Loss: 0.378 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (inf --> -0.964550).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1308780
	speed: 0.1767s/iter; left time: 2385.8626s
	iters: 200, epoch: 2 | loss: 0.0169443
	speed: 0.0434s/iter; left time: 581.4921s
	iters: 300, epoch: 2 | loss: 0.0792122
	speed: 0.0419s/iter; left time: 556.7555s
	iters: 400, epoch: 2 | loss: 0.0291837
	speed: 0.0406s/iter; left time: 536.3058s
Epoch: 2 cost time: 20.004728078842163
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0103590
	speed: 0.1844s/iter; left time: 2403.6193s
	iters: 200, epoch: 3 | loss: 0.0059769
	speed: 0.0537s/iter; left time: 695.0449s
	iters: 300, epoch: 3 | loss: 0.0061823
	speed: 0.0528s/iter; left time: 677.6818s
	iters: 400, epoch: 3 | loss: 0.0362262
	speed: 0.0552s/iter; left time: 702.4630s
Epoch: 3 cost time: 25.901722192764282
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1164832
	speed: 0.2246s/iter; left time: 2822.4581s
	iters: 200, epoch: 4 | loss: 0.0040168
	speed: 0.0533s/iter; left time: 664.4417s
	iters: 300, epoch: 4 | loss: 0.0075199
	speed: 0.0581s/iter; left time: 718.9143s
	iters: 400, epoch: 4 | loss: 0.0014997
	speed: 0.0551s/iter; left time: 676.3592s
Epoch: 4 cost time: 25.97862148284912
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.964550 --> -0.970554).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0028572
	speed: 0.2281s/iter; left time: 2758.7985s
	iters: 200, epoch: 5 | loss: 0.0038542
	speed: 0.0575s/iter; left time: 690.1072s
	iters: 300, epoch: 5 | loss: 0.0014950
	speed: 0.0532s/iter; left time: 633.1102s
	iters: 400, epoch: 5 | loss: 0.0063340
	speed: 0.0540s/iter; left time: 636.7478s
Epoch: 5 cost time: 26.333216190338135
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0062478
	speed: 0.2307s/iter; left time: 2681.9936s
	iters: 200, epoch: 6 | loss: 0.0983202
	speed: 0.0531s/iter; left time: 611.7883s
	iters: 300, epoch: 6 | loss: 0.0021603
	speed: 0.0553s/iter; left time: 631.5633s
	iters: 400, epoch: 6 | loss: 0.1248682
	speed: 0.0428s/iter; left time: 484.7078s
Epoch: 6 cost time: 23.925441026687622
Epoch: 6, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0235678
	speed: 0.1764s/iter; left time: 1968.5504s
	iters: 200, epoch: 7 | loss: 0.0005754
	speed: 0.0439s/iter; left time: 485.5691s
	iters: 300, epoch: 7 | loss: 0.0099631
	speed: 0.0450s/iter; left time: 493.4264s
	iters: 400, epoch: 7 | loss: 0.0000798
	speed: 0.0410s/iter; left time: 444.7072s
Epoch: 7 cost time: 20.43462824821472
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1934051
	speed: 0.1784s/iter; left time: 1907.1414s
	iters: 200, epoch: 8 | loss: 0.0003168
	speed: 0.0432s/iter; left time: 457.1927s
	iters: 300, epoch: 8 | loss: 0.0001638
	speed: 0.0387s/iter; left time: 405.7723s
	iters: 400, epoch: 8 | loss: 0.0527182
	speed: 0.0426s/iter; left time: 442.6421s
Epoch: 8 cost time: 20.277841567993164
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0003350
	speed: 0.1824s/iter; left time: 1863.5405s
	iters: 200, epoch: 9 | loss: 0.0001346
	speed: 0.0425s/iter; left time: 429.8525s
	iters: 300, epoch: 9 | loss: 0.0002208
	speed: 0.0419s/iter; left time: 419.3886s
	iters: 400, epoch: 9 | loss: 0.0010527
	speed: 0.0457s/iter; left time: 453.0537s
Epoch: 9 cost time: 20.837701320648193
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.970554 --> -0.975699).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0128628
	speed: 0.1796s/iter; left time: 1751.4618s
	iters: 200, epoch: 10 | loss: 0.0002345
	speed: 0.0377s/iter; left time: 363.3361s
	iters: 300, epoch: 10 | loss: 0.0072898
	speed: 0.0564s/iter; left time: 538.3558s
	iters: 400, epoch: 10 | loss: 0.1182685
	speed: 0.0539s/iter; left time: 509.8239s
Epoch: 10 cost time: 23.08021879196167
Epoch: 10, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.959 Test Loss: 0.225 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0112245
	speed: 0.2228s/iter; left time: 2068.0694s
	iters: 200, epoch: 11 | loss: 0.0083273
	speed: 0.0575s/iter; left time: 528.2826s
	iters: 300, epoch: 11 | loss: 0.0194778
	speed: 0.0538s/iter; left time: 488.5028s
	iters: 400, epoch: 11 | loss: 0.0072564
	speed: 0.0535s/iter; left time: 480.7611s
Epoch: 11 cost time: 26.13719415664673
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.961 Test Loss: 0.207 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0110275
	speed: 0.2285s/iter; left time: 2013.2656s
	iters: 200, epoch: 12 | loss: 0.0005260
	speed: 0.0537s/iter; left time: 467.8245s
	iters: 300, epoch: 12 | loss: 0.0720463
	speed: 0.0543s/iter; left time: 467.9043s
	iters: 400, epoch: 12 | loss: 0.0001049
	speed: 0.0592s/iter; left time: 504.2066s
Epoch: 12 cost time: 26.679473161697388
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0007210
	speed: 0.2251s/iter; left time: 1877.9546s
	iters: 200, epoch: 13 | loss: 0.0042688
	speed: 0.0560s/iter; left time: 461.6707s
	iters: 300, epoch: 13 | loss: 0.0001187
	speed: 0.0578s/iter; left time: 470.8586s
	iters: 400, epoch: 13 | loss: 0.0006657
	speed: 0.0538s/iter; left time: 432.7233s
Epoch: 13 cost time: 26.176743745803833
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.975699 --> -0.981417).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0041457
	speed: 0.1854s/iter; left time: 1460.0867s
	iters: 200, epoch: 14 | loss: 0.0000323
	speed: 0.0405s/iter; left time: 314.8836s
	iters: 300, epoch: 14 | loss: 0.0062055
	speed: 0.0402s/iter; left time: 308.3030s
	iters: 400, epoch: 14 | loss: 0.0000606
	speed: 0.0393s/iter; left time: 297.7672s
Epoch: 14 cost time: 19.436986923217773
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0148732
	speed: 0.1723s/iter; left time: 1275.8710s
	iters: 200, epoch: 15 | loss: 0.0000564
	speed: 0.0403s/iter; left time: 294.7125s
	iters: 300, epoch: 15 | loss: 0.0161623
	speed: 0.0420s/iter; left time: 302.3351s
	iters: 400, epoch: 15 | loss: 0.0018057
	speed: 0.0375s/iter; left time: 266.4249s
Epoch: 15 cost time: 19.256903886795044
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0004997
	speed: 0.1676s/iter; left time: 1162.2477s
	iters: 200, epoch: 16 | loss: 0.0007237
	speed: 0.0404s/iter; left time: 276.3029s
	iters: 300, epoch: 16 | loss: 0.0007688
	speed: 0.0411s/iter; left time: 277.0417s
	iters: 400, epoch: 16 | loss: 0.0077737
	speed: 0.0400s/iter; left time: 265.6045s
Epoch: 16 cost time: 19.32568883895874
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000679
	speed: 0.1711s/iter; left time: 1106.6669s
	iters: 200, epoch: 17 | loss: 0.0001051
	speed: 0.0399s/iter; left time: 253.8363s
	iters: 300, epoch: 17 | loss: 0.0007363
	speed: 0.0389s/iter; left time: 243.9252s
	iters: 400, epoch: 17 | loss: 0.0000250
	speed: 0.0529s/iter; left time: 326.2304s
Epoch: 17 cost time: 21.322892665863037
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001188
	speed: 0.2103s/iter; left time: 1261.4164s
	iters: 200, epoch: 18 | loss: 0.0001340
	speed: 0.0509s/iter; left time: 300.2820s
	iters: 300, epoch: 18 | loss: 0.0000709
	speed: 0.0535s/iter; left time: 309.9145s
	iters: 400, epoch: 18 | loss: 0.0000553
	speed: 0.0516s/iter; left time: 293.9703s
Epoch: 18 cost time: 24.70097017288208
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0077069
	speed: 0.2097s/iter; left time: 1159.3131s
	iters: 200, epoch: 19 | loss: 0.0000270
	speed: 0.0533s/iter; left time: 289.5791s
	iters: 300, epoch: 19 | loss: 0.0001021
	speed: 0.0506s/iter; left time: 269.8368s
	iters: 400, epoch: 19 | loss: 0.0008673
	speed: 0.0519s/iter; left time: 271.6381s
Epoch: 19 cost time: 24.8593430519104
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0003143
	speed: 0.2130s/iter; left time: 1077.5872s
	iters: 200, epoch: 20 | loss: 0.0000452
	speed: 0.0507s/iter; left time: 251.7108s
	iters: 300, epoch: 20 | loss: 0.0031925
	speed: 0.0526s/iter; left time: 255.5726s
	iters: 400, epoch: 20 | loss: 0.0022536
	speed: 0.0517s/iter; left time: 246.0701s
Epoch: 20 cost time: 24.559818029403687
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0036466
	speed: 0.1812s/iter; left time: 831.9653s
	iters: 200, epoch: 21 | loss: 0.0001570
	speed: 0.0399s/iter; left time: 179.1333s
	iters: 300, epoch: 21 | loss: 0.0002079
	speed: 0.0397s/iter; left time: 174.5145s
	iters: 400, epoch: 21 | loss: 0.1372684
	speed: 0.0356s/iter; left time: 152.6843s
Epoch: 21 cost time: 18.87093997001648
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000833
	speed: 0.1858s/iter; left time: 765.7019s
	iters: 200, epoch: 22 | loss: 0.0048865
	speed: 0.0471s/iter; left time: 189.4696s
	iters: 300, epoch: 22 | loss: 0.0001153
	speed: 0.0501s/iter; left time: 196.5630s
	iters: 400, epoch: 22 | loss: 0.1549951
	speed: 0.0445s/iter; left time: 170.0885s
Epoch: 22 cost time: 21.89159893989563
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000647
	speed: 0.1799s/iter; left time: 657.2021s
	iters: 200, epoch: 23 | loss: 0.0092542
	speed: 0.0452s/iter; left time: 160.7705s
	iters: 300, epoch: 23 | loss: 0.0002708
	speed: 0.0449s/iter; left time: 155.0381s
	iters: 400, epoch: 23 | loss: 0.0002535
	speed: 0.0456s/iter; left time: 152.7686s
Epoch: 23 cost time: 21.726642847061157
Epoch: 23, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 5518858
model size : 23.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2815910
	speed: 0.1005s/iter; left time: 1404.0468s
	iters: 200, epoch: 1 | loss: 0.1354296
	speed: 0.0902s/iter; left time: 1250.6355s
	iters: 300, epoch: 1 | loss: 0.0508019
	speed: 0.0859s/iter; left time: 1182.6206s
	iters: 400, epoch: 1 | loss: 0.0523995
	speed: 0.0872s/iter; left time: 1191.7848s
Epoch: 1 cost time: 42.65097713470459
Epoch: 1, Steps: 469 | Train Loss: 0.384 Vali Loss: 0.125 Vali Acc: 0.958 Test Loss: 0.125 Test Acc: 0.958
Validation loss decreased (inf --> -0.957689).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0430434
	speed: 0.3154s/iter; left time: 4258.9442s
	iters: 200, epoch: 2 | loss: 0.1069634
	speed: 0.0863s/iter; left time: 1156.5116s
	iters: 300, epoch: 2 | loss: 0.0024608
	speed: 0.0852s/iter; left time: 1133.9390s
	iters: 400, epoch: 2 | loss: 0.0841356
	speed: 0.0903s/iter; left time: 1192.0802s
Epoch: 2 cost time: 41.53760766983032
Epoch: 2, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0012685
	speed: 0.3149s/iter; left time: 4104.3547s
	iters: 200, epoch: 3 | loss: 0.0048047
	speed: 0.0852s/iter; left time: 1101.5885s
	iters: 300, epoch: 3 | loss: 0.0043529
	speed: 0.0909s/iter; left time: 1166.4162s
	iters: 400, epoch: 3 | loss: 0.0245018
	speed: 0.0870s/iter; left time: 1108.2210s
Epoch: 3 cost time: 41.28669047355652
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.957689 --> -0.976843).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1082847
	speed: 0.2818s/iter; left time: 3540.2073s
	iters: 200, epoch: 4 | loss: 0.0160458
	speed: 0.0745s/iter; left time: 928.0025s
	iters: 300, epoch: 4 | loss: 0.0048349
	speed: 0.0721s/iter; left time: 892.0249s
	iters: 400, epoch: 4 | loss: 0.0043303
	speed: 0.0693s/iter; left time: 849.4378s
Epoch: 4 cost time: 33.86868214607239
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0717037
	speed: 0.2664s/iter; left time: 3222.5353s
	iters: 200, epoch: 5 | loss: 0.0149850
	speed: 0.0705s/iter; left time: 845.1249s
	iters: 300, epoch: 5 | loss: 0.0015966
	speed: 0.0693s/iter; left time: 824.4967s
	iters: 400, epoch: 5 | loss: 0.0038396
	speed: 0.0720s/iter; left time: 849.5196s
Epoch: 5 cost time: 33.99574947357178
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003114
	speed: 0.2677s/iter; left time: 3111.9462s
	iters: 200, epoch: 6 | loss: 0.0181353
	speed: 0.0707s/iter; left time: 814.7191s
	iters: 300, epoch: 6 | loss: 0.3002724
	speed: 0.0687s/iter; left time: 785.1880s
	iters: 400, epoch: 6 | loss: 0.2091192
	speed: 0.0743s/iter; left time: 841.3574s
Epoch: 6 cost time: 34.08084750175476
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.235 Vali Acc: 0.945 Test Loss: 0.235 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0073744
	speed: 0.3010s/iter; left time: 3357.8496s
	iters: 200, epoch: 7 | loss: 0.0188741
	speed: 0.0845s/iter; left time: 934.7864s
	iters: 300, epoch: 7 | loss: 0.0037662
	speed: 0.0893s/iter; left time: 977.9440s
	iters: 400, epoch: 7 | loss: 0.0024064
	speed: 0.0875s/iter; left time: 950.0185s
Epoch: 7 cost time: 41.12826919555664
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0147763
	speed: 0.2908s/iter; left time: 3108.4383s
	iters: 200, epoch: 8 | loss: 0.0017943
	speed: 0.0819s/iter; left time: 867.5192s
	iters: 300, epoch: 8 | loss: 0.0070790
	speed: 0.0804s/iter; left time: 842.7954s
	iters: 400, epoch: 8 | loss: 0.0008294
	speed: 0.0844s/iter; left time: 876.2955s
Epoch: 8 cost time: 38.71313166618347
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0002364
	speed: 0.2919s/iter; left time: 2982.8079s
	iters: 200, epoch: 9 | loss: 0.0289612
	speed: 0.0825s/iter; left time: 834.4653s
	iters: 300, epoch: 9 | loss: 0.0800719
	speed: 0.0826s/iter; left time: 828.0415s
	iters: 400, epoch: 9 | loss: 0.0002548
	speed: 0.0636s/iter; left time: 630.4954s
Epoch: 9 cost time: 35.936487913131714
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0159107
	speed: 0.2476s/iter; left time: 2414.0818s
	iters: 200, epoch: 10 | loss: 0.2119408
	speed: 0.0657s/iter; left time: 633.9246s
	iters: 300, epoch: 10 | loss: 0.0062992
	speed: 0.0650s/iter; left time: 620.8184s
	iters: 400, epoch: 10 | loss: 0.5680164
	speed: 0.0690s/iter; left time: 651.8402s
Epoch: 10 cost time: 31.747225046157837
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0215508
	speed: 0.2368s/iter; left time: 2197.7011s
	iters: 200, epoch: 11 | loss: 0.2888842
	speed: 0.0666s/iter; left time: 611.5459s
	iters: 300, epoch: 11 | loss: 0.0003346
	speed: 0.0694s/iter; left time: 630.0185s
	iters: 400, epoch: 11 | loss: 0.0037648
	speed: 0.0645s/iter; left time: 579.1687s
Epoch: 11 cost time: 31.4734046459198
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000238
	speed: 0.2470s/iter; left time: 2176.4772s
	iters: 200, epoch: 12 | loss: 0.1143974
	speed: 0.0669s/iter; left time: 582.4415s
	iters: 300, epoch: 12 | loss: 0.0060636
	speed: 0.0643s/iter; left time: 553.6058s
	iters: 400, epoch: 12 | loss: 0.0026464
	speed: 0.0746s/iter; left time: 634.9742s
Epoch: 12 cost time: 33.36022090911865
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0001005
	speed: 0.2951s/iter; left time: 2462.2942s
	iters: 200, epoch: 13 | loss: 0.0035062
	speed: 0.0823s/iter; left time: 678.6619s
	iters: 300, epoch: 13 | loss: 0.0002539
	speed: 0.0830s/iter; left time: 675.6354s
	iters: 400, epoch: 13 | loss: 0.0538620
	speed: 0.0803s/iter; left time: 645.9308s
Epoch: 13 cost time: 38.74733638763428
Epoch: 13, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 18758154
model size : 74.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5178914
	speed: 0.0469s/iter; left time: 654.6790s
	iters: 200, epoch: 1 | loss: 0.1079812
	speed: 0.0315s/iter; left time: 437.0670s
	iters: 300, epoch: 1 | loss: 0.0632654
	speed: 0.0305s/iter; left time: 419.6986s
	iters: 400, epoch: 1 | loss: 0.5523481
	speed: 0.0348s/iter; left time: 476.3428s
Epoch: 1 cost time: 17.056558847427368
Epoch: 1, Steps: 469 | Train Loss: 0.419 Vali Loss: 0.147 Vali Acc: 0.952 Test Loss: 0.147 Test Acc: 0.952
Validation loss decreased (inf --> -0.951971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1620559
	speed: 0.1687s/iter; left time: 2278.1413s
	iters: 200, epoch: 2 | loss: 0.0167281
	speed: 0.0376s/iter; left time: 503.8757s
	iters: 300, epoch: 2 | loss: 0.0296990
	speed: 0.0337s/iter; left time: 448.2614s
	iters: 400, epoch: 2 | loss: 0.0485736
	speed: 0.0319s/iter; left time: 420.7260s
Epoch: 2 cost time: 16.492427110671997
Epoch: 2, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.951971 --> -0.969124).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1267823
	speed: 0.1373s/iter; left time: 1789.2022s
	iters: 200, epoch: 3 | loss: 0.0065390
	speed: 0.0307s/iter; left time: 396.5084s
	iters: 300, epoch: 3 | loss: 0.0020357
	speed: 0.0299s/iter; left time: 384.1251s
	iters: 400, epoch: 3 | loss: 0.0033974
	speed: 0.0314s/iter; left time: 399.4203s
Epoch: 3 cost time: 14.946890354156494
Epoch: 3, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0028358
	speed: 0.1346s/iter; left time: 1690.4960s
	iters: 200, epoch: 4 | loss: 0.0181860
	speed: 0.0314s/iter; left time: 390.9374s
	iters: 300, epoch: 4 | loss: 0.0885039
	speed: 0.0336s/iter; left time: 415.9007s
	iters: 400, epoch: 4 | loss: 0.0014346
	speed: 0.0328s/iter; left time: 402.0723s
Epoch: 4 cost time: 15.379520177841187
Epoch: 4, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.969124 --> -0.972841).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2408330
	speed: 0.1379s/iter; left time: 1668.1965s
	iters: 200, epoch: 5 | loss: 0.0252438
	speed: 0.0322s/iter; left time: 386.1333s
	iters: 300, epoch: 5 | loss: 0.0637154
	speed: 0.0303s/iter; left time: 360.6126s
	iters: 400, epoch: 5 | loss: 0.0021554
	speed: 0.0310s/iter; left time: 365.3293s
Epoch: 5 cost time: 15.543274641036987
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0016793
	speed: 0.1355s/iter; left time: 1575.0024s
	iters: 200, epoch: 6 | loss: 0.0107199
	speed: 0.0321s/iter; left time: 370.5187s
	iters: 300, epoch: 6 | loss: 0.0054955
	speed: 0.0331s/iter; left time: 378.6539s
	iters: 400, epoch: 6 | loss: 0.0443139
	speed: 0.0326s/iter; left time: 369.2703s
Epoch: 6 cost time: 15.387622594833374
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0016232
	speed: 0.1274s/iter; left time: 1420.9839s
	iters: 200, epoch: 7 | loss: 0.0042344
	speed: 0.0375s/iter; left time: 415.0564s
	iters: 300, epoch: 7 | loss: 0.0006976
	speed: 0.0360s/iter; left time: 393.9887s
	iters: 400, epoch: 7 | loss: 0.0019979
	speed: 0.0374s/iter; left time: 406.5535s
Epoch: 7 cost time: 17.955141305923462
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0821438
	speed: 0.1707s/iter; left time: 1824.6954s
	iters: 200, epoch: 8 | loss: 0.0014101
	speed: 0.0352s/iter; left time: 372.4311s
	iters: 300, epoch: 8 | loss: 0.0014567
	speed: 0.0368s/iter; left time: 386.4195s
	iters: 400, epoch: 8 | loss: 0.0014635
	speed: 0.0369s/iter; left time: 383.4844s
Epoch: 8 cost time: 17.28902816772461
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.972841 --> -0.978558).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0008453
	speed: 0.1710s/iter; left time: 1747.1951s
	iters: 200, epoch: 9 | loss: 0.0717159
	speed: 0.0394s/iter; left time: 398.7883s
	iters: 300, epoch: 9 | loss: 0.1250968
	speed: 0.0361s/iter; left time: 361.8906s
	iters: 400, epoch: 9 | loss: 0.0008621
	speed: 0.0376s/iter; left time: 372.4767s
Epoch: 9 cost time: 18.4657244682312
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0669340
	speed: 0.1683s/iter; left time: 1641.3597s
	iters: 200, epoch: 10 | loss: 0.0011027
	speed: 0.0369s/iter; left time: 356.3956s
	iters: 300, epoch: 10 | loss: 0.0008793
	speed: 0.0376s/iter; left time: 359.4538s
	iters: 400, epoch: 10 | loss: 0.0013857
	speed: 0.0376s/iter; left time: 355.5949s
Epoch: 10 cost time: 17.887736320495605
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.978558 --> -0.983418).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0032528
	speed: 0.1677s/iter; left time: 1556.7598s
	iters: 200, epoch: 11 | loss: 0.0000256
	speed: 0.0371s/iter; left time: 340.8166s
	iters: 300, epoch: 11 | loss: 0.0289358
	speed: 0.0375s/iter; left time: 340.2833s
	iters: 400, epoch: 11 | loss: 0.0234652
	speed: 0.0292s/iter; left time: 262.1236s
Epoch: 11 cost time: 16.840697765350342
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011137
	speed: 0.1336s/iter; left time: 1177.6074s
	iters: 200, epoch: 12 | loss: 0.0012244
	speed: 0.0311s/iter; left time: 271.0937s
	iters: 300, epoch: 12 | loss: 0.1232355
	speed: 0.0322s/iter; left time: 277.6507s
	iters: 400, epoch: 12 | loss: 0.0022742
	speed: 0.0326s/iter; left time: 277.4277s
Epoch: 12 cost time: 14.998400926589966
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000949
	speed: 0.1320s/iter; left time: 1100.8946s
	iters: 200, epoch: 13 | loss: 0.0074282
	speed: 0.0316s/iter; left time: 260.1410s
	iters: 300, epoch: 13 | loss: 0.0001296
	speed: 0.0308s/iter; left time: 250.9351s
	iters: 400, epoch: 13 | loss: 0.0030084
	speed: 0.0306s/iter; left time: 246.2707s
Epoch: 13 cost time: 15.012861728668213
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0004470
	speed: 0.1265s/iter; left time: 996.2011s
	iters: 200, epoch: 14 | loss: 0.0740671
	speed: 0.0314s/iter; left time: 244.1432s
	iters: 300, epoch: 14 | loss: 0.0003118
	speed: 0.0326s/iter; left time: 250.0256s
	iters: 400, epoch: 14 | loss: 0.0015158
	speed: 0.0315s/iter; left time: 238.9399s
Epoch: 14 cost time: 15.173562288284302
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0006834
	speed: 0.1376s/iter; left time: 1019.1619s
	iters: 200, epoch: 15 | loss: 0.0003967
	speed: 0.0332s/iter; left time: 242.2184s
	iters: 300, epoch: 15 | loss: 0.1585084
	speed: 0.0326s/iter; left time: 235.1729s
	iters: 400, epoch: 15 | loss: 0.0006398
	speed: 0.0309s/iter; left time: 219.4211s
Epoch: 15 cost time: 15.43889856338501
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000736
	speed: 0.1160s/iter; left time: 804.6365s
	iters: 200, epoch: 16 | loss: 0.0033606
	speed: 0.0321s/iter; left time: 219.5067s
	iters: 300, epoch: 16 | loss: 0.0026908
	speed: 0.0370s/iter; left time: 249.3863s
	iters: 400, epoch: 16 | loss: 0.0010258
	speed: 0.0394s/iter; left time: 261.6375s
Epoch: 16 cost time: 15.883323431015015
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001326
	speed: 0.1571s/iter; left time: 1016.1944s
	iters: 200, epoch: 17 | loss: 0.0000326
	speed: 0.0364s/iter; left time: 231.7459s
	iters: 300, epoch: 17 | loss: 0.0368180
	speed: 0.0355s/iter; left time: 222.6503s
	iters: 400, epoch: 17 | loss: 0.0000268
	speed: 0.0348s/iter; left time: 214.7761s
Epoch: 17 cost time: 16.99306321144104
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0003486
	speed: 0.1550s/iter; left time: 929.8735s
	iters: 200, epoch: 18 | loss: 0.0007553
	speed: 0.0359s/iter; left time: 211.6727s
	iters: 300, epoch: 18 | loss: 0.0018952
	speed: 0.0346s/iter; left time: 200.7682s
	iters: 400, epoch: 18 | loss: 0.0003712
	speed: 0.0341s/iter; left time: 194.5313s
Epoch: 18 cost time: 16.67825746536255
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000189
	speed: 0.1573s/iter; left time: 869.9424s
	iters: 200, epoch: 19 | loss: 0.0097163
	speed: 0.0366s/iter; left time: 198.7136s
	iters: 300, epoch: 19 | loss: 0.0001420
	speed: 0.0358s/iter; left time: 190.8307s
	iters: 400, epoch: 19 | loss: 0.0002392
	speed: 0.0363s/iter; left time: 189.8597s
Epoch: 19 cost time: 17.18732762336731
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000715
	speed: 0.1572s/iter; left time: 795.5338s
	iters: 200, epoch: 20 | loss: 0.0001337
	speed: 0.0354s/iter; left time: 175.6658s
	iters: 300, epoch: 20 | loss: 0.0000467
	speed: 0.0363s/iter; left time: 176.2884s
	iters: 400, epoch: 20 | loss: 0.0039026
	speed: 0.0351s/iter; left time: 167.2860s
Epoch: 20 cost time: 16.766443490982056
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 5518858
model size : 23.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4776257
	speed: 0.1754s/iter; left time: 2450.6496s
	iters: 200, epoch: 1 | loss: 0.0985900
	speed: 0.1608s/iter; left time: 2230.1544s
	iters: 300, epoch: 1 | loss: 0.0674101
	speed: 0.1589s/iter; left time: 2188.5972s
	iters: 400, epoch: 1 | loss: 0.1552622
	speed: 0.1594s/iter; left time: 2179.5454s
Epoch: 1 cost time: 76.47472810745239
Epoch: 1, Steps: 469 | Train Loss: 0.422 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
Validation loss decreased (inf --> -0.968838).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0139912
	speed: 0.5430s/iter; left time: 7331.9064s
	iters: 200, epoch: 2 | loss: 0.0597928
	speed: 0.1703s/iter; left time: 2282.5818s
	iters: 300, epoch: 2 | loss: 0.0533430
	speed: 0.1878s/iter; left time: 2498.5309s
	iters: 400, epoch: 2 | loss: 0.2732361
	speed: 0.1886s/iter; left time: 2489.6661s
Epoch: 2 cost time: 83.9394519329071
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1178204
	speed: 0.6407s/iter; left time: 8350.6747s
	iters: 200, epoch: 3 | loss: 0.0364102
	speed: 0.1879s/iter; left time: 2429.4959s
	iters: 300, epoch: 3 | loss: 0.0007687
	speed: 0.1889s/iter; left time: 2423.7084s
	iters: 400, epoch: 3 | loss: 0.0040459
	speed: 0.1890s/iter; left time: 2406.6276s
Epoch: 3 cost time: 87.6305935382843
Epoch: 3, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0096394
	speed: 0.5658s/iter; left time: 7108.4837s
	iters: 200, epoch: 4 | loss: 0.0056012
	speed: 0.1582s/iter; left time: 1971.7862s
	iters: 300, epoch: 4 | loss: 0.0114025
	speed: 0.1574s/iter; left time: 1946.4359s
	iters: 400, epoch: 4 | loss: 0.0010372
	speed: 0.1591s/iter; left time: 1950.8302s
Epoch: 4 cost time: 74.61403250694275
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.968838 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0016348
	speed: 0.5450s/iter; left time: 6592.2994s
	iters: 200, epoch: 5 | loss: 0.0032130
	speed: 0.1600s/iter; left time: 1919.0140s
	iters: 300, epoch: 5 | loss: 0.0178247
	speed: 0.1613s/iter; left time: 1918.2434s
	iters: 400, epoch: 5 | loss: 0.0021644
	speed: 0.1777s/iter; left time: 2096.1084s
Epoch: 5 cost time: 79.24550867080688
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0096274
	speed: 0.6537s/iter; left time: 7600.4264s
	iters: 200, epoch: 6 | loss: 0.0122626
	speed: 0.1883s/iter; left time: 2169.7713s
	iters: 300, epoch: 6 | loss: 0.0097597
	speed: 0.1879s/iter; left time: 2147.4264s
	iters: 400, epoch: 6 | loss: 0.0048412
	speed: 0.1886s/iter; left time: 2135.7536s
Epoch: 6 cost time: 88.93781971931458
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.971983 --> -0.975699).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0010192
	speed: 0.6298s/iter; left time: 7026.9981s
	iters: 200, epoch: 7 | loss: 0.0347283
	speed: 0.1594s/iter; left time: 1762.3190s
	iters: 300, epoch: 7 | loss: 0.0003734
	speed: 0.1614s/iter; left time: 1768.2518s
	iters: 400, epoch: 7 | loss: 0.0279838
	speed: 0.1612s/iter; left time: 1750.1959s
Epoch: 7 cost time: 75.30807209014893
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0155720
	speed: 0.5431s/iter; left time: 5804.2189s
	iters: 200, epoch: 8 | loss: 0.0011780
	speed: 0.1611s/iter; left time: 1705.8621s
	iters: 300, epoch: 8 | loss: 0.1539431
	speed: 0.1625s/iter; left time: 1703.8845s
	iters: 400, epoch: 8 | loss: 0.2071129
	speed: 0.1559s/iter; left time: 1619.6114s
Epoch: 8 cost time: 74.47684526443481
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0007710
	speed: 0.5934s/iter; left time: 6064.3955s
	iters: 200, epoch: 9 | loss: 0.0063693
	speed: 0.1818s/iter; left time: 1839.4490s
	iters: 300, epoch: 9 | loss: 0.0006556
	speed: 0.1808s/iter; left time: 1811.6037s
	iters: 400, epoch: 9 | loss: 0.0041364
	speed: 0.1814s/iter; left time: 1798.8572s
Epoch: 9 cost time: 85.2669768333435
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977701).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001879
	speed: 0.6317s/iter; left time: 6159.2239s
	iters: 200, epoch: 10 | loss: 0.0146483
	speed: 0.1740s/iter; left time: 1679.0293s
	iters: 300, epoch: 10 | loss: 0.0121644
	speed: 0.1545s/iter; left time: 1475.6049s
	iters: 400, epoch: 10 | loss: 0.0006981
	speed: 0.1528s/iter; left time: 1443.5034s
Epoch: 10 cost time: 77.19730496406555
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1614178
	speed: 0.5229s/iter; left time: 4852.9542s
	iters: 200, epoch: 11 | loss: 0.0255436
	speed: 0.1517s/iter; left time: 1393.1620s
	iters: 300, epoch: 11 | loss: 0.0001410
	speed: 0.1540s/iter; left time: 1398.0997s
	iters: 400, epoch: 11 | loss: 0.0025552
	speed: 0.1539s/iter; left time: 1382.3334s
Epoch: 11 cost time: 72.54670023918152
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0005051
	speed: 0.5402s/iter; left time: 4759.9492s
	iters: 200, epoch: 12 | loss: 0.0008698
	speed: 0.1951s/iter; left time: 1700.0178s
	iters: 300, epoch: 12 | loss: 0.0003901
	speed: 0.1994s/iter; left time: 1716.9941s
	iters: 400, epoch: 12 | loss: 0.0001274
	speed: 0.1956s/iter; left time: 1664.6816s
Epoch: 12 cost time: 90.24310421943665
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0013248
	speed: 0.6858s/iter; left time: 5721.5085s
	iters: 200, epoch: 13 | loss: 0.0018417
	speed: 0.2000s/iter; left time: 1648.5991s
	iters: 300, epoch: 13 | loss: 0.0018513
	speed: 0.1967s/iter; left time: 1602.0757s
	iters: 400, epoch: 13 | loss: 0.0011290
	speed: 0.1910s/iter; left time: 1535.9130s
Epoch: 13 cost time: 90.83511447906494
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0005147
	speed: 0.5746s/iter; left time: 4524.1871s
	iters: 200, epoch: 14 | loss: 0.0009796
	speed: 0.1661s/iter; left time: 1291.3660s
	iters: 300, epoch: 14 | loss: 0.0008839
	speed: 0.1715s/iter; left time: 1316.3357s
	iters: 400, epoch: 14 | loss: 0.0001160
	speed: 0.1680s/iter; left time: 1272.6779s
Epoch: 14 cost time: 79.2158465385437
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0166542
	speed: 0.5717s/iter; left time: 4233.2442s
	iters: 200, epoch: 15 | loss: 0.0414687
	speed: 0.1593s/iter; left time: 1163.7486s
	iters: 300, epoch: 15 | loss: 0.0085609
	speed: 0.1721s/iter; left time: 1239.9741s
	iters: 400, epoch: 15 | loss: 0.0005088
	speed: 0.1863s/iter; left time: 1323.6899s
Epoch: 15 cost time: 82.10615730285645
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0003311
	speed: 0.6495s/iter; left time: 4504.8165s
	iters: 200, epoch: 16 | loss: 0.0270809
	speed: 0.1893s/iter; left time: 1294.2227s
	iters: 300, epoch: 16 | loss: 0.1351328
	speed: 0.1892s/iter; left time: 1274.7500s
	iters: 400, epoch: 16 | loss: 0.0012925
	speed: 0.1878s/iter; left time: 1245.9793s
Epoch: 16 cost time: 88.38933205604553
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.977701 --> -0.978272).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0048147
	speed: 0.6032s/iter; left time: 3900.7350s
	iters: 200, epoch: 17 | loss: 0.0007325
	speed: 0.1590s/iter; left time: 1012.2293s
	iters: 300, epoch: 17 | loss: 0.0274821
	speed: 0.1616s/iter; left time: 1012.4517s
	iters: 400, epoch: 17 | loss: 0.0003490
	speed: 0.1600s/iter; left time: 986.6759s
Epoch: 17 cost time: 75.21013283729553
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0094266
	speed: 0.5406s/iter; left time: 3242.3710s
	iters: 200, epoch: 18 | loss: 0.0000746
	speed: 0.1618s/iter; left time: 954.1544s
	iters: 300, epoch: 18 | loss: 0.0005135
	speed: 0.1606s/iter; left time: 931.3768s
	iters: 400, epoch: 18 | loss: 0.0003644
	speed: 0.1580s/iter; left time: 900.2481s
Epoch: 18 cost time: 76.05013298988342
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0017206
	speed: 0.6380s/iter; left time: 3527.4290s
	iters: 200, epoch: 19 | loss: 0.0026847
	speed: 0.1809s/iter; left time: 982.0265s
	iters: 300, epoch: 19 | loss: 0.0004678
	speed: 0.1931s/iter; left time: 1029.1841s
	iters: 400, epoch: 19 | loss: 0.0007938
	speed: 0.1937s/iter; left time: 1012.6409s
Epoch: 19 cost time: 88.89515233039856
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0009225
	speed: 0.6646s/iter; left time: 3362.9088s
	iters: 200, epoch: 20 | loss: 0.0000974
	speed: 0.1656s/iter; left time: 821.4882s
	iters: 300, epoch: 20 | loss: 0.0002350
	speed: 0.1647s/iter; left time: 800.3395s
	iters: 400, epoch: 20 | loss: 0.0008607
	speed: 0.1655s/iter; left time: 787.7105s
Epoch: 20 cost time: 80.29536557197571
Epoch: 20, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0025597
	speed: 0.5574s/iter; left time: 2558.9842s
	iters: 200, epoch: 21 | loss: 0.0009474
	speed: 0.1651s/iter; left time: 741.6156s
	iters: 300, epoch: 21 | loss: 0.0004586
	speed: 0.1647s/iter; left time: 722.9934s
	iters: 400, epoch: 21 | loss: 0.0002585
	speed: 0.1665s/iter; left time: 714.5933s
Epoch: 21 cost time: 77.21985983848572
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0002263
	speed: 0.5937s/iter; left time: 2447.0951s
	iters: 200, epoch: 22 | loss: 0.0003493
	speed: 0.1924s/iter; left time: 774.0001s
	iters: 300, epoch: 22 | loss: 0.0016237
	speed: 0.1942s/iter; left time: 761.6794s
	iters: 400, epoch: 22 | loss: 0.0001918
	speed: 0.1948s/iter; left time: 744.7060s
Epoch: 22 cost time: 90.90754342079163
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0012449
	speed: 0.6678s/iter; left time: 2439.6042s
	iters: 200, epoch: 23 | loss: 0.0001028
	speed: 0.1913s/iter; left time: 679.6039s
	iters: 300, epoch: 23 | loss: 0.0103784
	speed: 0.1917s/iter; left time: 662.0868s
	iters: 400, epoch: 23 | loss: 0.0002487
	speed: 0.1745s/iter; left time: 585.0654s
Epoch: 23 cost time: 87.13990068435669
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0009318
	speed: 0.5525s/iter; left time: 1759.0173s
	iters: 200, epoch: 24 | loss: 0.0010716
	speed: 0.1553s/iter; left time: 478.8148s
	iters: 300, epoch: 24 | loss: 0.0005133
	speed: 0.1559s/iter; left time: 465.1093s
	iters: 400, epoch: 24 | loss: 0.0001717
	speed: 0.1575s/iter; left time: 454.2730s
Epoch: 24 cost time: 73.6632285118103
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.978272 --> -0.983132).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0036494
	speed: 0.5370s/iter; left time: 1457.9188s
	iters: 200, epoch: 25 | loss: 0.0001225
	speed: 0.1609s/iter; left time: 420.7165s
	iters: 300, epoch: 25 | loss: 0.0002143
	speed: 0.1855s/iter; left time: 466.6181s
	iters: 400, epoch: 25 | loss: 0.0005297
	speed: 0.1854s/iter; left time: 447.7867s
Epoch: 25 cost time: 81.73305320739746
Epoch: 25, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
Validation loss decreased (-0.983132 --> -0.984276).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0001676
	speed: 0.6437s/iter; left time: 1445.7815s
	iters: 200, epoch: 26 | loss: 0.0000378
	speed: 0.1857s/iter; left time: 398.4104s
	iters: 300, epoch: 26 | loss: 0.0000962
	speed: 0.1843s/iter; left time: 376.9917s
	iters: 400, epoch: 26 | loss: 0.0000557
	speed: 0.1838s/iter; left time: 357.6894s
Epoch: 26 cost time: 87.01356291770935
Epoch: 26, Steps: 469 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.984276 --> -0.985134).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000503
	speed: 0.5767s/iter; left time: 1024.7936s
	iters: 200, epoch: 27 | loss: 0.0011817
	speed: 0.1573s/iter; left time: 263.7711s
	iters: 300, epoch: 27 | loss: 0.0005323
	speed: 0.1575s/iter; left time: 248.3582s
	iters: 400, epoch: 27 | loss: 0.0019897
	speed: 0.1585s/iter; left time: 234.0831s
Epoch: 27 cost time: 73.75165462493896
Epoch: 27, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0001275
	speed: 0.5196s/iter; left time: 679.6634s
	iters: 200, epoch: 28 | loss: 0.0011183
	speed: 0.1557s/iter; left time: 188.0876s
	iters: 300, epoch: 28 | loss: 0.0009802
	speed: 0.1551s/iter; left time: 171.8234s
	iters: 400, epoch: 28 | loss: 0.0086368
	speed: 0.1586s/iter; left time: 159.8268s
Epoch: 28 cost time: 75.68304061889648
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0004770
	speed: 0.6387s/iter; left time: 535.8450s
	iters: 200, epoch: 29 | loss: 0.0005253
	speed: 0.1843s/iter; left time: 136.1989s
	iters: 300, epoch: 29 | loss: 0.0025000
	speed: 0.1845s/iter; left time: 117.9188s
	iters: 400, epoch: 29 | loss: 0.0231990
	speed: 0.1844s/iter; left time: 99.4169s
Epoch: 29 cost time: 86.58565258979797
Epoch: 29, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0010033
	speed: 0.6272s/iter; left time: 232.0518s
	iters: 200, epoch: 30 | loss: 0.0029335
	speed: 0.1564s/iter; left time: 42.2312s
	iters: 300, epoch: 30 | loss: 0.0001119
	speed: 0.1552s/iter; left time: 26.3782s
	iters: 400, epoch: 30 | loss: 0.0000975
	speed: 0.1583s/iter; left time: 11.0829s
Epoch: 30 cost time: 75.52198266983032
Epoch: 30, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 18753034
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4679082
	speed: 0.0722s/iter; left time: 1008.6236s
	iters: 200, epoch: 1 | loss: 0.0920355
	speed: 0.0595s/iter; left time: 825.0651s
	iters: 300, epoch: 1 | loss: 0.2718889
	speed: 0.0561s/iter; left time: 772.3379s
	iters: 400, epoch: 1 | loss: 0.0326148
	speed: 0.0591s/iter; left time: 807.4150s
Epoch: 1 cost time: 28.801799535751343
Epoch: 1, Steps: 469 | Train Loss: 0.444 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
Validation loss decreased (inf --> -0.966551).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0161058
	speed: 0.2326s/iter; left time: 3140.2528s
	iters: 200, epoch: 2 | loss: 0.2574456
	speed: 0.0689s/iter; left time: 922.7705s
	iters: 300, epoch: 2 | loss: 0.0421216
	speed: 0.0656s/iter; left time: 872.9905s
	iters: 400, epoch: 2 | loss: 0.0217632
	speed: 0.0665s/iter; left time: 878.4756s
Epoch: 2 cost time: 31.466648817062378
Epoch: 2, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.966551 --> -0.970268).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0059021
	speed: 0.2654s/iter; left time: 3458.5417s
	iters: 200, epoch: 3 | loss: 0.0065048
	speed: 0.0679s/iter; left time: 878.2598s
	iters: 300, epoch: 3 | loss: 0.0309363
	speed: 0.0662s/iter; left time: 849.4006s
	iters: 400, epoch: 3 | loss: 0.0020160
	speed: 0.0664s/iter; left time: 845.0823s
Epoch: 3 cost time: 31.58014726638794
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0053695
	speed: 0.2619s/iter; left time: 3291.1271s
	iters: 200, epoch: 4 | loss: 0.0039072
	speed: 0.0670s/iter; left time: 834.9047s
	iters: 300, epoch: 4 | loss: 0.0465828
	speed: 0.0687s/iter; left time: 849.2400s
	iters: 400, epoch: 4 | loss: 0.0009111
	speed: 0.0663s/iter; left time: 812.6231s
Epoch: 4 cost time: 31.78639531135559
Epoch: 4, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3507540
	speed: 0.2417s/iter; left time: 2922.9875s
	iters: 200, epoch: 5 | loss: 0.3235897
	speed: 0.0564s/iter; left time: 677.0311s
	iters: 300, epoch: 5 | loss: 0.0018532
	speed: 0.0564s/iter; left time: 671.3684s
	iters: 400, epoch: 5 | loss: 0.1281023
	speed: 0.0546s/iter; left time: 644.3417s
Epoch: 5 cost time: 26.58821702003479
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0025945
	speed: 0.2243s/iter; left time: 2607.8983s
	iters: 200, epoch: 6 | loss: 0.0036010
	speed: 0.0551s/iter; left time: 634.5481s
	iters: 300, epoch: 6 | loss: 0.0006910
	speed: 0.0560s/iter; left time: 639.6255s
	iters: 400, epoch: 6 | loss: 0.0008533
	speed: 0.0547s/iter; left time: 619.5117s
Epoch: 6 cost time: 25.91684126853943
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975699).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005241
	speed: 0.2239s/iter; left time: 2498.1746s
	iters: 200, epoch: 7 | loss: 0.0039736
	speed: 0.0552s/iter; left time: 610.4102s
	iters: 300, epoch: 7 | loss: 0.0143868
	speed: 0.0569s/iter; left time: 623.0978s
	iters: 400, epoch: 7 | loss: 0.0046911
	speed: 0.0565s/iter; left time: 613.6626s
Epoch: 7 cost time: 26.652987003326416
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0022678
	speed: 0.2234s/iter; left time: 2387.9405s
	iters: 200, epoch: 8 | loss: 0.0250411
	speed: 0.0484s/iter; left time: 512.3507s
	iters: 300, epoch: 8 | loss: 0.0018854
	speed: 0.0581s/iter; left time: 608.9076s
	iters: 400, epoch: 8 | loss: 0.0432200
	speed: 0.0604s/iter; left time: 627.2469s
Epoch: 8 cost time: 26.603663444519043
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0027158
	speed: 0.2244s/iter; left time: 2293.1281s
	iters: 200, epoch: 9 | loss: 0.0516279
	speed: 0.0676s/iter; left time: 683.8879s
	iters: 300, epoch: 9 | loss: 0.0006608
	speed: 0.0636s/iter; left time: 637.1111s
	iters: 400, epoch: 9 | loss: 0.5528236
	speed: 0.0626s/iter; left time: 620.7984s
Epoch: 9 cost time: 29.786171913146973
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.978558).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0512792
	speed: 0.1750s/iter; left time: 1706.0583s
	iters: 200, epoch: 10 | loss: 0.0005012
	speed: 0.0476s/iter; left time: 459.0041s
	iters: 300, epoch: 10 | loss: 0.0026441
	speed: 0.0596s/iter; left time: 569.2540s
	iters: 400, epoch: 10 | loss: 0.0021053
	speed: 0.0569s/iter; left time: 538.1000s
Epoch: 10 cost time: 25.11025047302246
Epoch: 10, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0987009
	speed: 0.2183s/iter; left time: 2025.6962s
	iters: 200, epoch: 11 | loss: 0.0011736
	speed: 0.0588s/iter; left time: 540.2408s
	iters: 300, epoch: 11 | loss: 0.0003486
	speed: 0.0606s/iter; left time: 550.4734s
	iters: 400, epoch: 11 | loss: 0.0003697
	speed: 0.0573s/iter; left time: 514.5836s
Epoch: 11 cost time: 27.71222448348999
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0093937
	speed: 0.2160s/iter; left time: 1903.2125s
	iters: 200, epoch: 12 | loss: 0.0424428
	speed: 0.0574s/iter; left time: 500.2190s
	iters: 300, epoch: 12 | loss: 0.0009535
	speed: 0.0619s/iter; left time: 533.0613s
	iters: 400, epoch: 12 | loss: 0.0006759
	speed: 0.0553s/iter; left time: 471.0779s
Epoch: 12 cost time: 26.85012698173523
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0004794
	speed: 0.1923s/iter; left time: 1604.3784s
	iters: 200, epoch: 13 | loss: 0.0002348
	speed: 0.0480s/iter; left time: 395.4394s
	iters: 300, epoch: 13 | loss: 0.0002664
	speed: 0.0502s/iter; left time: 409.0093s
	iters: 400, epoch: 13 | loss: 0.3342538
	speed: 0.0513s/iter; left time: 412.9326s
Epoch: 13 cost time: 23.879376888275146
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000803
	speed: 0.1959s/iter; left time: 1542.8424s
	iters: 200, epoch: 14 | loss: 0.0002744
	speed: 0.0495s/iter; left time: 384.7872s
	iters: 300, epoch: 14 | loss: 0.0007400
	speed: 0.0478s/iter; left time: 366.8014s
	iters: 400, epoch: 14 | loss: 0.0004650
	speed: 0.0528s/iter; left time: 399.5292s
Epoch: 14 cost time: 24.71772527694702
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979988).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000709
	speed: 0.2094s/iter; left time: 1550.7139s
	iters: 200, epoch: 15 | loss: 0.0000803
	speed: 0.0584s/iter; left time: 426.8598s
	iters: 300, epoch: 15 | loss: 0.0053755
	speed: 0.0558s/iter; left time: 402.3906s
	iters: 400, epoch: 15 | loss: 0.0359351
	speed: 0.0596s/iter; left time: 423.5315s
Epoch: 15 cost time: 28.127574920654297
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001535
	speed: 0.2268s/iter; left time: 1573.2808s
	iters: 200, epoch: 16 | loss: 0.0093450
	speed: 0.0587s/iter; left time: 401.5642s
	iters: 300, epoch: 16 | loss: 0.0035862
	speed: 0.0573s/iter; left time: 385.7322s
	iters: 400, epoch: 16 | loss: 0.0002938
	speed: 0.0599s/iter; left time: 397.4377s
Epoch: 16 cost time: 28.51285457611084
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0003690
	speed: 0.2277s/iter; left time: 1472.7277s
	iters: 200, epoch: 17 | loss: 0.0003737
	speed: 0.0535s/iter; left time: 340.7799s
	iters: 300, epoch: 17 | loss: 0.0001446
	speed: 0.0489s/iter; left time: 306.5935s
	iters: 400, epoch: 17 | loss: 0.0008310
	speed: 0.0500s/iter; left time: 308.2935s
Epoch: 17 cost time: 25.33203911781311
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0019125
	speed: 0.1717s/iter; left time: 1030.0440s
	iters: 200, epoch: 18 | loss: 0.0031916
	speed: 0.0491s/iter; left time: 289.8217s
	iters: 300, epoch: 18 | loss: 0.0001276
	speed: 0.0452s/iter; left time: 262.0146s
	iters: 400, epoch: 18 | loss: 0.0006136
	speed: 0.0437s/iter; left time: 248.7920s
Epoch: 18 cost time: 22.497264623641968
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0054627
	speed: 0.1831s/iter; left time: 1012.2657s
	iters: 200, epoch: 19 | loss: 0.0000448
	speed: 0.0497s/iter; left time: 269.8175s
	iters: 300, epoch: 19 | loss: 0.0013601
	speed: 0.0458s/iter; left time: 243.8524s
	iters: 400, epoch: 19 | loss: 0.0004302
	speed: 0.0461s/iter; left time: 241.0929s
Epoch: 19 cost time: 22.9830424785614
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0101211
	speed: 0.2053s/iter; left time: 1038.6263s
	iters: 200, epoch: 20 | loss: 0.0019360
	speed: 0.0570s/iter; left time: 282.7278s
	iters: 300, epoch: 20 | loss: 0.0004904
	speed: 0.0550s/iter; left time: 267.2874s
	iters: 400, epoch: 20 | loss: 0.0000220
	speed: 0.0567s/iter; left time: 270.1287s
Epoch: 20 cost time: 26.991508722305298
Epoch: 20, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0001189
	speed: 0.2111s/iter; left time: 969.1554s
	iters: 200, epoch: 21 | loss: 0.0006374
	speed: 0.0536s/iter; left time: 240.7664s
	iters: 300, epoch: 21 | loss: 0.0029414
	speed: 0.0540s/iter; left time: 237.2689s
	iters: 400, epoch: 21 | loss: 0.0006820
	speed: 0.0575s/iter; left time: 246.7274s
Epoch: 21 cost time: 26.380862951278687
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0001771
	speed: 0.1913s/iter; left time: 788.4886s
	iters: 200, epoch: 22 | loss: 0.0019399
	speed: 0.0462s/iter; left time: 185.7433s
	iters: 300, epoch: 22 | loss: 0.0002866
	speed: 0.0470s/iter; left time: 184.3467s
	iters: 400, epoch: 22 | loss: 0.0008712
	speed: 0.0498s/iter; left time: 190.3892s
Epoch: 22 cost time: 22.692020416259766
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0004176
	speed: 0.1787s/iter; left time: 652.7420s
	iters: 200, epoch: 23 | loss: 0.0001013
	speed: 0.0456s/iter; left time: 162.1105s
	iters: 300, epoch: 23 | loss: 0.0003085
	speed: 0.0480s/iter; left time: 165.8372s
	iters: 400, epoch: 23 | loss: 0.0011583
	speed: 0.0491s/iter; left time: 164.5928s
Epoch: 23 cost time: 22.460195064544678
Epoch: 23, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0001738
	speed: 0.1811s/iter; left time: 576.6964s
	iters: 200, epoch: 24 | loss: 0.0082962
	speed: 0.0459s/iter; left time: 141.7067s
	iters: 300, epoch: 24 | loss: 0.0004266
	speed: 0.0505s/iter; left time: 150.7762s
	iters: 400, epoch: 24 | loss: 0.0000132
	speed: 0.0560s/iter; left time: 161.4282s
Epoch: 24 cost time: 24.11483120918274
Epoch: 24, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 5513482
model size : 22.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5383858
	speed: 0.1215s/iter; left time: 1696.9561s
	iters: 200, epoch: 1 | loss: 0.0991033
	speed: 0.1118s/iter; left time: 1550.7259s
	iters: 300, epoch: 1 | loss: 0.0596117
	speed: 0.1126s/iter; left time: 1550.4091s
	iters: 400, epoch: 1 | loss: 0.2017739
	speed: 0.1127s/iter; left time: 1540.3882s
Epoch: 1 cost time: 53.53352689743042
Epoch: 1, Steps: 469 | Train Loss: 0.432 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
Validation loss decreased (inf --> -0.965693).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0164206
	speed: 0.3489s/iter; left time: 4710.7944s
	iters: 200, epoch: 2 | loss: 0.0458487
	speed: 0.0971s/iter; left time: 1301.9890s
	iters: 300, epoch: 2 | loss: 0.0712430
	speed: 0.0982s/iter; left time: 1306.2872s
	iters: 400, epoch: 2 | loss: 0.3792668
	speed: 0.0965s/iter; left time: 1273.9768s
Epoch: 2 cost time: 46.23603534698486
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0290599
	speed: 0.3385s/iter; left time: 4411.3540s
	iters: 200, epoch: 3 | loss: 0.0440543
	speed: 0.1003s/iter; left time: 1297.6440s
	iters: 300, epoch: 3 | loss: 0.0018617
	speed: 0.0952s/iter; left time: 1222.1656s
	iters: 400, epoch: 3 | loss: 0.0084493
	speed: 0.1078s/iter; left time: 1372.5446s
Epoch: 3 cost time: 47.9592809677124
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.969124).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0036191
	speed: 0.4041s/iter; left time: 5077.6704s
	iters: 200, epoch: 4 | loss: 0.0042442
	speed: 0.1145s/iter; left time: 1427.3491s
	iters: 300, epoch: 4 | loss: 0.1346825
	speed: 0.1125s/iter; left time: 1391.1712s
	iters: 400, epoch: 4 | loss: 0.0097423
	speed: 0.1154s/iter; left time: 1414.6777s
Epoch: 4 cost time: 53.65189552307129
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0018330
	speed: 0.3647s/iter; left time: 4410.6823s
	iters: 200, epoch: 5 | loss: 0.0011760
	speed: 0.0975s/iter; left time: 1169.4842s
	iters: 300, epoch: 5 | loss: 0.0196460
	speed: 0.0991s/iter; left time: 1178.5805s
	iters: 400, epoch: 5 | loss: 0.0028829
	speed: 0.0976s/iter; left time: 1150.8742s
Epoch: 5 cost time: 46.379061698913574
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.955 Test Loss: 0.138 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0251176
	speed: 0.3415s/iter; left time: 3969.7605s
	iters: 200, epoch: 6 | loss: 0.0072876
	speed: 0.0981s/iter; left time: 1131.2027s
	iters: 300, epoch: 6 | loss: 0.0022613
	speed: 0.0967s/iter; left time: 1105.0333s
	iters: 400, epoch: 6 | loss: 0.0015889
	speed: 0.0987s/iter; left time: 1117.6865s
Epoch: 6 cost time: 46.14811968803406
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0009301
	speed: 0.3562s/iter; left time: 3974.0616s
	iters: 200, epoch: 7 | loss: 0.0024369
	speed: 0.1034s/iter; left time: 1143.6335s
	iters: 300, epoch: 7 | loss: 0.0013953
	speed: 0.1059s/iter; left time: 1159.9687s
	iters: 400, epoch: 7 | loss: 0.0098912
	speed: 0.1049s/iter; left time: 1138.9878s
Epoch: 7 cost time: 49.95361518859863
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969124 --> -0.972554).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004889
	speed: 0.3796s/iter; left time: 4057.6394s
	iters: 200, epoch: 8 | loss: 0.0128061
	speed: 0.0915s/iter; left time: 969.0194s
	iters: 300, epoch: 8 | loss: 0.1088469
	speed: 0.0940s/iter; left time: 985.3919s
	iters: 400, epoch: 8 | loss: 0.0088357
	speed: 0.0917s/iter; left time: 953.0095s
Epoch: 8 cost time: 45.24644207954407
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.972554 --> -0.974556).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0013675
	speed: 0.3372s/iter; left time: 3445.3996s
	iters: 200, epoch: 9 | loss: 0.0092938
	speed: 0.0906s/iter; left time: 916.9019s
	iters: 300, epoch: 9 | loss: 0.0015711
	speed: 0.0950s/iter; left time: 951.8555s
	iters: 400, epoch: 9 | loss: 0.0011255
	speed: 0.0913s/iter; left time: 905.6465s
Epoch: 9 cost time: 44.24048924446106
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.974556 --> -0.978272).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0027529
	speed: 0.3538s/iter; left time: 3449.1761s
	iters: 200, epoch: 10 | loss: 0.0041090
	speed: 0.1049s/iter; left time: 1012.4678s
	iters: 300, epoch: 10 | loss: 0.0499665
	speed: 0.1006s/iter; left time: 960.4383s
	iters: 400, epoch: 10 | loss: 0.0012862
	speed: 0.1015s/iter; left time: 959.3098s
Epoch: 10 cost time: 49.15986680984497
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0008734
	speed: 0.3821s/iter; left time: 3546.3106s
	iters: 200, epoch: 11 | loss: 0.0029929
	speed: 0.1020s/iter; left time: 936.6081s
	iters: 300, epoch: 11 | loss: 0.0111748
	speed: 0.0930s/iter; left time: 844.3191s
	iters: 400, epoch: 11 | loss: 0.0008542
	speed: 0.0916s/iter; left time: 822.4760s
Epoch: 11 cost time: 46.44504952430725
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0007273
	speed: 0.3271s/iter; left time: 2882.5054s
	iters: 200, epoch: 12 | loss: 0.0409128
	speed: 0.0894s/iter; left time: 778.4822s
	iters: 300, epoch: 12 | loss: 0.0004251
	speed: 0.0959s/iter; left time: 825.8040s
	iters: 400, epoch: 12 | loss: 0.0001798
	speed: 0.0920s/iter; left time: 782.8568s
Epoch: 12 cost time: 44.23318552970886
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0007216
	speed: 0.3378s/iter; left time: 2818.1338s
	iters: 200, epoch: 13 | loss: 0.0001444
	speed: 0.1055s/iter; left time: 869.3720s
	iters: 300, epoch: 13 | loss: 0.0010255
	speed: 0.1092s/iter; left time: 889.5590s
	iters: 400, epoch: 13 | loss: 0.1419131
	speed: 0.1085s/iter; left time: 872.3755s
Epoch: 13 cost time: 49.82365107536316
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001709
	speed: 0.3759s/iter; left time: 2959.6948s
	iters: 200, epoch: 14 | loss: 0.0008147
	speed: 0.1074s/iter; left time: 834.9783s
	iters: 300, epoch: 14 | loss: 0.0005896
	speed: 0.1060s/iter; left time: 813.6080s
	iters: 400, epoch: 14 | loss: 0.0007604
	speed: 0.1009s/iter; left time: 764.2247s
Epoch: 14 cost time: 48.965397119522095
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0203129
	speed: 0.3256s/iter; left time: 2410.8084s
	iters: 200, epoch: 15 | loss: 0.0112827
	speed: 0.0940s/iter; left time: 687.0010s
	iters: 300, epoch: 15 | loss: 0.0001187
	speed: 0.0906s/iter; left time: 652.6305s
	iters: 400, epoch: 15 | loss: 0.0018151
	speed: 0.0957s/iter; left time: 679.6173s
Epoch: 15 cost time: 44.034290075302124
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0056895
	speed: 0.3256s/iter; left time: 2258.5550s
	iters: 200, epoch: 16 | loss: 0.0003392
	speed: 0.0966s/iter; left time: 660.4422s
	iters: 300, epoch: 16 | loss: 0.0032387
	speed: 0.0985s/iter; left time: 663.6579s
	iters: 400, epoch: 16 | loss: 0.0057868
	speed: 0.1081s/iter; left time: 717.6822s
Epoch: 16 cost time: 47.18609166145325
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0001635
	speed: 0.3750s/iter; left time: 2425.2957s
	iters: 200, epoch: 17 | loss: 0.0001660
	speed: 0.1100s/iter; left time: 700.0952s
	iters: 300, epoch: 17 | loss: 0.0021748
	speed: 0.1081s/iter; left time: 677.1932s
	iters: 400, epoch: 17 | loss: 0.0000711
	speed: 0.1075s/iter; left time: 662.8324s
Epoch: 17 cost time: 50.94309687614441
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000889
	speed: 0.3294s/iter; left time: 1975.9976s
	iters: 200, epoch: 18 | loss: 0.0044998
	speed: 0.0894s/iter; left time: 527.4051s
	iters: 300, epoch: 18 | loss: 0.0029661
	speed: 0.0905s/iter; left time: 524.8279s
	iters: 400, epoch: 18 | loss: 0.0024145
	speed: 0.0885s/iter; left time: 504.4323s
Epoch: 18 cost time: 42.299129009246826
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001914
	speed: 0.3183s/iter; left time: 1759.6157s
	iters: 200, epoch: 19 | loss: 0.0001069
	speed: 0.0879s/iter; left time: 477.2364s
	iters: 300, epoch: 19 | loss: 0.0004247
	speed: 0.0912s/iter; left time: 485.9308s
	iters: 400, epoch: 19 | loss: 0.0001931
	speed: 0.0874s/iter; left time: 456.8352s
Epoch: 19 cost time: 43.38027358055115
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0008176
	speed: 0.3653s/iter; left time: 1848.3110s
	iters: 200, epoch: 20 | loss: 0.0000862
	speed: 0.1037s/iter; left time: 514.1831s
	iters: 300, epoch: 20 | loss: 0.0221857
	speed: 0.1021s/iter; left time: 496.3918s
	iters: 400, epoch: 20 | loss: 0.1056656
	speed: 0.1033s/iter; left time: 491.5111s
Epoch: 20 cost time: 48.83867573738098
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0004887
	speed: 0.3459s/iter; left time: 1588.0972s
	iters: 200, epoch: 21 | loss: 0.0004452
	speed: 0.0913s/iter; left time: 409.9013s
	iters: 300, epoch: 21 | loss: 0.0918796
	speed: 0.0889s/iter; left time: 390.1979s
	iters: 400, epoch: 21 | loss: 0.0022246
	speed: 0.0896s/iter; left time: 384.4221s
Epoch: 21 cost time: 42.41836357116699
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0370827
	speed: 0.3163s/iter; left time: 1303.7130s
	iters: 200, epoch: 22 | loss: 0.0006186
	speed: 0.0891s/iter; left time: 358.3943s
	iters: 300, epoch: 22 | loss: 0.0018612
	speed: 0.0918s/iter; left time: 359.9963s
	iters: 400, epoch: 22 | loss: 0.0003294
	speed: 0.0887s/iter; left time: 339.0619s
Epoch: 22 cost time: 42.777485847473145
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 18753034
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5160121
	speed: 0.0529s/iter; left time: 738.9246s
	iters: 200, epoch: 1 | loss: 0.1180928
	speed: 0.0387s/iter; left time: 536.4481s
	iters: 300, epoch: 1 | loss: 0.3349528
	speed: 0.0363s/iter; left time: 500.5215s
	iters: 400, epoch: 1 | loss: 0.0327370
	speed: 0.0381s/iter; left time: 520.3614s
Epoch: 1 cost time: 19.294355154037476
Epoch: 1, Steps: 469 | Train Loss: 0.454 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (inf --> -0.965408).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0360576
	speed: 0.1459s/iter; left time: 1969.2720s
	iters: 200, epoch: 2 | loss: 0.2584981
	speed: 0.0403s/iter; left time: 540.1712s
	iters: 300, epoch: 2 | loss: 0.0417732
	speed: 0.0404s/iter; left time: 537.8876s
	iters: 400, epoch: 2 | loss: 0.0195912
	speed: 0.0386s/iter; left time: 509.8956s
Epoch: 2 cost time: 18.779654502868652
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.965408 --> -0.969410).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0050269
	speed: 0.1393s/iter; left time: 1816.1056s
	iters: 200, epoch: 3 | loss: 0.0979137
	speed: 0.0341s/iter; left time: 441.1529s
	iters: 300, epoch: 3 | loss: 0.0036509
	speed: 0.0327s/iter; left time: 419.2013s
	iters: 400, epoch: 3 | loss: 0.0029314
	speed: 0.0370s/iter; left time: 470.5149s
Epoch: 3 cost time: 16.763227701187134
Epoch: 3, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0063897
	speed: 0.1315s/iter; left time: 1652.2658s
	iters: 200, epoch: 4 | loss: 0.1837304
	speed: 0.0342s/iter; left time: 426.2778s
	iters: 300, epoch: 4 | loss: 0.0413014
	speed: 0.0338s/iter; left time: 418.3487s
	iters: 400, epoch: 4 | loss: 0.0061359
	speed: 0.0415s/iter; left time: 508.9947s
Epoch: 4 cost time: 17.322804927825928
Epoch: 4, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0053782
	speed: 0.1479s/iter; left time: 1788.7937s
	iters: 200, epoch: 5 | loss: 0.5448171
	speed: 0.0372s/iter; left time: 446.5398s
	iters: 300, epoch: 5 | loss: 0.0005507
	speed: 0.0368s/iter; left time: 437.8441s
	iters: 400, epoch: 5 | loss: 0.0641242
	speed: 0.0358s/iter; left time: 422.3730s
Epoch: 5 cost time: 17.88822340965271
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0290544
	speed: 0.1589s/iter; left time: 1846.9657s
	iters: 200, epoch: 6 | loss: 0.0028418
	speed: 0.0433s/iter; left time: 498.9150s
	iters: 300, epoch: 6 | loss: 0.0079517
	speed: 0.0445s/iter; left time: 508.4479s
	iters: 400, epoch: 6 | loss: 0.0007492
	speed: 0.0414s/iter; left time: 468.4028s
Epoch: 6 cost time: 20.270174741744995
Epoch: 6, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.969410 --> -0.976843).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0463636
	speed: 0.1652s/iter; left time: 1842.5950s
	iters: 200, epoch: 7 | loss: 0.0027840
	speed: 0.0425s/iter; left time: 470.3620s
	iters: 300, epoch: 7 | loss: 0.0013191
	speed: 0.0416s/iter; left time: 455.3235s
	iters: 400, epoch: 7 | loss: 0.0830968
	speed: 0.0421s/iter; left time: 457.3762s
Epoch: 7 cost time: 20.286812782287598
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.980845).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0050516
	speed: 0.1609s/iter; left time: 1719.8302s
	iters: 200, epoch: 8 | loss: 0.0087425
	speed: 0.0419s/iter; left time: 443.6398s
	iters: 300, epoch: 8 | loss: 0.0003423
	speed: 0.0360s/iter; left time: 377.6823s
	iters: 400, epoch: 8 | loss: 0.3214769
	speed: 0.0380s/iter; left time: 394.3867s
Epoch: 8 cost time: 18.94125533103943
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0012119
	speed: 0.1509s/iter; left time: 1542.1310s
	iters: 200, epoch: 9 | loss: 0.0007804
	speed: 0.0391s/iter; left time: 395.7614s
	iters: 300, epoch: 9 | loss: 0.0017406
	speed: 0.0371s/iter; left time: 372.0569s
	iters: 400, epoch: 9 | loss: 0.0274664
	speed: 0.0353s/iter; left time: 349.8410s
Epoch: 9 cost time: 17.933534622192383
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0110614
	speed: 0.1441s/iter; left time: 1404.6532s
	iters: 200, epoch: 10 | loss: 0.0020200
	speed: 0.0370s/iter; left time: 356.6145s
	iters: 300, epoch: 10 | loss: 0.0025570
	speed: 0.0375s/iter; left time: 357.9449s
	iters: 400, epoch: 10 | loss: 0.0004774
	speed: 0.0374s/iter; left time: 353.8722s
Epoch: 10 cost time: 17.63682770729065
Epoch: 10, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0012403
	speed: 0.1471s/iter; left time: 1365.3430s
	iters: 200, epoch: 11 | loss: 0.0003788
	speed: 0.0412s/iter; left time: 378.0783s
	iters: 300, epoch: 11 | loss: 0.0003431
	speed: 0.0425s/iter; left time: 386.2220s
	iters: 400, epoch: 11 | loss: 0.0007146
	speed: 0.0429s/iter; left time: 385.5128s
Epoch: 11 cost time: 19.897775650024414
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0003586
	speed: 0.1662s/iter; left time: 1464.6865s
	iters: 200, epoch: 12 | loss: 0.0400808
	speed: 0.0429s/iter; left time: 373.5076s
	iters: 300, epoch: 12 | loss: 0.0000961
	speed: 0.0483s/iter; left time: 416.1108s
	iters: 400, epoch: 12 | loss: 0.0001796
	speed: 0.0475s/iter; left time: 404.6319s
Epoch: 12 cost time: 21.486037254333496
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0005767
	speed: 0.1617s/iter; left time: 1349.2547s
	iters: 200, epoch: 13 | loss: 0.0006920
	speed: 0.0400s/iter; left time: 329.8874s
	iters: 300, epoch: 13 | loss: 0.0002944
	speed: 0.0422s/iter; left time: 343.2376s
	iters: 400, epoch: 13 | loss: 0.0037385
	speed: 0.0419s/iter; left time: 336.6374s
Epoch: 13 cost time: 19.960862636566162
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0007142
	speed: 0.1515s/iter; left time: 1192.8737s
	iters: 200, epoch: 14 | loss: 0.0018797
	speed: 0.0375s/iter; left time: 291.7861s
	iters: 300, epoch: 14 | loss: 0.0011768
	speed: 0.0363s/iter; left time: 278.9449s
	iters: 400, epoch: 14 | loss: 0.0004020
	speed: 0.0380s/iter; left time: 287.7215s
Epoch: 14 cost time: 17.73280382156372
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.980845 --> -0.985420).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002171
	speed: 0.1489s/iter; left time: 1102.8892s
	iters: 200, epoch: 15 | loss: 0.0002027
	speed: 0.0375s/iter; left time: 274.0585s
	iters: 300, epoch: 15 | loss: 0.0008792
	speed: 0.0355s/iter; left time: 256.0155s
	iters: 400, epoch: 15 | loss: 0.0027264
	speed: 0.0365s/iter; left time: 259.2571s
Epoch: 15 cost time: 17.72368597984314
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0013864
	speed: 0.1462s/iter; left time: 1013.7801s
	iters: 200, epoch: 16 | loss: 0.0001526
	speed: 0.0388s/iter; left time: 265.2632s
	iters: 300, epoch: 16 | loss: 0.0007862
	speed: 0.0385s/iter; left time: 259.3476s
	iters: 400, epoch: 16 | loss: 0.0000472
	speed: 0.0344s/iter; left time: 228.1506s
Epoch: 16 cost time: 17.444424867630005
Epoch: 16, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0009245
	speed: 0.1534s/iter; left time: 991.7298s
	iters: 200, epoch: 17 | loss: 0.0051220
	speed: 0.0413s/iter; left time: 262.7923s
	iters: 300, epoch: 17 | loss: 0.0013611
	speed: 0.0421s/iter; left time: 263.7109s
	iters: 400, epoch: 17 | loss: 0.0002366
	speed: 0.0437s/iter; left time: 269.2374s
Epoch: 17 cost time: 20.338088274002075
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0017800
	speed: 0.1644s/iter; left time: 985.8634s
	iters: 200, epoch: 18 | loss: 0.0619543
	speed: 0.0417s/iter; left time: 245.9958s
	iters: 300, epoch: 18 | loss: 0.0014446
	speed: 0.0387s/iter; left time: 224.1651s
	iters: 400, epoch: 18 | loss: 0.0009970
	speed: 0.0383s/iter; left time: 218.4371s
Epoch: 18 cost time: 19.22898292541504
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0007677
	speed: 0.1628s/iter; left time: 900.0931s
	iters: 200, epoch: 19 | loss: 0.0000787
	speed: 0.0401s/iter; left time: 217.6319s
	iters: 300, epoch: 19 | loss: 0.0546607
	speed: 0.0430s/iter; left time: 229.1796s
	iters: 400, epoch: 19 | loss: 0.0001062
	speed: 0.0419s/iter; left time: 218.9342s
Epoch: 19 cost time: 19.836669921875
Epoch: 19, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001645
	speed: 0.1508s/iter; left time: 763.2491s
	iters: 200, epoch: 20 | loss: 0.0014663
	speed: 0.0363s/iter; left time: 180.2946s
	iters: 300, epoch: 20 | loss: 0.0012670
	speed: 0.0358s/iter; left time: 174.0985s
	iters: 400, epoch: 20 | loss: 0.0000327
	speed: 0.0382s/iter; left time: 182.0526s
Epoch: 20 cost time: 17.99118137359619
Epoch: 20, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0009332
	speed: 0.1491s/iter; left time: 684.3196s
	iters: 200, epoch: 21 | loss: 0.0457571
	speed: 0.0358s/iter; left time: 160.7622s
	iters: 300, epoch: 21 | loss: 0.0005547
	speed: 0.0370s/iter; left time: 162.6235s
	iters: 400, epoch: 21 | loss: 0.0005470
	speed: 0.0370s/iter; left time: 158.8725s
Epoch: 21 cost time: 17.428767919540405
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0002010
	speed: 0.1492s/iter; left time: 614.9131s
	iters: 200, epoch: 22 | loss: 0.0013347
	speed: 0.0361s/iter; left time: 145.1293s
	iters: 300, epoch: 22 | loss: 0.0001389
	speed: 0.0348s/iter; left time: 136.3632s
	iters: 400, epoch: 22 | loss: 0.0006652
	speed: 0.0366s/iter; left time: 140.0318s
Epoch: 22 cost time: 17.62134552001953
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0004013
	speed: 0.1561s/iter; left time: 570.3181s
	iters: 200, epoch: 23 | loss: 0.0011871
	speed: 0.0410s/iter; left time: 145.5988s
	iters: 300, epoch: 23 | loss: 0.0000596
	speed: 0.0363s/iter; left time: 125.2702s
	iters: 400, epoch: 23 | loss: 0.0003025
	speed: 0.0361s/iter; left time: 120.9790s
Epoch: 23 cost time: 18.555671453475952
Epoch: 23, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0004589
	speed: 0.1476s/iter; left time: 469.8231s
	iters: 200, epoch: 24 | loss: 0.0004965
	speed: 0.0383s/iter; left time: 118.0710s
	iters: 300, epoch: 24 | loss: 0.0000895
	speed: 0.0388s/iter; left time: 115.7367s
	iters: 400, epoch: 24 | loss: 0.0001236
	speed: 0.0387s/iter; left time: 111.4977s
Epoch: 24 cost time: 18.4936842918396
Epoch: 24, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 5513482
model size : 22.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8067559
	speed: 0.0655s/iter; left time: 915.6829s
	iters: 200, epoch: 1 | loss: 0.1714219
	speed: 0.0519s/iter; left time: 720.3426s
	iters: 300, epoch: 1 | loss: 0.1068923
	speed: 0.0542s/iter; left time: 746.4840s
	iters: 400, epoch: 1 | loss: 0.1844815
	speed: 0.0548s/iter; left time: 749.8226s
Epoch: 1 cost time: 26.38601779937744
Epoch: 1, Steps: 469 | Train Loss: 0.491 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
Validation loss decreased (inf --> -0.959690).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0202731
	speed: 0.1933s/iter; left time: 2609.9192s
	iters: 200, epoch: 2 | loss: 0.0671115
	speed: 0.0523s/iter; left time: 701.4428s
	iters: 300, epoch: 2 | loss: 0.0651036
	speed: 0.0543s/iter; left time: 721.7818s
	iters: 400, epoch: 2 | loss: 0.4072285
	speed: 0.0544s/iter; left time: 717.6663s
Epoch: 2 cost time: 25.25132727622986
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0135278
	speed: 0.1921s/iter; left time: 2503.3265s
	iters: 200, epoch: 3 | loss: 0.1059133
	speed: 0.0519s/iter; left time: 670.8175s
	iters: 300, epoch: 3 | loss: 0.0027294
	speed: 0.0551s/iter; left time: 707.5431s
	iters: 400, epoch: 3 | loss: 0.0018910
	speed: 0.0534s/iter; left time: 679.5176s
Epoch: 3 cost time: 25.150033235549927
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.953 Test Loss: 0.151 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0085448
	speed: 0.2082s/iter; left time: 2615.6495s
	iters: 200, epoch: 4 | loss: 0.0075763
	speed: 0.0607s/iter; left time: 756.7316s
	iters: 300, epoch: 4 | loss: 0.0343005
	speed: 0.0634s/iter; left time: 784.4355s
	iters: 400, epoch: 4 | loss: 0.1118927
	speed: 0.0611s/iter; left time: 749.0749s
Epoch: 4 cost time: 29.008007764816284
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.959690 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0042264
	speed: 0.2215s/iter; left time: 2678.4532s
	iters: 200, epoch: 5 | loss: 0.0014360
	speed: 0.0619s/iter; left time: 742.2495s
	iters: 300, epoch: 5 | loss: 0.0098681
	speed: 0.0621s/iter; left time: 738.0923s
	iters: 400, epoch: 5 | loss: 0.0108038
	speed: 0.0598s/iter; left time: 705.7446s
Epoch: 5 cost time: 28.95419454574585
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0442061
	speed: 0.2041s/iter; left time: 2372.6039s
	iters: 200, epoch: 6 | loss: 0.0224360
	speed: 0.0548s/iter; left time: 632.1921s
	iters: 300, epoch: 6 | loss: 0.0618135
	speed: 0.0540s/iter; left time: 617.3468s
	iters: 400, epoch: 6 | loss: 0.0702109
	speed: 0.0522s/iter; left time: 590.8295s
Epoch: 6 cost time: 25.27870798110962
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.969124 --> -0.978558).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1603366
	speed: 0.1991s/iter; left time: 2221.5154s
	iters: 200, epoch: 7 | loss: 0.0080052
	speed: 0.0548s/iter; left time: 606.0385s
	iters: 300, epoch: 7 | loss: 0.0936722
	speed: 0.0540s/iter; left time: 591.4799s
	iters: 400, epoch: 7 | loss: 0.0251871
	speed: 0.0524s/iter; left time: 569.2021s
Epoch: 7 cost time: 25.465879201889038
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0005889
	speed: 0.1966s/iter; left time: 2101.5708s
	iters: 200, epoch: 8 | loss: 0.0005263
	speed: 0.0557s/iter; left time: 589.9760s
	iters: 300, epoch: 8 | loss: 0.1342068
	speed: 0.0527s/iter; left time: 552.6541s
	iters: 400, epoch: 8 | loss: 0.0025285
	speed: 0.0525s/iter; left time: 545.5140s
Epoch: 8 cost time: 26.203123092651367
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003797
	speed: 0.2228s/iter; left time: 2276.9602s
	iters: 200, epoch: 9 | loss: 0.0012456
	speed: 0.0621s/iter; left time: 628.4395s
	iters: 300, epoch: 9 | loss: 0.0026909
	speed: 0.0597s/iter; left time: 597.7094s
	iters: 400, epoch: 9 | loss: 0.0104315
	speed: 0.0603s/iter; left time: 598.1877s
Epoch: 9 cost time: 28.854161977767944
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002087
	speed: 0.2109s/iter; left time: 2056.7203s
	iters: 200, epoch: 10 | loss: 0.0558451
	speed: 0.0611s/iter; left time: 589.3276s
	iters: 300, epoch: 10 | loss: 0.0098388
	speed: 0.0640s/iter; left time: 611.2731s
	iters: 400, epoch: 10 | loss: 0.0081395
	speed: 0.0631s/iter; left time: 595.9594s
Epoch: 10 cost time: 29.98377513885498
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0238857
	speed: 0.2063s/iter; left time: 1914.6570s
	iters: 200, epoch: 11 | loss: 0.0182175
	speed: 0.0547s/iter; left time: 502.1474s
	iters: 300, epoch: 11 | loss: 0.0000822
	speed: 0.0574s/iter; left time: 520.9378s
	iters: 400, epoch: 11 | loss: 0.0007227
	speed: 0.0537s/iter; left time: 481.9975s
Epoch: 11 cost time: 26.018651485443115
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0005724
	speed: 0.1965s/iter; left time: 1731.9893s
	iters: 200, epoch: 12 | loss: 0.0128772
	speed: 0.0559s/iter; left time: 487.2464s
	iters: 300, epoch: 12 | loss: 0.0006666
	speed: 0.0553s/iter; left time: 476.4679s
	iters: 400, epoch: 12 | loss: 0.0003184
	speed: 0.0531s/iter; left time: 452.4048s
Epoch: 12 cost time: 25.847726583480835
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.978558 --> -0.982847).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002714
	speed: 0.2093s/iter; left time: 1746.0683s
	iters: 200, epoch: 13 | loss: 0.0002547
	speed: 0.0561s/iter; left time: 462.3858s
	iters: 300, epoch: 13 | loss: 0.0005127
	speed: 0.0548s/iter; left time: 446.2254s
	iters: 400, epoch: 13 | loss: 0.0076284
	speed: 0.0643s/iter; left time: 516.9932s
Epoch: 13 cost time: 28.167867183685303
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0008238
	speed: 0.2239s/iter; left time: 1762.7582s
	iters: 200, epoch: 14 | loss: 0.0073041
	speed: 0.0610s/iter; left time: 474.3761s
	iters: 300, epoch: 14 | loss: 0.0003990
	speed: 0.0635s/iter; left time: 487.1047s
	iters: 400, epoch: 14 | loss: 0.0002571
	speed: 0.0639s/iter; left time: 483.7235s
Epoch: 14 cost time: 29.84882116317749
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006537
	speed: 0.2234s/iter; left time: 1654.1876s
	iters: 200, epoch: 15 | loss: 0.0099429
	speed: 0.0624s/iter; left time: 455.7665s
	iters: 300, epoch: 15 | loss: 0.0000437
	speed: 0.0653s/iter; left time: 470.8402s
	iters: 400, epoch: 15 | loss: 0.0006573
	speed: 0.0610s/iter; left time: 433.1288s
Epoch: 15 cost time: 29.306720733642578
Epoch: 15, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002835
	speed: 0.2009s/iter; left time: 1393.3935s
	iters: 200, epoch: 16 | loss: 0.0003231
	speed: 0.0575s/iter; left time: 393.2799s
	iters: 300, epoch: 16 | loss: 0.0355505
	speed: 0.0548s/iter; left time: 368.8533s
	iters: 400, epoch: 16 | loss: 0.0007402
	speed: 0.0528s/iter; left time: 350.4250s
Epoch: 16 cost time: 26.099096059799194
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0003951
	speed: 0.2013s/iter; left time: 1301.6234s
	iters: 200, epoch: 17 | loss: 0.0045709
	speed: 0.0560s/iter; left time: 356.7326s
	iters: 300, epoch: 17 | loss: 0.0033312
	speed: 0.0529s/iter; left time: 331.7733s
	iters: 400, epoch: 17 | loss: 0.0002254
	speed: 0.0547s/iter; left time: 337.3800s
Epoch: 17 cost time: 26.336411714553833
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0001475
	speed: 0.2043s/iter; left time: 1225.6696s
	iters: 200, epoch: 18 | loss: 0.0007927
	speed: 0.0549s/iter; left time: 323.9280s
	iters: 300, epoch: 18 | loss: 0.0012237
	speed: 0.0609s/iter; left time: 353.2526s
	iters: 400, epoch: 18 | loss: 0.0001078
	speed: 0.0645s/iter; left time: 367.6599s
Epoch: 18 cost time: 28.521535634994507
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0002357
	speed: 0.2229s/iter; left time: 1232.4241s
	iters: 200, epoch: 19 | loss: 0.0007370
	speed: 0.0610s/iter; left time: 331.0663s
	iters: 300, epoch: 19 | loss: 0.0004349
	speed: 0.0646s/iter; left time: 344.3720s
	iters: 400, epoch: 19 | loss: 0.0015508
	speed: 0.0626s/iter; left time: 327.5236s
Epoch: 19 cost time: 29.68011236190796
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0003829
	speed: 0.2236s/iter; left time: 1131.4962s
	iters: 200, epoch: 20 | loss: 0.0002608
	speed: 0.0645s/iter; left time: 319.7720s
	iters: 300, epoch: 20 | loss: 0.0021528
	speed: 0.0620s/iter; left time: 301.2943s
	iters: 400, epoch: 20 | loss: 0.0318523
	speed: 0.0552s/iter; left time: 262.8018s
Epoch: 20 cost time: 28.593130350112915
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0002054
	speed: 0.2027s/iter; left time: 930.5275s
	iters: 200, epoch: 21 | loss: 0.0008517
	speed: 0.0567s/iter; left time: 254.7891s
	iters: 300, epoch: 21 | loss: 0.0717579
	speed: 0.0525s/iter; left time: 230.4850s
	iters: 400, epoch: 21 | loss: 0.0002148
	speed: 0.0536s/iter; left time: 230.1433s
Epoch: 21 cost time: 26.13766312599182
Epoch: 21, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0058018
	speed: 0.2041s/iter; left time: 841.2766s
	iters: 200, epoch: 22 | loss: 0.0001551
	speed: 0.0543s/iter; left time: 218.5873s
	iters: 300, epoch: 22 | loss: 0.0061542
	speed: 0.0529s/iter; left time: 207.5765s
	iters: 400, epoch: 22 | loss: 0.0003005
	speed: 0.0556s/iter; left time: 212.6425s
Epoch: 22 cost time: 26.502728700637817
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 18753034
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6058553
	speed: 0.0345s/iter; left time: 481.5409s
	iters: 200, epoch: 1 | loss: 0.2098078
	speed: 0.0229s/iter; left time: 317.9844s
	iters: 300, epoch: 1 | loss: 0.2408766
	speed: 0.0221s/iter; left time: 304.8222s
	iters: 400, epoch: 1 | loss: 0.0632903
	speed: 0.0223s/iter; left time: 304.3832s
Epoch: 1 cost time: 11.973270654678345
Epoch: 1, Steps: 469 | Train Loss: 0.528 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (inf --> -0.967123).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0309161
	speed: 0.0827s/iter; left time: 1116.5548s
	iters: 200, epoch: 2 | loss: 0.0944804
	speed: 0.0169s/iter; left time: 226.0021s
	iters: 300, epoch: 2 | loss: 0.0517132
	speed: 0.0153s/iter; left time: 204.1460s
	iters: 400, epoch: 2 | loss: 0.0089860
	speed: 0.0172s/iter; left time: 226.7809s
Epoch: 2 cost time: 8.646126747131348
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.967123 --> -0.968552).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0029560
	speed: 0.1184s/iter; left time: 1542.9308s
	iters: 200, epoch: 3 | loss: 0.1287896
	speed: 0.0384s/iter; left time: 496.2056s
	iters: 300, epoch: 3 | loss: 0.0521636
	speed: 0.0370s/iter; left time: 474.3066s
	iters: 400, epoch: 3 | loss: 0.0026755
	speed: 0.0365s/iter; left time: 464.3704s
Epoch: 3 cost time: 17.898517608642578
Epoch: 3, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0056686
	speed: 0.1642s/iter; left time: 2062.8327s
	iters: 200, epoch: 4 | loss: 0.0021553
	speed: 0.0377s/iter; left time: 469.7240s
	iters: 300, epoch: 4 | loss: 0.0750677
	speed: 0.0379s/iter; left time: 468.7036s
	iters: 400, epoch: 4 | loss: 0.0051485
	speed: 0.0369s/iter; left time: 452.4595s
Epoch: 4 cost time: 17.8391010761261
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0099913
	speed: 0.1678s/iter; left time: 2029.7006s
	iters: 200, epoch: 5 | loss: 0.1764383
	speed: 0.0370s/iter; left time: 443.6687s
	iters: 300, epoch: 5 | loss: 0.0007656
	speed: 0.0371s/iter; left time: 441.6403s
	iters: 400, epoch: 5 | loss: 0.0010876
	speed: 0.0376s/iter; left time: 443.8761s
Epoch: 5 cost time: 17.807713508605957
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.961 Test Loss: 0.122 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0007689
	speed: 0.1641s/iter; left time: 1908.1942s
	iters: 200, epoch: 6 | loss: 0.0014580
	speed: 0.0373s/iter; left time: 429.5328s
	iters: 300, epoch: 6 | loss: 0.0008565
	speed: 0.0372s/iter; left time: 424.8283s
	iters: 400, epoch: 6 | loss: 0.0004698
	speed: 0.0367s/iter; left time: 415.9755s
Epoch: 6 cost time: 17.685383081436157
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.968552 --> -0.971697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0007900
	speed: 0.1653s/iter; left time: 1843.7920s
	iters: 200, epoch: 7 | loss: 0.0012594
	speed: 0.0379s/iter; left time: 418.8010s
	iters: 300, epoch: 7 | loss: 0.0080255
	speed: 0.0390s/iter; left time: 427.7284s
	iters: 400, epoch: 7 | loss: 0.0006679
	speed: 0.0370s/iter; left time: 402.1499s
Epoch: 7 cost time: 17.878878355026245
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.971697 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0034849
	speed: 0.1683s/iter; left time: 1799.0933s
	iters: 200, epoch: 8 | loss: 0.0128750
	speed: 0.0361s/iter; left time: 381.9469s
	iters: 300, epoch: 8 | loss: 0.0007059
	speed: 0.0374s/iter; left time: 392.0531s
	iters: 400, epoch: 8 | loss: 0.0105713
	speed: 0.0392s/iter; left time: 406.9734s
Epoch: 8 cost time: 17.980918169021606
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0005225
	speed: 0.1616s/iter; left time: 1651.5377s
	iters: 200, epoch: 9 | loss: 0.0062776
	speed: 0.0315s/iter; left time: 318.3628s
	iters: 300, epoch: 9 | loss: 0.0021004
	speed: 0.0317s/iter; left time: 317.7095s
	iters: 400, epoch: 9 | loss: 0.1656154
	speed: 0.0319s/iter; left time: 316.2305s
Epoch: 9 cost time: 15.559355974197388
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.980273).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0023950
	speed: 0.1480s/iter; left time: 1443.3150s
	iters: 200, epoch: 10 | loss: 0.0014469
	speed: 0.0331s/iter; left time: 319.7630s
	iters: 300, epoch: 10 | loss: 0.0042268
	speed: 0.0326s/iter; left time: 311.5786s
	iters: 400, epoch: 10 | loss: 0.0004491
	speed: 0.0311s/iter; left time: 294.2069s
Epoch: 10 cost time: 15.39502501487732
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001819
	speed: 0.1441s/iter; left time: 1337.7913s
	iters: 200, epoch: 11 | loss: 0.0032368
	speed: 0.0326s/iter; left time: 299.2256s
	iters: 300, epoch: 11 | loss: 0.0001937
	speed: 0.0330s/iter; left time: 299.3102s
	iters: 400, epoch: 11 | loss: 0.0006097
	speed: 0.0334s/iter; left time: 300.2906s
Epoch: 11 cost time: 15.657819032669067
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0017450
	speed: 0.1471s/iter; left time: 1296.3895s
	iters: 200, epoch: 12 | loss: 0.1083554
	speed: 0.0324s/iter; left time: 282.1273s
	iters: 300, epoch: 12 | loss: 0.0128965
	speed: 0.0311s/iter; left time: 268.1304s
	iters: 400, epoch: 12 | loss: 0.0003529
	speed: 0.0317s/iter; left time: 270.1935s
Epoch: 12 cost time: 15.311570405960083
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0018262
	speed: 0.1426s/iter; left time: 1189.3066s
	iters: 200, epoch: 13 | loss: 0.0022398
	speed: 0.0332s/iter; left time: 273.7460s
	iters: 300, epoch: 13 | loss: 0.0019676
	speed: 0.0323s/iter; left time: 262.6183s
	iters: 400, epoch: 13 | loss: 0.0176050
	speed: 0.0325s/iter; left time: 261.4451s
Epoch: 13 cost time: 15.477600336074829
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0010725
	speed: 0.1415s/iter; left time: 1114.4691s
	iters: 200, epoch: 14 | loss: 0.0238582
	speed: 0.0314s/iter; left time: 244.4566s
	iters: 300, epoch: 14 | loss: 0.0001358
	speed: 0.0318s/iter; left time: 244.1644s
	iters: 400, epoch: 14 | loss: 0.0011100
	speed: 0.0321s/iter; left time: 243.3509s
Epoch: 14 cost time: 15.20483136177063
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0014792
	speed: 0.1429s/iter; left time: 1057.9371s
	iters: 200, epoch: 15 | loss: 0.0002722
	speed: 0.0340s/iter; left time: 248.5798s
	iters: 300, epoch: 15 | loss: 0.0007858
	speed: 0.0318s/iter; left time: 228.9350s
	iters: 400, epoch: 15 | loss: 0.0145741
	speed: 0.0317s/iter; left time: 225.3423s
Epoch: 15 cost time: 15.510822057723999
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0002943
	speed: 0.1423s/iter; left time: 986.9599s
	iters: 200, epoch: 16 | loss: 0.0001623
	speed: 0.0362s/iter; left time: 247.3612s
	iters: 300, epoch: 16 | loss: 0.0006678
	speed: 0.0376s/iter; left time: 253.4074s
	iters: 400, epoch: 16 | loss: 0.0022094
	speed: 0.0382s/iter; left time: 253.2508s
Epoch: 16 cost time: 17.19028878211975
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.976 Test Loss: 0.159 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0011296
	speed: 0.1654s/iter; left time: 1069.8002s
	iters: 200, epoch: 17 | loss: 0.0013132
	speed: 0.0360s/iter; left time: 229.0078s
	iters: 300, epoch: 17 | loss: 0.0015102
	speed: 0.0370s/iter; left time: 232.1539s
	iters: 400, epoch: 17 | loss: 0.0001106
	speed: 0.0372s/iter; left time: 229.4941s
Epoch: 17 cost time: 17.7870671749115
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0011137
	speed: 0.1642s/iter; left time: 985.1551s
	iters: 200, epoch: 18 | loss: 0.0018610
	speed: 0.0350s/iter; left time: 206.3025s
	iters: 300, epoch: 18 | loss: 0.0002039
	speed: 0.0350s/iter; left time: 202.8382s
	iters: 400, epoch: 18 | loss: 0.0002921
	speed: 0.0350s/iter; left time: 199.4834s
Epoch: 18 cost time: 17.14176344871521
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0027129
	speed: 0.1648s/iter; left time: 910.9831s
	iters: 200, epoch: 19 | loss: 0.0003756
	speed: 0.0378s/iter; left time: 205.1340s
	iters: 300, epoch: 19 | loss: 0.0001731
	speed: 0.0384s/iter; left time: 204.4066s
	iters: 400, epoch: 19 | loss: 0.0002996
	speed: 0.0366s/iter; left time: 191.3962s
Epoch: 19 cost time: 17.855404138565063
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 5513482
model size : 22.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7096074
	speed: 0.1287s/iter; left time: 1798.1494s
	iters: 200, epoch: 1 | loss: 0.2869092
	speed: 0.1158s/iter; left time: 1606.6252s
	iters: 300, epoch: 1 | loss: 0.2010767
	speed: 0.1168s/iter; left time: 1608.3601s
	iters: 400, epoch: 1 | loss: 0.0273254
	speed: 0.1145s/iter; left time: 1565.5413s
Epoch: 1 cost time: 56.01525640487671
Epoch: 1, Steps: 469 | Train Loss: 0.485 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
Validation loss decreased (inf --> -0.960262).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0743181
	speed: 0.3918s/iter; left time: 5290.2230s
	iters: 200, epoch: 2 | loss: 0.3623970
	speed: 0.0992s/iter; left time: 1329.6770s
	iters: 300, epoch: 2 | loss: 0.0986243
	speed: 0.1004s/iter; left time: 1336.0557s
	iters: 400, epoch: 2 | loss: 0.0726243
	speed: 0.0984s/iter; left time: 1298.4932s
Epoch: 2 cost time: 47.01273155212402
Epoch: 2, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
Validation loss decreased (-0.960262 --> -0.962263).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053696
	speed: 0.3815s/iter; left time: 4971.7346s
	iters: 200, epoch: 3 | loss: 0.0106810
	speed: 0.0997s/iter; left time: 1289.2765s
	iters: 300, epoch: 3 | loss: 0.0066944
	speed: 0.0993s/iter; left time: 1273.8171s
	iters: 400, epoch: 3 | loss: 0.0643380
	speed: 0.0952s/iter; left time: 1212.0733s
Epoch: 3 cost time: 46.693273305892944
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0102386
	speed: 0.3784s/iter; left time: 4754.2245s
	iters: 200, epoch: 4 | loss: 0.0069621
	speed: 0.1012s/iter; left time: 1261.1771s
	iters: 300, epoch: 4 | loss: 0.2728933
	speed: 0.1000s/iter; left time: 1236.9851s
	iters: 400, epoch: 4 | loss: 0.0028966
	speed: 0.0984s/iter; left time: 1206.6986s
Epoch: 4 cost time: 47.01542663574219
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.962263 --> -0.972841).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0260839
	speed: 0.3808s/iter; left time: 4605.6978s
	iters: 200, epoch: 5 | loss: 0.0153067
	speed: 0.0976s/iter; left time: 1171.1570s
	iters: 300, epoch: 5 | loss: 0.0469955
	speed: 0.1147s/iter; left time: 1364.0678s
	iters: 400, epoch: 5 | loss: 0.0069857
	speed: 0.1143s/iter; left time: 1347.7825s
Epoch: 5 cost time: 50.97792363166809
Epoch: 5, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003795
	speed: 0.4391s/iter; left time: 5104.7296s
	iters: 200, epoch: 6 | loss: 0.0040487
	speed: 0.1171s/iter; left time: 1349.2750s
	iters: 300, epoch: 6 | loss: 0.0623955
	speed: 0.1199s/iter; left time: 1369.9064s
	iters: 400, epoch: 6 | loss: 0.0080732
	speed: 0.1163s/iter; left time: 1317.7419s
Epoch: 6 cost time: 55.58634281158447
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0010144
	speed: 0.4355s/iter; left time: 4858.4093s
	iters: 200, epoch: 7 | loss: 0.0038717
	speed: 0.1149s/iter; left time: 1270.3766s
	iters: 300, epoch: 7 | loss: 0.0031251
	speed: 0.1180s/iter; left time: 1292.7836s
	iters: 400, epoch: 7 | loss: 0.0004987
	speed: 0.1134s/iter; left time: 1231.7128s
Epoch: 7 cost time: 54.16303730010986
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0754628
	speed: 0.4100s/iter; left time: 4382.4675s
	iters: 200, epoch: 8 | loss: 0.0001142
	speed: 0.0974s/iter; left time: 1030.7670s
	iters: 300, epoch: 8 | loss: 0.0024233
	speed: 0.0948s/iter; left time: 994.0468s
	iters: 400, epoch: 8 | loss: 0.0001433
	speed: 0.0977s/iter; left time: 1015.4243s
Epoch: 8 cost time: 46.58855056762695
Epoch: 8, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.973984 --> -0.978844).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0021149
	speed: 0.3645s/iter; left time: 3725.0780s
	iters: 200, epoch: 9 | loss: 0.0042087
	speed: 0.0980s/iter; left time: 992.0841s
	iters: 300, epoch: 9 | loss: 0.0001187
	speed: 0.0949s/iter; left time: 951.0519s
	iters: 400, epoch: 9 | loss: 0.0084023
	speed: 0.0980s/iter; left time: 971.8263s
Epoch: 9 cost time: 45.4275176525116
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0086746
	speed: 0.3625s/iter; left time: 3534.8209s
	iters: 200, epoch: 10 | loss: 0.0068814
	speed: 0.0981s/iter; left time: 946.2469s
	iters: 300, epoch: 10 | loss: 0.0020695
	speed: 0.0957s/iter; left time: 914.0846s
	iters: 400, epoch: 10 | loss: 0.0010970
	speed: 0.0957s/iter; left time: 904.8161s
Epoch: 10 cost time: 45.467589378356934
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0013843
	speed: 0.3645s/iter; left time: 3383.2905s
	iters: 200, epoch: 11 | loss: 0.0012152
	speed: 0.0973s/iter; left time: 893.7093s
	iters: 300, epoch: 11 | loss: 0.0485916
	speed: 0.0961s/iter; left time: 872.8300s
	iters: 400, epoch: 11 | loss: 0.0001746
	speed: 0.0947s/iter; left time: 850.8599s
Epoch: 11 cost time: 45.348851442337036
Epoch: 11, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0003765
	speed: 0.3959s/iter; left time: 3488.7415s
	iters: 200, epoch: 12 | loss: 0.0004618
	speed: 0.1125s/iter; left time: 980.3851s
	iters: 300, epoch: 12 | loss: 0.0004216
	speed: 0.1139s/iter; left time: 981.2607s
	iters: 400, epoch: 12 | loss: 0.0053101
	speed: 0.1111s/iter; left time: 945.8133s
Epoch: 12 cost time: 53.301159143447876
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0005820
	speed: 0.4211s/iter; left time: 3513.0306s
	iters: 200, epoch: 13 | loss: 0.0051747
	speed: 0.1115s/iter; left time: 919.1569s
	iters: 300, epoch: 13 | loss: 0.0002393
	speed: 0.1141s/iter; left time: 928.8431s
	iters: 400, epoch: 13 | loss: 0.0043610
	speed: 0.1143s/iter; left time: 919.5312s
Epoch: 13 cost time: 53.49175238609314
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0003093
	speed: 0.4189s/iter; left time: 3298.8047s
	iters: 200, epoch: 14 | loss: 0.0002881
	speed: 0.1141s/iter; left time: 886.8338s
	iters: 300, epoch: 14 | loss: 0.0002687
	speed: 0.1114s/iter; left time: 855.0532s
	iters: 400, epoch: 14 | loss: 0.0165269
	speed: 0.1078s/iter; left time: 816.3019s
Epoch: 14 cost time: 52.25934958457947
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0003372
	speed: 0.3908s/iter; left time: 2893.8382s
	iters: 200, epoch: 15 | loss: 0.0004471
	speed: 0.1006s/iter; left time: 734.6339s
	iters: 300, epoch: 15 | loss: 0.0009318
	speed: 0.1055s/iter; left time: 759.8985s
	iters: 400, epoch: 15 | loss: 0.0002062
	speed: 0.1040s/iter; left time: 738.8602s
Epoch: 15 cost time: 49.04539084434509
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001238
	speed: 0.3896s/iter; left time: 2702.2787s
	iters: 200, epoch: 16 | loss: 0.0007103
	speed: 0.1034s/iter; left time: 706.6757s
	iters: 300, epoch: 16 | loss: 0.0241558
	speed: 0.1039s/iter; left time: 700.1846s
	iters: 400, epoch: 16 | loss: 0.0014912
	speed: 0.1035s/iter; left time: 686.8051s
Epoch: 16 cost time: 49.09757137298584
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0003016
	speed: 0.3898s/iter; left time: 2521.0129s
	iters: 200, epoch: 17 | loss: 0.0048469
	speed: 0.1063s/iter; left time: 676.6975s
	iters: 300, epoch: 17 | loss: 0.0009023
	speed: 0.1029s/iter; left time: 644.6417s
	iters: 400, epoch: 17 | loss: 0.0001345
	speed: 0.1068s/iter; left time: 658.6754s
Epoch: 17 cost time: 49.381428956985474
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0025302
	speed: 0.3952s/iter; left time: 2370.2892s
	iters: 200, epoch: 18 | loss: 0.0000485
	speed: 0.1041s/iter; left time: 613.6999s
	iters: 300, epoch: 18 | loss: 0.0007311
	speed: 0.1214s/iter; left time: 703.9654s
	iters: 400, epoch: 18 | loss: 0.1934280
	speed: 0.1239s/iter; left time: 706.1246s
Epoch: 18 cost time: 54.142760038375854
Epoch: 18, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 9379850
model size : 37.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7793633
	speed: 0.0799s/iter; left time: 1116.6578s
	iters: 200, epoch: 1 | loss: 0.3170623
	speed: 0.0682s/iter; left time: 945.9424s
	iters: 300, epoch: 1 | loss: 0.1539592
	speed: 0.0649s/iter; left time: 893.9125s
	iters: 400, epoch: 1 | loss: 0.2602231
	speed: 0.0677s/iter; left time: 925.7746s
Epoch: 1 cost time: 32.991650342941284
Epoch: 1, Steps: 469 | Train Loss: 0.508 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (inf --> -0.965122).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0171306
	speed: 0.2500s/iter; left time: 3375.8589s
	iters: 200, epoch: 2 | loss: 0.0716624
	speed: 0.0674s/iter; left time: 903.0647s
	iters: 300, epoch: 2 | loss: 0.1946507
	speed: 0.0659s/iter; left time: 876.1031s
	iters: 400, epoch: 2 | loss: 0.0296210
	speed: 0.0658s/iter; left time: 869.0616s
Epoch: 2 cost time: 30.96840786933899
Epoch: 2, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.965122 --> -0.971983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0011685
	speed: 0.2250s/iter; left time: 2932.1945s
	iters: 200, epoch: 3 | loss: 0.0177231
	speed: 0.0608s/iter; left time: 786.5279s
	iters: 300, epoch: 3 | loss: 0.0308393
	speed: 0.0627s/iter; left time: 804.5362s
	iters: 400, epoch: 3 | loss: 0.1959568
	speed: 0.0505s/iter; left time: 643.5101s
Epoch: 3 cost time: 27.722724676132202
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1831556
	speed: 0.2140s/iter; left time: 2688.1261s
	iters: 200, epoch: 4 | loss: 0.0072888
	speed: 0.0535s/iter; left time: 666.8004s
	iters: 300, epoch: 4 | loss: 0.0118821
	speed: 0.0559s/iter; left time: 691.1305s
	iters: 400, epoch: 4 | loss: 0.0021702
	speed: 0.0553s/iter; left time: 677.6706s
Epoch: 4 cost time: 25.78166651725769
Epoch: 4, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0034591
	speed: 0.2023s/iter; left time: 2447.3996s
	iters: 200, epoch: 5 | loss: 0.0008428
	speed: 0.0558s/iter; left time: 669.2822s
	iters: 300, epoch: 5 | loss: 0.0026820
	speed: 0.0559s/iter; left time: 665.1900s
	iters: 400, epoch: 5 | loss: 0.0103705
	speed: 0.0528s/iter; left time: 622.5500s
Epoch: 5 cost time: 25.74401545524597
Epoch: 5, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0023893
	speed: 0.2017s/iter; left time: 2345.3933s
	iters: 200, epoch: 6 | loss: 0.0014733
	speed: 0.0555s/iter; left time: 639.9272s
	iters: 300, epoch: 6 | loss: 0.0205394
	speed: 0.0539s/iter; left time: 616.0377s
	iters: 400, epoch: 6 | loss: 0.0643060
	speed: 0.0532s/iter; left time: 603.0915s
Epoch: 6 cost time: 25.704910278320312
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.977129).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008036
	speed: 0.2115s/iter; left time: 2359.5002s
	iters: 200, epoch: 7 | loss: 0.0049625
	speed: 0.0562s/iter; left time: 621.6871s
	iters: 300, epoch: 7 | loss: 0.3739005
	speed: 0.0531s/iter; left time: 582.1409s
	iters: 400, epoch: 7 | loss: 0.0723263
	speed: 0.0531s/iter; left time: 576.5545s
Epoch: 7 cost time: 25.760543823242188
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0006621
	speed: 0.2083s/iter; left time: 2225.9346s
	iters: 200, epoch: 8 | loss: 0.0014128
	speed: 0.0650s/iter; left time: 688.7188s
	iters: 300, epoch: 8 | loss: 0.0022303
	speed: 0.0635s/iter; left time: 665.6708s
	iters: 400, epoch: 8 | loss: 0.0005777
	speed: 0.0653s/iter; left time: 678.5078s
Epoch: 8 cost time: 29.54235816001892
Epoch: 8, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0042442
	speed: 0.2395s/iter; left time: 2447.4627s
	iters: 200, epoch: 9 | loss: 0.0050259
	speed: 0.0609s/iter; left time: 616.1591s
	iters: 300, epoch: 9 | loss: 0.0023392
	speed: 0.0641s/iter; left time: 642.4860s
	iters: 400, epoch: 9 | loss: 0.0011216
	speed: 0.0638s/iter; left time: 632.8316s
Epoch: 9 cost time: 29.83581805229187
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0015336
	speed: 0.2333s/iter; left time: 2274.7440s
	iters: 200, epoch: 10 | loss: 0.0024140
	speed: 0.0619s/iter; left time: 597.1759s
	iters: 300, epoch: 10 | loss: 0.0006999
	speed: 0.0649s/iter; left time: 620.0964s
	iters: 400, epoch: 10 | loss: 0.0019655
	speed: 0.0612s/iter; left time: 578.0995s
Epoch: 10 cost time: 29.485310554504395
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0004452
	speed: 0.2258s/iter; left time: 2095.9722s
	iters: 200, epoch: 11 | loss: 0.0064221
	speed: 0.0646s/iter; left time: 592.6800s
	iters: 300, epoch: 11 | loss: 0.0054365
	speed: 0.0630s/iter; left time: 572.5361s
	iters: 400, epoch: 11 | loss: 0.3752429
	speed: 0.0663s/iter; left time: 595.5132s
Epoch: 11 cost time: 30.671980619430542
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0041912
	speed: 0.2404s/iter; left time: 2118.3350s
	iters: 200, epoch: 12 | loss: 0.0810864
	speed: 0.0514s/iter; left time: 447.7396s
	iters: 300, epoch: 12 | loss: 0.0000781
	speed: 0.0578s/iter; left time: 498.0892s
	iters: 400, epoch: 12 | loss: 0.0008545
	speed: 0.0564s/iter; left time: 480.0021s
Epoch: 12 cost time: 27.185369729995728
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0002310
	speed: 0.2135s/iter; left time: 1781.5187s
	iters: 200, epoch: 13 | loss: 0.0038391
	speed: 0.0586s/iter; left time: 483.2980s
	iters: 300, epoch: 13 | loss: 0.0076015
	speed: 0.0556s/iter; left time: 452.9929s
	iters: 400, epoch: 13 | loss: 0.0006936
	speed: 0.0552s/iter; left time: 443.6660s
Epoch: 13 cost time: 26.738100051879883
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.977129 --> -0.981131).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003900
	speed: 0.2183s/iter; left time: 1718.5612s
	iters: 200, epoch: 14 | loss: 0.0008543
	speed: 0.0554s/iter; left time: 430.6564s
	iters: 300, epoch: 14 | loss: 0.0015636
	speed: 0.0554s/iter; left time: 424.9687s
	iters: 400, epoch: 14 | loss: 0.0007635
	speed: 0.0554s/iter; left time: 419.3009s
Epoch: 14 cost time: 26.358124256134033
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.982847).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0007663
	speed: 0.2167s/iter; left time: 1604.4777s
	iters: 200, epoch: 15 | loss: 0.0005647
	speed: 0.0574s/iter; left time: 418.9499s
	iters: 300, epoch: 15 | loss: 0.0006806
	speed: 0.0577s/iter; left time: 415.7098s
	iters: 400, epoch: 15 | loss: 0.0008481
	speed: 0.0563s/iter; left time: 400.0803s
Epoch: 15 cost time: 26.698035955429077
Epoch: 15, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002298
	speed: 0.2188s/iter; left time: 1517.8990s
	iters: 200, epoch: 16 | loss: 0.0005227
	speed: 0.0581s/iter; left time: 397.5064s
	iters: 300, epoch: 16 | loss: 0.0008309
	speed: 0.0556s/iter; left time: 374.2355s
	iters: 400, epoch: 16 | loss: 0.0908933
	speed: 0.0574s/iter; left time: 381.0958s
Epoch: 16 cost time: 26.997841835021973
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0030458
	speed: 0.2241s/iter; left time: 1449.3298s
	iters: 200, epoch: 17 | loss: 0.0002107
	speed: 0.0624s/iter; left time: 397.0215s
	iters: 300, epoch: 17 | loss: 0.0001392
	speed: 0.0652s/iter; left time: 408.7096s
	iters: 400, epoch: 17 | loss: 0.0800193
	speed: 0.0646s/iter; left time: 398.1067s
Epoch: 17 cost time: 30.370042324066162
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0041733
	speed: 0.2384s/iter; left time: 1429.9292s
	iters: 200, epoch: 18 | loss: 0.0001705
	speed: 0.0599s/iter; left time: 353.0128s
	iters: 300, epoch: 18 | loss: 0.0001452
	speed: 0.0558s/iter; left time: 323.7097s
	iters: 400, epoch: 18 | loss: 0.0001255
	speed: 0.0616s/iter; left time: 351.0621s
Epoch: 18 cost time: 28.668415307998657
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0086786
	speed: 0.2305s/iter; left time: 1274.3807s
	iters: 200, epoch: 19 | loss: 0.0019785
	speed: 0.0605s/iter; left time: 328.6391s
	iters: 300, epoch: 19 | loss: 0.0000715
	speed: 0.0642s/iter; left time: 341.9673s
	iters: 400, epoch: 19 | loss: 0.0020163
	speed: 0.0607s/iter; left time: 317.2873s
Epoch: 19 cost time: 29.278342962265015
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0002581
	speed: 0.2298s/iter; left time: 1163.0404s
	iters: 200, epoch: 20 | loss: 0.0002323
	speed: 0.0620s/iter; left time: 307.3096s
	iters: 300, epoch: 20 | loss: 0.0001311
	speed: 0.0614s/iter; left time: 298.2054s
	iters: 400, epoch: 20 | loss: 0.0011259
	speed: 0.0641s/iter; left time: 305.3321s
Epoch: 20 cost time: 29.47129225730896
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.982847 --> -0.986563).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0911141
	speed: 0.2120s/iter; left time: 973.2204s
	iters: 200, epoch: 21 | loss: 0.0028317
	speed: 0.0543s/iter; left time: 243.7740s
	iters: 300, epoch: 21 | loss: 0.0020636
	speed: 0.0541s/iter; left time: 237.4085s
	iters: 400, epoch: 21 | loss: 0.0025008
	speed: 0.0529s/iter; left time: 226.9958s
Epoch: 21 cost time: 25.494618892669678
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002217
	speed: 0.2108s/iter; left time: 868.9241s
	iters: 200, epoch: 22 | loss: 0.0015838
	speed: 0.0529s/iter; left time: 212.8039s
	iters: 300, epoch: 22 | loss: 0.0069985
	speed: 0.0560s/iter; left time: 219.5618s
	iters: 400, epoch: 22 | loss: 0.0001282
	speed: 0.0538s/iter; left time: 205.6266s
Epoch: 22 cost time: 25.814406871795654
Epoch: 22, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0001758
	speed: 0.2103s/iter; left time: 768.2596s
	iters: 200, epoch: 23 | loss: 0.0000967
	speed: 0.0519s/iter; left time: 184.4389s
	iters: 300, epoch: 23 | loss: 0.0000563
	speed: 0.0523s/iter; left time: 180.4563s
	iters: 400, epoch: 23 | loss: 0.0014023
	speed: 0.0545s/iter; left time: 182.6489s
Epoch: 23 cost time: 25.58516788482666
Epoch: 23, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000897
	speed: 0.2128s/iter; left time: 677.6214s
	iters: 200, epoch: 24 | loss: 0.0012757
	speed: 0.0545s/iter; left time: 168.1282s
	iters: 300, epoch: 24 | loss: 0.0000779
	speed: 0.0554s/iter; left time: 165.2701s
	iters: 400, epoch: 24 | loss: 0.1028890
	speed: 0.0535s/iter; left time: 154.2458s
Epoch: 24 cost time: 25.76451063156128
Epoch: 24, Steps: 469 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000225
	speed: 0.2082s/iter; left time: 565.3935s
	iters: 200, epoch: 25 | loss: 0.0009929
	speed: 0.0505s/iter; left time: 132.0533s
	iters: 300, epoch: 25 | loss: 0.0205638
	speed: 0.0504s/iter; left time: 126.7127s
	iters: 400, epoch: 25 | loss: 0.0000716
	speed: 0.0620s/iter; left time: 149.6481s
Epoch: 25 cost time: 25.867956161499023
Epoch: 25, Steps: 469 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0001033
	speed: 0.2279s/iter; left time: 511.8732s
	iters: 200, epoch: 26 | loss: 0.0000348
	speed: 0.0640s/iter; left time: 137.4135s
	iters: 300, epoch: 26 | loss: 0.0004303
	speed: 0.0613s/iter; left time: 125.4372s
	iters: 400, epoch: 26 | loss: 0.0019808
	speed: 0.0639s/iter; left time: 124.3650s
Epoch: 26 cost time: 29.792836666107178
Epoch: 26, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000078
	speed: 0.2290s/iter; left time: 407.0093s
	iters: 200, epoch: 27 | loss: 0.0000276
	speed: 0.0612s/iter; left time: 102.6545s
	iters: 300, epoch: 27 | loss: 0.0000318
	speed: 0.0628s/iter; left time: 99.0860s
	iters: 400, epoch: 27 | loss: 0.0001313
	speed: 0.0609s/iter; left time: 89.9892s
Epoch: 27 cost time: 28.93414282798767
Epoch: 27, Steps: 469 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0002218
	speed: 0.2295s/iter; left time: 300.1531s
	iters: 200, epoch: 28 | loss: 0.0026094
	speed: 0.0601s/iter; left time: 72.5647s
	iters: 300, epoch: 28 | loss: 0.0047357
	speed: 0.0623s/iter; left time: 69.0259s
	iters: 400, epoch: 28 | loss: 0.0001583
	speed: 0.0627s/iter; left time: 63.2407s
Epoch: 28 cost time: 29.314975261688232
Epoch: 28, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0003003
	speed: 0.2275s/iter; left time: 190.8855s
	iters: 200, epoch: 29 | loss: 0.0002475
	speed: 0.0640s/iter; left time: 47.2796s
	iters: 300, epoch: 29 | loss: 0.0001025
	speed: 0.0605s/iter; left time: 38.6565s
	iters: 400, epoch: 29 | loss: 0.0004075
	speed: 0.0539s/iter; left time: 29.0403s
Epoch: 29 cost time: 27.954702854156494
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0005356
	speed: 0.2118s/iter; left time: 78.3573s
	iters: 200, epoch: 30 | loss: 0.0083615
	speed: 0.0549s/iter; left time: 14.8359s
	iters: 300, epoch: 30 | loss: 0.0094014
	speed: 0.0529s/iter; left time: 8.9975s
	iters: 400, epoch: 30 | loss: 0.0166040
	speed: 0.0552s/iter; left time: 3.8662s
Epoch: 30 cost time: 25.8940851688385
Epoch: 30, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 2759946
model size : 11.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7283323
	speed: 0.0875s/iter; left time: 1222.7215s
	iters: 200, epoch: 1 | loss: 0.2790582
	speed: 0.0728s/iter; left time: 1009.3700s
	iters: 300, epoch: 1 | loss: 0.1868033
	speed: 0.0667s/iter; left time: 919.1799s
	iters: 400, epoch: 1 | loss: 0.0339793
	speed: 0.0737s/iter; left time: 1007.9338s
Epoch: 1 cost time: 35.13834238052368
Epoch: 1, Steps: 469 | Train Loss: 0.492 Vali Loss: 0.133 Vali Acc: 0.955 Test Loss: 0.133 Test Acc: 0.955
Validation loss decreased (inf --> -0.955116).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0440228
	speed: 0.2826s/iter; left time: 3815.2416s
	iters: 200, epoch: 2 | loss: 0.3464241
	speed: 0.0728s/iter; left time: 975.0088s
	iters: 300, epoch: 2 | loss: 0.1322166
	speed: 0.0728s/iter; left time: 968.2558s
	iters: 400, epoch: 2 | loss: 0.1783730
	speed: 0.0719s/iter; left time: 949.7342s
Epoch: 2 cost time: 34.27731251716614
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.955116 --> -0.965122).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0135359
	speed: 0.2858s/iter; left time: 3725.0662s
	iters: 200, epoch: 3 | loss: 0.0842943
	speed: 0.0704s/iter; left time: 910.5210s
	iters: 300, epoch: 3 | loss: 0.0143581
	speed: 0.0730s/iter; left time: 936.9286s
	iters: 400, epoch: 3 | loss: 0.1355992
	speed: 0.0706s/iter; left time: 898.6687s
Epoch: 3 cost time: 34.77624034881592
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.965122 --> -0.967123).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0140689
	speed: 0.3164s/iter; left time: 3975.5910s
	iters: 200, epoch: 4 | loss: 0.0042132
	speed: 0.0826s/iter; left time: 1029.3817s
	iters: 300, epoch: 4 | loss: 0.0629027
	speed: 0.0816s/iter; left time: 1008.9346s
	iters: 400, epoch: 4 | loss: 0.0029448
	speed: 0.0825s/iter; left time: 1011.2830s
Epoch: 4 cost time: 38.697213649749756
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0039087
	speed: 0.3201s/iter; left time: 3872.0650s
	iters: 200, epoch: 5 | loss: 0.2239710
	speed: 0.0833s/iter; left time: 998.9297s
	iters: 300, epoch: 5 | loss: 0.0039679
	speed: 0.0806s/iter; left time: 958.1439s
	iters: 400, epoch: 5 | loss: 0.0179370
	speed: 0.0818s/iter; left time: 964.6583s
Epoch: 5 cost time: 38.57788920402527
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.967123 --> -0.970554).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0010539
	speed: 0.3222s/iter; left time: 3746.1218s
	iters: 200, epoch: 6 | loss: 0.0005315
	speed: 0.0813s/iter; left time: 936.8582s
	iters: 300, epoch: 6 | loss: 0.0024301
	speed: 0.0837s/iter; left time: 955.9239s
	iters: 400, epoch: 6 | loss: 0.0181326
	speed: 0.0813s/iter; left time: 920.9083s
Epoch: 6 cost time: 39.17044472694397
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970554 --> -0.972841).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005420
	speed: 0.3143s/iter; left time: 3506.6155s
	iters: 200, epoch: 7 | loss: 0.0028465
	speed: 0.0715s/iter; left time: 790.7391s
	iters: 300, epoch: 7 | loss: 0.0003183
	speed: 0.0696s/iter; left time: 763.0465s
	iters: 400, epoch: 7 | loss: 0.0008018
	speed: 0.0729s/iter; left time: 791.6063s
Epoch: 7 cost time: 34.18648338317871
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0040157
	speed: 0.2756s/iter; left time: 2945.1120s
	iters: 200, epoch: 8 | loss: 0.0000985
	speed: 0.0708s/iter; left time: 749.4134s
	iters: 300, epoch: 8 | loss: 0.0023761
	speed: 0.0713s/iter; left time: 748.1439s
	iters: 400, epoch: 8 | loss: 0.0071854
	speed: 0.0700s/iter; left time: 726.8960s
Epoch: 8 cost time: 33.67427182197571
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0012832
	speed: 0.2759s/iter; left time: 2819.6994s
	iters: 200, epoch: 9 | loss: 0.0070326
	speed: 0.0709s/iter; left time: 716.9731s
	iters: 300, epoch: 9 | loss: 0.0001567
	speed: 0.0672s/iter; left time: 672.9654s
	iters: 400, epoch: 9 | loss: 0.0390106
	speed: 0.0696s/iter; left time: 690.1991s
Epoch: 9 cost time: 33.29587721824646
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0007025
	speed: 0.2754s/iter; left time: 2685.3178s
	iters: 200, epoch: 10 | loss: 0.0004561
	speed: 0.0720s/iter; left time: 694.8255s
	iters: 300, epoch: 10 | loss: 0.0007673
	speed: 0.0705s/iter; left time: 673.7398s
	iters: 400, epoch: 10 | loss: 0.0190912
	speed: 0.0722s/iter; left time: 682.5551s
Epoch: 10 cost time: 33.62472057342529
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.973698).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0007950
	speed: 0.2680s/iter; left time: 2487.4584s
	iters: 200, epoch: 11 | loss: 0.0062388
	speed: 0.0663s/iter; left time: 608.8150s
	iters: 300, epoch: 11 | loss: 0.5735076
	speed: 0.0666s/iter; left time: 604.9285s
	iters: 400, epoch: 11 | loss: 0.0012555
	speed: 0.0667s/iter; left time: 599.0271s
Epoch: 11 cost time: 31.606666803359985
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0008650
	speed: 0.2876s/iter; left time: 2534.3987s
	iters: 200, epoch: 12 | loss: 0.0004029
	speed: 0.0777s/iter; left time: 677.0620s
	iters: 300, epoch: 12 | loss: 0.0011202
	speed: 0.0770s/iter; left time: 663.3662s
	iters: 400, epoch: 12 | loss: 0.0048639
	speed: 0.0770s/iter; left time: 655.2213s
Epoch: 12 cost time: 36.60401248931885
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.973698 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0394773
	speed: 0.3075s/iter; left time: 2565.5337s
	iters: 200, epoch: 13 | loss: 0.0006839
	speed: 0.0757s/iter; left time: 623.7377s
	iters: 300, epoch: 13 | loss: 0.0005076
	speed: 0.0753s/iter; left time: 612.9790s
	iters: 400, epoch: 13 | loss: 0.0048096
	speed: 0.0752s/iter; left time: 605.1557s
Epoch: 13 cost time: 35.91507411003113
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978558).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0011270
	speed: 0.3003s/iter; left time: 2364.8861s
	iters: 200, epoch: 14 | loss: 0.0004253
	speed: 0.0781s/iter; left time: 607.2152s
	iters: 300, epoch: 14 | loss: 0.0004485
	speed: 0.0777s/iter; left time: 596.3929s
	iters: 400, epoch: 14 | loss: 0.0032617
	speed: 0.0774s/iter; left time: 586.1747s
Epoch: 14 cost time: 36.859049558639526
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0001234
	speed: 0.3046s/iter; left time: 2255.5123s
	iters: 200, epoch: 15 | loss: 0.0001179
	speed: 0.0776s/iter; left time: 566.7917s
	iters: 300, epoch: 15 | loss: 0.0014497
	speed: 0.0619s/iter; left time: 445.6583s
	iters: 400, epoch: 15 | loss: 0.0018661
	speed: 0.0658s/iter; left time: 467.3707s
Epoch: 15 cost time: 33.230878829956055
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0004966
	speed: 0.2594s/iter; left time: 1799.3809s
	iters: 200, epoch: 16 | loss: 0.0007762
	speed: 0.0677s/iter; left time: 463.0318s
	iters: 300, epoch: 16 | loss: 0.0087661
	speed: 0.0679s/iter; left time: 457.6841s
	iters: 400, epoch: 16 | loss: 0.0044506
	speed: 0.0667s/iter; left time: 442.8495s
Epoch: 16 cost time: 31.839698791503906
Epoch: 16, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000874
	speed: 0.2574s/iter; left time: 1664.6414s
	iters: 200, epoch: 17 | loss: 0.1640043
	speed: 0.0663s/iter; left time: 422.1331s
	iters: 300, epoch: 17 | loss: 0.0000814
	speed: 0.0664s/iter; left time: 416.4346s
	iters: 400, epoch: 17 | loss: 0.0002534
	speed: 0.0628s/iter; left time: 387.3243s
Epoch: 17 cost time: 31.095945119857788
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0434216
	speed: 0.2572s/iter; left time: 1542.4365s
	iters: 200, epoch: 18 | loss: 0.0002549
	speed: 0.0665s/iter; left time: 392.2721s
	iters: 300, epoch: 18 | loss: 0.0020845
	speed: 0.0662s/iter; left time: 383.7898s
	iters: 400, epoch: 18 | loss: 0.0071073
	speed: 0.0670s/iter; left time: 381.6393s
Epoch: 18 cost time: 31.51208209991455
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0002762
	speed: 0.2566s/iter; left time: 1418.9687s
	iters: 200, epoch: 19 | loss: 0.0006766
	speed: 0.0669s/iter; left time: 363.1564s
	iters: 300, epoch: 19 | loss: 0.0003099
	speed: 0.0678s/iter; left time: 361.4209s
	iters: 400, epoch: 19 | loss: 0.0005271
	speed: 0.0667s/iter; left time: 348.9568s
Epoch: 19 cost time: 31.704674005508423
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979130).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000886
	speed: 0.2822s/iter; left time: 1428.1652s
	iters: 200, epoch: 20 | loss: 0.0009627
	speed: 0.0776s/iter; left time: 384.9306s
	iters: 300, epoch: 20 | loss: 0.0071965
	speed: 0.0773s/iter; left time: 375.7699s
	iters: 400, epoch: 20 | loss: 0.0004691
	speed: 0.0768s/iter; left time: 365.5805s
Epoch: 20 cost time: 36.61960411071777
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0003364
	speed: 0.3020s/iter; left time: 1386.5242s
	iters: 200, epoch: 21 | loss: 0.0001369
	speed: 0.0773s/iter; left time: 347.3340s
	iters: 300, epoch: 21 | loss: 0.0004590
	speed: 0.0768s/iter; left time: 337.2033s
	iters: 400, epoch: 21 | loss: 0.0273268
	speed: 0.0778s/iter; left time: 333.8120s
Epoch: 21 cost time: 36.58280658721924
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0056106
	speed: 0.2973s/iter; left time: 1225.6703s
	iters: 200, epoch: 22 | loss: 0.0007369
	speed: 0.0773s/iter; left time: 311.0452s
	iters: 300, epoch: 22 | loss: 0.2592177
	speed: 0.0772s/iter; left time: 302.6245s
	iters: 400, epoch: 22 | loss: 0.0004556
	speed: 0.0774s/iter; left time: 295.9577s
Epoch: 22 cost time: 36.65462923049927
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000488
	speed: 0.3012s/iter; left time: 1100.3556s
	iters: 200, epoch: 23 | loss: 0.0002278
	speed: 0.0771s/iter; left time: 274.0640s
	iters: 300, epoch: 23 | loss: 0.0012410
	speed: 0.0771s/iter; left time: 266.0593s
	iters: 400, epoch: 23 | loss: 0.0002675
	speed: 0.0661s/iter; left time: 221.6379s
Epoch: 23 cost time: 34.65558981895447
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0001772
	speed: 0.2572s/iter; left time: 819.0699s
	iters: 200, epoch: 24 | loss: 0.0012833
	speed: 0.0654s/iter; left time: 201.8235s
	iters: 300, epoch: 24 | loss: 0.0010160
	speed: 0.0662s/iter; left time: 197.6672s
	iters: 400, epoch: 24 | loss: 0.0001055
	speed: 0.0663s/iter; left time: 191.1640s
Epoch: 24 cost time: 31.28218126296997
Epoch: 24, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0013019
	speed: 0.2587s/iter; left time: 702.3426s
	iters: 200, epoch: 25 | loss: 0.0019844
	speed: 0.0688s/iter; left time: 179.7829s
	iters: 300, epoch: 25 | loss: 0.0016349
	speed: 0.0672s/iter; left time: 168.9169s
	iters: 400, epoch: 25 | loss: 0.0002770
	speed: 0.0672s/iter; left time: 162.3509s
Epoch: 25 cost time: 32.058034896850586
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000756
	speed: 0.2551s/iter; left time: 573.0100s
	iters: 200, epoch: 26 | loss: 0.0003499
	speed: 0.0667s/iter; left time: 143.1087s
	iters: 300, epoch: 26 | loss: 0.0002027
	speed: 0.0657s/iter; left time: 134.3799s
	iters: 400, epoch: 26 | loss: 0.0002674
	speed: 0.0659s/iter; left time: 128.3253s
Epoch: 26 cost time: 31.428126096725464
Epoch: 26, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0008512
	speed: 0.2590s/iter; left time: 460.2919s
	iters: 200, epoch: 27 | loss: 0.0004852
	speed: 0.0671s/iter; left time: 112.5975s
	iters: 300, epoch: 27 | loss: 0.0001053
	speed: 0.0678s/iter; left time: 106.8566s
	iters: 400, epoch: 27 | loss: 0.0077540
	speed: 0.0677s/iter; left time: 99.9489s
Epoch: 27 cost time: 31.86726951599121
Epoch: 27, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000360
	speed: 0.2637s/iter; left time: 344.9509s
	iters: 200, epoch: 28 | loss: 0.0000286
	speed: 0.0772s/iter; left time: 93.2658s
	iters: 300, epoch: 28 | loss: 0.0001307
	speed: 0.0775s/iter; left time: 85.8761s
	iters: 400, epoch: 28 | loss: 0.0128309
	speed: 0.0770s/iter; left time: 77.6356s
Epoch: 28 cost time: 36.490681171417236
Epoch: 28, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0002069
	speed: 0.3014s/iter; left time: 252.8558s
	iters: 200, epoch: 29 | loss: 0.0000523
	speed: 0.0775s/iter; left time: 57.2710s
	iters: 300, epoch: 29 | loss: 0.0002045
	speed: 0.0768s/iter; left time: 49.0474s
	iters: 400, epoch: 29 | loss: 0.0006358
	speed: 0.0772s/iter; left time: 41.5914s
Epoch: 29 cost time: 36.52119731903076
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979130 --> -0.982847).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000413
	speed: 0.3044s/iter; left time: 112.6333s
	iters: 200, epoch: 30 | loss: 0.0007275
	speed: 0.0770s/iter; left time: 20.7940s
	iters: 300, epoch: 30 | loss: 0.0009227
	speed: 0.0773s/iter; left time: 13.1443s
	iters: 400, epoch: 30 | loss: 0.0001429
	speed: 0.0769s/iter; left time: 5.3843s
Epoch: 30 cost time: 36.518359899520874
Epoch: 30, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 9379850
model size : 37.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7882586
	speed: 0.0546s/iter; left time: 762.5493s
	iters: 200, epoch: 1 | loss: 0.3171521
	speed: 0.0407s/iter; left time: 564.2166s
	iters: 300, epoch: 1 | loss: 0.1415052
	speed: 0.0355s/iter; left time: 488.3363s
	iters: 400, epoch: 1 | loss: 0.2807827
	speed: 0.0356s/iter; left time: 487.3200s
Epoch: 1 cost time: 19.113372325897217
Epoch: 1, Steps: 469 | Train Loss: 0.518 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (inf --> -0.963406).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0194358
	speed: 0.1520s/iter; left time: 2052.9079s
	iters: 200, epoch: 2 | loss: 0.0324868
	speed: 0.0391s/iter; left time: 523.9532s
	iters: 300, epoch: 2 | loss: 0.1665970
	speed: 0.0371s/iter; left time: 493.4536s
	iters: 400, epoch: 2 | loss: 0.0983979
	speed: 0.0383s/iter; left time: 505.5986s
Epoch: 2 cost time: 18.395439863204956
Epoch: 2, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.963406 --> -0.967981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0013583
	speed: 0.1540s/iter; left time: 2006.6099s
	iters: 200, epoch: 3 | loss: 0.0310480
	speed: 0.0394s/iter; left time: 509.9136s
	iters: 300, epoch: 3 | loss: 0.0148159
	speed: 0.0390s/iter; left time: 500.1169s
	iters: 400, epoch: 3 | loss: 0.2264317
	speed: 0.0398s/iter; left time: 506.4654s
Epoch: 3 cost time: 18.7310311794281
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3080974
	speed: 0.1518s/iter; left time: 1906.7343s
	iters: 200, epoch: 4 | loss: 0.3082960
	speed: 0.0383s/iter; left time: 477.4759s
	iters: 300, epoch: 4 | loss: 0.0074870
	speed: 0.0361s/iter; left time: 446.5633s
	iters: 400, epoch: 4 | loss: 0.0030165
	speed: 0.0426s/iter; left time: 522.9547s
Epoch: 4 cost time: 18.259000539779663
Epoch: 4, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0060340
	speed: 0.1547s/iter; left time: 1871.3428s
	iters: 200, epoch: 5 | loss: 0.0006950
	speed: 0.0388s/iter; left time: 465.7297s
	iters: 300, epoch: 5 | loss: 0.0070065
	speed: 0.0376s/iter; left time: 446.8576s
	iters: 400, epoch: 5 | loss: 0.0050593
	speed: 0.0379s/iter; left time: 447.0054s
Epoch: 5 cost time: 18.098983764648438
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0024356
	speed: 0.1559s/iter; left time: 1811.9267s
	iters: 200, epoch: 6 | loss: 0.0011496
	speed: 0.0450s/iter; left time: 518.1125s
	iters: 300, epoch: 6 | loss: 0.0027821
	speed: 0.0442s/iter; left time: 504.8327s
	iters: 400, epoch: 6 | loss: 0.0285345
	speed: 0.0396s/iter; left time: 448.6206s
Epoch: 6 cost time: 20.152520895004272
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0006110
	speed: 0.1588s/iter; left time: 1771.6757s
	iters: 200, epoch: 7 | loss: 0.0045586
	speed: 0.0419s/iter; left time: 463.6462s
	iters: 300, epoch: 7 | loss: 0.4939996
	speed: 0.0415s/iter; left time: 454.8048s
	iters: 400, epoch: 7 | loss: 0.0007219
	speed: 0.0446s/iter; left time: 484.5300s
Epoch: 7 cost time: 20.433475255966187
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0002536
	speed: 0.1725s/iter; left time: 1843.4779s
	iters: 200, epoch: 8 | loss: 0.0016978
	speed: 0.0427s/iter; left time: 452.0453s
	iters: 300, epoch: 8 | loss: 0.0098431
	speed: 0.0420s/iter; left time: 440.7572s
	iters: 400, epoch: 8 | loss: 0.0004044
	speed: 0.0429s/iter; left time: 446.0707s
Epoch: 8 cost time: 20.370492696762085
Epoch: 8, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.967981 --> -0.969410).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0022243
	speed: 0.1672s/iter; left time: 1708.4088s
	iters: 200, epoch: 9 | loss: 0.0117353
	speed: 0.0423s/iter; left time: 428.4296s
	iters: 300, epoch: 9 | loss: 0.0058516
	speed: 0.0444s/iter; left time: 444.4183s
	iters: 400, epoch: 9 | loss: 0.0054330
	speed: 0.0469s/iter; left time: 464.8031s
Epoch: 9 cost time: 21.335307121276855
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.970268).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0022491
	speed: 0.1746s/iter; left time: 1702.1817s
	iters: 200, epoch: 10 | loss: 0.0013531
	speed: 0.0433s/iter; left time: 417.4781s
	iters: 300, epoch: 10 | loss: 0.0010183
	speed: 0.0435s/iter; left time: 415.0950s
	iters: 400, epoch: 10 | loss: 0.0013556
	speed: 0.0433s/iter; left time: 409.4768s
Epoch: 10 cost time: 21.049617767333984
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
Validation loss decreased (-0.970268 --> -0.973984).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0088915
	speed: 0.1725s/iter; left time: 1601.0880s
	iters: 200, epoch: 11 | loss: 0.0008255
	speed: 0.0423s/iter; left time: 388.4595s
	iters: 300, epoch: 11 | loss: 0.0019413
	speed: 0.0422s/iter; left time: 383.5889s
	iters: 400, epoch: 11 | loss: 0.2565076
	speed: 0.0422s/iter; left time: 379.1167s
Epoch: 11 cost time: 20.090543508529663
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
Validation loss decreased (-0.973984 --> -0.977701).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004526
	speed: 0.1525s/iter; left time: 1343.9920s
	iters: 200, epoch: 12 | loss: 0.0009300
	speed: 0.0394s/iter; left time: 343.6372s
	iters: 300, epoch: 12 | loss: 0.0049525
	speed: 0.0397s/iter; left time: 341.5562s
	iters: 400, epoch: 12 | loss: 0.0004005
	speed: 0.0392s/iter; left time: 333.7100s
Epoch: 12 cost time: 18.752196311950684
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0007314
	speed: 0.1560s/iter; left time: 1301.4746s
	iters: 200, epoch: 13 | loss: 0.0024434
	speed: 0.0392s/iter; left time: 322.8457s
	iters: 300, epoch: 13 | loss: 0.0004466
	speed: 0.0387s/iter; left time: 315.4370s
	iters: 400, epoch: 13 | loss: 0.0778858
	speed: 0.0404s/iter; left time: 325.2757s
Epoch: 13 cost time: 18.80720591545105
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0015176
	speed: 0.1568s/iter; left time: 1234.3874s
	iters: 200, epoch: 14 | loss: 0.0137929
	speed: 0.0416s/iter; left time: 323.4192s
	iters: 300, epoch: 14 | loss: 0.0005184
	speed: 0.0440s/iter; left time: 337.3467s
	iters: 400, epoch: 14 | loss: 0.0004022
	speed: 0.0358s/iter; left time: 271.3735s
Epoch: 14 cost time: 19.125545740127563
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.977701 --> -0.981131).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000833
	speed: 0.1536s/iter; left time: 1137.1152s
	iters: 200, epoch: 15 | loss: 0.0071490
	speed: 0.0387s/iter; left time: 282.9994s
	iters: 300, epoch: 15 | loss: 0.0008188
	speed: 0.0391s/iter; left time: 281.8795s
	iters: 400, epoch: 15 | loss: 0.0255278
	speed: 0.0389s/iter; left time: 276.4748s
Epoch: 15 cost time: 18.57524609565735
Epoch: 15, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0008116
	speed: 0.1537s/iter; left time: 1065.9462s
	iters: 200, epoch: 16 | loss: 0.0001022
	speed: 0.0398s/iter; left time: 271.8776s
	iters: 300, epoch: 16 | loss: 0.0004964
	speed: 0.0408s/iter; left time: 275.0834s
	iters: 400, epoch: 16 | loss: 0.0003586
	speed: 0.0394s/iter; left time: 261.3486s
Epoch: 16 cost time: 19.182258129119873
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0015720
	speed: 0.1559s/iter; left time: 1008.3128s
	iters: 200, epoch: 17 | loss: 0.0010857
	speed: 0.0395s/iter; left time: 251.3606s
	iters: 300, epoch: 17 | loss: 0.0000489
	speed: 0.0441s/iter; left time: 276.2635s
	iters: 400, epoch: 17 | loss: 0.0533778
	speed: 0.0430s/iter; left time: 264.9951s
Epoch: 17 cost time: 19.83013153076172
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0011029
	speed: 0.1705s/iter; left time: 1022.7328s
	iters: 200, epoch: 18 | loss: 0.0001939
	speed: 0.0475s/iter; left time: 279.9821s
	iters: 300, epoch: 18 | loss: 0.0011706
	speed: 0.0473s/iter; left time: 274.4247s
	iters: 400, epoch: 18 | loss: 0.0001178
	speed: 0.0476s/iter; left time: 271.4942s
Epoch: 18 cost time: 22.412143230438232
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0004046
	speed: 0.1651s/iter; left time: 912.8465s
	iters: 200, epoch: 19 | loss: 0.0001365
	speed: 0.0429s/iter; left time: 232.6790s
	iters: 300, epoch: 19 | loss: 0.0001755
	speed: 0.0411s/iter; left time: 219.2639s
	iters: 400, epoch: 19 | loss: 0.0061876
	speed: 0.0419s/iter; left time: 219.2225s
Epoch: 19 cost time: 20.1739661693573
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000975
	speed: 0.1630s/iter; left time: 824.8209s
	iters: 200, epoch: 20 | loss: 0.0004621
	speed: 0.0415s/iter; left time: 205.7647s
	iters: 300, epoch: 20 | loss: 0.0007082
	speed: 0.0416s/iter; left time: 201.9453s
	iters: 400, epoch: 20 | loss: 0.0153120
	speed: 0.0425s/iter; left time: 202.4978s
Epoch: 20 cost time: 19.89879560470581
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0003887
	speed: 0.1589s/iter; left time: 729.4392s
	iters: 200, epoch: 21 | loss: 0.0004923
	speed: 0.0405s/iter; left time: 181.7112s
	iters: 300, epoch: 21 | loss: 0.0029240
	speed: 0.0411s/iter; left time: 180.5274s
	iters: 400, epoch: 21 | loss: 0.0130914
	speed: 0.0412s/iter; left time: 176.6670s
Epoch: 21 cost time: 19.5193190574646
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0001417
	speed: 0.1609s/iter; left time: 663.0840s
	iters: 200, epoch: 22 | loss: 0.0011193
	speed: 0.0429s/iter; left time: 172.6291s
	iters: 300, epoch: 22 | loss: 0.0006231
	speed: 0.0398s/iter; left time: 156.2722s
	iters: 400, epoch: 22 | loss: 0.0000995
	speed: 0.0396s/iter; left time: 151.1630s
Epoch: 22 cost time: 19.312455415725708
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0004261
	speed: 0.1528s/iter; left time: 558.0340s
	iters: 200, epoch: 23 | loss: 0.0007764
	speed: 0.0390s/iter; left time: 138.6592s
	iters: 300, epoch: 23 | loss: 0.0003407
	speed: 0.0390s/iter; left time: 134.5846s
	iters: 400, epoch: 23 | loss: 0.0002452
	speed: 0.0391s/iter; left time: 131.1853s
Epoch: 23 cost time: 18.3085515499115
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000816
	speed: 0.1557s/iter; left time: 495.8326s
	iters: 200, epoch: 24 | loss: 0.0071124
	speed: 0.0391s/iter; left time: 120.5148s
	iters: 300, epoch: 24 | loss: 0.0002801
	speed: 0.0384s/iter; left time: 114.4952s
	iters: 400, epoch: 24 | loss: 0.0244386
	speed: 0.0408s/iter; left time: 117.6458s
Epoch: 24 cost time: 18.738417625427246
Epoch: 24, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 2759946
model size : 11.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9856110
	speed: 0.0535s/iter; left time: 747.5475s
	iters: 200, epoch: 1 | loss: 0.2580395
	speed: 0.0403s/iter; left time: 559.6593s
	iters: 300, epoch: 1 | loss: 0.2209082
	speed: 0.0402s/iter; left time: 554.0732s
	iters: 400, epoch: 1 | loss: 0.0502453
	speed: 0.0404s/iter; left time: 552.4986s
Epoch: 1 cost time: 20.300737142562866
Epoch: 1, Steps: 469 | Train Loss: 0.550 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
Validation loss decreased (inf --> -0.968838).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0799663
	speed: 0.1684s/iter; left time: 2274.0860s
	iters: 200, epoch: 2 | loss: 0.3791744
	speed: 0.0404s/iter; left time: 541.2378s
	iters: 300, epoch: 2 | loss: 0.3996881
	speed: 0.0403s/iter; left time: 536.4268s
	iters: 400, epoch: 2 | loss: 0.0501404
	speed: 0.0409s/iter; left time: 539.6416s
Epoch: 2 cost time: 19.360326766967773
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0089201
	speed: 0.1734s/iter; left time: 2259.7679s
	iters: 200, epoch: 3 | loss: 0.1117978
	speed: 0.0417s/iter; left time: 539.8973s
	iters: 300, epoch: 3 | loss: 0.0114781
	speed: 0.0401s/iter; left time: 514.4509s
	iters: 400, epoch: 3 | loss: 0.1215764
	speed: 0.0401s/iter; left time: 510.3957s
Epoch: 3 cost time: 19.288841724395752
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.968838 --> -0.975700).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0040275
	speed: 0.1917s/iter; left time: 2407.9403s
	iters: 200, epoch: 4 | loss: 0.0449120
	speed: 0.0480s/iter; left time: 598.6291s
	iters: 300, epoch: 4 | loss: 0.3081346
	speed: 0.0473s/iter; left time: 585.1723s
	iters: 400, epoch: 4 | loss: 0.0050213
	speed: 0.0475s/iter; left time: 582.5070s
Epoch: 4 cost time: 22.703832149505615
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0184207
	speed: 0.1964s/iter; left time: 2375.9815s
	iters: 200, epoch: 5 | loss: 0.0085408
	speed: 0.0481s/iter; left time: 576.8687s
	iters: 300, epoch: 5 | loss: 0.1147260
	speed: 0.0474s/iter; left time: 563.2964s
	iters: 400, epoch: 5 | loss: 0.0159165
	speed: 0.0475s/iter; left time: 560.2590s
Epoch: 5 cost time: 22.5798659324646
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0012500
	speed: 0.1987s/iter; left time: 2310.4326s
	iters: 200, epoch: 6 | loss: 0.0208746
	speed: 0.0476s/iter; left time: 548.8300s
	iters: 300, epoch: 6 | loss: 0.0029097
	speed: 0.0471s/iter; left time: 538.5655s
	iters: 400, epoch: 6 | loss: 0.0498519
	speed: 0.0469s/iter; left time: 531.4541s
Epoch: 6 cost time: 22.50748062133789
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0007568
	speed: 0.1993s/iter; left time: 2223.9147s
	iters: 200, epoch: 7 | loss: 0.0007309
	speed: 0.0473s/iter; left time: 523.3155s
	iters: 300, epoch: 7 | loss: 0.0016424
	speed: 0.0470s/iter; left time: 515.0920s
	iters: 400, epoch: 7 | loss: 0.0015946
	speed: 0.0473s/iter; left time: 513.2653s
Epoch: 7 cost time: 22.500160217285156
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0927546
	speed: 0.1947s/iter; left time: 2081.1853s
	iters: 200, epoch: 8 | loss: 0.0001620
	speed: 0.0472s/iter; left time: 499.7531s
	iters: 300, epoch: 8 | loss: 0.0062253
	speed: 0.0473s/iter; left time: 495.9912s
	iters: 400, epoch: 8 | loss: 0.2290969
	speed: 0.0474s/iter; left time: 491.9813s
Epoch: 8 cost time: 22.401942491531372
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0014127
	speed: 0.1775s/iter; left time: 1814.1947s
	iters: 200, epoch: 9 | loss: 0.0093651
	speed: 0.0400s/iter; left time: 404.3702s
	iters: 300, epoch: 9 | loss: 0.2973873
	speed: 0.0399s/iter; left time: 400.0320s
	iters: 400, epoch: 9 | loss: 0.0144431
	speed: 0.0408s/iter; left time: 404.7159s
Epoch: 9 cost time: 19.279305696487427
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0006646
	speed: 0.1756s/iter; left time: 1712.3236s
	iters: 200, epoch: 10 | loss: 0.0018210
	speed: 0.0412s/iter; left time: 397.1264s
	iters: 300, epoch: 10 | loss: 0.0067131
	speed: 0.0416s/iter; left time: 397.0421s
	iters: 400, epoch: 10 | loss: 0.0005059
	speed: 0.0400s/iter; left time: 378.0676s
Epoch: 10 cost time: 19.357696294784546
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975700 --> -0.975985).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0023447
	speed: 0.1765s/iter; left time: 1637.7270s
	iters: 200, epoch: 11 | loss: 0.0067231
	speed: 0.0397s/iter; left time: 364.5373s
	iters: 300, epoch: 11 | loss: 0.0904733
	speed: 0.0405s/iter; left time: 367.3462s
	iters: 400, epoch: 11 | loss: 0.0056651
	speed: 0.0402s/iter; left time: 361.1450s
Epoch: 11 cost time: 19.20800018310547
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0372595
	speed: 0.1655s/iter; left time: 1458.6129s
	iters: 200, epoch: 12 | loss: 0.0002551
	speed: 0.0406s/iter; left time: 353.5640s
	iters: 300, epoch: 12 | loss: 0.0021363
	speed: 0.0403s/iter; left time: 346.7294s
	iters: 400, epoch: 12 | loss: 0.1417535
	speed: 0.0406s/iter; left time: 345.3947s
Epoch: 12 cost time: 19.253299951553345
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0535334
	speed: 0.1751s/iter; left time: 1461.1949s
	iters: 200, epoch: 13 | loss: 0.0003682
	speed: 0.0391s/iter; left time: 322.4186s
	iters: 300, epoch: 13 | loss: 0.0018739
	speed: 0.0402s/iter; left time: 326.9714s
	iters: 400, epoch: 13 | loss: 0.0472624
	speed: 0.0408s/iter; left time: 328.5089s
Epoch: 13 cost time: 19.104287147521973
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0003684
	speed: 0.1711s/iter; left time: 1347.5792s
	iters: 200, epoch: 14 | loss: 0.0003514
	speed: 0.0408s/iter; left time: 316.8626s
	iters: 300, epoch: 14 | loss: 0.0020013
	speed: 0.0409s/iter; left time: 313.9627s
	iters: 400, epoch: 14 | loss: 0.0117402
	speed: 0.0409s/iter; left time: 309.8711s
Epoch: 14 cost time: 19.42153024673462
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.248 Vali Acc: 0.949 Test Loss: 0.248 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0012534
	speed: 0.1698s/iter; left time: 1257.2435s
	iters: 200, epoch: 15 | loss: 0.0074939
	speed: 0.0404s/iter; left time: 295.3594s
	iters: 300, epoch: 15 | loss: 0.0026986
	speed: 0.0431s/iter; left time: 310.2841s
	iters: 400, epoch: 15 | loss: 0.0007527
	speed: 0.0434s/iter; left time: 308.6184s
Epoch: 15 cost time: 19.829189777374268
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0001222
	speed: 0.1772s/iter; left time: 1228.7743s
	iters: 200, epoch: 16 | loss: 0.0002581
	speed: 0.0407s/iter; left time: 278.2787s
	iters: 300, epoch: 16 | loss: 0.0180525
	speed: 0.0416s/iter; left time: 280.0127s
	iters: 400, epoch: 16 | loss: 0.1221535
	speed: 0.0417s/iter; left time: 276.5820s
Epoch: 16 cost time: 19.64687156677246
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000883
	speed: 0.1764s/iter; left time: 1140.5065s
	iters: 200, epoch: 17 | loss: 0.0037577
	speed: 0.0427s/iter; left time: 271.7891s
	iters: 300, epoch: 17 | loss: 0.0002874
	speed: 0.0424s/iter; left time: 265.5385s
	iters: 400, epoch: 17 | loss: 0.0000789
	speed: 0.0419s/iter; left time: 258.4187s
Epoch: 17 cost time: 20.157346487045288
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0002915
	speed: 0.1631s/iter; left time: 978.0687s
	iters: 200, epoch: 18 | loss: 0.0045200
	speed: 0.0270s/iter; left time: 159.2928s
	iters: 300, epoch: 18 | loss: 0.0021372
	speed: 0.0271s/iter; left time: 157.0558s
	iters: 400, epoch: 18 | loss: 0.0013734
	speed: 0.0281s/iter; left time: 160.2260s
Epoch: 18 cost time: 13.448395013809204
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0039667
	speed: 0.1171s/iter; left time: 647.5954s
	iters: 200, epoch: 19 | loss: 0.0009225
	speed: 0.0325s/iter; left time: 176.3877s
	iters: 300, epoch: 19 | loss: 0.0063813
	speed: 0.0325s/iter; left time: 173.1146s
	iters: 400, epoch: 19 | loss: 0.0003003
	speed: 0.0324s/iter; left time: 169.4086s
Epoch: 19 cost time: 15.680394649505615
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977129).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001447
	speed: 0.1316s/iter; left time: 665.8642s
	iters: 200, epoch: 20 | loss: 0.0014564
	speed: 0.0316s/iter; left time: 156.9082s
	iters: 300, epoch: 20 | loss: 0.0017192
	speed: 0.0336s/iter; left time: 163.4490s
	iters: 400, epoch: 20 | loss: 0.0094376
	speed: 0.0372s/iter; left time: 177.0286s
Epoch: 20 cost time: 16.113848209381104
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0055810
	speed: 0.1281s/iter; left time: 588.2271s
	iters: 200, epoch: 21 | loss: 0.0000329
	speed: 0.0325s/iter; left time: 146.0925s
	iters: 300, epoch: 21 | loss: 0.0012975
	speed: 0.0323s/iter; left time: 141.9070s
	iters: 400, epoch: 21 | loss: 0.0002951
	speed: 0.0326s/iter; left time: 140.0958s
Epoch: 21 cost time: 15.58424687385559
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0002846
	speed: 0.1275s/iter; left time: 525.5220s
	iters: 200, epoch: 22 | loss: 0.0022295
	speed: 0.0324s/iter; left time: 130.4985s
	iters: 300, epoch: 22 | loss: 0.0002263
	speed: 0.0345s/iter; left time: 135.3976s
	iters: 400, epoch: 22 | loss: 0.0010324
	speed: 0.0373s/iter; left time: 142.3925s
Epoch: 22 cost time: 16.61921453475952
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978844).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0046620
	speed: 0.1332s/iter; left time: 486.6093s
	iters: 200, epoch: 23 | loss: 0.0306916
	speed: 0.0340s/iter; left time: 120.7535s
	iters: 300, epoch: 23 | loss: 0.0003847
	speed: 0.0334s/iter; left time: 115.3176s
	iters: 400, epoch: 23 | loss: 0.0001933
	speed: 0.0331s/iter; left time: 111.1264s
Epoch: 23 cost time: 16.01864719390869
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0003294
	speed: 0.1196s/iter; left time: 380.7353s
	iters: 200, epoch: 24 | loss: 0.0036717
	speed: 0.0301s/iter; left time: 92.8232s
	iters: 300, epoch: 24 | loss: 0.1727364
	speed: 0.0304s/iter; left time: 90.7425s
	iters: 400, epoch: 24 | loss: 0.0001009
	speed: 0.0300s/iter; left time: 86.4035s
Epoch: 24 cost time: 14.509702205657959
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0003938
	speed: 0.1218s/iter; left time: 330.6494s
	iters: 200, epoch: 25 | loss: 0.0004692
	speed: 0.0311s/iter; left time: 81.3873s
	iters: 300, epoch: 25 | loss: 0.0284605
	speed: 0.0314s/iter; left time: 78.9741s
	iters: 400, epoch: 25 | loss: 0.0014351
	speed: 0.0299s/iter; left time: 72.1908s
Epoch: 25 cost time: 14.792309761047363
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0029993
	speed: 0.1205s/iter; left time: 270.6437s
	iters: 200, epoch: 26 | loss: 0.0003719
	speed: 0.0296s/iter; left time: 63.4265s
	iters: 300, epoch: 26 | loss: 0.0001810
	speed: 0.0315s/iter; left time: 64.4715s
	iters: 400, epoch: 26 | loss: 0.0002165
	speed: 0.0315s/iter; left time: 61.2400s
Epoch: 26 cost time: 14.89959979057312
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000813
	speed: 0.1219s/iter; left time: 216.5645s
	iters: 200, epoch: 27 | loss: 0.0011401
	speed: 0.0313s/iter; left time: 52.4435s
	iters: 300, epoch: 27 | loss: 0.2587849
	speed: 0.0314s/iter; left time: 49.5579s
	iters: 400, epoch: 27 | loss: 0.0016170
	speed: 0.0312s/iter; left time: 46.0632s
Epoch: 27 cost time: 15.028823852539062
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0003267
	speed: 0.1237s/iter; left time: 161.7543s
	iters: 200, epoch: 28 | loss: 0.1512760
	speed: 0.0314s/iter; left time: 37.9599s
	iters: 300, epoch: 28 | loss: 0.0003944
	speed: 0.0311s/iter; left time: 34.4865s
	iters: 400, epoch: 28 | loss: 0.0959704
	speed: 0.0309s/iter; left time: 31.1760s
Epoch: 28 cost time: 15.086833715438843
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0014139
	speed: 0.1281s/iter; left time: 107.4696s
	iters: 200, epoch: 29 | loss: 0.0003187
	speed: 0.0333s/iter; left time: 24.6381s
	iters: 300, epoch: 29 | loss: 0.0072522
	speed: 0.0327s/iter; left time: 20.9033s
	iters: 400, epoch: 29 | loss: 0.0010531
	speed: 0.0319s/iter; left time: 17.1879s
Epoch: 29 cost time: 15.996907949447632
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0002558
	speed: 0.1270s/iter; left time: 46.9972s
	iters: 200, epoch: 30 | loss: 0.0001729
	speed: 0.0335s/iter; left time: 9.0334s
	iters: 300, epoch: 30 | loss: 0.0003239
	speed: 0.0329s/iter; left time: 5.5895s
	iters: 400, epoch: 30 | loss: 0.0021487
	speed: 0.0325s/iter; left time: 2.2721s
Epoch: 30 cost time: 15.928340435028076
Epoch: 30, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 9379850
model size : 37.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9060459
	speed: 0.0312s/iter; left time: 435.7956s
	iters: 200, epoch: 1 | loss: 0.4014742
	speed: 0.0232s/iter; left time: 321.2108s
	iters: 300, epoch: 1 | loss: 0.2276401
	speed: 0.0231s/iter; left time: 317.4525s
	iters: 400, epoch: 1 | loss: 0.2589979
	speed: 0.0230s/iter; left time: 314.7133s
Epoch: 1 cost time: 11.780746936798096
Epoch: 1, Steps: 469 | Train Loss: 0.582 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
Validation loss decreased (inf --> -0.952829).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0330201
	speed: 0.0800s/iter; left time: 1080.6080s
	iters: 200, epoch: 2 | loss: 0.0720313
	speed: 0.0228s/iter; left time: 305.0305s
	iters: 300, epoch: 2 | loss: 0.1715171
	speed: 0.0227s/iter; left time: 301.3770s
	iters: 400, epoch: 2 | loss: 0.0828696
	speed: 0.0235s/iter; left time: 310.7237s
Epoch: 2 cost time: 10.854862213134766
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.952829 --> -0.967123).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0023324
	speed: 0.0828s/iter; left time: 1078.9841s
	iters: 200, epoch: 3 | loss: 0.0133139
	speed: 0.0239s/iter; left time: 309.0519s
	iters: 300, epoch: 3 | loss: 0.0035253
	speed: 0.0224s/iter; left time: 287.5728s
	iters: 400, epoch: 3 | loss: 0.1458319
	speed: 0.0232s/iter; left time: 295.5818s
Epoch: 3 cost time: 11.213049173355103
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.967123 --> -0.972841).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4096792
	speed: 0.0835s/iter; left time: 1048.7486s
	iters: 200, epoch: 4 | loss: 0.1415020
	speed: 0.0206s/iter; left time: 256.9419s
	iters: 300, epoch: 4 | loss: 0.0126993
	speed: 0.0242s/iter; left time: 299.0156s
	iters: 400, epoch: 4 | loss: 0.0204748
	speed: 0.0237s/iter; left time: 290.9817s
Epoch: 4 cost time: 10.888578414916992
Epoch: 4, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0061966
	speed: 0.0844s/iter; left time: 1021.3831s
	iters: 200, epoch: 5 | loss: 0.0018938
	speed: 0.0232s/iter; left time: 278.3863s
	iters: 300, epoch: 5 | loss: 0.0109507
	speed: 0.0259s/iter; left time: 308.5796s
	iters: 400, epoch: 5 | loss: 0.0017636
	speed: 0.0227s/iter; left time: 267.9901s
Epoch: 5 cost time: 11.41880202293396
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0764724
	speed: 0.0801s/iter; left time: 930.8297s
	iters: 200, epoch: 6 | loss: 0.0013579
	speed: 0.0216s/iter; left time: 249.4095s
	iters: 300, epoch: 6 | loss: 0.0051609
	speed: 0.0219s/iter; left time: 250.3559s
	iters: 400, epoch: 6 | loss: 0.0224887
	speed: 0.0224s/iter; left time: 254.1182s
Epoch: 6 cost time: 10.545790910720825
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0012218
	speed: 0.0853s/iter; left time: 951.8036s
	iters: 200, epoch: 7 | loss: 0.0034069
	speed: 0.0223s/iter; left time: 246.2506s
	iters: 300, epoch: 7 | loss: 0.3700264
	speed: 0.0241s/iter; left time: 264.1723s
	iters: 400, epoch: 7 | loss: 0.0757936
	speed: 0.0235s/iter; left time: 255.1105s
Epoch: 7 cost time: 11.133916854858398
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.979130).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003876
	speed: 0.0850s/iter; left time: 908.7571s
	iters: 200, epoch: 8 | loss: 0.0006463
	speed: 0.0190s/iter; left time: 200.7454s
	iters: 300, epoch: 8 | loss: 0.0024627
	speed: 0.0199s/iter; left time: 208.3628s
	iters: 400, epoch: 8 | loss: 0.0002800
	speed: 0.0219s/iter; left time: 227.2167s
Epoch: 8 cost time: 10.228922843933105
Epoch: 8, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0268740
	speed: 0.0838s/iter; left time: 856.1536s
	iters: 200, epoch: 9 | loss: 0.0005655
	speed: 0.0234s/iter; left time: 237.1059s
	iters: 300, epoch: 9 | loss: 0.0067572
	speed: 0.0238s/iter; left time: 238.5560s
	iters: 400, epoch: 9 | loss: 0.0029690
	speed: 0.0234s/iter; left time: 232.3205s
Epoch: 9 cost time: 11.46465539932251
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979130 --> -0.983133).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0080187
	speed: 0.0810s/iter; left time: 790.1141s
	iters: 200, epoch: 10 | loss: 0.0018700
	speed: 0.0182s/iter; left time: 176.0037s
	iters: 300, epoch: 10 | loss: 0.0248803
	speed: 0.0180s/iter; left time: 171.4828s
	iters: 400, epoch: 10 | loss: 0.0325063
	speed: 0.0179s/iter; left time: 169.3025s
Epoch: 10 cost time: 9.1780264377594
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0054899
	speed: 0.0782s/iter; left time: 725.5976s
	iters: 200, epoch: 11 | loss: 0.0114016
	speed: 0.0226s/iter; left time: 207.7342s
	iters: 300, epoch: 11 | loss: 0.6360899
	speed: 0.0233s/iter; left time: 211.4155s
	iters: 400, epoch: 11 | loss: 0.0145231
	speed: 0.0224s/iter; left time: 200.9610s
Epoch: 11 cost time: 10.88177490234375
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0015223
	speed: 0.0803s/iter; left time: 707.5963s
	iters: 200, epoch: 12 | loss: 0.0024038
	speed: 0.0233s/iter; left time: 202.5653s
	iters: 300, epoch: 12 | loss: 0.0001855
	speed: 0.0226s/iter; left time: 194.3700s
	iters: 400, epoch: 12 | loss: 0.0002064
	speed: 0.0233s/iter; left time: 198.7257s
Epoch: 12 cost time: 11.022006750106812
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0002156
	speed: 0.0794s/iter; left time: 662.7794s
	iters: 200, epoch: 13 | loss: 0.0013214
	speed: 0.0241s/iter; left time: 198.9839s
	iters: 300, epoch: 13 | loss: 0.4277813
	speed: 0.0237s/iter; left time: 192.7671s
	iters: 400, epoch: 13 | loss: 0.8692757
	speed: 0.0241s/iter; left time: 193.8961s
Epoch: 13 cost time: 11.28250765800476
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0008783
	speed: 0.0801s/iter; left time: 630.8900s
	iters: 200, epoch: 14 | loss: 0.2522514
	speed: 0.0225s/iter; left time: 174.9030s
	iters: 300, epoch: 14 | loss: 0.0004456
	speed: 0.0232s/iter; left time: 178.0516s
	iters: 400, epoch: 14 | loss: 0.0012881
	speed: 0.0234s/iter; left time: 177.3155s
Epoch: 14 cost time: 11.00120234489441
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0010572
	speed: 0.0809s/iter; left time: 599.0742s
	iters: 200, epoch: 15 | loss: 0.0034442
	speed: 0.0231s/iter; left time: 168.7515s
	iters: 300, epoch: 15 | loss: 0.2114694
	speed: 0.0241s/iter; left time: 173.9894s
	iters: 400, epoch: 15 | loss: 0.0113636
	speed: 0.0224s/iter; left time: 159.0672s
Epoch: 15 cost time: 11.030505657196045
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0003042
	speed: 0.0846s/iter; left time: 586.8437s
	iters: 200, epoch: 16 | loss: 0.0001531
	speed: 0.0200s/iter; left time: 136.9074s
	iters: 300, epoch: 16 | loss: 0.0025421
	speed: 0.0233s/iter; left time: 157.2736s
	iters: 400, epoch: 16 | loss: 0.0001948
	speed: 0.0187s/iter; left time: 124.1478s
Epoch: 16 cost time: 10.5438392162323
Epoch: 16, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0252856
	speed: 0.0927s/iter; left time: 599.2853s
	iters: 200, epoch: 17 | loss: 0.0008820
	speed: 0.0253s/iter; left time: 160.9866s
	iters: 300, epoch: 17 | loss: 0.0003951
	speed: 0.0252s/iter; left time: 158.2107s
	iters: 400, epoch: 17 | loss: 0.0005836
	speed: 0.0236s/iter; left time: 145.2969s
Epoch: 17 cost time: 12.112633228302002
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.983133 --> -0.983704).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0240845
	speed: 0.0842s/iter; left time: 504.9893s
	iters: 200, epoch: 18 | loss: 0.0001979
	speed: 0.0212s/iter; left time: 124.8836s
	iters: 300, epoch: 18 | loss: 0.0001307
	speed: 0.0248s/iter; left time: 143.5111s
	iters: 400, epoch: 18 | loss: 0.0068812
	speed: 0.0251s/iter; left time: 143.2833s
Epoch: 18 cost time: 10.888729572296143
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0066054
	speed: 0.0776s/iter; left time: 429.2323s
	iters: 200, epoch: 19 | loss: 0.0003119
	speed: 0.0201s/iter; left time: 109.0648s
	iters: 300, epoch: 19 | loss: 0.0000938
	speed: 0.0188s/iter; left time: 100.4211s
	iters: 400, epoch: 19 | loss: 0.0007611
	speed: 0.0234s/iter; left time: 122.2065s
Epoch: 19 cost time: 10.002672910690308
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000791
	speed: 0.0764s/iter; left time: 386.6400s
	iters: 200, epoch: 20 | loss: 0.0000974
	speed: 0.0208s/iter; left time: 103.1836s
	iters: 300, epoch: 20 | loss: 0.0002131
	speed: 0.0242s/iter; left time: 117.8355s
	iters: 400, epoch: 20 | loss: 0.0004982
	speed: 0.0239s/iter; left time: 113.7511s
Epoch: 20 cost time: 10.803715705871582
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0013684
	speed: 0.0832s/iter; left time: 381.7748s
	iters: 200, epoch: 21 | loss: 0.0002846
	speed: 0.0228s/iter; left time: 102.2099s
	iters: 300, epoch: 21 | loss: 0.0008752
	speed: 0.0232s/iter; left time: 101.7620s
	iters: 400, epoch: 21 | loss: 0.0018937
	speed: 0.0226s/iter; left time: 96.7655s
Epoch: 21 cost time: 10.867091417312622
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0001817
	speed: 0.0742s/iter; left time: 306.0192s
	iters: 200, epoch: 22 | loss: 0.0007648
	speed: 0.0229s/iter; left time: 92.2616s
	iters: 300, epoch: 22 | loss: 0.0002680
	speed: 0.0228s/iter; left time: 89.4617s
	iters: 400, epoch: 22 | loss: 0.0001955
	speed: 0.0234s/iter; left time: 89.4182s
Epoch: 22 cost time: 10.70454216003418
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000493
	speed: 0.0837s/iter; left time: 305.6283s
	iters: 200, epoch: 23 | loss: 0.0001570
	speed: 0.0237s/iter; left time: 84.1540s
	iters: 300, epoch: 23 | loss: 0.0003079
	speed: 0.0232s/iter; left time: 80.1626s
	iters: 400, epoch: 23 | loss: 0.0002594
	speed: 0.0246s/iter; left time: 82.5041s
Epoch: 23 cost time: 11.617878198623657
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0006971
	speed: 0.0845s/iter; left time: 269.0161s
	iters: 200, epoch: 24 | loss: 0.0058365
	speed: 0.0184s/iter; left time: 56.8849s
	iters: 300, epoch: 24 | loss: 0.0000685
	speed: 0.0237s/iter; left time: 70.5809s
	iters: 400, epoch: 24 | loss: 0.0102020
	speed: 0.0228s/iter; left time: 65.8459s
Epoch: 24 cost time: 10.730441093444824
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0006746
	speed: 0.0847s/iter; left time: 229.9634s
	iters: 200, epoch: 25 | loss: 0.0035942
	speed: 0.0280s/iter; left time: 73.1858s
	iters: 300, epoch: 25 | loss: 0.0138738
	speed: 0.0273s/iter; left time: 68.5816s
	iters: 400, epoch: 25 | loss: 0.0001703
	speed: 0.0271s/iter; left time: 65.5332s
Epoch: 25 cost time: 12.987433195114136
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0002485
	speed: 0.0783s/iter; left time: 175.9385s
	iters: 200, epoch: 26 | loss: 0.0060844
	speed: 0.0154s/iter; left time: 33.1147s
	iters: 300, epoch: 26 | loss: 0.0002486
	speed: 0.0151s/iter; left time: 30.8322s
	iters: 400, epoch: 26 | loss: 0.0036637
	speed: 0.0152s/iter; left time: 29.5912s
Epoch: 26 cost time: 7.628676176071167
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0001646
	speed: 0.0782s/iter; left time: 139.0268s
	iters: 200, epoch: 27 | loss: 0.0002519
	speed: 0.0232s/iter; left time: 38.9706s
	iters: 300, epoch: 27 | loss: 0.0005494
	speed: 0.0228s/iter; left time: 35.9342s
	iters: 400, epoch: 27 | loss: 0.0001431
	speed: 0.0232s/iter; left time: 34.2778s
Epoch: 27 cost time: 11.312357902526855
Epoch: 27, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 2759946
model size : 11.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7898401
	speed: 0.0662s/iter; left time: 924.1990s
	iters: 200, epoch: 1 | loss: 0.2386902
	speed: 0.0532s/iter; left time: 738.0720s
	iters: 300, epoch: 1 | loss: 0.2102346
	speed: 0.0543s/iter; left time: 748.4328s
	iters: 400, epoch: 1 | loss: 0.0962392
	speed: 0.0557s/iter; left time: 761.7167s
Epoch: 1 cost time: 26.978691577911377
Epoch: 1, Steps: 469 | Train Loss: 0.533 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (inf --> -0.967409).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0096089
	speed: 0.2005s/iter; left time: 2707.4098s
	iters: 200, epoch: 2 | loss: 0.1076496
	speed: 0.0548s/iter; left time: 734.6746s
	iters: 300, epoch: 2 | loss: 0.0083982
	speed: 0.0541s/iter; left time: 720.2820s
	iters: 400, epoch: 2 | loss: 0.0076217
	speed: 0.0571s/iter; left time: 754.2138s
Epoch: 2 cost time: 26.348882913589478
Epoch: 2, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.967409 --> -0.971697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0057022
	speed: 0.2133s/iter; left time: 2779.9647s
	iters: 200, epoch: 3 | loss: 0.0855746
	speed: 0.0490s/iter; left time: 633.9010s
	iters: 300, epoch: 3 | loss: 0.0364721
	speed: 0.0484s/iter; left time: 620.5502s
	iters: 400, epoch: 3 | loss: 0.0978252
	speed: 0.0524s/iter; left time: 666.6009s
Epoch: 3 cost time: 24.887532711029053
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0057172
	speed: 0.2195s/iter; left time: 2758.2123s
	iters: 200, epoch: 4 | loss: 0.0191574
	speed: 0.0588s/iter; left time: 733.3289s
	iters: 300, epoch: 4 | loss: 0.0051884
	speed: 0.0575s/iter; left time: 711.0504s
	iters: 400, epoch: 4 | loss: 0.0207047
	speed: 0.0574s/iter; left time: 703.8444s
Epoch: 4 cost time: 27.94426131248474
Epoch: 4, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.971697 --> -0.979416).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0158577
	speed: 0.2124s/iter; left time: 2569.1290s
	iters: 200, epoch: 5 | loss: 0.0091733
	speed: 0.0583s/iter; left time: 699.0151s
	iters: 300, epoch: 5 | loss: 0.0421205
	speed: 0.0579s/iter; left time: 688.2191s
	iters: 400, epoch: 5 | loss: 0.0079420
	speed: 0.0555s/iter; left time: 654.3075s
Epoch: 5 cost time: 27.058121919631958
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.981131).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014170
	speed: 0.1966s/iter; left time: 2285.2016s
	iters: 200, epoch: 6 | loss: 0.0024592
	speed: 0.0552s/iter; left time: 636.0504s
	iters: 300, epoch: 6 | loss: 0.0011995
	speed: 0.0536s/iter; left time: 612.3533s
	iters: 400, epoch: 6 | loss: 0.0024844
	speed: 0.0450s/iter; left time: 510.0843s
Epoch: 6 cost time: 24.17009162902832
Epoch: 6, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1304827
	speed: 0.1878s/iter; left time: 2095.0251s
	iters: 200, epoch: 7 | loss: 0.0117648
	speed: 0.0460s/iter; left time: 508.1017s
	iters: 300, epoch: 7 | loss: 0.0022251
	speed: 0.0551s/iter; left time: 603.7559s
	iters: 400, epoch: 7 | loss: 0.0007822
	speed: 0.0524s/iter; left time: 568.5516s
Epoch: 7 cost time: 24.605186462402344
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0021037
	speed: 0.2002s/iter; left time: 2139.5707s
	iters: 200, epoch: 8 | loss: 0.0042782
	speed: 0.0582s/iter; left time: 615.9825s
	iters: 300, epoch: 8 | loss: 0.0020253
	speed: 0.0537s/iter; left time: 563.1132s
	iters: 400, epoch: 8 | loss: 0.0470730
	speed: 0.0575s/iter; left time: 597.5093s
Epoch: 8 cost time: 26.986358642578125
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002253
	speed: 0.2125s/iter; left time: 2171.6520s
	iters: 200, epoch: 9 | loss: 0.2275035
	speed: 0.0564s/iter; left time: 571.0960s
	iters: 300, epoch: 9 | loss: 0.0866961
	speed: 0.0571s/iter; left time: 572.3755s
	iters: 400, epoch: 9 | loss: 0.0042437
	speed: 0.0534s/iter; left time: 529.5072s
Epoch: 9 cost time: 26.10088014602661
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0005536
	speed: 0.2062s/iter; left time: 2010.7810s
	iters: 200, epoch: 10 | loss: 0.0005009
	speed: 0.0598s/iter; left time: 577.4456s
	iters: 300, epoch: 10 | loss: 0.1085131
	speed: 0.0592s/iter; left time: 565.2480s
	iters: 400, epoch: 10 | loss: 0.0008208
	speed: 0.0588s/iter; left time: 555.3131s
Epoch: 10 cost time: 27.973064184188843
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0374709
	speed: 0.2127s/iter; left time: 1973.8679s
	iters: 200, epoch: 11 | loss: 0.0005828
	speed: 0.0601s/iter; left time: 551.6066s
	iters: 300, epoch: 11 | loss: 0.0001245
	speed: 0.0602s/iter; left time: 546.6365s
	iters: 400, epoch: 11 | loss: 0.0007959
	speed: 0.0525s/iter; left time: 471.8472s
Epoch: 11 cost time: 26.985958337783813
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1055518
	speed: 0.1984s/iter; left time: 1747.9886s
	iters: 200, epoch: 12 | loss: 0.0034749
	speed: 0.0550s/iter; left time: 478.7616s
	iters: 300, epoch: 12 | loss: 0.0014489
	speed: 0.0533s/iter; left time: 459.0065s
	iters: 400, epoch: 12 | loss: 0.0007220
	speed: 0.0533s/iter; left time: 453.5702s
Epoch: 12 cost time: 25.665393114089966
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.981417 --> -0.983704).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0006762
	speed: 0.1961s/iter; left time: 1636.4021s
	iters: 200, epoch: 13 | loss: 0.0000873
	speed: 0.0530s/iter; left time: 436.8297s
	iters: 300, epoch: 13 | loss: 0.0004300
	speed: 0.0543s/iter; left time: 441.8633s
	iters: 400, epoch: 13 | loss: 0.0068839
	speed: 0.0543s/iter; left time: 436.4482s
Epoch: 13 cost time: 25.722997903823853
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0008097
	speed: 0.1974s/iter; left time: 1554.3984s
	iters: 200, epoch: 14 | loss: 0.0451421
	speed: 0.0531s/iter; left time: 413.1840s
	iters: 300, epoch: 14 | loss: 0.0006350
	speed: 0.0599s/iter; left time: 459.3428s
	iters: 400, epoch: 14 | loss: 0.0002504
	speed: 0.0560s/iter; left time: 424.3503s
Epoch: 14 cost time: 26.44683265686035
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0001349
	speed: 0.2118s/iter; left time: 1568.5555s
	iters: 200, epoch: 15 | loss: 0.0011422
	speed: 0.0602s/iter; left time: 439.6201s
	iters: 300, epoch: 15 | loss: 0.0006952
	speed: 0.0593s/iter; left time: 427.2870s
	iters: 400, epoch: 15 | loss: 0.0020017
	speed: 0.0579s/iter; left time: 411.1714s
Epoch: 15 cost time: 27.90980362892151
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.966 Test Loss: 0.174 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0001933
	speed: 0.2127s/iter; left time: 1475.3942s
	iters: 200, epoch: 16 | loss: 0.0022377
	speed: 0.0584s/iter; left time: 398.9768s
	iters: 300, epoch: 16 | loss: 0.2044483
	speed: 0.0592s/iter; left time: 398.9549s
	iters: 400, epoch: 16 | loss: 0.1101481
	speed: 0.0588s/iter; left time: 390.2191s
Epoch: 16 cost time: 27.906774282455444
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0001495
	speed: 0.2151s/iter; left time: 1390.9451s
	iters: 200, epoch: 17 | loss: 0.0009857
	speed: 0.0607s/iter; left time: 386.2474s
	iters: 300, epoch: 17 | loss: 0.0001635
	speed: 0.0529s/iter; left time: 331.2305s
	iters: 400, epoch: 17 | loss: 0.0000611
	speed: 0.0593s/iter; left time: 365.6078s
Epoch: 17 cost time: 27.43521213531494
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
Validation loss decreased (-0.983704 --> -0.986277).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0002515
	speed: 0.1982s/iter; left time: 1188.9621s
	iters: 200, epoch: 18 | loss: 0.0003235
	speed: 0.0557s/iter; left time: 328.3029s
	iters: 300, epoch: 18 | loss: 0.0002540
	speed: 0.0559s/iter; left time: 324.1898s
	iters: 400, epoch: 18 | loss: 0.0000994
	speed: 0.0541s/iter; left time: 308.4972s
Epoch: 18 cost time: 25.81249213218689
Epoch: 18, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0002602
	speed: 0.1951s/iter; left time: 1078.6728s
	iters: 200, epoch: 19 | loss: 0.0015496
	speed: 0.0549s/iter; left time: 297.9512s
	iters: 300, epoch: 19 | loss: 0.0017596
	speed: 0.0544s/iter; left time: 289.7410s
	iters: 400, epoch: 19 | loss: 0.0004414
	speed: 0.0514s/iter; left time: 268.7431s
Epoch: 19 cost time: 25.51153016090393
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0004617
	speed: 0.1968s/iter; left time: 995.8074s
	iters: 200, epoch: 20 | loss: 0.0000947
	speed: 0.0573s/iter; left time: 284.4260s
	iters: 300, epoch: 20 | loss: 0.0003663
	speed: 0.0567s/iter; left time: 275.5790s
	iters: 400, epoch: 20 | loss: 0.0154432
	speed: 0.0572s/iter; left time: 272.4906s
Epoch: 20 cost time: 26.911983013153076
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001199
	speed: 0.2100s/iter; left time: 964.2923s
	iters: 200, epoch: 21 | loss: 0.0003650
	speed: 0.0573s/iter; left time: 257.4827s
	iters: 300, epoch: 21 | loss: 0.0001401
	speed: 0.0564s/iter; left time: 247.5871s
	iters: 400, epoch: 21 | loss: 0.0000282
	speed: 0.0578s/iter; left time: 247.9937s
Epoch: 21 cost time: 27.009042978286743
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0113755
	speed: 0.2101s/iter; left time: 865.8716s
	iters: 200, epoch: 22 | loss: 0.0000684
	speed: 0.0593s/iter; left time: 238.3446s
	iters: 300, epoch: 22 | loss: 0.0000762
	speed: 0.0582s/iter; left time: 228.2140s
	iters: 400, epoch: 22 | loss: 0.0017083
	speed: 0.0579s/iter; left time: 221.2744s
Epoch: 22 cost time: 27.344620943069458
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0004758
	speed: 0.2128s/iter; left time: 777.3637s
	iters: 200, epoch: 23 | loss: 0.0001180
	speed: 0.0509s/iter; left time: 181.0143s
	iters: 300, epoch: 23 | loss: 0.0002445
	speed: 0.0549s/iter; left time: 189.6656s
	iters: 400, epoch: 23 | loss: 0.0008225
	speed: 0.0556s/iter; left time: 186.3508s
Epoch: 23 cost time: 26.09980344772339
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0002731
	speed: 0.1960s/iter; left time: 624.0959s
	iters: 200, epoch: 24 | loss: 0.0145880
	speed: 0.0529s/iter; left time: 163.2788s
	iters: 300, epoch: 24 | loss: 0.0001495
	speed: 0.0521s/iter; left time: 155.3798s
	iters: 400, epoch: 24 | loss: 0.0004391
	speed: 0.0526s/iter; left time: 151.6702s
Epoch: 24 cost time: 25.00134038925171
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000816
	speed: 0.1957s/iter; left time: 531.1975s
	iters: 200, epoch: 25 | loss: 0.0000645
	speed: 0.0555s/iter; left time: 145.0442s
	iters: 300, epoch: 25 | loss: 0.0000752
	speed: 0.0513s/iter; left time: 129.0179s
	iters: 400, epoch: 25 | loss: 0.0008905
	speed: 0.0544s/iter; left time: 131.3242s
Epoch: 25 cost time: 25.75941014289856
Epoch: 25, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0002523
	speed: 0.2045s/iter; left time: 459.2245s
	iters: 200, epoch: 26 | loss: 0.0007677
	speed: 0.0545s/iter; left time: 116.8870s
	iters: 300, epoch: 26 | loss: 0.0002333
	speed: 0.0554s/iter; left time: 113.3337s
	iters: 400, epoch: 26 | loss: 0.0000838
	speed: 0.0586s/iter; left time: 113.9525s
Epoch: 26 cost time: 26.96854257583618
Epoch: 26, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0001741
	speed: 0.2149s/iter; left time: 381.8815s
	iters: 200, epoch: 27 | loss: 0.0001159
	speed: 0.0579s/iter; left time: 97.0147s
	iters: 300, epoch: 27 | loss: 0.0160942
	speed: 0.0583s/iter; left time: 91.9136s
	iters: 400, epoch: 27 | loss: 0.0000493
	speed: 0.0570s/iter; left time: 84.1728s
Epoch: 27 cost time: 27.504811763763428
Epoch: 27, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 4693258
model size : 19.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7544488
	speed: 0.0563s/iter; left time: 786.3702s
	iters: 200, epoch: 1 | loss: 0.3621539
	speed: 0.0485s/iter; left time: 672.9283s
	iters: 300, epoch: 1 | loss: 0.2199399
	speed: 0.0451s/iter; left time: 621.6820s
	iters: 400, epoch: 1 | loss: 0.0659823
	speed: 0.0448s/iter; left time: 612.9380s
Epoch: 1 cost time: 22.737701654434204
Epoch: 1, Steps: 469 | Train Loss: 0.564 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (inf --> -0.950256).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0288065
	speed: 0.1415s/iter; left time: 1910.0945s
	iters: 200, epoch: 2 | loss: 0.3953777
	speed: 0.0384s/iter; left time: 514.1972s
	iters: 300, epoch: 2 | loss: 0.0272246
	speed: 0.0395s/iter; left time: 525.1282s
	iters: 400, epoch: 2 | loss: 0.1874747
	speed: 0.0463s/iter; left time: 611.7375s
Epoch: 2 cost time: 20.389281511306763
Epoch: 2, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
Validation loss decreased (-0.950256 --> -0.968552).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0064176
	speed: 0.1392s/iter; left time: 1813.6450s
	iters: 200, epoch: 3 | loss: 0.0058152
	speed: 0.0466s/iter; left time: 602.4841s
	iters: 300, epoch: 3 | loss: 0.0059115
	speed: 0.0469s/iter; left time: 602.4997s
	iters: 400, epoch: 3 | loss: 0.0697784
	speed: 0.0460s/iter; left time: 586.1319s
Epoch: 3 cost time: 21.575161695480347
Epoch: 3, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
Validation loss decreased (-0.968552 --> -0.970840).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0025507
	speed: 0.1405s/iter; left time: 1765.5451s
	iters: 200, epoch: 4 | loss: 0.0023369
	speed: 0.0424s/iter; left time: 528.3496s
	iters: 300, epoch: 4 | loss: 0.0380496
	speed: 0.0453s/iter; left time: 560.5946s
	iters: 400, epoch: 4 | loss: 0.0104233
	speed: 0.0390s/iter; left time: 477.7016s
Epoch: 4 cost time: 20.492259740829468
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0478060
	speed: 0.1348s/iter; left time: 1630.4431s
	iters: 200, epoch: 5 | loss: 0.0061753
	speed: 0.0438s/iter; left time: 525.9800s
	iters: 300, epoch: 5 | loss: 0.0020466
	speed: 0.0435s/iter; left time: 517.8020s
	iters: 400, epoch: 5 | loss: 0.0052330
	speed: 0.0454s/iter; left time: 535.3597s
Epoch: 5 cost time: 20.83180069923401
Epoch: 5, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0008461
	speed: 0.1377s/iter; left time: 1600.7371s
	iters: 200, epoch: 6 | loss: 0.0289283
	speed: 0.0470s/iter; left time: 541.4961s
	iters: 300, epoch: 6 | loss: 0.0010167
	speed: 0.0402s/iter; left time: 459.6071s
	iters: 400, epoch: 6 | loss: 0.0129911
	speed: 0.0413s/iter; left time: 467.2671s
Epoch: 6 cost time: 20.468047618865967
Epoch: 6, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0018958
	speed: 0.1388s/iter; left time: 1548.6690s
	iters: 200, epoch: 7 | loss: 0.0098361
	speed: 0.0462s/iter; left time: 511.3213s
	iters: 300, epoch: 7 | loss: 0.0129858
	speed: 0.0459s/iter; left time: 503.3034s
	iters: 400, epoch: 7 | loss: 0.0037484
	speed: 0.0369s/iter; left time: 400.7389s
Epoch: 7 cost time: 20.496466875076294
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2004423
	speed: 0.1321s/iter; left time: 1412.1895s
	iters: 200, epoch: 8 | loss: 0.0010672
	speed: 0.0452s/iter; left time: 479.0716s
	iters: 300, epoch: 8 | loss: 0.0012990
	speed: 0.0468s/iter; left time: 490.8758s
	iters: 400, epoch: 8 | loss: 0.0034040
	speed: 0.0439s/iter; left time: 456.2377s
Epoch: 8 cost time: 21.77462148666382
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0045302
	speed: 0.1431s/iter; left time: 1462.7232s
	iters: 200, epoch: 9 | loss: 0.0041288
	speed: 0.0443s/iter; left time: 448.3945s
	iters: 300, epoch: 9 | loss: 0.0016857
	speed: 0.0462s/iter; left time: 463.2598s
	iters: 400, epoch: 9 | loss: 0.0021831
	speed: 0.0436s/iter; left time: 432.4708s
Epoch: 9 cost time: 21.475772619247437
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0003043
	speed: 0.1422s/iter; left time: 1385.9660s
	iters: 200, epoch: 10 | loss: 0.0009154
	speed: 0.0440s/iter; left time: 424.5553s
	iters: 300, epoch: 10 | loss: 0.0005456
	speed: 0.0465s/iter; left time: 443.7640s
	iters: 400, epoch: 10 | loss: 0.1417656
	speed: 0.0443s/iter; left time: 418.2812s
Epoch: 10 cost time: 21.625759601593018
Epoch: 10, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.970840 --> -0.977129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001210
	speed: 0.1288s/iter; left time: 1195.8037s
	iters: 200, epoch: 11 | loss: 0.0003699
	speed: 0.0372s/iter; left time: 341.4963s
	iters: 300, epoch: 11 | loss: 0.0012716
	speed: 0.0369s/iter; left time: 335.3556s
	iters: 400, epoch: 11 | loss: 0.1003001
	speed: 0.0416s/iter; left time: 373.4246s
Epoch: 11 cost time: 18.343274354934692
Epoch: 11, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978558).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0005162
	speed: 0.1336s/iter; left time: 1177.5986s
	iters: 200, epoch: 12 | loss: 0.0030248
	speed: 0.0469s/iter; left time: 408.2342s
	iters: 300, epoch: 12 | loss: 0.0003806
	speed: 0.0474s/iter; left time: 408.4353s
	iters: 400, epoch: 12 | loss: 0.0010808
	speed: 0.0472s/iter; left time: 401.6661s
Epoch: 12 cost time: 22.137301206588745
Epoch: 12, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0003908
	speed: 0.1397s/iter; left time: 1165.2891s
	iters: 200, epoch: 13 | loss: 0.0005297
	speed: 0.0455s/iter; left time: 375.4536s
	iters: 300, epoch: 13 | loss: 0.0015151
	speed: 0.0392s/iter; left time: 319.5549s
	iters: 400, epoch: 13 | loss: 0.0962747
	speed: 0.0389s/iter; left time: 313.0373s
Epoch: 13 cost time: 19.92740750312805
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0004733
	speed: 0.1326s/iter; left time: 1043.7880s
	iters: 200, epoch: 14 | loss: 0.0003152
	speed: 0.0463s/iter; left time: 359.7649s
	iters: 300, epoch: 14 | loss: 0.0004861
	speed: 0.0451s/iter; left time: 345.9368s
	iters: 400, epoch: 14 | loss: 0.0004107
	speed: 0.0448s/iter; left time: 339.3385s
Epoch: 14 cost time: 21.738409996032715
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001498
	speed: 0.1426s/iter; left time: 1055.6857s
	iters: 200, epoch: 15 | loss: 0.0003513
	speed: 0.0466s/iter; left time: 340.5025s
	iters: 300, epoch: 15 | loss: 0.0000465
	speed: 0.0471s/iter; left time: 339.4178s
	iters: 400, epoch: 15 | loss: 0.0000428
	speed: 0.0458s/iter; left time: 325.6556s
Epoch: 15 cost time: 21.94938635826111
Epoch: 15, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0009522
	speed: 0.1431s/iter; left time: 992.2342s
	iters: 200, epoch: 16 | loss: 0.0012615
	speed: 0.0484s/iter; left time: 330.8769s
	iters: 300, epoch: 16 | loss: 0.0207196
	speed: 0.0484s/iter; left time: 325.9568s
	iters: 400, epoch: 16 | loss: 0.0005675
	speed: 0.0483s/iter; left time: 320.6118s
Epoch: 16 cost time: 22.957722663879395
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0001594
	speed: 0.1342s/iter; left time: 867.9343s
	iters: 200, epoch: 17 | loss: 0.0019949
	speed: 0.0444s/iter; left time: 282.6121s
	iters: 300, epoch: 17 | loss: 0.0684254
	speed: 0.0447s/iter; left time: 280.1287s
	iters: 400, epoch: 17 | loss: 0.0099068
	speed: 0.0447s/iter; left time: 275.9153s
Epoch: 17 cost time: 21.163957357406616
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000282
	speed: 0.1355s/iter; left time: 812.6527s
	iters: 200, epoch: 18 | loss: 0.0002406
	speed: 0.0457s/iter; left time: 269.4301s
	iters: 300, epoch: 18 | loss: 0.0001347
	speed: 0.0454s/iter; left time: 263.4319s
	iters: 400, epoch: 18 | loss: 0.0215647
	speed: 0.0459s/iter; left time: 261.8122s
Epoch: 18 cost time: 21.628949880599976
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002851
	speed: 0.1384s/iter; left time: 764.9479s
	iters: 200, epoch: 19 | loss: 0.0051311
	speed: 0.0463s/iter; left time: 251.3088s
	iters: 300, epoch: 19 | loss: 0.0033480
	speed: 0.0454s/iter; left time: 242.1301s
	iters: 400, epoch: 19 | loss: 0.0433139
	speed: 0.0426s/iter; left time: 222.9389s
Epoch: 19 cost time: 21.505193948745728
Epoch: 19, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979130).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000501
	speed: 0.1398s/iter; left time: 707.6372s
	iters: 200, epoch: 20 | loss: 0.0001763
	speed: 0.0454s/iter; left time: 225.3978s
	iters: 300, epoch: 20 | loss: 0.0004123
	speed: 0.0442s/iter; left time: 214.8171s
	iters: 400, epoch: 20 | loss: 0.0008701
	speed: 0.0428s/iter; left time: 203.6443s
Epoch: 20 cost time: 20.894309759140015
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0004135
	speed: 0.1381s/iter; left time: 634.0712s
	iters: 200, epoch: 21 | loss: 0.0001382
	speed: 0.0473s/iter; left time: 212.2786s
	iters: 300, epoch: 21 | loss: 0.0004177
	speed: 0.0475s/iter; left time: 208.7083s
	iters: 400, epoch: 21 | loss: 0.0000805
	speed: 0.0467s/iter; left time: 200.5988s
Epoch: 21 cost time: 22.031463623046875
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
Validation loss decreased (-0.979130 --> -0.985705).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0956444
	speed: 0.1381s/iter; left time: 569.2042s
	iters: 200, epoch: 22 | loss: 0.0003448
	speed: 0.0425s/iter; left time: 170.9510s
	iters: 300, epoch: 22 | loss: 0.0000640
	speed: 0.0378s/iter; left time: 148.3504s
	iters: 400, epoch: 22 | loss: 0.0000600
	speed: 0.0451s/iter; left time: 172.1904s
Epoch: 22 cost time: 20.611829042434692
Epoch: 22, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0008046
	speed: 0.1351s/iter; left time: 493.3619s
	iters: 200, epoch: 23 | loss: 0.0001808
	speed: 0.0458s/iter; left time: 162.7524s
	iters: 300, epoch: 23 | loss: 0.0000368
	speed: 0.0462s/iter; left time: 159.4418s
	iters: 400, epoch: 23 | loss: 0.0002632
	speed: 0.0456s/iter; left time: 153.0113s
Epoch: 23 cost time: 21.433224201202393
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0002549
	speed: 0.1395s/iter; left time: 444.2390s
	iters: 200, epoch: 24 | loss: 0.0011720
	speed: 0.0459s/iter; left time: 141.6653s
	iters: 300, epoch: 24 | loss: 0.0021124
	speed: 0.0453s/iter; left time: 135.2679s
	iters: 400, epoch: 24 | loss: 0.0001326
	speed: 0.0459s/iter; left time: 132.4920s
Epoch: 24 cost time: 21.534591913223267
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0002825
	speed: 0.1370s/iter; left time: 372.0221s
	iters: 200, epoch: 25 | loss: 0.0024014
	speed: 0.0450s/iter; left time: 117.5679s
	iters: 300, epoch: 25 | loss: 0.0002352
	speed: 0.0444s/iter; left time: 111.7425s
	iters: 400, epoch: 25 | loss: 0.0003321
	speed: 0.0462s/iter; left time: 111.6782s
Epoch: 25 cost time: 21.72179102897644
Epoch: 25, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0021145
	speed: 0.1449s/iter; left time: 325.5086s
	iters: 200, epoch: 26 | loss: 0.0041435
	speed: 0.0508s/iter; left time: 109.0941s
	iters: 300, epoch: 26 | loss: 0.0157594
	speed: 0.0478s/iter; left time: 97.8919s
	iters: 400, epoch: 26 | loss: 0.0001608
	speed: 0.0482s/iter; left time: 93.7915s
Epoch: 26 cost time: 22.911725282669067
Epoch: 26, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0018331
	speed: 0.1369s/iter; left time: 243.3518s
	iters: 200, epoch: 27 | loss: 0.0319924
	speed: 0.0478s/iter; left time: 80.2130s
	iters: 300, epoch: 27 | loss: 0.0000384
	speed: 0.0465s/iter; left time: 73.3946s
	iters: 400, epoch: 27 | loss: 0.0001245
	speed: 0.0450s/iter; left time: 66.4824s
Epoch: 27 cost time: 21.217262029647827
Epoch: 27, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0031441
	speed: 0.1361s/iter; left time: 178.0806s
	iters: 200, epoch: 28 | loss: 0.0013258
	speed: 0.0474s/iter; left time: 57.2327s
	iters: 300, epoch: 28 | loss: 0.0032385
	speed: 0.0472s/iter; left time: 52.3493s
	iters: 400, epoch: 28 | loss: 0.0001584
	speed: 0.0462s/iter; left time: 46.5874s
Epoch: 28 cost time: 22.37271237373352
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000686
	speed: 0.1384s/iter; left time: 116.1466s
	iters: 200, epoch: 29 | loss: 0.0003371
	speed: 0.0466s/iter; left time: 34.4324s
	iters: 300, epoch: 29 | loss: 0.0019646
	speed: 0.0467s/iter; left time: 29.8161s
	iters: 400, epoch: 29 | loss: 0.0001532
	speed: 0.0463s/iter; left time: 24.9580s
Epoch: 29 cost time: 21.538547039031982
Epoch: 29, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0013470
	speed: 0.1357s/iter; left time: 50.2188s
	iters: 200, epoch: 30 | loss: 0.0008040
	speed: 0.0424s/iter; left time: 11.4573s
	iters: 300, epoch: 30 | loss: 0.0000619
	speed: 0.0414s/iter; left time: 7.0296s
	iters: 400, epoch: 30 | loss: 0.0004529
	speed: 0.0444s/iter; left time: 3.1104s
Epoch: 30 cost time: 20.667556285858154
Epoch: 30, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 1383178
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8092948
	speed: 0.0648s/iter; left time: 905.0147s
	iters: 200, epoch: 1 | loss: 0.2802659
	speed: 0.0520s/iter; left time: 720.9103s
	iters: 300, epoch: 1 | loss: 0.2710308
	speed: 0.0529s/iter; left time: 728.9807s
	iters: 400, epoch: 1 | loss: 0.1293127
	speed: 0.0536s/iter; left time: 732.5297s
Epoch: 1 cost time: 26.18278169631958
Epoch: 1, Steps: 469 | Train Loss: 0.542 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
Validation loss decreased (inf --> -0.961405).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0102814
	speed: 0.2251s/iter; left time: 3039.4249s
	iters: 200, epoch: 2 | loss: 0.0289461
	speed: 0.0550s/iter; left time: 736.4966s
	iters: 300, epoch: 2 | loss: 0.1170218
	speed: 0.0560s/iter; left time: 745.4738s
	iters: 400, epoch: 2 | loss: 0.0305404
	speed: 0.0614s/iter; left time: 810.8652s
Epoch: 2 cost time: 27.4016695022583
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.961405 --> -0.977129).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0099479
	speed: 0.2375s/iter; left time: 3094.9767s
	iters: 200, epoch: 3 | loss: 0.0905027
	speed: 0.0517s/iter; left time: 669.1496s
	iters: 300, epoch: 3 | loss: 0.0235754
	speed: 0.0510s/iter; left time: 654.4737s
	iters: 400, epoch: 3 | loss: 0.2567292
	speed: 0.0514s/iter; left time: 654.8288s
Epoch: 3 cost time: 25.40226173400879
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0121212
	speed: 0.2144s/iter; left time: 2693.3595s
	iters: 200, epoch: 4 | loss: 0.0104305
	speed: 0.0535s/iter; left time: 667.2864s
	iters: 300, epoch: 4 | loss: 0.0813045
	speed: 0.0588s/iter; left time: 727.0292s
	iters: 400, epoch: 4 | loss: 0.0142175
	speed: 0.0580s/iter; left time: 711.3527s
Epoch: 4 cost time: 26.448383331298828
Epoch: 4, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.977129 --> -0.983418).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2058596
	speed: 0.2162s/iter; left time: 2615.2939s
	iters: 200, epoch: 5 | loss: 0.0073343
	speed: 0.0492s/iter; left time: 590.5510s
	iters: 300, epoch: 5 | loss: 0.0026648
	speed: 0.0479s/iter; left time: 570.2297s
	iters: 400, epoch: 5 | loss: 0.0013988
	speed: 0.0519s/iter; left time: 611.6159s
Epoch: 5 cost time: 24.092544078826904
Epoch: 5, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0066421
	speed: 0.2063s/iter; left time: 2398.8778s
	iters: 200, epoch: 6 | loss: 0.0011963
	speed: 0.0517s/iter; left time: 596.4574s
	iters: 300, epoch: 6 | loss: 0.0013164
	speed: 0.0514s/iter; left time: 587.3429s
	iters: 400, epoch: 6 | loss: 0.0034960
	speed: 0.0527s/iter; left time: 596.9497s
Epoch: 6 cost time: 24.6763174533844
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1626527
	speed: 0.2101s/iter; left time: 2344.5272s
	iters: 200, epoch: 7 | loss: 0.1274118
	speed: 0.0556s/iter; left time: 614.2337s
	iters: 300, epoch: 7 | loss: 0.0012146
	speed: 0.0564s/iter; left time: 618.3553s
	iters: 400, epoch: 7 | loss: 0.0004829
	speed: 0.0526s/iter; left time: 571.1465s
Epoch: 7 cost time: 25.741373538970947
Epoch: 7, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983990).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0030984
	speed: 0.2240s/iter; left time: 2393.7092s
	iters: 200, epoch: 8 | loss: 0.0004597
	speed: 0.0526s/iter; left time: 556.7091s
	iters: 300, epoch: 8 | loss: 0.0105370
	speed: 0.0543s/iter; left time: 569.1684s
	iters: 400, epoch: 8 | loss: 0.0015303
	speed: 0.0546s/iter; left time: 567.5413s
Epoch: 8 cost time: 25.559496641159058
Epoch: 8, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001654
	speed: 0.2228s/iter; left time: 2276.9765s
	iters: 200, epoch: 9 | loss: 0.0012826
	speed: 0.0540s/iter; left time: 545.9559s
	iters: 300, epoch: 9 | loss: 0.0023627
	speed: 0.0536s/iter; left time: 537.3162s
	iters: 400, epoch: 9 | loss: 0.0029460
	speed: 0.0544s/iter; left time: 539.6381s
Epoch: 9 cost time: 25.614319324493408
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0207409
	speed: 0.2195s/iter; left time: 2140.4523s
	iters: 200, epoch: 10 | loss: 0.0006863
	speed: 0.0491s/iter; left time: 473.4591s
	iters: 300, epoch: 10 | loss: 0.0010131
	speed: 0.0502s/iter; left time: 479.4614s
	iters: 400, epoch: 10 | loss: 0.0017166
	speed: 0.0482s/iter; left time: 455.5341s
Epoch: 10 cost time: 23.12592101097107
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0058176
	speed: 0.2042s/iter; left time: 1895.1654s
	iters: 200, epoch: 11 | loss: 0.0061593
	speed: 0.0511s/iter; left time: 468.6948s
	iters: 300, epoch: 11 | loss: 0.0000861
	speed: 0.0518s/iter; left time: 470.4259s
	iters: 400, epoch: 11 | loss: 0.0002704
	speed: 0.0513s/iter; left time: 460.6415s
Epoch: 11 cost time: 24.447596549987793
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.983990 --> -0.986849).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0034766
	speed: 0.2104s/iter; left time: 1854.0167s
	iters: 200, epoch: 12 | loss: 0.3664925
	speed: 0.0500s/iter; left time: 435.7446s
	iters: 300, epoch: 12 | loss: 0.0027971
	speed: 0.0519s/iter; left time: 447.2119s
	iters: 400, epoch: 12 | loss: 0.0008727
	speed: 0.0520s/iter; left time: 442.7896s
Epoch: 12 cost time: 24.210867166519165
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0018219
	speed: 0.2061s/iter; left time: 1719.7048s
	iters: 200, epoch: 13 | loss: 0.0002990
	speed: 0.0481s/iter; left time: 396.2619s
	iters: 300, epoch: 13 | loss: 0.0003271
	speed: 0.0514s/iter; left time: 418.8457s
	iters: 400, epoch: 13 | loss: 0.0003424
	speed: 0.0474s/iter; left time: 381.6238s
Epoch: 13 cost time: 23.348286867141724
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0009867
	speed: 0.1972s/iter; left time: 1552.8065s
	iters: 200, epoch: 14 | loss: 0.0289992
	speed: 0.0483s/iter; left time: 375.6808s
	iters: 300, epoch: 14 | loss: 0.0004950
	speed: 0.0549s/iter; left time: 421.2109s
	iters: 400, epoch: 14 | loss: 0.0001109
	speed: 0.0535s/iter; left time: 405.0953s
Epoch: 14 cost time: 24.282341480255127
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0006883
	speed: 0.2169s/iter; left time: 1606.3664s
	iters: 200, epoch: 15 | loss: 0.0047516
	speed: 0.0534s/iter; left time: 390.2014s
	iters: 300, epoch: 15 | loss: 0.0015258
	speed: 0.0537s/iter; left time: 387.0878s
	iters: 400, epoch: 15 | loss: 0.0046391
	speed: 0.0533s/iter; left time: 378.8406s
Epoch: 15 cost time: 25.453977823257446
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000719
	speed: 0.2302s/iter; left time: 1596.8855s
	iters: 200, epoch: 16 | loss: 0.0281771
	speed: 0.0553s/iter; left time: 378.1104s
	iters: 300, epoch: 16 | loss: 0.1493743
	speed: 0.0551s/iter; left time: 370.9578s
	iters: 400, epoch: 16 | loss: 0.0052909
	speed: 0.0551s/iter; left time: 365.4263s
Epoch: 16 cost time: 26.212157726287842
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0001617
	speed: 0.2244s/iter; left time: 1451.5047s
	iters: 200, epoch: 17 | loss: 0.0007147
	speed: 0.0523s/iter; left time: 333.2458s
	iters: 300, epoch: 17 | loss: 0.0001406
	speed: 0.0492s/iter; left time: 308.2175s
	iters: 400, epoch: 17 | loss: 0.0000812
	speed: 0.0486s/iter; left time: 299.5649s
Epoch: 17 cost time: 23.91716694831848
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001968
	speed: 0.2061s/iter; left time: 1236.2975s
	iters: 200, epoch: 18 | loss: 0.0007597
	speed: 0.0463s/iter; left time: 273.2009s
	iters: 300, epoch: 18 | loss: 0.0219043
	speed: 0.0517s/iter; left time: 299.8684s
	iters: 400, epoch: 18 | loss: 0.0001498
	speed: 0.0509s/iter; left time: 289.8094s
Epoch: 18 cost time: 23.6163272857666
Epoch: 18, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0003731
	speed: 0.2049s/iter; left time: 1132.7379s
	iters: 200, epoch: 19 | loss: 0.0001687
	speed: 0.0484s/iter; left time: 262.7892s
	iters: 300, epoch: 19 | loss: 0.0061388
	speed: 0.0471s/iter; left time: 251.0349s
	iters: 400, epoch: 19 | loss: 0.0007882
	speed: 0.0437s/iter; left time: 228.5127s
Epoch: 19 cost time: 22.66551923751831
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0826886
	speed: 0.2054s/iter; left time: 1039.3255s
	iters: 200, epoch: 20 | loss: 0.0001751
	speed: 0.0456s/iter; left time: 226.2924s
	iters: 300, epoch: 20 | loss: 0.0000714
	speed: 0.0488s/iter; left time: 237.3153s
	iters: 400, epoch: 20 | loss: 0.0891337
	speed: 0.0503s/iter; left time: 239.6016s
Epoch: 20 cost time: 23.44385862350464
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0067976
	speed: 0.2094s/iter; left time: 961.3120s
	iters: 200, epoch: 21 | loss: 0.0151642
	speed: 0.0522s/iter; left time: 234.3244s
	iters: 300, epoch: 21 | loss: 0.0001964
	speed: 0.0521s/iter; left time: 228.6770s
	iters: 400, epoch: 21 | loss: 0.0002920
	speed: 0.0521s/iter; left time: 223.7708s
Epoch: 21 cost time: 24.952638149261475
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9868496283590623
model parameter : 4693258
model size : 19.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7670172
	speed: 0.0513s/iter; left time: 716.8437s
	iters: 200, epoch: 1 | loss: 0.3775797
	speed: 0.0376s/iter; left time: 521.0937s
	iters: 300, epoch: 1 | loss: 0.2280347
	speed: 0.0383s/iter; left time: 527.9626s
	iters: 400, epoch: 1 | loss: 0.0791392
	speed: 0.0382s/iter; left time: 522.7617s
Epoch: 1 cost time: 19.277753114700317
Epoch: 1, Steps: 469 | Train Loss: 0.572 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (inf --> -0.951113).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0260677
	speed: 0.1550s/iter; left time: 2092.9491s
	iters: 200, epoch: 2 | loss: 0.2897092
	speed: 0.0391s/iter; left time: 524.5753s
	iters: 300, epoch: 2 | loss: 0.0585374
	speed: 0.0396s/iter; left time: 526.2933s
	iters: 400, epoch: 2 | loss: 0.1053798
	speed: 0.0398s/iter; left time: 525.9372s
Epoch: 2 cost time: 18.755814790725708
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.951113 --> -0.965122).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0078430
	speed: 0.1465s/iter; left time: 1909.6544s
	iters: 200, epoch: 3 | loss: 0.0074710
	speed: 0.0385s/iter; left time: 498.3623s
	iters: 300, epoch: 3 | loss: 0.0095310
	speed: 0.0414s/iter; left time: 531.3510s
	iters: 400, epoch: 3 | loss: 0.0648269
	speed: 0.0407s/iter; left time: 517.9353s
Epoch: 3 cost time: 18.863945960998535
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.965122 --> -0.979702).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0017467
	speed: 0.1529s/iter; left time: 1921.4260s
	iters: 200, epoch: 4 | loss: 0.0043668
	speed: 0.0403s/iter; left time: 502.5616s
	iters: 300, epoch: 4 | loss: 0.0075922
	speed: 0.0414s/iter; left time: 512.2941s
	iters: 400, epoch: 4 | loss: 0.0089408
	speed: 0.0413s/iter; left time: 506.5610s
Epoch: 4 cost time: 18.974880695343018
Epoch: 4, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0474201
	speed: 0.1476s/iter; left time: 1784.8490s
	iters: 200, epoch: 5 | loss: 0.0035119
	speed: 0.0399s/iter; left time: 478.8268s
	iters: 300, epoch: 5 | loss: 0.0010925
	speed: 0.0401s/iter; left time: 477.2438s
	iters: 400, epoch: 5 | loss: 0.0023195
	speed: 0.0412s/iter; left time: 485.4279s
Epoch: 5 cost time: 19.277785778045654
Epoch: 5, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0005196
	speed: 0.1536s/iter; left time: 1786.0766s
	iters: 200, epoch: 6 | loss: 0.3421412
	speed: 0.0402s/iter; left time: 463.2998s
	iters: 300, epoch: 6 | loss: 0.0012352
	speed: 0.0385s/iter; left time: 440.2972s
	iters: 400, epoch: 6 | loss: 0.0579710
	speed: 0.0384s/iter; left time: 435.0994s
Epoch: 6 cost time: 18.323980569839478
Epoch: 6, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0013127
	speed: 0.1436s/iter; left time: 1601.8282s
	iters: 200, epoch: 7 | loss: 0.0105834
	speed: 0.0385s/iter; left time: 425.2152s
	iters: 300, epoch: 7 | loss: 0.0010290
	speed: 0.0391s/iter; left time: 427.9865s
	iters: 400, epoch: 7 | loss: 0.0016497
	speed: 0.0391s/iter; left time: 424.5698s
Epoch: 7 cost time: 18.37854504585266
Epoch: 7, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0112064
	speed: 0.1530s/iter; left time: 1634.9972s
	iters: 200, epoch: 8 | loss: 0.0005578
	speed: 0.0446s/iter; left time: 472.0867s
	iters: 300, epoch: 8 | loss: 0.0006194
	speed: 0.0389s/iter; left time: 408.4436s
	iters: 400, epoch: 8 | loss: 0.1827014
	speed: 0.0383s/iter; left time: 398.0367s
Epoch: 8 cost time: 18.925060987472534
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981417).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0179028
	speed: 0.1473s/iter; left time: 1505.2832s
	iters: 200, epoch: 9 | loss: 0.0042675
	speed: 0.0361s/iter; left time: 365.2534s
	iters: 300, epoch: 9 | loss: 0.0012340
	speed: 0.0372s/iter; left time: 372.8269s
	iters: 400, epoch: 9 | loss: 0.0019929
	speed: 0.0399s/iter; left time: 395.7885s
Epoch: 9 cost time: 17.99854326248169
Epoch: 9, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001716
	speed: 0.1477s/iter; left time: 1439.6624s
	iters: 200, epoch: 10 | loss: 0.0099024
	speed: 0.0390s/iter; left time: 376.5965s
	iters: 300, epoch: 10 | loss: 0.0050835
	speed: 0.0370s/iter; left time: 353.3754s
	iters: 400, epoch: 10 | loss: 0.1057348
	speed: 0.0375s/iter; left time: 354.4691s
Epoch: 10 cost time: 17.94187331199646
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0035148
	speed: 0.1413s/iter; left time: 1311.5271s
	iters: 200, epoch: 11 | loss: 0.0004243
	speed: 0.0382s/iter; left time: 350.3176s
	iters: 300, epoch: 11 | loss: 0.0165257
	speed: 0.0334s/iter; left time: 303.0931s
	iters: 400, epoch: 11 | loss: 0.0286272
	speed: 0.0367s/iter; left time: 329.6375s
Epoch: 11 cost time: 18.319393634796143
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000704
	speed: 0.1547s/iter; left time: 1363.0731s
	iters: 200, epoch: 12 | loss: 0.0097125
	speed: 0.0387s/iter; left time: 337.5287s
	iters: 300, epoch: 12 | loss: 0.0028567
	speed: 0.0420s/iter; left time: 361.4438s
	iters: 400, epoch: 12 | loss: 0.0014763
	speed: 0.0401s/iter; left time: 341.0263s
Epoch: 12 cost time: 18.718970775604248
Epoch: 12, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002867
	speed: 0.1533s/iter; left time: 1279.0830s
	iters: 200, epoch: 13 | loss: 0.0003364
	speed: 0.0398s/iter; left time: 327.9640s
	iters: 300, epoch: 13 | loss: 0.0056259
	speed: 0.0414s/iter; left time: 337.0591s
	iters: 400, epoch: 13 | loss: 0.0213766
	speed: 0.0415s/iter; left time: 333.8529s
Epoch: 13 cost time: 19.629186153411865
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0014089
	speed: 0.1604s/iter; left time: 1263.3177s
	iters: 200, epoch: 14 | loss: 0.0000889
	speed: 0.0392s/iter; left time: 304.8734s
	iters: 300, epoch: 14 | loss: 0.0005682
	speed: 0.0400s/iter; left time: 306.9475s
	iters: 400, epoch: 14 | loss: 0.0000701
	speed: 0.0394s/iter; left time: 298.0611s
Epoch: 14 cost time: 19.02631950378418
Epoch: 14, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0004403
	speed: 0.1571s/iter; left time: 1163.6559s
	iters: 200, epoch: 15 | loss: 0.0055667
	speed: 0.0371s/iter; left time: 270.9416s
	iters: 300, epoch: 15 | loss: 0.0001469
	speed: 0.0407s/iter; left time: 293.0257s
	iters: 400, epoch: 15 | loss: 0.0026204
	speed: 0.0371s/iter; left time: 263.7234s
Epoch: 15 cost time: 18.533610820770264
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000342
	speed: 0.1520s/iter; left time: 1054.0576s
	iters: 200, epoch: 16 | loss: 0.0000873
	speed: 0.0396s/iter; left time: 270.8034s
	iters: 300, epoch: 16 | loss: 0.0045366
	speed: 0.0328s/iter; left time: 221.0290s
	iters: 400, epoch: 16 | loss: 0.0002305
	speed: 0.0304s/iter; left time: 201.7561s
Epoch: 16 cost time: 17.239295721054077
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0084943
	speed: 0.1516s/iter; left time: 980.5841s
	iters: 200, epoch: 17 | loss: 0.0006975
	speed: 0.0408s/iter; left time: 260.0329s
	iters: 300, epoch: 17 | loss: 0.0002120
	speed: 0.0389s/iter; left time: 243.6029s
	iters: 400, epoch: 17 | loss: 0.0292394
	speed: 0.0397s/iter; left time: 244.7210s
Epoch: 17 cost time: 18.853111743927002
Epoch: 17, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.986 Test Loss: 0.074 Test Acc: 0.986
Validation loss decreased (-0.981703 --> -0.985705).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000629
	speed: 0.1592s/iter; left time: 954.8460s
	iters: 200, epoch: 18 | loss: 0.0003038
	speed: 0.0382s/iter; left time: 225.1329s
	iters: 300, epoch: 18 | loss: 0.0002184
	speed: 0.0396s/iter; left time: 229.8143s
	iters: 400, epoch: 18 | loss: 0.0045600
	speed: 0.0401s/iter; left time: 228.3260s
Epoch: 18 cost time: 18.990031480789185
Epoch: 18, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.985705 --> -0.985706).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000137
	speed: 0.1543s/iter; left time: 853.0033s
	iters: 200, epoch: 19 | loss: 0.0520677
	speed: 0.0393s/iter; left time: 213.1913s
	iters: 300, epoch: 19 | loss: 0.0117596
	speed: 0.0377s/iter; left time: 200.8960s
	iters: 400, epoch: 19 | loss: 0.0002240
	speed: 0.0397s/iter; left time: 207.5917s
Epoch: 19 cost time: 18.389395713806152
Epoch: 19, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0003177
	speed: 0.1511s/iter; left time: 764.5570s
	iters: 200, epoch: 20 | loss: 0.0000319
	speed: 0.0317s/iter; left time: 157.4679s
	iters: 300, epoch: 20 | loss: 0.0009347
	speed: 0.0331s/iter; left time: 160.8652s
	iters: 400, epoch: 20 | loss: 0.0005678
	speed: 0.0409s/iter; left time: 194.5525s
Epoch: 20 cost time: 17.239150047302246
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0001989
	speed: 0.1462s/iter; left time: 671.2615s
	iters: 200, epoch: 21 | loss: 0.0004603
	speed: 0.0372s/iter; left time: 167.1181s
	iters: 300, epoch: 21 | loss: 0.0001439
	speed: 0.0391s/iter; left time: 171.5563s
	iters: 400, epoch: 21 | loss: 0.0000492
	speed: 0.0333s/iter; left time: 142.8484s
Epoch: 21 cost time: 17.056938409805298
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0003401
	speed: 0.1413s/iter; left time: 582.2567s
	iters: 200, epoch: 22 | loss: 0.0005439
	speed: 0.0358s/iter; left time: 143.8559s
	iters: 300, epoch: 22 | loss: 0.0001182
	speed: 0.0350s/iter; left time: 137.0985s
	iters: 400, epoch: 22 | loss: 0.0000090
	speed: 0.0371s/iter; left time: 141.8855s
Epoch: 22 cost time: 17.212111949920654
Epoch: 22, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000456
	speed: 0.1451s/iter; left time: 529.9888s
	iters: 200, epoch: 23 | loss: 0.0004066
	speed: 0.0377s/iter; left time: 133.9461s
	iters: 300, epoch: 23 | loss: 0.0002618
	speed: 0.0378s/iter; left time: 130.5977s
	iters: 400, epoch: 23 | loss: 0.0171269
	speed: 0.0353s/iter; left time: 118.3137s
Epoch: 23 cost time: 17.33856749534607
Epoch: 23, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0001167
	speed: 0.1494s/iter; left time: 475.7926s
	iters: 200, epoch: 24 | loss: 0.0004555
	speed: 0.0385s/iter; left time: 118.7978s
	iters: 300, epoch: 24 | loss: 0.0000605
	speed: 0.0402s/iter; left time: 119.8189s
	iters: 400, epoch: 24 | loss: 0.0006071
	speed: 0.0408s/iter; left time: 117.6436s
Epoch: 24 cost time: 18.786632537841797
Epoch: 24, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1045766
	speed: 0.1470s/iter; left time: 399.2282s
	iters: 200, epoch: 25 | loss: 0.0281415
	speed: 0.0379s/iter; left time: 99.1683s
	iters: 300, epoch: 25 | loss: 0.0039963
	speed: 0.0378s/iter; left time: 95.0071s
	iters: 400, epoch: 25 | loss: 0.0052872
	speed: 0.0342s/iter; left time: 82.6991s
Epoch: 25 cost time: 17.50787663459778
Epoch: 25, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0005188
	speed: 0.1429s/iter; left time: 321.0137s
	iters: 200, epoch: 26 | loss: 0.0005292
	speed: 0.0326s/iter; left time: 70.0102s
	iters: 300, epoch: 26 | loss: 0.0014501
	speed: 0.0382s/iter; left time: 78.0805s
	iters: 400, epoch: 26 | loss: 0.0004636
	speed: 0.0397s/iter; left time: 77.3006s
Epoch: 26 cost time: 17.320783853530884
Epoch: 26, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0001549
	speed: 0.1515s/iter; left time: 269.2002s
	iters: 200, epoch: 27 | loss: 0.0267519
	speed: 0.0402s/iter; left time: 67.4127s
	iters: 300, epoch: 27 | loss: 0.0001556
	speed: 0.0422s/iter; left time: 66.5406s
	iters: 400, epoch: 27 | loss: 0.0003966
	speed: 0.0420s/iter; left time: 62.0797s
Epoch: 27 cost time: 19.43734049797058
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000430
	speed: 0.1491s/iter; left time: 194.9594s
	iters: 200, epoch: 28 | loss: 0.0021609
	speed: 0.0368s/iter; left time: 44.4389s
	iters: 300, epoch: 28 | loss: 0.0056853
	speed: 0.0370s/iter; left time: 41.0031s
	iters: 400, epoch: 28 | loss: 0.0001632
	speed: 0.0313s/iter; left time: 31.5077s
Epoch: 28 cost time: 16.75766658782959
Epoch: 28, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 1383178
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9160963
	speed: 0.0449s/iter; left time: 627.0808s
	iters: 200, epoch: 1 | loss: 0.3224563
	speed: 0.0326s/iter; left time: 452.4900s
	iters: 300, epoch: 1 | loss: 0.3201354
	speed: 0.0344s/iter; left time: 474.2576s
	iters: 400, epoch: 1 | loss: 0.1301013
	speed: 0.0365s/iter; left time: 498.9185s
Epoch: 1 cost time: 17.536369562149048
Epoch: 1, Steps: 469 | Train Loss: 0.594 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (inf --> -0.950256).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0238338
	speed: 0.1649s/iter; left time: 2225.9688s
	iters: 200, epoch: 2 | loss: 0.0897316
	speed: 0.0364s/iter; left time: 488.4745s
	iters: 300, epoch: 2 | loss: 0.0505672
	speed: 0.0361s/iter; left time: 480.6384s
	iters: 400, epoch: 2 | loss: 0.0380807
	speed: 0.0329s/iter; left time: 434.5599s
Epoch: 2 cost time: 16.835827112197876
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.950256 --> -0.970268).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0115654
	speed: 0.1561s/iter; left time: 2034.4002s
	iters: 200, epoch: 3 | loss: 0.0419238
	speed: 0.0318s/iter; left time: 411.0746s
	iters: 300, epoch: 3 | loss: 0.0467484
	speed: 0.0311s/iter; left time: 398.8677s
	iters: 400, epoch: 3 | loss: 0.1089605
	speed: 0.0311s/iter; left time: 396.0146s
Epoch: 3 cost time: 15.045165538787842
Epoch: 3, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0324935
	speed: 0.1548s/iter; left time: 1945.2245s
	iters: 200, epoch: 4 | loss: 0.0044944
	speed: 0.0348s/iter; left time: 433.5106s
	iters: 300, epoch: 4 | loss: 0.0960551
	speed: 0.0353s/iter; left time: 436.0405s
	iters: 400, epoch: 4 | loss: 0.0168913
	speed: 0.0345s/iter; left time: 423.4222s
Epoch: 4 cost time: 16.806418418884277
Epoch: 4, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
Validation loss decreased (-0.970268 --> -0.973698).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0701397
	speed: 0.1588s/iter; left time: 1920.2267s
	iters: 200, epoch: 5 | loss: 0.0460411
	speed: 0.0338s/iter; left time: 405.9105s
	iters: 300, epoch: 5 | loss: 0.0082740
	speed: 0.0312s/iter; left time: 371.5975s
	iters: 400, epoch: 5 | loss: 0.0017686
	speed: 0.0312s/iter; left time: 368.3720s
Epoch: 5 cost time: 15.789527416229248
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0025298
	speed: 0.1376s/iter; left time: 1599.6810s
	iters: 200, epoch: 6 | loss: 0.0011940
	speed: 0.0371s/iter; left time: 427.7820s
	iters: 300, epoch: 6 | loss: 0.0232808
	speed: 0.0354s/iter; left time: 404.6664s
	iters: 400, epoch: 6 | loss: 0.0108876
	speed: 0.0334s/iter; left time: 378.2454s
Epoch: 6 cost time: 16.671048879623413
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975414).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2112139
	speed: 0.1461s/iter; left time: 1630.4951s
	iters: 200, epoch: 7 | loss: 0.0015993
	speed: 0.0337s/iter; left time: 372.6815s
	iters: 300, epoch: 7 | loss: 0.0023960
	speed: 0.0319s/iter; left time: 349.0475s
	iters: 400, epoch: 7 | loss: 0.0014308
	speed: 0.0313s/iter; left time: 339.8287s
Epoch: 7 cost time: 15.804855585098267
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.975414 --> -0.980846).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0047765
	speed: 0.1389s/iter; left time: 1484.1900s
	iters: 200, epoch: 8 | loss: 0.0009792
	speed: 0.0349s/iter; left time: 370.0481s
	iters: 300, epoch: 8 | loss: 0.0284754
	speed: 0.0333s/iter; left time: 349.1448s
	iters: 400, epoch: 8 | loss: 0.0209862
	speed: 0.0349s/iter; left time: 362.2150s
Epoch: 8 cost time: 16.34480094909668
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001791
	speed: 0.1456s/iter; left time: 1487.8112s
	iters: 200, epoch: 9 | loss: 0.0013014
	speed: 0.0337s/iter; left time: 341.3675s
	iters: 300, epoch: 9 | loss: 0.0564257
	speed: 0.0343s/iter; left time: 343.7597s
	iters: 400, epoch: 9 | loss: 0.0020441
	speed: 0.0329s/iter; left time: 325.8580s
Epoch: 9 cost time: 16.228821992874146
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0017429
	speed: 0.1440s/iter; left time: 1404.0132s
	iters: 200, epoch: 10 | loss: 0.1198590
	speed: 0.0356s/iter; left time: 343.7566s
	iters: 300, epoch: 10 | loss: 0.0004272
	speed: 0.0318s/iter; left time: 303.4714s
	iters: 400, epoch: 10 | loss: 0.0011462
	speed: 0.0312s/iter; left time: 294.9869s
Epoch: 10 cost time: 15.54333782196045
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1573893
	speed: 0.1543s/iter; left time: 1432.4595s
	iters: 200, epoch: 11 | loss: 0.0100570
	speed: 0.0358s/iter; left time: 328.6203s
	iters: 300, epoch: 11 | loss: 0.0022980
	speed: 0.0349s/iter; left time: 316.6493s
	iters: 400, epoch: 11 | loss: 0.0032985
	speed: 0.0356s/iter; left time: 319.5540s
Epoch: 11 cost time: 16.996781826019287
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0053306
	speed: 0.1542s/iter; left time: 1358.7138s
	iters: 200, epoch: 12 | loss: 0.0099276
	speed: 0.0341s/iter; left time: 297.4296s
	iters: 300, epoch: 12 | loss: 0.0038923
	speed: 0.0339s/iter; left time: 291.8815s
	iters: 400, epoch: 12 | loss: 0.0018114
	speed: 0.0338s/iter; left time: 287.7764s
Epoch: 12 cost time: 16.48439383506775
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0037986
	speed: 0.1478s/iter; left time: 1233.4838s
	iters: 200, epoch: 13 | loss: 0.0014840
	speed: 0.0337s/iter; left time: 278.0686s
	iters: 300, epoch: 13 | loss: 0.0001523
	speed: 0.0333s/iter; left time: 270.7552s
	iters: 400, epoch: 13 | loss: 0.0006023
	speed: 0.0336s/iter; left time: 270.1060s
Epoch: 13 cost time: 16.110181093215942
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0013897
	speed: 0.1523s/iter; left time: 1199.1494s
	iters: 200, epoch: 14 | loss: 0.0126287
	speed: 0.0343s/iter; left time: 266.5701s
	iters: 300, epoch: 14 | loss: 0.0010064
	speed: 0.0342s/iter; left time: 262.1941s
	iters: 400, epoch: 14 | loss: 0.0002871
	speed: 0.0346s/iter; left time: 262.2231s
Epoch: 14 cost time: 16.515286922454834
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0004062
	speed: 0.1428s/iter; left time: 1057.1695s
	iters: 200, epoch: 15 | loss: 0.1432392
	speed: 0.0348s/iter; left time: 254.0818s
	iters: 300, epoch: 15 | loss: 0.0129931
	speed: 0.0345s/iter; left time: 248.4733s
	iters: 400, epoch: 15 | loss: 0.0018421
	speed: 0.0342s/iter; left time: 243.1172s
Epoch: 15 cost time: 16.49942111968994
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0002543
	speed: 0.1442s/iter; left time: 999.9798s
	iters: 200, epoch: 16 | loss: 0.0069475
	speed: 0.0340s/iter; left time: 232.2421s
	iters: 300, epoch: 16 | loss: 0.0062291
	speed: 0.0337s/iter; left time: 227.2866s
	iters: 400, epoch: 16 | loss: 0.0007602
	speed: 0.0326s/iter; left time: 216.2567s
Epoch: 16 cost time: 16.022350311279297
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0035245
	speed: 0.1439s/iter; left time: 930.8252s
	iters: 200, epoch: 17 | loss: 0.0000557
	speed: 0.0304s/iter; left time: 193.6933s
	iters: 300, epoch: 17 | loss: 0.0002145
	speed: 0.0321s/iter; left time: 201.2476s
	iters: 400, epoch: 17 | loss: 0.0010522
	speed: 0.0336s/iter; left time: 207.1103s
Epoch: 17 cost time: 15.582293510437012
Epoch: 17, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 4693258
model size : 19.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8753583
	speed: 0.0425s/iter; left time: 594.0169s
	iters: 200, epoch: 1 | loss: 0.4951655
	speed: 0.0274s/iter; left time: 379.9124s
	iters: 300, epoch: 1 | loss: 0.3010280
	speed: 0.0276s/iter; left time: 380.3178s
	iters: 400, epoch: 1 | loss: 0.0878647
	speed: 0.0260s/iter; left time: 354.7975s
Epoch: 1 cost time: 14.153128385543823
Epoch: 1, Steps: 469 | Train Loss: 0.640 Vali Loss: 0.176 Vali Acc: 0.947 Test Loss: 0.176 Test Acc: 0.947
Validation loss decreased (inf --> -0.947111).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0266335
	speed: 0.1187s/iter; left time: 1602.0153s
	iters: 200, epoch: 2 | loss: 0.1898169
	speed: 0.0300s/iter; left time: 401.8899s
	iters: 300, epoch: 2 | loss: 0.0553154
	speed: 0.0305s/iter; left time: 406.0508s
	iters: 400, epoch: 2 | loss: 0.1218932
	speed: 0.0300s/iter; left time: 396.4742s
Epoch: 2 cost time: 14.511408805847168
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.947111 --> -0.961691).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0121678
	speed: 0.1174s/iter; left time: 1530.3671s
	iters: 200, epoch: 3 | loss: 0.0099568
	speed: 0.0248s/iter; left time: 320.9612s
	iters: 300, epoch: 3 | loss: 0.0090150
	speed: 0.0277s/iter; left time: 355.1537s
	iters: 400, epoch: 3 | loss: 0.0303382
	speed: 0.0285s/iter; left time: 363.4907s
Epoch: 3 cost time: 12.964414119720459
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.961691 --> -0.977415).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0037214
	speed: 0.1143s/iter; left time: 1436.3942s
	iters: 200, epoch: 4 | loss: 0.0064590
	speed: 0.0264s/iter; left time: 328.8165s
	iters: 300, epoch: 4 | loss: 0.0207094
	speed: 0.0269s/iter; left time: 333.1553s
	iters: 400, epoch: 4 | loss: 0.0181050
	speed: 0.0258s/iter; left time: 316.3920s
Epoch: 4 cost time: 12.92073130607605
Epoch: 4, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0321542
	speed: 0.1072s/iter; left time: 1296.2298s
	iters: 200, epoch: 5 | loss: 0.0179019
	speed: 0.0268s/iter; left time: 321.0839s
	iters: 300, epoch: 5 | loss: 0.0038915
	speed: 0.0262s/iter; left time: 311.7423s
	iters: 400, epoch: 5 | loss: 0.0041533
	speed: 0.0262s/iter; left time: 308.7697s
Epoch: 5 cost time: 12.578108787536621
Epoch: 5, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0005053
	speed: 0.1076s/iter; left time: 1250.8517s
	iters: 200, epoch: 6 | loss: 0.0035932
	speed: 0.0249s/iter; left time: 286.5842s
	iters: 300, epoch: 6 | loss: 0.0019799
	speed: 0.0242s/iter; left time: 276.5698s
	iters: 400, epoch: 6 | loss: 0.0150895
	speed: 0.0236s/iter; left time: 266.8835s
Epoch: 6 cost time: 11.924464464187622
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0009084
	speed: 0.1049s/iter; left time: 1169.9031s
	iters: 200, epoch: 7 | loss: 0.0311204
	speed: 0.0284s/iter; left time: 314.2618s
	iters: 300, epoch: 7 | loss: 0.0019029
	speed: 0.0278s/iter; left time: 305.0139s
	iters: 400, epoch: 7 | loss: 0.0038094
	speed: 0.0299s/iter; left time: 324.5288s
Epoch: 7 cost time: 13.824382781982422
Epoch: 7, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.979416).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0234081
	speed: 0.1267s/iter; left time: 1354.0785s
	iters: 200, epoch: 8 | loss: 0.0010112
	speed: 0.0281s/iter; left time: 297.9735s
	iters: 300, epoch: 8 | loss: 0.0006085
	speed: 0.0299s/iter; left time: 313.4731s
	iters: 400, epoch: 8 | loss: 0.0144673
	speed: 0.0306s/iter; left time: 318.0689s
Epoch: 8 cost time: 14.104372262954712
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.979416 --> -0.983133).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0132180
	speed: 0.1258s/iter; left time: 1285.5258s
	iters: 200, epoch: 9 | loss: 0.0007527
	speed: 0.0271s/iter; left time: 274.3866s
	iters: 300, epoch: 9 | loss: 0.0041368
	speed: 0.0279s/iter; left time: 279.3986s
	iters: 400, epoch: 9 | loss: 0.0014493
	speed: 0.0277s/iter; left time: 274.2623s
Epoch: 9 cost time: 13.192980766296387
Epoch: 9, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003492
	speed: 0.1229s/iter; left time: 1198.3479s
	iters: 200, epoch: 10 | loss: 0.0013144
	speed: 0.0275s/iter; left time: 265.4384s
	iters: 300, epoch: 10 | loss: 0.0002729
	speed: 0.0276s/iter; left time: 263.4160s
	iters: 400, epoch: 10 | loss: 0.1549573
	speed: 0.0272s/iter; left time: 257.0599s
Epoch: 10 cost time: 13.220055341720581
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0013803
	speed: 0.1272s/iter; left time: 1180.6431s
	iters: 200, epoch: 11 | loss: 0.0003802
	speed: 0.0271s/iter; left time: 249.0082s
	iters: 300, epoch: 11 | loss: 0.0011015
	speed: 0.0240s/iter; left time: 217.9201s
	iters: 400, epoch: 11 | loss: 0.0153743
	speed: 0.0230s/iter; left time: 206.6170s
Epoch: 11 cost time: 12.56215500831604
Epoch: 11, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001389
	speed: 0.1045s/iter; left time: 920.4816s
	iters: 200, epoch: 12 | loss: 0.0109318
	speed: 0.0246s/iter; left time: 214.4436s
	iters: 300, epoch: 12 | loss: 0.0027498
	speed: 0.0237s/iter; left time: 204.2159s
	iters: 400, epoch: 12 | loss: 0.0002892
	speed: 0.0267s/iter; left time: 227.5265s
Epoch: 12 cost time: 12.084156036376953
Epoch: 12, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0001336
	speed: 0.1092s/iter; left time: 911.2998s
	iters: 200, epoch: 13 | loss: 0.0019167
	speed: 0.0270s/iter; left time: 222.6565s
	iters: 300, epoch: 13 | loss: 0.3444673
	speed: 0.0254s/iter; left time: 206.4446s
	iters: 400, epoch: 13 | loss: 0.0059369
	speed: 0.0256s/iter; left time: 206.2549s
Epoch: 13 cost time: 12.593579292297363
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0001930
	speed: 0.1088s/iter; left time: 856.4711s
	iters: 200, epoch: 14 | loss: 0.0013843
	speed: 0.0237s/iter; left time: 184.4517s
	iters: 300, epoch: 14 | loss: 0.0375484
	speed: 0.0235s/iter; left time: 180.0086s
	iters: 400, epoch: 14 | loss: 0.0002281
	speed: 0.0240s/iter; left time: 181.8902s
Epoch: 14 cost time: 11.758949995040894
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0001071
	speed: 0.1092s/iter; left time: 808.3397s
	iters: 200, epoch: 15 | loss: 0.0001349
	speed: 0.0269s/iter; left time: 196.2945s
	iters: 300, epoch: 15 | loss: 0.0001403
	speed: 0.0267s/iter; left time: 192.1743s
	iters: 400, epoch: 15 | loss: 0.0018152
	speed: 0.0241s/iter; left time: 171.3244s
Epoch: 15 cost time: 12.727218866348267
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000557
	speed: 0.1075s/iter; left time: 745.6328s
	iters: 200, epoch: 16 | loss: 0.0001459
	speed: 0.0269s/iter; left time: 183.6845s
	iters: 300, epoch: 16 | loss: 0.1079921
	speed: 0.0270s/iter; left time: 181.5782s
	iters: 400, epoch: 16 | loss: 0.0004395
	speed: 0.0274s/iter; left time: 181.6395s
Epoch: 16 cost time: 13.047149658203125
Epoch: 16, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0104577
	speed: 0.1093s/iter; left time: 707.0966s
	iters: 200, epoch: 17 | loss: 0.0015299
	speed: 0.0287s/iter; left time: 182.6235s
	iters: 300, epoch: 17 | loss: 0.0009509
	speed: 0.0289s/iter; left time: 181.1741s
	iters: 400, epoch: 17 | loss: 0.0003055
	speed: 0.0271s/iter; left time: 166.9240s
Epoch: 17 cost time: 13.573331832885742
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0005654
	speed: 0.1246s/iter; left time: 747.2791s
	iters: 200, epoch: 18 | loss: 0.0005046
	speed: 0.0273s/iter; left time: 161.1476s
	iters: 300, epoch: 18 | loss: 0.0001450
	speed: 0.0282s/iter; left time: 163.6458s
	iters: 400, epoch: 18 | loss: 0.0022885
	speed: 0.0278s/iter; left time: 158.2518s
Epoch: 18 cost time: 13.51484227180481
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 1383178
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1719252
	speed: 0.0796s/iter; left time: 1112.6461s
	iters: 200, epoch: 1 | loss: 0.5190235
	speed: 0.0647s/iter; left time: 897.4937s
	iters: 300, epoch: 1 | loss: 0.2776296
	speed: 0.0650s/iter; left time: 895.2976s
	iters: 400, epoch: 1 | loss: 0.0455943
	speed: 0.0648s/iter; left time: 886.3425s
Epoch: 1 cost time: 32.0267276763916
Epoch: 1, Steps: 469 | Train Loss: 0.645 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (inf --> -0.962834).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0691085
	speed: 0.2268s/iter; left time: 3062.3072s
	iters: 200, epoch: 2 | loss: 0.1075912
	speed: 0.0729s/iter; left time: 976.3983s
	iters: 300, epoch: 2 | loss: 0.0250325
	speed: 0.0731s/iter; left time: 972.3891s
	iters: 400, epoch: 2 | loss: 0.0398253
	speed: 0.0727s/iter; left time: 960.2272s
Epoch: 2 cost time: 34.49199604988098
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.962834 --> -0.972555).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0129336
	speed: 0.2457s/iter; left time: 3202.7184s
	iters: 200, epoch: 3 | loss: 0.0103032
	speed: 0.0724s/iter; left time: 936.2597s
	iters: 300, epoch: 3 | loss: 0.0019297
	speed: 0.0726s/iter; left time: 931.1134s
	iters: 400, epoch: 3 | loss: 0.1064607
	speed: 0.0722s/iter; left time: 919.1642s
Epoch: 3 cost time: 34.32519459724426
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.972555 --> -0.978273).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0682613
	speed: 0.2449s/iter; left time: 3076.6325s
	iters: 200, epoch: 4 | loss: 0.0177326
	speed: 0.0720s/iter; left time: 897.8741s
	iters: 300, epoch: 4 | loss: 0.0017814
	speed: 0.0681s/iter; left time: 841.5950s
	iters: 400, epoch: 4 | loss: 0.0270531
	speed: 0.0607s/iter; left time: 743.9044s
Epoch: 4 cost time: 32.04244112968445
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.978273 --> -0.981989).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0033940
	speed: 0.2240s/iter; left time: 2708.8792s
	iters: 200, epoch: 5 | loss: 0.0246209
	speed: 0.0649s/iter; left time: 778.6349s
	iters: 300, epoch: 5 | loss: 0.0105551
	speed: 0.0659s/iter; left time: 784.1479s
	iters: 400, epoch: 5 | loss: 0.0045239
	speed: 0.0662s/iter; left time: 781.1148s
Epoch: 5 cost time: 30.994396209716797
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0026290
	speed: 0.2185s/iter; left time: 2539.7161s
	iters: 200, epoch: 6 | loss: 0.0265170
	speed: 0.0658s/iter; left time: 758.3941s
	iters: 300, epoch: 6 | loss: 0.0024145
	speed: 0.0649s/iter; left time: 741.4038s
	iters: 400, epoch: 6 | loss: 0.0003901
	speed: 0.0636s/iter; left time: 720.6693s
Epoch: 6 cost time: 30.72241449356079
Epoch: 6, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983132).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005040
	speed: 0.2289s/iter; left time: 2554.2512s
	iters: 200, epoch: 7 | loss: 0.1771233
	speed: 0.0699s/iter; left time: 772.4997s
	iters: 300, epoch: 7 | loss: 0.0047510
	speed: 0.0710s/iter; left time: 778.4535s
	iters: 400, epoch: 7 | loss: 0.0035711
	speed: 0.0732s/iter; left time: 795.0723s
Epoch: 7 cost time: 33.40768885612488
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0010878
	speed: 0.2418s/iter; left time: 2584.7452s
	iters: 200, epoch: 8 | loss: 0.0009497
	speed: 0.0729s/iter; left time: 771.8078s
	iters: 300, epoch: 8 | loss: 0.0019311
	speed: 0.0709s/iter; left time: 743.9013s
	iters: 400, epoch: 8 | loss: 0.0020478
	speed: 0.0686s/iter; left time: 713.0917s
Epoch: 8 cost time: 33.58596420288086
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0010155
	speed: 0.2286s/iter; left time: 2336.3905s
	iters: 200, epoch: 9 | loss: 0.0109389
	speed: 0.0658s/iter; left time: 665.7419s
	iters: 300, epoch: 9 | loss: 0.0010311
	speed: 0.0648s/iter; left time: 648.9170s
	iters: 400, epoch: 9 | loss: 0.0019127
	speed: 0.0661s/iter; left time: 655.3291s
Epoch: 9 cost time: 30.95681595802307
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0005033
	speed: 0.2204s/iter; left time: 2149.0655s
	iters: 200, epoch: 10 | loss: 0.0017928
	speed: 0.0626s/iter; left time: 604.4048s
	iters: 300, epoch: 10 | loss: 0.0004714
	speed: 0.0630s/iter; left time: 601.2884s
	iters: 400, epoch: 10 | loss: 0.0034762
	speed: 0.0642s/iter; left time: 606.2929s
Epoch: 10 cost time: 29.829293966293335
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2132731
	speed: 0.2195s/iter; left time: 2036.9200s
	iters: 200, epoch: 11 | loss: 0.0013765
	speed: 0.0639s/iter; left time: 586.9323s
	iters: 300, epoch: 11 | loss: 0.0727500
	speed: 0.0638s/iter; left time: 579.7716s
	iters: 400, epoch: 11 | loss: 0.0028763
	speed: 0.0634s/iter; left time: 569.0945s
Epoch: 11 cost time: 30.017510414123535
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0020715
	speed: 0.2148s/iter; left time: 1892.6255s
	iters: 200, epoch: 12 | loss: 0.0067182
	speed: 0.0630s/iter; left time: 548.7382s
	iters: 300, epoch: 12 | loss: 0.0011885
	speed: 0.0623s/iter; left time: 536.1833s
	iters: 400, epoch: 12 | loss: 0.0010016
	speed: 0.0724s/iter; left time: 616.0142s
Epoch: 12 cost time: 31.115763425827026
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1565355
	speed: 0.2431s/iter; left time: 2028.1089s
	iters: 200, epoch: 13 | loss: 0.0043352
	speed: 0.0719s/iter; left time: 592.8858s
	iters: 300, epoch: 13 | loss: 0.0002142
	speed: 0.0707s/iter; left time: 575.5749s
	iters: 400, epoch: 13 | loss: 0.0071415
	speed: 0.0714s/iter; left time: 574.2691s
Epoch: 13 cost time: 33.64625000953674
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0005846
	speed: 0.2342s/iter; left time: 1844.4130s
	iters: 200, epoch: 14 | loss: 0.0033261
	speed: 0.0688s/iter; left time: 534.7162s
	iters: 300, epoch: 14 | loss: 0.0027241
	speed: 0.0673s/iter; left time: 516.8210s
	iters: 400, epoch: 14 | loss: 0.0005084
	speed: 0.0669s/iter; left time: 506.7944s
Epoch: 14 cost time: 32.110904693603516
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0002213
	speed: 0.2177s/iter; left time: 1611.7300s
	iters: 200, epoch: 15 | loss: 0.0007756
	speed: 0.0587s/iter; left time: 428.9035s
	iters: 300, epoch: 15 | loss: 0.0052687
	speed: 0.0598s/iter; left time: 430.6603s
	iters: 400, epoch: 15 | loss: 0.1014472
	speed: 0.0617s/iter; left time: 438.1592s
Epoch: 15 cost time: 28.269341945648193
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0006759
	speed: 0.2172s/iter; left time: 1506.8176s
	iters: 200, epoch: 16 | loss: 0.0002341
	speed: 0.0637s/iter; left time: 435.5623s
	iters: 300, epoch: 16 | loss: 0.0179846
	speed: 0.0617s/iter; left time: 415.7647s
	iters: 400, epoch: 16 | loss: 0.0283898
	speed: 0.0616s/iter; left time: 408.6404s
Epoch: 16 cost time: 29.947783946990967
Epoch: 16, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 4690698
model size : 18.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0199771
	speed: 0.0541s/iter; left time: 755.9871s
	iters: 200, epoch: 1 | loss: 0.4716215
	speed: 0.0490s/iter; left time: 680.1851s
	iters: 300, epoch: 1 | loss: 0.3522593
	speed: 0.0453s/iter; left time: 623.2933s
	iters: 400, epoch: 1 | loss: 0.1077196
	speed: 0.0432s/iter; left time: 590.5895s
Epoch: 1 cost time: 22.75518774986267
Epoch: 1, Steps: 469 | Train Loss: 0.685 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (inf --> -0.964550).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0274860
	speed: 0.1683s/iter; left time: 2271.7901s
	iters: 200, epoch: 2 | loss: 0.0182321
	speed: 0.0477s/iter; left time: 639.1514s
	iters: 300, epoch: 2 | loss: 0.2173010
	speed: 0.0505s/iter; left time: 671.3318s
	iters: 400, epoch: 2 | loss: 0.0102204
	speed: 0.0494s/iter; left time: 652.2036s
Epoch: 2 cost time: 23.335278511047363
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.964550 --> -0.979416).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0060305
	speed: 0.1734s/iter; left time: 2260.3964s
	iters: 200, epoch: 3 | loss: 0.0023929
	speed: 0.0494s/iter; left time: 638.7024s
	iters: 300, epoch: 3 | loss: 0.0052411
	speed: 0.0498s/iter; left time: 639.3626s
	iters: 400, epoch: 3 | loss: 0.1845905
	speed: 0.0492s/iter; left time: 626.7455s
Epoch: 3 cost time: 23.613966941833496
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0223705
	speed: 0.1840s/iter; left time: 2311.7301s
	iters: 200, epoch: 4 | loss: 0.0032218
	speed: 0.0540s/iter; left time: 672.6161s
	iters: 300, epoch: 4 | loss: 0.0032930
	speed: 0.0544s/iter; left time: 672.4785s
	iters: 400, epoch: 4 | loss: 0.0129301
	speed: 0.0500s/iter; left time: 613.6753s
Epoch: 4 cost time: 24.915183067321777
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3780127
	speed: 0.1635s/iter; left time: 1977.9810s
	iters: 200, epoch: 5 | loss: 0.0071871
	speed: 0.0470s/iter; left time: 564.3552s
	iters: 300, epoch: 5 | loss: 0.1681707
	speed: 0.0488s/iter; left time: 580.7954s
	iters: 400, epoch: 5 | loss: 0.0020039
	speed: 0.0472s/iter; left time: 556.6390s
Epoch: 5 cost time: 22.518866539001465
Epoch: 5, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0183644
	speed: 0.1751s/iter; left time: 2035.5393s
	iters: 200, epoch: 6 | loss: 0.0306615
	speed: 0.0407s/iter; left time: 468.7042s
	iters: 300, epoch: 6 | loss: 0.0504342
	speed: 0.0432s/iter; left time: 493.6781s
	iters: 400, epoch: 6 | loss: 0.0029057
	speed: 0.0494s/iter; left time: 559.5031s
Epoch: 6 cost time: 21.8011474609375
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979416 --> -0.982847).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0405829
	speed: 0.1784s/iter; left time: 1989.9292s
	iters: 200, epoch: 7 | loss: 0.0007980
	speed: 0.0496s/iter; left time: 548.8674s
	iters: 300, epoch: 7 | loss: 0.1387495
	speed: 0.0508s/iter; left time: 556.8867s
	iters: 400, epoch: 7 | loss: 0.0013439
	speed: 0.0494s/iter; left time: 536.3793s
Epoch: 7 cost time: 23.49386739730835
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.982847).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0012280
	speed: 0.1628s/iter; left time: 1739.5037s
	iters: 200, epoch: 8 | loss: 0.0005396
	speed: 0.0508s/iter; left time: 538.1891s
	iters: 300, epoch: 8 | loss: 0.0019467
	speed: 0.0474s/iter; left time: 496.8371s
	iters: 400, epoch: 8 | loss: 0.0006321
	speed: 0.0494s/iter; left time: 513.0181s
Epoch: 8 cost time: 23.57957363128662
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.982847 --> -0.986277).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020000
	speed: 0.1776s/iter; left time: 1815.2749s
	iters: 200, epoch: 9 | loss: 0.0012389
	speed: 0.0386s/iter; left time: 390.3357s
	iters: 300, epoch: 9 | loss: 0.0038099
	speed: 0.0410s/iter; left time: 411.0783s
	iters: 400, epoch: 9 | loss: 0.0336141
	speed: 0.0386s/iter; left time: 382.4825s
Epoch: 9 cost time: 19.531410217285156
Epoch: 9, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0006775
	speed: 0.1167s/iter; left time: 1137.9627s
	iters: 200, epoch: 10 | loss: 0.0011399
	speed: 0.0421s/iter; left time: 406.3545s
	iters: 300, epoch: 10 | loss: 0.0020055
	speed: 0.0421s/iter; left time: 402.3754s
	iters: 400, epoch: 10 | loss: 0.0288870
	speed: 0.0447s/iter; left time: 422.2544s
Epoch: 10 cost time: 20.0718035697937
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0118066
	speed: 0.1289s/iter; left time: 1196.0093s
	iters: 200, epoch: 11 | loss: 0.0004693
	speed: 0.0448s/iter; left time: 411.0066s
	iters: 300, epoch: 11 | loss: 0.0066559
	speed: 0.0447s/iter; left time: 405.8413s
	iters: 400, epoch: 11 | loss: 0.0002772
	speed: 0.0441s/iter; left time: 396.0516s
Epoch: 11 cost time: 21.015604257583618
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0046827
	speed: 0.1291s/iter; left time: 1137.3514s
	iters: 200, epoch: 12 | loss: 0.0022821
	speed: 0.0446s/iter; left time: 388.5935s
	iters: 300, epoch: 12 | loss: 0.0002271
	speed: 0.0448s/iter; left time: 385.4455s
	iters: 400, epoch: 12 | loss: 0.0002571
	speed: 0.0447s/iter; left time: 380.5692s
Epoch: 12 cost time: 21.209155559539795
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0004640
	speed: 0.1294s/iter; left time: 1079.5021s
	iters: 200, epoch: 13 | loss: 0.0004456
	speed: 0.0447s/iter; left time: 368.7709s
	iters: 300, epoch: 13 | loss: 0.0004016
	speed: 0.0425s/iter; left time: 346.3684s
	iters: 400, epoch: 13 | loss: 0.1811205
	speed: 0.0412s/iter; left time: 331.3027s
Epoch: 13 cost time: 20.432539463043213
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0159681
	speed: 0.1361s/iter; left time: 1071.9920s
	iters: 200, epoch: 14 | loss: 0.0003581
	speed: 0.0407s/iter; left time: 316.2136s
	iters: 300, epoch: 14 | loss: 0.0009833
	speed: 0.0421s/iter; left time: 322.9466s
	iters: 400, epoch: 14 | loss: 0.0002060
	speed: 0.0403s/iter; left time: 304.8644s
Epoch: 14 cost time: 19.469605922698975
Epoch: 14, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0001386
	speed: 0.1287s/iter; left time: 953.1636s
	iters: 200, epoch: 15 | loss: 0.0000503
	speed: 0.0414s/iter; left time: 302.4392s
	iters: 300, epoch: 15 | loss: 0.0012274
	speed: 0.0431s/iter; left time: 310.3581s
	iters: 400, epoch: 15 | loss: 0.0007381
	speed: 0.0450s/iter; left time: 319.6580s
Epoch: 15 cost time: 20.375582695007324
Epoch: 15, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0495617
	speed: 0.1253s/iter; left time: 869.4143s
	iters: 200, epoch: 16 | loss: 0.0104711
	speed: 0.0446s/iter; left time: 304.8113s
	iters: 300, epoch: 16 | loss: 0.0001859
	speed: 0.0446s/iter; left time: 300.7335s
	iters: 400, epoch: 16 | loss: 0.0003674
	speed: 0.0373s/iter; left time: 247.5400s
Epoch: 16 cost time: 19.34845805168152
Epoch: 16, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0003781
	speed: 0.1200s/iter; left time: 775.8017s
	iters: 200, epoch: 17 | loss: 0.0002519
	speed: 0.0423s/iter; left time: 269.5626s
	iters: 300, epoch: 17 | loss: 0.0035336
	speed: 0.0377s/iter; left time: 236.1632s
	iters: 400, epoch: 17 | loss: 0.0007301
	speed: 0.0358s/iter; left time: 220.4730s
Epoch: 17 cost time: 18.604299783706665
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0053580
	speed: 0.1211s/iter; left time: 726.5873s
	iters: 200, epoch: 18 | loss: 0.0005736
	speed: 0.0441s/iter; left time: 260.1910s
	iters: 300, epoch: 18 | loss: 0.0061580
	speed: 0.0443s/iter; left time: 256.5999s
	iters: 400, epoch: 18 | loss: 0.0020143
	speed: 0.0446s/iter; left time: 254.2605s
Epoch: 18 cost time: 20.954878568649292
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 1380490
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1874390
	speed: 0.0550s/iter; left time: 768.2342s
	iters: 200, epoch: 1 | loss: 0.5694430
	speed: 0.0438s/iter; left time: 607.5963s
	iters: 300, epoch: 1 | loss: 0.2847263
	speed: 0.0391s/iter; left time: 537.7665s
	iters: 400, epoch: 1 | loss: 0.0679898
	speed: 0.0423s/iter; left time: 577.6666s
Epoch: 1 cost time: 21.249640226364136
Epoch: 1, Steps: 469 | Train Loss: 0.661 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
Validation loss decreased (inf --> -0.953114).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0993373
	speed: 0.1389s/iter; left time: 1874.8593s
	iters: 200, epoch: 2 | loss: 0.1051300
	speed: 0.0458s/iter; left time: 613.9055s
	iters: 300, epoch: 2 | loss: 0.0413992
	speed: 0.0423s/iter; left time: 562.9375s
	iters: 400, epoch: 2 | loss: 0.0574152
	speed: 0.0369s/iter; left time: 487.4232s
Epoch: 2 cost time: 19.59158730506897
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.953114 --> -0.967981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0190991
	speed: 0.1258s/iter; left time: 1639.9798s
	iters: 200, epoch: 3 | loss: 0.0105713
	speed: 0.0452s/iter; left time: 585.0523s
	iters: 300, epoch: 3 | loss: 0.0041916
	speed: 0.0417s/iter; left time: 534.6355s
	iters: 400, epoch: 3 | loss: 0.0914276
	speed: 0.0412s/iter; left time: 524.2497s
Epoch: 3 cost time: 19.869357585906982
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.967981 --> -0.974556).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0223130
	speed: 0.1319s/iter; left time: 1657.0596s
	iters: 200, epoch: 4 | loss: 0.0116857
	speed: 0.0427s/iter; left time: 531.9960s
	iters: 300, epoch: 4 | loss: 0.0077810
	speed: 0.0466s/iter; left time: 576.7570s
	iters: 400, epoch: 4 | loss: 0.0231570
	speed: 0.0437s/iter; left time: 536.3185s
Epoch: 4 cost time: 20.289714097976685
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.976557).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0160030
	speed: 0.1331s/iter; left time: 1609.9921s
	iters: 200, epoch: 5 | loss: 0.0168268
	speed: 0.0459s/iter; left time: 551.1489s
	iters: 300, epoch: 5 | loss: 0.0088049
	speed: 0.0460s/iter; left time: 546.7635s
	iters: 400, epoch: 5 | loss: 0.0044620
	speed: 0.0459s/iter; left time: 541.1959s
Epoch: 5 cost time: 21.523331880569458
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0020065
	speed: 0.1365s/iter; left time: 1587.4966s
	iters: 200, epoch: 6 | loss: 0.0287509
	speed: 0.0449s/iter; left time: 517.4791s
	iters: 300, epoch: 6 | loss: 0.0037278
	speed: 0.0387s/iter; left time: 441.8402s
	iters: 400, epoch: 6 | loss: 0.0006623
	speed: 0.0446s/iter; left time: 504.9671s
Epoch: 6 cost time: 20.448546409606934
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0017146
	speed: 0.1340s/iter; left time: 1494.9240s
	iters: 200, epoch: 7 | loss: 0.0041002
	speed: 0.0425s/iter; left time: 469.7405s
	iters: 300, epoch: 7 | loss: 0.0023326
	speed: 0.0412s/iter; left time: 451.6094s
	iters: 400, epoch: 7 | loss: 0.0783333
	speed: 0.0424s/iter; left time: 460.7225s
Epoch: 7 cost time: 19.566664457321167
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0022014
	speed: 0.1352s/iter; left time: 1445.2150s
	iters: 200, epoch: 8 | loss: 0.0014580
	speed: 0.0448s/iter; left time: 474.4042s
	iters: 300, epoch: 8 | loss: 0.0056206
	speed: 0.0446s/iter; left time: 467.9187s
	iters: 400, epoch: 8 | loss: 0.0030961
	speed: 0.0441s/iter; left time: 458.6236s
Epoch: 8 cost time: 20.894375562667847
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0007284
	speed: 0.1325s/iter; left time: 1353.5489s
	iters: 200, epoch: 9 | loss: 0.0067612
	speed: 0.0443s/iter; left time: 447.8637s
	iters: 300, epoch: 9 | loss: 0.0007898
	speed: 0.0419s/iter; left time: 420.1120s
	iters: 400, epoch: 9 | loss: 0.1372018
	speed: 0.0411s/iter; left time: 407.5045s
Epoch: 9 cost time: 20.04091715812683
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0022381
	speed: 0.1297s/iter; left time: 1264.8333s
	iters: 200, epoch: 10 | loss: 0.0006193
	speed: 0.0431s/iter; left time: 416.1288s
	iters: 300, epoch: 10 | loss: 0.0007916
	speed: 0.0422s/iter; left time: 402.9592s
	iters: 400, epoch: 10 | loss: 0.0176789
	speed: 0.0415s/iter; left time: 392.1427s
Epoch: 10 cost time: 19.99101710319519
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1820734
	speed: 0.1359s/iter; left time: 1261.5113s
	iters: 200, epoch: 11 | loss: 0.0010855
	speed: 0.0432s/iter; left time: 396.4310s
	iters: 300, epoch: 11 | loss: 0.0063473
	speed: 0.0434s/iter; left time: 394.3205s
	iters: 400, epoch: 11 | loss: 0.0005188
	speed: 0.0425s/iter; left time: 381.3111s
Epoch: 11 cost time: 20.579343795776367
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.977129 --> -0.983990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0009559
	speed: 0.1447s/iter; left time: 1275.4019s
	iters: 200, epoch: 12 | loss: 0.0110271
	speed: 0.0421s/iter; left time: 366.4119s
	iters: 300, epoch: 12 | loss: 0.0011596
	speed: 0.0446s/iter; left time: 384.2306s
	iters: 400, epoch: 12 | loss: 0.0004064
	speed: 0.0453s/iter; left time: 385.5077s
Epoch: 12 cost time: 21.248318910598755
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0065454
	speed: 0.1372s/iter; left time: 1144.9040s
	iters: 200, epoch: 13 | loss: 0.1561987
	speed: 0.0469s/iter; left time: 386.8931s
	iters: 300, epoch: 13 | loss: 0.0364269
	speed: 0.0411s/iter; left time: 334.5039s
	iters: 400, epoch: 13 | loss: 0.0019101
	speed: 0.0411s/iter; left time: 330.5575s
Epoch: 13 cost time: 20.637329578399658
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0011945
	speed: 0.1334s/iter; left time: 1050.6374s
	iters: 200, epoch: 14 | loss: 0.0084355
	speed: 0.0429s/iter; left time: 333.2641s
	iters: 300, epoch: 14 | loss: 0.0019305
	speed: 0.0431s/iter; left time: 330.6629s
	iters: 400, epoch: 14 | loss: 0.0007936
	speed: 0.0426s/iter; left time: 322.9650s
Epoch: 14 cost time: 20.319971084594727
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0013987
	speed: 0.1369s/iter; left time: 1013.5821s
	iters: 200, epoch: 15 | loss: 0.0007188
	speed: 0.0422s/iter; left time: 307.9933s
	iters: 300, epoch: 15 | loss: 0.0018547
	speed: 0.0400s/iter; left time: 287.9395s
	iters: 400, epoch: 15 | loss: 0.3226915
	speed: 0.0410s/iter; left time: 291.6098s
Epoch: 15 cost time: 19.958797931671143
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0007135
	speed: 0.1311s/iter; left time: 909.5922s
	iters: 200, epoch: 16 | loss: 0.0004958
	speed: 0.0412s/iter; left time: 281.4389s
	iters: 300, epoch: 16 | loss: 0.0829580
	speed: 0.0416s/iter; left time: 280.2595s
	iters: 400, epoch: 16 | loss: 0.2692867
	speed: 0.0434s/iter; left time: 287.8532s
Epoch: 16 cost time: 20.051351308822632
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0007207
	speed: 0.1331s/iter; left time: 860.6489s
	iters: 200, epoch: 17 | loss: 0.0001515
	speed: 0.0408s/iter; left time: 259.7015s
	iters: 300, epoch: 17 | loss: 0.0006752
	speed: 0.0425s/iter; left time: 266.2861s
	iters: 400, epoch: 17 | loss: 0.0210962
	speed: 0.0452s/iter; left time: 278.8746s
Epoch: 17 cost time: 20.30585765838623
Epoch: 17, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0093193
	speed: 0.1361s/iter; left time: 816.5785s
	iters: 200, epoch: 18 | loss: 0.0006570
	speed: 0.0376s/iter; left time: 221.8572s
	iters: 300, epoch: 18 | loss: 0.0001857
	speed: 0.0410s/iter; left time: 237.4379s
	iters: 400, epoch: 18 | loss: 0.0001132
	speed: 0.0423s/iter; left time: 241.2617s
Epoch: 18 cost time: 19.601746559143066
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0022001
	speed: 0.1335s/iter; left time: 737.9487s
	iters: 200, epoch: 19 | loss: 0.0002473
	speed: 0.0430s/iter; left time: 233.5284s
	iters: 300, epoch: 19 | loss: 0.0075299
	speed: 0.0431s/iter; left time: 229.4856s
	iters: 400, epoch: 19 | loss: 0.0004387
	speed: 0.0426s/iter; left time: 222.8772s
Epoch: 19 cost time: 20.202381372451782
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0003040
	speed: 0.1363s/iter; left time: 689.7922s
	iters: 200, epoch: 20 | loss: 0.0006432
	speed: 0.0468s/iter; left time: 232.1834s
	iters: 300, epoch: 20 | loss: 0.0002986
	speed: 0.0464s/iter; left time: 225.6383s
	iters: 400, epoch: 20 | loss: 0.0004361
	speed: 0.0465s/iter; left time: 221.5032s
Epoch: 20 cost time: 21.861309051513672
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0004921
	speed: 0.1343s/iter; left time: 616.5157s
	iters: 200, epoch: 21 | loss: 0.0007323
	speed: 0.0432s/iter; left time: 194.2193s
	iters: 300, epoch: 21 | loss: 0.1172773
	speed: 0.0424s/iter; left time: 186.3549s
	iters: 400, epoch: 21 | loss: 0.0006636
	speed: 0.0421s/iter; left time: 180.8014s
Epoch: 21 cost time: 20.188368797302246
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 4690698
model size : 18.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0239848
	speed: 0.0451s/iter; left time: 630.0366s
	iters: 200, epoch: 1 | loss: 0.5035601
	speed: 0.0283s/iter; left time: 393.1749s
	iters: 300, epoch: 1 | loss: 0.4190502
	speed: 0.0351s/iter; left time: 483.2636s
	iters: 400, epoch: 1 | loss: 0.1160402
	speed: 0.0369s/iter; left time: 504.3282s
Epoch: 1 cost time: 16.81348466873169
Epoch: 1, Steps: 469 | Train Loss: 0.699 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (inf --> -0.963120).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0366461
	speed: 0.1074s/iter; left time: 1449.5016s
	iters: 200, epoch: 2 | loss: 0.0191600
	speed: 0.0397s/iter; left time: 532.5660s
	iters: 300, epoch: 2 | loss: 0.2895915
	speed: 0.0337s/iter; left time: 448.6430s
	iters: 400, epoch: 2 | loss: 0.0096855
	speed: 0.0342s/iter; left time: 450.9159s
Epoch: 2 cost time: 16.55837893486023
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.963120 --> -0.972841).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0073192
	speed: 0.1080s/iter; left time: 1407.4603s
	iters: 200, epoch: 3 | loss: 0.0020015
	speed: 0.0312s/iter; left time: 403.6791s
	iters: 300, epoch: 3 | loss: 0.0139298
	speed: 0.0338s/iter; left time: 433.9156s
	iters: 400, epoch: 3 | loss: 0.1172742
	speed: 0.0320s/iter; left time: 406.8590s
Epoch: 3 cost time: 15.5088951587677
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0173734
	speed: 0.1060s/iter; left time: 1332.0323s
	iters: 200, epoch: 4 | loss: 0.0043682
	speed: 0.0348s/iter; left time: 433.1705s
	iters: 300, epoch: 4 | loss: 0.0163190
	speed: 0.0350s/iter; left time: 432.9957s
	iters: 400, epoch: 4 | loss: 0.0178705
	speed: 0.0353s/iter; left time: 433.5184s
Epoch: 4 cost time: 16.693887948989868
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972841 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4121158
	speed: 0.1066s/iter; left time: 1289.8018s
	iters: 200, epoch: 5 | loss: 0.0028324
	speed: 0.0350s/iter; left time: 419.8460s
	iters: 300, epoch: 5 | loss: 0.0204365
	speed: 0.0318s/iter; left time: 378.8120s
	iters: 400, epoch: 5 | loss: 0.0030184
	speed: 0.0348s/iter; left time: 410.2876s
Epoch: 5 cost time: 16.256773233413696
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0070329
	speed: 0.1044s/iter; left time: 1214.0252s
	iters: 200, epoch: 6 | loss: 0.0093888
	speed: 0.0351s/iter; left time: 404.6685s
	iters: 300, epoch: 6 | loss: 0.0138410
	speed: 0.0341s/iter; left time: 389.9859s
	iters: 400, epoch: 6 | loss: 0.0022185
	speed: 0.0270s/iter; left time: 305.4649s
Epoch: 6 cost time: 15.730273485183716
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.973412 --> -0.980274).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0313026
	speed: 0.1068s/iter; left time: 1192.0467s
	iters: 200, epoch: 7 | loss: 0.0009800
	speed: 0.0353s/iter; left time: 390.2177s
	iters: 300, epoch: 7 | loss: 0.0701796
	speed: 0.0350s/iter; left time: 383.7811s
	iters: 400, epoch: 7 | loss: 0.0181230
	speed: 0.0303s/iter; left time: 328.5459s
Epoch: 7 cost time: 16.196454524993896
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0013758
	speed: 0.1049s/iter; left time: 1121.4401s
	iters: 200, epoch: 8 | loss: 0.0003675
	speed: 0.0292s/iter; left time: 309.0236s
	iters: 300, epoch: 8 | loss: 0.0135798
	speed: 0.0374s/iter; left time: 392.7610s
	iters: 400, epoch: 8 | loss: 0.0011169
	speed: 0.0358s/iter; left time: 371.6203s
Epoch: 8 cost time: 15.73196268081665
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.980274 --> -0.983704).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0263389
	speed: 0.1146s/iter; left time: 1170.8469s
	iters: 200, epoch: 9 | loss: 0.0031032
	speed: 0.0386s/iter; left time: 390.4994s
	iters: 300, epoch: 9 | loss: 0.0030046
	speed: 0.0354s/iter; left time: 354.7037s
	iters: 400, epoch: 9 | loss: 0.1878030
	speed: 0.0368s/iter; left time: 365.3116s
Epoch: 9 cost time: 17.302337646484375
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.053 Vali Acc: 0.988 Test Loss: 0.053 Test Acc: 0.988
Validation loss decreased (-0.983704 --> -0.987707).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0015243
	speed: 0.1020s/iter; left time: 994.4000s
	iters: 200, epoch: 10 | loss: 0.0012927
	speed: 0.0393s/iter; left time: 379.3380s
	iters: 300, epoch: 10 | loss: 0.0031764
	speed: 0.0358s/iter; left time: 341.7499s
	iters: 400, epoch: 10 | loss: 0.0128552
	speed: 0.0399s/iter; left time: 376.9054s
Epoch: 10 cost time: 17.523473978042603
Epoch: 10, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0074439
	speed: 0.1113s/iter; left time: 1033.3820s
	iters: 200, epoch: 11 | loss: 0.0006302
	speed: 0.0346s/iter; left time: 317.8015s
	iters: 300, epoch: 11 | loss: 0.0147578
	speed: 0.0345s/iter; left time: 313.1059s
	iters: 400, epoch: 11 | loss: 0.0005182
	speed: 0.0336s/iter; left time: 302.1081s
Epoch: 11 cost time: 16.534546613693237
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0008571
	speed: 0.1071s/iter; left time: 944.0927s
	iters: 200, epoch: 12 | loss: 0.0027891
	speed: 0.0350s/iter; left time: 305.3284s
	iters: 300, epoch: 12 | loss: 0.0002986
	speed: 0.0351s/iter; left time: 302.0786s
	iters: 400, epoch: 12 | loss: 0.0005653
	speed: 0.0349s/iter; left time: 296.7299s
Epoch: 12 cost time: 16.555755138397217
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0009790
	speed: 0.1066s/iter; left time: 888.9491s
	iters: 200, epoch: 13 | loss: 0.0010353
	speed: 0.0192s/iter; left time: 158.3084s
	iters: 300, epoch: 13 | loss: 0.0028209
	speed: 0.0270s/iter; left time: 220.2476s
	iters: 400, epoch: 13 | loss: 0.0135129
	speed: 0.0321s/iter; left time: 257.8931s
Epoch: 13 cost time: 13.860902547836304
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0182283
	speed: 0.1098s/iter; left time: 864.3494s
	iters: 200, epoch: 14 | loss: 0.0001537
	speed: 0.0366s/iter; left time: 284.7438s
	iters: 300, epoch: 14 | loss: 0.0010873
	speed: 0.0334s/iter; left time: 256.2891s
	iters: 400, epoch: 14 | loss: 0.0020105
	speed: 0.0351s/iter; left time: 265.8282s
Epoch: 14 cost time: 16.78198218345642
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0001897
	speed: 0.1094s/iter; left time: 810.2084s
	iters: 200, epoch: 15 | loss: 0.0001621
	speed: 0.0304s/iter; left time: 221.9590s
	iters: 300, epoch: 15 | loss: 0.0219557
	speed: 0.0352s/iter; left time: 253.9110s
	iters: 400, epoch: 15 | loss: 0.0003983
	speed: 0.0339s/iter; left time: 240.8877s
Epoch: 15 cost time: 15.847411394119263
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0010003
	speed: 0.1128s/iter; left time: 782.1642s
	iters: 200, epoch: 16 | loss: 0.0012229
	speed: 0.0356s/iter; left time: 243.3059s
	iters: 300, epoch: 16 | loss: 0.0012765
	speed: 0.0350s/iter; left time: 235.6953s
	iters: 400, epoch: 16 | loss: 0.0001052
	speed: 0.0346s/iter; left time: 229.5366s
Epoch: 16 cost time: 16.497812271118164
Epoch: 16, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0003449
	speed: 0.1054s/iter; left time: 681.5979s
	iters: 200, epoch: 17 | loss: 0.0006468
	speed: 0.0351s/iter; left time: 223.7003s
	iters: 300, epoch: 17 | loss: 0.0015406
	speed: 0.0346s/iter; left time: 217.0598s
	iters: 400, epoch: 17 | loss: 0.0007253
	speed: 0.0324s/iter; left time: 199.7155s
Epoch: 17 cost time: 16.154270887374878
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0010572
	speed: 0.1052s/iter; left time: 631.2356s
	iters: 200, epoch: 18 | loss: 0.0003892
	speed: 0.0349s/iter; left time: 206.0501s
	iters: 300, epoch: 18 | loss: 0.0303664
	speed: 0.0350s/iter; left time: 202.6725s
	iters: 400, epoch: 18 | loss: 0.0007859
	speed: 0.0364s/iter; left time: 207.6477s
Epoch: 18 cost time: 17.015211820602417
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0007168
	speed: 0.1114s/iter; left time: 615.8281s
	iters: 200, epoch: 19 | loss: 0.0007099
	speed: 0.0418s/iter; left time: 226.6791s
	iters: 300, epoch: 19 | loss: 0.0002295
	speed: 0.0426s/iter; left time: 226.9784s
	iters: 400, epoch: 19 | loss: 0.0001751
	speed: 0.0420s/iter; left time: 219.8345s
Epoch: 19 cost time: 19.374516248703003
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9877072612921669
model parameter : 1380490
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3851473
	speed: 0.0368s/iter; left time: 513.7345s
	iters: 200, epoch: 1 | loss: 0.7371442
	speed: 0.0233s/iter; left time: 323.6584s
	iters: 300, epoch: 1 | loss: 0.3759165
	speed: 0.0277s/iter; left time: 380.7872s
	iters: 400, epoch: 1 | loss: 0.1486230
	speed: 0.0265s/iter; left time: 362.6633s
Epoch: 1 cost time: 13.35845947265625
Epoch: 1, Steps: 469 | Train Loss: 0.760 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (inf --> -0.941679).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0908142
	speed: 0.0980s/iter; left time: 1323.2462s
	iters: 200, epoch: 2 | loss: 0.1175366
	speed: 0.0295s/iter; left time: 395.0655s
	iters: 300, epoch: 2 | loss: 0.0285672
	speed: 0.0290s/iter; left time: 386.1638s
	iters: 400, epoch: 2 | loss: 0.0347711
	speed: 0.0275s/iter; left time: 363.3558s
Epoch: 2 cost time: 14.116179704666138
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.941679 --> -0.968838).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0725198
	speed: 0.0961s/iter; left time: 1252.2693s
	iters: 200, epoch: 3 | loss: 0.0085561
	speed: 0.0246s/iter; left time: 318.5536s
	iters: 300, epoch: 3 | loss: 0.0082761
	speed: 0.0234s/iter; left time: 300.1814s
	iters: 400, epoch: 3 | loss: 0.1032532
	speed: 0.0243s/iter; left time: 308.9666s
Epoch: 3 cost time: 11.533800601959229
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.968838 --> -0.978558).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0489702
	speed: 0.0904s/iter; left time: 1136.1179s
	iters: 200, epoch: 4 | loss: 0.0361845
	speed: 0.0275s/iter; left time: 342.5904s
	iters: 300, epoch: 4 | loss: 0.0078311
	speed: 0.0273s/iter; left time: 337.2740s
	iters: 400, epoch: 4 | loss: 0.0051875
	speed: 0.0279s/iter; left time: 342.7567s
Epoch: 4 cost time: 13.202598571777344
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0098942
	speed: 0.0970s/iter; left time: 1173.3896s
	iters: 200, epoch: 5 | loss: 0.0193164
	speed: 0.0292s/iter; left time: 350.8104s
	iters: 300, epoch: 5 | loss: 0.0154189
	speed: 0.0279s/iter; left time: 332.4179s
	iters: 400, epoch: 5 | loss: 0.0055747
	speed: 0.0282s/iter; left time: 332.3180s
Epoch: 5 cost time: 14.147276878356934
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0010152
	speed: 0.0933s/iter; left time: 1085.1493s
	iters: 200, epoch: 6 | loss: 0.0088962
	speed: 0.0282s/iter; left time: 325.0802s
	iters: 300, epoch: 6 | loss: 0.0156097
	speed: 0.0305s/iter; left time: 348.5766s
	iters: 400, epoch: 6 | loss: 0.0054985
	speed: 0.0299s/iter; left time: 338.4727s
Epoch: 6 cost time: 13.868241548538208
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0073894
	speed: 0.0956s/iter; left time: 1066.6763s
	iters: 200, epoch: 7 | loss: 0.0064422
	speed: 0.0284s/iter; left time: 313.9494s
	iters: 300, epoch: 7 | loss: 0.0041161
	speed: 0.0279s/iter; left time: 305.6683s
	iters: 400, epoch: 7 | loss: 0.0036479
	speed: 0.0286s/iter; left time: 309.9751s
Epoch: 7 cost time: 13.417952537536621
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0024693
	speed: 0.0885s/iter; left time: 945.3953s
	iters: 200, epoch: 8 | loss: 0.0093569
	speed: 0.0279s/iter; left time: 295.0746s
	iters: 300, epoch: 8 | loss: 0.0032187
	speed: 0.0279s/iter; left time: 292.9401s
	iters: 400, epoch: 8 | loss: 0.0022408
	speed: 0.0232s/iter; left time: 241.1378s
Epoch: 8 cost time: 12.890064001083374
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0008270
	speed: 0.0960s/iter; left time: 981.3980s
	iters: 200, epoch: 9 | loss: 0.0156205
	speed: 0.0250s/iter; left time: 253.0596s
	iters: 300, epoch: 9 | loss: 0.0005610
	speed: 0.0260s/iter; left time: 260.2598s
	iters: 400, epoch: 9 | loss: 0.0061584
	speed: 0.0281s/iter; left time: 279.0415s
Epoch: 9 cost time: 13.045320987701416
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0004628
	speed: 0.0923s/iter; left time: 899.8654s
	iters: 200, epoch: 10 | loss: 0.0001798
	speed: 0.0290s/iter; left time: 280.2267s
	iters: 300, epoch: 10 | loss: 0.0009541
	speed: 0.0255s/iter; left time: 243.9764s
	iters: 400, epoch: 10 | loss: 0.0036229
	speed: 0.0247s/iter; left time: 233.7872s
Epoch: 10 cost time: 12.789022445678711
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2475782
	speed: 0.0979s/iter; left time: 908.8329s
	iters: 200, epoch: 11 | loss: 0.0449837
	speed: 0.0283s/iter; left time: 260.2659s
	iters: 300, epoch: 11 | loss: 0.0945519
	speed: 0.0269s/iter; left time: 244.4066s
	iters: 400, epoch: 11 | loss: 0.0024926
	speed: 0.0271s/iter; left time: 243.1013s
Epoch: 11 cost time: 13.438597917556763
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981703).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0094954
	speed: 0.0902s/iter; left time: 794.4026s
	iters: 200, epoch: 12 | loss: 0.0009199
	speed: 0.0260s/iter; left time: 226.1226s
	iters: 300, epoch: 12 | loss: 0.0007391
	speed: 0.0281s/iter; left time: 242.3385s
	iters: 400, epoch: 12 | loss: 0.0005409
	speed: 0.0289s/iter; left time: 246.0886s
Epoch: 12 cost time: 12.813041925430298
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0204148
	speed: 0.0897s/iter; left time: 748.1338s
	iters: 200, epoch: 13 | loss: 0.0023931
	speed: 0.0282s/iter; left time: 232.4907s
	iters: 300, epoch: 13 | loss: 0.0004519
	speed: 0.0247s/iter; left time: 200.9856s
	iters: 400, epoch: 13 | loss: 0.0014666
	speed: 0.0281s/iter; left time: 225.8627s
Epoch: 13 cost time: 12.945942640304565
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0005690
	speed: 0.0907s/iter; left time: 714.5443s
	iters: 200, epoch: 14 | loss: 0.0019405
	speed: 0.0255s/iter; left time: 198.5594s
	iters: 300, epoch: 14 | loss: 0.0001743
	speed: 0.0219s/iter; left time: 168.2254s
	iters: 400, epoch: 14 | loss: 0.0108537
	speed: 0.0240s/iter; left time: 181.8346s
Epoch: 14 cost time: 11.898900985717773
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0039341
	speed: 0.0866s/iter; left time: 641.3661s
	iters: 200, epoch: 15 | loss: 0.0002906
	speed: 0.0269s/iter; left time: 196.4076s
	iters: 300, epoch: 15 | loss: 0.0236613
	speed: 0.0276s/iter; left time: 199.2155s
	iters: 400, epoch: 15 | loss: 0.0133351
	speed: 0.0274s/iter; left time: 194.8435s
Epoch: 15 cost time: 12.95759105682373
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0023853
	speed: 0.0908s/iter; left time: 630.0552s
	iters: 200, epoch: 16 | loss: 0.0037389
	speed: 0.0243s/iter; left time: 166.1974s
	iters: 300, epoch: 16 | loss: 0.0072567
	speed: 0.0283s/iter; left time: 190.8410s
	iters: 400, epoch: 16 | loss: 0.0258179
	speed: 0.0271s/iter; left time: 179.9982s
Epoch: 16 cost time: 12.495999813079834
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0010954
	speed: 0.0910s/iter; left time: 588.7149s
	iters: 200, epoch: 17 | loss: 0.0009876
	speed: 0.0221s/iter; left time: 140.4622s
	iters: 300, epoch: 17 | loss: 0.0221216
	speed: 0.0211s/iter; left time: 132.4248s
	iters: 400, epoch: 17 | loss: 0.0020954
	speed: 0.0248s/iter; left time: 152.9321s
Epoch: 17 cost time: 11.409941911697388
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0008606
	speed: 0.0933s/iter; left time: 559.3676s
	iters: 200, epoch: 18 | loss: 0.0007648
	speed: 0.0242s/iter; left time: 142.6099s
	iters: 300, epoch: 18 | loss: 0.0016181
	speed: 0.0250s/iter; left time: 144.6991s
	iters: 400, epoch: 18 | loss: 0.0001537
	speed: 0.0273s/iter; left time: 155.4719s
Epoch: 18 cost time: 12.265488147735596
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0019041
	speed: 0.0907s/iter; left time: 501.2298s
	iters: 200, epoch: 19 | loss: 0.0002035
	speed: 0.0250s/iter; left time: 135.5368s
	iters: 300, epoch: 19 | loss: 0.0002848
	speed: 0.0220s/iter; left time: 117.1652s
	iters: 400, epoch: 19 | loss: 0.0005890
	speed: 0.0202s/iter; left time: 105.5426s
Epoch: 19 cost time: 10.733756303787231
Epoch: 19, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.981703 --> -0.984848).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0005653
	speed: 0.0921s/iter; left time: 466.0719s
	iters: 200, epoch: 20 | loss: 0.0011382
	speed: 0.0276s/iter; left time: 136.7198s
	iters: 300, epoch: 20 | loss: 0.0003367
	speed: 0.0283s/iter; left time: 137.7276s
	iters: 400, epoch: 20 | loss: 0.0007553
	speed: 0.0282s/iter; left time: 134.1730s
Epoch: 20 cost time: 13.150775671005249
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0026209
	speed: 0.0931s/iter; left time: 427.6373s
	iters: 200, epoch: 21 | loss: 0.0054847
	speed: 0.0277s/iter; left time: 124.3243s
	iters: 300, epoch: 21 | loss: 0.0927027
	speed: 0.0285s/iter; left time: 125.3188s
	iters: 400, epoch: 21 | loss: 0.0086610
	speed: 0.0247s/iter; left time: 106.0098s
Epoch: 21 cost time: 12.920102834701538
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0008065
	speed: 0.0838s/iter; left time: 345.3146s
	iters: 200, epoch: 22 | loss: 0.0007065
	speed: 0.0282s/iter; left time: 113.4945s
	iters: 300, epoch: 22 | loss: 0.0011012
	speed: 0.0295s/iter; left time: 115.7956s
	iters: 400, epoch: 22 | loss: 0.0004636
	speed: 0.0285s/iter; left time: 109.1180s
Epoch: 22 cost time: 12.715351819992065
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0001095
	speed: 0.0863s/iter; left time: 315.0920s
	iters: 200, epoch: 23 | loss: 0.0009308
	speed: 0.0255s/iter; left time: 90.5325s
	iters: 300, epoch: 23 | loss: 0.0001466
	speed: 0.0264s/iter; left time: 91.0325s
	iters: 400, epoch: 23 | loss: 0.0041991
	speed: 0.0258s/iter; left time: 86.6418s
Epoch: 23 cost time: 12.249956369400024
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0006970
	speed: 0.0883s/iter; left time: 281.0882s
	iters: 200, epoch: 24 | loss: 0.0044526
	speed: 0.0236s/iter; left time: 72.7448s
	iters: 300, epoch: 24 | loss: 0.0005566
	speed: 0.0254s/iter; left time: 75.8699s
	iters: 400, epoch: 24 | loss: 0.0016577
	speed: 0.0244s/iter; left time: 70.4521s
Epoch: 24 cost time: 15.630278587341309
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.2169034
	speed: 0.5898s/iter; left time: 1601.3595s
	iters: 200, epoch: 25 | loss: 0.0151273
	speed: 0.1568s/iter; left time: 409.9259s
	iters: 300, epoch: 25 | loss: 0.0003081
	speed: 0.1570s/iter; left time: 394.7745s
	iters: 400, epoch: 25 | loss: 0.0033927
	speed: 0.1571s/iter; left time: 379.4341s
Epoch: 25 cost time: 73.87711381912231
Epoch: 25, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0026733
	speed: 0.6287s/iter; left time: 1412.0247s
	iters: 200, epoch: 26 | loss: 0.0008004
	speed: 0.1570s/iter; left time: 336.8990s
	iters: 300, epoch: 26 | loss: 0.0001868
	speed: 0.1544s/iter; left time: 315.8596s
	iters: 400, epoch: 26 | loss: 0.0028018
	speed: 0.1128s/iter; left time: 219.5228s
Epoch: 26 cost time: 66.09073615074158
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0010346
	speed: 0.4469s/iter; left time: 794.1316s
	iters: 200, epoch: 27 | loss: 0.0001890
	speed: 0.1120s/iter; left time: 187.8193s
	iters: 300, epoch: 27 | loss: 0.0012871
	speed: 0.1090s/iter; left time: 171.8749s
	iters: 400, epoch: 27 | loss: 0.0002741
	speed: 0.1118s/iter; left time: 165.0553s
Epoch: 27 cost time: 52.420374631881714
Epoch: 27, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0008157
	speed: 0.4402s/iter; left time: 575.7200s
	iters: 200, epoch: 28 | loss: 0.0000393
	speed: 0.1124s/iter; left time: 135.8271s
	iters: 300, epoch: 28 | loss: 0.0398797
	speed: 0.1123s/iter; left time: 124.4536s
	iters: 400, epoch: 28 | loss: 0.0001200
	speed: 0.1116s/iter; left time: 112.4914s
Epoch: 28 cost time: 53.370240688323975
Epoch: 28, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0006572
	speed: 0.4842s/iter; left time: 406.2817s
	iters: 200, epoch: 29 | loss: 0.0000544
	speed: 0.1214s/iter; left time: 89.7455s
	iters: 300, epoch: 29 | loss: 0.0003816
	speed: 0.1213s/iter; left time: 77.4828s
	iters: 400, epoch: 29 | loss: 0.0004400
	speed: 0.1211s/iter; left time: 65.2782s
Epoch: 29 cost time: 57.159597396850586
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 4690698
model size : 18.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1399378
	speed: 0.1100s/iter; left time: 1536.2650s
	iters: 200, epoch: 1 | loss: 0.7842304
	speed: 0.0943s/iter; left time: 1307.5685s
	iters: 300, epoch: 1 | loss: 0.4670041
	speed: 0.0946s/iter; left time: 1303.3144s
	iters: 400, epoch: 1 | loss: 0.1394304
	speed: 0.0924s/iter; left time: 1262.7072s
Epoch: 1 cost time: 45.6811785697937
Epoch: 1, Steps: 469 | Train Loss: 0.811 Vali Loss: 0.209 Vali Acc: 0.940 Test Loss: 0.209 Test Acc: 0.940
Validation loss decreased (inf --> -0.939964).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0615861
	speed: 0.4237s/iter; left time: 5720.2642s
	iters: 200, epoch: 2 | loss: 0.0678101
	speed: 0.0843s/iter; left time: 1130.2550s
	iters: 300, epoch: 2 | loss: 0.1308520
	speed: 0.0873s/iter; left time: 1161.5602s
	iters: 400, epoch: 2 | loss: 0.0170356
	speed: 0.0872s/iter; left time: 1151.8018s
Epoch: 2 cost time: 40.683674335479736
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.939964 --> -0.964836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0183243
	speed: 0.3972s/iter; left time: 5176.1314s
	iters: 200, epoch: 3 | loss: 0.0043471
	speed: 0.0872s/iter; left time: 1127.8365s
	iters: 300, epoch: 3 | loss: 0.0122868
	speed: 0.0867s/iter; left time: 1112.1431s
	iters: 400, epoch: 3 | loss: 0.1271155
	speed: 0.0875s/iter; left time: 1113.5208s
Epoch: 3 cost time: 38.998260736465454
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.964836 --> -0.969124).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0378355
	speed: 0.3771s/iter; left time: 4737.7611s
	iters: 200, epoch: 4 | loss: 0.0170387
	speed: 0.0879s/iter; left time: 1095.4150s
	iters: 300, epoch: 4 | loss: 0.0040593
	speed: 0.0878s/iter; left time: 1085.6272s
	iters: 400, epoch: 4 | loss: 0.0474842
	speed: 0.0878s/iter; left time: 1076.9905s
Epoch: 4 cost time: 41.329633712768555
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4043097
	speed: 0.3998s/iter; left time: 4835.4267s
	iters: 200, epoch: 5 | loss: 0.0071580
	speed: 0.0875s/iter; left time: 1049.0155s
	iters: 300, epoch: 5 | loss: 0.0670753
	speed: 0.0850s/iter; left time: 1011.3507s
	iters: 400, epoch: 5 | loss: 0.0010900
	speed: 0.0875s/iter; left time: 1031.9001s
Epoch: 5 cost time: 41.04304122924805
Epoch: 5, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.970554).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0115309
	speed: 0.4021s/iter; left time: 4674.8769s
	iters: 200, epoch: 6 | loss: 0.0111358
	speed: 0.0941s/iter; left time: 1084.2169s
	iters: 300, epoch: 6 | loss: 0.0021814
	speed: 0.0944s/iter; left time: 1078.1597s
	iters: 400, epoch: 6 | loss: 0.0099653
	speed: 0.0944s/iter; left time: 1068.9466s
Epoch: 6 cost time: 43.9285945892334
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.970554 --> -0.977129).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0564046
	speed: 0.4304s/iter; left time: 4801.4303s
	iters: 200, epoch: 7 | loss: 0.0033416
	speed: 0.0916s/iter; left time: 1012.3026s
	iters: 300, epoch: 7 | loss: 0.0037499
	speed: 0.0945s/iter; left time: 1035.8883s
	iters: 400, epoch: 7 | loss: 0.0014652
	speed: 0.0941s/iter; left time: 1021.4444s
Epoch: 7 cost time: 44.26092767715454
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
Validation loss decreased (-0.977129 --> -0.981703).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0007977
	speed: 0.4292s/iter; left time: 4587.4330s
	iters: 200, epoch: 8 | loss: 0.0003128
	speed: 0.0950s/iter; left time: 1005.8298s
	iters: 300, epoch: 8 | loss: 0.0030583
	speed: 0.0944s/iter; left time: 990.3331s
	iters: 400, epoch: 8 | loss: 0.0012000
	speed: 0.0946s/iter; left time: 982.3074s
Epoch: 8 cost time: 44.37796139717102
Epoch: 8, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0784757
	speed: 0.4293s/iter; left time: 4386.9258s
	iters: 200, epoch: 9 | loss: 0.0026514
	speed: 0.0869s/iter; left time: 878.9976s
	iters: 300, epoch: 9 | loss: 0.0025916
	speed: 0.0875s/iter; left time: 876.2037s
	iters: 400, epoch: 9 | loss: 0.0505960
	speed: 0.0877s/iter; left time: 870.0064s
Epoch: 9 cost time: 41.68591332435608
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.981703 --> -0.984848).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0009105
	speed: 0.3987s/iter; left time: 3887.5631s
	iters: 200, epoch: 10 | loss: 0.0013481
	speed: 0.0881s/iter; left time: 850.1974s
	iters: 300, epoch: 10 | loss: 0.0047652
	speed: 0.0881s/iter; left time: 841.5147s
	iters: 400, epoch: 10 | loss: 0.0026301
	speed: 0.0876s/iter; left time: 827.7376s
Epoch: 10 cost time: 41.51927185058594
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1019937
	speed: 0.4008s/iter; left time: 3719.4537s
	iters: 200, epoch: 11 | loss: 0.0014754
	speed: 0.0867s/iter; left time: 795.8204s
	iters: 300, epoch: 11 | loss: 0.0096002
	speed: 0.0872s/iter; left time: 792.1833s
	iters: 400, epoch: 11 | loss: 0.0007056
	speed: 0.0875s/iter; left time: 786.0557s
Epoch: 11 cost time: 41.22659778594971
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0019003
	speed: 0.3973s/iter; left time: 3501.4306s
	iters: 200, epoch: 12 | loss: 0.0039296
	speed: 0.0866s/iter; left time: 754.4411s
	iters: 300, epoch: 12 | loss: 0.0003353
	speed: 0.0872s/iter; left time: 750.8772s
	iters: 400, epoch: 12 | loss: 0.0008019
	speed: 0.0870s/iter; left time: 740.3638s
Epoch: 12 cost time: 41.119380235672
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0112410
	speed: 0.3710s/iter; left time: 3095.2862s
	iters: 200, epoch: 13 | loss: 0.0015619
	speed: 0.0906s/iter; left time: 746.6543s
	iters: 300, epoch: 13 | loss: 0.0003276
	speed: 0.0940s/iter; left time: 765.5435s
	iters: 400, epoch: 13 | loss: 0.0415673
	speed: 0.0951s/iter; left time: 765.0256s
Epoch: 13 cost time: 43.58618140220642
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0212813
	speed: 0.4296s/iter; left time: 3382.9382s
	iters: 200, epoch: 14 | loss: 0.0046692
	speed: 0.0950s/iter; left time: 738.3747s
	iters: 300, epoch: 14 | loss: 0.0194242
	speed: 0.0949s/iter; left time: 728.2861s
	iters: 400, epoch: 14 | loss: 0.0037937
	speed: 0.0947s/iter; left time: 717.6214s
Epoch: 14 cost time: 44.73356008529663
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.984848 --> -0.985420).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000864
	speed: 0.4330s/iter; left time: 3206.4500s
	iters: 200, epoch: 15 | loss: 0.0002222
	speed: 0.0940s/iter; left time: 686.3552s
	iters: 300, epoch: 15 | loss: 0.0218999
	speed: 0.0937s/iter; left time: 674.9948s
	iters: 400, epoch: 15 | loss: 0.0003771
	speed: 0.0944s/iter; left time: 670.9662s
Epoch: 15 cost time: 44.41190576553345
Epoch: 15, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0694041
	speed: 0.4284s/iter; left time: 2971.1165s
	iters: 200, epoch: 16 | loss: 0.0070045
	speed: 0.0913s/iter; left time: 623.7866s
	iters: 300, epoch: 16 | loss: 0.0008274
	speed: 0.0871s/iter; left time: 586.5796s
	iters: 400, epoch: 16 | loss: 0.0001089
	speed: 0.0868s/iter; left time: 576.0434s
Epoch: 16 cost time: 42.160733461380005
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0014716
	speed: 0.3955s/iter; left time: 2557.9016s
	iters: 200, epoch: 17 | loss: 0.0022623
	speed: 0.0708s/iter; left time: 450.9052s
	iters: 300, epoch: 17 | loss: 0.0103706
	speed: 0.0738s/iter; left time: 462.4779s
	iters: 400, epoch: 17 | loss: 0.0008314
	speed: 0.0845s/iter; left time: 521.1668s
Epoch: 17 cost time: 37.99660611152649
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0120058
	speed: 0.4012s/iter; left time: 2406.3996s
	iters: 200, epoch: 18 | loss: 0.0016391
	speed: 0.0882s/iter; left time: 520.0268s
	iters: 300, epoch: 18 | loss: 0.0008373
	speed: 0.0873s/iter; left time: 505.8937s
	iters: 400, epoch: 18 | loss: 0.0008013
	speed: 0.0879s/iter; left time: 500.6100s
Epoch: 18 cost time: 41.43680191040039
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0007876
	speed: 0.4019s/iter; left time: 2221.9063s
	iters: 200, epoch: 19 | loss: 0.0002443
	speed: 0.0877s/iter; left time: 476.0544s
	iters: 300, epoch: 19 | loss: 0.0065845
	speed: 0.0878s/iter; left time: 468.0883s
	iters: 400, epoch: 19 | loss: 0.0004723
	speed: 0.0880s/iter; left time: 460.0806s
Epoch: 19 cost time: 41.49038076400757
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0004354
	speed: 0.3993s/iter; left time: 2020.6840s
	iters: 200, epoch: 20 | loss: 0.0013909
	speed: 0.0873s/iter; left time: 433.2523s
	iters: 300, epoch: 20 | loss: 0.0185366
	speed: 0.0886s/iter; left time: 430.6511s
	iters: 400, epoch: 20 | loss: 0.3010922
	speed: 0.0935s/iter; left time: 445.0470s
Epoch: 20 cost time: 42.15835905075073
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0036000
	speed: 0.4223s/iter; left time: 1938.5749s
	iters: 200, epoch: 21 | loss: 0.0002140
	speed: 0.0936s/iter; left time: 420.2956s
	iters: 300, epoch: 21 | loss: 0.0005345
	speed: 0.0909s/iter; left time: 399.2482s
	iters: 400, epoch: 21 | loss: 0.0000549
	speed: 0.0939s/iter; left time: 402.8903s
Epoch: 21 cost time: 43.9435076713562
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0036391
	speed: 0.4037s/iter; left time: 1664.2167s
	iters: 200, epoch: 22 | loss: 0.3799557
	speed: 0.0944s/iter; left time: 379.6955s
	iters: 300, epoch: 22 | loss: 0.0017027
	speed: 0.0940s/iter; left time: 368.7768s
	iters: 400, epoch: 22 | loss: 0.0047374
	speed: 0.0941s/iter; left time: 359.6945s
Epoch: 22 cost time: 44.47898483276367
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0001702
	speed: 0.4302s/iter; left time: 1571.5142s
	iters: 200, epoch: 23 | loss: 0.0001392
	speed: 0.0940s/iter; left time: 333.8473s
	iters: 300, epoch: 23 | loss: 0.0000699
	speed: 0.0945s/iter; left time: 326.2789s
	iters: 400, epoch: 23 | loss: 0.0001860
	speed: 0.0910s/iter; left time: 305.0521s
Epoch: 23 cost time: 43.724961042404175
Epoch: 23, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0127564
	speed: 0.3995s/iter; left time: 1271.8547s
	iters: 200, epoch: 24 | loss: 0.0001154
	speed: 0.0875s/iter; left time: 269.8233s
	iters: 300, epoch: 24 | loss: 0.0007593
	speed: 0.0850s/iter; left time: 253.5839s
	iters: 400, epoch: 24 | loss: 0.0002185
	speed: 0.0870s/iter; left time: 250.8613s
Epoch: 24 cost time: 40.982200145721436
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 1380490
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4258869
	speed: 0.2383s/iter; left time: 3329.4518s
	iters: 200, epoch: 1 | loss: 0.5855064
	speed: 0.2278s/iter; left time: 3160.0048s
	iters: 300, epoch: 1 | loss: 0.3284526
	speed: 0.2283s/iter; left time: 3143.4741s
	iters: 400, epoch: 1 | loss: 0.1251450
	speed: 0.2261s/iter; left time: 3090.3322s
Epoch: 1 cost time: 108.12494802474976
Epoch: 1, Steps: 469 | Train Loss: 0.777 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (inf --> -0.953686).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0697278
	speed: 0.7094s/iter; left time: 9578.4526s
	iters: 200, epoch: 2 | loss: 0.0606606
	speed: 0.2304s/iter; left time: 3088.1852s
	iters: 300, epoch: 2 | loss: 0.0080189
	speed: 0.2275s/iter; left time: 3026.5552s
	iters: 400, epoch: 2 | loss: 0.0105351
	speed: 0.2297s/iter; left time: 3032.1557s
Epoch: 2 cost time: 107.53539800643921
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
Validation loss decreased (-0.953686 --> -0.963692).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0502625
	speed: 0.6947s/iter; left time: 9054.6158s
	iters: 200, epoch: 3 | loss: 0.0046986
	speed: 0.2384s/iter; left time: 3082.6968s
	iters: 300, epoch: 3 | loss: 0.2893318
	speed: 0.2528s/iter; left time: 3244.2620s
	iters: 400, epoch: 3 | loss: 0.0143418
	speed: 0.2529s/iter; left time: 3219.5596s
Epoch: 3 cost time: 113.26466917991638
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.963692 --> -0.965408).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0049663
	speed: 0.7812s/iter; left time: 9814.6650s
	iters: 200, epoch: 4 | loss: 0.0077637
	speed: 0.2540s/iter; left time: 3166.3287s
	iters: 300, epoch: 4 | loss: 0.0181912
	speed: 0.2515s/iter; left time: 3109.3130s
	iters: 400, epoch: 4 | loss: 0.0098111
	speed: 0.2535s/iter; left time: 3108.5945s
Epoch: 4 cost time: 118.73502039909363
Epoch: 4, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.965408 --> -0.979988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0972034
	speed: 0.7627s/iter; left time: 9224.6659s
	iters: 200, epoch: 5 | loss: 0.0058287
	speed: 0.2334s/iter; left time: 2799.0790s
	iters: 300, epoch: 5 | loss: 0.0058895
	speed: 0.2331s/iter; left time: 2772.7705s
	iters: 400, epoch: 5 | loss: 0.0017320
	speed: 0.2298s/iter; left time: 2710.3330s
Epoch: 5 cost time: 109.35713052749634
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0053903
	speed: 0.7191s/iter; left time: 8360.4981s
	iters: 200, epoch: 6 | loss: 0.0011368
	speed: 0.2305s/iter; left time: 2656.8155s
	iters: 300, epoch: 6 | loss: 0.3131430
	speed: 0.2339s/iter; left time: 2672.0761s
	iters: 400, epoch: 6 | loss: 0.0665358
	speed: 0.2278s/iter; left time: 2579.7610s
Epoch: 6 cost time: 108.96719455718994
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0007195
	speed: 0.6498s/iter; left time: 7249.7759s
	iters: 200, epoch: 7 | loss: 0.0009339
	speed: 0.2313s/iter; left time: 2557.7587s
	iters: 300, epoch: 7 | loss: 0.0258558
	speed: 0.2373s/iter; left time: 2600.5869s
	iters: 400, epoch: 7 | loss: 0.0016689
	speed: 0.2455s/iter; left time: 2665.2306s
Epoch: 7 cost time: 107.32773542404175
Epoch: 7, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0009480
	speed: 0.7655s/iter; left time: 8181.7507s
	iters: 200, epoch: 8 | loss: 0.0272821
	speed: 0.2468s/iter; left time: 2613.0056s
	iters: 300, epoch: 8 | loss: 0.0304657
	speed: 0.2476s/iter; left time: 2596.5318s
	iters: 400, epoch: 8 | loss: 0.0025951
	speed: 0.2498s/iter; left time: 2594.6076s
Epoch: 8 cost time: 117.08666348457336
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0021584
	speed: 0.7750s/iter; left time: 7919.4591s
	iters: 200, epoch: 9 | loss: 0.0027588
	speed: 0.2364s/iter; left time: 2391.9479s
	iters: 300, epoch: 9 | loss: 0.0023633
	speed: 0.2329s/iter; left time: 2333.7657s
	iters: 400, epoch: 9 | loss: 0.0013007
	speed: 0.2324s/iter; left time: 2305.4760s
Epoch: 9 cost time: 111.10723567008972
Epoch: 9, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0017221
	speed: 0.7085s/iter; left time: 6907.9848s
	iters: 200, epoch: 10 | loss: 0.0088408
	speed: 0.2331s/iter; left time: 2249.8241s
	iters: 300, epoch: 10 | loss: 0.1504343
	speed: 0.2278s/iter; left time: 2175.0558s
	iters: 400, epoch: 10 | loss: 0.0008809
	speed: 0.2299s/iter; left time: 2172.3244s
Epoch: 10 cost time: 108.34171152114868
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980845).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0020432
	speed: 0.7206s/iter; left time: 6687.7182s
	iters: 200, epoch: 11 | loss: 0.0014851
	speed: 0.2289s/iter; left time: 2101.3624s
	iters: 300, epoch: 11 | loss: 0.0004791
	speed: 0.2295s/iter; left time: 2084.2030s
	iters: 400, epoch: 11 | loss: 0.0387523
	speed: 0.2339s/iter; left time: 2100.8769s
Epoch: 11 cost time: 110.01813101768494
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1075691
	speed: 0.7671s/iter; left time: 6759.8042s
	iters: 200, epoch: 12 | loss: 0.0031296
	speed: 0.2490s/iter; left time: 2169.4968s
	iters: 300, epoch: 12 | loss: 0.0012496
	speed: 0.2512s/iter; left time: 2163.3036s
	iters: 400, epoch: 12 | loss: 0.0558059
	speed: 0.2481s/iter; left time: 2111.6381s
Epoch: 12 cost time: 116.5819034576416
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0318223
	speed: 0.7737s/iter; left time: 6455.2967s
	iters: 200, epoch: 13 | loss: 0.0010906
	speed: 0.2532s/iter; left time: 2087.0134s
	iters: 300, epoch: 13 | loss: 0.0022286
	speed: 0.2422s/iter; left time: 1971.8594s
	iters: 400, epoch: 13 | loss: 0.0001627
	speed: 0.2297s/iter; left time: 1847.6781s
Epoch: 13 cost time: 114.18371176719666
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.981131).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0004221
	speed: 0.7218s/iter; left time: 5683.2638s
	iters: 200, epoch: 14 | loss: 0.0011505
	speed: 0.2250s/iter; left time: 1749.1806s
	iters: 300, epoch: 14 | loss: 0.0004519
	speed: 0.2301s/iter; left time: 1765.7959s
	iters: 400, epoch: 14 | loss: 0.0020624
	speed: 0.2326s/iter; left time: 1761.4976s
Epoch: 14 cost time: 108.22904467582703
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000811
	speed: 0.7118s/iter; left time: 5270.6025s
	iters: 200, epoch: 15 | loss: 0.0017105
	speed: 0.1995s/iter; left time: 1457.2879s
	iters: 300, epoch: 15 | loss: 0.0012792
	speed: 0.1911s/iter; left time: 1376.5606s
	iters: 400, epoch: 15 | loss: 0.0001506
	speed: 0.2354s/iter; left time: 1672.7644s
Epoch: 15 cost time: 102.04017758369446
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.983132).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001356
	speed: 0.7594s/iter; left time: 5267.2171s
	iters: 200, epoch: 16 | loss: 0.0010164
	speed: 0.2514s/iter; left time: 1718.8612s
	iters: 300, epoch: 16 | loss: 0.0012738
	speed: 0.2513s/iter; left time: 1692.5523s
	iters: 400, epoch: 16 | loss: 0.0002492
	speed: 0.2467s/iter; left time: 1636.8533s
Epoch: 16 cost time: 117.8417546749115
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0001910
	speed: 0.7718s/iter; left time: 4991.3528s
	iters: 200, epoch: 17 | loss: 0.0018186
	speed: 0.2531s/iter; left time: 1611.1902s
	iters: 300, epoch: 17 | loss: 0.0002570
	speed: 0.2536s/iter; left time: 1589.5101s
	iters: 400, epoch: 17 | loss: 0.0037618
	speed: 0.2536s/iter; left time: 1564.1990s
Epoch: 17 cost time: 117.64925026893616
Epoch: 17, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000653
	speed: 0.7230s/iter; left time: 4336.2648s
	iters: 200, epoch: 18 | loss: 0.0000654
	speed: 0.2356s/iter; left time: 1389.6702s
	iters: 300, epoch: 18 | loss: 0.0001816
	speed: 0.2304s/iter; left time: 1335.6648s
	iters: 400, epoch: 18 | loss: 0.0005515
	speed: 0.2344s/iter; left time: 1335.8237s
Epoch: 18 cost time: 109.13711786270142
Epoch: 18, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983132 --> -0.983418).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0014538
	speed: 0.7208s/iter; left time: 3985.2651s
	iters: 200, epoch: 19 | loss: 0.0004430
	speed: 0.2299s/iter; left time: 1248.3323s
	iters: 300, epoch: 19 | loss: 0.0423688
	speed: 0.2351s/iter; left time: 1252.5958s
	iters: 400, epoch: 19 | loss: 0.0001412
	speed: 0.2311s/iter; left time: 1208.3865s
Epoch: 19 cost time: 109.37699484825134
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000921
	speed: 0.7294s/iter; left time: 3690.6316s
	iters: 200, epoch: 20 | loss: 0.0001622
	speed: 0.2538s/iter; left time: 1258.7465s
	iters: 300, epoch: 20 | loss: 0.0003094
	speed: 0.2536s/iter; left time: 1232.5319s
	iters: 400, epoch: 20 | loss: 0.0011218
	speed: 0.2527s/iter; left time: 1202.8444s
Epoch: 20 cost time: 117.65302991867065
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2606138
	speed: 0.7728s/iter; left time: 3547.7813s
	iters: 200, epoch: 21 | loss: 0.0001336
	speed: 0.2494s/iter; left time: 1119.9288s
	iters: 300, epoch: 21 | loss: 0.0006403
	speed: 0.2311s/iter; left time: 1014.8289s
	iters: 400, epoch: 21 | loss: 0.0002499
	speed: 0.2527s/iter; left time: 1084.2669s
Epoch: 21 cost time: 115.97881174087524
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0004257
	speed: 0.7548s/iter; left time: 3111.1909s
	iters: 200, epoch: 22 | loss: 0.3048531
	speed: 0.2325s/iter; left time: 935.3151s
	iters: 300, epoch: 22 | loss: 0.0010648
	speed: 0.2305s/iter; left time: 904.2037s
	iters: 400, epoch: 22 | loss: 0.0007312
	speed: 0.2330s/iter; left time: 890.4910s
Epoch: 22 cost time: 109.04276609420776
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002759
	speed: 0.7178s/iter; left time: 2622.0629s
	iters: 200, epoch: 23 | loss: 0.0003885
	speed: 0.2305s/iter; left time: 818.9135s
	iters: 300, epoch: 23 | loss: 0.0000975
	speed: 0.2334s/iter; left time: 806.0606s
	iters: 400, epoch: 23 | loss: 0.0004938
	speed: 0.2322s/iter; left time: 778.5818s
Epoch: 23 cost time: 109.03117942810059
Epoch: 23, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.983418 --> -0.986277).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0016846
	speed: 0.7199s/iter; left time: 2292.0959s
	iters: 200, epoch: 24 | loss: 0.0001909
	speed: 0.2315s/iter; left time: 713.8647s
	iters: 300, epoch: 24 | loss: 0.0005622
	speed: 0.2479s/iter; left time: 739.6310s
	iters: 400, epoch: 24 | loss: 0.0000666
	speed: 0.2529s/iter; left time: 729.4787s
Epoch: 24 cost time: 114.34271049499512
Epoch: 24, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0003778
	speed: 0.7807s/iter; left time: 2119.5490s
	iters: 200, epoch: 25 | loss: 0.0003119
	speed: 0.2515s/iter; left time: 657.7072s
	iters: 300, epoch: 25 | loss: 0.0003239
	speed: 0.2460s/iter; left time: 618.7114s
	iters: 400, epoch: 25 | loss: 0.0117221
	speed: 0.2517s/iter; left time: 607.8238s
Epoch: 25 cost time: 117.44575953483582
Epoch: 25, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0001001
	speed: 0.7769s/iter; left time: 1744.9630s
	iters: 200, epoch: 26 | loss: 0.0006388
	speed: 0.2360s/iter; left time: 506.4053s
	iters: 300, epoch: 26 | loss: 0.0002061
	speed: 0.2351s/iter; left time: 481.0070s
	iters: 400, epoch: 26 | loss: 0.0025293
	speed: 0.2340s/iter; left time: 455.4210s
Epoch: 26 cost time: 112.27621054649353
Epoch: 26, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0002196
	speed: 0.7218s/iter; left time: 1282.5834s
	iters: 200, epoch: 27 | loss: 0.0013914
	speed: 0.2298s/iter; left time: 385.3569s
	iters: 300, epoch: 27 | loss: 0.0001185
	speed: 0.2329s/iter; left time: 367.2837s
	iters: 400, epoch: 27 | loss: 0.0006984
	speed: 0.2302s/iter; left time: 339.9767s
Epoch: 27 cost time: 109.05316019058228
Epoch: 27, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0004225
	speed: 0.7201s/iter; left time: 941.9398s
	iters: 200, epoch: 28 | loss: 0.0190814
	speed: 0.2336s/iter; left time: 282.2337s
	iters: 300, epoch: 28 | loss: 0.0001174
	speed: 0.2309s/iter; left time: 255.8103s
	iters: 400, epoch: 28 | loss: 0.0000771
	speed: 0.2345s/iter; left time: 236.4079s
Epoch: 28 cost time: 110.58236193656921
Epoch: 28, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0037812
	speed: 0.7830s/iter; left time: 656.9048s
	iters: 200, epoch: 29 | loss: 0.0019689
	speed: 0.2534s/iter; left time: 187.2580s
	iters: 300, epoch: 29 | loss: 0.0329665
	speed: 0.2525s/iter; left time: 161.3201s
	iters: 400, epoch: 29 | loss: 0.0028623
	speed: 0.2517s/iter; left time: 135.6606s
Epoch: 29 cost time: 118.71158838272095
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0003401
	speed: 0.7698s/iter; left time: 284.8171s
	iters: 200, epoch: 30 | loss: 0.0057532
	speed: 0.2525s/iter; left time: 68.1694s
	iters: 300, epoch: 30 | loss: 0.0008481
	speed: 0.2434s/iter; left time: 41.3799s
	iters: 400, epoch: 30 | loss: 0.0001091
	speed: 0.2353s/iter; left time: 16.4734s
Epoch: 30 cost time: 114.44776272773743
Epoch: 30, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 2347018
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4275992
	speed: 0.1672s/iter; left time: 2336.4814s
	iters: 200, epoch: 1 | loss: 0.6794625
	speed: 0.1555s/iter; left time: 2156.9788s
	iters: 300, epoch: 1 | loss: 0.2804449
	speed: 0.1544s/iter; left time: 2126.4589s
	iters: 400, epoch: 1 | loss: 0.2077858
	speed: 0.1508s/iter; left time: 2061.4282s
Epoch: 1 cost time: 73.580721616745
Epoch: 1, Steps: 469 | Train Loss: 0.780 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (inf --> -0.948826).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1573393
	speed: 0.4631s/iter; left time: 6252.7748s
	iters: 200, epoch: 2 | loss: 0.0890526
	speed: 0.1489s/iter; left time: 1995.0626s
	iters: 300, epoch: 2 | loss: 0.1361878
	speed: 0.1542s/iter; left time: 2051.0618s
	iters: 400, epoch: 2 | loss: 0.1612056
	speed: 0.1534s/iter; left time: 2024.5519s
Epoch: 2 cost time: 65.8848328590393
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.948826 --> -0.973412).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0496391
	speed: 0.5176s/iter; left time: 6745.3982s
	iters: 200, epoch: 3 | loss: 0.0295160
	speed: 0.1547s/iter; left time: 2000.4646s
	iters: 300, epoch: 3 | loss: 0.0055541
	speed: 0.1617s/iter; left time: 2074.5625s
	iters: 400, epoch: 3 | loss: 0.0046365
	speed: 0.1636s/iter; left time: 2083.0929s
Epoch: 3 cost time: 75.21356725692749
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0027888
	speed: 0.5639s/iter; left time: 7084.6677s
	iters: 200, epoch: 4 | loss: 0.0046489
	speed: 0.1667s/iter; left time: 2077.3655s
	iters: 300, epoch: 4 | loss: 0.0124399
	speed: 0.1635s/iter; left time: 2022.0684s
	iters: 400, epoch: 4 | loss: 0.0313525
	speed: 0.1657s/iter; left time: 2032.6253s
Epoch: 4 cost time: 77.97736477851868
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.977415).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0308640
	speed: 0.5668s/iter; left time: 6855.7023s
	iters: 200, epoch: 5 | loss: 0.0019037
	speed: 0.1631s/iter; left time: 1956.5178s
	iters: 300, epoch: 5 | loss: 0.0181380
	speed: 0.1602s/iter; left time: 1906.0156s
	iters: 400, epoch: 5 | loss: 0.0205627
	speed: 0.1665s/iter; left time: 1963.5606s
Epoch: 5 cost time: 77.35788488388062
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0715585
	speed: 0.5409s/iter; left time: 6288.4678s
	iters: 200, epoch: 6 | loss: 0.0008317
	speed: 0.1515s/iter; left time: 1746.0446s
	iters: 300, epoch: 6 | loss: 0.0389342
	speed: 0.1552s/iter; left time: 1773.0005s
	iters: 400, epoch: 6 | loss: 0.1199996
	speed: 0.1547s/iter; left time: 1751.9469s
Epoch: 6 cost time: 71.80549359321594
Epoch: 6, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978844).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0012438
	speed: 0.5215s/iter; left time: 5818.9111s
	iters: 200, epoch: 7 | loss: 0.0113724
	speed: 0.1551s/iter; left time: 1714.6935s
	iters: 300, epoch: 7 | loss: 0.0017351
	speed: 0.1545s/iter; left time: 1693.0663s
	iters: 400, epoch: 7 | loss: 0.0114974
	speed: 0.1530s/iter; left time: 1661.3890s
Epoch: 7 cost time: 72.0841383934021
Epoch: 7, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0034297
	speed: 0.5173s/iter; left time: 5529.0884s
	iters: 200, epoch: 8 | loss: 0.1464904
	speed: 0.1543s/iter; left time: 1633.3622s
	iters: 300, epoch: 8 | loss: 0.0008857
	speed: 0.1530s/iter; left time: 1604.5909s
	iters: 400, epoch: 8 | loss: 0.2148229
	speed: 0.1471s/iter; left time: 1527.8491s
Epoch: 8 cost time: 71.61853194236755
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1177160
	speed: 0.5254s/iter; left time: 5369.2461s
	iters: 200, epoch: 9 | loss: 0.0054354
	speed: 0.1501s/iter; left time: 1519.0892s
	iters: 300, epoch: 9 | loss: 0.0014184
	speed: 0.1633s/iter; left time: 1636.1325s
	iters: 400, epoch: 9 | loss: 0.0500222
	speed: 0.1640s/iter; left time: 1626.8025s
Epoch: 9 cost time: 74.94840836524963
Epoch: 9, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0003110
	speed: 0.5690s/iter; left time: 5548.2007s
	iters: 200, epoch: 10 | loss: 0.0019085
	speed: 0.1640s/iter; left time: 1582.5478s
	iters: 300, epoch: 10 | loss: 0.0004554
	speed: 0.1643s/iter; left time: 1568.6810s
	iters: 400, epoch: 10 | loss: 0.0006048
	speed: 0.1675s/iter; left time: 1583.0086s
Epoch: 10 cost time: 77.88957166671753
Epoch: 10, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0003276
	speed: 0.5639s/iter; left time: 5233.1412s
	iters: 200, epoch: 11 | loss: 0.0283757
	speed: 0.1641s/iter; left time: 1506.2826s
	iters: 300, epoch: 11 | loss: 0.0370640
	speed: 0.1669s/iter; left time: 1515.7882s
	iters: 400, epoch: 11 | loss: 0.0257597
	speed: 0.1645s/iter; left time: 1477.3961s
Epoch: 11 cost time: 77.4886167049408
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979988).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0012965
	speed: 0.5389s/iter; left time: 4748.6323s
	iters: 200, epoch: 12 | loss: 0.0012789
	speed: 0.1516s/iter; left time: 1320.4155s
	iters: 300, epoch: 12 | loss: 0.0112479
	speed: 0.1545s/iter; left time: 1330.3007s
	iters: 400, epoch: 12 | loss: 0.0009984
	speed: 0.1533s/iter; left time: 1305.1601s
Epoch: 12 cost time: 71.83845090866089
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0008036
	speed: 0.5248s/iter; left time: 4378.6042s
	iters: 200, epoch: 13 | loss: 0.0051786
	speed: 0.1546s/iter; left time: 1274.0606s
	iters: 300, epoch: 13 | loss: 0.0003712
	speed: 0.1533s/iter; left time: 1248.5571s
	iters: 400, epoch: 13 | loss: 0.0044125
	speed: 0.1505s/iter; left time: 1210.3739s
Epoch: 13 cost time: 72.1124677658081
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0290181
	speed: 0.5277s/iter; left time: 4154.8842s
	iters: 200, epoch: 14 | loss: 0.0021125
	speed: 0.1503s/iter; left time: 1168.1613s
	iters: 300, epoch: 14 | loss: 0.0166714
	speed: 0.1522s/iter; left time: 1168.1369s
	iters: 400, epoch: 14 | loss: 0.0038844
	speed: 0.1521s/iter; left time: 1151.8021s
Epoch: 14 cost time: 71.4188392162323
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0077637
	speed: 0.5217s/iter; left time: 3863.1917s
	iters: 200, epoch: 15 | loss: 0.0155207
	speed: 0.1517s/iter; left time: 1108.0795s
	iters: 300, epoch: 15 | loss: 0.0099619
	speed: 0.1639s/iter; left time: 1180.6490s
	iters: 400, epoch: 15 | loss: 0.0001643
	speed: 0.1681s/iter; left time: 1194.0315s
Epoch: 15 cost time: 75.28220319747925
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.979988).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001662
	speed: 0.5626s/iter; left time: 3902.2895s
	iters: 200, epoch: 16 | loss: 0.0001670
	speed: 0.1560s/iter; left time: 1066.2652s
	iters: 300, epoch: 16 | loss: 0.0001778
	speed: 0.1039s/iter; left time: 700.1900s
	iters: 400, epoch: 16 | loss: 0.0006094
	speed: 0.1653s/iter; left time: 1096.8909s
Epoch: 16 cost time: 70.68365812301636
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0017167
	speed: 0.5738s/iter; left time: 3711.0648s
	iters: 200, epoch: 17 | loss: 0.0047557
	speed: 0.1652s/iter; left time: 1051.8059s
	iters: 300, epoch: 17 | loss: 0.0523053
	speed: 0.1660s/iter; left time: 1040.5185s
	iters: 400, epoch: 17 | loss: 0.0009048
	speed: 0.1635s/iter; left time: 1008.3562s
Epoch: 17 cost time: 77.97868061065674
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0055756
	speed: 0.5373s/iter; left time: 3223.0190s
	iters: 200, epoch: 18 | loss: 0.0010620
	speed: 0.1545s/iter; left time: 911.4133s
	iters: 300, epoch: 18 | loss: 0.0013549
	speed: 0.1475s/iter; left time: 855.1081s
	iters: 400, epoch: 18 | loss: 0.0002517
	speed: 0.1537s/iter; left time: 875.7489s
Epoch: 18 cost time: 72.00908851623535
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0016878
	speed: 0.4976s/iter; left time: 2751.4089s
	iters: 200, epoch: 19 | loss: 0.0049902
	speed: 0.1001s/iter; left time: 543.1784s
	iters: 300, epoch: 19 | loss: 0.0012165
	speed: 0.1528s/iter; left time: 814.0106s
	iters: 400, epoch: 19 | loss: 0.0005057
	speed: 0.1535s/iter; left time: 802.5881s
Epoch: 19 cost time: 64.24865579605103
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000762
	speed: 0.5242s/iter; left time: 2652.3967s
	iters: 200, epoch: 20 | loss: 0.0007258
	speed: 0.1481s/iter; left time: 734.3922s
	iters: 300, epoch: 20 | loss: 0.0003703
	speed: 0.1493s/iter; left time: 725.5173s
	iters: 400, epoch: 20 | loss: 0.0000699
	speed: 0.1498s/iter; left time: 713.0143s
Epoch: 20 cost time: 70.81878232955933
Epoch: 20, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0002467
	speed: 0.5288s/iter; left time: 2427.5111s
	iters: 200, epoch: 21 | loss: 0.0936435
	speed: 0.1536s/iter; left time: 689.8509s
	iters: 300, epoch: 21 | loss: 0.0013377
	speed: 0.1616s/iter; left time: 709.4777s
	iters: 400, epoch: 21 | loss: 0.0000767
	speed: 0.1613s/iter; left time: 691.9511s
Epoch: 21 cost time: 74.60580062866211
Epoch: 21, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.981989).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0041287
	speed: 0.5653s/iter; left time: 2330.2942s
	iters: 200, epoch: 22 | loss: 0.0000387
	speed: 0.1665s/iter; left time: 669.8637s
	iters: 300, epoch: 22 | loss: 0.0001507
	speed: 0.1650s/iter; left time: 647.0200s
	iters: 400, epoch: 22 | loss: 0.0001021
	speed: 0.1638s/iter; left time: 625.8563s
Epoch: 22 cost time: 77.5467619895935
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0004123
	speed: 0.5537s/iter; left time: 2022.7973s
	iters: 200, epoch: 23 | loss: 0.0044206
	speed: 0.1674s/iter; left time: 594.8540s
	iters: 300, epoch: 23 | loss: 0.2509126
	speed: 0.1661s/iter; left time: 573.3998s
	iters: 400, epoch: 23 | loss: 0.0098022
	speed: 0.1660s/iter; left time: 556.4355s
Epoch: 23 cost time: 77.96715521812439
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0284469
	speed: 0.5292s/iter; left time: 1685.0096s
	iters: 200, epoch: 24 | loss: 0.0002837
	speed: 0.1505s/iter; left time: 464.0407s
	iters: 300, epoch: 24 | loss: 0.0006008
	speed: 0.1512s/iter; left time: 451.2416s
	iters: 400, epoch: 24 | loss: 0.0004689
	speed: 0.1548s/iter; left time: 446.3268s
Epoch: 24 cost time: 71.53298711776733
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0001419
	speed: 0.5211s/iter; left time: 1414.8675s
	iters: 200, epoch: 25 | loss: 0.0004293
	speed: 0.1518s/iter; left time: 397.0530s
	iters: 300, epoch: 25 | loss: 0.0008180
	speed: 0.1477s/iter; left time: 371.5281s
	iters: 400, epoch: 25 | loss: 0.0004003
	speed: 0.1528s/iter; left time: 368.9596s
Epoch: 25 cost time: 70.88919186592102
Epoch: 25, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0001489
	speed: 0.5241s/iter; left time: 1177.0264s
	iters: 200, epoch: 26 | loss: 0.0000883
	speed: 0.1522s/iter; left time: 326.5720s
	iters: 300, epoch: 26 | loss: 0.0001676
	speed: 0.1505s/iter; left time: 307.9960s
	iters: 400, epoch: 26 | loss: 0.0000561
	speed: 0.1486s/iter; left time: 289.1297s
Epoch: 26 cost time: 71.25273561477661
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0003199
	speed: 0.5220s/iter; left time: 927.5776s
	iters: 200, epoch: 27 | loss: 0.0000661
	speed: 0.1570s/iter; left time: 263.2932s
	iters: 300, epoch: 27 | loss: 0.0002684
	speed: 0.1647s/iter; left time: 259.7825s
	iters: 400, epoch: 27 | loss: 0.0000280
	speed: 0.1622s/iter; left time: 239.5515s
Epoch: 27 cost time: 75.23688292503357
Epoch: 27, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0002442
	speed: 0.5541s/iter; left time: 724.7233s
	iters: 200, epoch: 28 | loss: 0.0000387
	speed: 0.1661s/iter; left time: 200.6783s
	iters: 300, epoch: 28 | loss: 0.0049570
	speed: 0.1643s/iter; left time: 182.0598s
	iters: 400, epoch: 28 | loss: 0.0002803
	speed: 0.1644s/iter; left time: 165.7019s
Epoch: 28 cost time: 77.50419545173645
Epoch: 28, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0067704
	speed: 0.5529s/iter; left time: 463.8582s
	iters: 200, epoch: 29 | loss: 0.0005118
	speed: 0.1655s/iter; left time: 122.3377s
	iters: 300, epoch: 29 | loss: 0.0448287
	speed: 0.1635s/iter; left time: 104.4866s
	iters: 400, epoch: 29 | loss: 0.0027707
	speed: 0.1658s/iter; left time: 89.3406s
Epoch: 29 cost time: 76.65863299369812
Epoch: 29, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0001619
	speed: 0.5339s/iter; left time: 197.5521s
	iters: 200, epoch: 30 | loss: 0.0008980
	speed: 0.1503s/iter; left time: 40.5913s
	iters: 300, epoch: 30 | loss: 0.0000610
	speed: 0.1541s/iter; left time: 26.1937s
	iters: 400, epoch: 30 | loss: 0.1013957
	speed: 0.1535s/iter; left time: 10.7473s
Epoch: 30 cost time: 71.74538230895996
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 691850
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4269550
	speed: 0.1433s/iter; left time: 2002.1390s
	iters: 200, epoch: 1 | loss: 0.5969666
	speed: 0.1411s/iter; left time: 1957.4942s
	iters: 300, epoch: 1 | loss: 0.3428479
	speed: 0.1767s/iter; left time: 2433.7654s
	iters: 400, epoch: 1 | loss: 0.1343422
	speed: 0.1714s/iter; left time: 2342.8516s
Epoch: 1 cost time: 75.24487829208374
Epoch: 1, Steps: 469 | Train Loss: 0.786 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
Validation loss decreased (inf --> -0.947969).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0633771
	speed: 0.5937s/iter; left time: 8016.0159s
	iters: 200, epoch: 2 | loss: 0.0772061
	speed: 0.1724s/iter; left time: 2310.2896s
	iters: 300, epoch: 2 | loss: 0.0085409
	speed: 0.1737s/iter; left time: 2309.9997s
	iters: 400, epoch: 2 | loss: 0.0086460
	speed: 0.1715s/iter; left time: 2264.7674s
Epoch: 2 cost time: 80.16002106666565
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
Validation loss decreased (-0.947969 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0474740
	speed: 0.6311s/iter; left time: 8224.7124s
	iters: 200, epoch: 3 | loss: 0.0058610
	speed: 0.1883s/iter; left time: 2435.0616s
	iters: 300, epoch: 3 | loss: 0.2307344
	speed: 0.1821s/iter; left time: 2337.0587s
	iters: 400, epoch: 3 | loss: 0.0076127
	speed: 0.1871s/iter; left time: 2382.8600s
Epoch: 3 cost time: 87.44710612297058
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.964264 --> -0.970268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0104577
	speed: 0.6509s/iter; left time: 8178.0811s
	iters: 200, epoch: 4 | loss: 0.0066857
	speed: 0.1848s/iter; left time: 2303.5542s
	iters: 300, epoch: 4 | loss: 0.0331699
	speed: 0.1802s/iter; left time: 2228.0276s
	iters: 400, epoch: 4 | loss: 0.0030833
	speed: 0.1882s/iter; left time: 2308.0707s
Epoch: 4 cost time: 87.13507771492004
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.970268 --> -0.979416).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0857645
	speed: 0.6382s/iter; left time: 7718.7456s
	iters: 200, epoch: 5 | loss: 0.0024011
	speed: 0.1661s/iter; left time: 1992.0035s
	iters: 300, epoch: 5 | loss: 0.0014309
	speed: 0.1704s/iter; left time: 2027.0049s
	iters: 400, epoch: 5 | loss: 0.0075200
	speed: 0.1728s/iter; left time: 2038.0067s
Epoch: 5 cost time: 80.80503416061401
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0028250
	speed: 0.6043s/iter; left time: 7025.2152s
	iters: 200, epoch: 6 | loss: 0.0009321
	speed: 0.1688s/iter; left time: 1945.1757s
	iters: 300, epoch: 6 | loss: 0.0052736
	speed: 0.1657s/iter; left time: 1892.8169s
	iters: 400, epoch: 6 | loss: 0.0828549
	speed: 0.1693s/iter; left time: 1917.0675s
Epoch: 6 cost time: 79.8370931148529
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0006872
	speed: 0.5989s/iter; left time: 6681.9995s
	iters: 200, epoch: 7 | loss: 0.0011973
	speed: 0.1704s/iter; left time: 1884.5478s
	iters: 300, epoch: 7 | loss: 0.0055593
	speed: 0.1710s/iter; left time: 1873.6801s
	iters: 400, epoch: 7 | loss: 0.0015327
	speed: 0.1698s/iter; left time: 1843.6866s
Epoch: 7 cost time: 79.43455123901367
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0006053
	speed: 0.6058s/iter; left time: 6474.2564s
	iters: 200, epoch: 8 | loss: 0.0078683
	speed: 0.1859s/iter; left time: 1968.2752s
	iters: 300, epoch: 8 | loss: 0.0771551
	speed: 0.1845s/iter; left time: 1935.3721s
	iters: 400, epoch: 8 | loss: 0.0006081
	speed: 0.1828s/iter; left time: 1898.5471s
Epoch: 8 cost time: 86.21580076217651
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0981433
	speed: 0.6467s/iter; left time: 6608.2285s
	iters: 200, epoch: 9 | loss: 0.0011098
	speed: 0.1889s/iter; left time: 1911.9158s
	iters: 300, epoch: 9 | loss: 0.0022015
	speed: 0.1826s/iter; left time: 1829.1246s
	iters: 400, epoch: 9 | loss: 0.0013869
	speed: 0.1813s/iter; left time: 1798.3568s
Epoch: 9 cost time: 87.1635754108429
Epoch: 9, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0114650
	speed: 0.6491s/iter; left time: 6329.1403s
	iters: 200, epoch: 10 | loss: 0.0019507
	speed: 0.1864s/iter; left time: 1798.2816s
	iters: 300, epoch: 10 | loss: 0.0021512
	speed: 0.1686s/iter; left time: 1610.1481s
	iters: 400, epoch: 10 | loss: 0.0004474
	speed: 0.1694s/iter; left time: 1600.5243s
Epoch: 10 cost time: 83.56693482398987
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0030413
	speed: 0.6003s/iter; left time: 5571.0948s
	iters: 200, epoch: 11 | loss: 0.0024315
	speed: 0.1715s/iter; left time: 1574.6032s
	iters: 300, epoch: 11 | loss: 0.0003842
	speed: 0.1678s/iter; left time: 1524.1973s
	iters: 400, epoch: 11 | loss: 0.1097141
	speed: 0.1118s/iter; left time: 1004.3673s
Epoch: 11 cost time: 72.0466775894165
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0353222
	speed: 0.5796s/iter; left time: 5107.1621s
	iters: 200, epoch: 12 | loss: 0.0006853
	speed: 0.1772s/iter; left time: 1543.6073s
	iters: 300, epoch: 12 | loss: 0.0005940
	speed: 0.1745s/iter; left time: 1503.0452s
	iters: 400, epoch: 12 | loss: 0.0154459
	speed: 0.1733s/iter; left time: 1475.3273s
Epoch: 12 cost time: 82.26472663879395
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5863420
	speed: 0.6030s/iter; left time: 5031.0616s
	iters: 200, epoch: 13 | loss: 0.0015654
	speed: 0.1784s/iter; left time: 1470.4302s
	iters: 300, epoch: 13 | loss: 0.0011835
	speed: 0.1900s/iter; left time: 1547.0558s
	iters: 400, epoch: 13 | loss: 0.0113420
	speed: 0.1887s/iter; left time: 1517.3971s
Epoch: 13 cost time: 86.56237387657166
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0003695
	speed: 0.6529s/iter; left time: 5140.7545s
	iters: 200, epoch: 14 | loss: 0.0008976
	speed: 0.1881s/iter; left time: 1462.1630s
	iters: 300, epoch: 14 | loss: 0.0003852
	speed: 0.1903s/iter; left time: 1460.7088s
	iters: 400, epoch: 14 | loss: 0.0032196
	speed: 0.1889s/iter; left time: 1430.5251s
Epoch: 14 cost time: 88.92834043502808
Epoch: 14, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.979416 --> -0.983990).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001372
	speed: 0.6561s/iter; left time: 4858.4535s
	iters: 200, epoch: 15 | loss: 0.0110507
	speed: 0.1898s/iter; left time: 1386.3677s
	iters: 300, epoch: 15 | loss: 0.0014651
	speed: 0.1876s/iter; left time: 1351.4275s
	iters: 400, epoch: 15 | loss: 0.0002272
	speed: 0.1807s/iter; left time: 1283.8261s
Epoch: 15 cost time: 86.84876561164856
Epoch: 15, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002966
	speed: 0.6083s/iter; left time: 4219.3906s
	iters: 200, epoch: 16 | loss: 0.0014761
	speed: 0.1778s/iter; left time: 1215.2754s
	iters: 300, epoch: 16 | loss: 0.0004768
	speed: 0.1763s/iter; left time: 1187.5032s
	iters: 400, epoch: 16 | loss: 0.0005252
	speed: 0.1752s/iter; left time: 1162.7570s
Epoch: 16 cost time: 82.50789880752563
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0003104
	speed: 0.6019s/iter; left time: 3892.2061s
	iters: 200, epoch: 17 | loss: 0.0010486
	speed: 0.1784s/iter; left time: 1136.1232s
	iters: 300, epoch: 17 | loss: 0.0042922
	speed: 0.1777s/iter; left time: 1113.5494s
	iters: 400, epoch: 17 | loss: 0.0003671
	speed: 0.1774s/iter; left time: 1093.9106s
Epoch: 17 cost time: 83.04417777061462
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0003939
	speed: 0.6013s/iter; left time: 3606.8757s
	iters: 200, epoch: 18 | loss: 0.0006467
	speed: 0.1728s/iter; left time: 1019.3701s
	iters: 300, epoch: 18 | loss: 0.0036265
	speed: 0.1300s/iter; left time: 753.7458s
	iters: 400, epoch: 18 | loss: 0.0003711
	speed: 0.1430s/iter; left time: 814.6878s
Epoch: 18 cost time: 75.22936367988586
Epoch: 18, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.983990 --> -0.986849).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0004512
	speed: 0.6701s/iter; left time: 3704.7362s
	iters: 200, epoch: 19 | loss: 0.0004843
	speed: 0.1900s/iter; left time: 1031.4530s
	iters: 300, epoch: 19 | loss: 0.1093979
	speed: 0.1892s/iter; left time: 1008.4110s
	iters: 400, epoch: 19 | loss: 0.0001854
	speed: 0.1895s/iter; left time: 990.7420s
Epoch: 19 cost time: 89.46819925308228
Epoch: 19, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000856
	speed: 0.6662s/iter; left time: 3370.8041s
	iters: 200, epoch: 20 | loss: 0.0010697
	speed: 0.1907s/iter; left time: 945.9524s
	iters: 300, epoch: 20 | loss: 0.0007918
	speed: 0.1899s/iter; left time: 922.7521s
	iters: 400, epoch: 20 | loss: 0.0003780
	speed: 0.1880s/iter; left time: 894.9614s
Epoch: 20 cost time: 88.74180912971497
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0056544
	speed: 0.6333s/iter; left time: 2907.2630s
	iters: 200, epoch: 21 | loss: 0.0001918
	speed: 0.1788s/iter; left time: 802.8063s
	iters: 300, epoch: 21 | loss: 0.0002486
	speed: 0.1787s/iter; left time: 784.5763s
	iters: 400, epoch: 21 | loss: 0.0001427
	speed: 0.1790s/iter; left time: 767.9061s
Epoch: 21 cost time: 84.26329731941223
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000956
	speed: 0.6169s/iter; left time: 2543.0123s
	iters: 200, epoch: 22 | loss: 0.0039687
	speed: 0.1710s/iter; left time: 687.9296s
	iters: 300, epoch: 22 | loss: 0.0001773
	speed: 0.1774s/iter; left time: 695.9553s
	iters: 400, epoch: 22 | loss: 0.0066050
	speed: 0.1786s/iter; left time: 682.7465s
Epoch: 22 cost time: 81.50252032279968
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0001230
	speed: 0.6085s/iter; left time: 2222.7971s
	iters: 200, epoch: 23 | loss: 0.0002339
	speed: 0.1749s/iter; left time: 621.2597s
	iters: 300, epoch: 23 | loss: 0.0001069
	speed: 0.1780s/iter; left time: 614.7990s
	iters: 400, epoch: 23 | loss: 0.0043431
	speed: 0.1755s/iter; left time: 588.4717s
Epoch: 23 cost time: 83.27595663070679
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0020627
	speed: 0.6242s/iter; left time: 1987.6052s
	iters: 200, epoch: 24 | loss: 0.0002823
	speed: 0.1786s/iter; left time: 550.8464s
	iters: 300, epoch: 24 | loss: 0.0022833
	speed: 0.1739s/iter; left time: 519.0147s
	iters: 400, epoch: 24 | loss: 0.0000482
	speed: 0.1755s/iter; left time: 506.2839s
Epoch: 24 cost time: 83.3580915927887
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0008575
	speed: 0.6211s/iter; left time: 1686.2624s
	iters: 200, epoch: 25 | loss: 0.0002234
	speed: 0.1674s/iter; left time: 437.7966s
	iters: 300, epoch: 25 | loss: 0.0013929
	speed: 0.1687s/iter; left time: 424.2743s
	iters: 400, epoch: 25 | loss: 0.0012250
	speed: 0.1787s/iter; left time: 431.5252s
Epoch: 25 cost time: 81.95976519584656
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0002279
	speed: 0.6175s/iter; left time: 1386.9075s
	iters: 200, epoch: 26 | loss: 0.0003483
	speed: 0.1718s/iter; left time: 368.7589s
	iters: 300, epoch: 26 | loss: 0.0010395
	speed: 0.1739s/iter; left time: 355.8625s
	iters: 400, epoch: 26 | loss: 0.0040124
	speed: 0.1055s/iter; left time: 205.3623s
Epoch: 26 cost time: 75.16232991218567
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0071647
	speed: 0.5747s/iter; left time: 1021.1827s
	iters: 200, epoch: 27 | loss: 0.0189079
	speed: 0.1637s/iter; left time: 274.5806s
	iters: 300, epoch: 27 | loss: 0.0002042
	speed: 0.1667s/iter; left time: 262.9250s
	iters: 400, epoch: 27 | loss: 0.0004355
	speed: 0.1611s/iter; left time: 237.9524s
Epoch: 27 cost time: 76.79365396499634
Epoch: 27, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0026797
	speed: 0.5737s/iter; left time: 750.4217s
	iters: 200, epoch: 28 | loss: 0.0008879
	speed: 0.1614s/iter; left time: 194.9950s
	iters: 300, epoch: 28 | loss: 0.0001359
	speed: 0.1659s/iter; left time: 183.7636s
	iters: 400, epoch: 28 | loss: 0.0000678
	speed: 0.1609s/iter; left time: 162.2137s
Epoch: 28 cost time: 76.10978651046753
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9868496283590623
model parameter : 2347018
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4455788
	speed: 0.1271s/iter; left time: 1775.2456s
	iters: 200, epoch: 1 | loss: 0.7063676
	speed: 0.1185s/iter; left time: 1644.1657s
	iters: 300, epoch: 1 | loss: 0.3397972
	speed: 0.1211s/iter; left time: 1668.3156s
	iters: 400, epoch: 1 | loss: 0.2393597
	speed: 0.1216s/iter; left time: 1662.1160s
Epoch: 1 cost time: 57.17340803146362
Epoch: 1, Steps: 469 | Train Loss: 0.793 Vali Loss: 0.209 Vali Acc: 0.927 Test Loss: 0.209 Test Acc: 0.927
Validation loss decreased (inf --> -0.926527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1752148
	speed: 0.4594s/iter; left time: 6202.2858s
	iters: 200, epoch: 2 | loss: 0.0818992
	speed: 0.1214s/iter; left time: 1627.1684s
	iters: 300, epoch: 2 | loss: 0.2289243
	speed: 0.1183s/iter; left time: 1573.4856s
	iters: 400, epoch: 2 | loss: 0.2062678
	speed: 0.1163s/iter; left time: 1535.9114s
Epoch: 2 cost time: 55.745548486709595
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
Validation loss decreased (-0.926527 --> -0.973984).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0508600
	speed: 0.4543s/iter; left time: 5920.4029s
	iters: 200, epoch: 3 | loss: 0.0253474
	speed: 0.1093s/iter; left time: 1413.3556s
	iters: 300, epoch: 3 | loss: 0.0171371
	speed: 0.1086s/iter; left time: 1393.9981s
	iters: 400, epoch: 3 | loss: 0.0066809
	speed: 0.1103s/iter; left time: 1404.7001s
Epoch: 3 cost time: 52.86825776100159
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021881
	speed: 0.4331s/iter; left time: 5441.3540s
	iters: 200, epoch: 4 | loss: 0.0099933
	speed: 0.1112s/iter; left time: 1386.4047s
	iters: 300, epoch: 4 | loss: 0.0337454
	speed: 0.1136s/iter; left time: 1403.9900s
	iters: 400, epoch: 4 | loss: 0.0544441
	speed: 0.1130s/iter; left time: 1385.7015s
Epoch: 4 cost time: 53.028348445892334
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.973984 --> -0.977701).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0517206
	speed: 0.4291s/iter; left time: 5190.4310s
	iters: 200, epoch: 5 | loss: 0.0021738
	speed: 0.1130s/iter; left time: 1355.7079s
	iters: 300, epoch: 5 | loss: 0.0144475
	speed: 0.1107s/iter; left time: 1316.6867s
	iters: 400, epoch: 5 | loss: 0.0055070
	speed: 0.1084s/iter; left time: 1278.3144s
Epoch: 5 cost time: 52.344257831573486
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.977701 --> -0.980560).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0012727
	speed: 0.4282s/iter; left time: 4978.4538s
	iters: 200, epoch: 6 | loss: 0.0008241
	speed: 0.1086s/iter; left time: 1251.5199s
	iters: 300, epoch: 6 | loss: 0.0302728
	speed: 0.1080s/iter; left time: 1234.0064s
	iters: 400, epoch: 6 | loss: 0.0492326
	speed: 0.1214s/iter; left time: 1375.4829s
Epoch: 6 cost time: 53.588603496551514
Epoch: 6, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.980560 --> -0.984562).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0155947
	speed: 0.4547s/iter; left time: 5073.2447s
	iters: 200, epoch: 7 | loss: 0.0052981
	speed: 0.1207s/iter; left time: 1334.9887s
	iters: 300, epoch: 7 | loss: 0.0015610
	speed: 0.1213s/iter; left time: 1329.1957s
	iters: 400, epoch: 7 | loss: 0.0875525
	speed: 0.1202s/iter; left time: 1304.5799s
Epoch: 7 cost time: 56.269296407699585
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0020720
	speed: 0.4572s/iter; left time: 4886.2274s
	iters: 200, epoch: 8 | loss: 0.0232319
	speed: 0.1203s/iter; left time: 1273.2778s
	iters: 300, epoch: 8 | loss: 0.0032518
	speed: 0.1176s/iter; left time: 1232.9180s
	iters: 400, epoch: 8 | loss: 0.2232973
	speed: 0.1084s/iter; left time: 1125.8261s
Epoch: 8 cost time: 54.14176368713379
Epoch: 8, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0111767
	speed: 0.4272s/iter; left time: 4365.5883s
	iters: 200, epoch: 9 | loss: 0.0054047
	speed: 0.1060s/iter; left time: 1072.3807s
	iters: 300, epoch: 9 | loss: 0.0012101
	speed: 0.1106s/iter; left time: 1107.6806s
	iters: 400, epoch: 9 | loss: 0.0200047
	speed: 0.1139s/iter; left time: 1130.1550s
Epoch: 9 cost time: 52.2817759513855
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0006936
	speed: 0.4290s/iter; left time: 4182.8752s
	iters: 200, epoch: 10 | loss: 0.0040714
	speed: 0.1138s/iter; left time: 1097.9974s
	iters: 300, epoch: 10 | loss: 0.0031231
	speed: 0.1141s/iter; left time: 1089.3549s
	iters: 400, epoch: 10 | loss: 0.0009435
	speed: 0.1120s/iter; left time: 1058.1263s
Epoch: 10 cost time: 52.899375677108765
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0006409
	speed: 0.4325s/iter; left time: 4014.1827s
	iters: 200, epoch: 11 | loss: 0.0535126
	speed: 0.1121s/iter; left time: 1028.7895s
	iters: 300, epoch: 11 | loss: 0.0991750
	speed: 0.1033s/iter; left time: 937.6516s
	iters: 400, epoch: 11 | loss: 0.0039571
	speed: 0.1106s/iter; left time: 992.9314s
Epoch: 11 cost time: 52.101704120635986
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0008688
	speed: 0.4569s/iter; left time: 4025.7986s
	iters: 200, epoch: 12 | loss: 0.0013625
	speed: 0.1169s/iter; left time: 1018.2735s
	iters: 300, epoch: 12 | loss: 0.0565444
	speed: 0.1181s/iter; left time: 1017.0773s
	iters: 400, epoch: 12 | loss: 0.0006781
	speed: 0.1212s/iter; left time: 1031.9726s
Epoch: 12 cost time: 56.03174901008606
Epoch: 12, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0006192
	speed: 0.4607s/iter; left time: 3843.6066s
	iters: 200, epoch: 13 | loss: 0.0076393
	speed: 0.1212s/iter; left time: 998.7098s
	iters: 300, epoch: 13 | loss: 0.0826252
	speed: 0.1214s/iter; left time: 988.9564s
	iters: 400, epoch: 13 | loss: 0.0002400
	speed: 0.1190s/iter; left time: 956.9185s
Epoch: 13 cost time: 56.32928395271301
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
Validation loss decreased (-0.984562 --> -0.985991).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0181304
	speed: 0.4368s/iter; left time: 3439.7284s
	iters: 200, epoch: 14 | loss: 0.0092714
	speed: 0.1083s/iter; left time: 842.1037s
	iters: 300, epoch: 14 | loss: 0.0040411
	speed: 0.1081s/iter; left time: 829.6811s
	iters: 400, epoch: 14 | loss: 0.0013972
	speed: 0.1074s/iter; left time: 813.8214s
Epoch: 14 cost time: 51.83115530014038
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0476337
	speed: 0.3398s/iter; left time: 2516.5141s
	iters: 200, epoch: 15 | loss: 0.0018537
	speed: 0.1142s/iter; left time: 834.0275s
	iters: 300, epoch: 15 | loss: 0.0048692
	speed: 0.1146s/iter; left time: 826.0023s
	iters: 400, epoch: 15 | loss: 0.0002329
	speed: 0.1145s/iter; left time: 813.8262s
Epoch: 15 cost time: 53.96538996696472
Epoch: 15, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0002532
	speed: 0.4406s/iter; left time: 3055.9000s
	iters: 200, epoch: 16 | loss: 0.0005549
	speed: 0.1135s/iter; left time: 775.6289s
	iters: 300, epoch: 16 | loss: 0.0001879
	speed: 0.1095s/iter; left time: 737.5374s
	iters: 400, epoch: 16 | loss: 0.0010363
	speed: 0.1138s/iter; left time: 754.8632s
Epoch: 16 cost time: 53.053404092788696
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0347763
	speed: 0.4541s/iter; left time: 2936.3614s
	iters: 200, epoch: 17 | loss: 0.0007333
	speed: 0.1203s/iter; left time: 766.0113s
	iters: 300, epoch: 17 | loss: 0.0006702
	speed: 0.1199s/iter; left time: 751.7170s
	iters: 400, epoch: 17 | loss: 0.0002796
	speed: 0.1175s/iter; left time: 724.4055s
Epoch: 17 cost time: 56.3806574344635
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0008159
	speed: 0.4656s/iter; left time: 2792.3947s
	iters: 200, epoch: 18 | loss: 0.0014355
	speed: 0.1219s/iter; left time: 718.8122s
	iters: 300, epoch: 18 | loss: 0.0015431
	speed: 0.1219s/iter; left time: 706.6841s
	iters: 400, epoch: 18 | loss: 0.0362681
	speed: 0.1218s/iter; left time: 694.0362s
Epoch: 18 cost time: 57.53854322433472
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0004265
	speed: 0.4567s/iter; left time: 2525.1022s
	iters: 200, epoch: 19 | loss: 0.0007776
	speed: 0.1105s/iter; left time: 600.0475s
	iters: 300, epoch: 19 | loss: 0.0171559
	speed: 0.1139s/iter; left time: 606.9490s
	iters: 400, epoch: 19 | loss: 0.0002290
	speed: 0.1138s/iter; left time: 595.1066s
Epoch: 19 cost time: 53.48082137107849
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0002911
	speed: 0.4377s/iter; left time: 2214.6215s
	iters: 200, epoch: 20 | loss: 0.0006522
	speed: 0.1129s/iter; left time: 559.7383s
	iters: 300, epoch: 20 | loss: 0.0002150
	speed: 0.1096s/iter; left time: 532.4795s
	iters: 400, epoch: 20 | loss: 0.0005382
	speed: 0.1098s/iter; left time: 522.4842s
Epoch: 20 cost time: 52.6475875377655
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0012473
	speed: 0.4454s/iter; left time: 2044.9326s
	iters: 200, epoch: 21 | loss: 0.0015325
	speed: 0.1143s/iter; left time: 513.4423s
	iters: 300, epoch: 21 | loss: 0.0053420
	speed: 0.1145s/iter; left time: 502.6566s
	iters: 400, epoch: 21 | loss: 0.0001543
	speed: 0.1136s/iter; left time: 487.4350s
Epoch: 21 cost time: 53.98841691017151
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0007539
	speed: 0.4361s/iter; left time: 1797.7374s
	iters: 200, epoch: 22 | loss: 0.0000169
	speed: 0.1211s/iter; left time: 487.2586s
	iters: 300, epoch: 22 | loss: 0.0002175
	speed: 0.1212s/iter; left time: 475.3645s
	iters: 400, epoch: 22 | loss: 0.0001498
	speed: 0.1211s/iter; left time: 462.7218s
Epoch: 22 cost time: 56.284201860427856
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0004165
	speed: 0.4668s/iter; left time: 1705.1663s
	iters: 200, epoch: 23 | loss: 0.0015822
	speed: 0.1176s/iter; left time: 417.8713s
	iters: 300, epoch: 23 | loss: 0.0128888
	speed: 0.1180s/iter; left time: 407.5481s
	iters: 400, epoch: 23 | loss: 0.0007207
	speed: 0.1187s/iter; left time: 397.9574s
Epoch: 23 cost time: 56.26408553123474
Epoch: 23, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9859919954259577
model parameter : 691850
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4842379
	speed: 0.1208s/iter; left time: 1687.1422s
	iters: 200, epoch: 1 | loss: 0.7579429
	speed: 0.1052s/iter; left time: 1458.7514s
	iters: 300, epoch: 1 | loss: 0.3944731
	speed: 0.1034s/iter; left time: 1424.2851s
	iters: 400, epoch: 1 | loss: 0.2703254
	speed: 0.1036s/iter; left time: 1415.8492s
Epoch: 1 cost time: 50.694660902023315
Epoch: 1, Steps: 469 | Train Loss: 0.875 Vali Loss: 0.215 Vali Acc: 0.936 Test Loss: 0.215 Test Acc: 0.936
Validation loss decreased (inf --> -0.935961).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0714224
	speed: 0.4266s/iter; left time: 5759.2860s
	iters: 200, epoch: 2 | loss: 0.1510897
	speed: 0.1051s/iter; left time: 1408.4387s
	iters: 300, epoch: 2 | loss: 0.0124278
	speed: 0.1015s/iter; left time: 1349.8336s
	iters: 400, epoch: 2 | loss: 0.0115486
	speed: 0.1049s/iter; left time: 1385.2126s
Epoch: 2 cost time: 49.21399641036987
Epoch: 2, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
Validation loss decreased (-0.935961 --> -0.963692).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0590538
	speed: 0.4237s/iter; left time: 5521.7412s
	iters: 200, epoch: 3 | loss: 0.0101633
	speed: 0.1027s/iter; left time: 1328.6637s
	iters: 300, epoch: 3 | loss: 0.3890570
	speed: 0.1058s/iter; left time: 1357.1501s
	iters: 400, epoch: 3 | loss: 0.0258641
	speed: 0.1058s/iter; left time: 1347.0391s
Epoch: 3 cost time: 49.680630922317505
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.961 Test Loss: 0.129 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0104539
	speed: 0.4317s/iter; left time: 5424.0070s
	iters: 200, epoch: 4 | loss: 0.0110250
	speed: 0.1048s/iter; left time: 1306.7429s
	iters: 300, epoch: 4 | loss: 0.0095940
	speed: 0.1096s/iter; left time: 1355.3252s
	iters: 400, epoch: 4 | loss: 0.0079807
	speed: 0.1090s/iter; left time: 1337.2706s
Epoch: 4 cost time: 50.95451736450195
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.963692 --> -0.977987).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1071869
	speed: 0.4519s/iter; left time: 5466.1802s
	iters: 200, epoch: 5 | loss: 0.0020193
	speed: 0.1118s/iter; left time: 1341.2513s
	iters: 300, epoch: 5 | loss: 0.0187907
	speed: 0.1091s/iter; left time: 1298.0139s
	iters: 400, epoch: 5 | loss: 0.0136637
	speed: 0.1114s/iter; left time: 1313.9173s
Epoch: 5 cost time: 52.47329902648926
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.977987 --> -0.978844).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0241739
	speed: 0.4415s/iter; left time: 5132.5514s
	iters: 200, epoch: 6 | loss: 0.0031257
	speed: 0.1105s/iter; left time: 1273.1155s
	iters: 300, epoch: 6 | loss: 0.2266571
	speed: 0.1101s/iter; left time: 1257.4467s
	iters: 400, epoch: 6 | loss: 0.1095457
	speed: 0.1106s/iter; left time: 1252.2571s
Epoch: 6 cost time: 51.674986124038696
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0011949
	speed: 0.3499s/iter; left time: 3904.1212s
	iters: 200, epoch: 7 | loss: 0.0019292
	speed: 0.1041s/iter; left time: 1151.1673s
	iters: 300, epoch: 7 | loss: 0.0029851
	speed: 0.1043s/iter; left time: 1143.1687s
	iters: 400, epoch: 7 | loss: 0.0035212
	speed: 0.1001s/iter; left time: 1087.1173s
Epoch: 7 cost time: 48.818981885910034
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0012045
	speed: 0.3919s/iter; left time: 4188.6572s
	iters: 200, epoch: 8 | loss: 0.0043748
	speed: 0.0593s/iter; left time: 627.8794s
	iters: 300, epoch: 8 | loss: 0.1099302
	speed: 0.0759s/iter; left time: 795.7560s
	iters: 400, epoch: 8 | loss: 0.0012237
	speed: 0.1044s/iter; left time: 1084.4307s
Epoch: 8 cost time: 39.75218629837036
Epoch: 8, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0787314
	speed: 0.4056s/iter; left time: 4144.4542s
	iters: 200, epoch: 9 | loss: 0.0010783
	speed: 0.1028s/iter; left time: 1040.2276s
	iters: 300, epoch: 9 | loss: 0.0056108
	speed: 0.0993s/iter; left time: 994.8928s
	iters: 400, epoch: 9 | loss: 0.0043023
	speed: 0.0998s/iter; left time: 990.0549s
Epoch: 9 cost time: 46.992531061172485
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0023749
	speed: 0.4206s/iter; left time: 4100.7012s
	iters: 200, epoch: 10 | loss: 0.0044204
	speed: 0.1032s/iter; left time: 995.9910s
	iters: 300, epoch: 10 | loss: 0.0066797
	speed: 0.1090s/iter; left time: 1041.2280s
	iters: 400, epoch: 10 | loss: 0.0208710
	speed: 0.1004s/iter; left time: 948.8417s
Epoch: 10 cost time: 49.55499839782715
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0024187
	speed: 0.4386s/iter; left time: 4070.3756s
	iters: 200, epoch: 11 | loss: 0.0013184
	speed: 0.1081s/iter; left time: 992.3816s
	iters: 300, epoch: 11 | loss: 0.0028661
	speed: 0.1049s/iter; left time: 952.2436s
	iters: 400, epoch: 11 | loss: 0.0306316
	speed: 0.1025s/iter; left time: 920.7567s
Epoch: 11 cost time: 50.446433782577515
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0620083
	speed: 0.4370s/iter; left time: 3851.0180s
	iters: 200, epoch: 12 | loss: 0.0023777
	speed: 0.1019s/iter; left time: 888.0806s
	iters: 300, epoch: 12 | loss: 0.0004194
	speed: 0.1032s/iter; left time: 889.0628s
	iters: 400, epoch: 12 | loss: 0.0275129
	speed: 0.1015s/iter; left time: 863.7016s
Epoch: 12 cost time: 48.30638337135315
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979130).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0048988
	speed: 0.3967s/iter; left time: 3309.8514s
	iters: 200, epoch: 13 | loss: 0.0006449
	speed: 0.0996s/iter; left time: 820.7299s
	iters: 300, epoch: 13 | loss: 0.0025629
	speed: 0.0993s/iter; left time: 808.5687s
	iters: 400, epoch: 13 | loss: 0.0080223
	speed: 0.1042s/iter; left time: 838.4305s
Epoch: 13 cost time: 48.10478377342224
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0093507
	speed: 0.4003s/iter; left time: 3152.1542s
	iters: 200, epoch: 14 | loss: 0.0038443
	speed: 0.1011s/iter; left time: 785.6517s
	iters: 300, epoch: 14 | loss: 0.0004468
	speed: 0.1033s/iter; left time: 792.8299s
	iters: 400, epoch: 14 | loss: 0.1235140
	speed: 0.0993s/iter; left time: 752.2765s
Epoch: 14 cost time: 47.76434588432312
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0008679
	speed: 0.4097s/iter; left time: 3034.1809s
	iters: 200, epoch: 15 | loss: 0.0139306
	speed: 0.0976s/iter; left time: 713.2140s
	iters: 300, epoch: 15 | loss: 0.0023176
	speed: 0.0945s/iter; left time: 680.8604s
	iters: 400, epoch: 15 | loss: 0.0005695
	speed: 0.0682s/iter; left time: 484.4533s
Epoch: 15 cost time: 40.624539375305176
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979988).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002020
	speed: 0.4069s/iter; left time: 2822.4657s
	iters: 200, epoch: 16 | loss: 0.0067105
	speed: 0.1087s/iter; left time: 743.3658s
	iters: 300, epoch: 16 | loss: 0.0004550
	speed: 0.1057s/iter; left time: 711.8633s
	iters: 400, epoch: 16 | loss: 0.0027788
	speed: 0.1057s/iter; left time: 701.2522s
Epoch: 16 cost time: 50.44448494911194
Epoch: 16, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0006916
	speed: 0.4454s/iter; left time: 2880.3120s
	iters: 200, epoch: 17 | loss: 0.0152511
	speed: 0.1090s/iter; left time: 693.8697s
	iters: 300, epoch: 17 | loss: 0.0020347
	speed: 0.1065s/iter; left time: 667.6010s
	iters: 400, epoch: 17 | loss: 0.0007936
	speed: 0.1054s/iter; left time: 649.9347s
Epoch: 17 cost time: 50.78737497329712
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0007376
	speed: 0.4272s/iter; left time: 2562.1204s
	iters: 200, epoch: 18 | loss: 0.0035017
	speed: 0.1037s/iter; left time: 611.6324s
	iters: 300, epoch: 18 | loss: 0.0009248
	speed: 0.0998s/iter; left time: 578.6561s
	iters: 400, epoch: 18 | loss: 0.0053759
	speed: 0.1019s/iter; left time: 580.5194s
Epoch: 18 cost time: 48.12386083602905
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0007668
	speed: 0.4110s/iter; left time: 2272.4390s
	iters: 200, epoch: 19 | loss: 0.0004293
	speed: 0.1031s/iter; left time: 559.5335s
	iters: 300, epoch: 19 | loss: 0.1146290
	speed: 0.1007s/iter; left time: 536.6851s
	iters: 400, epoch: 19 | loss: 0.0007510
	speed: 0.1030s/iter; left time: 538.5873s
Epoch: 19 cost time: 48.332178592681885
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.981703).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0037850
	speed: 0.4129s/iter; left time: 2089.4550s
	iters: 200, epoch: 20 | loss: 0.1836004
	speed: 0.0999s/iter; left time: 495.4074s
	iters: 300, epoch: 20 | loss: 0.0013210
	speed: 0.1009s/iter; left time: 490.4072s
	iters: 400, epoch: 20 | loss: 0.0035283
	speed: 0.1007s/iter; left time: 479.5097s
Epoch: 20 cost time: 47.951366901397705
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.981703 --> -0.985134).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0013043
	speed: 0.4188s/iter; left time: 1922.7688s
	iters: 200, epoch: 21 | loss: 0.0004065
	speed: 0.1046s/iter; left time: 469.6703s
	iters: 300, epoch: 21 | loss: 0.0021491
	speed: 0.1035s/iter; left time: 454.4068s
	iters: 400, epoch: 21 | loss: 0.0009111
	speed: 0.1078s/iter; left time: 462.7118s
Epoch: 21 cost time: 49.57447004318237
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002237
	speed: 0.4486s/iter; left time: 1849.0477s
	iters: 200, epoch: 22 | loss: 0.0015022
	speed: 0.1058s/iter; left time: 425.4988s
	iters: 300, epoch: 22 | loss: 0.0027006
	speed: 0.1058s/iter; left time: 414.9409s
	iters: 400, epoch: 22 | loss: 0.0012360
	speed: 0.1066s/iter; left time: 407.3819s
Epoch: 22 cost time: 50.34931468963623
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0001829
	speed: 0.4460s/iter; left time: 1629.2274s
	iters: 200, epoch: 23 | loss: 0.0001581
	speed: 0.1062s/iter; left time: 377.3634s
	iters: 300, epoch: 23 | loss: 0.0000759
	speed: 0.1085s/iter; left time: 374.7058s
	iters: 400, epoch: 23 | loss: 0.0016314
	speed: 0.0990s/iter; left time: 331.8165s
Epoch: 23 cost time: 49.811830282211304
Epoch: 23, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0008593
	speed: 0.4183s/iter; left time: 1331.7472s
	iters: 200, epoch: 24 | loss: 0.0000911
	speed: 0.1009s/iter; left time: 311.0465s
	iters: 300, epoch: 24 | loss: 0.0017013
	speed: 0.1014s/iter; left time: 302.7016s
	iters: 400, epoch: 24 | loss: 0.0001160
	speed: 0.1024s/iter; left time: 295.2086s
Epoch: 24 cost time: 48.22903370857239
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0085573
	speed: 0.4110s/iter; left time: 1115.7671s
	iters: 200, epoch: 25 | loss: 0.0001912
	speed: 0.0991s/iter; left time: 259.1707s
	iters: 300, epoch: 25 | loss: 0.0004362
	speed: 0.0640s/iter; left time: 161.0642s
	iters: 400, epoch: 25 | loss: 0.0133526
	speed: 0.0609s/iter; left time: 147.1069s
Epoch: 25 cost time: 38.59602355957031
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0002406
	speed: 0.4122s/iter; left time: 925.7762s
	iters: 200, epoch: 26 | loss: 0.0038400
	speed: 0.1012s/iter; left time: 217.1758s
	iters: 300, epoch: 26 | loss: 0.0001762
	speed: 0.0993s/iter; left time: 203.1196s
	iters: 400, epoch: 26 | loss: 0.0012299
	speed: 0.1045s/iter; left time: 203.2896s
Epoch: 26 cost time: 45.74237942695618
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0002045
	speed: 0.3502s/iter; left time: 622.3848s
	iters: 200, epoch: 27 | loss: 0.0040926
	speed: 0.1028s/iter; left time: 172.4313s
	iters: 300, epoch: 27 | loss: 0.0422666
	speed: 0.1093s/iter; left time: 172.2962s
	iters: 400, epoch: 27 | loss: 0.0003339
	speed: 0.1003s/iter; left time: 148.1595s
Epoch: 27 cost time: 48.85866665840149
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0002341
	speed: 0.4331s/iter; left time: 566.4839s
	iters: 200, epoch: 28 | loss: 0.0014431
	speed: 0.1103s/iter; left time: 133.2560s
	iters: 300, epoch: 28 | loss: 0.0002963
	speed: 0.1057s/iter; left time: 117.0751s
	iters: 400, epoch: 28 | loss: 0.0000962
	speed: 0.1064s/iter; left time: 107.2112s
Epoch: 28 cost time: 50.72027516365051
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0055838
	speed: 0.4294s/iter; left time: 360.2609s
	iters: 200, epoch: 29 | loss: 0.0008531
	speed: 0.0969s/iter; left time: 71.5924s
	iters: 300, epoch: 29 | loss: 0.0001399
	speed: 0.0991s/iter; left time: 63.3536s
	iters: 400, epoch: 29 | loss: 0.0000973
	speed: 0.0823s/iter; left time: 44.3476s
Epoch: 29 cost time: 45.61743974685669
Epoch: 29, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0012168
	speed: 0.4073s/iter; left time: 150.6848s
	iters: 200, epoch: 30 | loss: 0.0001083
	speed: 0.1008s/iter; left time: 27.2105s
	iters: 300, epoch: 30 | loss: 0.0002278
	speed: 0.1030s/iter; left time: 17.5054s
	iters: 400, epoch: 30 | loss: 0.0001527
	speed: 0.0986s/iter; left time: 6.9038s
Epoch: 30 cost time: 46.878331661224365
Epoch: 30, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 2347018
model size : 9.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5280603
	speed: 0.0919s/iter; left time: 1283.6720s
	iters: 200, epoch: 1 | loss: 0.8790656
	speed: 0.0749s/iter; left time: 1038.3960s
	iters: 300, epoch: 1 | loss: 0.4672919
	speed: 0.0821s/iter; left time: 1131.1531s
	iters: 400, epoch: 1 | loss: 0.3133451
	speed: 0.0805s/iter; left time: 1100.7910s
Epoch: 1 cost time: 38.30503273010254
Epoch: 1, Steps: 469 | Train Loss: 0.890 Vali Loss: 0.265 Vali Acc: 0.910 Test Loss: 0.265 Test Acc: 0.910
Validation loss decreased (inf --> -0.909660).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2273847
	speed: 0.3637s/iter; left time: 4910.8805s
	iters: 200, epoch: 2 | loss: 0.1145585
	speed: 0.0787s/iter; left time: 1054.1426s
	iters: 300, epoch: 2 | loss: 0.1659367
	speed: 0.0817s/iter; left time: 1086.6108s
	iters: 400, epoch: 2 | loss: 0.1362485
	speed: 0.0830s/iter; left time: 1095.3308s
Epoch: 2 cost time: 37.896668910980225
Epoch: 2, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.909660 --> -0.974556).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0645445
	speed: 0.3797s/iter; left time: 4948.8093s
	iters: 200, epoch: 3 | loss: 0.0422073
	speed: 0.0838s/iter; left time: 1083.9279s
	iters: 300, epoch: 3 | loss: 0.0091723
	speed: 0.0760s/iter; left time: 974.6759s
	iters: 400, epoch: 3 | loss: 0.0113788
	speed: 0.0677s/iter; left time: 862.3571s
Epoch: 3 cost time: 37.10544419288635
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0067803
	speed: 0.3889s/iter; left time: 4886.2097s
	iters: 200, epoch: 4 | loss: 0.0091024
	speed: 0.0873s/iter; left time: 1088.0148s
	iters: 300, epoch: 4 | loss: 0.0087494
	speed: 0.0867s/iter; left time: 1071.6900s
	iters: 400, epoch: 4 | loss: 0.0442345
	speed: 0.0829s/iter; left time: 1016.7834s
Epoch: 4 cost time: 39.83008432388306
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.977415).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0785884
	speed: 0.3745s/iter; left time: 4529.2308s
	iters: 200, epoch: 5 | loss: 0.0079925
	speed: 0.0618s/iter; left time: 740.9280s
	iters: 300, epoch: 5 | loss: 0.0114509
	speed: 0.0475s/iter; left time: 564.9429s
	iters: 400, epoch: 5 | loss: 0.0172671
	speed: 0.0550s/iter; left time: 648.1670s
Epoch: 5 cost time: 29.567981958389282
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0400161
	speed: 0.3724s/iter; left time: 4329.1793s
	iters: 200, epoch: 6 | loss: 0.0013583
	speed: 0.0833s/iter; left time: 960.3722s
	iters: 300, epoch: 6 | loss: 0.1505129
	speed: 0.0834s/iter; left time: 953.1822s
	iters: 400, epoch: 6 | loss: 0.1334220
	speed: 0.0834s/iter; left time: 944.9724s
Epoch: 6 cost time: 39.440858364105225
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.980846).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0025051
	speed: 0.3792s/iter; left time: 4230.5734s
	iters: 200, epoch: 7 | loss: 0.0155141
	speed: 0.0820s/iter; left time: 906.9800s
	iters: 300, epoch: 7 | loss: 0.0372491
	speed: 0.0795s/iter; left time: 870.8542s
	iters: 400, epoch: 7 | loss: 0.0030493
	speed: 0.0822s/iter; left time: 892.4826s
Epoch: 7 cost time: 38.07612991333008
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0021860
	speed: 0.3482s/iter; left time: 3721.3748s
	iters: 200, epoch: 8 | loss: 0.1234801
	speed: 0.0833s/iter; left time: 881.9728s
	iters: 300, epoch: 8 | loss: 0.0073886
	speed: 0.0834s/iter; left time: 874.6343s
	iters: 400, epoch: 8 | loss: 0.1305471
	speed: 0.0835s/iter; left time: 867.4494s
Epoch: 8 cost time: 38.983922719955444
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0013689
	speed: 0.3904s/iter; left time: 3989.6902s
	iters: 200, epoch: 9 | loss: 0.0082399
	speed: 0.0879s/iter; left time: 889.0556s
	iters: 300, epoch: 9 | loss: 0.0076745
	speed: 0.0877s/iter; left time: 878.8186s
	iters: 400, epoch: 9 | loss: 0.0582025
	speed: 0.0876s/iter; left time: 868.6078s
Epoch: 9 cost time: 41.17283606529236
Epoch: 9, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003064
	speed: 0.3908s/iter; left time: 3810.5541s
	iters: 200, epoch: 10 | loss: 0.0018851
	speed: 0.0877s/iter; left time: 846.7390s
	iters: 300, epoch: 10 | loss: 0.0002945
	speed: 0.0879s/iter; left time: 839.1404s
	iters: 400, epoch: 10 | loss: 0.0019321
	speed: 0.0866s/iter; left time: 817.9968s
Epoch: 10 cost time: 40.66281747817993
Epoch: 10, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0012130
	speed: 0.4049s/iter; left time: 3757.5373s
	iters: 200, epoch: 11 | loss: 0.0511374
	speed: 0.0886s/iter; left time: 813.5298s
	iters: 300, epoch: 11 | loss: 0.0087859
	speed: 0.0874s/iter; left time: 793.2389s
	iters: 400, epoch: 11 | loss: 0.0466260
	speed: 0.0876s/iter; left time: 787.1019s
Epoch: 11 cost time: 41.22793507575989
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0093102
	speed: 0.3761s/iter; left time: 3313.9986s
	iters: 200, epoch: 12 | loss: 0.0141367
	speed: 0.0821s/iter; left time: 715.6447s
	iters: 300, epoch: 12 | loss: 0.0813047
	speed: 0.0796s/iter; left time: 685.3695s
	iters: 400, epoch: 12 | loss: 0.0019247
	speed: 0.0831s/iter; left time: 707.7532s
Epoch: 12 cost time: 38.28713059425354
Epoch: 12, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.980846 --> -0.985420).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0025333
	speed: 0.3752s/iter; left time: 3130.1305s
	iters: 200, epoch: 13 | loss: 0.0017859
	speed: 0.0834s/iter; left time: 687.1771s
	iters: 300, epoch: 13 | loss: 0.0008656
	speed: 0.0835s/iter; left time: 680.0629s
	iters: 400, epoch: 13 | loss: 0.0014688
	speed: 0.0830s/iter; left time: 667.6530s
Epoch: 13 cost time: 38.984623432159424
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0618621
	speed: 0.3787s/iter; left time: 2981.9289s
	iters: 200, epoch: 14 | loss: 0.0006422
	speed: 0.0824s/iter; left time: 640.7298s
	iters: 300, epoch: 14 | loss: 0.0037849
	speed: 0.0826s/iter; left time: 633.8038s
	iters: 400, epoch: 14 | loss: 0.0091788
	speed: 0.0797s/iter; left time: 603.7818s
Epoch: 14 cost time: 38.68136668205261
Epoch: 14, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0573431
	speed: 0.3769s/iter; left time: 2791.1316s
	iters: 200, epoch: 15 | loss: 0.0022590
	speed: 0.0828s/iter; left time: 604.8503s
	iters: 300, epoch: 15 | loss: 0.0163928
	speed: 0.0829s/iter; left time: 597.1197s
	iters: 400, epoch: 15 | loss: 0.0029547
	speed: 0.0848s/iter; left time: 602.2241s
Epoch: 15 cost time: 39.235316038131714
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000770
	speed: 0.4003s/iter; left time: 2776.2420s
	iters: 200, epoch: 16 | loss: 0.0003631
	speed: 0.0855s/iter; left time: 584.2973s
	iters: 300, epoch: 16 | loss: 0.0011091
	speed: 0.0878s/iter; left time: 591.4689s
	iters: 400, epoch: 16 | loss: 0.0025147
	speed: 0.0873s/iter; left time: 579.4171s
Epoch: 16 cost time: 41.14896035194397
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0009158
	speed: 0.4007s/iter; left time: 2591.0297s
	iters: 200, epoch: 17 | loss: 0.0011702
	speed: 0.0878s/iter; left time: 558.7778s
	iters: 300, epoch: 17 | loss: 0.0071448
	speed: 0.0879s/iter; left time: 550.7382s
	iters: 400, epoch: 17 | loss: 0.0000994
	speed: 0.0879s/iter; left time: 542.0282s
Epoch: 17 cost time: 41.149019956588745
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0100830
	speed: 0.3942s/iter; left time: 2364.4766s
	iters: 200, epoch: 18 | loss: 0.0008762
	speed: 0.0826s/iter; left time: 487.3480s
	iters: 300, epoch: 18 | loss: 0.0008329
	speed: 0.0825s/iter; left time: 478.1087s
	iters: 400, epoch: 18 | loss: 0.0001270
	speed: 0.0802s/iter; left time: 456.9260s
Epoch: 18 cost time: 38.763105392456055
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0002896
	speed: 0.3776s/iter; left time: 2087.8081s
	iters: 200, epoch: 19 | loss: 0.0017011
	speed: 0.0836s/iter; left time: 453.8061s
	iters: 300, epoch: 19 | loss: 0.0361028
	speed: 0.0833s/iter; left time: 443.9362s
	iters: 400, epoch: 19 | loss: 0.0002817
	speed: 0.0835s/iter; left time: 436.6425s
Epoch: 19 cost time: 39.309866189956665
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1068851
	speed: 0.3764s/iter; left time: 1904.6832s
	iters: 200, epoch: 20 | loss: 0.0048222
	speed: 0.0818s/iter; left time: 405.5132s
	iters: 300, epoch: 20 | loss: 0.0004537
	speed: 0.0822s/iter; left time: 399.2824s
	iters: 400, epoch: 20 | loss: 0.0000558
	speed: 0.0821s/iter; left time: 390.9869s
Epoch: 20 cost time: 37.97692918777466
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0005541
	speed: 0.3708s/iter; left time: 1702.3396s
	iters: 200, epoch: 21 | loss: 0.0830331
	speed: 0.0834s/iter; left time: 374.3495s
	iters: 300, epoch: 21 | loss: 0.0241081
	speed: 0.0836s/iter; left time: 366.8874s
	iters: 400, epoch: 21 | loss: 0.0001432
	speed: 0.0835s/iter; left time: 358.3002s
Epoch: 21 cost time: 39.081995248794556
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0022645
	speed: 0.3823s/iter; left time: 1575.7101s
	iters: 200, epoch: 22 | loss: 0.0000531
	speed: 0.0834s/iter; left time: 335.3792s
	iters: 300, epoch: 22 | loss: 0.0001044
	speed: 0.0823s/iter; left time: 322.7237s
	iters: 400, epoch: 22 | loss: 0.0002433
	speed: 0.0824s/iter; left time: 314.7554s
Epoch: 22 cost time: 38.70219588279724
Epoch: 22, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 691850
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4286438
	speed: 0.3141s/iter; left time: 4388.6861s
	iters: 200, epoch: 1 | loss: 0.6735258
	speed: 0.2998s/iter; left time: 4158.8956s
	iters: 300, epoch: 1 | loss: 0.3162655
	speed: 0.3613s/iter; left time: 4975.5154s
	iters: 400, epoch: 1 | loss: 0.1437417
	speed: 0.3549s/iter; left time: 4851.6100s
Epoch: 1 cost time: 157.86255311965942
Epoch: 1, Steps: 469 | Train Loss: 0.776 Vali Loss: 0.183 Vali Acc: 0.943 Test Loss: 0.183 Test Acc: 0.943
Validation loss decreased (inf --> -0.942537).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0758880
	speed: 0.9737s/iter; left time: 13146.5652s
	iters: 200, epoch: 2 | loss: 0.0419645
	speed: 0.3637s/iter; left time: 4873.8057s
	iters: 300, epoch: 2 | loss: 0.0331541
	speed: 0.3573s/iter; left time: 4752.2451s
	iters: 400, epoch: 2 | loss: 0.0283805
	speed: 0.3558s/iter; left time: 4697.1706s
Epoch: 2 cost time: 169.03152632713318
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.942537 --> -0.971697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0231992
	speed: 0.9711s/iter; left time: 12655.9885s
	iters: 200, epoch: 3 | loss: 0.0219410
	speed: 0.3585s/iter; left time: 4635.9207s
	iters: 300, epoch: 3 | loss: 0.0081017
	speed: 0.3394s/iter; left time: 4355.7008s
	iters: 400, epoch: 3 | loss: 0.1261252
	speed: 0.2914s/iter; left time: 3711.0073s
Epoch: 3 cost time: 153.11223888397217
Epoch: 3, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0176482
	speed: 0.8406s/iter; left time: 10560.8398s
	iters: 200, epoch: 4 | loss: 0.1738949
	speed: 0.3337s/iter; left time: 4159.6160s
	iters: 300, epoch: 4 | loss: 0.0235713
	speed: 0.3247s/iter; left time: 4014.7222s
	iters: 400, epoch: 4 | loss: 0.7044817
	speed: 0.3237s/iter; left time: 3969.8140s
Epoch: 4 cost time: 153.25348591804504
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0230455
	speed: 0.8142s/iter; left time: 9848.3113s
	iters: 200, epoch: 5 | loss: 0.0012077
	speed: 0.3244s/iter; left time: 3890.8974s
	iters: 300, epoch: 5 | loss: 0.0077163
	speed: 0.3208s/iter; left time: 3815.8189s
	iters: 400, epoch: 5 | loss: 0.0038706
	speed: 0.3240s/iter; left time: 3822.0546s
Epoch: 5 cost time: 153.5358452796936
Epoch: 5, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.971697 --> -0.976271).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0363661
	speed: 0.9240s/iter; left time: 10742.4199s
	iters: 200, epoch: 6 | loss: 0.0296431
	speed: 0.3516s/iter; left time: 4053.0350s
	iters: 300, epoch: 6 | loss: 0.0017615
	speed: 0.3410s/iter; left time: 3896.3635s
	iters: 400, epoch: 6 | loss: 0.0139518
	speed: 0.3541s/iter; left time: 4010.1429s
Epoch: 6 cost time: 161.52283716201782
Epoch: 6, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0819026
	speed: 0.9244s/iter; left time: 10313.5157s
	iters: 200, epoch: 7 | loss: 0.0037584
	speed: 0.3568s/iter; left time: 3945.1728s
	iters: 300, epoch: 7 | loss: 0.0110657
	speed: 0.3403s/iter; left time: 3728.9083s
	iters: 400, epoch: 7 | loss: 0.2545204
	speed: 0.3542s/iter; left time: 3845.3182s
Epoch: 7 cost time: 162.34064435958862
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0166296
	speed: 0.8805s/iter; left time: 9411.1166s
	iters: 200, epoch: 8 | loss: 0.0010325
	speed: 0.3272s/iter; left time: 3464.8718s
	iters: 300, epoch: 8 | loss: 0.0249411
	speed: 0.3231s/iter; left time: 3388.6912s
	iters: 400, epoch: 8 | loss: 0.0038484
	speed: 0.3260s/iter; left time: 3386.4216s
Epoch: 8 cost time: 152.4731206893921
Epoch: 8, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0003571
	speed: 0.8676s/iter; left time: 8865.7856s
	iters: 200, epoch: 9 | loss: 0.0012590
	speed: 0.3303s/iter; left time: 3342.4466s
	iters: 300, epoch: 9 | loss: 0.0023982
	speed: 0.3221s/iter; left time: 3227.6083s
	iters: 400, epoch: 9 | loss: 0.0006992
	speed: 0.3325s/iter; left time: 3298.2703s
Epoch: 9 cost time: 152.13189935684204
Epoch: 9, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0019160
	speed: 0.8668s/iter; left time: 8451.0008s
	iters: 200, epoch: 10 | loss: 0.0032021
	speed: 0.3458s/iter; left time: 3337.0788s
	iters: 300, epoch: 10 | loss: 0.0012544
	speed: 0.3388s/iter; left time: 3235.5164s
	iters: 400, epoch: 10 | loss: 0.0676023
	speed: 0.3534s/iter; left time: 3339.6707s
Epoch: 10 cost time: 159.54561042785645
Epoch: 10, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0007167
	speed: 0.9253s/iter; left time: 8587.2498s
	iters: 200, epoch: 11 | loss: 0.0008090
	speed: 0.2617s/iter; left time: 2402.6583s
	iters: 300, epoch: 11 | loss: 0.0024520
	speed: 0.3471s/iter; left time: 3151.7646s
	iters: 400, epoch: 11 | loss: 0.0007223
	speed: 0.3494s/iter; left time: 3138.0256s
Epoch: 11 cost time: 155.210608959198
Epoch: 11, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0191477
	speed: 0.9436s/iter; left time: 8314.9016s
	iters: 200, epoch: 12 | loss: 0.0015844
	speed: 0.3342s/iter; left time: 2911.6389s
	iters: 300, epoch: 12 | loss: 0.0005235
	speed: 0.3361s/iter; left time: 2894.3960s
	iters: 400, epoch: 12 | loss: 0.0107486
	speed: 0.3328s/iter; left time: 2832.6615s
Epoch: 12 cost time: 158.32120656967163
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0011664
	speed: 0.8297s/iter; left time: 6922.4335s
	iters: 200, epoch: 13 | loss: 0.0007891
	speed: 0.3267s/iter; left time: 2693.2029s
	iters: 300, epoch: 13 | loss: 0.1283832
	speed: 0.3343s/iter; left time: 2721.8414s
	iters: 400, epoch: 13 | loss: 0.0001487
	speed: 0.3360s/iter; left time: 2702.3125s
Epoch: 13 cost time: 156.776109457016
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0002929
	speed: 0.9070s/iter; left time: 7141.6751s
	iters: 200, epoch: 14 | loss: 0.0011476
	speed: 0.3318s/iter; left time: 2579.2651s
	iters: 300, epoch: 14 | loss: 0.0003377
	speed: 0.3287s/iter; left time: 2522.0649s
	iters: 400, epoch: 14 | loss: 0.0003082
	speed: 0.3610s/iter; left time: 2734.4672s
Epoch: 14 cost time: 160.45209217071533
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0004209
	speed: 0.9490s/iter; left time: 7027.6359s
	iters: 200, epoch: 15 | loss: 0.0018539
	speed: 0.3573s/iter; left time: 2610.2076s
	iters: 300, epoch: 15 | loss: 0.0006326
	speed: 0.3597s/iter; left time: 2591.9661s
	iters: 400, epoch: 15 | loss: 0.0006281
	speed: 0.3532s/iter; left time: 2509.7640s
Epoch: 15 cost time: 166.79196953773499
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.976271 --> -0.982561).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0009980
	speed: 0.9437s/iter; left time: 6545.6654s
	iters: 200, epoch: 16 | loss: 0.0374581
	speed: 0.3539s/iter; left time: 2419.4228s
	iters: 300, epoch: 16 | loss: 0.0053096
	speed: 0.3538s/iter; left time: 2383.4644s
	iters: 400, epoch: 16 | loss: 0.0243881
	speed: 0.3523s/iter; left time: 2337.8094s
Epoch: 16 cost time: 165.41109251976013
Epoch: 16, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0005878
	speed: 0.9067s/iter; left time: 5863.3259s
	iters: 200, epoch: 17 | loss: 0.0002338
	speed: 0.3384s/iter; left time: 2154.8241s
	iters: 300, epoch: 17 | loss: 0.0001358
	speed: 0.3420s/iter; left time: 2143.0821s
	iters: 400, epoch: 17 | loss: 0.0002286
	speed: 0.3403s/iter; left time: 2098.8718s
Epoch: 17 cost time: 158.42269277572632
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0043721
	speed: 0.8953s/iter; left time: 5370.1759s
	iters: 200, epoch: 18 | loss: 0.0083565
	speed: 0.3415s/iter; left time: 2014.2859s
	iters: 300, epoch: 18 | loss: 0.1101167
	speed: 0.3405s/iter; left time: 1974.0828s
	iters: 400, epoch: 18 | loss: 0.0053742
	speed: 0.3353s/iter; left time: 1910.4821s
Epoch: 18 cost time: 158.4259171485901
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0007533
	speed: 0.9127s/iter; left time: 5046.5271s
	iters: 200, epoch: 19 | loss: 0.0015187
	speed: 0.3510s/iter; left time: 1905.5468s
	iters: 300, epoch: 19 | loss: 0.0000987
	speed: 0.3511s/iter; left time: 1870.8204s
	iters: 400, epoch: 19 | loss: 0.0004942
	speed: 0.3536s/iter; left time: 1849.0069s
Epoch: 19 cost time: 164.35394191741943
Epoch: 19, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.982561 --> -0.984276).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0003408
	speed: 0.9394s/iter; left time: 4753.3301s
	iters: 200, epoch: 20 | loss: 0.0000557
	speed: 0.3529s/iter; left time: 1750.2057s
	iters: 300, epoch: 20 | loss: 0.0219555
	speed: 0.3558s/iter; left time: 1729.2444s
	iters: 400, epoch: 20 | loss: 0.0001134
	speed: 0.3510s/iter; left time: 1670.9326s
Epoch: 20 cost time: 163.81909775733948
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.059 Vali Acc: 0.988 Test Loss: 0.059 Test Acc: 0.988
Validation loss decreased (-0.984276 --> -0.988278).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0002236
	speed: 0.9270s/iter; left time: 4255.8240s
	iters: 200, epoch: 21 | loss: 0.0042167
	speed: 0.3500s/iter; left time: 1571.8799s
	iters: 300, epoch: 21 | loss: 0.0034657
	speed: 0.3383s/iter; left time: 1485.5977s
	iters: 400, epoch: 21 | loss: 0.0003971
	speed: 0.3304s/iter; left time: 1417.7529s
Epoch: 21 cost time: 156.03638529777527
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0002665
	speed: 0.8157s/iter; left time: 3362.4186s
	iters: 200, epoch: 22 | loss: 0.0000773
	speed: 0.3370s/iter; left time: 1355.3708s
	iters: 300, epoch: 22 | loss: 0.0000648
	speed: 0.3261s/iter; left time: 1279.1405s
	iters: 400, epoch: 22 | loss: 0.0000516
	speed: 0.3235s/iter; left time: 1236.5886s
Epoch: 22 cost time: 154.22908091545105
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0016490
	speed: 0.8293s/iter; left time: 3029.2949s
	iters: 200, epoch: 23 | loss: 0.0007905
	speed: 0.3064s/iter; left time: 1088.6285s
	iters: 300, epoch: 23 | loss: 0.0026624
	speed: 0.3238s/iter; left time: 1118.2283s
	iters: 400, epoch: 23 | loss: 0.0001794
	speed: 0.3199s/iter; left time: 1072.5499s
Epoch: 23 cost time: 146.54495358467102
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000951
	speed: 0.8969s/iter; left time: 2855.7027s
	iters: 200, epoch: 24 | loss: 0.1025349
	speed: 0.3338s/iter; left time: 1029.5874s
	iters: 300, epoch: 24 | loss: 0.0008742
	speed: 0.3286s/iter; left time: 980.6283s
	iters: 400, epoch: 24 | loss: 0.0006750
	speed: 0.3350s/iter; left time: 966.2535s
Epoch: 24 cost time: 156.0615153312683
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0006650
	speed: 0.8622s/iter; left time: 2340.8750s
	iters: 200, epoch: 25 | loss: 0.0000843
	speed: 0.2713s/iter; left time: 709.3568s
	iters: 300, epoch: 25 | loss: 0.0002515
	speed: 0.3364s/iter; left time: 846.0158s
	iters: 400, epoch: 25 | loss: 0.0084781
	speed: 0.3327s/iter; left time: 803.3668s
Epoch: 25 cost time: 147.37774848937988
Epoch: 25, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0002676
	speed: 0.8899s/iter; left time: 1998.7994s
	iters: 200, epoch: 26 | loss: 0.0000883
	speed: 0.3275s/iter; left time: 702.7328s
	iters: 300, epoch: 26 | loss: 0.0000571
	speed: 0.3305s/iter; left time: 676.1317s
	iters: 400, epoch: 26 | loss: 0.0279947
	speed: 0.3226s/iter; left time: 627.7162s
Epoch: 26 cost time: 153.4814088344574
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0003227
	speed: 0.8484s/iter; left time: 1507.6506s
	iters: 200, epoch: 27 | loss: 0.0003296
	speed: 0.3325s/iter; left time: 557.5747s
	iters: 300, epoch: 27 | loss: 0.0002947
	speed: 0.3219s/iter; left time: 507.5629s
	iters: 400, epoch: 27 | loss: 0.0001327
	speed: 0.3276s/iter; left time: 483.9244s
Epoch: 27 cost time: 150.3972406387329
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000347
	speed: 0.8863s/iter; left time: 1159.3059s
	iters: 200, epoch: 28 | loss: 0.0000900
	speed: 0.3249s/iter; left time: 392.5021s
	iters: 300, epoch: 28 | loss: 0.0002561
	speed: 0.3009s/iter; left time: 333.3624s
	iters: 400, epoch: 28 | loss: 0.0179293
	speed: 0.2866s/iter; left time: 288.9402s
Epoch: 28 cost time: 148.3218116760254
Epoch: 28, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000069
	speed: 0.9169s/iter; left time: 769.2468s
	iters: 200, epoch: 29 | loss: 0.0002967
	speed: 0.3357s/iter; left time: 248.1147s
	iters: 300, epoch: 29 | loss: 0.0052918
	speed: 0.3439s/iter; left time: 219.7418s
	iters: 400, epoch: 29 | loss: 0.0329419
	speed: 0.3455s/iter; left time: 186.2148s
Epoch: 29 cost time: 160.09569716453552
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0049812
	speed: 0.8968s/iter; left time: 331.8320s
	iters: 200, epoch: 30 | loss: 0.0001932
	speed: 0.3388s/iter; left time: 91.4841s
	iters: 300, epoch: 30 | loss: 0.0565819
	speed: 0.3423s/iter; left time: 58.1983s
	iters: 400, epoch: 30 | loss: 0.0002142
	speed: 0.3351s/iter; left time: 23.4568s
Epoch: 30 cost time: 157.9236068725586
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9882790165809033
model parameter : 1175178
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6567063
	speed: 0.2059s/iter; left time: 2877.2225s
	iters: 200, epoch: 1 | loss: 0.8566843
	speed: 0.1898s/iter; left time: 2632.5730s
	iters: 300, epoch: 1 | loss: 0.2938244
	speed: 0.1911s/iter; left time: 2631.0957s
	iters: 400, epoch: 1 | loss: 0.1253997
	speed: 0.1931s/iter; left time: 2639.5096s
Epoch: 1 cost time: 91.12118077278137
Epoch: 1, Steps: 469 | Train Loss: 0.868 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (inf --> -0.930244).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1825066
	speed: 0.5587s/iter; left time: 7543.2406s
	iters: 200, epoch: 2 | loss: 0.0575409
	speed: 0.1670s/iter; left time: 2238.3777s
	iters: 300, epoch: 2 | loss: 0.2140415
	speed: 0.1851s/iter; left time: 2462.7674s
	iters: 400, epoch: 2 | loss: 0.0334310
	speed: 0.1842s/iter; left time: 2432.3183s
Epoch: 2 cost time: 82.38038992881775
Epoch: 2, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.930244 --> -0.966837).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0181604
	speed: 0.5816s/iter; left time: 7579.9808s
	iters: 200, epoch: 3 | loss: 0.0963914
	speed: 0.1888s/iter; left time: 2441.7123s
	iters: 300, epoch: 3 | loss: 0.0369011
	speed: 0.1847s/iter; left time: 2370.7878s
	iters: 400, epoch: 3 | loss: 0.0227556
	speed: 0.1903s/iter; left time: 2422.6260s
Epoch: 3 cost time: 87.93641924858093
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.966837 --> -0.977415).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0579145
	speed: 0.5784s/iter; left time: 7266.4942s
	iters: 200, epoch: 4 | loss: 0.0140014
	speed: 0.1915s/iter; left time: 2386.8853s
	iters: 300, epoch: 4 | loss: 0.0544291
	speed: 0.1855s/iter; left time: 2293.1050s
	iters: 400, epoch: 4 | loss: 0.1166653
	speed: 0.1905s/iter; left time: 2336.6081s
Epoch: 4 cost time: 87.75417447090149
Epoch: 4, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.977415 --> -0.980274).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0073801
	speed: 0.5823s/iter; left time: 7042.6703s
	iters: 200, epoch: 5 | loss: 0.0095927
	speed: 0.1863s/iter; left time: 2235.1760s
	iters: 300, epoch: 5 | loss: 0.0026330
	speed: 0.1918s/iter; left time: 2281.9411s
	iters: 400, epoch: 5 | loss: 0.0113772
	speed: 0.1891s/iter; left time: 2229.9293s
Epoch: 5 cost time: 88.95843553543091
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0011812
	speed: 0.5925s/iter; left time: 6888.5401s
	iters: 200, epoch: 6 | loss: 0.0051981
	speed: 0.1821s/iter; left time: 2099.4535s
	iters: 300, epoch: 6 | loss: 0.0023312
	speed: 0.1907s/iter; left time: 2178.7954s
	iters: 400, epoch: 6 | loss: 0.0026571
	speed: 0.1861s/iter; left time: 2107.7042s
Epoch: 6 cost time: 88.88006687164307
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0956606
	speed: 0.5982s/iter; left time: 6674.5205s
	iters: 200, epoch: 7 | loss: 0.0057866
	speed: 0.1832s/iter; left time: 2025.6775s
	iters: 300, epoch: 7 | loss: 0.0009681
	speed: 0.1854s/iter; left time: 2031.8585s
	iters: 400, epoch: 7 | loss: 0.0135931
	speed: 0.1836s/iter; left time: 1993.7563s
Epoch: 7 cost time: 88.09994435310364
Epoch: 7, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0007292
	speed: 0.5946s/iter; left time: 6355.5192s
	iters: 200, epoch: 8 | loss: 0.0014898
	speed: 0.1887s/iter; left time: 1998.3250s
	iters: 300, epoch: 8 | loss: 0.0017523
	speed: 0.1861s/iter; left time: 1951.6156s
	iters: 400, epoch: 8 | loss: 0.0008804
	speed: 0.1881s/iter; left time: 1953.8189s
Epoch: 8 cost time: 88.04697728157043
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
Validation loss decreased (-0.980274 --> -0.986277).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003020
	speed: 0.5831s/iter; left time: 5959.2074s
	iters: 200, epoch: 9 | loss: 0.0060416
	speed: 0.1378s/iter; left time: 1394.4729s
	iters: 300, epoch: 9 | loss: 0.0006115
	speed: 0.1804s/iter; left time: 1807.5960s
	iters: 400, epoch: 9 | loss: 0.0027865
	speed: 0.1935s/iter; left time: 1919.1252s
Epoch: 9 cost time: 83.0135350227356
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0053019
	speed: 0.5929s/iter; left time: 5780.2972s
	iters: 200, epoch: 10 | loss: 0.0822043
	speed: 0.1920s/iter; left time: 1852.8609s
	iters: 300, epoch: 10 | loss: 0.0467254
	speed: 0.1951s/iter; left time: 1863.2743s
	iters: 400, epoch: 10 | loss: 0.0008861
	speed: 0.1949s/iter; left time: 1842.0972s
Epoch: 10 cost time: 90.27809309959412
Epoch: 10, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004196
	speed: 0.5898s/iter; left time: 5473.7390s
	iters: 200, epoch: 11 | loss: 0.3974785
	speed: 0.1875s/iter; left time: 1721.4686s
	iters: 300, epoch: 11 | loss: 0.0001785
	speed: 0.1909s/iter; left time: 1733.8976s
	iters: 400, epoch: 11 | loss: 0.0015989
	speed: 0.1282s/iter; left time: 1151.7524s
Epoch: 11 cost time: 82.81361889839172
Epoch: 11, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0015217
	speed: 0.5848s/iter; left time: 5152.9361s
	iters: 200, epoch: 12 | loss: 0.6201504
	speed: 0.1936s/iter; left time: 1686.2517s
	iters: 300, epoch: 12 | loss: 0.0763710
	speed: 0.1873s/iter; left time: 1613.1797s
	iters: 400, epoch: 12 | loss: 0.0123460
	speed: 0.1779s/iter; left time: 1513.8785s
Epoch: 12 cost time: 87.52996325492859
Epoch: 12, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0027232
	speed: 0.5893s/iter; left time: 4916.7034s
	iters: 200, epoch: 13 | loss: 0.0018497
	speed: 0.1928s/iter; left time: 1589.3333s
	iters: 300, epoch: 13 | loss: 0.0007105
	speed: 0.1874s/iter; left time: 1526.2963s
	iters: 400, epoch: 13 | loss: 0.0283845
	speed: 0.1816s/iter; left time: 1460.3185s
Epoch: 13 cost time: 88.52445816993713
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0072893
	speed: 0.5971s/iter; left time: 4701.7527s
	iters: 200, epoch: 14 | loss: 0.0008376
	speed: 0.1896s/iter; left time: 1473.7842s
	iters: 300, epoch: 14 | loss: 0.0078125
	speed: 0.1865s/iter; left time: 1431.0742s
	iters: 400, epoch: 14 | loss: 0.0002467
	speed: 0.1838s/iter; left time: 1392.0637s
Epoch: 14 cost time: 88.1169183254242
Epoch: 14, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0003049
	speed: 0.5848s/iter; left time: 4330.2384s
	iters: 200, epoch: 15 | loss: 0.0001984
	speed: 0.1894s/iter; left time: 1383.8999s
	iters: 300, epoch: 15 | loss: 0.0022583
	speed: 0.1920s/iter; left time: 1383.0582s
	iters: 400, epoch: 15 | loss: 0.0001562
	speed: 0.1858s/iter; left time: 1320.4584s
Epoch: 15 cost time: 87.93490219116211
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0027945
	speed: 0.5854s/iter; left time: 4060.4420s
	iters: 200, epoch: 16 | loss: 0.0004075
	speed: 0.1933s/iter; left time: 1321.5596s
	iters: 300, epoch: 16 | loss: 0.0008500
	speed: 0.1912s/iter; left time: 1287.9600s
	iters: 400, epoch: 16 | loss: 0.0974553
	speed: 0.1847s/iter; left time: 1225.9375s
Epoch: 16 cost time: 88.49901485443115
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0003289
	speed: 0.5787s/iter; left time: 3742.1711s
	iters: 200, epoch: 17 | loss: 0.0001148
	speed: 0.1932s/iter; left time: 1229.7919s
	iters: 300, epoch: 17 | loss: 0.0000503
	speed: 0.1912s/iter; left time: 1198.4862s
	iters: 400, epoch: 17 | loss: 0.0010513
	speed: 0.1799s/iter; left time: 1109.5308s
Epoch: 17 cost time: 87.36689043045044
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0001712
	speed: 0.5852s/iter; left time: 3510.0208s
	iters: 200, epoch: 18 | loss: 0.0016292
	speed: 0.1917s/iter; left time: 1130.4020s
	iters: 300, epoch: 18 | loss: 0.0029689
	speed: 0.1885s/iter; left time: 1093.0134s
	iters: 400, epoch: 18 | loss: 0.0136922
	speed: 0.1799s/iter; left time: 1025.2155s
Epoch: 18 cost time: 87.5179693698883
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 347530
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4292979
	speed: 0.2365s/iter; left time: 3303.6028s
	iters: 200, epoch: 1 | loss: 0.6809453
	speed: 0.2235s/iter; left time: 3100.6635s
	iters: 300, epoch: 1 | loss: 0.2950355
	speed: 0.2205s/iter; left time: 3036.7068s
	iters: 400, epoch: 1 | loss: 0.1366077
	speed: 0.2285s/iter; left time: 3123.1625s
Epoch: 1 cost time: 105.43549156188965
Epoch: 1, Steps: 469 | Train Loss: 0.785 Vali Loss: 0.192 Vali Acc: 0.938 Test Loss: 0.192 Test Acc: 0.938
Validation loss decreased (inf --> -0.937677).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1010449
	speed: 0.6395s/iter; left time: 8634.9643s
	iters: 200, epoch: 2 | loss: 0.0331849
	speed: 0.2245s/iter; left time: 3008.8240s
	iters: 300, epoch: 2 | loss: 0.0448982
	speed: 0.2236s/iter; left time: 2974.6946s
	iters: 400, epoch: 2 | loss: 0.0512494
	speed: 0.2182s/iter; left time: 2880.4873s
Epoch: 2 cost time: 104.48889589309692
Epoch: 2, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.937677 --> -0.973127).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0298882
	speed: 0.6523s/iter; left time: 8501.5120s
	iters: 200, epoch: 3 | loss: 0.0144828
	speed: 0.2230s/iter; left time: 2883.8716s
	iters: 300, epoch: 3 | loss: 0.0067540
	speed: 0.2239s/iter; left time: 2873.3833s
	iters: 400, epoch: 3 | loss: 0.1291959
	speed: 0.2271s/iter; left time: 2891.3902s
Epoch: 3 cost time: 106.10168862342834
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.973127 --> -0.976271).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0167729
	speed: 0.6448s/iter; left time: 8101.0681s
	iters: 200, epoch: 4 | loss: 0.2057315
	speed: 0.2233s/iter; left time: 2783.4433s
	iters: 300, epoch: 4 | loss: 0.0433617
	speed: 0.2255s/iter; left time: 2788.2524s
	iters: 400, epoch: 4 | loss: 0.6936532
	speed: 0.2241s/iter; left time: 2748.5968s
Epoch: 4 cost time: 105.30012059211731
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0292047
	speed: 0.6415s/iter; left time: 7759.3916s
	iters: 200, epoch: 5 | loss: 0.0026754
	speed: 0.2285s/iter; left time: 2741.3465s
	iters: 300, epoch: 5 | loss: 0.0049930
	speed: 0.2231s/iter; left time: 2653.7799s
	iters: 400, epoch: 5 | loss: 0.0020900
	speed: 0.2200s/iter; left time: 2594.6047s
Epoch: 5 cost time: 100.1134901046753
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976271 --> -0.979988).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0881607
	speed: 0.5790s/iter; left time: 6731.1714s
	iters: 200, epoch: 6 | loss: 0.0088498
	speed: 0.2265s/iter; left time: 2611.0489s
	iters: 300, epoch: 6 | loss: 0.0017417
	speed: 0.2270s/iter; left time: 2593.6904s
	iters: 400, epoch: 6 | loss: 0.0047577
	speed: 0.2238s/iter; left time: 2534.2329s
Epoch: 6 cost time: 106.94454026222229
Epoch: 6, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0724790
	speed: 0.6567s/iter; left time: 7327.1228s
	iters: 200, epoch: 7 | loss: 0.0137628
	speed: 0.2119s/iter; left time: 2342.4307s
	iters: 300, epoch: 7 | loss: 0.0101549
	speed: 0.2335s/iter; left time: 2558.8572s
	iters: 400, epoch: 7 | loss: 0.2796985
	speed: 0.2145s/iter; left time: 2328.6390s
Epoch: 7 cost time: 97.72048163414001
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.952 Test Loss: 0.144 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0132528
	speed: 0.5924s/iter; left time: 6331.2455s
	iters: 200, epoch: 8 | loss: 0.0017864
	speed: 0.2271s/iter; left time: 2404.6022s
	iters: 300, epoch: 8 | loss: 0.0284028
	speed: 0.2229s/iter; left time: 2338.2710s
	iters: 400, epoch: 8 | loss: 0.0011083
	speed: 0.2380s/iter; left time: 2472.3290s
Epoch: 8 cost time: 108.39376902580261
Epoch: 8, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0012493
	speed: 0.6592s/iter; left time: 6736.5373s
	iters: 200, epoch: 9 | loss: 0.0017849
	speed: 0.2348s/iter; left time: 2376.2985s
	iters: 300, epoch: 9 | loss: 0.0032315
	speed: 0.2291s/iter; left time: 2295.2367s
	iters: 400, epoch: 9 | loss: 0.0021148
	speed: 0.2295s/iter; left time: 2276.6465s
Epoch: 9 cost time: 108.57667541503906
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0033876
	speed: 0.6653s/iter; left time: 6486.8855s
	iters: 200, epoch: 10 | loss: 0.0339842
	speed: 0.2305s/iter; left time: 2224.3761s
	iters: 300, epoch: 10 | loss: 0.0048027
	speed: 0.2268s/iter; left time: 2166.2400s
	iters: 400, epoch: 10 | loss: 0.0148755
	speed: 0.2332s/iter; left time: 2203.6569s
Epoch: 10 cost time: 108.90707063674927
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0016736
	speed: 0.6607s/iter; left time: 6132.2153s
	iters: 200, epoch: 11 | loss: 0.0063733
	speed: 0.2369s/iter; left time: 2174.9317s
	iters: 300, epoch: 11 | loss: 0.0274101
	speed: 0.2351s/iter; left time: 2135.2524s
	iters: 400, epoch: 11 | loss: 0.0025581
	speed: 0.2261s/iter; left time: 2031.0229s
Epoch: 11 cost time: 108.19853472709656
Epoch: 11, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0050993
	speed: 0.6687s/iter; left time: 5892.4618s
	iters: 200, epoch: 12 | loss: 0.0012406
	speed: 0.2237s/iter; left time: 1948.5536s
	iters: 300, epoch: 12 | loss: 0.0115597
	speed: 0.2341s/iter; left time: 2016.2591s
	iters: 400, epoch: 12 | loss: 0.0151651
	speed: 0.2345s/iter; left time: 1995.8319s
Epoch: 12 cost time: 108.31208038330078
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.981703).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0023129
	speed: 0.6634s/iter; left time: 5534.8650s
	iters: 200, epoch: 13 | loss: 0.0041566
	speed: 0.2319s/iter; left time: 1911.3443s
	iters: 300, epoch: 13 | loss: 0.0007225
	speed: 0.2310s/iter; left time: 1881.3070s
	iters: 400, epoch: 13 | loss: 0.0007789
	speed: 0.2315s/iter; left time: 1862.2127s
Epoch: 13 cost time: 108.70464730262756
Epoch: 13, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982561).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0002701
	speed: 0.5337s/iter; left time: 4202.5978s
	iters: 200, epoch: 14 | loss: 0.0006344
	speed: 0.1557s/iter; left time: 1210.1178s
	iters: 300, epoch: 14 | loss: 0.0010843
	speed: 0.2162s/iter; left time: 1659.3113s
	iters: 400, epoch: 14 | loss: 0.0001703
	speed: 0.2157s/iter; left time: 1633.4823s
Epoch: 14 cost time: 91.73972654342651
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982847).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002859
	speed: 0.6225s/iter; left time: 4609.8820s
	iters: 200, epoch: 15 | loss: 0.0138022
	speed: 0.2201s/iter; left time: 1608.1110s
	iters: 300, epoch: 15 | loss: 0.0007082
	speed: 0.2108s/iter; left time: 1518.9731s
	iters: 400, epoch: 15 | loss: 0.0164440
	speed: 0.2172s/iter; left time: 1542.8591s
Epoch: 15 cost time: 101.33198571205139
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0093208
	speed: 0.6267s/iter; left time: 4347.1371s
	iters: 200, epoch: 16 | loss: 0.0150672
	speed: 0.2128s/iter; left time: 1454.6373s
	iters: 300, epoch: 16 | loss: 0.0049362
	speed: 0.2143s/iter; left time: 1443.6122s
	iters: 400, epoch: 16 | loss: 0.0041275
	speed: 0.2208s/iter; left time: 1465.0260s
Epoch: 16 cost time: 101.99124002456665
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0008278
	speed: 0.6200s/iter; left time: 4009.8041s
	iters: 200, epoch: 17 | loss: 0.0020716
	speed: 0.2244s/iter; left time: 1428.5065s
	iters: 300, epoch: 17 | loss: 0.0007965
	speed: 0.2003s/iter; left time: 1255.0448s
	iters: 400, epoch: 17 | loss: 0.0002397
	speed: 0.1482s/iter; left time: 913.7775s
Epoch: 17 cost time: 94.61615633964539
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0009963
	speed: 0.6531s/iter; left time: 3917.5594s
	iters: 200, epoch: 18 | loss: 0.0008263
	speed: 0.2290s/iter; left time: 1350.6784s
	iters: 300, epoch: 18 | loss: 0.1048099
	speed: 0.2253s/iter; left time: 1306.3947s
	iters: 400, epoch: 18 | loss: 0.0038753
	speed: 0.2218s/iter; left time: 1263.7414s
Epoch: 18 cost time: 106.36370825767517
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0002491
	speed: 0.5859s/iter; left time: 3239.2676s
	iters: 200, epoch: 19 | loss: 0.0001720
	speed: 0.2336s/iter; left time: 1268.1706s
	iters: 300, epoch: 19 | loss: 0.3202110
	speed: 0.2289s/iter; left time: 1219.6168s
	iters: 400, epoch: 19 | loss: 0.0015177
	speed: 0.2350s/iter; left time: 1228.8157s
Epoch: 19 cost time: 104.30615592002869
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0010879
	speed: 0.6605s/iter; left time: 3342.3245s
	iters: 200, epoch: 20 | loss: 0.0006722
	speed: 0.2308s/iter; left time: 1144.9914s
	iters: 300, epoch: 20 | loss: 0.0031182
	speed: 0.2278s/iter; left time: 1107.1705s
	iters: 400, epoch: 20 | loss: 0.0000561
	speed: 0.2217s/iter; left time: 1055.2324s
Epoch: 20 cost time: 106.87364864349365
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0001523
	speed: 0.6700s/iter; left time: 3075.7829s
	iters: 200, epoch: 21 | loss: 0.0285069
	speed: 0.2300s/iter; left time: 1032.7844s
	iters: 300, epoch: 21 | loss: 0.0004162
	speed: 0.2358s/iter; left time: 1035.5239s
	iters: 400, epoch: 21 | loss: 0.0001232
	speed: 0.2282s/iter; left time: 979.1078s
Epoch: 21 cost time: 109.22336220741272
Epoch: 21, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.982847 --> -0.983990).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001181
	speed: 0.6642s/iter; left time: 2737.7028s
	iters: 200, epoch: 22 | loss: 0.0002334
	speed: 0.2312s/iter; left time: 930.0139s
	iters: 300, epoch: 22 | loss: 0.0001506
	speed: 0.2339s/iter; left time: 917.2397s
	iters: 400, epoch: 22 | loss: 0.0000374
	speed: 0.2318s/iter; left time: 885.9617s
Epoch: 22 cost time: 109.22767806053162
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000889
	speed: 0.6593s/iter; left time: 2408.4318s
	iters: 200, epoch: 23 | loss: 0.0031405
	speed: 0.1664s/iter; left time: 591.2667s
	iters: 300, epoch: 23 | loss: 0.0008080
	speed: 0.2213s/iter; left time: 764.0716s
	iters: 400, epoch: 23 | loss: 0.0003910
	speed: 0.2214s/iter; left time: 742.2365s
Epoch: 23 cost time: 98.48158097267151
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0001163
	speed: 0.6442s/iter; left time: 2050.9991s
	iters: 200, epoch: 24 | loss: 0.0001398
	speed: 0.2248s/iter; left time: 693.3972s
	iters: 300, epoch: 24 | loss: 0.0012181
	speed: 0.2237s/iter; left time: 667.4981s
	iters: 400, epoch: 24 | loss: 0.0008106
	speed: 0.2229s/iter; left time: 642.8640s
Epoch: 24 cost time: 104.58012580871582
Epoch: 24, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.984276).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0003109
	speed: 0.6355s/iter; left time: 1725.3509s
	iters: 200, epoch: 25 | loss: 0.0000272
	speed: 0.2249s/iter; left time: 588.0506s
	iters: 300, epoch: 25 | loss: 0.0003957
	speed: 0.2254s/iter; left time: 566.8126s
	iters: 400, epoch: 25 | loss: 0.0864954
	speed: 0.2247s/iter; left time: 542.6934s
Epoch: 25 cost time: 105.20481300354004
Epoch: 25, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000476
	speed: 0.6427s/iter; left time: 1443.4975s
	iters: 200, epoch: 26 | loss: 0.0002194
	speed: 0.2208s/iter; left time: 473.9400s
	iters: 300, epoch: 26 | loss: 0.0001145
	speed: 0.1974s/iter; left time: 403.8088s
	iters: 400, epoch: 26 | loss: 0.0000547
	speed: 0.1846s/iter; left time: 359.2886s
Epoch: 26 cost time: 99.02728319168091
Epoch: 26, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0004378
	speed: 0.6700s/iter; left time: 1190.6330s
	iters: 200, epoch: 27 | loss: 0.0005459
	speed: 0.2361s/iter; left time: 395.8799s
	iters: 300, epoch: 27 | loss: 0.0001666
	speed: 0.2291s/iter; left time: 361.2664s
	iters: 400, epoch: 27 | loss: 0.0554061
	speed: 0.2293s/iter; left time: 338.6177s
Epoch: 27 cost time: 109.1452853679657
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0014484
	speed: 0.6567s/iter; left time: 858.9628s
	iters: 200, epoch: 28 | loss: 0.0000781
	speed: 0.2345s/iter; left time: 283.2851s
	iters: 300, epoch: 28 | loss: 0.0006077
	speed: 0.2275s/iter; left time: 252.0282s
	iters: 400, epoch: 28 | loss: 0.0103537
	speed: 0.2373s/iter; left time: 239.1984s
Epoch: 28 cost time: 109.16154885292053
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000045
	speed: 0.6672s/iter; left time: 559.7652s
	iters: 200, epoch: 29 | loss: 0.0001524
	speed: 0.2176s/iter; left time: 160.8355s
	iters: 300, epoch: 29 | loss: 0.0409434
	speed: 0.2320s/iter; left time: 148.2287s
	iters: 400, epoch: 29 | loss: 0.0052945
	speed: 0.2326s/iter; left time: 125.3790s
Epoch: 29 cost time: 107.67084169387817
Epoch: 29, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0013768
	speed: 0.6695s/iter; left time: 247.7181s
	iters: 200, epoch: 30 | loss: 0.0009477
	speed: 0.2314s/iter; left time: 62.4896s
	iters: 300, epoch: 30 | loss: 0.0004725
	speed: 0.2312s/iter; left time: 39.2981s
	iters: 400, epoch: 30 | loss: 0.0003529
	speed: 0.2322s/iter; left time: 16.2513s
Epoch: 30 cost time: 108.86506199836731
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 1175178
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6608407
	speed: 0.1570s/iter; left time: 2193.2385s
	iters: 200, epoch: 1 | loss: 0.8558576
	speed: 0.1442s/iter; left time: 2000.5153s
	iters: 300, epoch: 1 | loss: 0.3022010
	speed: 0.1486s/iter; left time: 2046.7835s
	iters: 400, epoch: 1 | loss: 0.1262328
	speed: 0.1463s/iter; left time: 2000.4283s
Epoch: 1 cost time: 69.88402605056763
Epoch: 1, Steps: 469 | Train Loss: 0.875 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (inf --> -0.935389).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1814567
	speed: 0.5145s/iter; left time: 6946.6921s
	iters: 200, epoch: 2 | loss: 0.0975557
	speed: 0.1448s/iter; left time: 1940.2730s
	iters: 300, epoch: 2 | loss: 0.1973964
	speed: 0.1415s/iter; left time: 1882.6497s
	iters: 400, epoch: 2 | loss: 0.0369293
	speed: 0.1425s/iter; left time: 1881.6606s
Epoch: 2 cost time: 67.77517294883728
Epoch: 2, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.935389 --> -0.965979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0382209
	speed: 0.5072s/iter; left time: 6610.3399s
	iters: 200, epoch: 3 | loss: 0.0765963
	speed: 0.1444s/iter; left time: 1867.8807s
	iters: 300, epoch: 3 | loss: 0.0299985
	speed: 0.1482s/iter; left time: 1901.4394s
	iters: 400, epoch: 3 | loss: 0.0171005
	speed: 0.1470s/iter; left time: 1871.2556s
Epoch: 3 cost time: 68.07714462280273
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.965979 --> -0.979416).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0499536
	speed: 0.5146s/iter; left time: 6465.8704s
	iters: 200, epoch: 4 | loss: 0.0088248
	speed: 0.1463s/iter; left time: 1823.6321s
	iters: 300, epoch: 4 | loss: 0.1019683
	speed: 0.1412s/iter; left time: 1746.3828s
	iters: 400, epoch: 4 | loss: 0.2103908
	speed: 0.1415s/iter; left time: 1735.9027s
Epoch: 4 cost time: 68.22143006324768
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0223465
	speed: 0.5100s/iter; left time: 6168.0263s
	iters: 200, epoch: 5 | loss: 0.0087359
	speed: 0.1387s/iter; left time: 1663.4405s
	iters: 300, epoch: 5 | loss: 0.0052518
	speed: 0.1482s/iter; left time: 1763.4123s
	iters: 400, epoch: 5 | loss: 0.0060350
	speed: 0.1479s/iter; left time: 1744.4528s
Epoch: 5 cost time: 67.77161145210266
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0009249
	speed: 0.5121s/iter; left time: 5953.7884s
	iters: 200, epoch: 6 | loss: 0.0075903
	speed: 0.1463s/iter; left time: 1686.0361s
	iters: 300, epoch: 6 | loss: 0.0033844
	speed: 0.1428s/iter; left time: 1631.3060s
	iters: 400, epoch: 6 | loss: 0.0030417
	speed: 0.1419s/iter; left time: 1607.0634s
Epoch: 6 cost time: 68.30699706077576
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.981989).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0623314
	speed: 0.5097s/iter; left time: 5687.1316s
	iters: 200, epoch: 7 | loss: 0.0074833
	speed: 0.1418s/iter; left time: 1567.9957s
	iters: 300, epoch: 7 | loss: 0.0005015
	speed: 0.1422s/iter; left time: 1558.3295s
	iters: 400, epoch: 7 | loss: 0.0155021
	speed: 0.1460s/iter; left time: 1584.7869s
Epoch: 7 cost time: 67.29370093345642
Epoch: 7, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0010406
	speed: 0.4358s/iter; left time: 4658.2815s
	iters: 200, epoch: 8 | loss: 0.0012391
	speed: 0.1459s/iter; left time: 1544.3599s
	iters: 300, epoch: 8 | loss: 0.0015143
	speed: 0.1418s/iter; left time: 1487.5018s
	iters: 400, epoch: 8 | loss: 0.0040424
	speed: 0.1401s/iter; left time: 1454.9774s
Epoch: 8 cost time: 66.67389297485352
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.981989 --> -0.981989).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020342
	speed: 0.5046s/iter; left time: 5156.5535s
	iters: 200, epoch: 9 | loss: 0.0062116
	speed: 0.1423s/iter; left time: 1439.7089s
	iters: 300, epoch: 9 | loss: 0.0006931
	speed: 0.1442s/iter; left time: 1444.9163s
	iters: 400, epoch: 9 | loss: 0.0037104
	speed: 0.1425s/iter; left time: 1413.4571s
Epoch: 9 cost time: 66.91439723968506
Epoch: 9, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0035471
	speed: 0.5018s/iter; left time: 4892.3474s
	iters: 200, epoch: 10 | loss: 0.0664975
	speed: 0.1449s/iter; left time: 1398.2431s
	iters: 300, epoch: 10 | loss: 0.0544424
	speed: 0.1362s/iter; left time: 1300.2326s
	iters: 400, epoch: 10 | loss: 0.0022263
	speed: 0.1386s/iter; left time: 1309.6857s
Epoch: 10 cost time: 66.6799852848053
Epoch: 10, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004956
	speed: 0.5094s/iter; left time: 4727.4337s
	iters: 200, epoch: 11 | loss: 0.4404175
	speed: 0.1391s/iter; left time: 1277.0963s
	iters: 300, epoch: 11 | loss: 0.0005098
	speed: 0.1432s/iter; left time: 1300.6390s
	iters: 400, epoch: 11 | loss: 0.0046291
	speed: 0.1401s/iter; left time: 1258.6588s
Epoch: 11 cost time: 66.50066471099854
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0120688
	speed: 0.4594s/iter; left time: 4048.3343s
	iters: 200, epoch: 12 | loss: 0.5242999
	speed: 0.0992s/iter; left time: 864.4776s
	iters: 300, epoch: 12 | loss: 0.0062023
	speed: 0.1351s/iter; left time: 1163.4464s
	iters: 400, epoch: 12 | loss: 0.0053065
	speed: 0.1359s/iter; left time: 1157.0035s
Epoch: 12 cost time: 57.15522646903992
Epoch: 12, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.981989 --> -0.983704).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0006490
	speed: 0.4759s/iter; left time: 3970.6072s
	iters: 200, epoch: 13 | loss: 0.0020897
	speed: 0.1389s/iter; left time: 1145.0329s
	iters: 300, epoch: 13 | loss: 0.0064912
	speed: 0.1364s/iter; left time: 1110.5824s
	iters: 400, epoch: 13 | loss: 0.2025977
	speed: 0.1423s/iter; left time: 1144.9008s
Epoch: 13 cost time: 63.70526480674744
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0164842
	speed: 0.4829s/iter; left time: 3802.5563s
	iters: 200, epoch: 14 | loss: 0.0021192
	speed: 0.1344s/iter; left time: 1044.8076s
	iters: 300, epoch: 14 | loss: 0.0010284
	speed: 0.1449s/iter; left time: 1111.7829s
	iters: 400, epoch: 14 | loss: 0.0001673
	speed: 0.1336s/iter; left time: 1011.6975s
Epoch: 14 cost time: 65.00550055503845
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0003313
	speed: 0.4845s/iter; left time: 3587.3951s
	iters: 200, epoch: 15 | loss: 0.0003634
	speed: 0.1413s/iter; left time: 1032.2629s
	iters: 300, epoch: 15 | loss: 0.0041955
	speed: 0.1369s/iter; left time: 986.2265s
	iters: 400, epoch: 15 | loss: 0.0001281
	speed: 0.1385s/iter; left time: 983.7097s
Epoch: 15 cost time: 64.67251968383789
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0041140
	speed: 0.4848s/iter; left time: 3362.3947s
	iters: 200, epoch: 16 | loss: 0.0013732
	speed: 0.1394s/iter; left time: 952.6205s
	iters: 300, epoch: 16 | loss: 0.0011567
	speed: 0.1176s/iter; left time: 791.8902s
	iters: 400, epoch: 16 | loss: 0.0075852
	speed: 0.0788s/iter; left time: 523.2240s
Epoch: 16 cost time: 57.152262449264526
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0005588
	speed: 0.4967s/iter; left time: 3211.9679s
	iters: 200, epoch: 17 | loss: 0.0005784
	speed: 0.1432s/iter; left time: 911.9881s
	iters: 300, epoch: 17 | loss: 0.0001200
	speed: 0.1395s/iter; left time: 874.2935s
	iters: 400, epoch: 17 | loss: 0.0007159
	speed: 0.1361s/iter; left time: 839.1758s
Epoch: 17 cost time: 65.4098207950592
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0010257
	speed: 0.5008s/iter; left time: 3003.5361s
	iters: 200, epoch: 18 | loss: 0.0010350
	speed: 0.1360s/iter; left time: 802.3774s
	iters: 300, epoch: 18 | loss: 0.0096262
	speed: 0.1416s/iter; left time: 821.0244s
	iters: 400, epoch: 18 | loss: 0.0215504
	speed: 0.1404s/iter; left time: 799.8914s
Epoch: 18 cost time: 65.63767623901367
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0764332
	speed: 0.5027s/iter; left time: 2779.1557s
	iters: 200, epoch: 19 | loss: 0.0004532
	speed: 0.1368s/iter; left time: 742.8131s
	iters: 300, epoch: 19 | loss: 0.0003390
	speed: 0.1468s/iter; left time: 782.2129s
	iters: 400, epoch: 19 | loss: 0.0001961
	speed: 0.1440s/iter; left time: 752.9774s
Epoch: 19 cost time: 66.09724712371826
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0119617
	speed: 0.4921s/iter; left time: 2490.2478s
	iters: 200, epoch: 20 | loss: 0.0001830
	speed: 0.1376s/iter; left time: 682.6378s
	iters: 300, epoch: 20 | loss: 0.0001380
	speed: 0.1472s/iter; left time: 715.5348s
	iters: 400, epoch: 20 | loss: 0.0004675
	speed: 0.1447s/iter; left time: 688.8447s
Epoch: 20 cost time: 66.34813046455383
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0009773
	speed: 0.4843s/iter; left time: 2223.5159s
	iters: 200, epoch: 21 | loss: 0.0000595
	speed: 0.0933s/iter; left time: 418.8675s
	iters: 300, epoch: 21 | loss: 0.0001231
	speed: 0.0916s/iter; left time: 402.1814s
	iters: 400, epoch: 21 | loss: 0.0013494
	speed: 0.1467s/iter; left time: 629.6449s
Epoch: 21 cost time: 57.26499533653259
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0006871
	speed: 0.5087s/iter; left time: 2096.6720s
	iters: 200, epoch: 22 | loss: 0.0005275
	speed: 0.1392s/iter; left time: 559.7694s
	iters: 300, epoch: 22 | loss: 0.0028273
	speed: 0.1400s/iter; left time: 548.9473s
	iters: 400, epoch: 22 | loss: 0.0002269
	speed: 0.1458s/iter; left time: 557.2989s
Epoch: 22 cost time: 67.20277190208435
Epoch: 22, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 347530
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4943736
	speed: 0.1553s/iter; left time: 2170.3251s
	iters: 200, epoch: 1 | loss: 0.7461397
	speed: 0.1436s/iter; left time: 1991.2438s
	iters: 300, epoch: 1 | loss: 0.4241516
	speed: 0.1469s/iter; left time: 2023.6080s
	iters: 400, epoch: 1 | loss: 0.2152660
	speed: 0.1448s/iter; left time: 1979.0358s
Epoch: 1 cost time: 68.85679721832275
Epoch: 1, Steps: 469 | Train Loss: 0.866 Vali Loss: 0.239 Vali Acc: 0.918 Test Loss: 0.239 Test Acc: 0.918
Validation loss decreased (inf --> -0.917951).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1318920
	speed: 0.5045s/iter; left time: 6811.2107s
	iters: 200, epoch: 2 | loss: 0.0884229
	speed: 0.1383s/iter; left time: 1854.0651s
	iters: 300, epoch: 2 | loss: 0.0348672
	speed: 0.1359s/iter; left time: 1807.7643s
	iters: 400, epoch: 2 | loss: 0.0826557
	speed: 0.1423s/iter; left time: 1878.7538s
Epoch: 2 cost time: 65.67059326171875
Epoch: 2, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.917951 --> -0.965694).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0446055
	speed: 0.5082s/iter; left time: 6622.9484s
	iters: 200, epoch: 3 | loss: 0.0168557
	speed: 0.1418s/iter; left time: 1833.8373s
	iters: 300, epoch: 3 | loss: 0.0396038
	speed: 0.1438s/iter; left time: 1845.1233s
	iters: 400, epoch: 3 | loss: 0.0548879
	speed: 0.1457s/iter; left time: 1854.6990s
Epoch: 3 cost time: 67.76829290390015
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.965694 --> -0.974556).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0130069
	speed: 0.5049s/iter; left time: 6343.2391s
	iters: 200, epoch: 4 | loss: 0.0869578
	speed: 0.1410s/iter; left time: 1757.4084s
	iters: 300, epoch: 4 | loss: 0.0153050
	speed: 0.1435s/iter; left time: 1774.2688s
	iters: 400, epoch: 4 | loss: 0.7355342
	speed: 0.1475s/iter; left time: 1808.6948s
Epoch: 4 cost time: 67.9088716506958
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0897263
	speed: 0.5121s/iter; left time: 6193.6898s
	iters: 200, epoch: 5 | loss: 0.0026189
	speed: 0.1430s/iter; left time: 1714.8530s
	iters: 300, epoch: 5 | loss: 0.0118912
	speed: 0.1360s/iter; left time: 1617.6996s
	iters: 400, epoch: 5 | loss: 0.0030756
	speed: 0.1458s/iter; left time: 1719.9271s
Epoch: 5 cost time: 66.85090470314026
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.975128).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1616665
	speed: 0.5006s/iter; left time: 5820.2710s
	iters: 200, epoch: 6 | loss: 0.0085042
	speed: 0.1465s/iter; left time: 1688.0709s
	iters: 300, epoch: 6 | loss: 0.0050742
	speed: 0.1432s/iter; left time: 1636.3460s
	iters: 400, epoch: 6 | loss: 0.0382375
	speed: 0.1452s/iter; left time: 1644.8269s
Epoch: 6 cost time: 68.57034492492676
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.975128 --> -0.979416).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1424399
	speed: 0.5082s/iter; left time: 5669.5755s
	iters: 200, epoch: 7 | loss: 0.0118827
	speed: 0.1459s/iter; left time: 1613.3751s
	iters: 300, epoch: 7 | loss: 0.0079967
	speed: 0.1392s/iter; left time: 1525.4305s
	iters: 400, epoch: 7 | loss: 0.0381928
	speed: 0.1439s/iter; left time: 1561.9774s
Epoch: 7 cost time: 68.0157105922699
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0288515
	speed: 0.5097s/iter; left time: 5447.1441s
	iters: 200, epoch: 8 | loss: 0.0047810
	speed: 0.0872s/iter; left time: 923.3672s
	iters: 300, epoch: 8 | loss: 0.0136513
	speed: 0.1278s/iter; left time: 1339.8823s
	iters: 400, epoch: 8 | loss: 0.0015773
	speed: 0.1339s/iter; left time: 1390.9085s
Epoch: 8 cost time: 58.92286276817322
Epoch: 8, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0012774
	speed: 0.4888s/iter; left time: 4994.9550s
	iters: 200, epoch: 9 | loss: 0.0034620
	speed: 0.1364s/iter; left time: 1379.9359s
	iters: 300, epoch: 9 | loss: 0.0028238
	speed: 0.1431s/iter; left time: 1433.4308s
	iters: 400, epoch: 9 | loss: 0.0008358
	speed: 0.1386s/iter; left time: 1374.4845s
Epoch: 9 cost time: 65.64333510398865
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0158300
	speed: 0.4918s/iter; left time: 4795.0782s
	iters: 200, epoch: 10 | loss: 0.0026402
	speed: 0.1339s/iter; left time: 1292.5092s
	iters: 300, epoch: 10 | loss: 0.0485321
	speed: 0.1362s/iter; left time: 1300.8826s
	iters: 400, epoch: 10 | loss: 0.0263505
	speed: 0.1362s/iter; left time: 1286.6833s
Epoch: 10 cost time: 64.27794241905212
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0069805
	speed: 0.4919s/iter; left time: 4565.5396s
	iters: 200, epoch: 11 | loss: 0.0005271
	speed: 0.1412s/iter; left time: 1296.0580s
	iters: 300, epoch: 11 | loss: 0.0036879
	speed: 0.1373s/iter; left time: 1247.1589s
	iters: 400, epoch: 11 | loss: 0.0005810
	speed: 0.1373s/iter; left time: 1233.1282s
Epoch: 11 cost time: 63.88445973396301
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0014678
	speed: 0.4362s/iter; left time: 3843.9572s
	iters: 200, epoch: 12 | loss: 0.0018581
	speed: 0.1295s/iter; left time: 1127.9080s
	iters: 300, epoch: 12 | loss: 0.0167091
	speed: 0.1432s/iter; left time: 1233.0719s
	iters: 400, epoch: 12 | loss: 0.0045651
	speed: 0.1381s/iter; left time: 1175.5242s
Epoch: 12 cost time: 65.37747097015381
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
Validation loss decreased (-0.979416 --> -0.982275).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0017100
	speed: 0.5019s/iter; left time: 4187.1335s
	iters: 200, epoch: 13 | loss: 0.0006449
	speed: 0.1386s/iter; left time: 1142.6825s
	iters: 300, epoch: 13 | loss: 0.0003017
	speed: 0.1428s/iter; left time: 1162.9290s
	iters: 400, epoch: 13 | loss: 0.0075899
	speed: 0.1312s/iter; left time: 1055.6133s
Epoch: 13 cost time: 65.81503963470459
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983133).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0019131
	speed: 0.4994s/iter; left time: 3932.1158s
	iters: 200, epoch: 14 | loss: 0.0016006
	speed: 0.1379s/iter; left time: 1072.2646s
	iters: 300, epoch: 14 | loss: 0.0003355
	speed: 0.1459s/iter; left time: 1119.4934s
	iters: 400, epoch: 14 | loss: 0.0002963
	speed: 0.1380s/iter; left time: 1044.9504s
Epoch: 14 cost time: 67.0228340625763
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0006524
	speed: 0.5007s/iter; left time: 3707.6231s
	iters: 200, epoch: 15 | loss: 0.0030428
	speed: 0.1359s/iter; left time: 993.0050s
	iters: 300, epoch: 15 | loss: 0.0001784
	speed: 0.1443s/iter; left time: 1040.0066s
	iters: 400, epoch: 15 | loss: 0.0006107
	speed: 0.1376s/iter; left time: 977.8166s
Epoch: 15 cost time: 65.97370791435242
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0835922
	speed: 0.5047s/iter; left time: 3500.6264s
	iters: 200, epoch: 16 | loss: 0.2017812
	speed: 0.1382s/iter; left time: 945.0172s
	iters: 300, epoch: 16 | loss: 0.0081127
	speed: 0.1437s/iter; left time: 968.2554s
	iters: 400, epoch: 16 | loss: 0.0123128
	speed: 0.1388s/iter; left time: 921.1490s
Epoch: 16 cost time: 66.5703022480011
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0016175
	speed: 0.5016s/iter; left time: 3243.6236s
	iters: 200, epoch: 17 | loss: 0.0006216
	speed: 0.1389s/iter; left time: 884.1435s
	iters: 300, epoch: 17 | loss: 0.0016308
	speed: 0.1447s/iter; left time: 906.6940s
	iters: 400, epoch: 17 | loss: 0.0002047
	speed: 0.1418s/iter; left time: 874.4084s
Epoch: 17 cost time: 66.91855764389038
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001267
	speed: 0.5063s/iter; left time: 3036.8518s
	iters: 200, epoch: 18 | loss: 0.0007352
	speed: 0.1389s/iter; left time: 819.1412s
	iters: 300, epoch: 18 | loss: 0.0031437
	speed: 0.1392s/iter; left time: 807.1846s
	iters: 400, epoch: 18 | loss: 0.0743649
	speed: 0.1406s/iter; left time: 801.1331s
Epoch: 18 cost time: 65.85801887512207
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0002006
	speed: 0.5048s/iter; left time: 2790.8716s
	iters: 200, epoch: 19 | loss: 0.0006024
	speed: 0.1415s/iter; left time: 768.1044s
	iters: 300, epoch: 19 | loss: 0.0002041
	speed: 0.1255s/iter; left time: 668.5430s
	iters: 400, epoch: 19 | loss: 0.0113926
	speed: 0.0911s/iter; left time: 476.2334s
Epoch: 19 cost time: 60.0798454284668
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0006389
	speed: 0.4736s/iter; left time: 2396.3487s
	iters: 200, epoch: 20 | loss: 0.0000631
	speed: 0.1317s/iter; left time: 653.2131s
	iters: 300, epoch: 20 | loss: 0.0023344
	speed: 0.1311s/iter; left time: 637.3832s
	iters: 400, epoch: 20 | loss: 0.0001329
	speed: 0.1333s/iter; left time: 634.7233s
Epoch: 20 cost time: 62.82152080535889
Epoch: 20, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0003910
	speed: 0.4771s/iter; left time: 2190.5811s
	iters: 200, epoch: 21 | loss: 0.0002529
	speed: 0.1355s/iter; left time: 608.4964s
	iters: 300, epoch: 21 | loss: 0.0287640
	speed: 0.1354s/iter; left time: 594.4866s
	iters: 400, epoch: 21 | loss: 0.0002508
	speed: 0.1294s/iter; left time: 555.3150s
Epoch: 21 cost time: 60.84699082374573
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0001541
	speed: 0.4550s/iter; left time: 1875.5301s
	iters: 200, epoch: 22 | loss: 0.0001780
	speed: 0.1471s/iter; left time: 591.5998s
	iters: 300, epoch: 22 | loss: 0.0003142
	speed: 0.1454s/iter; left time: 570.1362s
	iters: 400, epoch: 22 | loss: 0.0001722
	speed: 0.1461s/iter; left time: 558.4551s
Epoch: 22 cost time: 69.40409111976624
Epoch: 22, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000579
	speed: 0.5005s/iter; left time: 1828.4425s
	iters: 200, epoch: 23 | loss: 0.0252815
	speed: 0.1086s/iter; left time: 385.8786s
	iters: 300, epoch: 23 | loss: 0.0028857
	speed: 0.1437s/iter; left time: 496.2934s
	iters: 400, epoch: 23 | loss: 0.0002034
	speed: 0.1429s/iter; left time: 479.0107s
Epoch: 23 cost time: 62.17245864868164
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 1175178
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7101156
	speed: 0.1171s/iter; left time: 1635.6234s
	iters: 200, epoch: 1 | loss: 0.9390244
	speed: 0.1006s/iter; left time: 1395.8052s
	iters: 300, epoch: 1 | loss: 0.4046920
	speed: 0.0975s/iter; left time: 1343.1302s
	iters: 400, epoch: 1 | loss: 0.2412461
	speed: 0.0983s/iter; left time: 1343.9832s
Epoch: 1 cost time: 48.54227113723755
Epoch: 1, Steps: 469 | Train Loss: 0.951 Vali Loss: 0.289 Vali Acc: 0.910 Test Loss: 0.289 Test Acc: 0.910
Validation loss decreased (inf --> -0.909946).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2254722
	speed: 0.4351s/iter; left time: 5874.1972s
	iters: 200, epoch: 2 | loss: 0.0786870
	speed: 0.0946s/iter; left time: 1268.3482s
	iters: 300, epoch: 2 | loss: 0.2881114
	speed: 0.1002s/iter; left time: 1332.3805s
	iters: 400, epoch: 2 | loss: 0.0504618
	speed: 0.1028s/iter; left time: 1356.6312s
Epoch: 2 cost time: 47.18385076522827
Epoch: 2, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
Validation loss decreased (-0.909946 --> -0.960262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0270732
	speed: 0.4379s/iter; left time: 5706.9035s
	iters: 200, epoch: 3 | loss: 0.0793790
	speed: 0.1019s/iter; left time: 1317.8892s
	iters: 300, epoch: 3 | loss: 0.0290118
	speed: 0.0983s/iter; left time: 1262.1082s
	iters: 400, epoch: 3 | loss: 0.0169142
	speed: 0.0945s/iter; left time: 1202.8769s
Epoch: 3 cost time: 46.218366622924805
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
Validation loss decreased (-0.960262 --> -0.974270).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0501131
	speed: 0.4005s/iter; left time: 5031.5475s
	iters: 200, epoch: 4 | loss: 0.0178117
	speed: 0.0863s/iter; left time: 1075.2689s
	iters: 300, epoch: 4 | loss: 0.0840948
	speed: 0.0945s/iter; left time: 1168.2199s
	iters: 400, epoch: 4 | loss: 0.2158697
	speed: 0.0958s/iter; left time: 1174.9311s
Epoch: 4 cost time: 43.87653970718384
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975414).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0097935
	speed: 0.4003s/iter; left time: 4841.1195s
	iters: 200, epoch: 5 | loss: 0.0082983
	speed: 0.0958s/iter; left time: 1148.8978s
	iters: 300, epoch: 5 | loss: 0.0076459
	speed: 0.0956s/iter; left time: 1137.2265s
	iters: 400, epoch: 5 | loss: 0.0191610
	speed: 0.0946s/iter; left time: 1115.9063s
Epoch: 5 cost time: 44.532567739486694
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.975414 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0017093
	speed: 0.3931s/iter; left time: 4570.0723s
	iters: 200, epoch: 6 | loss: 0.0361485
	speed: 0.0947s/iter; left time: 1091.5688s
	iters: 300, epoch: 6 | loss: 0.0042532
	speed: 0.0880s/iter; left time: 1005.8318s
	iters: 400, epoch: 6 | loss: 0.0022331
	speed: 0.0937s/iter; left time: 1061.2884s
Epoch: 6 cost time: 43.54043006896973
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.976843 --> -0.980274).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0023657
	speed: 0.2929s/iter; left time: 3267.6929s
	iters: 200, epoch: 7 | loss: 0.0175598
	speed: 0.0926s/iter; left time: 1024.3086s
	iters: 300, epoch: 7 | loss: 0.0009569
	speed: 0.0948s/iter; left time: 1038.6324s
	iters: 400, epoch: 7 | loss: 0.0259524
	speed: 0.0924s/iter; left time: 1003.2851s
Epoch: 7 cost time: 40.03632307052612
Epoch: 7, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0007629
	speed: 0.4010s/iter; left time: 4286.0001s
	iters: 200, epoch: 8 | loss: 0.0010705
	speed: 0.1022s/iter; left time: 1082.4808s
	iters: 300, epoch: 8 | loss: 0.0059534
	speed: 0.1006s/iter; left time: 1054.6088s
	iters: 400, epoch: 8 | loss: 0.0022557
	speed: 0.0956s/iter; left time: 993.3494s
Epoch: 8 cost time: 47.072282552719116
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
Validation loss decreased (-0.980274 --> -0.984562).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0019478
	speed: 0.4251s/iter; left time: 4343.7786s
	iters: 200, epoch: 9 | loss: 0.0111815
	speed: 0.1004s/iter; left time: 1015.4774s
	iters: 300, epoch: 9 | loss: 0.0012445
	speed: 0.0957s/iter; left time: 958.7342s
	iters: 400, epoch: 9 | loss: 0.0014709
	speed: 0.0957s/iter; left time: 949.0731s
Epoch: 9 cost time: 46.278149127960205
Epoch: 9, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0020761
	speed: 0.4311s/iter; left time: 4203.5887s
	iters: 200, epoch: 10 | loss: 0.0362841
	speed: 0.0979s/iter; left time: 944.6738s
	iters: 300, epoch: 10 | loss: 0.0171726
	speed: 0.0937s/iter; left time: 894.5185s
	iters: 400, epoch: 10 | loss: 0.0006871
	speed: 0.0963s/iter; left time: 909.5730s
Epoch: 10 cost time: 45.500195264816284
Epoch: 10, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.984562 --> -0.986563).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0025467
	speed: 0.4271s/iter; left time: 3963.8416s
	iters: 200, epoch: 11 | loss: 0.5007870
	speed: 0.0930s/iter; left time: 853.9422s
	iters: 300, epoch: 11 | loss: 0.0004522
	speed: 0.0960s/iter; left time: 871.8215s
	iters: 400, epoch: 11 | loss: 0.0017626
	speed: 0.0857s/iter; left time: 769.4181s
Epoch: 11 cost time: 44.16288471221924
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0057576
	speed: 0.3956s/iter; left time: 3486.0619s
	iters: 200, epoch: 12 | loss: 0.5462263
	speed: 0.0876s/iter; left time: 763.1257s
	iters: 300, epoch: 12 | loss: 0.0029505
	speed: 0.0914s/iter; left time: 786.9998s
	iters: 400, epoch: 12 | loss: 0.0082016
	speed: 0.0950s/iter; left time: 808.3072s
Epoch: 12 cost time: 42.81376504898071
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0061447
	speed: 0.3916s/iter; left time: 3267.1545s
	iters: 200, epoch: 13 | loss: 0.0010039
	speed: 0.0853s/iter; left time: 703.1793s
	iters: 300, epoch: 13 | loss: 0.0023165
	speed: 0.0717s/iter; left time: 583.5822s
	iters: 400, epoch: 13 | loss: 0.0892644
	speed: 0.0536s/iter; left time: 431.1910s
Epoch: 13 cost time: 35.36645770072937
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1036576
	speed: 0.3687s/iter; left time: 2903.2232s
	iters: 200, epoch: 14 | loss: 0.0094418
	speed: 0.0918s/iter; left time: 713.5508s
	iters: 300, epoch: 14 | loss: 0.0021674
	speed: 0.0882s/iter; left time: 677.0826s
	iters: 400, epoch: 14 | loss: 0.0000764
	speed: 0.0890s/iter; left time: 674.3550s
Epoch: 14 cost time: 42.33122658729553
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0003533
	speed: 0.3820s/iter; left time: 2828.4637s
	iters: 200, epoch: 15 | loss: 0.0100000
	speed: 0.0860s/iter; left time: 628.1876s
	iters: 300, epoch: 15 | loss: 0.1144781
	speed: 0.0915s/iter; left time: 659.4206s
	iters: 400, epoch: 15 | loss: 0.0010122
	speed: 0.0856s/iter; left time: 608.5372s
Epoch: 15 cost time: 41.55007362365723
Epoch: 15, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0040782
	speed: 0.3881s/iter; left time: 2691.8345s
	iters: 200, epoch: 16 | loss: 0.0004514
	speed: 0.0988s/iter; left time: 675.5747s
	iters: 300, epoch: 16 | loss: 0.0023424
	speed: 0.0897s/iter; left time: 604.0685s
	iters: 400, epoch: 16 | loss: 0.0474599
	speed: 0.0947s/iter; left time: 628.4973s
Epoch: 16 cost time: 44.86951947212219
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0010948
	speed: 0.4177s/iter; left time: 2701.4014s
	iters: 200, epoch: 17 | loss: 0.0003029
	speed: 0.0906s/iter; left time: 576.8957s
	iters: 300, epoch: 17 | loss: 0.0002755
	speed: 0.0954s/iter; left time: 597.7585s
	iters: 400, epoch: 17 | loss: 0.0003941
	speed: 0.0972s/iter; left time: 599.1650s
Epoch: 17 cost time: 44.85140538215637
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0003914
	speed: 0.4095s/iter; left time: 2455.9159s
	iters: 200, epoch: 18 | loss: 0.0006057
	speed: 0.0965s/iter; left time: 569.1761s
	iters: 300, epoch: 18 | loss: 0.0020515
	speed: 0.0980s/iter; left time: 568.2422s
	iters: 400, epoch: 18 | loss: 0.0124934
	speed: 0.0931s/iter; left time: 530.7253s
Epoch: 18 cost time: 44.915183305740356
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0013502
	speed: 0.4126s/iter; left time: 2281.4438s
	iters: 200, epoch: 19 | loss: 0.0009373
	speed: 0.0944s/iter; left time: 512.3365s
	iters: 300, epoch: 19 | loss: 0.0018532
	speed: 0.0969s/iter; left time: 516.4740s
	iters: 400, epoch: 19 | loss: 0.0000443
	speed: 0.1007s/iter; left time: 526.7429s
Epoch: 19 cost time: 45.26323080062866
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0135407
	speed: 0.3675s/iter; left time: 1859.5627s
	iters: 200, epoch: 20 | loss: 0.0672086
	speed: 0.0527s/iter; left time: 261.2082s
	iters: 300, epoch: 20 | loss: 0.0007502
	speed: 0.0203s/iter; left time: 98.6093s
	iters: 400, epoch: 20 | loss: 0.0007091
	speed: 0.0217s/iter; left time: 103.4261s
Epoch: 20 cost time: 19.7929368019104
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9865637507146942
model parameter : 347530
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9017229
	speed: 0.1560s/iter; left time: 2179.8822s
	iters: 200, epoch: 1 | loss: 0.9543380
	speed: 0.1366s/iter; left time: 1895.1890s
	iters: 300, epoch: 1 | loss: 0.5346441
	speed: 0.1361s/iter; left time: 1874.6332s
	iters: 400, epoch: 1 | loss: 0.3535943
	speed: 0.1390s/iter; left time: 1900.6247s
Epoch: 1 cost time: 66.60887169837952
Epoch: 1, Steps: 469 | Train Loss: 1.022 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (inf --> -0.929958).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1945662
	speed: 0.5279s/iter; left time: 7127.9173s
	iters: 200, epoch: 2 | loss: 0.1119383
	speed: 0.1386s/iter; left time: 1857.6046s
	iters: 300, epoch: 2 | loss: 0.2375524
	speed: 0.1385s/iter; left time: 1842.2810s
	iters: 400, epoch: 2 | loss: 0.0430832
	speed: 0.1378s/iter; left time: 1818.8223s
Epoch: 2 cost time: 65.80072546005249
Epoch: 2, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
Validation loss decreased (-0.929958 --> -0.962835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0206273
	speed: 0.5355s/iter; left time: 6979.3557s
	iters: 200, epoch: 3 | loss: 0.0244176
	speed: 0.1424s/iter; left time: 1841.1358s
	iters: 300, epoch: 3 | loss: 0.0411338
	speed: 0.1452s/iter; left time: 1863.9045s
	iters: 400, epoch: 3 | loss: 0.1300515
	speed: 0.1435s/iter; left time: 1827.6179s
Epoch: 3 cost time: 67.60665035247803
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.112 Vali Acc: 0.963 Test Loss: 0.112 Test Acc: 0.963
Validation loss decreased (-0.962835 --> -0.962835).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1496657
	speed: 0.5680s/iter; left time: 7135.7795s
	iters: 200, epoch: 4 | loss: 0.0223421
	speed: 0.1510s/iter; left time: 1882.5773s
	iters: 300, epoch: 4 | loss: 0.0108490
	speed: 0.1457s/iter; left time: 1801.0597s
	iters: 400, epoch: 4 | loss: 0.0086119
	speed: 0.1438s/iter; left time: 1763.8121s
Epoch: 4 cost time: 69.97163534164429
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.962835 --> -0.977987).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0029734
	speed: 0.5657s/iter; left time: 6842.6764s
	iters: 200, epoch: 5 | loss: 0.0173109
	speed: 0.1502s/iter; left time: 1801.3956s
	iters: 300, epoch: 5 | loss: 0.0118866
	speed: 0.1468s/iter; left time: 1745.6903s
	iters: 400, epoch: 5 | loss: 0.0453305
	speed: 0.1442s/iter; left time: 1701.1670s
Epoch: 5 cost time: 69.72116136550903
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1521687
	speed: 0.5564s/iter; left time: 6468.7856s
	iters: 200, epoch: 6 | loss: 0.0009607
	speed: 0.1422s/iter; left time: 1639.5042s
	iters: 300, epoch: 6 | loss: 0.0013617
	speed: 0.1374s/iter; left time: 1570.1264s
	iters: 400, epoch: 6 | loss: 0.0228083
	speed: 0.1331s/iter; left time: 1507.7450s
Epoch: 6 cost time: 65.07514476776123
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.977987 --> -0.981131).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0058879
	speed: 0.5337s/iter; left time: 5954.5044s
	iters: 200, epoch: 7 | loss: 0.0207614
	speed: 0.1057s/iter; left time: 1169.2444s
	iters: 300, epoch: 7 | loss: 0.0053416
	speed: 0.1077s/iter; left time: 1179.6006s
	iters: 400, epoch: 7 | loss: 0.0005575
	speed: 0.1327s/iter; left time: 1440.9470s
Epoch: 7 cost time: 57.37623310089111
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.982561).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0043322
	speed: 0.5143s/iter; left time: 5496.3312s
	iters: 200, epoch: 8 | loss: 0.0114736
	speed: 0.1349s/iter; left time: 1427.8409s
	iters: 300, epoch: 8 | loss: 0.0042761
	speed: 0.1299s/iter; left time: 1362.1931s
	iters: 400, epoch: 8 | loss: 0.0082112
	speed: 0.1344s/iter; left time: 1396.0602s
Epoch: 8 cost time: 62.52886152267456
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0263196
	speed: 0.5184s/iter; left time: 5297.7421s
	iters: 200, epoch: 9 | loss: 0.0292648
	speed: 0.1363s/iter; left time: 1379.6554s
	iters: 300, epoch: 9 | loss: 0.0073190
	speed: 0.1410s/iter; left time: 1412.9627s
	iters: 400, epoch: 9 | loss: 0.0344900
	speed: 0.1415s/iter; left time: 1403.4092s
Epoch: 9 cost time: 65.33457398414612
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0080821
	speed: 0.5522s/iter; left time: 5383.6215s
	iters: 200, epoch: 10 | loss: 0.0194476
	speed: 0.1400s/iter; left time: 1350.9918s
	iters: 300, epoch: 10 | loss: 0.0055272
	speed: 0.1389s/iter; left time: 1326.5744s
	iters: 400, epoch: 10 | loss: 0.0047878
	speed: 0.1404s/iter; left time: 1326.7752s
Epoch: 10 cost time: 66.5494532585144
Epoch: 10, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0058906
	speed: 0.5597s/iter; left time: 5194.2641s
	iters: 200, epoch: 11 | loss: 0.0002727
	speed: 0.1430s/iter; left time: 1313.1063s
	iters: 300, epoch: 11 | loss: 0.0037962
	speed: 0.1147s/iter; left time: 1041.9914s
	iters: 400, epoch: 11 | loss: 0.0082878
	speed: 0.1020s/iter; left time: 916.4656s
Epoch: 11 cost time: 60.89633011817932
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0023463
	speed: 0.5585s/iter; left time: 4921.6412s
	iters: 200, epoch: 12 | loss: 0.0035028
	speed: 0.1338s/iter; left time: 1165.5096s
	iters: 300, epoch: 12 | loss: 0.0005311
	speed: 0.1377s/iter; left time: 1185.9121s
	iters: 400, epoch: 12 | loss: 0.0040207
	speed: 0.1320s/iter; left time: 1123.5751s
Epoch: 12 cost time: 64.17015838623047
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.982561 --> -0.985134).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0019498
	speed: 0.5372s/iter; left time: 4482.2127s
	iters: 200, epoch: 13 | loss: 0.0007237
	speed: 0.1308s/iter; left time: 1078.2401s
	iters: 300, epoch: 13 | loss: 0.0119523
	speed: 0.1394s/iter; left time: 1135.0379s
	iters: 400, epoch: 13 | loss: 0.0010280
	speed: 0.1333s/iter; left time: 1071.9421s
Epoch: 13 cost time: 64.04318857192993
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0004585
	speed: 0.5307s/iter; left time: 4179.0069s
	iters: 200, epoch: 14 | loss: 0.2483055
	speed: 0.1309s/iter; left time: 1017.9986s
	iters: 300, epoch: 14 | loss: 0.0042083
	speed: 0.1394s/iter; left time: 1069.6757s
	iters: 400, epoch: 14 | loss: 0.0010217
	speed: 0.1316s/iter; left time: 996.7200s
Epoch: 14 cost time: 63.69193243980408
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006826
	speed: 0.4399s/iter; left time: 3257.2450s
	iters: 200, epoch: 15 | loss: 0.0017234
	speed: 0.1294s/iter; left time: 945.3173s
	iters: 300, epoch: 15 | loss: 0.0007757
	speed: 0.1349s/iter; left time: 972.0839s
	iters: 400, epoch: 15 | loss: 0.0005669
	speed: 0.1416s/iter; left time: 1005.9985s
Epoch: 15 cost time: 63.88222026824951
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0016938
	speed: 0.4551s/iter; left time: 3156.6379s
	iters: 200, epoch: 16 | loss: 0.0006879
	speed: 0.1300s/iter; left time: 888.4869s
	iters: 300, epoch: 16 | loss: 0.0056632
	speed: 0.1333s/iter; left time: 898.2150s
	iters: 400, epoch: 16 | loss: 0.0007042
	speed: 0.1315s/iter; left time: 872.9441s
Epoch: 16 cost time: 61.97176218032837
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.985134 --> -0.985134).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0009900
	speed: 0.5158s/iter; left time: 3335.4653s
	iters: 200, epoch: 17 | loss: 0.0002939
	speed: 0.1324s/iter; left time: 842.8511s
	iters: 300, epoch: 17 | loss: 0.0002010
	speed: 0.1273s/iter; left time: 798.0950s
	iters: 400, epoch: 17 | loss: 0.0006197
	speed: 0.1407s/iter; left time: 867.9964s
Epoch: 17 cost time: 63.00354599952698
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0133515
	speed: 0.5161s/iter; left time: 3095.5818s
	iters: 200, epoch: 18 | loss: 0.0004228
	speed: 0.1170s/iter; left time: 690.0929s
	iters: 300, epoch: 18 | loss: 0.0018619
	speed: 0.1241s/iter; left time: 719.5734s
	iters: 400, epoch: 18 | loss: 0.0007679
	speed: 0.1256s/iter; left time: 715.5225s
Epoch: 18 cost time: 57.275524616241455
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0004030
	speed: 0.4403s/iter; left time: 2434.5039s
	iters: 200, epoch: 19 | loss: 0.0039081
	speed: 0.1339s/iter; left time: 726.9191s
	iters: 300, epoch: 19 | loss: 0.0003365
	speed: 0.1334s/iter; left time: 710.8760s
	iters: 400, epoch: 19 | loss: 0.0006341
	speed: 0.1286s/iter; left time: 672.5686s
Epoch: 19 cost time: 61.90536403656006
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
Validation loss decreased (-0.985134 --> -0.986277).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0007321
	speed: 0.5096s/iter; left time: 2578.5665s
	iters: 200, epoch: 20 | loss: 0.0001193
	speed: 0.1316s/iter; left time: 652.9632s
	iters: 300, epoch: 20 | loss: 0.0002667
	speed: 0.1291s/iter; left time: 627.2999s
	iters: 400, epoch: 20 | loss: 0.0007418
	speed: 0.1330s/iter; left time: 633.3175s
Epoch: 20 cost time: 62.28969693183899
Epoch: 20, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0450289
	speed: 0.5104s/iter; left time: 2343.1978s
	iters: 200, epoch: 21 | loss: 0.0430733
	speed: 0.1125s/iter; left time: 505.2476s
	iters: 300, epoch: 21 | loss: 0.0004922
	speed: 0.0935s/iter; left time: 410.5664s
	iters: 400, epoch: 21 | loss: 0.0074576
	speed: 0.1381s/iter; left time: 592.5317s
Epoch: 21 cost time: 57.60161519050598
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0001385
	speed: 0.5614s/iter; left time: 2314.1059s
	iters: 200, epoch: 22 | loss: 0.0003143
	speed: 0.1459s/iter; left time: 586.7084s
	iters: 300, epoch: 22 | loss: 0.0008122
	speed: 0.1380s/iter; left time: 541.1810s
	iters: 400, epoch: 22 | loss: 0.0010228
	speed: 0.1399s/iter; left time: 534.7392s
Epoch: 22 cost time: 67.37317299842834
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0007134
	speed: 0.5718s/iter; left time: 2088.7059s
	iters: 200, epoch: 23 | loss: 0.0351570
	speed: 0.1431s/iter; left time: 508.2640s
	iters: 300, epoch: 23 | loss: 0.0202761
	speed: 0.1444s/iter; left time: 498.5598s
	iters: 400, epoch: 23 | loss: 0.0168534
	speed: 0.1449s/iter; left time: 485.9340s
Epoch: 23 cost time: 68.21337580680847
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0002770
	speed: 0.4918s/iter; left time: 1565.7694s
	iters: 200, epoch: 24 | loss: 0.0028815
	speed: 0.1399s/iter; left time: 431.5369s
	iters: 300, epoch: 24 | loss: 0.0010778
	speed: 0.1360s/iter; left time: 405.7306s
	iters: 400, epoch: 24 | loss: 0.0006685
	speed: 0.1312s/iter; left time: 378.4474s
Epoch: 24 cost time: 63.29763650894165
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0007346
	speed: 0.5034s/iter; left time: 1366.7920s
	iters: 200, epoch: 25 | loss: 0.0001566
	speed: 0.1335s/iter; left time: 348.9796s
	iters: 300, epoch: 25 | loss: 0.0002142
	speed: 0.1319s/iter; left time: 331.6610s
	iters: 400, epoch: 25 | loss: 0.0006948
	speed: 0.1330s/iter; left time: 321.2935s
Epoch: 25 cost time: 62.874480962753296
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0006956
	speed: 0.5015s/iter; left time: 1126.3878s
	iters: 200, epoch: 26 | loss: 0.0005485
	speed: 0.1343s/iter; left time: 288.1513s
	iters: 300, epoch: 26 | loss: 0.0003613
	speed: 0.1326s/iter; left time: 271.3911s
	iters: 400, epoch: 26 | loss: 0.0015678
	speed: 0.1304s/iter; left time: 253.8385s
Epoch: 26 cost time: 62.16486406326294
Epoch: 26, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0124481
	speed: 0.5017s/iter; left time: 891.4356s
	iters: 200, epoch: 27 | loss: 0.0004882
	speed: 0.1157s/iter; left time: 194.0012s
	iters: 300, epoch: 27 | loss: 0.0002318
	speed: 0.0911s/iter; left time: 143.6295s
	iters: 400, epoch: 27 | loss: 0.0025198
	speed: 0.1381s/iter; left time: 204.0272s
Epoch: 27 cost time: 57.482775926589966
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0001548
	speed: 0.5421s/iter; left time: 709.0293s
	iters: 200, epoch: 28 | loss: 0.0040152
	speed: 0.1470s/iter; left time: 177.6155s
	iters: 300, epoch: 28 | loss: 0.0013613
	speed: 0.1405s/iter; left time: 155.6461s
	iters: 400, epoch: 28 | loss: 0.0178853
	speed: 0.1510s/iter; left time: 152.2352s
Epoch: 28 cost time: 68.26734972000122
Epoch: 28, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0014666
	speed: 0.5606s/iter; left time: 470.3799s
	iters: 200, epoch: 29 | loss: 0.0001984
	speed: 0.1453s/iter; left time: 107.4110s
	iters: 300, epoch: 29 | loss: 0.0006816
	speed: 0.1415s/iter; left time: 90.4255s
	iters: 400, epoch: 29 | loss: 0.0008040
	speed: 0.1468s/iter; left time: 79.1136s
Epoch: 29 cost time: 67.92980360984802
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 1173898
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5141135
	speed: 0.1152s/iter; left time: 1609.9170s
	iters: 200, epoch: 1 | loss: 1.0006065
	speed: 0.1058s/iter; left time: 1467.6698s
	iters: 300, epoch: 1 | loss: 0.4991811
	speed: 0.1073s/iter; left time: 1477.3913s
	iters: 400, epoch: 1 | loss: 0.3427847
	speed: 0.0990s/iter; left time: 1353.9358s
Epoch: 1 cost time: 49.699559688568115
Epoch: 1, Steps: 469 | Train Loss: 1.003 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
Validation loss decreased (inf --> -0.927670).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1530157
	speed: 0.4145s/iter; left time: 5595.9774s
	iters: 200, epoch: 2 | loss: 0.1155101
	speed: 0.0994s/iter; left time: 1332.2871s
	iters: 300, epoch: 2 | loss: 0.0845744
	speed: 0.0943s/iter; left time: 1254.6385s
	iters: 400, epoch: 2 | loss: 0.1205488
	speed: 0.0956s/iter; left time: 1262.6769s
Epoch: 2 cost time: 43.6032178401947
Epoch: 2, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.122 Vali Acc: 0.961 Test Loss: 0.122 Test Acc: 0.961
Validation loss decreased (-0.927670 --> -0.961119).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0333478
	speed: 0.3374s/iter; left time: 4397.8097s
	iters: 200, epoch: 3 | loss: 0.0138781
	speed: 0.0892s/iter; left time: 1153.7426s
	iters: 300, epoch: 3 | loss: 0.0402025
	speed: 0.0975s/iter; left time: 1251.5476s
	iters: 400, epoch: 3 | loss: 0.0066889
	speed: 0.0941s/iter; left time: 1198.4500s
Epoch: 3 cost time: 44.26496744155884
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
Validation loss decreased (-0.961119 --> -0.971125).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0107736
	speed: 0.3880s/iter; left time: 4874.7956s
	iters: 200, epoch: 4 | loss: 0.0985503
	speed: 0.0932s/iter; left time: 1161.4582s
	iters: 300, epoch: 4 | loss: 0.0185446
	speed: 0.0944s/iter; left time: 1166.6912s
	iters: 400, epoch: 4 | loss: 0.1512021
	speed: 0.0924s/iter; left time: 1133.0563s
Epoch: 4 cost time: 43.72958493232727
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.973984).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0103273
	speed: 0.3983s/iter; left time: 4817.4433s
	iters: 200, epoch: 5 | loss: 0.0239473
	speed: 0.0932s/iter; left time: 1118.4082s
	iters: 300, epoch: 5 | loss: 0.0022577
	speed: 0.0938s/iter; left time: 1115.1748s
	iters: 400, epoch: 5 | loss: 0.0776942
	speed: 0.0922s/iter; left time: 1087.8869s
Epoch: 5 cost time: 44.30500507354736
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0150267
	speed: 0.4006s/iter; left time: 4657.6511s
	iters: 200, epoch: 6 | loss: 0.0064007
	speed: 0.0619s/iter; left time: 713.9516s
	iters: 300, epoch: 6 | loss: 0.0161836
	speed: 0.0360s/iter; left time: 410.8837s
	iters: 400, epoch: 6 | loss: 0.2331284
	speed: 0.0385s/iter; left time: 435.5421s
Epoch: 6 cost time: 30.34420084953308
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0843913
	speed: 0.4100s/iter; left time: 4573.8705s
	iters: 200, epoch: 7 | loss: 0.0368033
	speed: 0.0988s/iter; left time: 1092.9109s
	iters: 300, epoch: 7 | loss: 0.2523133
	speed: 0.1017s/iter; left time: 1114.6332s
	iters: 400, epoch: 7 | loss: 0.0026896
	speed: 0.1001s/iter; left time: 1087.1431s
Epoch: 7 cost time: 46.96810722351074
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0019212
	speed: 0.4150s/iter; left time: 4435.1620s
	iters: 200, epoch: 8 | loss: 0.0106175
	speed: 0.0966s/iter; left time: 1022.8360s
	iters: 300, epoch: 8 | loss: 0.0034400
	speed: 0.0973s/iter; left time: 1020.2732s
	iters: 400, epoch: 8 | loss: 0.0042454
	speed: 0.0987s/iter; left time: 1025.4787s
Epoch: 8 cost time: 46.56773376464844
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.973984 --> -0.979130).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0016346
	speed: 0.4103s/iter; left time: 4192.5844s
	iters: 200, epoch: 9 | loss: 0.0033170
	speed: 0.1031s/iter; left time: 1043.1211s
	iters: 300, epoch: 9 | loss: 0.0343847
	speed: 0.1020s/iter; left time: 1021.8076s
	iters: 400, epoch: 9 | loss: 0.2919150
	speed: 0.0998s/iter; left time: 989.4478s
Epoch: 9 cost time: 46.86012840270996
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0041533
	speed: 0.3848s/iter; left time: 3751.6235s
	iters: 200, epoch: 10 | loss: 0.0021529
	speed: 0.0639s/iter; left time: 616.4536s
	iters: 300, epoch: 10 | loss: 0.0043149
	speed: 0.0729s/iter; left time: 696.5452s
	iters: 400, epoch: 10 | loss: 0.0011119
	speed: 0.0891s/iter; left time: 842.0056s
Epoch: 10 cost time: 37.8823881149292
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0012548
	speed: 0.3669s/iter; left time: 3405.0209s
	iters: 200, epoch: 11 | loss: 0.0008452
	speed: 0.0917s/iter; left time: 841.9101s
	iters: 300, epoch: 11 | loss: 0.2541653
	speed: 0.0869s/iter; left time: 789.5549s
	iters: 400, epoch: 11 | loss: 0.0052452
	speed: 0.0857s/iter; left time: 769.4481s
Epoch: 11 cost time: 41.8059184551239
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979416).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008254
	speed: 0.3682s/iter; left time: 3244.9584s
	iters: 200, epoch: 12 | loss: 0.0099508
	speed: 0.0862s/iter; left time: 750.6262s
	iters: 300, epoch: 12 | loss: 0.0040978
	speed: 0.0942s/iter; left time: 810.9399s
	iters: 400, epoch: 12 | loss: 0.0014258
	speed: 0.0910s/iter; left time: 774.9143s
Epoch: 12 cost time: 42.104203939437866
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0020791
	speed: 0.3369s/iter; left time: 2810.5710s
	iters: 200, epoch: 13 | loss: 0.0041528
	speed: 0.0901s/iter; left time: 742.7430s
	iters: 300, epoch: 13 | loss: 0.0055635
	speed: 0.0913s/iter; left time: 743.7169s
	iters: 400, epoch: 13 | loss: 0.0020999
	speed: 0.0984s/iter; left time: 791.4959s
Epoch: 13 cost time: 44.89567160606384
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0097259
	speed: 0.4006s/iter; left time: 3154.2751s
	iters: 200, epoch: 14 | loss: 0.0008019
	speed: 0.1056s/iter; left time: 820.6079s
	iters: 300, epoch: 14 | loss: 0.0019209
	speed: 0.1009s/iter; left time: 774.1980s
	iters: 400, epoch: 14 | loss: 0.0148545
	speed: 0.0982s/iter; left time: 744.0058s
Epoch: 14 cost time: 47.33622074127197
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.979416 --> -0.982561).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0311567
	speed: 0.4200s/iter; left time: 3110.4688s
	iters: 200, epoch: 15 | loss: 0.0001107
	speed: 0.0971s/iter; left time: 709.2983s
	iters: 300, epoch: 15 | loss: 0.0007236
	speed: 0.1002s/iter; left time: 721.7923s
	iters: 400, epoch: 15 | loss: 0.0007930
	speed: 0.1026s/iter; left time: 729.1156s
Epoch: 15 cost time: 47.37306213378906
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0016215
	speed: 0.4125s/iter; left time: 2861.2058s
	iters: 200, epoch: 16 | loss: 0.0012288
	speed: 0.0628s/iter; left time: 429.4745s
	iters: 300, epoch: 16 | loss: 0.0012679
	speed: 0.0898s/iter; left time: 604.9360s
	iters: 400, epoch: 16 | loss: 0.0005963
	speed: 0.1034s/iter; left time: 686.4696s
Epoch: 16 cost time: 42.562479972839355
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0005277
	speed: 0.4191s/iter; left time: 2710.6108s
	iters: 200, epoch: 17 | loss: 0.0009087
	speed: 0.0658s/iter; left time: 418.9975s
	iters: 300, epoch: 17 | loss: 0.0004748
	speed: 0.0970s/iter; left time: 607.8485s
	iters: 400, epoch: 17 | loss: 0.0002429
	speed: 0.0929s/iter; left time: 572.6999s
Epoch: 17 cost time: 41.76129746437073
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0002278
	speed: 0.3993s/iter; left time: 2395.2001s
	iters: 200, epoch: 18 | loss: 0.0001514
	speed: 0.0912s/iter; left time: 537.8746s
	iters: 300, epoch: 18 | loss: 0.0004429
	speed: 0.0912s/iter; left time: 528.9136s
	iters: 400, epoch: 18 | loss: 0.0041506
	speed: 0.0913s/iter; left time: 519.9620s
Epoch: 18 cost time: 43.41512084007263
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0002348
	speed: 0.3928s/iter; left time: 2171.9371s
	iters: 200, epoch: 19 | loss: 0.0002218
	speed: 0.0942s/iter; left time: 511.2240s
	iters: 300, epoch: 19 | loss: 0.0024450
	speed: 0.0903s/iter; left time: 481.1521s
	iters: 400, epoch: 19 | loss: 0.0829749
	speed: 0.0936s/iter; left time: 489.2295s
Epoch: 19 cost time: 42.89535117149353
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.982561 --> -0.983704).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0008008
	speed: 0.3507s/iter; left time: 1774.3133s
	iters: 200, epoch: 20 | loss: 0.0003003
	speed: 0.0986s/iter; left time: 488.9190s
	iters: 300, epoch: 20 | loss: 0.0004931
	speed: 0.0942s/iter; left time: 457.7192s
	iters: 400, epoch: 20 | loss: 0.0000241
	speed: 0.0958s/iter; left time: 456.1376s
Epoch: 20 cost time: 45.53935217857361
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983704 --> -0.984562).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0199433
	speed: 0.3928s/iter; left time: 1803.3058s
	iters: 200, epoch: 21 | loss: 0.0009996
	speed: 0.0951s/iter; left time: 426.8793s
	iters: 300, epoch: 21 | loss: 0.0008865
	speed: 0.0972s/iter; left time: 426.8428s
	iters: 400, epoch: 21 | loss: 0.0016409
	speed: 0.0985s/iter; left time: 422.6748s
Epoch: 21 cost time: 45.40962219238281
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0001980
	speed: 0.4070s/iter; left time: 1677.6609s
	iters: 200, epoch: 22 | loss: 0.0014019
	speed: 0.1034s/iter; left time: 415.7710s
	iters: 300, epoch: 22 | loss: 0.1038097
	speed: 0.1061s/iter; left time: 416.1246s
	iters: 400, epoch: 22 | loss: 0.0003043
	speed: 0.0999s/iter; left time: 381.8795s
Epoch: 22 cost time: 49.310866594314575
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0005141
	speed: 0.4168s/iter; left time: 1522.6967s
	iters: 200, epoch: 23 | loss: 0.0026150
	speed: 0.0760s/iter; left time: 270.0961s
	iters: 300, epoch: 23 | loss: 0.0001872
	speed: 0.0845s/iter; left time: 291.7873s
	iters: 400, epoch: 23 | loss: 0.3877240
	speed: 0.0964s/iter; left time: 323.2449s
Epoch: 23 cost time: 42.42965626716614
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0059955
	speed: 0.3920s/iter; left time: 1248.0130s
	iters: 200, epoch: 24 | loss: 0.0004079
	speed: 0.0972s/iter; left time: 299.7168s
	iters: 300, epoch: 24 | loss: 0.0005629
	speed: 0.0971s/iter; left time: 289.6904s
	iters: 400, epoch: 24 | loss: 0.0009154
	speed: 0.0965s/iter; left time: 278.3922s
Epoch: 24 cost time: 45.571242809295654
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0017757
	speed: 0.3891s/iter; left time: 1056.4986s
	iters: 200, epoch: 25 | loss: 0.0001011
	speed: 0.0936s/iter; left time: 244.8317s
	iters: 300, epoch: 25 | loss: 0.0405043
	speed: 0.0969s/iter; left time: 243.6657s
	iters: 400, epoch: 25 | loss: 0.0004544
	speed: 0.0979s/iter; left time: 236.4510s
Epoch: 25 cost time: 45.178454637527466
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0081982
	speed: 0.3850s/iter; left time: 864.8024s
	iters: 200, epoch: 26 | loss: 0.0000987
	speed: 0.0909s/iter; left time: 195.1454s
	iters: 300, epoch: 26 | loss: 0.0000802
	speed: 0.0849s/iter; left time: 173.7807s
	iters: 400, epoch: 26 | loss: 0.0002994
	speed: 0.0712s/iter; left time: 138.6337s
Epoch: 26 cost time: 38.84451365470886
Epoch: 26, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0003879
	speed: 0.3806s/iter; left time: 676.3442s
	iters: 200, epoch: 27 | loss: 0.0010766
	speed: 0.0896s/iter; left time: 150.2110s
	iters: 300, epoch: 27 | loss: 0.0041429
	speed: 0.0926s/iter; left time: 145.9652s
	iters: 400, epoch: 27 | loss: 0.0005843
	speed: 0.0976s/iter; left time: 144.1059s
Epoch: 27 cost time: 44.610020875930786
Epoch: 27, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0003440
	speed: 0.3964s/iter; left time: 518.4598s
	iters: 200, epoch: 28 | loss: 0.0011604
	speed: 0.0897s/iter; left time: 108.3005s
	iters: 300, epoch: 28 | loss: 0.0026793
	speed: 0.0964s/iter; left time: 106.8170s
	iters: 400, epoch: 28 | loss: 0.0009546
	speed: 0.0909s/iter; left time: 91.6603s
Epoch: 28 cost time: 43.863882303237915
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0001391
	speed: 0.3572s/iter; left time: 299.7156s
	iters: 200, epoch: 29 | loss: 0.0007200
	speed: 0.0850s/iter; left time: 62.8377s
	iters: 300, epoch: 29 | loss: 0.0000745
	speed: 0.0837s/iter; left time: 53.4560s
	iters: 400, epoch: 29 | loss: 0.0032910
	speed: 0.0860s/iter; left time: 46.3516s
Epoch: 29 cost time: 38.24110412597656
Epoch: 29, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0038500
	speed: 0.3646s/iter; left time: 134.8913s
	iters: 200, epoch: 30 | loss: 0.0000434
	speed: 0.0935s/iter; left time: 25.2524s
	iters: 300, epoch: 30 | loss: 0.0001619
	speed: 0.0917s/iter; left time: 15.5871s
	iters: 400, epoch: 30 | loss: 0.0002292
	speed: 0.0880s/iter; left time: 6.1570s
Epoch: 30 cost time: 43.010427713394165
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 346186
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9107732
	speed: 0.1198s/iter; left time: 1673.3184s
	iters: 200, epoch: 1 | loss: 0.9655073
	speed: 0.0766s/iter; left time: 1062.6305s
	iters: 300, epoch: 1 | loss: 0.5767573
	speed: 0.1135s/iter; left time: 1562.8065s
	iters: 400, epoch: 1 | loss: 0.3668334
	speed: 0.1214s/iter; left time: 1659.7767s
Epoch: 1 cost time: 49.14367604255676
Epoch: 1, Steps: 469 | Train Loss: 1.037 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
Validation loss decreased (inf --> -0.925097).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2605424
	speed: 0.3806s/iter; left time: 5138.5574s
	iters: 200, epoch: 2 | loss: 0.1074132
	speed: 0.1126s/iter; left time: 1509.1768s
	iters: 300, epoch: 2 | loss: 0.2215034
	speed: 0.1210s/iter; left time: 1608.9525s
	iters: 400, epoch: 2 | loss: 0.0564789
	speed: 0.1132s/iter; left time: 1495.0754s
Epoch: 2 cost time: 54.115368366241455
Epoch: 2, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.925097 --> -0.966837).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0373774
	speed: 0.4416s/iter; left time: 5755.2124s
	iters: 200, epoch: 3 | loss: 0.0240647
	speed: 0.1168s/iter; left time: 1510.5248s
	iters: 300, epoch: 3 | loss: 0.0400287
	speed: 0.1163s/iter; left time: 1492.8552s
	iters: 400, epoch: 3 | loss: 0.1492574
	speed: 0.1070s/iter; left time: 1361.9060s
Epoch: 3 cost time: 53.09990739822388
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2014736
	speed: 0.4206s/iter; left time: 5284.6042s
	iters: 200, epoch: 4 | loss: 0.0228804
	speed: 0.1106s/iter; left time: 1378.5759s
	iters: 300, epoch: 4 | loss: 0.0115846
	speed: 0.1124s/iter; left time: 1390.1222s
	iters: 400, epoch: 4 | loss: 0.0078693
	speed: 0.1091s/iter; left time: 1338.3981s
Epoch: 4 cost time: 51.86745262145996
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.966837 --> -0.979416).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0120012
	speed: 0.4279s/iter; left time: 5174.9235s
	iters: 200, epoch: 5 | loss: 0.0102042
	speed: 0.1110s/iter; left time: 1331.2252s
	iters: 300, epoch: 5 | loss: 0.0725621
	speed: 0.1118s/iter; left time: 1329.9831s
	iters: 400, epoch: 5 | loss: 0.0182328
	speed: 0.1060s/iter; left time: 1250.4704s
Epoch: 5 cost time: 52.09436345100403
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1163014
	speed: 0.4270s/iter; left time: 4963.9239s
	iters: 200, epoch: 6 | loss: 0.0012429
	speed: 0.1107s/iter; left time: 1276.3018s
	iters: 300, epoch: 6 | loss: 0.0023268
	speed: 0.1061s/iter; left time: 1212.3407s
	iters: 400, epoch: 6 | loss: 0.0191169
	speed: 0.1158s/iter; left time: 1311.8135s
Epoch: 6 cost time: 52.75619339942932
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.057 Vali Acc: 0.984 Test Loss: 0.057 Test Acc: 0.984
Validation loss decreased (-0.979416 --> -0.983990).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0040208
	speed: 0.4218s/iter; left time: 4705.8843s
	iters: 200, epoch: 7 | loss: 0.0230232
	speed: 0.1008s/iter; left time: 1114.2969s
	iters: 300, epoch: 7 | loss: 0.0150962
	speed: 0.1096s/iter; left time: 1200.7962s
	iters: 400, epoch: 7 | loss: 0.0007012
	speed: 0.0734s/iter; left time: 797.0959s
Epoch: 7 cost time: 46.010584592819214
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0050092
	speed: 0.4050s/iter; left time: 4328.6622s
	iters: 200, epoch: 8 | loss: 0.0326476
	speed: 0.1103s/iter; left time: 1168.2588s
	iters: 300, epoch: 8 | loss: 0.0063639
	speed: 0.1138s/iter; left time: 1193.2216s
	iters: 400, epoch: 8 | loss: 0.0293673
	speed: 0.1114s/iter; left time: 1157.3891s
Epoch: 8 cost time: 51.51249289512634
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0206281
	speed: 0.4215s/iter; left time: 4307.4777s
	iters: 200, epoch: 9 | loss: 0.0055148
	speed: 0.1150s/iter; left time: 1163.6064s
	iters: 300, epoch: 9 | loss: 0.0093151
	speed: 0.1096s/iter; left time: 1098.0500s
	iters: 400, epoch: 9 | loss: 0.0485295
	speed: 0.1064s/iter; left time: 1055.0190s
Epoch: 9 cost time: 51.903972864151
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0017065
	speed: 0.4220s/iter; left time: 4114.1174s
	iters: 200, epoch: 10 | loss: 0.0057457
	speed: 0.1137s/iter; left time: 1097.6797s
	iters: 300, epoch: 10 | loss: 0.0108643
	speed: 0.0909s/iter; left time: 867.8157s
	iters: 400, epoch: 10 | loss: 0.0126657
	speed: 0.0789s/iter; left time: 745.8200s
Epoch: 10 cost time: 47.01137900352478
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0025119
	speed: 0.3665s/iter; left time: 3401.6964s
	iters: 200, epoch: 11 | loss: 0.0012650
	speed: 0.0902s/iter; left time: 827.9642s
	iters: 300, epoch: 11 | loss: 0.0006787
	speed: 0.1168s/iter; left time: 1060.2925s
	iters: 400, epoch: 11 | loss: 0.0016008
	speed: 0.1096s/iter; left time: 984.2035s
Epoch: 11 cost time: 46.826822996139526
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0023063
	speed: 0.4278s/iter; left time: 3769.4312s
	iters: 200, epoch: 12 | loss: 0.0043254
	speed: 0.1101s/iter; left time: 958.7892s
	iters: 300, epoch: 12 | loss: 0.0005222
	speed: 0.1119s/iter; left time: 963.8710s
	iters: 400, epoch: 12 | loss: 0.0059328
	speed: 0.1088s/iter; left time: 925.9492s
Epoch: 12 cost time: 53.0931658744812
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0004623
	speed: 0.4284s/iter; left time: 3574.3788s
	iters: 200, epoch: 13 | loss: 0.0016047
	speed: 0.1121s/iter; left time: 923.8908s
	iters: 300, epoch: 13 | loss: 0.0067138
	speed: 0.1158s/iter; left time: 943.0303s
	iters: 400, epoch: 13 | loss: 0.0011458
	speed: 0.1144s/iter; left time: 919.7570s
Epoch: 13 cost time: 53.0064697265625
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0441790
	speed: 0.4316s/iter; left time: 3398.1561s
	iters: 200, epoch: 14 | loss: 0.2145293
	speed: 0.1115s/iter; left time: 866.8558s
	iters: 300, epoch: 14 | loss: 0.0002887
	speed: 0.1073s/iter; left time: 823.7765s
	iters: 400, epoch: 14 | loss: 0.0011149
	speed: 0.1078s/iter; left time: 816.6283s
Epoch: 14 cost time: 52.31289291381836
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0003250
	speed: 0.4285s/iter; left time: 3173.0554s
	iters: 200, epoch: 15 | loss: 0.0007586
	speed: 0.0925s/iter; left time: 675.7130s
	iters: 300, epoch: 15 | loss: 0.0020713
	speed: 0.0978s/iter; left time: 704.8258s
	iters: 400, epoch: 15 | loss: 0.0018611
	speed: 0.1117s/iter; left time: 793.9103s
Epoch: 15 cost time: 48.33412504196167
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0032892
	speed: 0.4242s/iter; left time: 2942.0754s
	iters: 200, epoch: 16 | loss: 0.0014633
	speed: 0.1101s/iter; left time: 752.5844s
	iters: 300, epoch: 16 | loss: 0.0052552
	speed: 0.1066s/iter; left time: 718.2329s
	iters: 400, epoch: 16 | loss: 0.0012188
	speed: 0.1099s/iter; left time: 729.1029s
Epoch: 16 cost time: 52.16808795928955
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 1173898
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5100859
	speed: 0.1019s/iter; left time: 1423.8054s
	iters: 200, epoch: 1 | loss: 1.0228258
	speed: 0.0898s/iter; left time: 1245.8254s
	iters: 300, epoch: 1 | loss: 0.5177974
	speed: 0.0742s/iter; left time: 1021.2764s
	iters: 400, epoch: 1 | loss: 0.3419488
	speed: 0.0529s/iter; left time: 722.5998s
Epoch: 1 cost time: 35.973143577575684
Epoch: 1, Steps: 469 | Train Loss: 1.013 Vali Loss: 0.270 Vali Acc: 0.921 Test Loss: 0.270 Test Acc: 0.921
Validation loss decreased (inf --> -0.920523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1742562
	speed: 0.3721s/iter; left time: 5024.6825s
	iters: 200, epoch: 2 | loss: 0.1478681
	speed: 0.0889s/iter; left time: 1190.7741s
	iters: 300, epoch: 2 | loss: 0.0824598
	speed: 0.0824s/iter; left time: 1096.2533s
	iters: 400, epoch: 2 | loss: 0.0646249
	speed: 0.0914s/iter; left time: 1207.2295s
Epoch: 2 cost time: 41.23258590698242
Epoch: 2, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.920523 --> -0.969124).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0328867
	speed: 0.3721s/iter; left time: 4850.0557s
	iters: 200, epoch: 3 | loss: 0.0131972
	speed: 0.0837s/iter; left time: 1082.0628s
	iters: 300, epoch: 3 | loss: 0.0176878
	speed: 0.0843s/iter; left time: 1081.7648s
	iters: 400, epoch: 3 | loss: 0.0124597
	speed: 0.0866s/iter; left time: 1103.2377s
Epoch: 3 cost time: 39.72580599784851
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.969124 --> -0.973698).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0048683
	speed: 0.3620s/iter; left time: 4548.1259s
	iters: 200, epoch: 4 | loss: 0.0501125
	speed: 0.0844s/iter; left time: 1052.5482s
	iters: 300, epoch: 4 | loss: 0.0344010
	speed: 0.0860s/iter; left time: 1063.1605s
	iters: 400, epoch: 4 | loss: 0.0868843
	speed: 0.0797s/iter; left time: 977.1499s
Epoch: 4 cost time: 39.92333674430847
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0071638
	speed: 0.3727s/iter; left time: 4508.3618s
	iters: 200, epoch: 5 | loss: 0.0204655
	speed: 0.0774s/iter; left time: 928.4517s
	iters: 300, epoch: 5 | loss: 0.0042232
	speed: 0.0651s/iter; left time: 773.9260s
	iters: 400, epoch: 5 | loss: 0.0347107
	speed: 0.0499s/iter; left time: 588.0098s
Epoch: 5 cost time: 33.20510292053223
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.963 Test Loss: 0.115 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0101998
	speed: 0.1883s/iter; left time: 2189.3181s
	iters: 200, epoch: 6 | loss: 0.0109797
	speed: 0.0780s/iter; left time: 899.1795s
	iters: 300, epoch: 6 | loss: 0.0209913
	speed: 0.0696s/iter; left time: 794.8480s
	iters: 400, epoch: 6 | loss: 0.0020364
	speed: 0.0728s/iter; left time: 824.8756s
Epoch: 6 cost time: 32.32593321800232
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1004734
	speed: 0.3182s/iter; left time: 3549.9981s
	iters: 200, epoch: 7 | loss: 0.0082729
	speed: 0.0735s/iter; left time: 812.7379s
	iters: 300, epoch: 7 | loss: 0.2924999
	speed: 0.0742s/iter; left time: 812.8128s
	iters: 400, epoch: 7 | loss: 0.0029933
	speed: 0.0705s/iter; left time: 765.6003s
Epoch: 7 cost time: 33.66147828102112
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.974270 --> -0.982275).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0018172
	speed: 0.2897s/iter; left time: 3096.4932s
	iters: 200, epoch: 8 | loss: 0.0182837
	speed: 0.0811s/iter; left time: 858.6168s
	iters: 300, epoch: 8 | loss: 0.0125801
	speed: 0.0799s/iter; left time: 838.2220s
	iters: 400, epoch: 8 | loss: 0.0029162
	speed: 0.0918s/iter; left time: 953.5032s
Epoch: 8 cost time: 40.257235527038574
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0595330
	speed: 0.3690s/iter; left time: 3771.1765s
	iters: 200, epoch: 9 | loss: 0.0086361
	speed: 0.0894s/iter; left time: 905.0079s
	iters: 300, epoch: 9 | loss: 0.0177152
	speed: 0.0736s/iter; left time: 737.6439s
	iters: 400, epoch: 9 | loss: 0.2439207
	speed: 0.0902s/iter; left time: 894.3699s
Epoch: 9 cost time: 40.299439668655396
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0028716
	speed: 0.3744s/iter; left time: 3650.1310s
	iters: 200, epoch: 10 | loss: 0.0043245
	speed: 0.0859s/iter; left time: 828.5526s
	iters: 300, epoch: 10 | loss: 0.1115388
	speed: 0.0876s/iter; left time: 836.2429s
	iters: 400, epoch: 10 | loss: 0.0017032
	speed: 0.0833s/iter; left time: 786.7843s
Epoch: 10 cost time: 40.37799143791199
Epoch: 10, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0012133
	speed: 0.3768s/iter; left time: 3497.1408s
	iters: 200, epoch: 11 | loss: 0.0012896
	speed: 0.0876s/iter; left time: 804.4653s
	iters: 300, epoch: 11 | loss: 0.0634561
	speed: 0.0854s/iter; left time: 775.1166s
	iters: 400, epoch: 11 | loss: 0.0015298
	speed: 0.0856s/iter; left time: 769.2219s
Epoch: 11 cost time: 41.09314227104187
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0005591
	speed: 0.3671s/iter; left time: 3234.5826s
	iters: 200, epoch: 12 | loss: 0.0058689
	speed: 0.0816s/iter; left time: 710.8618s
	iters: 300, epoch: 12 | loss: 0.0027473
	speed: 0.0879s/iter; left time: 756.9787s
	iters: 400, epoch: 12 | loss: 0.0092507
	speed: 0.0718s/iter; left time: 611.3836s
Epoch: 12 cost time: 38.04674673080444
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0024117
	speed: 0.3635s/iter; left time: 3033.0824s
	iters: 200, epoch: 13 | loss: 0.0016340
	speed: 0.0751s/iter; left time: 619.2552s
	iters: 300, epoch: 13 | loss: 0.0976566
	speed: 0.0806s/iter; left time: 656.6346s
	iters: 400, epoch: 13 | loss: 0.0010852
	speed: 0.0545s/iter; left time: 438.3868s
Epoch: 13 cost time: 33.29239630699158
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.983133).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0033034
	speed: 0.3249s/iter; left time: 2558.6180s
	iters: 200, epoch: 14 | loss: 0.0005453
	speed: 0.0568s/iter; left time: 441.4233s
	iters: 300, epoch: 14 | loss: 0.0005426
	speed: 0.0582s/iter; left time: 446.6126s
	iters: 400, epoch: 14 | loss: 0.0013512
	speed: 0.0818s/iter; left time: 619.5006s
Epoch: 14 cost time: 33.845670223236084
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
Validation loss decreased (-0.983133 --> -0.985706).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0057812
	speed: 0.3606s/iter; left time: 2670.5412s
	iters: 200, epoch: 15 | loss: 0.0002622
	speed: 0.0842s/iter; left time: 615.4238s
	iters: 300, epoch: 15 | loss: 0.0008911
	speed: 0.0780s/iter; left time: 562.1884s
	iters: 400, epoch: 15 | loss: 0.0014968
	speed: 0.0802s/iter; left time: 569.8220s
Epoch: 15 cost time: 39.0984787940979
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0122682
	speed: 0.3556s/iter; left time: 2466.1299s
	iters: 200, epoch: 16 | loss: 0.0008296
	speed: 0.0850s/iter; left time: 580.8468s
	iters: 300, epoch: 16 | loss: 0.0011447
	speed: 0.0793s/iter; left time: 534.1090s
	iters: 400, epoch: 16 | loss: 0.0214923
	speed: 0.0808s/iter; left time: 536.0042s
Epoch: 16 cost time: 39.31884002685547
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0009377
	speed: 0.3422s/iter; left time: 2213.1019s
	iters: 200, epoch: 17 | loss: 0.0002407
	speed: 0.0692s/iter; left time: 440.5804s
	iters: 300, epoch: 17 | loss: 0.0009215
	speed: 0.0872s/iter; left time: 546.2737s
	iters: 400, epoch: 17 | loss: 0.0005672
	speed: 0.0832s/iter; left time: 512.9639s
Epoch: 17 cost time: 37.20254421234131
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0050887
	speed: 0.3793s/iter; left time: 2274.9471s
	iters: 200, epoch: 18 | loss: 0.0005278
	speed: 0.0896s/iter; left time: 528.6640s
	iters: 300, epoch: 18 | loss: 0.0009090
	speed: 0.0895s/iter; left time: 518.8451s
	iters: 400, epoch: 18 | loss: 0.1615351
	speed: 0.0826s/iter; left time: 470.5168s
Epoch: 18 cost time: 41.97042274475098
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0018120
	speed: 0.3891s/iter; left time: 2151.2154s
	iters: 200, epoch: 19 | loss: 0.0001330
	speed: 0.0930s/iter; left time: 505.1002s
	iters: 300, epoch: 19 | loss: 0.0131046
	speed: 0.0871s/iter; left time: 464.4092s
	iters: 400, epoch: 19 | loss: 0.0246243
	speed: 0.0874s/iter; left time: 457.0183s
Epoch: 19 cost time: 41.59326958656311
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0004442
	speed: 0.3820s/iter; left time: 1933.0652s
	iters: 200, epoch: 20 | loss: 0.0001774
	speed: 0.0918s/iter; left time: 455.4685s
	iters: 300, epoch: 20 | loss: 0.0004803
	speed: 0.0853s/iter; left time: 414.3838s
	iters: 400, epoch: 20 | loss: 0.0000284
	speed: 0.0899s/iter; left time: 427.9076s
Epoch: 20 cost time: 41.409281730651855
Epoch: 20, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0032426
	speed: 0.3799s/iter; left time: 1744.2895s
	iters: 200, epoch: 21 | loss: 0.0026433
	speed: 0.0862s/iter; left time: 387.2712s
	iters: 300, epoch: 21 | loss: 0.0823261
	speed: 0.0861s/iter; left time: 378.1218s
	iters: 400, epoch: 21 | loss: 0.0016551
	speed: 0.0821s/iter; left time: 352.1872s
Epoch: 21 cost time: 40.39910387992859
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0001606
	speed: 0.3686s/iter; left time: 1519.5348s
	iters: 200, epoch: 22 | loss: 0.0001739
	speed: 0.0850s/iter; left time: 341.8492s
	iters: 300, epoch: 22 | loss: 0.0170159
	speed: 0.0871s/iter; left time: 341.6688s
	iters: 400, epoch: 22 | loss: 0.0003241
	speed: 0.0827s/iter; left time: 316.0791s
Epoch: 22 cost time: 40.26646447181702
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0004001
	speed: 0.3620s/iter; left time: 1322.2723s
	iters: 200, epoch: 23 | loss: 0.0034580
	speed: 0.0871s/iter; left time: 309.3454s
	iters: 300, epoch: 23 | loss: 0.0004918
	speed: 0.0829s/iter; left time: 286.3656s
	iters: 400, epoch: 23 | loss: 0.0002079
	speed: 0.0866s/iter; left time: 290.2654s
Epoch: 23 cost time: 39.96946382522583
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0005153
	speed: 0.3665s/iter; left time: 1166.9780s
	iters: 200, epoch: 24 | loss: 0.0010523
	speed: 0.0893s/iter; left time: 275.3597s
	iters: 300, epoch: 24 | loss: 0.0026469
	speed: 0.0824s/iter; left time: 245.7414s
	iters: 400, epoch: 24 | loss: 0.0002913
	speed: 0.0883s/iter; left time: 254.5202s
Epoch: 24 cost time: 39.98113179206848
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 346186
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9481200
	speed: 0.0737s/iter; left time: 1030.0820s
	iters: 200, epoch: 1 | loss: 1.2080635
	speed: 0.0750s/iter; left time: 1039.8257s
	iters: 300, epoch: 1 | loss: 0.7459191
	speed: 0.0882s/iter; left time: 1214.2819s
	iters: 400, epoch: 1 | loss: 0.4666894
	speed: 0.0895s/iter; left time: 1223.8871s
Epoch: 1 cost time: 39.335471868515015
Epoch: 1, Steps: 469 | Train Loss: 1.152 Vali Loss: 0.377 Vali Acc: 0.866 Test Loss: 0.377 Test Acc: 0.866
Validation loss decreased (inf --> -0.866205).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1972938
	speed: 0.3803s/iter; left time: 5134.2965s
	iters: 200, epoch: 2 | loss: 0.1122364
	speed: 0.0866s/iter; left time: 1161.2491s
	iters: 300, epoch: 2 | loss: 0.2787203
	speed: 0.0838s/iter; left time: 1114.3062s
	iters: 400, epoch: 2 | loss: 0.1428321
	speed: 0.0940s/iter; left time: 1241.4663s
Epoch: 2 cost time: 42.48509740829468
Epoch: 2, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
Validation loss decreased (-0.866205 --> -0.954258).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0527789
	speed: 0.3385s/iter; left time: 4411.3080s
	iters: 200, epoch: 3 | loss: 0.0357734
	speed: 0.0668s/iter; left time: 864.4020s
	iters: 300, epoch: 3 | loss: 0.0467122
	speed: 0.0916s/iter; left time: 1175.5639s
	iters: 400, epoch: 3 | loss: 0.1882093
	speed: 0.0972s/iter; left time: 1237.8889s
Epoch: 3 cost time: 38.0181930065155
Epoch: 3, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
Validation loss decreased (-0.954258 --> -0.957403).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1102796
	speed: 0.3768s/iter; left time: 4734.5223s
	iters: 200, epoch: 4 | loss: 0.0489903
	speed: 0.0964s/iter; left time: 1201.1696s
	iters: 300, epoch: 4 | loss: 0.0383678
	speed: 0.0920s/iter; left time: 1137.8315s
	iters: 400, epoch: 4 | loss: 0.0076651
	speed: 0.0986s/iter; left time: 1208.9338s
Epoch: 4 cost time: 43.37600898742676
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.957403 --> -0.980274).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0049990
	speed: 0.3850s/iter; left time: 4656.7942s
	iters: 200, epoch: 5 | loss: 0.0185119
	speed: 0.0937s/iter; left time: 1124.0388s
	iters: 300, epoch: 5 | loss: 0.0517728
	speed: 0.0988s/iter; left time: 1175.2519s
	iters: 400, epoch: 5 | loss: 0.0040467
	speed: 0.0908s/iter; left time: 1070.7171s
Epoch: 5 cost time: 44.215736627578735
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0334002
	speed: 0.3487s/iter; left time: 4054.3280s
	iters: 200, epoch: 6 | loss: 0.0018064
	speed: 0.0549s/iter; left time: 633.0162s
	iters: 300, epoch: 6 | loss: 0.0037454
	speed: 0.0751s/iter; left time: 858.0077s
	iters: 400, epoch: 6 | loss: 0.0448081
	speed: 0.0842s/iter; left time: 954.1058s
Epoch: 6 cost time: 34.83037352561951
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0154113
	speed: 0.3279s/iter; left time: 3658.2839s
	iters: 200, epoch: 7 | loss: 0.0093496
	speed: 0.0829s/iter; left time: 916.8584s
	iters: 300, epoch: 7 | loss: 0.0074568
	speed: 0.0843s/iter; left time: 923.1638s
	iters: 400, epoch: 7 | loss: 0.0006923
	speed: 0.0858s/iter; left time: 931.9797s
Epoch: 7 cost time: 39.15938663482666
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.980274 --> -0.982847).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0019983
	speed: 0.2907s/iter; left time: 3106.6207s
	iters: 200, epoch: 8 | loss: 0.2396067
	speed: 0.0859s/iter; left time: 909.6727s
	iters: 300, epoch: 8 | loss: 0.0071854
	speed: 0.0520s/iter; left time: 545.7692s
	iters: 400, epoch: 8 | loss: 0.0075313
	speed: 0.0455s/iter; left time: 472.8858s
Epoch: 8 cost time: 33.270402908325195
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0112229
	speed: 0.3618s/iter; left time: 3697.3837s
	iters: 200, epoch: 9 | loss: 0.0126922
	speed: 0.0933s/iter; left time: 944.1518s
	iters: 300, epoch: 9 | loss: 0.0558277
	speed: 0.0834s/iter; left time: 835.2175s
	iters: 400, epoch: 9 | loss: 0.2410093
	speed: 0.0929s/iter; left time: 921.0930s
Epoch: 9 cost time: 42.71147632598877
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0008727
	speed: 0.3656s/iter; left time: 3564.5835s
	iters: 200, epoch: 10 | loss: 0.0068401
	speed: 0.0857s/iter; left time: 827.3078s
	iters: 300, epoch: 10 | loss: 0.0074955
	speed: 0.0936s/iter; left time: 894.1154s
	iters: 400, epoch: 10 | loss: 0.0088777
	speed: 0.0904s/iter; left time: 854.2062s
Epoch: 10 cost time: 41.65542912483215
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0060065
	speed: 0.3564s/iter; left time: 3307.4221s
	iters: 200, epoch: 11 | loss: 0.0008285
	speed: 0.0913s/iter; left time: 838.1104s
	iters: 300, epoch: 11 | loss: 0.0004405
	speed: 0.0941s/iter; left time: 854.5853s
	iters: 400, epoch: 11 | loss: 0.0046032
	speed: 0.0775s/iter; left time: 696.1119s
Epoch: 11 cost time: 41.77868413925171
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0028132
	speed: 0.2749s/iter; left time: 2422.5807s
	iters: 200, epoch: 12 | loss: 0.0013525
	speed: 0.0664s/iter; left time: 578.1474s
	iters: 300, epoch: 12 | loss: 0.0025856
	speed: 0.0667s/iter; left time: 574.2893s
	iters: 400, epoch: 12 | loss: 0.0051814
	speed: 0.0759s/iter; left time: 646.4337s
Epoch: 12 cost time: 32.14105558395386
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983133).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0011334
	speed: 0.3980s/iter; left time: 3320.7614s
	iters: 200, epoch: 13 | loss: 0.0013458
	speed: 0.0933s/iter; left time: 769.3503s
	iters: 300, epoch: 13 | loss: 0.0144536
	speed: 0.0958s/iter; left time: 780.0091s
	iters: 400, epoch: 13 | loss: 0.0021118
	speed: 0.1015s/iter; left time: 816.2767s
Epoch: 13 cost time: 45.70123910903931
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0007596
	speed: 0.3905s/iter; left time: 3074.8007s
	iters: 200, epoch: 14 | loss: 0.0009146
	speed: 0.0842s/iter; left time: 654.2539s
	iters: 300, epoch: 14 | loss: 0.0016686
	speed: 0.0721s/iter; left time: 553.3526s
	iters: 400, epoch: 14 | loss: 0.0011784
	speed: 0.0855s/iter; left time: 647.4211s
Epoch: 14 cost time: 40.42252850532532
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983133 --> -0.984562).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0006393
	speed: 0.4119s/iter; left time: 3049.8886s
	iters: 200, epoch: 15 | loss: 0.0085075
	speed: 0.0677s/iter; left time: 494.4258s
	iters: 300, epoch: 15 | loss: 0.0030064
	speed: 0.0570s/iter; left time: 410.7738s
	iters: 400, epoch: 15 | loss: 0.0015240
	speed: 0.1078s/iter; left time: 765.8328s
Epoch: 15 cost time: 40.88821840286255
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.984562 --> -0.986563).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0015529
	speed: 0.4325s/iter; left time: 2999.4873s
	iters: 200, epoch: 16 | loss: 0.0039472
	speed: 0.1097s/iter; left time: 749.8090s
	iters: 300, epoch: 16 | loss: 0.0065411
	speed: 0.1039s/iter; left time: 700.1521s
	iters: 400, epoch: 16 | loss: 0.0005215
	speed: 0.1013s/iter; left time: 672.5153s
Epoch: 16 cost time: 49.00202989578247
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0012567
	speed: 0.4043s/iter; left time: 2614.5602s
	iters: 200, epoch: 17 | loss: 0.0007298
	speed: 0.0973s/iter; left time: 619.6422s
	iters: 300, epoch: 17 | loss: 0.0014360
	speed: 0.0718s/iter; left time: 450.1136s
	iters: 400, epoch: 17 | loss: 0.0004384
	speed: 0.0602s/iter; left time: 371.3737s
Epoch: 17 cost time: 39.0620391368866
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2037525
	speed: 0.3696s/iter; left time: 2217.0743s
	iters: 200, epoch: 18 | loss: 0.0005627
	speed: 0.0859s/iter; left time: 506.6921s
	iters: 300, epoch: 18 | loss: 0.0016948
	speed: 0.0909s/iter; left time: 527.0114s
	iters: 400, epoch: 18 | loss: 0.0053619
	speed: 0.0927s/iter; left time: 528.1087s
Epoch: 18 cost time: 42.75855040550232
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0012314
	speed: 0.3734s/iter; left time: 2064.6844s
	iters: 200, epoch: 19 | loss: 0.0003245
	speed: 0.0923s/iter; left time: 501.0090s
	iters: 300, epoch: 19 | loss: 0.0071481
	speed: 0.0695s/iter; left time: 370.4482s
	iters: 400, epoch: 19 | loss: 0.0103399
	speed: 0.0678s/iter; left time: 354.6446s
Epoch: 19 cost time: 39.27872610092163
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0024093
	speed: 0.3875s/iter; left time: 1960.5112s
	iters: 200, epoch: 20 | loss: 0.0173398
	speed: 0.0909s/iter; left time: 450.8005s
	iters: 300, epoch: 20 | loss: 0.0003625
	speed: 0.0904s/iter; left time: 439.1848s
	iters: 400, epoch: 20 | loss: 0.0032047
	speed: 0.0967s/iter; left time: 460.4588s
Epoch: 20 cost time: 44.60460567474365
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0021776
	speed: 0.4042s/iter; left time: 1855.4975s
	iters: 200, epoch: 21 | loss: 0.0137905
	speed: 0.1056s/iter; left time: 474.1477s
	iters: 300, epoch: 21 | loss: 0.0009114
	speed: 0.1065s/iter; left time: 467.5924s
	iters: 400, epoch: 21 | loss: 0.2013542
	speed: 0.0952s/iter; left time: 408.3350s
Epoch: 21 cost time: 45.44616222381592
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0001350
	speed: 0.3321s/iter; left time: 1368.9546s
	iters: 200, epoch: 22 | loss: 0.0049006
	speed: 0.0975s/iter; left time: 392.1879s
	iters: 300, epoch: 22 | loss: 0.0010388
	speed: 0.0913s/iter; left time: 358.0910s
	iters: 400, epoch: 22 | loss: 0.0013976
	speed: 0.0874s/iter; left time: 334.0276s
Epoch: 22 cost time: 43.678269386291504
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0013951
	speed: 0.3773s/iter; left time: 1378.2471s
	iters: 200, epoch: 23 | loss: 0.0114642
	speed: 0.0658s/iter; left time: 233.9119s
	iters: 300, epoch: 23 | loss: 0.0024232
	speed: 0.0856s/iter; left time: 295.5615s
	iters: 400, epoch: 23 | loss: 0.1182119
	speed: 0.1162s/iter; left time: 389.6758s
Epoch: 23 cost time: 43.419575929641724
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0004917
	speed: 0.4513s/iter; left time: 1437.0173s
	iters: 200, epoch: 24 | loss: 0.0006549
	speed: 0.1090s/iter; left time: 336.1956s
	iters: 300, epoch: 24 | loss: 0.0001648
	speed: 0.1182s/iter; left time: 352.6753s
	iters: 400, epoch: 24 | loss: 0.0006073
	speed: 0.1039s/iter; left time: 299.6062s
Epoch: 24 cost time: 51.47338604927063
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (-0.986563 --> -0.987707).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0011110
	speed: 0.4228s/iter; left time: 1147.9156s
	iters: 200, epoch: 25 | loss: 0.0002132
	speed: 0.1000s/iter; left time: 261.5349s
	iters: 300, epoch: 25 | loss: 0.0000991
	speed: 0.1045s/iter; left time: 262.7789s
	iters: 400, epoch: 25 | loss: 0.0006212
	speed: 0.0981s/iter; left time: 236.9410s
Epoch: 25 cost time: 48.99401235580444
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0048124
	speed: 0.4257s/iter; left time: 956.0608s
	iters: 200, epoch: 26 | loss: 0.0006217
	speed: 0.1034s/iter; left time: 221.8546s
	iters: 300, epoch: 26 | loss: 0.0005720
	speed: 0.1055s/iter; left time: 215.9460s
	iters: 400, epoch: 26 | loss: 0.0004813
	speed: 0.1061s/iter; left time: 206.3954s
Epoch: 26 cost time: 49.00969219207764
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1104257
	speed: 0.4188s/iter; left time: 744.1982s
	iters: 200, epoch: 27 | loss: 0.0007058
	speed: 0.1102s/iter; left time: 184.8206s
	iters: 300, epoch: 27 | loss: 0.0001373
	speed: 0.0986s/iter; left time: 155.5649s
	iters: 400, epoch: 27 | loss: 0.0060005
	speed: 0.1055s/iter; left time: 155.8396s
Epoch: 27 cost time: 48.8189377784729
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0001133
	speed: 0.4218s/iter; left time: 551.6837s
	iters: 200, epoch: 28 | loss: 0.0007917
	speed: 0.1055s/iter; left time: 127.5021s
	iters: 300, epoch: 28 | loss: 0.0000706
	speed: 0.0988s/iter; left time: 109.4231s
	iters: 400, epoch: 28 | loss: 0.0069206
	speed: 0.1095s/iter; left time: 110.4090s
Epoch: 28 cost time: 49.25313138961792
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000342
	speed: 0.3608s/iter; left time: 302.7118s
	iters: 200, epoch: 29 | loss: 0.0014002
	speed: 0.0831s/iter; left time: 61.4066s
	iters: 300, epoch: 29 | loss: 0.0005051
	speed: 0.0507s/iter; left time: 32.3808s
	iters: 400, epoch: 29 | loss: 0.0005566
	speed: 0.0792s/iter; left time: 42.7137s
Epoch: 29 cost time: 37.83124232292175
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0001077
	speed: 0.3898s/iter; left time: 144.2421s
	iters: 200, epoch: 30 | loss: 0.0002409
	speed: 0.0971s/iter; left time: 26.2128s
	iters: 300, epoch: 30 | loss: 0.0000573
	speed: 0.1006s/iter; left time: 17.1090s
	iters: 400, epoch: 30 | loss: 0.0032872
	speed: 0.0956s/iter; left time: 6.6939s
Epoch: 30 cost time: 45.82688808441162
Epoch: 30, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9877072612921669
model parameter : 1173898
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6370275
	speed: 0.0916s/iter; left time: 1279.2557s
	iters: 200, epoch: 1 | loss: 1.0861533
	speed: 0.0790s/iter; left time: 1096.3194s
	iters: 300, epoch: 1 | loss: 0.8159744
	speed: 0.0733s/iter; left time: 1008.9979s
	iters: 400, epoch: 1 | loss: 0.4593714
	speed: 0.0763s/iter; left time: 1043.2407s
Epoch: 1 cost time: 36.001140832901
Epoch: 1, Steps: 469 | Train Loss: 1.142 Vali Loss: 0.381 Vali Acc: 0.898 Test Loss: 0.381 Test Acc: 0.898
Validation loss decreased (inf --> -0.898224).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2192439
	speed: 0.3072s/iter; left time: 4147.7618s
	iters: 200, epoch: 2 | loss: 0.1753518
	speed: 0.0863s/iter; left time: 1156.8196s
	iters: 300, epoch: 2 | loss: 0.1577873
	speed: 0.0774s/iter; left time: 1030.0345s
	iters: 400, epoch: 2 | loss: 0.1532628
	speed: 0.0811s/iter; left time: 1070.5578s
Epoch: 2 cost time: 38.46636772155762
Epoch: 2, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (-0.898224 --> -0.962835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0588902
	speed: 0.3542s/iter; left time: 4615.7698s
	iters: 200, epoch: 3 | loss: 0.0111161
	speed: 0.0746s/iter; left time: 964.9302s
	iters: 300, epoch: 3 | loss: 0.0487504
	speed: 0.0808s/iter; left time: 1037.4557s
	iters: 400, epoch: 3 | loss: 0.0296000
	speed: 0.0703s/iter; left time: 894.6434s
Epoch: 3 cost time: 35.185965061187744
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.962835 --> -0.967409).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0085683
	speed: 0.3541s/iter; left time: 4448.8767s
	iters: 200, epoch: 4 | loss: 0.0238495
	speed: 0.0786s/iter; left time: 979.6686s
	iters: 300, epoch: 4 | loss: 0.0799187
	speed: 0.0628s/iter; left time: 776.5721s
	iters: 400, epoch: 4 | loss: 0.0608353
	speed: 0.0825s/iter; left time: 1011.5796s
Epoch: 4 cost time: 35.33117175102234
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.968552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0161966
	speed: 0.2750s/iter; left time: 3326.0161s
	iters: 200, epoch: 5 | loss: 0.0177737
	speed: 0.0641s/iter; left time: 768.2910s
	iters: 300, epoch: 5 | loss: 0.0055151
	speed: 0.0771s/iter; left time: 916.8099s
	iters: 400, epoch: 5 | loss: 0.0470718
	speed: 0.0591s/iter; left time: 696.6847s
Epoch: 5 cost time: 27.36969804763794
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.968552 --> -0.972555).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0111798
	speed: 0.2968s/iter; left time: 3450.2056s
	iters: 200, epoch: 6 | loss: 0.0148337
	speed: 0.0678s/iter; left time: 781.5230s
	iters: 300, epoch: 6 | loss: 0.0374667
	speed: 0.0665s/iter; left time: 759.5397s
	iters: 400, epoch: 6 | loss: 0.0148421
	speed: 0.0739s/iter; left time: 837.5081s
Epoch: 6 cost time: 33.36547493934631
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1282998
	speed: 0.3257s/iter; left time: 3634.3062s
	iters: 200, epoch: 7 | loss: 0.1931076
	speed: 0.0711s/iter; left time: 786.1306s
	iters: 300, epoch: 7 | loss: 0.4160394
	speed: 0.0710s/iter; left time: 778.0404s
	iters: 400, epoch: 7 | loss: 0.0051564
	speed: 0.0691s/iter; left time: 750.5148s
Epoch: 7 cost time: 34.13577747344971
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.974270 --> -0.977987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0041693
	speed: 0.3524s/iter; left time: 3766.8740s
	iters: 200, epoch: 8 | loss: 0.0368786
	speed: 0.0814s/iter; left time: 862.2045s
	iters: 300, epoch: 8 | loss: 0.0241521
	speed: 0.0768s/iter; left time: 805.6397s
	iters: 400, epoch: 8 | loss: 0.0018549
	speed: 0.0681s/iter; left time: 707.6884s
Epoch: 8 cost time: 36.910186767578125
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
Validation loss decreased (-0.977987 --> -0.984562).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0604421
	speed: 0.3615s/iter; left time: 3693.8037s
	iters: 200, epoch: 9 | loss: 0.0214919
	speed: 0.0823s/iter; left time: 833.0034s
	iters: 300, epoch: 9 | loss: 0.0430943
	speed: 0.0667s/iter; left time: 668.2328s
	iters: 400, epoch: 9 | loss: 0.2321680
	speed: 0.0509s/iter; left time: 505.3610s
Epoch: 9 cost time: 31.612996101379395
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0073665
	speed: 0.3301s/iter; left time: 3218.9233s
	iters: 200, epoch: 10 | loss: 0.0068356
	speed: 0.0778s/iter; left time: 750.3265s
	iters: 300, epoch: 10 | loss: 0.0805596
	speed: 0.0790s/iter; left time: 754.9019s
	iters: 400, epoch: 10 | loss: 0.0010841
	speed: 0.0750s/iter; left time: 709.0074s
Epoch: 10 cost time: 35.50512766838074
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0079221
	speed: 0.3518s/iter; left time: 3264.7641s
	iters: 200, epoch: 11 | loss: 0.0007877
	speed: 0.0719s/iter; left time: 659.7389s
	iters: 300, epoch: 11 | loss: 0.1095553
	speed: 0.0787s/iter; left time: 714.3638s
	iters: 400, epoch: 11 | loss: 0.0049962
	speed: 0.0804s/iter; left time: 722.4840s
Epoch: 11 cost time: 36.118446826934814
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0026198
	speed: 0.3507s/iter; left time: 3090.0275s
	iters: 200, epoch: 12 | loss: 0.0122117
	speed: 0.0791s/iter; left time: 689.1754s
	iters: 300, epoch: 12 | loss: 0.0022898
	speed: 0.0734s/iter; left time: 632.4194s
	iters: 400, epoch: 12 | loss: 0.0115756
	speed: 0.0702s/iter; left time: 597.9137s
Epoch: 12 cost time: 33.9381263256073
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0042535
	speed: 0.2651s/iter; left time: 2211.7813s
	iters: 200, epoch: 13 | loss: 0.0012297
	speed: 0.0601s/iter; left time: 495.1235s
	iters: 300, epoch: 13 | loss: 0.0043052
	speed: 0.0642s/iter; left time: 523.0623s
	iters: 400, epoch: 13 | loss: 0.0103913
	speed: 0.0682s/iter; left time: 548.8915s
Epoch: 13 cost time: 30.822694540023804
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0158456
	speed: 0.3006s/iter; left time: 2367.2963s
	iters: 200, epoch: 14 | loss: 0.0006000
	speed: 0.0598s/iter; left time: 465.2179s
	iters: 300, epoch: 14 | loss: 0.0033248
	speed: 0.0448s/iter; left time: 343.6761s
	iters: 400, epoch: 14 | loss: 0.0009621
	speed: 0.0464s/iter; left time: 351.4663s
Epoch: 14 cost time: 27.716713190078735
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0023261
	speed: 0.3577s/iter; left time: 2648.5243s
	iters: 200, epoch: 15 | loss: 0.0001824
	speed: 0.0775s/iter; left time: 566.2550s
	iters: 300, epoch: 15 | loss: 0.0010163
	speed: 0.0785s/iter; left time: 565.6652s
	iters: 400, epoch: 15 | loss: 0.0041944
	speed: 0.0681s/iter; left time: 483.7550s
Epoch: 15 cost time: 36.20662236213684
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0048573
	speed: 0.2590s/iter; left time: 1796.5709s
	iters: 200, epoch: 16 | loss: 0.0010921
	speed: 0.0645s/iter; left time: 441.2569s
	iters: 300, epoch: 16 | loss: 0.5200934
	speed: 0.0765s/iter; left time: 514.9773s
	iters: 400, epoch: 16 | loss: 0.0067152
	speed: 0.0617s/iter; left time: 409.1973s
Epoch: 16 cost time: 32.87810039520264
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0006362
	speed: 0.3314s/iter; left time: 2143.4711s
	iters: 200, epoch: 17 | loss: 0.0011290
	speed: 0.0674s/iter; left time: 429.2385s
	iters: 300, epoch: 17 | loss: 0.0005639
	speed: 0.0520s/iter; left time: 325.8308s
	iters: 400, epoch: 17 | loss: 0.0018810
	speed: 0.0487s/iter; left time: 300.1445s
Epoch: 17 cost time: 27.303645372390747
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0039346
	speed: 0.2981s/iter; left time: 1787.9526s
	iters: 200, epoch: 18 | loss: 0.0369966
	speed: 0.0659s/iter; left time: 388.5297s
	iters: 300, epoch: 18 | loss: 0.0002445
	speed: 0.0721s/iter; left time: 418.2251s
	iters: 400, epoch: 18 | loss: 0.0019294
	speed: 0.0649s/iter; left time: 369.7299s
Epoch: 18 cost time: 32.93698453903198
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 346186
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0332828
	speed: 0.2474s/iter; left time: 3456.0369s
	iters: 200, epoch: 1 | loss: 1.1247305
	speed: 0.2271s/iter; left time: 3150.4961s
	iters: 300, epoch: 1 | loss: 0.6077732
	speed: 0.1781s/iter; left time: 2452.3072s
	iters: 400, epoch: 1 | loss: 0.4810818
	speed: 0.1284s/iter; left time: 1754.7917s
Epoch: 1 cost time: 97.22685861587524
Epoch: 1, Steps: 469 | Train Loss: 1.159 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
Validation loss decreased (inf --> -0.919951).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3107727
	speed: 0.6727s/iter; left time: 9082.6731s
	iters: 200, epoch: 2 | loss: 0.4804608
	speed: 0.2394s/iter; left time: 3208.6118s
	iters: 300, epoch: 2 | loss: 0.2361743
	speed: 0.2525s/iter; left time: 3358.6160s
	iters: 400, epoch: 2 | loss: 0.0449000
	speed: 0.2645s/iter; left time: 3492.5865s
Epoch: 2 cost time: 117.17049908638
Epoch: 2, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.919951 --> -0.962835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1358826
	speed: 0.6277s/iter; left time: 8180.3757s
	iters: 200, epoch: 3 | loss: 0.0311820
	speed: 0.2383s/iter; left time: 3081.6678s
	iters: 300, epoch: 3 | loss: 0.0193379
	speed: 0.2381s/iter; left time: 3055.4537s
	iters: 400, epoch: 3 | loss: 0.0093774
	speed: 0.2509s/iter; left time: 3194.4985s
Epoch: 3 cost time: 109.55991625785828
Epoch: 3, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.962835 --> -0.977701).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0066271
	speed: 0.6497s/iter; left time: 8162.6620s
	iters: 200, epoch: 4 | loss: 0.0120755
	speed: 0.1936s/iter; left time: 2412.7657s
	iters: 300, epoch: 4 | loss: 0.0062773
	speed: 0.2580s/iter; left time: 3190.2936s
	iters: 400, epoch: 4 | loss: 0.0120565
	speed: 0.2550s/iter; left time: 3127.0037s
Epoch: 4 cost time: 113.08847260475159
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0019019
	speed: 0.6227s/iter; left time: 7531.3377s
	iters: 200, epoch: 5 | loss: 0.0486786
	speed: 0.2273s/iter; left time: 2726.7352s
	iters: 300, epoch: 5 | loss: 0.0944983
	speed: 0.2429s/iter; left time: 2889.8414s
	iters: 400, epoch: 5 | loss: 0.0738170
	speed: 0.2222s/iter; left time: 2620.8456s
Epoch: 5 cost time: 109.52619290351868
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0587600
	speed: 0.5872s/iter; left time: 6826.5236s
	iters: 200, epoch: 6 | loss: 0.0813671
	speed: 0.2451s/iter; left time: 2824.9259s
	iters: 300, epoch: 6 | loss: 0.0095061
	speed: 0.2502s/iter; left time: 2858.2628s
	iters: 400, epoch: 6 | loss: 0.0015162
	speed: 0.2683s/iter; left time: 3038.9066s
Epoch: 6 cost time: 114.7399423122406
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0179333
	speed: 0.6969s/iter; left time: 7775.5337s
	iters: 200, epoch: 7 | loss: 0.0039879
	speed: 0.2640s/iter; left time: 2919.1384s
	iters: 300, epoch: 7 | loss: 0.0228268
	speed: 0.2550s/iter; left time: 2793.7309s
	iters: 400, epoch: 7 | loss: 0.0084493
	speed: 0.2121s/iter; left time: 2303.1031s
Epoch: 7 cost time: 116.37562608718872
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0045565
	speed: 0.6366s/iter; left time: 6803.6619s
	iters: 200, epoch: 8 | loss: 0.0030823
	speed: 0.2092s/iter; left time: 2215.3655s
	iters: 300, epoch: 8 | loss: 0.0019048
	speed: 0.2625s/iter; left time: 2752.9274s
	iters: 400, epoch: 8 | loss: 0.0018771
	speed: 0.2648s/iter; left time: 2750.5276s
Epoch: 8 cost time: 115.78071403503418
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0026834
	speed: 0.5995s/iter; left time: 6125.8394s
	iters: 200, epoch: 9 | loss: 0.0004535
	speed: 0.2512s/iter; left time: 2542.2765s
	iters: 300, epoch: 9 | loss: 0.1268831
	speed: 0.2544s/iter; left time: 2549.0617s
	iters: 400, epoch: 9 | loss: 0.0068248
	speed: 0.1778s/iter; left time: 1763.5843s
Epoch: 9 cost time: 109.19104075431824
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0134266
	speed: 0.5945s/iter; left time: 5795.9986s
	iters: 200, epoch: 10 | loss: 0.0015097
	speed: 0.1660s/iter; left time: 1601.7148s
	iters: 300, epoch: 10 | loss: 0.0038998
	speed: 0.2092s/iter; left time: 1997.9932s
	iters: 400, epoch: 10 | loss: 0.0008312
	speed: 0.2102s/iter; left time: 1986.6746s
Epoch: 10 cost time: 93.89363598823547
Epoch: 10, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.977701 --> -0.977701).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0067248
	speed: 0.5462s/iter; left time: 5069.1902s
	iters: 200, epoch: 11 | loss: 0.0009467
	speed: 0.1639s/iter; left time: 1505.1008s
	iters: 300, epoch: 11 | loss: 0.0026443
	speed: 0.1784s/iter; left time: 1620.3906s
	iters: 400, epoch: 11 | loss: 0.0027464
	speed: 0.1875s/iter; left time: 1683.5163s
Epoch: 11 cost time: 84.32434415817261
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0016054
	speed: 0.6997s/iter; left time: 6166.0075s
	iters: 200, epoch: 12 | loss: 0.0050256
	speed: 0.3061s/iter; left time: 2666.4166s
	iters: 300, epoch: 12 | loss: 0.0009849
	speed: 0.2552s/iter; left time: 2198.1837s
	iters: 400, epoch: 12 | loss: 0.0029723
	speed: 0.3290s/iter; left time: 2800.7942s
Epoch: 12 cost time: 141.5887155532837
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.979416).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0024929
	speed: 0.8391s/iter; left time: 7000.5960s
	iters: 200, epoch: 13 | loss: 0.0004640
	speed: 0.3284s/iter; left time: 2707.1590s
	iters: 300, epoch: 13 | loss: 0.0083431
	speed: 0.3209s/iter; left time: 2613.1597s
	iters: 400, epoch: 13 | loss: 0.0115975
	speed: 0.3311s/iter; left time: 2662.7042s
Epoch: 13 cost time: 152.5314269065857
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0019346
	speed: 0.8330s/iter; left time: 6559.1980s
	iters: 200, epoch: 14 | loss: 0.0010530
	speed: 0.3292s/iter; left time: 2559.4608s
	iters: 300, epoch: 14 | loss: 0.0024474
	speed: 0.3211s/iter; left time: 2464.0535s
	iters: 400, epoch: 14 | loss: 0.0004460
	speed: 0.3210s/iter; left time: 2431.1096s
Epoch: 14 cost time: 149.6425063610077
Epoch: 14, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0034946
	speed: 0.8336s/iter; left time: 6172.5635s
	iters: 200, epoch: 15 | loss: 0.0005937
	speed: 0.3206s/iter; left time: 2341.6949s
	iters: 300, epoch: 15 | loss: 0.0023609
	speed: 0.3147s/iter; left time: 2267.3635s
	iters: 400, epoch: 15 | loss: 0.0004499
	speed: 0.3241s/iter; left time: 2302.7982s
Epoch: 15 cost time: 148.96954941749573
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0018858
	speed: 0.8374s/iter; left time: 5807.9034s
	iters: 200, epoch: 16 | loss: 0.2250968
	speed: 0.3167s/iter; left time: 2165.2865s
	iters: 300, epoch: 16 | loss: 0.3175617
	speed: 0.3200s/iter; left time: 2155.6900s
	iters: 400, epoch: 16 | loss: 0.0045544
	speed: 0.3309s/iter; left time: 2195.9284s
Epoch: 16 cost time: 150.50922274589539
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0014405
	speed: 0.8527s/iter; left time: 5514.1166s
	iters: 200, epoch: 17 | loss: 0.0029944
	speed: 0.3259s/iter; left time: 2074.8898s
	iters: 300, epoch: 17 | loss: 0.0014516
	speed: 0.3242s/iter; left time: 2031.9578s
	iters: 400, epoch: 17 | loss: 0.0993996
	speed: 0.3304s/iter; left time: 2037.8796s
Epoch: 17 cost time: 152.49918508529663
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0003912
	speed: 0.8579s/iter; left time: 5145.9209s
	iters: 200, epoch: 18 | loss: 0.0001759
	speed: 0.3257s/iter; left time: 1921.0487s
	iters: 300, epoch: 18 | loss: 0.0003736
	speed: 0.3216s/iter; left time: 1864.7744s
	iters: 400, epoch: 18 | loss: 0.0013489
	speed: 0.3236s/iter; left time: 1843.8953s
Epoch: 18 cost time: 151.53790259361267
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0002544
	speed: 0.8448s/iter; left time: 4670.7336s
	iters: 200, epoch: 19 | loss: 0.0006229
	speed: 0.3185s/iter; left time: 1729.2435s
	iters: 300, epoch: 19 | loss: 0.0016456
	speed: 0.3132s/iter; left time: 1669.1683s
	iters: 400, epoch: 19 | loss: 0.0005217
	speed: 0.3223s/iter; left time: 1685.1832s
Epoch: 19 cost time: 149.3263759613037
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0009381
	speed: 0.8505s/iter; left time: 4303.4114s
	iters: 200, epoch: 20 | loss: 0.0000406
	speed: 0.2822s/iter; left time: 1399.6047s
	iters: 300, epoch: 20 | loss: 0.0003461
	speed: 0.2745s/iter; left time: 1334.1135s
	iters: 400, epoch: 20 | loss: 0.0024581
	speed: 0.3100s/iter; left time: 1475.6532s
Epoch: 20 cost time: 140.59138679504395
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0016581
	speed: 0.8324s/iter; left time: 3821.3849s
	iters: 200, epoch: 21 | loss: 0.0013022
	speed: 0.3095s/iter; left time: 1389.9339s
	iters: 300, epoch: 21 | loss: 0.0004657
	speed: 0.3087s/iter; left time: 1355.5734s
	iters: 400, epoch: 21 | loss: 0.0006740
	speed: 0.3084s/iter; left time: 1323.4840s
Epoch: 21 cost time: 144.79743361473083
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0003004
	speed: 0.7974s/iter; left time: 3286.7359s
	iters: 200, epoch: 22 | loss: 0.0001652
	speed: 0.3083s/iter; left time: 1240.0211s
	iters: 300, epoch: 22 | loss: 0.0004862
	speed: 0.3078s/iter; left time: 1207.1469s
	iters: 400, epoch: 22 | loss: 0.0001998
	speed: 0.3032s/iter; left time: 1158.9241s
Epoch: 22 cost time: 143.49092650413513
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.980274).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0019181
	speed: 0.7562s/iter; left time: 2762.5660s
	iters: 200, epoch: 23 | loss: 0.0044303
	speed: 0.3149s/iter; left time: 1118.8159s
	iters: 300, epoch: 23 | loss: 0.0003663
	speed: 0.3095s/iter; left time: 1068.7657s
	iters: 400, epoch: 23 | loss: 0.0005867
	speed: 0.3045s/iter; left time: 1021.1095s
Epoch: 23 cost time: 145.66627597808838
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0019798
	speed: 0.8226s/iter; left time: 2619.2443s
	iters: 200, epoch: 24 | loss: 0.0046380
	speed: 0.3065s/iter; left time: 945.3582s
	iters: 300, epoch: 24 | loss: 0.0046487
	speed: 0.3125s/iter; left time: 932.3784s
	iters: 400, epoch: 24 | loss: 0.0001963
	speed: 0.3123s/iter; left time: 900.7666s
Epoch: 24 cost time: 145.21213555335999
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0002978
	speed: 0.8297s/iter; left time: 2252.6182s
	iters: 200, epoch: 25 | loss: 0.0004028
	speed: 0.2007s/iter; left time: 524.8071s
	iters: 300, epoch: 25 | loss: 0.0002758
	speed: 0.3143s/iter; left time: 790.5852s
	iters: 400, epoch: 25 | loss: 0.0008187
	speed: 0.3098s/iter; left time: 748.1557s
Epoch: 25 cost time: 136.3602044582367
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0002454
	speed: 0.8184s/iter; left time: 1838.0429s
	iters: 200, epoch: 26 | loss: 0.0002090
	speed: 0.3140s/iter; left time: 673.9081s
	iters: 300, epoch: 26 | loss: 0.0005095
	speed: 0.3144s/iter; left time: 643.3494s
	iters: 400, epoch: 26 | loss: 0.0005555
	speed: 0.3098s/iter; left time: 602.9534s
Epoch: 26 cost time: 146.54822540283203
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0070244
	speed: 0.8185s/iter; left time: 1454.3889s
	iters: 200, epoch: 27 | loss: 0.0001561
	speed: 0.3057s/iter; left time: 512.7379s
	iters: 300, epoch: 27 | loss: 0.0004629
	speed: 0.3035s/iter; left time: 478.6746s
	iters: 400, epoch: 27 | loss: 0.0003276
	speed: 0.3121s/iter; left time: 460.9149s
Epoch: 27 cost time: 143.38349533081055
Epoch: 27, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0004738
	speed: 0.8165s/iter; left time: 1067.9376s
	iters: 200, epoch: 28 | loss: 0.0434520
	speed: 0.2253s/iter; left time: 272.2214s
	iters: 300, epoch: 28 | loss: 0.0019056
	speed: 0.2664s/iter; left time: 295.1857s
	iters: 400, epoch: 28 | loss: 0.0129738
	speed: 0.2856s/iter; left time: 287.8673s
Epoch: 28 cost time: 128.4200897216797
Epoch: 28, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0007994
	speed: 0.7504s/iter; left time: 629.6231s
	iters: 200, epoch: 29 | loss: 0.0007263
	speed: 0.2770s/iter; left time: 204.6821s
	iters: 300, epoch: 29 | loss: 0.0008240
	speed: 0.2902s/iter; left time: 185.4457s
	iters: 400, epoch: 29 | loss: 0.0023817
	speed: 0.2907s/iter; left time: 156.6767s
Epoch: 29 cost time: 135.09103918075562
Epoch: 29, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0032210
	speed: 0.7158s/iter; left time: 264.8602s
	iters: 200, epoch: 30 | loss: 0.0002325
	speed: 0.0535s/iter; left time: 14.4407s
	iters: 300, epoch: 30 | loss: 0.0002610
	speed: 0.1489s/iter; left time: 25.3055s
	iters: 400, epoch: 30 | loss: 0.0094612
	speed: 0.3150s/iter; left time: 22.0530s
Epoch: 30 cost time: 97.33143091201782
Epoch: 30, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
Validation loss decreased (-0.980274 --> -0.984848).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 587786
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0141494
	speed: 0.1997s/iter; left time: 2789.9509s
	iters: 200, epoch: 1 | loss: 1.3362619
	speed: 0.1741s/iter; left time: 2414.6036s
	iters: 300, epoch: 1 | loss: 0.5102652
	speed: 0.1863s/iter; left time: 2564.9355s
	iters: 400, epoch: 1 | loss: 0.3442181
	speed: 0.1816s/iter; left time: 2482.1507s
Epoch: 1 cost time: 86.47049927711487
Epoch: 1, Steps: 469 | Train Loss: 1.173 Vali Loss: 0.349 Vali Acc: 0.907 Test Loss: 0.349 Test Acc: 0.907
Validation loss decreased (inf --> -0.907372).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2000303
	speed: 0.5693s/iter; left time: 7686.3345s
	iters: 200, epoch: 2 | loss: 0.4025373
	speed: 0.1820s/iter; left time: 2439.2519s
	iters: 300, epoch: 2 | loss: 0.0958011
	speed: 0.1803s/iter; left time: 2398.0391s
	iters: 400, epoch: 2 | loss: 0.1211875
	speed: 0.1752s/iter; left time: 2312.9338s
Epoch: 2 cost time: 83.07660722732544
Epoch: 2, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.907372 --> -0.956831).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1198370
	speed: 0.5555s/iter; left time: 7239.5578s
	iters: 200, epoch: 3 | loss: 0.0234800
	speed: 0.1850s/iter; left time: 2392.8255s
	iters: 300, epoch: 3 | loss: 0.0557081
	speed: 0.1776s/iter; left time: 2279.5420s
	iters: 400, epoch: 3 | loss: 0.0324589
	speed: 0.1845s/iter; left time: 2348.6253s
Epoch: 3 cost time: 85.89069056510925
Epoch: 3, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.956831 --> -0.976843).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0404757
	speed: 0.5663s/iter; left time: 7114.7754s
	iters: 200, epoch: 4 | loss: 0.1553785
	speed: 0.1783s/iter; left time: 2222.5487s
	iters: 300, epoch: 4 | loss: 0.0975610
	speed: 0.1846s/iter; left time: 2282.7401s
	iters: 400, epoch: 4 | loss: 0.1591259
	speed: 0.1864s/iter; left time: 2286.1898s
Epoch: 4 cost time: 85.83962416648865
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.980560).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0088941
	speed: 0.5707s/iter; left time: 6902.9905s
	iters: 200, epoch: 5 | loss: 0.0208657
	speed: 0.1846s/iter; left time: 2214.7151s
	iters: 300, epoch: 5 | loss: 0.0305137
	speed: 0.1847s/iter; left time: 2197.5494s
	iters: 400, epoch: 5 | loss: 0.0246351
	speed: 0.1810s/iter; left time: 2135.4308s
Epoch: 5 cost time: 85.97604298591614
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0379147
	speed: 0.5798s/iter; left time: 6741.2764s
	iters: 200, epoch: 6 | loss: 0.0085230
	speed: 0.1878s/iter; left time: 2164.7474s
	iters: 300, epoch: 6 | loss: 0.0028574
	speed: 0.1794s/iter; left time: 2049.5913s
	iters: 400, epoch: 6 | loss: 0.0167091
	speed: 0.1857s/iter; left time: 2102.9229s
Epoch: 6 cost time: 86.58048892021179
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0225877
	speed: 0.5277s/iter; left time: 5888.0685s
	iters: 200, epoch: 7 | loss: 0.0082196
	speed: 0.1674s/iter; left time: 1851.0658s
	iters: 300, epoch: 7 | loss: 0.0035269
	speed: 0.1749s/iter; left time: 1916.7109s
	iters: 400, epoch: 7 | loss: 0.0378528
	speed: 0.1712s/iter; left time: 1859.0859s
Epoch: 7 cost time: 78.37946224212646
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0924775
	speed: 0.5417s/iter; left time: 5789.8296s
	iters: 200, epoch: 8 | loss: 0.0021753
	speed: 0.1702s/iter; left time: 1802.3893s
	iters: 300, epoch: 8 | loss: 0.0020825
	speed: 0.1741s/iter; left time: 1825.8261s
	iters: 400, epoch: 8 | loss: 0.0031899
	speed: 0.1743s/iter; left time: 1810.1476s
Epoch: 8 cost time: 80.46662783622742
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0043774
	speed: 0.5414s/iter; left time: 5532.7232s
	iters: 200, epoch: 9 | loss: 0.0024777
	speed: 0.1701s/iter; left time: 1720.9384s
	iters: 300, epoch: 9 | loss: 0.0055092
	speed: 0.1696s/iter; left time: 1698.8470s
	iters: 400, epoch: 9 | loss: 0.0027422
	speed: 0.1684s/iter; left time: 1669.9773s
Epoch: 9 cost time: 80.55199599266052
Epoch: 9, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.980560 --> -0.983418).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0013630
	speed: 0.5499s/iter; left time: 5361.9292s
	iters: 200, epoch: 10 | loss: 0.0017941
	speed: 0.1709s/iter; left time: 1648.8466s
	iters: 300, epoch: 10 | loss: 0.0013747
	speed: 0.1719s/iter; left time: 1641.3454s
	iters: 400, epoch: 10 | loss: 0.0065593
	speed: 0.1727s/iter; left time: 1631.8182s
Epoch: 10 cost time: 80.87913131713867
Epoch: 10, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983704).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0976745
	speed: 0.4882s/iter; left time: 4531.1180s
	iters: 200, epoch: 11 | loss: 0.0489745
	speed: 0.1861s/iter; left time: 1708.9861s
	iters: 300, epoch: 11 | loss: 0.0217157
	speed: 0.1784s/iter; left time: 1619.6753s
	iters: 400, epoch: 11 | loss: 0.0153317
	speed: 0.1873s/iter; left time: 1681.9106s
Epoch: 11 cost time: 80.83819317817688
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0381651
	speed: 0.5609s/iter; left time: 4942.6548s
	iters: 200, epoch: 12 | loss: 0.0104663
	speed: 0.1877s/iter; left time: 1634.8486s
	iters: 300, epoch: 12 | loss: 0.0613890
	speed: 0.1796s/iter; left time: 1547.0197s
	iters: 400, epoch: 12 | loss: 0.0004312
	speed: 0.1851s/iter; left time: 1575.6393s
Epoch: 12 cost time: 85.60145401954651
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0016956
	speed: 0.5684s/iter; left time: 4742.1406s
	iters: 200, epoch: 13 | loss: 0.0016381
	speed: 0.1813s/iter; left time: 1494.5659s
	iters: 300, epoch: 13 | loss: 0.0026365
	speed: 0.1802s/iter; left time: 1467.2027s
	iters: 400, epoch: 13 | loss: 0.0012386
	speed: 0.1812s/iter; left time: 1457.6097s
Epoch: 13 cost time: 85.22450017929077
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0014819
	speed: 0.5710s/iter; left time: 4496.0008s
	iters: 200, epoch: 14 | loss: 0.0051164
	speed: 0.1835s/iter; left time: 1426.2743s
	iters: 300, epoch: 14 | loss: 0.0021650
	speed: 0.1825s/iter; left time: 1400.4232s
	iters: 400, epoch: 14 | loss: 0.0103633
	speed: 0.1781s/iter; left time: 1349.1969s
Epoch: 14 cost time: 85.40328407287598
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0014953
	speed: 0.5652s/iter; left time: 4185.4096s
	iters: 200, epoch: 15 | loss: 0.0106622
	speed: 0.1774s/iter; left time: 1295.7182s
	iters: 300, epoch: 15 | loss: 0.0017870
	speed: 0.1836s/iter; left time: 1322.7655s
	iters: 400, epoch: 15 | loss: 0.0002117
	speed: 0.1777s/iter; left time: 1262.7582s
Epoch: 15 cost time: 85.07898783683777
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1873466
	speed: 0.5582s/iter; left time: 3871.3830s
	iters: 200, epoch: 16 | loss: 0.0007851
	speed: 0.1671s/iter; left time: 1142.1092s
	iters: 300, epoch: 16 | loss: 0.0007508
	speed: 0.1294s/iter; left time: 871.5655s
	iters: 400, epoch: 16 | loss: 0.0019170
	speed: 0.0676s/iter; left time: 448.6772s
Epoch: 16 cost time: 60.7503457069397
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0032567
	speed: 0.4714s/iter; left time: 3048.6497s
	iters: 200, epoch: 17 | loss: 0.0009661
	speed: 0.1621s/iter; left time: 1031.9395s
	iters: 300, epoch: 17 | loss: 0.0004104
	speed: 0.1679s/iter; left time: 1052.2777s
	iters: 400, epoch: 17 | loss: 0.0021023
	speed: 0.1661s/iter; left time: 1024.3884s
Epoch: 17 cost time: 77.70996141433716
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0005105
	speed: 0.5294s/iter; left time: 3175.3570s
	iters: 200, epoch: 18 | loss: 0.0004003
	speed: 0.1638s/iter; left time: 966.1561s
	iters: 300, epoch: 18 | loss: 0.0006925
	speed: 0.1710s/iter; left time: 991.4585s
	iters: 400, epoch: 18 | loss: 0.0085713
	speed: 0.1410s/iter; left time: 803.1997s
Epoch: 18 cost time: 74.84987783432007
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1862775
	speed: 0.5270s/iter; left time: 2914.0536s
	iters: 200, epoch: 19 | loss: 0.0014815
	speed: 0.1741s/iter; left time: 945.2315s
	iters: 300, epoch: 19 | loss: 0.0005782
	speed: 0.1736s/iter; left time: 925.2312s
	iters: 400, epoch: 19 | loss: 0.0012541
	speed: 0.1749s/iter; left time: 914.7028s
Epoch: 19 cost time: 82.64489030838013
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.983704 --> -0.985991).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0007635
	speed: 0.5521s/iter; left time: 2793.6601s
	iters: 200, epoch: 20 | loss: 0.0005122
	speed: 0.1729s/iter; left time: 857.7054s
	iters: 300, epoch: 20 | loss: 0.0008900
	speed: 0.1643s/iter; left time: 798.7116s
	iters: 400, epoch: 20 | loss: 0.0272717
	speed: 0.1778s/iter; left time: 846.3986s
Epoch: 20 cost time: 81.42212295532227
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0006955
	speed: 0.5508s/iter; left time: 2528.8906s
	iters: 200, epoch: 21 | loss: 0.0003366
	speed: 0.1748s/iter; left time: 785.1596s
	iters: 300, epoch: 21 | loss: 0.0013594
	speed: 0.1692s/iter; left time: 742.8053s
	iters: 400, epoch: 21 | loss: 0.0051206
	speed: 0.1745s/iter; left time: 748.6014s
Epoch: 21 cost time: 82.04430818557739
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0041645
	speed: 0.5391s/iter; left time: 2222.1854s
	iters: 200, epoch: 22 | loss: 0.0176079
	speed: 0.1437s/iter; left time: 578.0431s
	iters: 300, epoch: 22 | loss: 0.0002303
	speed: 0.1327s/iter; left time: 520.4110s
	iters: 400, epoch: 22 | loss: 0.0014625
	speed: 0.1546s/iter; left time: 591.0300s
Epoch: 22 cost time: 67.81233596801758
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0004089
	speed: 0.4005s/iter; left time: 1462.8724s
	iters: 200, epoch: 23 | loss: 0.0004261
	speed: 0.1617s/iter; left time: 574.3577s
	iters: 300, epoch: 23 | loss: 0.0005609
	speed: 0.1616s/iter; left time: 557.9460s
	iters: 400, epoch: 23 | loss: 0.0006571
	speed: 0.1508s/iter; left time: 505.4892s
Epoch: 23 cost time: 74.61095666885376
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0027359
	speed: 0.4764s/iter; left time: 1516.7509s
	iters: 200, epoch: 24 | loss: 0.0008190
	speed: 0.1715s/iter; left time: 528.9901s
	iters: 300, epoch: 24 | loss: 0.1197493
	speed: 0.1763s/iter; left time: 526.0536s
	iters: 400, epoch: 24 | loss: 0.0007153
	speed: 0.1582s/iter; left time: 456.1513s
Epoch: 24 cost time: 80.05567169189453
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0003888
	speed: 0.5637s/iter; left time: 1530.5220s
	iters: 200, epoch: 25 | loss: 0.2472398
	speed: 0.1724s/iter; left time: 450.7393s
	iters: 300, epoch: 25 | loss: 0.0075874
	speed: 0.1773s/iter; left time: 445.9082s
	iters: 400, epoch: 25 | loss: 0.0001922
	speed: 0.1780s/iter; left time: 429.9555s
Epoch: 25 cost time: 83.7588210105896
Epoch: 25, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0038202
	speed: 0.5588s/iter; left time: 1254.9565s
	iters: 200, epoch: 26 | loss: 0.0118902
	speed: 0.1781s/iter; left time: 382.1218s
	iters: 300, epoch: 26 | loss: 0.0000554
	speed: 0.1767s/iter; left time: 361.4934s
	iters: 400, epoch: 26 | loss: 0.0022671
	speed: 0.1830s/iter; left time: 356.1939s
Epoch: 26 cost time: 83.4810676574707
Epoch: 26, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0002577
	speed: 0.5539s/iter; left time: 984.2974s
	iters: 200, epoch: 27 | loss: 0.0082419
	speed: 0.1800s/iter; left time: 301.8345s
	iters: 300, epoch: 27 | loss: 0.0010613
	speed: 0.1723s/iter; left time: 271.6840s
	iters: 400, epoch: 27 | loss: 0.0005964
	speed: 0.1282s/iter; left time: 189.4020s
Epoch: 27 cost time: 77.22868061065674
Epoch: 27, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0011634
	speed: 0.5227s/iter; left time: 683.6332s
	iters: 200, epoch: 28 | loss: 0.0008049
	speed: 0.1680s/iter; left time: 202.9833s
	iters: 300, epoch: 28 | loss: 0.0006936
	speed: 0.1672s/iter; left time: 185.2451s
	iters: 400, epoch: 28 | loss: 0.0131651
	speed: 0.1651s/iter; left time: 166.4640s
Epoch: 28 cost time: 78.41273641586304
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0069652
	speed: 0.5209s/iter; left time: 437.0175s
	iters: 200, epoch: 29 | loss: 0.0002214
	speed: 0.1669s/iter; left time: 123.3443s
	iters: 300, epoch: 29 | loss: 0.0003617
	speed: 0.1649s/iter; left time: 105.3939s
	iters: 400, epoch: 29 | loss: 0.0018280
	speed: 0.1613s/iter; left time: 86.9635s
Epoch: 29 cost time: 77.80921840667725
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9859919954259577
model parameter : 173898
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0403395
	speed: 0.2139s/iter; left time: 2988.1933s
	iters: 200, epoch: 1 | loss: 1.1135641
	speed: 0.1995s/iter; left time: 2767.5214s
	iters: 300, epoch: 1 | loss: 0.6575921
	speed: 0.2015s/iter; left time: 2774.2067s
	iters: 400, epoch: 1 | loss: 0.4399152
	speed: 0.1545s/iter; left time: 2112.7925s
Epoch: 1 cost time: 91.66156840324402
Epoch: 1, Steps: 469 | Train Loss: 1.174 Vali Loss: 0.338 Vali Acc: 0.903 Test Loss: 0.338 Test Acc: 0.903
Validation loss decreased (inf --> -0.902798).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3029873
	speed: 0.6127s/iter; left time: 8273.0271s
	iters: 200, epoch: 2 | loss: 0.4474005
	speed: 0.2140s/iter; left time: 2867.9314s
	iters: 300, epoch: 2 | loss: 0.1975624
	speed: 0.2160s/iter; left time: 2873.2312s
	iters: 400, epoch: 2 | loss: 0.0764069
	speed: 0.2121s/iter; left time: 2800.0925s
Epoch: 2 cost time: 100.66430902481079
Epoch: 2, Steps: 469 | Train Loss: 0.174 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.902798 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0946942
	speed: 0.6189s/iter; left time: 8066.3622s
	iters: 200, epoch: 3 | loss: 0.0271421
	speed: 0.2064s/iter; left time: 2669.9465s
	iters: 300, epoch: 3 | loss: 0.0155939
	speed: 0.2021s/iter; left time: 2593.4402s
	iters: 400, epoch: 3 | loss: 0.0114352
	speed: 0.1667s/iter; left time: 2122.5014s
Epoch: 3 cost time: 87.79899668693542
Epoch: 3, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.964264 --> -0.977415).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0059264
	speed: 0.4816s/iter; left time: 6051.3940s
	iters: 200, epoch: 4 | loss: 0.0177542
	speed: 0.1926s/iter; left time: 2400.7525s
	iters: 300, epoch: 4 | loss: 0.0043785
	speed: 0.1931s/iter; left time: 2387.1757s
	iters: 400, epoch: 4 | loss: 0.0149519
	speed: 0.1915s/iter; left time: 2348.3031s
Epoch: 4 cost time: 86.68695998191833
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0362474
	speed: 0.5617s/iter; left time: 6793.9631s
	iters: 200, epoch: 5 | loss: 0.0251010
	speed: 0.1897s/iter; left time: 2275.9005s
	iters: 300, epoch: 5 | loss: 0.0185938
	speed: 0.1897s/iter; left time: 2256.7827s
	iters: 400, epoch: 5 | loss: 0.1340076
	speed: 0.1848s/iter; left time: 2180.1789s
Epoch: 5 cost time: 87.87647008895874
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0246812
	speed: 0.5343s/iter; left time: 6211.5697s
	iters: 200, epoch: 6 | loss: 0.0375597
	speed: 0.1932s/iter; left time: 2226.3969s
	iters: 300, epoch: 6 | loss: 0.0148743
	speed: 0.1381s/iter; left time: 1577.8558s
	iters: 400, epoch: 6 | loss: 0.0020336
	speed: 0.1893s/iter; left time: 2144.2014s
Epoch: 6 cost time: 83.79050016403198
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.977701).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0182226
	speed: 0.5258s/iter; left time: 5866.4582s
	iters: 200, epoch: 7 | loss: 0.0032511
	speed: 0.0924s/iter; left time: 1021.8244s
	iters: 300, epoch: 7 | loss: 0.0055221
	speed: 0.2031s/iter; left time: 2224.9308s
	iters: 400, epoch: 7 | loss: 0.0057907
	speed: 0.2042s/iter; left time: 2216.8414s
Epoch: 7 cost time: 80.02570462226868
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0052420
	speed: 0.5843s/iter; left time: 6244.9430s
	iters: 200, epoch: 8 | loss: 0.0021187
	speed: 0.1571s/iter; left time: 1663.1559s
	iters: 300, epoch: 8 | loss: 0.0028617
	speed: 0.1907s/iter; left time: 2000.0536s
	iters: 400, epoch: 8 | loss: 0.0035056
	speed: 0.1884s/iter; left time: 1957.0728s
Epoch: 8 cost time: 86.96043729782104
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0021249
	speed: 0.5398s/iter; left time: 5515.7958s
	iters: 200, epoch: 9 | loss: 0.0061435
	speed: 0.1908s/iter; left time: 1930.8874s
	iters: 300, epoch: 9 | loss: 0.0342522
	speed: 0.1913s/iter; left time: 1916.7213s
	iters: 400, epoch: 9 | loss: 0.0026123
	speed: 0.1825s/iter; left time: 1809.7694s
Epoch: 9 cost time: 88.76602721214294
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0013542
	speed: 0.5173s/iter; left time: 5043.7218s
	iters: 200, epoch: 10 | loss: 0.0037545
	speed: 0.2232s/iter; left time: 2154.1956s
	iters: 300, epoch: 10 | loss: 0.0186712
	speed: 0.2140s/iter; left time: 2043.8731s
	iters: 400, epoch: 10 | loss: 0.0010667
	speed: 0.2165s/iter; left time: 2045.8812s
Epoch: 10 cost time: 96.55829906463623
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.977701 --> -0.983418).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0017194
	speed: 0.6286s/iter; left time: 5833.8248s
	iters: 200, epoch: 11 | loss: 0.0009557
	speed: 0.2126s/iter; left time: 1952.1931s
	iters: 300, epoch: 11 | loss: 0.0010336
	speed: 0.2185s/iter; left time: 1984.4579s
	iters: 400, epoch: 11 | loss: 0.0015164
	speed: 0.2129s/iter; left time: 1911.6420s
Epoch: 11 cost time: 102.05935287475586
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0009019
	speed: 0.6301s/iter; left time: 5552.7791s
	iters: 200, epoch: 12 | loss: 0.0047832
	speed: 0.2127s/iter; left time: 1852.8999s
	iters: 300, epoch: 12 | loss: 0.0046271
	speed: 0.2196s/iter; left time: 1890.9311s
	iters: 400, epoch: 12 | loss: 0.0010628
	speed: 0.2203s/iter; left time: 1874.8317s
Epoch: 12 cost time: 102.62967896461487
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0002762
	speed: 0.6215s/iter; left time: 5184.8555s
	iters: 200, epoch: 13 | loss: 0.0005691
	speed: 0.2225s/iter; left time: 1834.3433s
	iters: 300, epoch: 13 | loss: 0.0099048
	speed: 0.2151s/iter; left time: 1751.4858s
	iters: 400, epoch: 13 | loss: 0.0363709
	speed: 0.2258s/iter; left time: 1815.7163s
Epoch: 13 cost time: 102.53367447853088
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0009371
	speed: 0.6245s/iter; left time: 4917.4442s
	iters: 200, epoch: 14 | loss: 0.0011763
	speed: 0.2240s/iter; left time: 1741.4351s
	iters: 300, epoch: 14 | loss: 0.0006987
	speed: 0.2205s/iter; left time: 1691.8637s
	iters: 400, epoch: 14 | loss: 0.0002207
	speed: 0.2183s/iter; left time: 1653.3105s
Epoch: 14 cost time: 103.03678703308105
Epoch: 14, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0090918
	speed: 0.6374s/iter; left time: 4719.9868s
	iters: 200, epoch: 15 | loss: 0.0004681
	speed: 0.2188s/iter; left time: 1598.6770s
	iters: 300, epoch: 15 | loss: 0.0013495
	speed: 0.1731s/iter; left time: 1247.0185s
	iters: 400, epoch: 15 | loss: 0.0036424
	speed: 0.1821s/iter; left time: 1293.8583s
Epoch: 15 cost time: 94.38742971420288
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0015680
	speed: 0.5986s/iter; left time: 4152.1821s
	iters: 200, epoch: 16 | loss: 0.1830832
	speed: 0.2052s/iter; left time: 1402.5128s
	iters: 300, epoch: 16 | loss: 0.1905298
	speed: 0.2010s/iter; left time: 1354.1975s
	iters: 400, epoch: 16 | loss: 0.0108176
	speed: 0.2008s/iter; left time: 1332.5301s
Epoch: 16 cost time: 90.19203472137451
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0008779
	speed: 0.4796s/iter; left time: 3101.2658s
	iters: 200, epoch: 17 | loss: 0.0065637
	speed: 0.1988s/iter; left time: 1265.8468s
	iters: 300, epoch: 17 | loss: 0.0004617
	speed: 0.1992s/iter; left time: 1248.0745s
	iters: 400, epoch: 17 | loss: 0.1201880
	speed: 0.1943s/iter; left time: 1198.1916s
Epoch: 17 cost time: 93.13620829582214
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0073149
	speed: 0.5811s/iter; left time: 3485.2507s
	iters: 200, epoch: 18 | loss: 0.0000983
	speed: 0.1950s/iter; left time: 1149.8709s
	iters: 300, epoch: 18 | loss: 0.0067072
	speed: 0.2017s/iter; left time: 1169.5771s
	iters: 400, epoch: 18 | loss: 0.0006233
	speed: 0.1938s/iter; left time: 1104.1652s
Epoch: 18 cost time: 89.51415038108826
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983418 --> -0.984562).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0003482
	speed: 0.5593s/iter; left time: 3092.4559s
	iters: 200, epoch: 19 | loss: 0.0005530
	speed: 0.2043s/iter; left time: 1109.3885s
	iters: 300, epoch: 19 | loss: 0.0025596
	speed: 0.2184s/iter; left time: 1163.9755s
	iters: 400, epoch: 19 | loss: 0.0001495
	speed: 0.2098s/iter; left time: 1096.9587s
Epoch: 19 cost time: 99.74798536300659
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0032524
	speed: 0.6223s/iter; left time: 3148.5975s
	iters: 200, epoch: 20 | loss: 0.0000967
	speed: 0.2068s/iter; left time: 1025.7860s
	iters: 300, epoch: 20 | loss: 0.0936837
	speed: 0.2134s/iter; left time: 1037.1385s
	iters: 400, epoch: 20 | loss: 0.0006130
	speed: 0.2134s/iter; left time: 1015.9009s
Epoch: 20 cost time: 99.99633479118347
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0021936
	speed: 0.6039s/iter; left time: 2772.7331s
	iters: 200, epoch: 21 | loss: 0.0011526
	speed: 0.2083s/iter; left time: 935.6593s
	iters: 300, epoch: 21 | loss: 0.0009566
	speed: 0.2133s/iter; left time: 936.7116s
	iters: 400, epoch: 21 | loss: 0.0002221
	speed: 0.2125s/iter; left time: 911.9966s
Epoch: 21 cost time: 98.40578627586365
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001663
	speed: 0.6129s/iter; left time: 2526.3278s
	iters: 200, epoch: 22 | loss: 0.0005531
	speed: 0.2087s/iter; left time: 839.5643s
	iters: 300, epoch: 22 | loss: 0.0002549
	speed: 0.2059s/iter; left time: 807.3576s
	iters: 400, epoch: 22 | loss: 0.0432227
	speed: 0.2133s/iter; left time: 815.0688s
Epoch: 22 cost time: 97.28678131103516
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002424
	speed: 0.5376s/iter; left time: 1963.9744s
	iters: 200, epoch: 23 | loss: 0.0003457
	speed: 0.1782s/iter; left time: 633.0775s
	iters: 300, epoch: 23 | loss: 0.0000690
	speed: 0.1847s/iter; left time: 637.7934s
	iters: 400, epoch: 23 | loss: 0.0002147
	speed: 0.1991s/iter; left time: 667.7268s
Epoch: 23 cost time: 84.765873670578
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0003515
	speed: 0.4550s/iter; left time: 1448.5784s
	iters: 200, epoch: 24 | loss: 0.0117056
	speed: 0.2014s/iter; left time: 621.1719s
	iters: 300, epoch: 24 | loss: 0.3606108
	speed: 0.1967s/iter; left time: 587.0060s
	iters: 400, epoch: 24 | loss: 0.0001963
	speed: 0.1940s/iter; left time: 559.6231s
Epoch: 24 cost time: 85.7311692237854
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.984562 --> -0.984848).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0003784
	speed: 0.5337s/iter; left time: 1449.1171s
	iters: 200, epoch: 25 | loss: 0.0014531
	speed: 0.2035s/iter; left time: 532.1823s
	iters: 300, epoch: 25 | loss: 0.0006508
	speed: 0.2017s/iter; left time: 507.2046s
	iters: 400, epoch: 25 | loss: 0.0228851
	speed: 0.2115s/iter; left time: 510.8731s
Epoch: 25 cost time: 97.12574362754822
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
Validation loss decreased (-0.984848 --> -0.985991).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0002555
	speed: 0.5661s/iter; left time: 1271.4573s
	iters: 200, epoch: 26 | loss: 0.0002595
	speed: 0.1946s/iter; left time: 417.6342s
	iters: 300, epoch: 26 | loss: 0.0174716
	speed: 0.2062s/iter; left time: 421.8251s
	iters: 400, epoch: 26 | loss: 0.0003884
	speed: 0.2031s/iter; left time: 395.2238s
Epoch: 26 cost time: 92.06152248382568
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0029187
	speed: 0.6020s/iter; left time: 1069.7073s
	iters: 200, epoch: 27 | loss: 0.0002264
	speed: 0.1937s/iter; left time: 324.8980s
	iters: 300, epoch: 27 | loss: 0.0007848
	speed: 0.2034s/iter; left time: 320.8095s
	iters: 400, epoch: 27 | loss: 0.0004209
	speed: 0.2071s/iter; left time: 305.9367s
Epoch: 27 cost time: 95.91535782814026
Epoch: 27, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0022243
	speed: 0.4681s/iter; left time: 612.2286s
	iters: 200, epoch: 28 | loss: 0.0010025
	speed: 0.1768s/iter; left time: 213.6178s
	iters: 300, epoch: 28 | loss: 0.0008511
	speed: 0.1748s/iter; left time: 193.6928s
	iters: 400, epoch: 28 | loss: 0.0023402
	speed: 0.1620s/iter; left time: 163.2994s
Epoch: 28 cost time: 76.73580527305603
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0008705
	speed: 0.5099s/iter; left time: 427.7967s
	iters: 200, epoch: 29 | loss: 0.0003403
	speed: 0.1577s/iter; left time: 116.5269s
	iters: 300, epoch: 29 | loss: 0.0004212
	speed: 0.1154s/iter; left time: 73.7332s
	iters: 400, epoch: 29 | loss: 0.0019600
	speed: 0.1985s/iter; left time: 106.9966s
Epoch: 29 cost time: 79.10165286064148
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0028266
	speed: 0.5895s/iter; left time: 218.1195s
	iters: 200, epoch: 30 | loss: 0.0004074
	speed: 0.2091s/iter; left time: 56.4679s
	iters: 300, epoch: 30 | loss: 0.0008594
	speed: 0.2123s/iter; left time: 36.0977s
	iters: 400, epoch: 30 | loss: 0.0457045
	speed: 0.2084s/iter; left time: 14.5883s
Epoch: 30 cost time: 97.62777590751648
Epoch: 30, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9859919954259577
model parameter : 587786
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0224154
	speed: 0.1476s/iter; left time: 2062.0844s
	iters: 200, epoch: 1 | loss: 1.3419724
	speed: 0.1146s/iter; left time: 1590.1531s
	iters: 300, epoch: 1 | loss: 0.5433422
	speed: 0.1244s/iter; left time: 1713.1394s
	iters: 400, epoch: 1 | loss: 0.3660392
	speed: 0.0504s/iter; left time: 689.4758s
Epoch: 1 cost time: 48.63457369804382
Epoch: 1, Steps: 469 | Train Loss: 1.187 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (inf --> -0.899939).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2010323
	speed: 0.3605s/iter; left time: 4867.0490s
	iters: 200, epoch: 2 | loss: 0.3520449
	speed: 0.1183s/iter; left time: 1584.9714s
	iters: 300, epoch: 2 | loss: 0.0984865
	speed: 0.1135s/iter; left time: 1509.7469s
	iters: 400, epoch: 2 | loss: 0.1343617
	speed: 0.1105s/iter; left time: 1459.0343s
Epoch: 2 cost time: 53.663960456848145
Epoch: 2, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
Validation loss decreased (-0.899939 --> -0.960547).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1456142
	speed: 0.4142s/iter; left time: 5398.7128s
	iters: 200, epoch: 3 | loss: 0.0255459
	speed: 0.1178s/iter; left time: 1522.9154s
	iters: 300, epoch: 3 | loss: 0.0606230
	speed: 0.1123s/iter; left time: 1440.5448s
	iters: 400, epoch: 3 | loss: 0.0276031
	speed: 0.1231s/iter; left time: 1567.2647s
Epoch: 3 cost time: 54.65794134140015
Epoch: 3, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.960547 --> -0.972555).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0322374
	speed: 0.4140s/iter; left time: 5202.0944s
	iters: 200, epoch: 4 | loss: 0.1460711
	speed: 0.1161s/iter; left time: 1446.5473s
	iters: 300, epoch: 4 | loss: 0.1283016
	speed: 0.1341s/iter; left time: 1657.5443s
	iters: 400, epoch: 4 | loss: 0.1725755
	speed: 0.1167s/iter; left time: 1431.1664s
Epoch: 4 cost time: 55.9739887714386
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.972555 --> -0.977987).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0102304
	speed: 0.3780s/iter; left time: 4572.3019s
	iters: 200, epoch: 5 | loss: 0.0174526
	speed: 0.1159s/iter; left time: 1390.0264s
	iters: 300, epoch: 5 | loss: 0.0490170
	speed: 0.1191s/iter; left time: 1416.4358s
	iters: 400, epoch: 5 | loss: 0.0179515
	speed: 0.1198s/iter; left time: 1413.3898s
Epoch: 5 cost time: 55.68071174621582
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0784360
	speed: 0.4099s/iter; left time: 4765.9310s
	iters: 200, epoch: 6 | loss: 0.0095579
	speed: 0.1235s/iter; left time: 1423.7174s
	iters: 300, epoch: 6 | loss: 0.0110337
	speed: 0.1116s/iter; left time: 1275.3114s
	iters: 400, epoch: 6 | loss: 0.0275052
	speed: 0.0955s/iter; left time: 1081.6765s
Epoch: 6 cost time: 52.64809274673462
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.977987 --> -0.978273).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0245543
	speed: 0.3853s/iter; left time: 4298.4521s
	iters: 200, epoch: 7 | loss: 0.0070339
	speed: 0.1008s/iter; left time: 1114.5002s
	iters: 300, epoch: 7 | loss: 0.0029370
	speed: 0.1090s/iter; left time: 1194.2950s
	iters: 400, epoch: 7 | loss: 0.0375797
	speed: 0.1093s/iter; left time: 1186.2786s
Epoch: 7 cost time: 49.06274604797363
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1100679
	speed: 0.3188s/iter; left time: 3406.8648s
	iters: 200, epoch: 8 | loss: 0.0036035
	speed: 0.1158s/iter; left time: 1225.7510s
	iters: 300, epoch: 8 | loss: 0.0036597
	speed: 0.1165s/iter; left time: 1221.5042s
	iters: 400, epoch: 8 | loss: 0.0063132
	speed: 0.1122s/iter; left time: 1165.5967s
Epoch: 8 cost time: 53.999526023864746
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.978273 --> -0.983990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0311586
	speed: 0.4167s/iter; left time: 4258.2717s
	iters: 200, epoch: 9 | loss: 0.0119453
	speed: 0.1138s/iter; left time: 1151.9626s
	iters: 300, epoch: 9 | loss: 0.0026950
	speed: 0.1178s/iter; left time: 1179.8720s
	iters: 400, epoch: 9 | loss: 0.0021859
	speed: 0.1298s/iter; left time: 1287.0142s
Epoch: 9 cost time: 55.93257665634155
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0058387
	speed: 0.3261s/iter; left time: 3179.0591s
	iters: 200, epoch: 10 | loss: 0.0025663
	speed: 0.1273s/iter; left time: 1228.5032s
	iters: 300, epoch: 10 | loss: 0.0031457
	speed: 0.1283s/iter; left time: 1225.5900s
	iters: 400, epoch: 10 | loss: 0.0138380
	speed: 0.1262s/iter; left time: 1192.9296s
Epoch: 10 cost time: 55.599900245666504
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984562).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0062465
	speed: 0.4519s/iter; left time: 4194.0871s
	iters: 200, epoch: 11 | loss: 0.0214293
	speed: 0.1236s/iter; left time: 1134.7957s
	iters: 300, epoch: 11 | loss: 0.0093336
	speed: 0.1251s/iter; left time: 1136.1771s
	iters: 400, epoch: 11 | loss: 0.0068321
	speed: 0.1325s/iter; left time: 1190.3696s
Epoch: 11 cost time: 59.409765005111694
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0049604
	speed: 0.4189s/iter; left time: 3691.1931s
	iters: 200, epoch: 12 | loss: 0.0057892
	speed: 0.1228s/iter; left time: 1069.7890s
	iters: 300, epoch: 12 | loss: 0.0712387
	speed: 0.1065s/iter; left time: 917.0434s
	iters: 400, epoch: 12 | loss: 0.0017159
	speed: 0.1210s/iter; left time: 1029.5994s
Epoch: 12 cost time: 55.2939658164978
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0008250
	speed: 0.3697s/iter; left time: 3084.6536s
	iters: 200, epoch: 13 | loss: 0.0010307
	speed: 0.1011s/iter; left time: 833.4398s
	iters: 300, epoch: 13 | loss: 0.0131111
	speed: 0.1103s/iter; left time: 898.5478s
	iters: 400, epoch: 13 | loss: 0.0038085
	speed: 0.1031s/iter; left time: 828.8708s
Epoch: 13 cost time: 46.47531032562256
Epoch: 13, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0005507
	speed: 0.3933s/iter; left time: 3096.5704s
	iters: 200, epoch: 14 | loss: 0.0033014
	speed: 0.1004s/iter; left time: 780.3970s
	iters: 300, epoch: 14 | loss: 0.0010308
	speed: 0.1024s/iter; left time: 786.0471s
	iters: 400, epoch: 14 | loss: 0.0053274
	speed: 0.1119s/iter; left time: 847.8813s
Epoch: 14 cost time: 50.690574407577515
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0008830
	speed: 0.4007s/iter; left time: 2967.2804s
	iters: 200, epoch: 15 | loss: 0.0019083
	speed: 0.1196s/iter; left time: 873.5634s
	iters: 300, epoch: 15 | loss: 0.0009306
	speed: 0.1125s/iter; left time: 810.8805s
	iters: 400, epoch: 15 | loss: 0.0000970
	speed: 0.1005s/iter; left time: 714.1232s
Epoch: 15 cost time: 51.26568388938904
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
Validation loss decreased (-0.984562 --> -0.985991).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0027291
	speed: 0.3950s/iter; left time: 2739.4447s
	iters: 200, epoch: 16 | loss: 0.0015622
	speed: 0.1206s/iter; left time: 824.6212s
	iters: 300, epoch: 16 | loss: 0.0007245
	speed: 0.1245s/iter; left time: 838.6668s
	iters: 400, epoch: 16 | loss: 0.0052698
	speed: 0.1244s/iter; left time: 825.8442s
Epoch: 16 cost time: 56.88888883590698
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0976778
	speed: 0.3183s/iter; left time: 2058.6436s
	iters: 200, epoch: 17 | loss: 0.0011297
	speed: 0.0725s/iter; left time: 461.7767s
	iters: 300, epoch: 17 | loss: 0.0005696
	speed: 0.1021s/iter; left time: 639.9061s
	iters: 400, epoch: 17 | loss: 0.0177025
	speed: 0.1111s/iter; left time: 685.3265s
Epoch: 17 cost time: 41.98331308364868
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0011596
	speed: 0.3848s/iter; left time: 2307.8647s
	iters: 200, epoch: 18 | loss: 0.0001327
	speed: 0.1072s/iter; left time: 632.3281s
	iters: 300, epoch: 18 | loss: 0.0001696
	speed: 0.1070s/iter; left time: 620.6397s
	iters: 400, epoch: 18 | loss: 0.0030739
	speed: 0.1032s/iter; left time: 588.2543s
Epoch: 18 cost time: 50.61402988433838
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2853893
	speed: 0.3753s/iter; left time: 2074.9580s
	iters: 200, epoch: 19 | loss: 0.0036561
	speed: 0.0709s/iter; left time: 384.7265s
	iters: 300, epoch: 19 | loss: 0.0006685
	speed: 0.0774s/iter; left time: 412.4765s
	iters: 400, epoch: 19 | loss: 0.0134187
	speed: 0.0959s/iter; left time: 501.7084s
Epoch: 19 cost time: 40.135952949523926
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0011133
	speed: 0.3329s/iter; left time: 1684.5462s
	iters: 200, epoch: 20 | loss: 0.0007053
	speed: 0.0958s/iter; left time: 475.0890s
	iters: 300, epoch: 20 | loss: 0.0030410
	speed: 0.1059s/iter; left time: 514.4653s
	iters: 400, epoch: 20 | loss: 0.0018626
	speed: 0.0999s/iter; left time: 475.7123s
Epoch: 20 cost time: 48.69691729545593
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0045424
	speed: 0.2492s/iter; left time: 1143.9454s
	iters: 200, epoch: 21 | loss: 0.0005339
	speed: 0.0628s/iter; left time: 281.8951s
	iters: 300, epoch: 21 | loss: 0.0010448
	speed: 0.0873s/iter; left time: 383.4882s
	iters: 400, epoch: 21 | loss: 0.0015292
	speed: 0.1123s/iter; left time: 481.9576s
Epoch: 21 cost time: 39.273568630218506
Epoch: 21, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0007018
	speed: 0.4536s/iter; left time: 1869.8426s
	iters: 200, epoch: 22 | loss: 0.0032129
	speed: 0.1209s/iter; left time: 486.3770s
	iters: 300, epoch: 22 | loss: 0.0032973
	speed: 0.1268s/iter; left time: 497.4701s
	iters: 400, epoch: 22 | loss: 0.0035038
	speed: 0.1136s/iter; left time: 434.0728s
Epoch: 22 cost time: 57.92190623283386
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0525999
	speed: 0.4314s/iter; left time: 1575.8393s
	iters: 200, epoch: 23 | loss: 0.0044457
	speed: 0.1178s/iter; left time: 418.3736s
	iters: 300, epoch: 23 | loss: 0.0351021
	speed: 0.1234s/iter; left time: 426.1072s
	iters: 400, epoch: 23 | loss: 0.0012036
	speed: 0.1179s/iter; left time: 395.3311s
Epoch: 23 cost time: 56.693727254867554
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0075906
	speed: 0.4233s/iter; left time: 1347.8585s
	iters: 200, epoch: 24 | loss: 0.0002210
	speed: 0.1172s/iter; left time: 361.3426s
	iters: 300, epoch: 24 | loss: 0.0239059
	speed: 0.1223s/iter; left time: 364.9780s
	iters: 400, epoch: 24 | loss: 0.0013077
	speed: 0.1185s/iter; left time: 341.8867s
Epoch: 24 cost time: 57.08345365524292
Epoch: 24, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0005653
	speed: 0.4268s/iter; left time: 1158.7241s
	iters: 200, epoch: 25 | loss: 0.4150305
	speed: 0.1137s/iter; left time: 297.3970s
	iters: 300, epoch: 25 | loss: 0.0045194
	speed: 0.1271s/iter; left time: 319.6672s
	iters: 400, epoch: 25 | loss: 0.0012389
	speed: 0.1217s/iter; left time: 293.9736s
Epoch: 25 cost time: 55.49163222312927
Epoch: 25, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9859919954259577
model parameter : 173898
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0573463
	speed: 0.1284s/iter; left time: 1793.2872s
	iters: 200, epoch: 1 | loss: 1.2525723
	speed: 0.1171s/iter; left time: 1624.1837s
	iters: 300, epoch: 1 | loss: 0.7818550
	speed: 0.0995s/iter; left time: 1369.9406s
	iters: 400, epoch: 1 | loss: 0.5784829
	speed: 0.1186s/iter; left time: 1621.4084s
Epoch: 1 cost time: 54.57897114753723
Epoch: 1, Steps: 469 | Train Loss: 1.267 Vali Loss: 0.452 Vali Acc: 0.869 Test Loss: 0.452 Test Acc: 0.869
Validation loss decreased (inf --> -0.869349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3551791
	speed: 0.4181s/iter; left time: 5645.7967s
	iters: 200, epoch: 2 | loss: 0.3986733
	speed: 0.1139s/iter; left time: 1526.9187s
	iters: 300, epoch: 2 | loss: 0.4251527
	speed: 0.1125s/iter; left time: 1496.1076s
	iters: 400, epoch: 2 | loss: 0.1851227
	speed: 0.1124s/iter; left time: 1483.7475s
Epoch: 2 cost time: 51.92431354522705
Epoch: 2, Steps: 469 | Train Loss: 0.231 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
Validation loss decreased (-0.869349 --> -0.947683).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1104858
	speed: 0.3325s/iter; left time: 4333.6311s
	iters: 200, epoch: 3 | loss: 0.0468656
	speed: 0.1177s/iter; left time: 1522.4592s
	iters: 300, epoch: 3 | loss: 0.0400982
	speed: 0.1198s/iter; left time: 1537.1204s
	iters: 400, epoch: 3 | loss: 0.0087148
	speed: 0.1145s/iter; left time: 1457.6111s
Epoch: 3 cost time: 51.724913120269775
Epoch: 3, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
Validation loss decreased (-0.947683 --> -0.970554).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0129717
	speed: 0.4105s/iter; left time: 5157.1136s
	iters: 200, epoch: 4 | loss: 0.0732873
	speed: 0.1202s/iter; left time: 1497.8196s
	iters: 300, epoch: 4 | loss: 0.0225243
	speed: 0.1162s/iter; left time: 1437.2046s
	iters: 400, epoch: 4 | loss: 0.0337252
	speed: 0.1169s/iter; left time: 1433.3254s
Epoch: 4 cost time: 55.441274881362915
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0046885
	speed: 0.4180s/iter; left time: 5055.9395s
	iters: 200, epoch: 5 | loss: 0.0416203
	speed: 0.1147s/iter; left time: 1376.4010s
	iters: 300, epoch: 5 | loss: 0.0484729
	speed: 0.1104s/iter; left time: 1312.9862s
	iters: 400, epoch: 5 | loss: 0.1132429
	speed: 0.1227s/iter; left time: 1447.3548s
Epoch: 5 cost time: 55.14305067062378
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0274477
	speed: 0.4445s/iter; left time: 5167.3133s
	iters: 200, epoch: 6 | loss: 0.0327546
	speed: 0.1204s/iter; left time: 1387.6774s
	iters: 300, epoch: 6 | loss: 0.0141462
	speed: 0.1208s/iter; left time: 1379.8317s
	iters: 400, epoch: 6 | loss: 0.0022085
	speed: 0.1023s/iter; left time: 1158.6640s
Epoch: 6 cost time: 50.900264739990234
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.970554 --> -0.975985).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0296591
	speed: 0.3432s/iter; left time: 3828.5707s
	iters: 200, epoch: 7 | loss: 0.0125977
	speed: 0.1118s/iter; left time: 1235.9856s
	iters: 300, epoch: 7 | loss: 0.0049801
	speed: 0.1120s/iter; left time: 1226.9528s
	iters: 400, epoch: 7 | loss: 0.0187267
	speed: 0.1119s/iter; left time: 1214.5957s
Epoch: 7 cost time: 52.40475130081177
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0035139
	speed: 0.3626s/iter; left time: 3875.0363s
	iters: 200, epoch: 8 | loss: 0.0034008
	speed: 0.1069s/iter; left time: 1132.3309s
	iters: 300, epoch: 8 | loss: 0.0019171
	speed: 0.1037s/iter; left time: 1088.0121s
	iters: 400, epoch: 8 | loss: 0.0025788
	speed: 0.1049s/iter; left time: 1089.7881s
Epoch: 8 cost time: 49.25062322616577
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.975985 --> -0.980560).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0048655
	speed: 0.3399s/iter; left time: 3473.3721s
	iters: 200, epoch: 9 | loss: 0.0100515
	speed: 0.1096s/iter; left time: 1109.1354s
	iters: 300, epoch: 9 | loss: 0.0212022
	speed: 0.1019s/iter; left time: 1020.6213s
	iters: 400, epoch: 9 | loss: 0.0656642
	speed: 0.1122s/iter; left time: 1112.4904s
Epoch: 9 cost time: 50.70428490638733
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0009659
	speed: 0.3962s/iter; left time: 3863.0795s
	iters: 200, epoch: 10 | loss: 0.0015405
	speed: 0.1097s/iter; left time: 1058.6701s
	iters: 300, epoch: 10 | loss: 0.0106891
	speed: 0.1089s/iter; left time: 1040.1476s
	iters: 400, epoch: 10 | loss: 0.0012025
	speed: 0.1063s/iter; left time: 1004.0933s
Epoch: 10 cost time: 51.815547466278076
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0037457
	speed: 0.4080s/iter; left time: 3786.6980s
	iters: 200, epoch: 11 | loss: 0.0111966
	speed: 0.1198s/iter; left time: 1099.9299s
	iters: 300, epoch: 11 | loss: 0.0014788
	speed: 0.1189s/iter; left time: 1079.7209s
	iters: 400, epoch: 11 | loss: 0.0030652
	speed: 0.1183s/iter; left time: 1062.6682s
Epoch: 11 cost time: 55.52142381668091
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0018772
	speed: 0.3806s/iter; left time: 3353.8355s
	iters: 200, epoch: 12 | loss: 0.1193181
	speed: 0.0902s/iter; left time: 785.5465s
	iters: 300, epoch: 12 | loss: 0.3618274
	speed: 0.1047s/iter; left time: 901.4387s
	iters: 400, epoch: 12 | loss: 0.0088179
	speed: 0.1064s/iter; left time: 905.3061s
Epoch: 12 cost time: 45.998000144958496
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0005882
	speed: 0.3749s/iter; left time: 3128.0072s
	iters: 200, epoch: 13 | loss: 0.0002762
	speed: 0.1018s/iter; left time: 839.4266s
	iters: 300, epoch: 13 | loss: 0.0055373
	speed: 0.0871s/iter; left time: 709.5858s
	iters: 400, epoch: 13 | loss: 0.0392877
	speed: 0.1014s/iter; left time: 815.5250s
Epoch: 13 cost time: 46.50258755683899
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0028700
	speed: 0.3260s/iter; left time: 2566.6919s
	iters: 200, epoch: 14 | loss: 0.0062334
	speed: 0.1280s/iter; left time: 994.7673s
	iters: 300, epoch: 14 | loss: 0.0022802
	speed: 0.1201s/iter; left time: 921.4078s
	iters: 400, epoch: 14 | loss: 0.0003580
	speed: 0.1193s/iter; left time: 903.8500s
Epoch: 14 cost time: 53.896498680114746
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0256644
	speed: 0.4446s/iter; left time: 3292.5820s
	iters: 200, epoch: 15 | loss: 0.0049221
	speed: 0.1219s/iter; left time: 890.3939s
	iters: 300, epoch: 15 | loss: 0.0027183
	speed: 0.1284s/iter; left time: 925.0192s
	iters: 400, epoch: 15 | loss: 0.0025040
	speed: 0.1210s/iter; left time: 859.7975s
Epoch: 15 cost time: 58.71002674102783
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0122620
	speed: 0.4406s/iter; left time: 3056.1416s
	iters: 200, epoch: 16 | loss: 0.0850184
	speed: 0.1213s/iter; left time: 829.0059s
	iters: 300, epoch: 16 | loss: 0.0219464
	speed: 0.1309s/iter; left time: 881.7500s
	iters: 400, epoch: 16 | loss: 0.0461704
	speed: 0.1287s/iter; left time: 854.1341s
Epoch: 16 cost time: 60.06998586654663
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0015263
	speed: 0.4695s/iter; left time: 3036.0150s
	iters: 200, epoch: 17 | loss: 0.0012721
	speed: 0.1214s/iter; left time: 773.1943s
	iters: 300, epoch: 17 | loss: 0.0006189
	speed: 0.1316s/iter; left time: 824.6757s
	iters: 400, epoch: 17 | loss: 0.0162468
	speed: 0.1284s/iter; left time: 791.9881s
Epoch: 17 cost time: 61.11028480529785
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0031566
	speed: 0.4718s/iter; left time: 2829.7178s
	iters: 200, epoch: 18 | loss: 0.0000738
	speed: 0.1252s/iter; left time: 738.7217s
	iters: 300, epoch: 18 | loss: 0.0009795
	speed: 0.1374s/iter; left time: 796.4330s
	iters: 400, epoch: 18 | loss: 0.0006898
	speed: 0.1228s/iter; left time: 699.8964s
Epoch: 18 cost time: 61.65429711341858
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.980560 --> -0.984848).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001382
	speed: 0.4552s/iter; left time: 2516.9409s
	iters: 200, epoch: 19 | loss: 0.0018234
	speed: 0.1193s/iter; left time: 647.7755s
	iters: 300, epoch: 19 | loss: 0.0029255
	speed: 0.1300s/iter; left time: 692.9020s
	iters: 400, epoch: 19 | loss: 0.0139700
	speed: 0.1204s/iter; left time: 629.7599s
Epoch: 19 cost time: 58.901432037353516
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0004868
	speed: 0.4232s/iter; left time: 2141.3981s
	iters: 200, epoch: 20 | loss: 0.0000546
	speed: 0.1140s/iter; left time: 565.6687s
	iters: 300, epoch: 20 | loss: 0.0034949
	speed: 0.0801s/iter; left time: 389.3426s
	iters: 400, epoch: 20 | loss: 0.0037183
	speed: 0.0232s/iter; left time: 110.6580s
Epoch: 20 cost time: 35.68287920951843
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0070457
	speed: 0.1246s/iter; left time: 572.1963s
	iters: 200, epoch: 21 | loss: 0.0019736
	speed: 0.1109s/iter; left time: 498.2593s
	iters: 300, epoch: 21 | loss: 0.0011215
	speed: 0.1110s/iter; left time: 487.5162s
	iters: 400, epoch: 21 | loss: 0.0003631
	speed: 0.1102s/iter; left time: 472.7591s
Epoch: 21 cost time: 46.98336410522461
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0007213
	speed: 0.4072s/iter; left time: 1678.3227s
	iters: 200, epoch: 22 | loss: 0.0012748
	speed: 0.1046s/iter; left time: 420.5775s
	iters: 300, epoch: 22 | loss: 0.0009226
	speed: 0.1196s/iter; left time: 469.0308s
	iters: 400, epoch: 22 | loss: 0.0002600
	speed: 0.1202s/iter; left time: 459.5228s
Epoch: 22 cost time: 53.23128867149353
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002103
	speed: 0.4166s/iter; left time: 1521.7570s
	iters: 200, epoch: 23 | loss: 0.0036737
	speed: 0.1150s/iter; left time: 408.4185s
	iters: 300, epoch: 23 | loss: 0.0001419
	speed: 0.1154s/iter; left time: 398.3058s
	iters: 400, epoch: 23 | loss: 0.0133378
	speed: 0.1210s/iter; left time: 405.8693s
Epoch: 23 cost time: 55.866496562957764
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0016194
	speed: 0.4034s/iter; left time: 1284.5500s
	iters: 200, epoch: 24 | loss: 0.0073181
	speed: 0.1192s/iter; left time: 367.7439s
	iters: 300, epoch: 24 | loss: 0.0006029
	speed: 0.1001s/iter; left time: 298.8417s
	iters: 400, epoch: 24 | loss: 0.0009434
	speed: 0.1128s/iter; left time: 325.3927s
Epoch: 24 cost time: 53.805063247680664
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0002778
	speed: 0.3892s/iter; left time: 1056.6683s
	iters: 200, epoch: 25 | loss: 0.0002814
	speed: 0.1163s/iter; left time: 304.1097s
	iters: 300, epoch: 25 | loss: 0.0005586
	speed: 0.1141s/iter; left time: 286.9798s
	iters: 400, epoch: 25 | loss: 0.0041252
	speed: 0.0993s/iter; left time: 239.7740s
Epoch: 25 cost time: 51.299482345581055
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0004671
	speed: 0.3897s/iter; left time: 875.3522s
	iters: 200, epoch: 26 | loss: 0.0045339
	speed: 0.1114s/iter; left time: 239.0050s
	iters: 300, epoch: 26 | loss: 0.0018490
	speed: 0.1116s/iter; left time: 228.3560s
	iters: 400, epoch: 26 | loss: 0.0001737
	speed: 0.1021s/iter; left time: 198.7794s
Epoch: 26 cost time: 50.2690646648407
Epoch: 26, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0228815
	speed: 0.3519s/iter; left time: 625.2424s
	iters: 200, epoch: 27 | loss: 0.0003200
	speed: 0.1127s/iter; left time: 188.9300s
	iters: 300, epoch: 27 | loss: 0.0004418
	speed: 0.1242s/iter; left time: 195.7908s
	iters: 400, epoch: 27 | loss: 0.0009814
	speed: 0.1150s/iter; left time: 169.8750s
Epoch: 27 cost time: 53.3606903553009
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0034855
	speed: 0.4363s/iter; left time: 570.6486s
	iters: 200, epoch: 28 | loss: 0.0001924
	speed: 0.1154s/iter; left time: 139.4336s
	iters: 300, epoch: 28 | loss: 0.0013290
	speed: 0.1265s/iter; left time: 140.2167s
	iters: 400, epoch: 28 | loss: 0.0259733
	speed: 0.1261s/iter; left time: 127.0751s
Epoch: 28 cost time: 58.36575365066528
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 587786
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0658879
	speed: 0.1050s/iter; left time: 1466.6321s
	iters: 200, epoch: 1 | loss: 1.5090281
	speed: 0.0770s/iter; left time: 1067.4585s
	iters: 300, epoch: 1 | loss: 0.6606991
	speed: 0.0808s/iter; left time: 1112.7675s
	iters: 400, epoch: 1 | loss: 0.5901338
	speed: 0.0388s/iter; left time: 530.2999s
Epoch: 1 cost time: 32.60433483123779
Epoch: 1, Steps: 469 | Train Loss: 1.315 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
Validation loss decreased (inf --> -0.861916).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3319959
	speed: 0.3227s/iter; left time: 4357.7233s
	iters: 200, epoch: 2 | loss: 0.4368577
	speed: 0.0827s/iter; left time: 1108.9314s
	iters: 300, epoch: 2 | loss: 0.1826481
	speed: 0.0901s/iter; left time: 1198.9953s
	iters: 400, epoch: 2 | loss: 0.2183940
	speed: 0.0793s/iter; left time: 1046.6395s
Epoch: 2 cost time: 40.755151987075806
Epoch: 2, Steps: 469 | Train Loss: 0.262 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.861916 --> -0.953400).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2315728
	speed: 0.3504s/iter; left time: 4566.7413s
	iters: 200, epoch: 3 | loss: 0.0482283
	speed: 0.0870s/iter; left time: 1125.0813s
	iters: 300, epoch: 3 | loss: 0.0975022
	speed: 0.0845s/iter; left time: 1084.6318s
	iters: 400, epoch: 3 | loss: 0.0902648
	speed: 0.0838s/iter; left time: 1067.6617s
Epoch: 3 cost time: 39.140706300735474
Epoch: 3, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.953400 --> -0.970554).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0660361
	speed: 0.3660s/iter; left time: 4597.9100s
	iters: 200, epoch: 4 | loss: 0.1282513
	speed: 0.0866s/iter; left time: 1078.7687s
	iters: 300, epoch: 4 | loss: 0.2360662
	speed: 0.0803s/iter; left time: 992.6435s
	iters: 400, epoch: 4 | loss: 0.3309474
	speed: 0.0839s/iter; left time: 1029.3667s
Epoch: 4 cost time: 39.19630551338196
Epoch: 4, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.970554 --> -0.973698).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0326843
	speed: 0.3674s/iter; left time: 4444.1232s
	iters: 200, epoch: 5 | loss: 0.0307945
	speed: 0.0856s/iter; left time: 1027.2880s
	iters: 300, epoch: 5 | loss: 0.0086255
	speed: 0.0769s/iter; left time: 914.2419s
	iters: 400, epoch: 5 | loss: 0.0608055
	speed: 0.0512s/iter; left time: 604.0964s
Epoch: 5 cost time: 33.85504221916199
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0857405
	speed: 0.3053s/iter; left time: 3549.7573s
	iters: 200, epoch: 6 | loss: 0.0077611
	speed: 0.0801s/iter; left time: 922.9062s
	iters: 300, epoch: 6 | loss: 0.0133013
	speed: 0.0829s/iter; left time: 947.0215s
	iters: 400, epoch: 6 | loss: 0.0192720
	speed: 0.0813s/iter; left time: 921.1901s
Epoch: 6 cost time: 37.626975297927856
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.973698 --> -0.979988).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0112954
	speed: 0.3353s/iter; left time: 3740.9726s
	iters: 200, epoch: 7 | loss: 0.0032195
	speed: 0.0777s/iter; left time: 859.1022s
	iters: 300, epoch: 7 | loss: 0.0056123
	speed: 0.0788s/iter; left time: 863.6158s
	iters: 400, epoch: 7 | loss: 0.0678290
	speed: 0.0829s/iter; left time: 899.9422s
Epoch: 7 cost time: 37.115394592285156
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0964466
	speed: 0.3461s/iter; left time: 3699.4702s
	iters: 200, epoch: 8 | loss: 0.0120145
	speed: 0.0781s/iter; left time: 827.2613s
	iters: 300, epoch: 8 | loss: 0.0034034
	speed: 0.0792s/iter; left time: 830.3820s
	iters: 400, epoch: 8 | loss: 0.0030636
	speed: 0.0529s/iter; left time: 549.1881s
Epoch: 8 cost time: 35.109915256500244
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0102781
	speed: 0.3474s/iter; left time: 3549.7086s
	iters: 200, epoch: 9 | loss: 0.0039224
	speed: 0.0809s/iter; left time: 818.5517s
	iters: 300, epoch: 9 | loss: 0.0095311
	speed: 0.0818s/iter; left time: 819.4572s
	iters: 400, epoch: 9 | loss: 0.0035144
	speed: 0.0749s/iter; left time: 743.0049s
Epoch: 9 cost time: 36.115256547927856
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0024110
	speed: 0.3236s/iter; left time: 3155.0058s
	iters: 200, epoch: 10 | loss: 0.0044994
	speed: 0.0728s/iter; left time: 702.5949s
	iters: 300, epoch: 10 | loss: 0.0033410
	speed: 0.0769s/iter; left time: 734.5509s
	iters: 400, epoch: 10 | loss: 0.0088103
	speed: 0.0784s/iter; left time: 740.5991s
Epoch: 10 cost time: 35.93911266326904
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.983133).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0330539
	speed: 0.3235s/iter; left time: 3002.0488s
	iters: 200, epoch: 11 | loss: 0.1230141
	speed: 0.0745s/iter; left time: 684.3871s
	iters: 300, epoch: 11 | loss: 0.0483406
	speed: 0.0699s/iter; left time: 634.3260s
	iters: 400, epoch: 11 | loss: 0.0028828
	speed: 0.0543s/iter; left time: 487.5616s
Epoch: 11 cost time: 31.727516651153564
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0642460
	speed: 0.3260s/iter; left time: 2872.2757s
	iters: 200, epoch: 12 | loss: 0.0031676
	speed: 0.0829s/iter; left time: 722.1724s
	iters: 300, epoch: 12 | loss: 0.0566575
	speed: 0.0752s/iter; left time: 647.9107s
	iters: 400, epoch: 12 | loss: 0.0006653
	speed: 0.0783s/iter; left time: 666.6501s
Epoch: 12 cost time: 37.04648804664612
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0024857
	speed: 0.3496s/iter; left time: 2916.7577s
	iters: 200, epoch: 13 | loss: 0.0032127
	speed: 0.0790s/iter; left time: 651.2146s
	iters: 300, epoch: 13 | loss: 0.0064649
	speed: 0.0844s/iter; left time: 687.5668s
	iters: 400, epoch: 13 | loss: 0.0051471
	speed: 0.0856s/iter; left time: 688.8530s
Epoch: 13 cost time: 39.166239738464355
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0014536
	speed: 0.3497s/iter; left time: 2753.5744s
	iters: 200, epoch: 14 | loss: 0.0130490
	speed: 0.0844s/iter; left time: 655.7653s
	iters: 300, epoch: 14 | loss: 0.0012156
	speed: 0.0871s/iter; left time: 668.0257s
	iters: 400, epoch: 14 | loss: 0.0099123
	speed: 0.0808s/iter; left time: 612.1276s
Epoch: 14 cost time: 40.27770161628723
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983133 --> -0.983418).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0053026
	speed: 0.3664s/iter; left time: 2713.4375s
	iters: 200, epoch: 15 | loss: 0.0053255
	speed: 0.0845s/iter; left time: 617.0178s
	iters: 300, epoch: 15 | loss: 0.0017311
	speed: 0.0782s/iter; left time: 563.7067s
	iters: 400, epoch: 15 | loss: 0.0012896
	speed: 0.0881s/iter; left time: 626.1098s
Epoch: 15 cost time: 39.01293992996216
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
Validation loss decreased (-0.983418 --> -0.984848).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0049671
	speed: 0.3058s/iter; left time: 2121.1706s
	iters: 200, epoch: 16 | loss: 0.0007113
	speed: 0.0743s/iter; left time: 508.2310s
	iters: 300, epoch: 16 | loss: 0.0003747
	speed: 0.0696s/iter; left time: 469.1067s
	iters: 400, epoch: 16 | loss: 0.0010715
	speed: 0.0748s/iter; left time: 496.1317s
Epoch: 16 cost time: 34.64691162109375
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0124442
	speed: 0.3133s/iter; left time: 2026.3718s
	iters: 200, epoch: 17 | loss: 0.0032064
	speed: 0.0736s/iter; left time: 468.3711s
	iters: 300, epoch: 17 | loss: 0.0002511
	speed: 0.0718s/iter; left time: 450.0795s
	iters: 400, epoch: 17 | loss: 0.0019689
	speed: 0.0708s/iter; left time: 436.7536s
Epoch: 17 cost time: 34.20195198059082
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0086308
	speed: 0.3014s/iter; left time: 1807.7177s
	iters: 200, epoch: 18 | loss: 0.0004882
	speed: 0.0715s/iter; left time: 421.4948s
	iters: 300, epoch: 18 | loss: 0.0012475
	speed: 0.0717s/iter; left time: 415.8094s
	iters: 400, epoch: 18 | loss: 0.0157209
	speed: 0.0720s/iter; left time: 410.1180s
Epoch: 18 cost time: 33.78125834465027
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0791430
	speed: 0.3028s/iter; left time: 1674.4573s
	iters: 200, epoch: 19 | loss: 0.0010981
	speed: 0.0702s/iter; left time: 381.0586s
	iters: 300, epoch: 19 | loss: 0.0004014
	speed: 0.0645s/iter; left time: 343.8049s
	iters: 400, epoch: 19 | loss: 0.0018379
	speed: 0.0718s/iter; left time: 375.4112s
Epoch: 19 cost time: 32.06036305427551
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.984848 --> -0.985134).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0004262
	speed: 0.2996s/iter; left time: 1515.7913s
	iters: 200, epoch: 20 | loss: 0.0006946
	speed: 0.0529s/iter; left time: 262.1947s
	iters: 300, epoch: 20 | loss: 0.0012278
	speed: 0.0581s/iter; left time: 282.1616s
	iters: 400, epoch: 20 | loss: 0.0024005
	speed: 0.0865s/iter; left time: 411.9076s
Epoch: 20 cost time: 31.835847854614258
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0011316
	speed: 0.3644s/iter; left time: 1672.9826s
	iters: 200, epoch: 21 | loss: 0.0010836
	speed: 0.0820s/iter; left time: 368.0436s
	iters: 300, epoch: 21 | loss: 0.0047921
	speed: 0.0928s/iter; left time: 407.5453s
	iters: 400, epoch: 21 | loss: 0.0008043
	speed: 0.0813s/iter; left time: 348.7867s
Epoch: 21 cost time: 41.073150396347046
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0054551
	speed: 0.3669s/iter; left time: 1512.5323s
	iters: 200, epoch: 22 | loss: 0.0027449
	speed: 0.0889s/iter; left time: 357.4754s
	iters: 300, epoch: 22 | loss: 0.0006554
	speed: 0.0360s/iter; left time: 141.0610s
	iters: 400, epoch: 22 | loss: 0.0009850
	speed: 0.0425s/iter; left time: 162.3046s
Epoch: 22 cost time: 29.00774645805359
Epoch: 22, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0100537
	speed: 0.3373s/iter; left time: 1232.1989s
	iters: 200, epoch: 23 | loss: 0.0003787
	speed: 0.0805s/iter; left time: 285.9696s
	iters: 300, epoch: 23 | loss: 0.0021485
	speed: 0.0856s/iter; left time: 295.5944s
	iters: 400, epoch: 23 | loss: 0.0031848
	speed: 0.0852s/iter; left time: 285.7205s
Epoch: 23 cost time: 38.07978296279907
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0025533
	speed: 0.3514s/iter; left time: 1118.7943s
	iters: 200, epoch: 24 | loss: 0.0001202
	speed: 0.0649s/iter; left time: 200.0214s
	iters: 300, epoch: 24 | loss: 0.0487643
	speed: 0.0831s/iter; left time: 247.8437s
	iters: 400, epoch: 24 | loss: 0.0004167
	speed: 0.0762s/iter; left time: 219.8096s
Epoch: 24 cost time: 36.46477484703064
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0010129
	speed: 0.3454s/iter; left time: 937.6375s
	iters: 200, epoch: 25 | loss: 0.1328367
	speed: 0.0799s/iter; left time: 208.9463s
	iters: 300, epoch: 25 | loss: 0.0036637
	speed: 0.0688s/iter; left time: 173.0025s
	iters: 400, epoch: 25 | loss: 0.0006259
	speed: 0.0864s/iter; left time: 208.5693s
Epoch: 25 cost time: 36.86212706565857
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0298817
	speed: 0.3408s/iter; left time: 765.4392s
	iters: 200, epoch: 26 | loss: 0.0077942
	speed: 0.0758s/iter; left time: 162.5744s
	iters: 300, epoch: 26 | loss: 0.0106288
	speed: 0.0559s/iter; left time: 114.4644s
	iters: 400, epoch: 26 | loss: 0.0100556
	speed: 0.0435s/iter; left time: 84.6620s
Epoch: 26 cost time: 30.219518661499023
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0001335
	speed: 0.2939s/iter; left time: 522.2996s
	iters: 200, epoch: 27 | loss: 0.0020017
	speed: 0.0755s/iter; left time: 126.5937s
	iters: 300, epoch: 27 | loss: 0.0493078
	speed: 0.0704s/iter; left time: 110.9850s
	iters: 400, epoch: 27 | loss: 0.0002995
	speed: 0.0594s/iter; left time: 87.7077s
Epoch: 27 cost time: 32.557180643081665
Epoch: 27, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.985134 --> -0.986277).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0002967
	speed: 0.3190s/iter; left time: 417.2966s
	iters: 200, epoch: 28 | loss: 0.0018459
	speed: 0.0655s/iter; left time: 79.1633s
	iters: 300, epoch: 28 | loss: 0.0068325
	speed: 0.0766s/iter; left time: 84.8905s
	iters: 400, epoch: 28 | loss: 0.0084430
	speed: 0.0772s/iter; left time: 77.8325s
Epoch: 28 cost time: 33.42129969596863
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0032209
	speed: 0.2702s/iter; left time: 226.7011s
	iters: 200, epoch: 29 | loss: 0.0006772
	speed: 0.0799s/iter; left time: 59.0384s
	iters: 300, epoch: 29 | loss: 0.0002686
	speed: 0.0730s/iter; left time: 46.6574s
	iters: 400, epoch: 29 | loss: 0.0015557
	speed: 0.0824s/iter; left time: 44.4227s
Epoch: 29 cost time: 35.72778868675232
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0002529
	speed: 0.3537s/iter; left time: 130.8707s
	iters: 200, epoch: 30 | loss: 0.0014301
	speed: 0.0736s/iter; left time: 19.8605s
	iters: 300, epoch: 30 | loss: 0.0138948
	speed: 0.0799s/iter; left time: 13.5809s
	iters: 400, epoch: 30 | loss: 0.0155720
	speed: 0.0829s/iter; left time: 5.8041s
Epoch: 30 cost time: 38.463948488235474
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 173898
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3655527
	speed: 0.2614s/iter; left time: 3652.2313s
	iters: 200, epoch: 1 | loss: 1.2800529
	speed: 0.2357s/iter; left time: 3269.6323s
	iters: 300, epoch: 1 | loss: 0.7009324
	speed: 0.2526s/iter; left time: 3478.6720s
	iters: 400, epoch: 1 | loss: 0.6622546
	speed: 0.2235s/iter; left time: 3055.3379s
Epoch: 1 cost time: 111.93787002563477
Epoch: 1, Steps: 469 | Train Loss: 1.228 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (inf --> -0.889361).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4275729
	speed: 0.5292s/iter; left time: 7145.0082s
	iters: 200, epoch: 2 | loss: 0.1825065
	speed: 0.2227s/iter; left time: 2985.2556s
	iters: 300, epoch: 2 | loss: 0.1708712
	speed: 0.1809s/iter; left time: 2405.9175s
	iters: 400, epoch: 2 | loss: 0.1750685
	speed: 0.2283s/iter; left time: 3014.4253s
Epoch: 2 cost time: 93.76436400413513
Epoch: 2, Steps: 469 | Train Loss: 0.192 Vali Loss: 0.149 Vali Acc: 0.952 Test Loss: 0.149 Test Acc: 0.952
Validation loss decreased (-0.889361 --> -0.952257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1367844
	speed: 0.5737s/iter; left time: 7476.7454s
	iters: 200, epoch: 3 | loss: 0.0269827
	speed: 0.2190s/iter; left time: 2832.3239s
	iters: 300, epoch: 3 | loss: 0.0181563
	speed: 0.2262s/iter; left time: 2903.3474s
	iters: 400, epoch: 3 | loss: 0.0226816
	speed: 0.1802s/iter; left time: 2294.1191s
Epoch: 3 cost time: 101.35719728469849
Epoch: 3, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.113 Vali Acc: 0.961 Test Loss: 0.113 Test Acc: 0.961
Validation loss decreased (-0.952257 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0756475
	speed: 0.6309s/iter; left time: 7926.1350s
	iters: 200, epoch: 4 | loss: 0.0058849
	speed: 0.2242s/iter; left time: 2794.2598s
	iters: 300, epoch: 4 | loss: 0.0178356
	speed: 0.2343s/iter; left time: 2897.0342s
	iters: 400, epoch: 4 | loss: 0.0936785
	speed: 0.2102s/iter; left time: 2577.7239s
Epoch: 4 cost time: 108.08324241638184
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.961405 --> -0.964550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0028355
	speed: 0.5992s/iter; left time: 7247.3475s
	iters: 200, epoch: 5 | loss: 0.0054736
	speed: 0.1764s/iter; left time: 2116.3617s
	iters: 300, epoch: 5 | loss: 0.0407088
	speed: 0.1995s/iter; left time: 2373.5167s
	iters: 400, epoch: 5 | loss: 0.0156276
	speed: 0.2093s/iter; left time: 2469.0766s
Epoch: 5 cost time: 92.9909348487854
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.964550 --> -0.973698).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0546632
	speed: 0.5400s/iter; left time: 6278.1350s
	iters: 200, epoch: 6 | loss: 0.0126912
	speed: 0.2203s/iter; left time: 2539.4886s
	iters: 300, epoch: 6 | loss: 0.1358346
	speed: 0.1915s/iter; left time: 2187.9465s
	iters: 400, epoch: 6 | loss: 0.0592500
	speed: 0.1321s/iter; left time: 1496.5217s
Epoch: 6 cost time: 83.31376910209656
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.973698 --> -0.982275).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0531216
	speed: 0.5288s/iter; left time: 5900.3745s
	iters: 200, epoch: 7 | loss: 0.0037779
	speed: 0.2381s/iter; left time: 2632.4886s
	iters: 300, epoch: 7 | loss: 0.0082878
	speed: 0.2347s/iter; left time: 2571.2586s
	iters: 400, epoch: 7 | loss: 0.0034478
	speed: 0.2254s/iter; left time: 2447.0841s
Epoch: 7 cost time: 107.62736988067627
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1211580
	speed: 0.5807s/iter; left time: 6206.4122s
	iters: 200, epoch: 8 | loss: 0.0186508
	speed: 0.2157s/iter; left time: 2284.3535s
	iters: 300, epoch: 8 | loss: 0.0287796
	speed: 0.2159s/iter; left time: 2264.4752s
	iters: 400, epoch: 8 | loss: 0.0047694
	speed: 0.2270s/iter; left time: 2357.6775s
Epoch: 8 cost time: 103.46690630912781
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.982275 --> -0.983990).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0089061
	speed: 0.5556s/iter; left time: 5677.2205s
	iters: 200, epoch: 9 | loss: 0.0204840
	speed: 0.1737s/iter; left time: 1757.9114s
	iters: 300, epoch: 9 | loss: 0.0046764
	speed: 0.1953s/iter; left time: 1956.3097s
	iters: 400, epoch: 9 | loss: 0.0013613
	speed: 0.2027s/iter; left time: 2010.2053s
Epoch: 9 cost time: 85.01422214508057
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0021949
	speed: 0.4321s/iter; left time: 4213.4098s
	iters: 200, epoch: 10 | loss: 0.0016309
	speed: 0.2173s/iter; left time: 2096.9338s
	iters: 300, epoch: 10 | loss: 0.0002654
	speed: 0.2278s/iter; left time: 2175.8267s
	iters: 400, epoch: 10 | loss: 0.0013589
	speed: 0.1876s/iter; left time: 1772.7991s
Epoch: 10 cost time: 102.01846528053284
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0005606
	speed: 0.6160s/iter; left time: 5717.1498s
	iters: 200, epoch: 11 | loss: 0.0410447
	speed: 0.2360s/iter; left time: 2166.9740s
	iters: 300, epoch: 11 | loss: 0.0028529
	speed: 0.2376s/iter; left time: 2157.3956s
	iters: 400, epoch: 11 | loss: 0.0004844
	speed: 0.2293s/iter; left time: 2059.7503s
Epoch: 11 cost time: 110.79680109024048
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0002454
	speed: 0.6194s/iter; left time: 5458.3671s
	iters: 200, epoch: 12 | loss: 0.0048140
	speed: 0.2393s/iter; left time: 2085.0753s
	iters: 300, epoch: 12 | loss: 0.0012271
	speed: 0.2256s/iter; left time: 1942.5062s
	iters: 400, epoch: 12 | loss: 0.0013394
	speed: 0.2471s/iter; left time: 2102.9830s
Epoch: 12 cost time: 110.37198233604431
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0003603
	speed: 0.5657s/iter; left time: 4719.3551s
	iters: 200, epoch: 13 | loss: 0.0005392
	speed: 0.1644s/iter; left time: 1355.0985s
	iters: 300, epoch: 13 | loss: 0.0014306
	speed: 0.2263s/iter; left time: 1842.6446s
	iters: 400, epoch: 13 | loss: 0.0014443
	speed: 0.2270s/iter; left time: 1825.7913s
Epoch: 13 cost time: 97.18034648895264
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0028578
	speed: 0.6066s/iter; left time: 4776.3101s
	iters: 200, epoch: 14 | loss: 0.0909162
	speed: 0.2178s/iter; left time: 1692.8413s
	iters: 300, epoch: 14 | loss: 0.0150158
	speed: 0.2474s/iter; left time: 1898.9222s
	iters: 400, epoch: 14 | loss: 0.0002075
	speed: 0.2537s/iter; left time: 1921.4641s
Epoch: 14 cost time: 111.54345989227295
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0045268
	speed: 0.6191s/iter; left time: 4584.7448s
	iters: 200, epoch: 15 | loss: 0.1199804
	speed: 0.2153s/iter; left time: 1572.6527s
	iters: 300, epoch: 15 | loss: 0.0028815
	speed: 0.2219s/iter; left time: 1598.5669s
	iters: 400, epoch: 15 | loss: 0.0557614
	speed: 0.2001s/iter; left time: 1421.4693s
Epoch: 15 cost time: 97.857994556427
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0017966
	speed: 0.4995s/iter; left time: 3464.5334s
	iters: 200, epoch: 16 | loss: 0.0007416
	speed: 0.1775s/iter; left time: 1213.5063s
	iters: 300, epoch: 16 | loss: 0.0014565
	speed: 0.0616s/iter; left time: 414.7249s
	iters: 400, epoch: 16 | loss: 0.0024324
	speed: 0.1027s/iter; left time: 681.5828s
Epoch: 16 cost time: 69.21510577201843
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0013516
	speed: 0.7517s/iter; left time: 4861.0345s
	iters: 200, epoch: 17 | loss: 0.0104151
	speed: 0.3128s/iter; left time: 1991.3942s
	iters: 300, epoch: 17 | loss: 0.0047002
	speed: 0.3121s/iter; left time: 1955.9993s
	iters: 400, epoch: 17 | loss: 0.0008517
	speed: 0.3106s/iter; left time: 1915.4346s
Epoch: 17 cost time: 145.54425573349
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0001953
	speed: 0.7326s/iter; left time: 4393.9367s
	iters: 200, epoch: 18 | loss: 0.0063283
	speed: 0.2920s/iter; left time: 1722.1504s
	iters: 300, epoch: 18 | loss: 0.0020120
	speed: 0.2918s/iter; left time: 1691.7407s
	iters: 400, epoch: 18 | loss: 0.0004007
	speed: 0.2918s/iter; left time: 1662.6399s
Epoch: 18 cost time: 134.73024892807007
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 294730
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9427347
	speed: 0.1692s/iter; left time: 2363.2687s
	iters: 200, epoch: 1 | loss: 1.4549646
	speed: 0.1777s/iter; left time: 2465.1699s
	iters: 300, epoch: 1 | loss: 0.8867011
	speed: 0.1807s/iter; left time: 2488.8554s
	iters: 400, epoch: 1 | loss: 0.4735295
	speed: 0.1055s/iter; left time: 1442.2263s
Epoch: 1 cost time: 76.56262683868408
Epoch: 1, Steps: 469 | Train Loss: 1.282 Vali Loss: 0.434 Vali Acc: 0.885 Test Loss: 0.434 Test Acc: 0.885
Validation loss decreased (inf --> -0.885073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1687826
	speed: 0.5867s/iter; left time: 7921.7048s
	iters: 200, epoch: 2 | loss: 0.1144322
	speed: 0.1905s/iter; left time: 2552.4976s
	iters: 300, epoch: 2 | loss: 0.2848910
	speed: 0.1899s/iter; left time: 2526.2014s
	iters: 400, epoch: 2 | loss: 0.1637454
	speed: 0.1866s/iter; left time: 2463.2642s
Epoch: 2 cost time: 88.0383358001709
Epoch: 2, Steps: 469 | Train Loss: 0.223 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.885073 --> -0.949112).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0469751
	speed: 0.5815s/iter; left time: 7578.9607s
	iters: 200, epoch: 3 | loss: 0.0241916
	speed: 0.1884s/iter; left time: 2436.6390s
	iters: 300, epoch: 3 | loss: 0.0499478
	speed: 0.1802s/iter; left time: 2312.1659s
	iters: 400, epoch: 3 | loss: 0.3143944
	speed: 0.1441s/iter; left time: 1834.5324s
Epoch: 3 cost time: 82.02116537094116
Epoch: 3, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.133 Vali Acc: 0.961 Test Loss: 0.133 Test Acc: 0.961
Validation loss decreased (-0.949112 --> -0.960833).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0218047
	speed: 0.5546s/iter; left time: 6968.5076s
	iters: 200, epoch: 4 | loss: 0.0599815
	speed: 0.1763s/iter; left time: 2197.9750s
	iters: 300, epoch: 4 | loss: 0.0212822
	speed: 0.1795s/iter; left time: 2219.9242s
	iters: 400, epoch: 4 | loss: 0.0637323
	speed: 0.1746s/iter; left time: 2141.3064s
Epoch: 4 cost time: 82.78654551506042
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.960833 --> -0.973698).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0187742
	speed: 0.5510s/iter; left time: 6663.8664s
	iters: 200, epoch: 5 | loss: 0.0360446
	speed: 0.1716s/iter; left time: 2058.2753s
	iters: 300, epoch: 5 | loss: 0.0146343
	speed: 0.1791s/iter; left time: 2129.8693s
	iters: 400, epoch: 5 | loss: 0.0122265
	speed: 0.1743s/iter; left time: 2056.3860s
Epoch: 5 cost time: 79.48870730400085
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0104215
	speed: 0.5589s/iter; left time: 6497.7291s
	iters: 200, epoch: 6 | loss: 0.0466023
	speed: 0.1853s/iter; left time: 2135.4382s
	iters: 300, epoch: 6 | loss: 0.2430363
	speed: 0.1926s/iter; left time: 2200.2014s
	iters: 400, epoch: 6 | loss: 0.0080902
	speed: 0.1907s/iter; left time: 2159.8085s
Epoch: 6 cost time: 88.84461736679077
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.973698 --> -0.976843).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0212292
	speed: 0.5916s/iter; left time: 6600.2321s
	iters: 200, epoch: 7 | loss: 0.0157143
	speed: 0.1842s/iter; left time: 2036.6553s
	iters: 300, epoch: 7 | loss: 0.0112593
	speed: 0.1884s/iter; left time: 2064.2594s
	iters: 400, epoch: 7 | loss: 0.0064266
	speed: 0.1890s/iter; left time: 2051.8900s
Epoch: 7 cost time: 88.09933137893677
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.976843 --> -0.981131).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0043695
	speed: 0.5638s/iter; left time: 6026.1525s
	iters: 200, epoch: 8 | loss: 0.0190638
	speed: 0.1718s/iter; left time: 1819.2386s
	iters: 300, epoch: 8 | loss: 0.0097463
	speed: 0.1807s/iter; left time: 1895.0209s
	iters: 400, epoch: 8 | loss: 0.0045279
	speed: 0.1794s/iter; left time: 1863.2667s
Epoch: 8 cost time: 83.36967921257019
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0090140
	speed: 0.5542s/iter; left time: 5663.1372s
	iters: 200, epoch: 9 | loss: 0.0042693
	speed: 0.1738s/iter; left time: 1758.7051s
	iters: 300, epoch: 9 | loss: 0.0989907
	speed: 0.1731s/iter; left time: 1734.1533s
	iters: 400, epoch: 9 | loss: 0.0504860
	speed: 0.1791s/iter; left time: 1776.2518s
Epoch: 9 cost time: 82.54063582420349
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.981131 --> -0.981989).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0056108
	speed: 0.5535s/iter; left time: 5396.9727s
	iters: 200, epoch: 10 | loss: 0.0003142
	speed: 0.1820s/iter; left time: 1756.0499s
	iters: 300, epoch: 10 | loss: 0.0056248
	speed: 0.1884s/iter; left time: 1799.3059s
	iters: 400, epoch: 10 | loss: 0.0018650
	speed: 0.1914s/iter; left time: 1808.6258s
Epoch: 10 cost time: 87.53505301475525
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0055153
	speed: 0.5922s/iter; left time: 5496.2697s
	iters: 200, epoch: 11 | loss: 0.0333587
	speed: 0.1852s/iter; left time: 1700.1910s
	iters: 300, epoch: 11 | loss: 0.0256304
	speed: 0.1821s/iter; left time: 1653.7576s
	iters: 400, epoch: 11 | loss: 0.3834493
	speed: 0.1264s/iter; left time: 1135.3362s
Epoch: 11 cost time: 81.26852989196777
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0004700
	speed: 0.5709s/iter; left time: 5031.0600s
	iters: 200, epoch: 12 | loss: 0.3648269
	speed: 0.1827s/iter; left time: 1591.4445s
	iters: 300, epoch: 12 | loss: 0.0012377
	speed: 0.1741s/iter; left time: 1499.0997s
	iters: 400, epoch: 12 | loss: 0.0014266
	speed: 0.1704s/iter; left time: 1450.0869s
Epoch: 12 cost time: 82.90058851242065
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0008526
	speed: 0.5427s/iter; left time: 4527.9537s
	iters: 200, epoch: 13 | loss: 0.0016453
	speed: 0.1689s/iter; left time: 1392.1164s
	iters: 300, epoch: 13 | loss: 0.0021286
	speed: 0.1679s/iter; left time: 1367.3991s
	iters: 400, epoch: 13 | loss: 0.0015948
	speed: 0.1704s/iter; left time: 1370.5979s
Epoch: 13 cost time: 79.84277582168579
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0277287
	speed: 0.5357s/iter; left time: 4218.1321s
	iters: 200, epoch: 14 | loss: 0.0027774
	speed: 0.1762s/iter; left time: 1369.5596s
	iters: 300, epoch: 14 | loss: 0.0042355
	speed: 0.1713s/iter; left time: 1314.3318s
	iters: 400, epoch: 14 | loss: 0.0008695
	speed: 0.1688s/iter; left time: 1278.7703s
Epoch: 14 cost time: 81.06259036064148
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0006709
	speed: 0.5192s/iter; left time: 3845.0306s
	iters: 200, epoch: 15 | loss: 0.0004498
	speed: 0.1846s/iter; left time: 1348.4380s
	iters: 300, epoch: 15 | loss: 0.0007480
	speed: 0.1855s/iter; left time: 1336.4855s
	iters: 400, epoch: 15 | loss: 0.0005504
	speed: 0.1817s/iter; left time: 1290.6938s
Epoch: 15 cost time: 84.90705847740173
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0137392
	speed: 0.5802s/iter; left time: 4024.2273s
	iters: 200, epoch: 16 | loss: 0.0017705
	speed: 0.1849s/iter; left time: 1264.0196s
	iters: 300, epoch: 16 | loss: 0.0008106
	speed: 0.1875s/iter; left time: 1263.1921s
	iters: 400, epoch: 16 | loss: 0.0008964
	speed: 0.1853s/iter; left time: 1229.4678s
Epoch: 16 cost time: 87.74046492576599
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0018228
	speed: 0.5731s/iter; left time: 3706.5453s
	iters: 200, epoch: 17 | loss: 0.0025695
	speed: 0.1705s/iter; left time: 1085.5390s
	iters: 300, epoch: 17 | loss: 0.0372625
	speed: 0.1793s/iter; left time: 1123.6757s
	iters: 400, epoch: 17 | loss: 0.0675549
	speed: 0.1677s/iter; left time: 1033.9639s
Epoch: 17 cost time: 82.466379404068
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0031039
	speed: 0.5528s/iter; left time: 3315.4389s
	iters: 200, epoch: 18 | loss: 0.0002972
	speed: 0.1720s/iter; left time: 1014.2389s
	iters: 300, epoch: 18 | loss: 0.0007482
	speed: 0.1791s/iter; left time: 1038.6039s
	iters: 400, epoch: 18 | loss: 0.0017000
	speed: 0.1712s/iter; left time: 975.2534s
Epoch: 18 cost time: 82.47105669975281
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0023643
	speed: 0.5606s/iter; left time: 3099.4601s
	iters: 200, epoch: 19 | loss: 0.0140793
	speed: 0.1725s/iter; left time: 936.6715s
	iters: 300, epoch: 19 | loss: 0.0037551
	speed: 0.1867s/iter; left time: 995.0413s
	iters: 400, epoch: 19 | loss: 0.0005902
	speed: 0.1817s/iter; left time: 950.1435s
Epoch: 19 cost time: 85.0533356666565
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 87754
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3648410
	speed: 0.2421s/iter; left time: 3382.1229s
	iters: 200, epoch: 1 | loss: 1.3096138
	speed: 0.2227s/iter; left time: 3088.8897s
	iters: 300, epoch: 1 | loss: 0.7153752
	speed: 0.2301s/iter; left time: 3169.3490s
	iters: 400, epoch: 1 | loss: 0.6722881
	speed: 0.2248s/iter; left time: 3073.8574s
Epoch: 1 cost time: 108.01595759391785
Epoch: 1, Steps: 469 | Train Loss: 1.237 Vali Loss: 0.399 Vali Acc: 0.885 Test Loss: 0.399 Test Acc: 0.885
Validation loss decreased (inf --> -0.885073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4638479
	speed: 0.5788s/iter; left time: 7815.5401s
	iters: 200, epoch: 2 | loss: 0.1683586
	speed: 0.1960s/iter; left time: 2627.2879s
	iters: 300, epoch: 2 | loss: 0.2144788
	speed: 0.2052s/iter; left time: 2729.5871s
	iters: 400, epoch: 2 | loss: 0.1990469
	speed: 0.1984s/iter; left time: 2619.9048s
Epoch: 2 cost time: 92.72374653816223
Epoch: 2, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
Validation loss decreased (-0.885073 --> -0.955973).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0806226
	speed: 0.5945s/iter; left time: 7748.4004s
	iters: 200, epoch: 3 | loss: 0.0233510
	speed: 0.2041s/iter; left time: 2639.5513s
	iters: 300, epoch: 3 | loss: 0.0200611
	speed: 0.2025s/iter; left time: 2598.0858s
	iters: 400, epoch: 3 | loss: 0.0186673
	speed: 0.2017s/iter; left time: 2568.0219s
Epoch: 3 cost time: 95.92711138725281
Epoch: 3, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (-0.955973 --> -0.959404).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0539492
	speed: 0.5774s/iter; left time: 7254.1022s
	iters: 200, epoch: 4 | loss: 0.0068816
	speed: 0.2065s/iter; left time: 2574.4123s
	iters: 300, epoch: 4 | loss: 0.0163271
	speed: 0.2110s/iter; left time: 2608.4260s
	iters: 400, epoch: 4 | loss: 0.1105719
	speed: 0.2173s/iter; left time: 2665.5349s
Epoch: 4 cost time: 97.1633083820343
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.959404 --> -0.973127).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0044825
	speed: 0.5625s/iter; left time: 6803.8163s
	iters: 200, epoch: 5 | loss: 0.0093016
	speed: 0.2303s/iter; left time: 2762.7927s
	iters: 300, epoch: 5 | loss: 0.0412574
	speed: 0.2249s/iter; left time: 2674.7052s
	iters: 400, epoch: 5 | loss: 0.0113574
	speed: 0.2275s/iter; left time: 2683.4782s
Epoch: 5 cost time: 99.69885277748108
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0794612
	speed: 0.6508s/iter; left time: 7566.6767s
	iters: 200, epoch: 6 | loss: 0.0141367
	speed: 0.1917s/iter; left time: 2209.7107s
	iters: 300, epoch: 6 | loss: 0.2127887
	speed: 0.2183s/iter; left time: 2494.0341s
	iters: 400, epoch: 6 | loss: 0.0158394
	speed: 0.1373s/iter; left time: 1555.5850s
Epoch: 6 cost time: 88.08240175247192
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.973127 --> -0.982847).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0733243
	speed: 0.5734s/iter; left time: 6397.8484s
	iters: 200, epoch: 7 | loss: 0.0063071
	speed: 0.2058s/iter; left time: 2275.0185s
	iters: 300, epoch: 7 | loss: 0.0066563
	speed: 0.2096s/iter; left time: 2296.6965s
	iters: 400, epoch: 7 | loss: 0.0012558
	speed: 0.2163s/iter; left time: 2348.7923s
Epoch: 7 cost time: 99.15398025512695
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0702948
	speed: 0.6013s/iter; left time: 6426.6379s
	iters: 200, epoch: 8 | loss: 0.0302755
	speed: 0.2214s/iter; left time: 2344.6369s
	iters: 300, epoch: 8 | loss: 0.0222642
	speed: 0.2207s/iter; left time: 2315.1573s
	iters: 400, epoch: 8 | loss: 0.0078605
	speed: 0.2251s/iter; left time: 2338.5301s
Epoch: 8 cost time: 102.03177261352539
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983133).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0040655
	speed: 0.6423s/iter; left time: 6563.8248s
	iters: 200, epoch: 9 | loss: 0.0444189
	speed: 0.2223s/iter; left time: 2249.0401s
	iters: 300, epoch: 9 | loss: 0.0087599
	speed: 0.2203s/iter; left time: 2206.8131s
	iters: 400, epoch: 9 | loss: 0.0009659
	speed: 0.2189s/iter; left time: 2171.1597s
Epoch: 9 cost time: 104.67817449569702
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0034587
	speed: 0.6430s/iter; left time: 6269.2231s
	iters: 200, epoch: 10 | loss: 0.0044069
	speed: 0.2103s/iter; left time: 2029.6770s
	iters: 300, epoch: 10 | loss: 0.0004894
	speed: 0.2191s/iter; left time: 2092.3276s
	iters: 400, epoch: 10 | loss: 0.0013894
	speed: 0.2080s/iter; left time: 1965.5056s
Epoch: 10 cost time: 100.55100750923157
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0029343
	speed: 0.6106s/iter; left time: 5667.0409s
	iters: 200, epoch: 11 | loss: 0.0411117
	speed: 0.2140s/iter; left time: 1964.7079s
	iters: 300, epoch: 11 | loss: 0.0015886
	speed: 0.2042s/iter; left time: 1854.1932s
	iters: 400, epoch: 11 | loss: 0.0004788
	speed: 0.2120s/iter; left time: 1904.3996s
Epoch: 11 cost time: 98.76223301887512
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0023000
	speed: 0.6053s/iter; left time: 5333.6775s
	iters: 200, epoch: 12 | loss: 0.0010499
	speed: 0.2133s/iter; left time: 1858.4292s
	iters: 300, epoch: 12 | loss: 0.0007000
	speed: 0.2210s/iter; left time: 1903.0532s
	iters: 400, epoch: 12 | loss: 0.0010661
	speed: 0.2257s/iter; left time: 1921.3360s
Epoch: 12 cost time: 101.75866723060608
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0018983
	speed: 0.6397s/iter; left time: 5337.0099s
	iters: 200, epoch: 13 | loss: 0.0003589
	speed: 0.2232s/iter; left time: 1839.6346s
	iters: 300, epoch: 13 | loss: 0.0015822
	speed: 0.2246s/iter; left time: 1828.6106s
	iters: 400, epoch: 13 | loss: 0.0034589
	speed: 0.2075s/iter; left time: 1668.6185s
Epoch: 13 cost time: 98.36999583244324
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0019723
	speed: 0.5601s/iter; left time: 4410.0097s
	iters: 200, epoch: 14 | loss: 0.1767545
	speed: 0.2104s/iter; left time: 1635.8302s
	iters: 300, epoch: 14 | loss: 0.0470792
	speed: 0.2011s/iter; left time: 1543.5315s
	iters: 400, epoch: 14 | loss: 0.0002794
	speed: 0.2059s/iter; left time: 1559.7388s
Epoch: 14 cost time: 97.26304817199707
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0083652
	speed: 0.5821s/iter; left time: 4310.4408s
	iters: 200, epoch: 15 | loss: 0.0051731
	speed: 0.1165s/iter; left time: 850.9593s
	iters: 300, epoch: 15 | loss: 0.0062186
	speed: 0.1358s/iter; left time: 978.3570s
	iters: 400, epoch: 15 | loss: 0.0808834
	speed: 0.2063s/iter; left time: 1465.8678s
Epoch: 15 cost time: 77.17167019844055
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0101485
	speed: 0.5468s/iter; left time: 3792.4947s
	iters: 200, epoch: 16 | loss: 0.0015261
	speed: 0.2138s/iter; left time: 1461.7081s
	iters: 300, epoch: 16 | loss: 0.0051436
	speed: 0.2079s/iter; left time: 1400.4165s
	iters: 400, epoch: 16 | loss: 0.0028775
	speed: 0.2255s/iter; left time: 1496.3844s
Epoch: 16 cost time: 100.73877930641174
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0008587
	speed: 0.6434s/iter; left time: 4160.8029s
	iters: 200, epoch: 17 | loss: 0.0961155
	speed: 0.2209s/iter; left time: 1406.5973s
	iters: 300, epoch: 17 | loss: 0.0032170
	speed: 0.2272s/iter; left time: 1423.8083s
	iters: 400, epoch: 17 | loss: 0.0009081
	speed: 0.2191s/iter; left time: 1350.9292s
Epoch: 17 cost time: 105.24673819541931
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000820
	speed: 0.6379s/iter; left time: 3825.8743s
	iters: 200, epoch: 18 | loss: 0.0067011
	speed: 0.2267s/iter; left time: 1336.8223s
	iters: 300, epoch: 18 | loss: 0.0040432
	speed: 0.2194s/iter; left time: 1272.3500s
	iters: 400, epoch: 18 | loss: 0.0005878
	speed: 0.2174s/iter; left time: 1238.7225s
Epoch: 18 cost time: 102.91387009620667
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 294730
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9431114
	speed: 0.1448s/iter; left time: 2022.3483s
	iters: 200, epoch: 1 | loss: 1.4574647
	speed: 0.1323s/iter; left time: 1835.6278s
	iters: 300, epoch: 1 | loss: 0.8937130
	speed: 0.1199s/iter; left time: 1651.7907s
	iters: 400, epoch: 1 | loss: 0.4802634
	speed: 0.1301s/iter; left time: 1778.1203s
Epoch: 1 cost time: 62.06858849525452
Epoch: 1, Steps: 469 | Train Loss: 1.286 Vali Loss: 0.440 Vali Acc: 0.886 Test Loss: 0.440 Test Acc: 0.886
Validation loss decreased (inf --> -0.886216).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1793115
	speed: 0.4588s/iter; left time: 6194.7639s
	iters: 200, epoch: 2 | loss: 0.1214658
	speed: 0.0824s/iter; left time: 1104.1954s
	iters: 300, epoch: 2 | loss: 0.3126216
	speed: 0.1250s/iter; left time: 1662.3978s
	iters: 400, epoch: 2 | loss: 0.1644460
	speed: 0.1262s/iter; left time: 1665.8269s
Epoch: 2 cost time: 53.54452085494995
Epoch: 2, Steps: 469 | Train Loss: 0.232 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (-0.886216 --> -0.948540).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0681943
	speed: 0.4513s/iter; left time: 5882.3694s
	iters: 200, epoch: 3 | loss: 0.0329713
	speed: 0.1322s/iter; left time: 1709.7067s
	iters: 300, epoch: 3 | loss: 0.0452244
	speed: 0.1199s/iter; left time: 1538.7892s
	iters: 400, epoch: 3 | loss: 0.3360585
	speed: 0.1344s/iter; left time: 1711.7485s
Epoch: 3 cost time: 61.43669152259827
Epoch: 3, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
Validation loss decreased (-0.948540 --> -0.960262).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0171182
	speed: 0.4754s/iter; left time: 5972.5694s
	iters: 200, epoch: 4 | loss: 0.0926922
	speed: 0.1336s/iter; left time: 1665.4171s
	iters: 300, epoch: 4 | loss: 0.0664531
	speed: 0.1285s/iter; left time: 1589.3088s
	iters: 400, epoch: 4 | loss: 0.0646098
	speed: 0.0848s/iter; left time: 1039.4734s
Epoch: 4 cost time: 56.442166566848755
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.960262 --> -0.974842).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0193096
	speed: 0.4653s/iter; left time: 5627.9173s
	iters: 200, epoch: 5 | loss: 0.0202815
	speed: 0.1344s/iter; left time: 1612.1752s
	iters: 300, epoch: 5 | loss: 0.0148274
	speed: 0.1364s/iter; left time: 1622.3159s
	iters: 400, epoch: 5 | loss: 0.0044788
	speed: 0.1391s/iter; left time: 1641.2742s
Epoch: 5 cost time: 64.17088532447815
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0051619
	speed: 0.4751s/iter; left time: 5523.4602s
	iters: 200, epoch: 6 | loss: 0.0678170
	speed: 0.1283s/iter; left time: 1478.2795s
	iters: 300, epoch: 6 | loss: 0.3460048
	speed: 0.1329s/iter; left time: 1518.5646s
	iters: 400, epoch: 6 | loss: 0.0083175
	speed: 0.1274s/iter; left time: 1443.1082s
Epoch: 6 cost time: 61.69985389709473
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0168931
	speed: 0.4610s/iter; left time: 5142.8511s
	iters: 200, epoch: 7 | loss: 0.0127888
	speed: 0.1287s/iter; left time: 1422.9300s
	iters: 300, epoch: 7 | loss: 0.0104786
	speed: 0.1317s/iter; left time: 1442.6864s
	iters: 400, epoch: 7 | loss: 0.0078983
	speed: 0.1306s/iter; left time: 1418.3843s
Epoch: 7 cost time: 61.28201627731323
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.975700 --> -0.981417).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0052441
	speed: 0.4702s/iter; left time: 5025.1285s
	iters: 200, epoch: 8 | loss: 0.0833505
	speed: 0.1330s/iter; left time: 1408.3139s
	iters: 300, epoch: 8 | loss: 0.0080007
	speed: 0.1241s/iter; left time: 1301.3613s
	iters: 400, epoch: 8 | loss: 0.0080317
	speed: 0.0900s/iter; left time: 935.0191s
Epoch: 8 cost time: 52.88766837120056
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0138594
	speed: 0.4103s/iter; left time: 4193.0801s
	iters: 200, epoch: 9 | loss: 0.0019082
	speed: 0.1306s/iter; left time: 1321.7350s
	iters: 300, epoch: 9 | loss: 0.1823322
	speed: 0.1301s/iter; left time: 1303.8895s
	iters: 400, epoch: 9 | loss: 0.1198051
	speed: 0.1279s/iter; left time: 1268.1569s
Epoch: 9 cost time: 60.84812641143799
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.981417 --> -0.983990).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0055967
	speed: 0.4648s/iter; left time: 4531.4846s
	iters: 200, epoch: 10 | loss: 0.0002554
	speed: 0.1016s/iter; left time: 980.8203s
	iters: 300, epoch: 10 | loss: 0.0033927
	speed: 0.0953s/iter; left time: 910.4660s
	iters: 400, epoch: 10 | loss: 0.0039438
	speed: 0.1402s/iter; left time: 1324.6614s
Epoch: 10 cost time: 56.89636969566345
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0087597
	speed: 0.4971s/iter; left time: 4613.8344s
	iters: 200, epoch: 11 | loss: 0.0126348
	speed: 0.1423s/iter; left time: 1306.7782s
	iters: 300, epoch: 11 | loss: 0.0039240
	speed: 0.1390s/iter; left time: 1262.2651s
	iters: 400, epoch: 11 | loss: 0.2920990
	speed: 0.1397s/iter; left time: 1254.2604s
Epoch: 11 cost time: 66.64281177520752
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0006324
	speed: 0.4836s/iter; left time: 4261.1107s
	iters: 200, epoch: 12 | loss: 0.3694106
	speed: 0.1369s/iter; left time: 1192.7610s
	iters: 300, epoch: 12 | loss: 0.0006968
	speed: 0.1281s/iter; left time: 1102.9978s
	iters: 400, epoch: 12 | loss: 0.0010967
	speed: 0.1336s/iter; left time: 1137.2632s
Epoch: 12 cost time: 62.96119976043701
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0022769
	speed: 0.4747s/iter; left time: 3960.1055s
	iters: 200, epoch: 13 | loss: 0.0016080
	speed: 0.1368s/iter; left time: 1127.8861s
	iters: 300, epoch: 13 | loss: 0.0027499
	speed: 0.1357s/iter; left time: 1104.7408s
	iters: 400, epoch: 13 | loss: 0.0006947
	speed: 0.1311s/iter; left time: 1054.8248s
Epoch: 13 cost time: 63.53226041793823
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0150816
	speed: 0.4796s/iter; left time: 3776.4699s
	iters: 200, epoch: 14 | loss: 0.0055242
	speed: 0.1369s/iter; left time: 1064.5218s
	iters: 300, epoch: 14 | loss: 0.0013971
	speed: 0.1324s/iter; left time: 1016.0418s
	iters: 400, epoch: 14 | loss: 0.0007730
	speed: 0.1314s/iter; left time: 995.2112s
Epoch: 14 cost time: 62.442365646362305
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0014785
	speed: 0.4917s/iter; left time: 3640.7479s
	iters: 200, epoch: 15 | loss: 0.0004501
	speed: 0.1421s/iter; left time: 1038.2027s
	iters: 300, epoch: 15 | loss: 0.0017771
	speed: 0.1433s/iter; left time: 1032.7529s
	iters: 400, epoch: 15 | loss: 0.0002644
	speed: 0.1395s/iter; left time: 991.3545s
Epoch: 15 cost time: 66.38821578025818
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0387523
	speed: 0.4977s/iter; left time: 3451.7077s
	iters: 200, epoch: 16 | loss: 0.0035692
	speed: 0.1362s/iter; left time: 930.8303s
	iters: 300, epoch: 16 | loss: 0.0008762
	speed: 0.1425s/iter; left time: 959.8774s
	iters: 400, epoch: 16 | loss: 0.0080604
	speed: 0.1408s/iter; left time: 934.1698s
Epoch: 16 cost time: 64.63103580474854
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0192925
	speed: 0.4219s/iter; left time: 2728.6348s
	iters: 200, epoch: 17 | loss: 0.0003948
	speed: 0.1347s/iter; left time: 857.8635s
	iters: 300, epoch: 17 | loss: 0.0005601
	speed: 0.1382s/iter; left time: 866.2686s
	iters: 400, epoch: 17 | loss: 0.0349536
	speed: 0.1326s/iter; left time: 817.7846s
Epoch: 17 cost time: 61.45880579948425
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0043773
	speed: 0.4617s/iter; left time: 2769.4440s
	iters: 200, epoch: 18 | loss: 0.0008539
	speed: 0.1303s/iter; left time: 768.7839s
	iters: 300, epoch: 18 | loss: 0.0009153
	speed: 0.1274s/iter; left time: 738.7896s
	iters: 400, epoch: 18 | loss: 0.0286048
	speed: 0.1208s/iter; left time: 688.1865s
Epoch: 18 cost time: 59.43617272377014
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0006024
	speed: 0.4602s/iter; left time: 2544.4683s
	iters: 200, epoch: 19 | loss: 0.0199227
	speed: 0.1308s/iter; left time: 710.0547s
	iters: 300, epoch: 19 | loss: 0.0141880
	speed: 0.1269s/iter; left time: 676.0945s
	iters: 400, epoch: 19 | loss: 0.0005645
	speed: 0.1339s/iter; left time: 700.2068s
Epoch: 19 cost time: 60.651342153549194
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 87754
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.3746529
	speed: 0.1029s/iter; left time: 1437.9552s
	iters: 200, epoch: 1 | loss: 1.3866793
	speed: 0.0783s/iter; left time: 1086.3933s
	iters: 300, epoch: 1 | loss: 0.8550605
	speed: 0.1361s/iter; left time: 1874.6819s
	iters: 400, epoch: 1 | loss: 0.7514319
	speed: 0.1404s/iter; left time: 1919.4144s
Epoch: 1 cost time: 55.04822611808777
Epoch: 1, Steps: 469 | Train Loss: 1.298 Vali Loss: 0.486 Vali Acc: 0.861 Test Loss: 0.486 Test Acc: 0.861
Validation loss decreased (inf --> -0.860773).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5608873
	speed: 0.4906s/iter; left time: 6623.9885s
	iters: 200, epoch: 2 | loss: 0.2303044
	speed: 0.1425s/iter; left time: 1909.1953s
	iters: 300, epoch: 2 | loss: 0.2727691
	speed: 0.1399s/iter; left time: 1860.5652s
	iters: 400, epoch: 2 | loss: 0.2422240
	speed: 0.1339s/iter; left time: 1767.3644s
Epoch: 2 cost time: 64.66391825675964
Epoch: 2, Steps: 469 | Train Loss: 0.255 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.860773 --> -0.947683).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1691871
	speed: 0.4851s/iter; left time: 6321.7171s
	iters: 200, epoch: 3 | loss: 0.0369587
	speed: 0.1399s/iter; left time: 1808.9598s
	iters: 300, epoch: 3 | loss: 0.0198429
	speed: 0.1346s/iter; left time: 1726.8758s
	iters: 400, epoch: 3 | loss: 0.0312329
	speed: 0.1280s/iter; left time: 1629.6372s
Epoch: 3 cost time: 59.1744384765625
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
Validation loss decreased (-0.947683 --> -0.959976).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0470163
	speed: 0.4182s/iter; left time: 5253.6993s
	iters: 200, epoch: 4 | loss: 0.0140459
	speed: 0.1321s/iter; left time: 1646.1102s
	iters: 300, epoch: 4 | loss: 0.0506369
	speed: 0.1338s/iter; left time: 1654.9090s
	iters: 400, epoch: 4 | loss: 0.1094496
	speed: 0.1272s/iter; left time: 1560.4325s
Epoch: 4 cost time: 62.69915556907654
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (-0.959976 --> -0.969410).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0180386
	speed: 0.4672s/iter; left time: 5650.7053s
	iters: 200, epoch: 5 | loss: 0.0076512
	speed: 0.1300s/iter; left time: 1559.5737s
	iters: 300, epoch: 5 | loss: 0.0369967
	speed: 0.1258s/iter; left time: 1496.2942s
	iters: 400, epoch: 5 | loss: 0.0051777
	speed: 0.1282s/iter; left time: 1511.6658s
Epoch: 5 cost time: 60.53222060203552
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.971697).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1595662
	speed: 0.5960s/iter; left time: 6928.6822s
	iters: 200, epoch: 6 | loss: 0.0339942
	speed: 0.1918s/iter; left time: 2210.5812s
	iters: 300, epoch: 6 | loss: 0.1906800
	speed: 0.1857s/iter; left time: 2122.0251s
	iters: 400, epoch: 6 | loss: 0.0799939
	speed: 0.1590s/iter; left time: 1800.4469s
Epoch: 6 cost time: 83.6694085597992
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.971697 --> -0.976843).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0719838
	speed: 0.6316s/iter; left time: 7046.5668s
	iters: 200, epoch: 7 | loss: 0.0193769
	speed: 0.1825s/iter; left time: 2018.3186s
	iters: 300, epoch: 7 | loss: 0.0489460
	speed: 0.1827s/iter; left time: 2002.1637s
	iters: 400, epoch: 7 | loss: 0.0089318
	speed: 0.1894s/iter; left time: 2055.9082s
Epoch: 7 cost time: 86.93350601196289
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.978273).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0292667
	speed: 0.6711s/iter; left time: 7173.2316s
	iters: 200, epoch: 8 | loss: 0.1606306
	speed: 0.1845s/iter; left time: 1952.9762s
	iters: 300, epoch: 8 | loss: 0.0241905
	speed: 0.1884s/iter; left time: 1976.0761s
	iters: 400, epoch: 8 | loss: 0.0245963
	speed: 0.1927s/iter; left time: 2001.6880s
Epoch: 8 cost time: 88.71573424339294
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.978273 --> -0.980845).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0155285
	speed: 0.6561s/iter; left time: 6704.4711s
	iters: 200, epoch: 9 | loss: 0.1621147
	speed: 0.1530s/iter; left time: 1548.1227s
	iters: 300, epoch: 9 | loss: 0.0055754
	speed: 0.1960s/iter; left time: 1963.2697s
	iters: 400, epoch: 9 | loss: 0.0009830
	speed: 0.1910s/iter; left time: 1894.9624s
Epoch: 9 cost time: 85.32467293739319
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0073706
	speed: 0.6779s/iter; left time: 6609.8019s
	iters: 200, epoch: 10 | loss: 0.0027989
	speed: 0.1961s/iter; left time: 1892.0692s
	iters: 300, epoch: 10 | loss: 0.0017075
	speed: 0.1888s/iter; left time: 1803.3369s
	iters: 400, epoch: 10 | loss: 0.0037815
	speed: 0.1843s/iter; left time: 1741.7257s
Epoch: 10 cost time: 89.19442319869995
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0215052
	speed: 0.6654s/iter; left time: 6175.5649s
	iters: 200, epoch: 11 | loss: 0.0166858
	speed: 0.1836s/iter; left time: 1685.8716s
	iters: 300, epoch: 11 | loss: 0.0123915
	speed: 0.1855s/iter; left time: 1684.3066s
	iters: 400, epoch: 11 | loss: 0.0010805
	speed: 0.1866s/iter; left time: 1675.9763s
Epoch: 11 cost time: 87.68357682228088
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0017074
	speed: 0.6590s/iter; left time: 5806.7853s
	iters: 200, epoch: 12 | loss: 0.0016594
	speed: 0.1852s/iter; left time: 1613.0839s
	iters: 300, epoch: 12 | loss: 0.0025688
	speed: 0.1889s/iter; left time: 1626.4320s
	iters: 400, epoch: 12 | loss: 0.0014589
	speed: 0.1867s/iter; left time: 1589.5299s
Epoch: 12 cost time: 86.06749868392944
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0058212
	speed: 0.5967s/iter; left time: 4978.1794s
	iters: 200, epoch: 13 | loss: 0.0026717
	speed: 0.1305s/iter; left time: 1075.3914s
	iters: 300, epoch: 13 | loss: 0.0045794
	speed: 0.1658s/iter; left time: 1350.1976s
	iters: 400, epoch: 13 | loss: 0.0029665
	speed: 0.1876s/iter; left time: 1508.7326s
Epoch: 13 cost time: 79.49369740486145
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0086345
	speed: 0.6593s/iter; left time: 5190.9609s
	iters: 200, epoch: 14 | loss: 0.0438953
	speed: 0.1768s/iter; left time: 1374.5803s
	iters: 300, epoch: 14 | loss: 0.0023404
	speed: 0.1798s/iter; left time: 1379.5560s
	iters: 400, epoch: 14 | loss: 0.0021616
	speed: 0.1429s/iter; left time: 1082.5074s
Epoch: 14 cost time: 80.37851643562317
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0314183
	speed: 0.6615s/iter; left time: 4898.1248s
	iters: 200, epoch: 15 | loss: 0.0142713
	speed: 0.1869s/iter; left time: 1365.0415s
	iters: 300, epoch: 15 | loss: 0.0044233
	speed: 0.1888s/iter; left time: 1360.1891s
	iters: 400, epoch: 15 | loss: 0.0491905
	speed: 0.1843s/iter; left time: 1309.1824s
Epoch: 15 cost time: 88.4340980052948
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.982275).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0022136
	speed: 0.6759s/iter; left time: 4688.3765s
	iters: 200, epoch: 16 | loss: 0.0027127
	speed: 0.1932s/iter; left time: 1320.9507s
	iters: 300, epoch: 16 | loss: 0.0011539
	speed: 0.1936s/iter; left time: 1304.0916s
	iters: 400, epoch: 16 | loss: 0.0026419
	speed: 0.1861s/iter; left time: 1235.0896s
Epoch: 16 cost time: 90.4528157711029
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0030780
	speed: 0.6602s/iter; left time: 4269.7818s
	iters: 200, epoch: 17 | loss: 0.0690152
	speed: 0.1878s/iter; left time: 1195.5454s
	iters: 300, epoch: 17 | loss: 0.0050163
	speed: 0.1912s/iter; left time: 1198.3389s
	iters: 400, epoch: 17 | loss: 0.0011203
	speed: 0.1875s/iter; left time: 1156.3650s
Epoch: 17 cost time: 88.39697456359863
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001540
	speed: 0.6686s/iter; left time: 4010.2885s
	iters: 200, epoch: 18 | loss: 0.0017466
	speed: 0.1850s/iter; left time: 1091.0099s
	iters: 300, epoch: 18 | loss: 0.0035698
	speed: 0.1902s/iter; left time: 1102.5785s
	iters: 400, epoch: 18 | loss: 0.0014215
	speed: 0.1886s/iter; left time: 1074.5716s
Epoch: 18 cost time: 88.7752013206482
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0036196
	speed: 0.6160s/iter; left time: 3405.9741s
	iters: 200, epoch: 19 | loss: 0.0007045
	speed: 0.1781s/iter; left time: 966.8788s
	iters: 300, epoch: 19 | loss: 0.0007003
	speed: 0.1833s/iter; left time: 976.5963s
	iters: 400, epoch: 19 | loss: 0.0006312
	speed: 0.1865s/iter; left time: 975.4107s
Epoch: 19 cost time: 86.08679795265198
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0016647
	speed: 0.6671s/iter; left time: 3375.3693s
	iters: 200, epoch: 20 | loss: 0.0004928
	speed: 0.1861s/iter; left time: 922.8224s
	iters: 300, epoch: 20 | loss: 0.0268331
	speed: 0.1853s/iter; left time: 900.4081s
	iters: 400, epoch: 20 | loss: 0.0016934
	speed: 0.1876s/iter; left time: 893.1594s
Epoch: 20 cost time: 87.72087168693542
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.982275 --> -0.983704).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0955700
	speed: 0.6319s/iter; left time: 2900.9120s
	iters: 200, epoch: 21 | loss: 0.0080519
	speed: 0.1904s/iter; left time: 855.2636s
	iters: 300, epoch: 21 | loss: 0.0030572
	speed: 0.1955s/iter; left time: 858.3168s
	iters: 400, epoch: 21 | loss: 0.0030728
	speed: 0.1898s/iter; left time: 814.5299s
Epoch: 21 cost time: 89.84520173072815
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0136570
	speed: 0.6823s/iter; left time: 2812.3835s
	iters: 200, epoch: 22 | loss: 0.0068034
	speed: 0.1961s/iter; left time: 788.7192s
	iters: 300, epoch: 22 | loss: 0.0155568
	speed: 0.1900s/iter; left time: 745.2315s
	iters: 400, epoch: 22 | loss: 0.1885749
	speed: 0.1874s/iter; left time: 716.2147s
Epoch: 22 cost time: 89.88960194587708
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0024869
	speed: 0.6611s/iter; left time: 2415.1300s
	iters: 200, epoch: 23 | loss: 0.0049322
	speed: 0.1903s/iter; left time: 676.1075s
	iters: 300, epoch: 23 | loss: 0.0008095
	speed: 0.1853s/iter; left time: 639.6890s
	iters: 400, epoch: 23 | loss: 0.0029856
	speed: 0.1902s/iter; left time: 637.8148s
Epoch: 23 cost time: 88.1989517211914
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0005330
	speed: 0.6616s/iter; left time: 2106.6887s
	iters: 200, epoch: 24 | loss: 0.1627322
	speed: 0.1749s/iter; left time: 539.2678s
	iters: 300, epoch: 24 | loss: 0.0005157
	speed: 0.1301s/iter; left time: 388.1260s
	iters: 400, epoch: 24 | loss: 0.0004905
	speed: 0.1758s/iter; left time: 506.9100s
Epoch: 24 cost time: 79.07716822624207
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0007740
	speed: 0.6209s/iter; left time: 1685.7912s
	iters: 200, epoch: 25 | loss: 0.0000485
	speed: 0.1701s/iter; left time: 444.9039s
	iters: 300, epoch: 25 | loss: 0.0001428
	speed: 0.1745s/iter; left time: 438.8260s
	iters: 400, epoch: 25 | loss: 0.0002914
	speed: 0.1784s/iter; left time: 430.7819s
Epoch: 25 cost time: 82.60542917251587
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0005617
	speed: 0.6210s/iter; left time: 1394.7882s
	iters: 200, epoch: 26 | loss: 0.0024166
	speed: 0.1737s/iter; left time: 372.7011s
	iters: 300, epoch: 26 | loss: 0.0026582
	speed: 0.1883s/iter; left time: 385.3151s
	iters: 400, epoch: 26 | loss: 0.0049070
	speed: 0.1863s/iter; left time: 362.6189s
Epoch: 26 cost time: 83.98392033576965
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0003586
	speed: 0.6738s/iter; left time: 1197.3705s
	iters: 200, epoch: 27 | loss: 0.0008021
	speed: 0.1897s/iter; left time: 318.1691s
	iters: 300, epoch: 27 | loss: 0.0002010
	speed: 0.1916s/iter; left time: 302.1575s
	iters: 400, epoch: 27 | loss: 0.0006026
	speed: 0.1901s/iter; left time: 280.7910s
Epoch: 27 cost time: 89.32559776306152
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0003367
	speed: 0.6698s/iter; left time: 876.1552s
	iters: 200, epoch: 28 | loss: 0.2821271
	speed: 0.1907s/iter; left time: 230.3392s
	iters: 300, epoch: 28 | loss: 0.0034075
	speed: 0.1740s/iter; left time: 192.7766s
	iters: 400, epoch: 28 | loss: 0.0024081
	speed: 0.1499s/iter; left time: 151.1370s
Epoch: 28 cost time: 82.82646226882935
Epoch: 28, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0024597
	speed: 0.6089s/iter; left time: 510.8624s
	iters: 200, epoch: 29 | loss: 0.0000870
	speed: 0.1706s/iter; left time: 126.0989s
	iters: 300, epoch: 29 | loss: 0.0009917
	speed: 0.1719s/iter; left time: 109.8750s
	iters: 400, epoch: 29 | loss: 0.0009203
	speed: 0.1319s/iter; left time: 71.0738s
Epoch: 29 cost time: 73.99838495254517
Epoch: 29, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0373495
	speed: 0.5585s/iter; left time: 206.6321s
	iters: 200, epoch: 30 | loss: 0.0003228
	speed: 0.1843s/iter; left time: 49.7679s
	iters: 300, epoch: 30 | loss: 0.0002101
	speed: 0.1816s/iter; left time: 30.8778s
	iters: 400, epoch: 30 | loss: 0.0000982
	speed: 0.1806s/iter; left time: 12.6443s
Epoch: 30 cost time: 85.01341462135315
Epoch: 30, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 294730
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.9705428
	speed: 0.1447s/iter; left time: 2022.0683s
	iters: 200, epoch: 1 | loss: 1.5427725
	speed: 0.1311s/iter; left time: 1818.3251s
	iters: 300, epoch: 1 | loss: 0.9932796
	speed: 0.1328s/iter; left time: 1828.4714s
	iters: 400, epoch: 1 | loss: 0.5122244
	speed: 0.1283s/iter; left time: 1753.4632s
Epoch: 1 cost time: 63.03367805480957
Epoch: 1, Steps: 469 | Train Loss: 1.366 Vali Loss: 0.549 Vali Acc: 0.842 Test Loss: 0.549 Test Acc: 0.842
Validation loss decreased (inf --> -0.842190).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3178405
	speed: 0.5696s/iter; left time: 7691.2557s
	iters: 200, epoch: 2 | loss: 0.1953681
	speed: 0.1314s/iter; left time: 1761.4823s
	iters: 300, epoch: 2 | loss: 0.2939155
	speed: 0.1317s/iter; left time: 1751.4834s
	iters: 400, epoch: 2 | loss: 0.2391908
	speed: 0.1361s/iter; left time: 1797.2491s
Epoch: 2 cost time: 61.98144268989563
Epoch: 2, Steps: 469 | Train Loss: 0.301 Vali Loss: 0.236 Vali Acc: 0.934 Test Loss: 0.236 Test Acc: 0.934
Validation loss decreased (-0.842190 --> -0.933674).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1422073
	speed: 0.5670s/iter; left time: 7390.0985s
	iters: 200, epoch: 3 | loss: 0.0694155
	speed: 0.1294s/iter; left time: 1673.1130s
	iters: 300, epoch: 3 | loss: 0.0597584
	speed: 0.1094s/iter; left time: 1403.3193s
	iters: 400, epoch: 3 | loss: 0.3190282
	speed: 0.1061s/iter; left time: 1351.5937s
Epoch: 3 cost time: 57.1847186088562
Epoch: 3, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.933674 --> -0.965407).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0383890
	speed: 0.5410s/iter; left time: 6796.9343s
	iters: 200, epoch: 4 | loss: 0.1062083
	speed: 0.1271s/iter; left time: 1584.2770s
	iters: 300, epoch: 4 | loss: 0.1529868
	speed: 0.1277s/iter; left time: 1579.3208s
	iters: 400, epoch: 4 | loss: 0.1276218
	speed: 0.1276s/iter; left time: 1565.4352s
Epoch: 4 cost time: 59.413957834243774
Epoch: 4, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.965407 --> -0.975699).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0274032
	speed: 0.5321s/iter; left time: 6436.0397s
	iters: 200, epoch: 5 | loss: 0.0214535
	speed: 0.1135s/iter; left time: 1361.2774s
	iters: 300, epoch: 5 | loss: 0.0112383
	speed: 0.1161s/iter; left time: 1380.6503s
	iters: 400, epoch: 5 | loss: 0.0072989
	speed: 0.1189s/iter; left time: 1402.5674s
Epoch: 5 cost time: 54.366673707962036
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0110445
	speed: 0.4820s/iter; left time: 5604.2775s
	iters: 200, epoch: 6 | loss: 0.0326621
	speed: 0.1186s/iter; left time: 1366.7362s
	iters: 300, epoch: 6 | loss: 0.3413108
	speed: 0.1267s/iter; left time: 1447.4570s
	iters: 400, epoch: 6 | loss: 0.0196673
	speed: 0.1170s/iter; left time: 1324.7488s
Epoch: 6 cost time: 57.57654404640198
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.975700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0083715
	speed: 0.5318s/iter; left time: 5933.8453s
	iters: 200, epoch: 7 | loss: 0.0218154
	speed: 0.1185s/iter; left time: 1310.5969s
	iters: 300, epoch: 7 | loss: 0.0165015
	speed: 0.1243s/iter; left time: 1362.2908s
	iters: 400, epoch: 7 | loss: 0.0110228
	speed: 0.1242s/iter; left time: 1348.0173s
Epoch: 7 cost time: 58.42764973640442
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.975700 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0043758
	speed: 0.5442s/iter; left time: 5816.7255s
	iters: 200, epoch: 8 | loss: 0.1201238
	speed: 0.1273s/iter; left time: 1347.5931s
	iters: 300, epoch: 8 | loss: 0.0108746
	speed: 0.1257s/iter; left time: 1317.9511s
	iters: 400, epoch: 8 | loss: 0.0125373
	speed: 0.1250s/iter; left time: 1299.0167s
Epoch: 8 cost time: 59.66764497756958
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977987).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0093362
	speed: 0.5091s/iter; left time: 5202.4890s
	iters: 200, epoch: 9 | loss: 0.0160079
	speed: 0.1184s/iter; left time: 1197.8080s
	iters: 300, epoch: 9 | loss: 0.2104146
	speed: 0.1255s/iter; left time: 1257.8511s
	iters: 400, epoch: 9 | loss: 0.0911830
	speed: 0.1260s/iter; left time: 1249.4141s
Epoch: 9 cost time: 55.221004009246826
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.977987 --> -0.985134).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0102302
	speed: 0.5342s/iter; left time: 5208.7431s
	iters: 200, epoch: 10 | loss: 0.0004490
	speed: 0.1236s/iter; left time: 1192.6721s
	iters: 300, epoch: 10 | loss: 0.0039538
	speed: 0.1208s/iter; left time: 1153.4185s
	iters: 400, epoch: 10 | loss: 0.0043604
	speed: 0.1226s/iter; left time: 1158.7454s
Epoch: 10 cost time: 58.31205105781555
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0229545
	speed: 0.5024s/iter; left time: 4663.0988s
	iters: 200, epoch: 11 | loss: 0.1297632
	speed: 0.1259s/iter; left time: 1156.0614s
	iters: 300, epoch: 11 | loss: 0.0031128
	speed: 0.0889s/iter; left time: 807.5251s
	iters: 400, epoch: 11 | loss: 0.1648170
	speed: 0.1107s/iter; left time: 994.4235s
Epoch: 11 cost time: 54.007237911224365
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007301
	speed: 0.5602s/iter; left time: 4936.4770s
	iters: 200, epoch: 12 | loss: 0.4580604
	speed: 0.1292s/iter; left time: 1125.2625s
	iters: 300, epoch: 12 | loss: 0.0016326
	speed: 0.1292s/iter; left time: 1112.6971s
	iters: 400, epoch: 12 | loss: 0.0125553
	speed: 0.1303s/iter; left time: 1109.2373s
Epoch: 12 cost time: 61.31954383850098
Epoch: 12, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0025945
	speed: 0.5301s/iter; left time: 4422.7526s
	iters: 200, epoch: 13 | loss: 0.0008983
	speed: 0.0964s/iter; left time: 794.7130s
	iters: 300, epoch: 13 | loss: 0.0044493
	speed: 0.1143s/iter; left time: 931.0256s
	iters: 400, epoch: 13 | loss: 0.0030357
	speed: 0.1173s/iter; left time: 943.5519s
Epoch: 13 cost time: 52.42352867126465
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0133850
	speed: 0.5126s/iter; left time: 4036.5801s
	iters: 200, epoch: 14 | loss: 0.0040581
	speed: 0.1206s/iter; left time: 937.8534s
	iters: 300, epoch: 14 | loss: 0.0105234
	speed: 0.1148s/iter; left time: 880.6840s
	iters: 400, epoch: 14 | loss: 0.0009434
	speed: 0.0995s/iter; left time: 753.4425s
Epoch: 14 cost time: 52.25379705429077
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0013128
	speed: 0.5413s/iter; left time: 4007.9645s
	iters: 200, epoch: 15 | loss: 0.0036348
	speed: 0.1316s/iter; left time: 961.5979s
	iters: 300, epoch: 15 | loss: 0.0010278
	speed: 0.1289s/iter; left time: 928.6183s
	iters: 400, epoch: 15 | loss: 0.0007688
	speed: 0.1345s/iter; left time: 955.5934s
Epoch: 15 cost time: 62.36160111427307
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0028820
	speed: 0.5679s/iter; left time: 3938.9302s
	iters: 200, epoch: 16 | loss: 0.0321714
	speed: 0.1304s/iter; left time: 891.5894s
	iters: 300, epoch: 16 | loss: 0.0023136
	speed: 0.1340s/iter; left time: 902.7088s
	iters: 400, epoch: 16 | loss: 0.0241131
	speed: 0.1276s/iter; left time: 846.5003s
Epoch: 16 cost time: 61.262195348739624
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0020410
	speed: 0.5748s/iter; left time: 3716.9586s
	iters: 200, epoch: 17 | loss: 0.0006498
	speed: 0.1349s/iter; left time: 858.8937s
	iters: 300, epoch: 17 | loss: 0.0037869
	speed: 0.1347s/iter; left time: 844.1165s
	iters: 400, epoch: 17 | loss: 0.0028070
	speed: 0.1395s/iter; left time: 860.5586s
Epoch: 17 cost time: 64.46445512771606
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0590028
	speed: 0.5722s/iter; left time: 3432.1152s
	iters: 200, epoch: 18 | loss: 0.0006873
	speed: 0.1340s/iter; left time: 790.2438s
	iters: 300, epoch: 18 | loss: 0.0016486
	speed: 0.1317s/iter; left time: 763.5516s
	iters: 400, epoch: 18 | loss: 0.0011138
	speed: 0.1263s/iter; left time: 719.5031s
Epoch: 18 cost time: 61.47773003578186
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0045042
	speed: 0.5689s/iter; left time: 3145.3941s
	iters: 200, epoch: 19 | loss: 0.0221632
	speed: 0.1293s/iter; left time: 701.8534s
	iters: 300, epoch: 19 | loss: 0.0023108
	speed: 0.1335s/iter; left time: 711.5494s
	iters: 400, epoch: 19 | loss: 0.0006841
	speed: 0.1331s/iter; left time: 695.9726s
Epoch: 19 cost time: 62.150639295578
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 87754
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1428022
	speed: 0.2208s/iter; left time: 3084.2241s
	iters: 200, epoch: 1 | loss: 1.3918048
	speed: 0.2086s/iter; left time: 2893.0514s
	iters: 300, epoch: 1 | loss: 1.2545550
	speed: 0.2081s/iter; left time: 2865.9822s
	iters: 400, epoch: 1 | loss: 0.5884458
	speed: 0.2120s/iter; left time: 2898.1715s
Epoch: 1 cost time: 99.33306908607483
Epoch: 1, Steps: 469 | Train Loss: 1.368 Vali Loss: 0.484 Vali Acc: 0.885 Test Loss: 0.484 Test Acc: 0.885
Validation loss decreased (inf --> -0.884501).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4743912
	speed: 0.6640s/iter; left time: 8965.2901s
	iters: 200, epoch: 2 | loss: 0.1541198
	speed: 0.2010s/iter; left time: 2694.1152s
	iters: 300, epoch: 2 | loss: 0.4527145
	speed: 0.2002s/iter; left time: 2662.4944s
	iters: 400, epoch: 2 | loss: 0.3097766
	speed: 0.2022s/iter; left time: 2669.1095s
Epoch: 2 cost time: 94.48513412475586
Epoch: 2, Steps: 469 | Train Loss: 0.278 Vali Loss: 0.212 Vali Acc: 0.947 Test Loss: 0.212 Test Acc: 0.947
Validation loss decreased (-0.884501 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1509151
	speed: 0.6894s/iter; left time: 8985.0495s
	iters: 200, epoch: 3 | loss: 0.0884578
	speed: 0.2048s/iter; left time: 2648.2669s
	iters: 300, epoch: 3 | loss: 0.0527803
	speed: 0.2015s/iter; left time: 2585.7942s
	iters: 400, epoch: 3 | loss: 0.0330915
	speed: 0.2018s/iter; left time: 2569.0647s
Epoch: 3 cost time: 94.52808952331543
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.946825 --> -0.949398).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0138363
	speed: 0.6461s/iter; left time: 8117.0365s
	iters: 200, epoch: 4 | loss: 0.0187043
	speed: 0.2091s/iter; left time: 2605.6040s
	iters: 300, epoch: 4 | loss: 0.0196848
	speed: 0.2076s/iter; left time: 2567.1964s
	iters: 400, epoch: 4 | loss: 0.0310487
	speed: 0.2102s/iter; left time: 2578.4648s
Epoch: 4 cost time: 97.7535412311554
Epoch: 4, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.949398 --> -0.968266).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0132826
	speed: 0.7075s/iter; left time: 8557.2801s
	iters: 200, epoch: 5 | loss: 0.0771792
	speed: 0.2061s/iter; left time: 2472.3075s
	iters: 300, epoch: 5 | loss: 0.0172599
	speed: 0.1933s/iter; left time: 2299.4760s
	iters: 400, epoch: 5 | loss: 0.0269865
	speed: 0.1934s/iter; left time: 2280.8869s
Epoch: 5 cost time: 94.03373742103577
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.970268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0455612
	speed: 0.7072s/iter; left time: 8221.4197s
	iters: 200, epoch: 6 | loss: 0.0388263
	speed: 0.2075s/iter; left time: 2391.9599s
	iters: 300, epoch: 6 | loss: 0.0576742
	speed: 0.2077s/iter; left time: 2372.7339s
	iters: 400, epoch: 6 | loss: 0.0168905
	speed: 0.1891s/iter; left time: 2141.2930s
Epoch: 6 cost time: 93.21758484840393
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0041466
	speed: 0.6619s/iter; left time: 7385.0003s
	iters: 200, epoch: 7 | loss: 0.0283185
	speed: 0.2029s/iter; left time: 2243.7928s
	iters: 300, epoch: 7 | loss: 0.0267123
	speed: 0.1978s/iter; left time: 2167.6116s
	iters: 400, epoch: 7 | loss: 0.0026891
	speed: 0.1910s/iter; left time: 2073.3338s
Epoch: 7 cost time: 92.86539959907532
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972841).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0076682
	speed: 0.6527s/iter; left time: 6975.7899s
	iters: 200, epoch: 8 | loss: 0.0061873
	speed: 0.1717s/iter; left time: 1818.0452s
	iters: 300, epoch: 8 | loss: 0.0668476
	speed: 0.1819s/iter; left time: 1907.9323s
	iters: 400, epoch: 8 | loss: 0.0291203
	speed: 0.1982s/iter; left time: 2059.1165s
Epoch: 8 cost time: 88.39944672584534
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0035829
	speed: 0.6564s/iter; left time: 6708.1344s
	iters: 200, epoch: 9 | loss: 0.0067577
	speed: 0.1929s/iter; left time: 1951.7340s
	iters: 300, epoch: 9 | loss: 0.0284634
	speed: 0.1901s/iter; left time: 1904.5136s
	iters: 400, epoch: 9 | loss: 0.0132455
	speed: 0.1921s/iter; left time: 1905.8554s
Epoch: 9 cost time: 89.97177505493164
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2992802
	speed: 0.6558s/iter; left time: 6393.7994s
	iters: 200, epoch: 10 | loss: 0.3091320
	speed: 0.1623s/iter; left time: 1565.9340s
	iters: 300, epoch: 10 | loss: 0.0113149
	speed: 0.1883s/iter; left time: 1797.7904s
	iters: 400, epoch: 10 | loss: 0.2791138
	speed: 0.1841s/iter; left time: 1739.9161s
Epoch: 10 cost time: 85.19055938720703
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.972841 --> -0.977415).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2405723
	speed: 0.6497s/iter; left time: 6029.6022s
	iters: 200, epoch: 11 | loss: 0.1384055
	speed: 0.1967s/iter; left time: 1805.6151s
	iters: 300, epoch: 11 | loss: 0.0502994
	speed: 0.1945s/iter; left time: 1766.3230s
	iters: 400, epoch: 11 | loss: 0.2280792
	speed: 0.1951s/iter; left time: 1752.1426s
Epoch: 11 cost time: 91.90361905097961
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.980560).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006799
	speed: 0.6282s/iter; left time: 5535.5287s
	iters: 200, epoch: 12 | loss: 0.0154864
	speed: 0.1986s/iter; left time: 1730.1623s
	iters: 300, epoch: 12 | loss: 0.2198874
	speed: 0.2009s/iter; left time: 1729.9188s
	iters: 400, epoch: 12 | loss: 0.0014046
	speed: 0.2038s/iter; left time: 1734.8471s
Epoch: 12 cost time: 92.85278367996216
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0043706
	speed: 0.6809s/iter; left time: 5680.5962s
	iters: 200, epoch: 13 | loss: 0.0016503
	speed: 0.2003s/iter; left time: 1651.0319s
	iters: 300, epoch: 13 | loss: 0.0086392
	speed: 0.2005s/iter; left time: 1632.4305s
	iters: 400, epoch: 13 | loss: 0.0179933
	speed: 0.1981s/iter; left time: 1593.5675s
Epoch: 13 cost time: 93.884836435318
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0250832
	speed: 0.6831s/iter; left time: 5379.0025s
	iters: 200, epoch: 14 | loss: 0.0060917
	speed: 0.1990s/iter; left time: 1547.0063s
	iters: 300, epoch: 14 | loss: 0.0014328
	speed: 0.1983s/iter; left time: 1522.1288s
	iters: 400, epoch: 14 | loss: 0.0171232
	speed: 0.1991s/iter; left time: 1508.2748s
Epoch: 14 cost time: 94.50622892379761
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0046926
	speed: 0.7057s/iter; left time: 5225.5596s
	iters: 200, epoch: 15 | loss: 0.0019661
	speed: 0.2063s/iter; left time: 1506.8731s
	iters: 300, epoch: 15 | loss: 0.0060818
	speed: 0.2118s/iter; left time: 1525.7681s
	iters: 400, epoch: 15 | loss: 0.0025327
	speed: 0.2084s/iter; left time: 1480.9371s
Epoch: 15 cost time: 97.61619997024536
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0002517
	speed: 0.7000s/iter; left time: 4854.8960s
	iters: 200, epoch: 16 | loss: 0.0057610
	speed: 0.2096s/iter; left time: 1432.9898s
	iters: 300, epoch: 16 | loss: 0.0027473
	speed: 0.2038s/iter; left time: 1372.8796s
	iters: 400, epoch: 16 | loss: 0.0021758
	speed: 0.1991s/iter; left time: 1321.5452s
Epoch: 16 cost time: 96.36451506614685
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0006339
	speed: 0.6861s/iter; left time: 4436.7165s
	iters: 200, epoch: 17 | loss: 0.0011467
	speed: 0.1947s/iter; left time: 1239.7961s
	iters: 300, epoch: 17 | loss: 0.0025302
	speed: 0.1976s/iter; left time: 1238.3064s
	iters: 400, epoch: 17 | loss: 0.0004282
	speed: 0.1998s/iter; left time: 1232.3777s
Epoch: 17 cost time: 93.12930727005005
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0077883
	speed: 0.6811s/iter; left time: 4085.0139s
	iters: 200, epoch: 18 | loss: 0.0012613
	speed: 0.1609s/iter; left time: 949.0630s
	iters: 300, epoch: 18 | loss: 0.0157734
	speed: 0.1928s/iter; left time: 1117.6959s
	iters: 400, epoch: 18 | loss: 0.0019208
	speed: 0.1831s/iter; left time: 1043.5019s
Epoch: 18 cost time: 86.44941663742065
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.980560 --> -0.981703).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0951986
	speed: 0.6377s/iter; left time: 3525.7108s
	iters: 200, epoch: 19 | loss: 0.0028234
	speed: 0.1938s/iter; left time: 1052.3504s
	iters: 300, epoch: 19 | loss: 0.0039172
	speed: 0.1931s/iter; left time: 1029.0160s
	iters: 400, epoch: 19 | loss: 0.0430431
	speed: 0.1996s/iter; left time: 1043.7716s
Epoch: 19 cost time: 91.61341714859009
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0006851
	speed: 0.6530s/iter; left time: 3304.1027s
	iters: 200, epoch: 20 | loss: 0.0014220
	speed: 0.1598s/iter; left time: 792.6690s
	iters: 300, epoch: 20 | loss: 0.0056269
	speed: 0.2024s/iter; left time: 983.5459s
	iters: 400, epoch: 20 | loss: 0.0005367
	speed: 0.2060s/iter; left time: 980.7303s
Epoch: 20 cost time: 90.16810035705566
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.983418).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0070747
	speed: 0.6815s/iter; left time: 3128.8945s
	iters: 200, epoch: 21 | loss: 0.0005371
	speed: 0.1926s/iter; left time: 864.9238s
	iters: 300, epoch: 21 | loss: 0.0005294
	speed: 0.1927s/iter; left time: 846.1397s
	iters: 400, epoch: 21 | loss: 0.0015396
	speed: 0.1941s/iter; left time: 832.9553s
Epoch: 21 cost time: 90.91968512535095
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0044808
	speed: 0.6662s/iter; left time: 2746.1023s
	iters: 200, epoch: 22 | loss: 0.0020127
	speed: 0.1942s/iter; left time: 780.9120s
	iters: 300, epoch: 22 | loss: 0.0011025
	speed: 0.1944s/iter; left time: 762.5111s
	iters: 400, epoch: 22 | loss: 0.0019729
	speed: 0.1958s/iter; left time: 748.4537s
Epoch: 22 cost time: 91.67533087730408
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0002364
	speed: 0.6602s/iter; left time: 2411.6013s
	iters: 200, epoch: 23 | loss: 0.0046898
	speed: 0.1957s/iter; left time: 695.3190s
	iters: 300, epoch: 23 | loss: 0.0051452
	speed: 0.1955s/iter; left time: 675.0892s
	iters: 400, epoch: 23 | loss: 0.0041969
	speed: 0.1949s/iter; left time: 653.6226s
Epoch: 23 cost time: 92.33729791641235
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0230871
	speed: 0.6852s/iter; left time: 2181.5310s
	iters: 200, epoch: 24 | loss: 0.0020697
	speed: 0.2034s/iter; left time: 627.3514s
	iters: 300, epoch: 24 | loss: 0.0913487
	speed: 0.1992s/iter; left time: 594.2731s
	iters: 400, epoch: 24 | loss: 0.0067787
	speed: 0.1998s/iter; left time: 576.3461s
Epoch: 24 cost time: 89.99623680114746
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0079912
	speed: 0.5710s/iter; left time: 1550.3229s
	iters: 200, epoch: 25 | loss: 0.0066713
	speed: 0.1868s/iter; left time: 488.5308s
	iters: 300, epoch: 25 | loss: 0.0005290
	speed: 0.1850s/iter; left time: 465.3500s
	iters: 400, epoch: 25 | loss: 0.0033488
	speed: 0.1847s/iter; left time: 446.1230s
Epoch: 25 cost time: 87.79895830154419
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1359906
	speed: 0.6200s/iter; left time: 1392.4866s
	iters: 200, epoch: 26 | loss: 0.0005381
	speed: 0.1850s/iter; left time: 397.0440s
	iters: 300, epoch: 26 | loss: 0.0580548
	speed: 0.1730s/iter; left time: 354.0237s
	iters: 400, epoch: 26 | loss: 0.0124949
	speed: 0.1634s/iter; left time: 318.0206s
Epoch: 26 cost time: 83.9834372997284
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0007628
	speed: 0.6395s/iter; left time: 1136.3943s
	iters: 200, epoch: 27 | loss: 0.0004310
	speed: 0.1879s/iter; left time: 315.1464s
	iters: 300, epoch: 27 | loss: 0.0011602
	speed: 0.1878s/iter; left time: 296.0947s
	iters: 400, epoch: 27 | loss: 0.0021596
	speed: 0.1846s/iter; left time: 272.7260s
Epoch: 27 cost time: 87.82646584510803
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0051935
	speed: 0.5997s/iter; left time: 784.3587s
	iters: 200, epoch: 28 | loss: 0.0010844
	speed: 0.1806s/iter; left time: 218.1245s
	iters: 300, epoch: 28 | loss: 0.0005776
	speed: 0.1811s/iter; left time: 200.6488s
	iters: 400, epoch: 28 | loss: 0.0006371
	speed: 0.1794s/iter; left time: 180.7991s
Epoch: 28 cost time: 81.53638434410095
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0009767
	speed: 0.6157s/iter; left time: 516.5571s
	iters: 200, epoch: 29 | loss: 0.0003317
	speed: 0.1720s/iter; left time: 127.0763s
	iters: 300, epoch: 29 | loss: 0.2625097
	speed: 0.1774s/iter; left time: 113.3729s
	iters: 400, epoch: 29 | loss: 0.0019457
	speed: 0.1681s/iter; left time: 90.5876s
Epoch: 29 cost time: 83.01092839241028
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1267480
	speed: 0.6672s/iter; left time: 246.8554s
	iters: 200, epoch: 30 | loss: 0.0806319
	speed: 0.1906s/iter; left time: 51.4601s
	iters: 300, epoch: 30 | loss: 0.0007368
	speed: 0.1923s/iter; left time: 32.6899s
	iters: 400, epoch: 30 | loss: 0.0036625
	speed: 0.1957s/iter; left time: 13.6991s
Epoch: 30 cost time: 90.96638107299805
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 587338
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0483418
	speed: 0.1764s/iter; left time: 2465.1725s
	iters: 200, epoch: 1 | loss: 1.2880785
	speed: 0.1581s/iter; left time: 2192.4637s
	iters: 300, epoch: 1 | loss: 0.9569577
	speed: 0.1535s/iter; left time: 2114.3595s
	iters: 400, epoch: 1 | loss: 0.7640457
	speed: 0.1318s/iter; left time: 1801.4490s
Epoch: 1 cost time: 70.67758870124817
Epoch: 1, Steps: 469 | Train Loss: 1.391 Vali Loss: 0.492 Vali Acc: 0.895 Test Loss: 0.492 Test Acc: 0.895
Validation loss decreased (inf --> -0.894506).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3864458
	speed: 0.5259s/iter; left time: 7100.6630s
	iters: 200, epoch: 2 | loss: 0.2258939
	speed: 0.1499s/iter; left time: 2008.9259s
	iters: 300, epoch: 2 | loss: 0.2888716
	speed: 0.1514s/iter; left time: 2014.4164s
	iters: 400, epoch: 2 | loss: 0.1026435
	speed: 0.1477s/iter; left time: 1950.4493s
Epoch: 2 cost time: 70.74555945396423
Epoch: 2, Steps: 469 | Train Loss: 0.279 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.894506 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2522293
	speed: 0.5821s/iter; left time: 7586.2206s
	iters: 200, epoch: 3 | loss: 0.3002104
	speed: 0.1334s/iter; left time: 1725.5283s
	iters: 300, epoch: 3 | loss: 0.2463607
	speed: 0.1643s/iter; left time: 2108.7923s
	iters: 400, epoch: 3 | loss: 0.0232677
	speed: 0.1600s/iter; left time: 2037.0136s
Epoch: 3 cost time: 72.95106267929077
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.958260 --> -0.963978).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0170513
	speed: 0.6083s/iter; left time: 7642.6384s
	iters: 200, epoch: 4 | loss: 0.0291761
	speed: 0.1639s/iter; left time: 2043.0086s
	iters: 300, epoch: 4 | loss: 0.0168819
	speed: 0.1653s/iter; left time: 2043.9580s
	iters: 400, epoch: 4 | loss: 0.1270195
	speed: 0.1645s/iter; left time: 2017.3915s
Epoch: 4 cost time: 77.12513780593872
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.963978 --> -0.973984).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0236683
	speed: 0.5936s/iter; left time: 7179.2415s
	iters: 200, epoch: 5 | loss: 0.0156730
	speed: 0.1505s/iter; left time: 1805.3709s
	iters: 300, epoch: 5 | loss: 0.2355641
	speed: 0.1453s/iter; left time: 1728.1834s
	iters: 400, epoch: 5 | loss: 0.0464181
	speed: 0.1302s/iter; left time: 1535.1567s
Epoch: 5 cost time: 68.87579822540283
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0510236
	speed: 0.5550s/iter; left time: 6452.7373s
	iters: 200, epoch: 6 | loss: 0.0321666
	speed: 0.1466s/iter; left time: 1689.9205s
	iters: 300, epoch: 6 | loss: 0.0172856
	speed: 0.1486s/iter; left time: 1697.4047s
	iters: 400, epoch: 6 | loss: 0.0172678
	speed: 0.1287s/iter; left time: 1458.2184s
Epoch: 6 cost time: 66.52346968650818
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0025158
	speed: 0.5561s/iter; left time: 6204.8095s
	iters: 200, epoch: 7 | loss: 0.0110033
	speed: 0.1480s/iter; left time: 1636.4541s
	iters: 300, epoch: 7 | loss: 0.0018879
	speed: 0.1485s/iter; left time: 1627.6521s
	iters: 400, epoch: 7 | loss: 0.0129117
	speed: 0.1522s/iter; left time: 1652.5537s
Epoch: 7 cost time: 70.69520616531372
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1243212
	speed: 0.5786s/iter; left time: 6184.4535s
	iters: 200, epoch: 8 | loss: 0.0028558
	speed: 0.1520s/iter; left time: 1609.8849s
	iters: 300, epoch: 8 | loss: 0.0168117
	speed: 0.1249s/iter; left time: 1309.6968s
	iters: 400, epoch: 8 | loss: 0.0093703
	speed: 0.1379s/iter; left time: 1432.6648s
Epoch: 8 cost time: 67.54450678825378
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0181496
	speed: 0.5385s/iter; left time: 5503.2441s
	iters: 200, epoch: 9 | loss: 0.0334328
	speed: 0.1326s/iter; left time: 1341.9702s
	iters: 300, epoch: 9 | loss: 0.0579321
	speed: 0.1399s/iter; left time: 1401.2274s
	iters: 400, epoch: 9 | loss: 0.0169065
	speed: 0.1602s/iter; left time: 1588.8413s
Epoch: 9 cost time: 69.35930490493774
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975414).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0035287
	speed: 0.6055s/iter; left time: 5903.5887s
	iters: 200, epoch: 10 | loss: 0.0552530
	speed: 0.1555s/iter; left time: 1500.0996s
	iters: 300, epoch: 10 | loss: 0.0015110
	speed: 0.1622s/iter; left time: 1549.0044s
	iters: 400, epoch: 10 | loss: 0.0262765
	speed: 0.1617s/iter; left time: 1528.1873s
Epoch: 10 cost time: 75.1821768283844
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.975414 --> -0.980274).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0957710
	speed: 0.5970s/iter; left time: 5540.4006s
	iters: 200, epoch: 11 | loss: 0.0022175
	speed: 0.1606s/iter; left time: 1474.5960s
	iters: 300, epoch: 11 | loss: 0.1294061
	speed: 0.1596s/iter; left time: 1449.6575s
	iters: 400, epoch: 11 | loss: 0.0009466
	speed: 0.1616s/iter; left time: 1450.9994s
Epoch: 11 cost time: 75.47483730316162
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (-0.980274 --> -0.980560).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006188
	speed: 0.6000s/iter; left time: 5287.3635s
	iters: 200, epoch: 12 | loss: 0.0046298
	speed: 0.1596s/iter; left time: 1390.5016s
	iters: 300, epoch: 12 | loss: 0.0008366
	speed: 0.1602s/iter; left time: 1379.4053s
	iters: 400, epoch: 12 | loss: 0.0078131
	speed: 0.1555s/iter; left time: 1323.6374s
Epoch: 12 cost time: 71.88731336593628
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0036839
	speed: 0.5502s/iter; left time: 4590.6301s
	iters: 200, epoch: 13 | loss: 0.0189963
	speed: 0.1558s/iter; left time: 1283.9951s
	iters: 300, epoch: 13 | loss: 0.0059768
	speed: 0.1530s/iter; left time: 1245.6198s
	iters: 400, epoch: 13 | loss: 0.0021968
	speed: 0.1574s/iter; left time: 1266.2268s
Epoch: 13 cost time: 73.11934852600098
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0097131
	speed: 0.6009s/iter; left time: 4731.4037s
	iters: 200, epoch: 14 | loss: 0.0034376
	speed: 0.1585s/iter; left time: 1232.3360s
	iters: 300, epoch: 14 | loss: 0.0414814
	speed: 0.1587s/iter; left time: 1217.9084s
	iters: 400, epoch: 14 | loss: 0.0063707
	speed: 0.1445s/iter; left time: 1094.7259s
Epoch: 14 cost time: 71.09210991859436
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0024798
	speed: 0.5852s/iter; left time: 4333.4268s
	iters: 200, epoch: 15 | loss: 0.0019276
	speed: 0.1629s/iter; left time: 1190.1309s
	iters: 300, epoch: 15 | loss: 0.1602358
	speed: 0.1589s/iter; left time: 1145.0114s
	iters: 400, epoch: 15 | loss: 0.0009956
	speed: 0.1546s/iter; left time: 1098.4830s
Epoch: 15 cost time: 74.47144031524658
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0011777
	speed: 0.5812s/iter; left time: 4031.2098s
	iters: 200, epoch: 16 | loss: 0.1055596
	speed: 0.1572s/iter; left time: 1074.4465s
	iters: 300, epoch: 16 | loss: 0.0122517
	speed: 0.1575s/iter; left time: 1060.7253s
	iters: 400, epoch: 16 | loss: 0.0004835
	speed: 0.1576s/iter; left time: 1045.6847s
Epoch: 16 cost time: 74.07064151763916
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.980560 --> -0.983704).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0008720
	speed: 0.5827s/iter; left time: 3768.3250s
	iters: 200, epoch: 17 | loss: 0.0007867
	speed: 0.1516s/iter; left time: 965.3038s
	iters: 300, epoch: 17 | loss: 0.0361123
	speed: 0.1510s/iter; left time: 946.2561s
	iters: 400, epoch: 17 | loss: 0.0004737
	speed: 0.1082s/iter; left time: 666.9882s
Epoch: 17 cost time: 67.53316164016724
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983704 --> -0.985420).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0076776
	speed: 0.5273s/iter; left time: 3162.7117s
	iters: 200, epoch: 18 | loss: 0.0024730
	speed: 0.1482s/iter; left time: 874.2951s
	iters: 300, epoch: 18 | loss: 0.0014908
	speed: 0.1451s/iter; left time: 841.1933s
	iters: 400, epoch: 18 | loss: 0.0021969
	speed: 0.1479s/iter; left time: 842.9257s
Epoch: 18 cost time: 69.31876063346863
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0016569
	speed: 0.5674s/iter; left time: 3137.3937s
	iters: 200, epoch: 19 | loss: 0.1546139
	speed: 0.1538s/iter; left time: 834.7170s
	iters: 300, epoch: 19 | loss: 0.0472171
	speed: 0.1458s/iter; left time: 777.1464s
	iters: 400, epoch: 19 | loss: 0.0004849
	speed: 0.1208s/iter; left time: 631.6815s
Epoch: 19 cost time: 66.81325078010559
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0012037
	speed: 0.5476s/iter; left time: 2770.9431s
	iters: 200, epoch: 20 | loss: 0.0021316
	speed: 0.1457s/iter; left time: 722.5990s
	iters: 300, epoch: 20 | loss: 0.0003406
	speed: 0.1485s/iter; left time: 721.5771s
	iters: 400, epoch: 20 | loss: 0.0014685
	speed: 0.1438s/iter; left time: 684.4190s
Epoch: 20 cost time: 68.58064579963684
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.048 Vali Acc: 0.989 Test Loss: 0.048 Test Acc: 0.989
Validation loss decreased (-0.985420 --> -0.988850).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0007209
	speed: 0.5039s/iter; left time: 2313.4042s
	iters: 200, epoch: 21 | loss: 0.0028144
	speed: 0.1357s/iter; left time: 609.6022s
	iters: 300, epoch: 21 | loss: 0.0046976
	speed: 0.1399s/iter; left time: 614.3136s
	iters: 400, epoch: 21 | loss: 0.0079470
	speed: 0.1359s/iter; left time: 583.0869s
Epoch: 21 cost time: 62.2039909362793
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0019240
	speed: 0.5190s/iter; left time: 2139.1205s
	iters: 200, epoch: 22 | loss: 0.0073916
	speed: 0.1225s/iter; left time: 492.7614s
	iters: 300, epoch: 22 | loss: 0.0004690
	speed: 0.1502s/iter; left time: 589.2207s
	iters: 400, epoch: 22 | loss: 0.0008769
	speed: 0.1522s/iter; left time: 581.6174s
Epoch: 22 cost time: 66.71327519416809
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0035315
	speed: 0.5808s/iter; left time: 2121.8262s
	iters: 200, epoch: 23 | loss: 0.0013541
	speed: 0.1552s/iter; left time: 551.4766s
	iters: 300, epoch: 23 | loss: 0.0011280
	speed: 0.1572s/iter; left time: 542.7099s
	iters: 400, epoch: 23 | loss: 0.0009892
	speed: 0.1520s/iter; left time: 509.7254s
Epoch: 23 cost time: 72.29216623306274
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0004881
	speed: 0.5465s/iter; left time: 1739.9005s
	iters: 200, epoch: 24 | loss: 0.0017418
	speed: 0.1644s/iter; left time: 507.0961s
	iters: 300, epoch: 24 | loss: 0.0004996
	speed: 0.1616s/iter; left time: 482.1375s
	iters: 400, epoch: 24 | loss: 0.0107869
	speed: 0.1584s/iter; left time: 456.7558s
Epoch: 24 cost time: 75.78902459144592
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0003564
	speed: 0.6024s/iter; left time: 1635.4409s
	iters: 200, epoch: 25 | loss: 0.0011416
	speed: 0.1593s/iter; left time: 416.6725s
	iters: 300, epoch: 25 | loss: 0.0009780
	speed: 0.1611s/iter; left time: 405.2230s
	iters: 400, epoch: 25 | loss: 0.0013339
	speed: 0.1613s/iter; left time: 389.4395s
Epoch: 25 cost time: 76.19745016098022
Epoch: 25, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0004151
	speed: 0.5995s/iter; left time: 1346.4828s
	iters: 200, epoch: 26 | loss: 0.0005361
	speed: 0.1480s/iter; left time: 317.5557s
	iters: 300, epoch: 26 | loss: 0.1058627
	speed: 0.1522s/iter; left time: 311.4559s
	iters: 400, epoch: 26 | loss: 0.0040692
	speed: 0.1215s/iter; left time: 236.5251s
Epoch: 26 cost time: 67.72533011436462
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0008547
	speed: 0.5458s/iter; left time: 969.9021s
	iters: 200, epoch: 27 | loss: 0.0005500
	speed: 0.1446s/iter; left time: 242.5732s
	iters: 300, epoch: 27 | loss: 0.0010035
	speed: 0.1479s/iter; left time: 233.2381s
	iters: 400, epoch: 27 | loss: 0.0093194
	speed: 0.1437s/iter; left time: 212.2833s
Epoch: 27 cost time: 68.58365035057068
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0052878
	speed: 0.5487s/iter; left time: 717.6854s
	iters: 200, epoch: 28 | loss: 0.0006109
	speed: 0.1444s/iter; left time: 174.4707s
	iters: 300, epoch: 28 | loss: 0.0086020
	speed: 0.1418s/iter; left time: 157.0785s
	iters: 400, epoch: 28 | loss: 0.0034886
	speed: 0.1443s/iter; left time: 145.4368s
Epoch: 28 cost time: 68.1702983379364
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0056830
	speed: 0.5307s/iter; left time: 445.2826s
	iters: 200, epoch: 29 | loss: 0.0777269
	speed: 0.1535s/iter; left time: 113.4652s
	iters: 300, epoch: 29 | loss: 0.0017203
	speed: 0.1544s/iter; left time: 98.6842s
	iters: 400, epoch: 29 | loss: 0.0010910
	speed: 0.1580s/iter; left time: 85.1566s
Epoch: 29 cost time: 72.7681291103363
Epoch: 29, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0003708
	speed: 0.5907s/iter; left time: 218.5755s
	iters: 200, epoch: 30 | loss: 0.0030792
	speed: 0.1563s/iter; left time: 42.2143s
	iters: 300, epoch: 30 | loss: 0.0024004
	speed: 0.1402s/iter; left time: 23.8360s
	iters: 400, epoch: 30 | loss: 0.0337467
	speed: 0.1255s/iter; left time: 8.7839s
Epoch: 30 cost time: 67.91537523269653
Epoch: 30, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9888507718696398
model parameter : 173354
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1391580
	speed: 0.1797s/iter; left time: 2510.7145s
	iters: 200, epoch: 1 | loss: 1.3824859
	speed: 0.1601s/iter; left time: 2221.2357s
	iters: 300, epoch: 1 | loss: 1.2462813
	speed: 0.1397s/iter; left time: 1924.3474s
	iters: 400, epoch: 1 | loss: 0.5928131
	speed: 0.1557s/iter; left time: 2127.9657s
Epoch: 1 cost time: 74.82111835479736
Epoch: 1, Steps: 469 | Train Loss: 1.372 Vali Loss: 0.496 Vali Acc: 0.876 Test Loss: 0.496 Test Acc: 0.876
Validation loss decreased (inf --> -0.875924).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4738193
	speed: 0.5748s/iter; left time: 7760.4055s
	iters: 200, epoch: 2 | loss: 0.1544053
	speed: 0.1645s/iter; left time: 2204.9237s
	iters: 300, epoch: 2 | loss: 0.4540127
	speed: 0.1342s/iter; left time: 1785.0714s
	iters: 400, epoch: 2 | loss: 0.2989841
	speed: 0.1495s/iter; left time: 1973.1303s
Epoch: 2 cost time: 72.48022413253784
Epoch: 2, Steps: 469 | Train Loss: 0.283 Vali Loss: 0.223 Vali Acc: 0.939 Test Loss: 0.223 Test Acc: 0.939
Validation loss decreased (-0.875924 --> -0.938534).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1604568
	speed: 0.5378s/iter; left time: 7008.8739s
	iters: 200, epoch: 3 | loss: 0.1199130
	speed: 0.1472s/iter; left time: 1904.1135s
	iters: 300, epoch: 3 | loss: 0.0444391
	speed: 0.1247s/iter; left time: 1600.8553s
	iters: 400, epoch: 3 | loss: 0.0555640
	speed: 0.1210s/iter; left time: 1540.4036s
Epoch: 3 cost time: 66.45977210998535
Epoch: 3, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.938534 --> -0.959404).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0193518
	speed: 0.6049s/iter; left time: 7599.9451s
	iters: 200, epoch: 4 | loss: 0.0305065
	speed: 0.1727s/iter; left time: 2153.0774s
	iters: 300, epoch: 4 | loss: 0.0215802
	speed: 0.1757s/iter; left time: 2171.9564s
	iters: 400, epoch: 4 | loss: 0.0260964
	speed: 0.1775s/iter; left time: 2176.6789s
Epoch: 4 cost time: 82.78014087677002
Epoch: 4, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.959404 --> -0.965693).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0131866
	speed: 0.6166s/iter; left time: 7458.2629s
	iters: 200, epoch: 5 | loss: 0.1767577
	speed: 0.1774s/iter; left time: 2127.9321s
	iters: 300, epoch: 5 | loss: 0.0482077
	speed: 0.1385s/iter; left time: 1647.7325s
	iters: 400, epoch: 5 | loss: 0.0561889
	speed: 0.1654s/iter; left time: 1950.7824s
Epoch: 5 cost time: 77.01492643356323
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0495190
	speed: 0.5758s/iter; left time: 6694.6654s
	iters: 200, epoch: 6 | loss: 0.0417638
	speed: 0.1593s/iter; left time: 1836.6384s
	iters: 300, epoch: 6 | loss: 0.1584399
	speed: 0.1565s/iter; left time: 1788.5541s
	iters: 400, epoch: 6 | loss: 0.0229646
	speed: 0.1593s/iter; left time: 1804.0957s
Epoch: 6 cost time: 73.09906220436096
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.127 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0041938
	speed: 0.5520s/iter; left time: 6159.0669s
	iters: 200, epoch: 7 | loss: 0.0246107
	speed: 0.1626s/iter; left time: 1797.6783s
	iters: 300, epoch: 7 | loss: 0.0053430
	speed: 0.1412s/iter; left time: 1547.0553s
	iters: 400, epoch: 7 | loss: 0.0277268
	speed: 0.1356s/iter; left time: 1472.3045s
Epoch: 7 cost time: 73.70654678344727
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.969124 --> -0.975985).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0059376
	speed: 0.6149s/iter; left time: 6571.8468s
	iters: 200, epoch: 8 | loss: 0.0071572
	speed: 0.1719s/iter; left time: 1819.9699s
	iters: 300, epoch: 8 | loss: 0.1112116
	speed: 0.1422s/iter; left time: 1491.6044s
	iters: 400, epoch: 8 | loss: 0.0451115
	speed: 0.1626s/iter; left time: 1688.6682s
Epoch: 8 cost time: 76.58456993103027
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0045761
	speed: 0.5731s/iter; left time: 5856.8870s
	iters: 200, epoch: 9 | loss: 0.0031908
	speed: 0.1702s/iter; left time: 1721.9434s
	iters: 300, epoch: 9 | loss: 0.0777552
	speed: 0.1678s/iter; left time: 1681.0871s
	iters: 400, epoch: 9 | loss: 0.0451792
	speed: 0.1493s/iter; left time: 1481.2909s
Epoch: 9 cost time: 77.42326712608337
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.977701).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2259433
	speed: 0.5832s/iter; left time: 5686.2742s
	iters: 200, epoch: 10 | loss: 0.0354993
	speed: 0.1618s/iter; left time: 1561.6095s
	iters: 300, epoch: 10 | loss: 0.2389206
	speed: 0.1595s/iter; left time: 1523.6607s
	iters: 400, epoch: 10 | loss: 0.3383781
	speed: 0.1590s/iter; left time: 1502.3086s
Epoch: 10 cost time: 74.20985674858093
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0246631
	speed: 0.5221s/iter; left time: 4845.2749s
	iters: 200, epoch: 11 | loss: 0.1639420
	speed: 0.1510s/iter; left time: 1386.0231s
	iters: 300, epoch: 11 | loss: 0.0225696
	speed: 0.1501s/iter; left time: 1363.4709s
	iters: 400, epoch: 11 | loss: 0.0275484
	speed: 0.1400s/iter; left time: 1257.5874s
Epoch: 11 cost time: 69.14736819267273
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0013701
	speed: 0.6395s/iter; left time: 5635.2790s
	iters: 200, epoch: 12 | loss: 0.0380744
	speed: 0.1910s/iter; left time: 1663.7443s
	iters: 300, epoch: 12 | loss: 0.3001758
	speed: 0.1949s/iter; left time: 1678.6824s
	iters: 400, epoch: 12 | loss: 0.0013181
	speed: 0.1936s/iter; left time: 1647.9783s
Epoch: 12 cost time: 91.06096124649048
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0039497
	speed: 0.6774s/iter; left time: 5651.8759s
	iters: 200, epoch: 13 | loss: 0.0019813
	speed: 0.1942s/iter; left time: 1600.6050s
	iters: 300, epoch: 13 | loss: 0.0196433
	speed: 0.1933s/iter; left time: 1574.1984s
	iters: 400, epoch: 13 | loss: 0.0074395
	speed: 0.1912s/iter; left time: 1537.6186s
Epoch: 13 cost time: 90.88081240653992
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.979130).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0944214
	speed: 0.6898s/iter; left time: 5431.8525s
	iters: 200, epoch: 14 | loss: 0.1037674
	speed: 0.1987s/iter; left time: 1544.4691s
	iters: 300, epoch: 14 | loss: 0.0017298
	speed: 0.2003s/iter; left time: 1537.3133s
	iters: 400, epoch: 14 | loss: 0.0262330
	speed: 0.1988s/iter; left time: 1505.7724s
Epoch: 14 cost time: 93.99243903160095
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0042651
	speed: 0.7004s/iter; left time: 5186.2865s
	iters: 200, epoch: 15 | loss: 0.0008665
	speed: 0.1982s/iter; left time: 1447.9067s
	iters: 300, epoch: 15 | loss: 0.0125822
	speed: 0.1994s/iter; left time: 1436.4536s
	iters: 400, epoch: 15 | loss: 0.0016304
	speed: 0.1936s/iter; left time: 1375.6152s
Epoch: 15 cost time: 92.97076511383057
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0004936
	speed: 0.6848s/iter; left time: 4749.6670s
	iters: 200, epoch: 16 | loss: 0.0043602
	speed: 0.1947s/iter; left time: 1331.2450s
	iters: 300, epoch: 16 | loss: 0.0030342
	speed: 0.1949s/iter; left time: 1313.1441s
	iters: 400, epoch: 16 | loss: 0.0078772
	speed: 0.1940s/iter; left time: 1287.6489s
Epoch: 16 cost time: 91.81205677986145
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0012419
	speed: 0.6728s/iter; left time: 4350.7577s
	iters: 200, epoch: 17 | loss: 0.0035198
	speed: 0.1953s/iter; left time: 1243.5648s
	iters: 300, epoch: 17 | loss: 0.0011884
	speed: 0.1929s/iter; left time: 1208.6811s
	iters: 400, epoch: 17 | loss: 0.0008768
	speed: 0.1951s/iter; left time: 1203.3869s
Epoch: 17 cost time: 91.1605167388916
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980559).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0219471
	speed: 0.6853s/iter; left time: 4110.7180s
	iters: 200, epoch: 18 | loss: 0.0006691
	speed: 0.1940s/iter; left time: 1144.0421s
	iters: 300, epoch: 18 | loss: 0.0380216
	speed: 0.1899s/iter; left time: 1100.8082s
	iters: 400, epoch: 18 | loss: 0.0007499
	speed: 0.1907s/iter; left time: 1086.6234s
Epoch: 18 cost time: 90.59937071800232
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0050926
	speed: 0.6962s/iter; left time: 3849.2780s
	iters: 200, epoch: 19 | loss: 0.0059219
	speed: 0.2011s/iter; left time: 1091.5900s
	iters: 300, epoch: 19 | loss: 0.0022439
	speed: 0.2007s/iter; left time: 1069.4633s
	iters: 400, epoch: 19 | loss: 0.0711960
	speed: 0.2014s/iter; left time: 1052.9795s
Epoch: 19 cost time: 94.57227301597595
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0006301
	speed: 0.6846s/iter; left time: 3464.2520s
	iters: 200, epoch: 20 | loss: 0.0116716
	speed: 0.1927s/iter; left time: 955.6640s
	iters: 300, epoch: 20 | loss: 0.0010377
	speed: 0.1934s/iter; left time: 939.7207s
	iters: 400, epoch: 20 | loss: 0.0008776
	speed: 0.1961s/iter; left time: 933.3267s
Epoch: 20 cost time: 91.1904809474945
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0013816
	speed: 0.6729s/iter; left time: 3089.3641s
	iters: 200, epoch: 21 | loss: 0.0009297
	speed: 0.1877s/iter; left time: 843.0355s
	iters: 300, epoch: 21 | loss: 0.0004101
	speed: 0.1861s/iter; left time: 817.0089s
	iters: 400, epoch: 21 | loss: 0.0018108
	speed: 0.1867s/iter; left time: 801.2750s
Epoch: 21 cost time: 87.80272841453552
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0025276
	speed: 0.6751s/iter; left time: 2782.8197s
	iters: 200, epoch: 22 | loss: 0.0008090
	speed: 0.1944s/iter; left time: 781.7931s
	iters: 300, epoch: 22 | loss: 0.0057417
	speed: 0.1949s/iter; left time: 764.5089s
	iters: 400, epoch: 22 | loss: 0.0049875
	speed: 0.1937s/iter; left time: 740.3516s
Epoch: 22 cost time: 91.53805303573608
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.980559 --> -0.982561).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0005782
	speed: 0.6779s/iter; left time: 2476.3187s
	iters: 200, epoch: 23 | loss: 0.0077928
	speed: 0.1913s/iter; left time: 679.6145s
	iters: 300, epoch: 23 | loss: 0.0148792
	speed: 0.1929s/iter; left time: 665.9691s
	iters: 400, epoch: 23 | loss: 0.0167476
	speed: 0.1917s/iter; left time: 642.7283s
Epoch: 23 cost time: 90.53906345367432
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0050813
	speed: 0.7006s/iter; left time: 2230.5851s
	iters: 200, epoch: 24 | loss: 0.0006277
	speed: 0.1987s/iter; left time: 612.9351s
	iters: 300, epoch: 24 | loss: 0.0772514
	speed: 0.1997s/iter; left time: 595.9854s
	iters: 400, epoch: 24 | loss: 0.0140882
	speed: 0.1970s/iter; left time: 568.2857s
Epoch: 24 cost time: 93.71855139732361
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0023724
	speed: 0.6991s/iter; left time: 1898.1855s
	iters: 200, epoch: 25 | loss: 0.0013968
	speed: 0.1991s/iter; left time: 520.5644s
	iters: 300, epoch: 25 | loss: 0.0003500
	speed: 0.2000s/iter; left time: 503.1002s
	iters: 400, epoch: 25 | loss: 0.0079722
	speed: 0.2003s/iter; left time: 483.7028s
Epoch: 25 cost time: 93.80478644371033
Epoch: 25, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.983133).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0362017
	speed: 0.6857s/iter; left time: 1540.0629s
	iters: 200, epoch: 26 | loss: 0.0005196
	speed: 0.1927s/iter; left time: 413.4465s
	iters: 300, epoch: 26 | loss: 0.0093867
	speed: 0.1922s/iter; left time: 393.1607s
	iters: 400, epoch: 26 | loss: 0.0057110
	speed: 0.1931s/iter; left time: 375.8117s
Epoch: 26 cost time: 90.86142420768738
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0003062
	speed: 0.6809s/iter; left time: 1210.0045s
	iters: 200, epoch: 27 | loss: 0.0002667
	speed: 0.1941s/iter; left time: 325.5102s
	iters: 300, epoch: 27 | loss: 0.0012199
	speed: 0.1927s/iter; left time: 303.9178s
	iters: 400, epoch: 27 | loss: 0.1682940
	speed: 0.1950s/iter; left time: 288.0294s
Epoch: 27 cost time: 91.10286331176758
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0006761
	speed: 0.6794s/iter; left time: 888.6231s
	iters: 200, epoch: 28 | loss: 0.0026533
	speed: 0.1928s/iter; left time: 232.8702s
	iters: 300, epoch: 28 | loss: 0.0066407
	speed: 0.1917s/iter; left time: 212.4117s
	iters: 400, epoch: 28 | loss: 0.0005664
	speed: 0.1924s/iter; left time: 193.9471s
Epoch: 28 cost time: 90.56232762336731
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0017374
	speed: 0.6830s/iter; left time: 573.0778s
	iters: 200, epoch: 29 | loss: 0.0002487
	speed: 0.1943s/iter; left time: 143.6072s
	iters: 300, epoch: 29 | loss: 0.1914302
	speed: 0.1940s/iter; left time: 123.9825s
	iters: 400, epoch: 29 | loss: 0.0048268
	speed: 0.1935s/iter; left time: 104.2966s
Epoch: 29 cost time: 91.19975423812866
Epoch: 29, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.983133 --> -0.984276).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.2090450
	speed: 0.6589s/iter; left time: 243.8092s
	iters: 200, epoch: 30 | loss: 0.0097822
	speed: 0.2000s/iter; left time: 53.9909s
	iters: 300, epoch: 30 | loss: 0.0005612
	speed: 0.1963s/iter; left time: 33.3787s
	iters: 400, epoch: 30 | loss: 0.0004015
	speed: 0.1808s/iter; left time: 12.6570s
Epoch: 30 cost time: 90.88254237174988
Epoch: 30, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
Validation loss decreased (-0.984276 --> -0.984562).  Saving model ...
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 587338
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0573566
	speed: 0.1892s/iter; left time: 2643.0705s
	iters: 200, epoch: 1 | loss: 1.2883149
	speed: 0.1712s/iter; left time: 2374.4609s
	iters: 300, epoch: 1 | loss: 0.9553137
	speed: 0.1654s/iter; left time: 2277.6894s
	iters: 400, epoch: 1 | loss: 0.7756392
	speed: 0.1697s/iter; left time: 2319.8080s
Epoch: 1 cost time: 81.65922498703003
Epoch: 1, Steps: 469 | Train Loss: 1.399 Vali Loss: 0.511 Vali Acc: 0.889 Test Loss: 0.511 Test Acc: 0.889
Validation loss decreased (inf --> -0.888788).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4019522
	speed: 0.6248s/iter; left time: 8435.8269s
	iters: 200, epoch: 2 | loss: 0.2271843
	speed: 0.1752s/iter; left time: 2348.5985s
	iters: 300, epoch: 2 | loss: 0.3205784
	speed: 0.1738s/iter; left time: 2312.1018s
	iters: 400, epoch: 2 | loss: 0.0972748
	speed: 0.1701s/iter; left time: 2245.0583s
Epoch: 2 cost time: 81.15547943115234
Epoch: 2, Steps: 469 | Train Loss: 0.293 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.888788 --> -0.955687).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3100770
	speed: 0.6765s/iter; left time: 8816.9028s
	iters: 200, epoch: 3 | loss: 0.2208157
	speed: 0.1689s/iter; left time: 2184.5308s
	iters: 300, epoch: 3 | loss: 0.3228762
	speed: 0.1709s/iter; left time: 2192.9663s
	iters: 400, epoch: 3 | loss: 0.0242985
	speed: 0.1731s/iter; left time: 2203.6533s
Epoch: 3 cost time: 81.17490339279175
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0234623
	speed: 0.6556s/iter; left time: 8237.2298s
	iters: 200, epoch: 4 | loss: 0.0277417
	speed: 0.1662s/iter; left time: 2071.4729s
	iters: 300, epoch: 4 | loss: 0.0162630
	speed: 0.1683s/iter; left time: 2081.2954s
	iters: 400, epoch: 4 | loss: 0.1898039
	speed: 0.1661s/iter; left time: 2036.9430s
Epoch: 4 cost time: 77.90279936790466
Epoch: 4, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
Validation loss decreased (-0.955687 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0435488
	speed: 0.6418s/iter; left time: 7762.7695s
	iters: 200, epoch: 5 | loss: 0.0149354
	speed: 0.1646s/iter; left time: 1974.3056s
	iters: 300, epoch: 5 | loss: 0.1045011
	speed: 0.1665s/iter; left time: 1980.5553s
	iters: 400, epoch: 5 | loss: 0.0676386
	speed: 0.1645s/iter; left time: 1939.9403s
Epoch: 5 cost time: 77.80631470680237
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.975414).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0369813
	speed: 0.6427s/iter; left time: 7472.2896s
	iters: 200, epoch: 6 | loss: 0.0119369
	speed: 0.1645s/iter; left time: 1896.2331s
	iters: 300, epoch: 6 | loss: 0.0311372
	speed: 0.1598s/iter; left time: 1825.8573s
	iters: 400, epoch: 6 | loss: 0.0113877
	speed: 0.1620s/iter; left time: 1834.8464s
Epoch: 6 cost time: 77.43382167816162
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
Validation loss decreased (-0.975414 --> -0.978558).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008717
	speed: 0.6477s/iter; left time: 7226.0987s
	iters: 200, epoch: 7 | loss: 0.0198342
	speed: 0.1637s/iter; left time: 1809.5227s
	iters: 300, epoch: 7 | loss: 0.0016204
	speed: 0.1701s/iter; left time: 1864.2869s
	iters: 400, epoch: 7 | loss: 0.0064678
	speed: 0.1687s/iter; left time: 1831.6126s
Epoch: 7 cost time: 78.01503491401672
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1347375
	speed: 0.5890s/iter; left time: 6295.6335s
	iters: 200, epoch: 8 | loss: 0.0051495
	speed: 0.1680s/iter; left time: 1779.2484s
	iters: 300, epoch: 8 | loss: 0.0064786
	speed: 0.1686s/iter; left time: 1767.9917s
	iters: 400, epoch: 8 | loss: 0.0083099
	speed: 0.1663s/iter; left time: 1727.0826s
Epoch: 8 cost time: 75.92214775085449
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0236781
	speed: 0.6675s/iter; left time: 6820.8535s
	iters: 200, epoch: 9 | loss: 0.0326544
	speed: 0.1732s/iter; left time: 1753.0377s
	iters: 300, epoch: 9 | loss: 0.0313708
	speed: 0.1692s/iter; left time: 1695.5191s
	iters: 400, epoch: 9 | loss: 0.0155335
	speed: 0.1735s/iter; left time: 1720.6529s
Epoch: 9 cost time: 81.48002076148987
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978558).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0036096
	speed: 0.6811s/iter; left time: 6640.3427s
	iters: 200, epoch: 10 | loss: 0.0853136
	speed: 0.1721s/iter; left time: 1660.9305s
	iters: 300, epoch: 10 | loss: 0.0023734
	speed: 0.1716s/iter; left time: 1639.2057s
	iters: 400, epoch: 10 | loss: 0.0098784
	speed: 0.1758s/iter; left time: 1661.1653s
Epoch: 10 cost time: 81.57525300979614
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.980274).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0455909
	speed: 0.6643s/iter; left time: 6165.1801s
	iters: 200, epoch: 11 | loss: 0.0014584
	speed: 0.1620s/iter; left time: 1487.1579s
	iters: 300, epoch: 11 | loss: 0.1047475
	speed: 0.1309s/iter; left time: 1188.8741s
	iters: 400, epoch: 11 | loss: 0.0004961
	speed: 0.1712s/iter; left time: 1537.7777s
Epoch: 11 cost time: 75.12588310241699
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0012948
	speed: 0.6627s/iter; left time: 5839.6558s
	iters: 200, epoch: 12 | loss: 0.0076347
	speed: 0.1723s/iter; left time: 1501.1520s
	iters: 300, epoch: 12 | loss: 0.0042977
	speed: 0.1717s/iter; left time: 1478.2896s
	iters: 400, epoch: 12 | loss: 0.0030547
	speed: 0.1711s/iter; left time: 1456.3998s
Epoch: 12 cost time: 80.70283532142639
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0486516
	speed: 0.6412s/iter; left time: 5349.6893s
	iters: 200, epoch: 13 | loss: 0.0045389
	speed: 0.1704s/iter; left time: 1404.3422s
	iters: 300, epoch: 13 | loss: 0.0030634
	speed: 0.1713s/iter; left time: 1395.1338s
	iters: 400, epoch: 13 | loss: 0.0015931
	speed: 0.1716s/iter; left time: 1380.5773s
Epoch: 13 cost time: 79.59087085723877
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.981989).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0026784
	speed: 0.6514s/iter; left time: 5128.8593s
	iters: 200, epoch: 14 | loss: 0.0042790
	speed: 0.1663s/iter; left time: 1293.0338s
	iters: 300, epoch: 14 | loss: 0.0137930
	speed: 0.1682s/iter; left time: 1291.0986s
	iters: 400, epoch: 14 | loss: 0.0056674
	speed: 0.1687s/iter; left time: 1277.9790s
Epoch: 14 cost time: 78.94085597991943
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
Validation loss decreased (-0.981989 --> -0.982275).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0079108
	speed: 0.6586s/iter; left time: 4876.9865s
	iters: 200, epoch: 15 | loss: 0.0035318
	speed: 0.1669s/iter; left time: 1219.1271s
	iters: 300, epoch: 15 | loss: 0.0537224
	speed: 0.1650s/iter; left time: 1188.6349s
	iters: 400, epoch: 15 | loss: 0.0006980
	speed: 0.1678s/iter; left time: 1192.0851s
Epoch: 15 cost time: 78.49017381668091
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0040994
	speed: 0.6595s/iter; left time: 4574.1994s
	iters: 200, epoch: 16 | loss: 0.0823526
	speed: 0.1704s/iter; left time: 1165.1858s
	iters: 300, epoch: 16 | loss: 0.0051593
	speed: 0.1697s/iter; left time: 1142.8108s
	iters: 400, epoch: 16 | loss: 0.0008552
	speed: 0.1678s/iter; left time: 1113.2909s
Epoch: 16 cost time: 79.74060916900635
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.982275 --> -0.983990).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0015408
	speed: 0.6500s/iter; left time: 4203.6284s
	iters: 200, epoch: 17 | loss: 0.0030482
	speed: 0.1690s/iter; left time: 1075.9517s
	iters: 300, epoch: 17 | loss: 0.0125753
	speed: 0.1683s/iter; left time: 1054.7301s
	iters: 400, epoch: 17 | loss: 0.0020715
	speed: 0.1696s/iter; left time: 1046.0923s
Epoch: 17 cost time: 79.34097647666931
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984562).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0086686
	speed: 0.6704s/iter; left time: 4020.9027s
	iters: 200, epoch: 18 | loss: 0.0080962
	speed: 0.1753s/iter; left time: 1034.1249s
	iters: 300, epoch: 18 | loss: 0.0004975
	speed: 0.1703s/iter; left time: 987.3996s
	iters: 400, epoch: 18 | loss: 0.0014990
	speed: 0.1767s/iter; left time: 1007.0261s
Epoch: 18 cost time: 81.87946343421936
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0037540
	speed: 0.6838s/iter; left time: 3780.5590s
	iters: 200, epoch: 19 | loss: 0.0473326
	speed: 0.1759s/iter; left time: 955.0844s
	iters: 300, epoch: 19 | loss: 0.0925574
	speed: 0.1741s/iter; left time: 927.9241s
	iters: 400, epoch: 19 | loss: 0.0007015
	speed: 0.1731s/iter; left time: 905.3389s
Epoch: 19 cost time: 82.28246116638184
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0007791
	speed: 0.6843s/iter; left time: 3462.7686s
	iters: 200, epoch: 20 | loss: 0.0039275
	speed: 0.1774s/iter; left time: 880.1187s
	iters: 300, epoch: 20 | loss: 0.0025379
	speed: 0.1756s/iter; left time: 853.4253s
	iters: 400, epoch: 20 | loss: 0.0025591
	speed: 0.1753s/iter; left time: 834.5182s
Epoch: 20 cost time: 82.6796383857727
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.984562 --> -0.985991).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0009828
	speed: 0.6762s/iter; left time: 3104.6194s
	iters: 200, epoch: 21 | loss: 0.0057411
	speed: 0.1739s/iter; left time: 780.9337s
	iters: 300, epoch: 21 | loss: 0.0696057
	speed: 0.1759s/iter; left time: 772.4051s
	iters: 400, epoch: 21 | loss: 0.0064970
	speed: 0.1750s/iter; left time: 750.9379s
Epoch: 21 cost time: 82.43856477737427
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0013814
	speed: 0.6660s/iter; left time: 2745.1395s
	iters: 200, epoch: 22 | loss: 0.0066772
	speed: 0.1687s/iter; left time: 678.6443s
	iters: 300, epoch: 22 | loss: 0.0039169
	speed: 0.1687s/iter; left time: 661.4988s
	iters: 400, epoch: 22 | loss: 0.0001132
	speed: 0.1672s/iter; left time: 638.8808s
Epoch: 22 cost time: 78.98641896247864
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0028599
	speed: 0.6401s/iter; left time: 2338.2310s
	iters: 200, epoch: 23 | loss: 0.0024325
	speed: 0.1652s/iter; left time: 586.9100s
	iters: 300, epoch: 23 | loss: 0.0008583
	speed: 0.1659s/iter; left time: 572.6978s
	iters: 400, epoch: 23 | loss: 0.0009236
	speed: 0.1628s/iter; left time: 546.0158s
Epoch: 23 cost time: 77.4429862499237
Epoch: 23, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0013299
	speed: 0.6357s/iter; left time: 2023.9403s
	iters: 200, epoch: 24 | loss: 0.0003830
	speed: 0.1646s/iter; left time: 507.6415s
	iters: 300, epoch: 24 | loss: 0.0032471
	speed: 0.1623s/iter; left time: 484.4230s
	iters: 400, epoch: 24 | loss: 0.0063702
	speed: 0.1645s/iter; left time: 474.3766s
Epoch: 24 cost time: 73.84510207176208
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0005010
	speed: 0.5779s/iter; left time: 1569.0489s
	iters: 200, epoch: 25 | loss: 0.0005212
	speed: 0.1608s/iter; left time: 420.5808s
	iters: 300, epoch: 25 | loss: 0.0170643
	speed: 0.1631s/iter; left time: 410.1245s
	iters: 400, epoch: 25 | loss: 0.0880860
	speed: 0.1652s/iter; left time: 399.0305s
Epoch: 25 cost time: 76.4598023891449
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0009224
	speed: 0.5941s/iter; left time: 1334.3422s
	iters: 200, epoch: 26 | loss: 0.0007415
	speed: 0.1588s/iter; left time: 340.8647s
	iters: 300, epoch: 26 | loss: 0.0001231
	speed: 0.1632s/iter; left time: 334.0009s
	iters: 400, epoch: 26 | loss: 0.0013187
	speed: 0.1620s/iter; left time: 315.2078s
Epoch: 26 cost time: 76.0750961303711
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0027095
	speed: 0.6532s/iter; left time: 1160.6727s
	iters: 200, epoch: 27 | loss: 0.0006169
	speed: 0.1682s/iter; left time: 282.0761s
	iters: 300, epoch: 27 | loss: 0.0007606
	speed: 0.1707s/iter; left time: 269.2189s
	iters: 400, epoch: 27 | loss: 0.0028349
	speed: 0.1704s/iter; left time: 251.6996s
Epoch: 27 cost time: 79.82691740989685
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0005968
	speed: 0.6537s/iter; left time: 855.0986s
	iters: 200, epoch: 28 | loss: 0.0011872
	speed: 0.1634s/iter; left time: 197.4125s
	iters: 300, epoch: 28 | loss: 0.0229432
	speed: 0.1722s/iter; left time: 190.8228s
	iters: 400, epoch: 28 | loss: 0.0052983
	speed: 0.1708s/iter; left time: 172.2143s
Epoch: 28 cost time: 79.72783541679382
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.985991 --> -0.986849).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0217692
	speed: 0.6642s/iter; left time: 557.2476s
	iters: 200, epoch: 29 | loss: 0.0035222
	speed: 0.1656s/iter; left time: 122.3474s
	iters: 300, epoch: 29 | loss: 0.0026653
	speed: 0.1663s/iter; left time: 106.2691s
	iters: 400, epoch: 29 | loss: 0.0015925
	speed: 0.1620s/iter; left time: 87.3385s
Epoch: 29 cost time: 78.11144614219666
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0012555
	speed: 0.6325s/iter; left time: 234.0332s
	iters: 200, epoch: 30 | loss: 0.0058579
	speed: 0.1624s/iter; left time: 43.8415s
	iters: 300, epoch: 30 | loss: 0.0187533
	speed: 0.1641s/iter; left time: 27.8954s
	iters: 400, epoch: 30 | loss: 0.1438670
	speed: 0.1704s/iter; left time: 11.9280s
Epoch: 30 cost time: 77.7136013507843
Epoch: 30, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9868496283590623
model parameter : 173354
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.2126803
	speed: 0.2108s/iter; left time: 2944.4040s
	iters: 200, epoch: 1 | loss: 1.6585555
	speed: 0.1983s/iter; left time: 2750.2089s
	iters: 300, epoch: 1 | loss: 1.4744612
	speed: 0.1944s/iter; left time: 2677.0644s
	iters: 400, epoch: 1 | loss: 0.8038147
	speed: 0.1947s/iter; left time: 2661.8349s
Epoch: 1 cost time: 93.57451605796814
Epoch: 1, Steps: 469 | Train Loss: 1.508 Vali Loss: 0.635 Vali Acc: 0.845 Test Loss: 0.635 Test Acc: 0.845
Validation loss decreased (inf --> -0.844762).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5707574
	speed: 0.6868s/iter; left time: 9272.5871s
	iters: 200, epoch: 2 | loss: 0.2494808
	speed: 0.1711s/iter; left time: 2293.6915s
	iters: 300, epoch: 2 | loss: 0.5993614
	speed: 0.1486s/iter; left time: 1976.8972s
	iters: 400, epoch: 2 | loss: 0.4605810
	speed: 0.1438s/iter; left time: 1898.1582s
Epoch: 2 cost time: 78.97579526901245
Epoch: 2, Steps: 469 | Train Loss: 0.360 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
Validation loss decreased (-0.844762 --> -0.919380).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1991394
	speed: 0.6775s/iter; left time: 8830.2387s
	iters: 200, epoch: 3 | loss: 0.1538537
	speed: 0.1843s/iter; left time: 2383.1349s
	iters: 300, epoch: 3 | loss: 0.1569169
	speed: 0.1747s/iter; left time: 2242.4444s
	iters: 400, epoch: 3 | loss: 0.0710071
	speed: 0.1875s/iter; left time: 2387.4926s
Epoch: 3 cost time: 87.18926787376404
Epoch: 3, Steps: 469 | Train Loss: 0.165 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.919380 --> -0.951685).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0217616
	speed: 0.6498s/iter; left time: 8164.5652s
	iters: 200, epoch: 4 | loss: 0.0427386
	speed: 0.1947s/iter; left time: 2427.1813s
	iters: 300, epoch: 4 | loss: 0.0321122
	speed: 0.1912s/iter; left time: 2364.5315s
	iters: 400, epoch: 4 | loss: 0.0366115
	speed: 0.1929s/iter; left time: 2365.8956s
Epoch: 4 cost time: 90.10658478736877
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.160 Vali Acc: 0.947 Test Loss: 0.160 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0087053
	speed: 0.6780s/iter; left time: 8200.8820s
	iters: 200, epoch: 5 | loss: 0.1288885
	speed: 0.2011s/iter; left time: 2412.3662s
	iters: 300, epoch: 5 | loss: 0.0375801
	speed: 0.1957s/iter; left time: 2327.7951s
	iters: 400, epoch: 5 | loss: 0.0264216
	speed: 0.1974s/iter; left time: 2328.7143s
Epoch: 5 cost time: 93.61140727996826
Epoch: 5, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.951685 --> -0.962263).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0799732
	speed: 0.7066s/iter; left time: 8215.1144s
	iters: 200, epoch: 6 | loss: 0.0852439
	speed: 0.2020s/iter; left time: 2327.8154s
	iters: 300, epoch: 6 | loss: 0.3253256
	speed: 0.1986s/iter; left time: 2269.1803s
	iters: 400, epoch: 6 | loss: 0.0214667
	speed: 0.1993s/iter; left time: 2256.7324s
Epoch: 6 cost time: 94.10380983352661
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.962263 --> -0.967695).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0073637
	speed: 0.6992s/iter; left time: 7801.1743s
	iters: 200, epoch: 7 | loss: 0.0141011
	speed: 0.1934s/iter; left time: 2138.9729s
	iters: 300, epoch: 7 | loss: 0.0070244
	speed: 0.1869s/iter; left time: 2047.3319s
	iters: 400, epoch: 7 | loss: 0.0058108
	speed: 0.1821s/iter; left time: 1977.4118s
Epoch: 7 cost time: 89.30183935165405
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.967695 --> -0.981417).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0052814
	speed: 0.6795s/iter; left time: 7262.1690s
	iters: 200, epoch: 8 | loss: 0.0092177
	speed: 0.2006s/iter; left time: 2123.8321s
	iters: 300, epoch: 8 | loss: 0.0617623
	speed: 0.1976s/iter; left time: 2072.7939s
	iters: 400, epoch: 8 | loss: 0.1533959
	speed: 0.1972s/iter; left time: 2048.7224s
Epoch: 8 cost time: 93.4238018989563
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0043852
	speed: 0.6952s/iter; left time: 7104.3377s
	iters: 200, epoch: 9 | loss: 0.0121169
	speed: 0.1968s/iter; left time: 1991.3177s
	iters: 300, epoch: 9 | loss: 0.1316955
	speed: 0.1945s/iter; left time: 1948.6048s
	iters: 400, epoch: 9 | loss: 0.0379138
	speed: 0.1910s/iter; left time: 1894.6914s
Epoch: 9 cost time: 90.40097522735596
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2870202
	speed: 0.6833s/iter; left time: 6661.8853s
	iters: 200, epoch: 10 | loss: 0.0529994
	speed: 0.1935s/iter; left time: 1867.3306s
	iters: 300, epoch: 10 | loss: 0.0202887
	speed: 0.1925s/iter; left time: 1838.3865s
	iters: 400, epoch: 10 | loss: 0.4895185
	speed: 0.1892s/iter; left time: 1787.5006s
Epoch: 10 cost time: 89.98917627334595
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0213728
	speed: 0.6259s/iter; left time: 5808.6338s
	iters: 200, epoch: 11 | loss: 0.0560281
	speed: 0.1839s/iter; left time: 1688.7624s
	iters: 300, epoch: 11 | loss: 0.0789382
	speed: 0.1836s/iter; left time: 1666.9674s
	iters: 400, epoch: 11 | loss: 0.0415929
	speed: 0.1816s/iter; left time: 1631.0007s
Epoch: 11 cost time: 86.31326603889465
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0044100
	speed: 0.6344s/iter; left time: 5590.0184s
	iters: 200, epoch: 12 | loss: 0.0267486
	speed: 0.1844s/iter; left time: 1606.2503s
	iters: 300, epoch: 12 | loss: 0.0744863
	speed: 0.1871s/iter; left time: 1611.0954s
	iters: 400, epoch: 12 | loss: 0.0025930
	speed: 0.1924s/iter; left time: 1637.9039s
Epoch: 12 cost time: 85.78900098800659
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0167008
	speed: 0.6788s/iter; left time: 5663.0903s
	iters: 200, epoch: 13 | loss: 0.0039927
	speed: 0.1905s/iter; left time: 1570.2669s
	iters: 300, epoch: 13 | loss: 0.0591754
	speed: 0.1901s/iter; left time: 1547.9581s
	iters: 400, epoch: 13 | loss: 0.0282253
	speed: 0.2000s/iter; left time: 1608.4389s
Epoch: 13 cost time: 90.97524929046631
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0148160
	speed: 0.6937s/iter; left time: 5462.2392s
	iters: 200, epoch: 14 | loss: 0.0142209
	speed: 0.2010s/iter; left time: 1562.9570s
	iters: 300, epoch: 14 | loss: 0.0016419
	speed: 0.2004s/iter; left time: 1537.5201s
	iters: 400, epoch: 14 | loss: 0.0093200
	speed: 0.1992s/iter; left time: 1508.8863s
Epoch: 14 cost time: 93.31526589393616
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0041710
	speed: 0.6760s/iter; left time: 5005.6837s
	iters: 200, epoch: 15 | loss: 0.0029576
	speed: 0.1894s/iter; left time: 1383.2376s
	iters: 300, epoch: 15 | loss: 0.0072608
	speed: 0.1755s/iter; left time: 1264.2745s
	iters: 400, epoch: 15 | loss: 0.0576636
	speed: 0.1341s/iter; left time: 952.5685s
Epoch: 15 cost time: 81.78879594802856
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0004104
	speed: 0.7043s/iter; left time: 4884.9726s
	iters: 200, epoch: 16 | loss: 0.0040651
	speed: 0.1982s/iter; left time: 1354.7898s
	iters: 300, epoch: 16 | loss: 0.0032010
	speed: 0.1962s/iter; left time: 1321.5884s
	iters: 400, epoch: 16 | loss: 0.0348774
	speed: 0.1998s/iter; left time: 1325.8861s
Epoch: 16 cost time: 94.06392812728882
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0008476
	speed: 0.7092s/iter; left time: 4586.7101s
	iters: 200, epoch: 17 | loss: 0.0014478
	speed: 0.1951s/iter; left time: 1242.1276s
	iters: 300, epoch: 17 | loss: 0.0014594
	speed: 0.1998s/iter; left time: 1252.4241s
	iters: 400, epoch: 17 | loss: 0.0019378
	speed: 0.1977s/iter; left time: 1219.0594s
Epoch: 17 cost time: 92.86861991882324
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0171669
	speed: 0.6862s/iter; left time: 4115.5728s
	iters: 200, epoch: 18 | loss: 0.0007855
	speed: 0.1986s/iter; left time: 1171.5790s
	iters: 300, epoch: 18 | loss: 0.0566921
	speed: 0.1985s/iter; left time: 1150.6293s
	iters: 400, epoch: 18 | loss: 0.1226129
	speed: 0.1947s/iter; left time: 1109.4614s
Epoch: 18 cost time: 91.83055543899536
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1711113
	speed: 0.6618s/iter; left time: 3658.9839s
	iters: 200, epoch: 19 | loss: 0.0074402
	speed: 0.1852s/iter; left time: 1005.3107s
	iters: 300, epoch: 19 | loss: 0.0030832
	speed: 0.1840s/iter; left time: 980.2976s
	iters: 400, epoch: 19 | loss: 0.0164484
	speed: 0.1781s/iter; left time: 931.0695s
Epoch: 19 cost time: 86.84257483482361
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0072502
	speed: 0.6927s/iter; left time: 3505.0923s
	iters: 200, epoch: 20 | loss: 0.0013992
	speed: 0.1934s/iter; left time: 959.1954s
	iters: 300, epoch: 20 | loss: 0.0021603
	speed: 0.1921s/iter; left time: 933.8257s
	iters: 400, epoch: 20 | loss: 0.0010257
	speed: 0.1962s/iter; left time: 933.8361s
Epoch: 20 cost time: 91.88416695594788
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 587338
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0730000
	speed: 0.1860s/iter; left time: 2598.4583s
	iters: 200, epoch: 1 | loss: 1.4804069
	speed: 0.1647s/iter; left time: 2284.3166s
	iters: 300, epoch: 1 | loss: 1.2229130
	speed: 0.1677s/iter; left time: 2309.6606s
	iters: 400, epoch: 1 | loss: 1.0022408
	speed: 0.1646s/iter; left time: 2250.3995s
Epoch: 1 cost time: 80.04755020141602
Epoch: 1, Steps: 469 | Train Loss: 1.517 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
Validation loss decreased (inf --> -0.833326).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4468957
	speed: 0.6511s/iter; left time: 8791.3154s
	iters: 200, epoch: 2 | loss: 0.3599551
	speed: 0.1715s/iter; left time: 2297.8395s
	iters: 300, epoch: 2 | loss: 0.4570028
	speed: 0.1711s/iter; left time: 2275.5539s
	iters: 400, epoch: 2 | loss: 0.2519764
	speed: 0.1689s/iter; left time: 2230.1077s
Epoch: 2 cost time: 79.67156648635864
Epoch: 2, Steps: 469 | Train Loss: 0.401 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
Validation loss decreased (-0.833326 --> -0.941964).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1952367
	speed: 0.5532s/iter; left time: 7209.6784s
	iters: 200, epoch: 3 | loss: 0.2337899
	speed: 0.1614s/iter; left time: 2087.8008s
	iters: 300, epoch: 3 | loss: 0.5287245
	speed: 0.1547s/iter; left time: 1985.6625s
	iters: 400, epoch: 3 | loss: 0.0235351
	speed: 0.1554s/iter; left time: 1979.1087s
Epoch: 3 cost time: 69.94576096534729
Epoch: 3, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
Validation loss decreased (-0.941964 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0621133
	speed: 0.6370s/iter; left time: 8003.1464s
	iters: 200, epoch: 4 | loss: 0.0404095
	speed: 0.1636s/iter; left time: 2038.5513s
	iters: 300, epoch: 4 | loss: 0.0525748
	speed: 0.1675s/iter; left time: 2070.5593s
	iters: 400, epoch: 4 | loss: 0.0919359
	speed: 0.1652s/iter; left time: 2026.1712s
Epoch: 4 cost time: 77.74004554748535
Epoch: 4, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.955973 --> -0.972841).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0311689
	speed: 0.6313s/iter; left time: 7635.7826s
	iters: 200, epoch: 5 | loss: 0.0200048
	speed: 0.1682s/iter; left time: 2018.0168s
	iters: 300, epoch: 5 | loss: 0.0754902
	speed: 0.1630s/iter; left time: 1938.4410s
	iters: 400, epoch: 5 | loss: 0.1318323
	speed: 0.1653s/iter; left time: 1949.2903s
Epoch: 5 cost time: 77.84647393226624
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0550448
	speed: 0.6365s/iter; left time: 7400.1212s
	iters: 200, epoch: 6 | loss: 0.0264341
	speed: 0.1632s/iter; left time: 1880.9956s
	iters: 300, epoch: 6 | loss: 0.0667208
	speed: 0.1639s/iter; left time: 1873.1512s
	iters: 400, epoch: 6 | loss: 0.0197256
	speed: 0.1562s/iter; left time: 1768.9700s
Epoch: 6 cost time: 76.2330801486969
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0115495
	speed: 0.6157s/iter; left time: 6869.7780s
	iters: 200, epoch: 7 | loss: 0.0718850
	speed: 0.1518s/iter; left time: 1678.9625s
	iters: 300, epoch: 7 | loss: 0.0044362
	speed: 0.1515s/iter; left time: 1659.4531s
	iters: 400, epoch: 7 | loss: 0.0149815
	speed: 0.1510s/iter; left time: 1639.8233s
Epoch: 7 cost time: 71.18086624145508
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1113030
	speed: 0.5387s/iter; left time: 5757.2471s
	iters: 200, epoch: 8 | loss: 0.0067389
	speed: 0.1624s/iter; left time: 1719.9901s
	iters: 300, epoch: 8 | loss: 0.0334175
	speed: 0.1545s/iter; left time: 1619.9256s
	iters: 400, epoch: 8 | loss: 0.0153258
	speed: 0.1600s/iter; left time: 1662.4039s
Epoch: 8 cost time: 74.4598183631897
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0694046
	speed: 0.6107s/iter; left time: 6241.2293s
	iters: 200, epoch: 9 | loss: 0.0216036
	speed: 0.1586s/iter; left time: 1604.4321s
	iters: 300, epoch: 9 | loss: 0.0084585
	speed: 0.1413s/iter; left time: 1415.7064s
	iters: 400, epoch: 9 | loss: 0.0186186
	speed: 0.1134s/iter; left time: 1124.6158s
Epoch: 9 cost time: 68.77123713493347
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1672478
	speed: 0.6371s/iter; left time: 6211.2837s
	iters: 200, epoch: 10 | loss: 0.0208432
	speed: 0.1603s/iter; left time: 1547.1206s
	iters: 300, epoch: 10 | loss: 0.0034924
	speed: 0.1608s/iter; left time: 1535.5636s
	iters: 400, epoch: 10 | loss: 0.0054035
	speed: 0.1625s/iter; left time: 1535.4685s
Epoch: 10 cost time: 75.87490677833557
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.972841 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0351731
	speed: 0.6279s/iter; left time: 5827.7739s
	iters: 200, epoch: 11 | loss: 0.0015922
	speed: 0.1660s/iter; left time: 1523.6809s
	iters: 300, epoch: 11 | loss: 0.0074519
	speed: 0.1563s/iter; left time: 1419.0774s
	iters: 400, epoch: 11 | loss: 0.0011349
	speed: 0.1561s/iter; left time: 1402.2301s
Epoch: 11 cost time: 75.26282525062561
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981989).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0022079
	speed: 0.6007s/iter; left time: 5293.1388s
	iters: 200, epoch: 12 | loss: 0.0063324
	speed: 0.1548s/iter; left time: 1348.5130s
	iters: 300, epoch: 12 | loss: 0.0077167
	speed: 0.1187s/iter; left time: 1022.4366s
	iters: 400, epoch: 12 | loss: 0.0084991
	speed: 0.1626s/iter; left time: 1384.4274s
Epoch: 12 cost time: 71.36920595169067
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0256057
	speed: 0.6469s/iter; left time: 5397.0902s
	iters: 200, epoch: 13 | loss: 0.0045029
	speed: 0.1675s/iter; left time: 1380.3710s
	iters: 300, epoch: 13 | loss: 0.0197276
	speed: 0.1685s/iter; left time: 1372.4499s
	iters: 400, epoch: 13 | loss: 0.0471536
	speed: 0.1683s/iter; left time: 1353.2913s
Epoch: 13 cost time: 78.86321949958801
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0019494
	speed: 0.6449s/iter; left time: 5078.2248s
	iters: 200, epoch: 14 | loss: 0.0078192
	speed: 0.1701s/iter; left time: 1322.4833s
	iters: 300, epoch: 14 | loss: 0.0826212
	speed: 0.1671s/iter; left time: 1282.3457s
	iters: 400, epoch: 14 | loss: 0.0104005
	speed: 0.1642s/iter; left time: 1243.3085s
Epoch: 14 cost time: 78.64709496498108
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0049730
	speed: 0.6433s/iter; left time: 4763.3137s
	iters: 200, epoch: 15 | loss: 0.0039233
	speed: 0.1668s/iter; left time: 1218.1984s
	iters: 300, epoch: 15 | loss: 0.1982291
	speed: 0.1652s/iter; left time: 1189.9280s
	iters: 400, epoch: 15 | loss: 0.0034671
	speed: 0.1671s/iter; left time: 1186.9657s
Epoch: 15 cost time: 78.55249810218811
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0014793
	speed: 0.6024s/iter; left time: 4178.1623s
	iters: 200, epoch: 16 | loss: 0.0660157
	speed: 0.1568s/iter; left time: 1071.9841s
	iters: 300, epoch: 16 | loss: 0.0023848
	speed: 0.1575s/iter; left time: 1060.7463s
	iters: 400, epoch: 16 | loss: 0.0013707
	speed: 0.1556s/iter; left time: 1032.3119s
Epoch: 16 cost time: 73.330078125
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0012395
	speed: 0.6289s/iter; left time: 4067.1664s
	iters: 200, epoch: 17 | loss: 0.0014333
	speed: 0.1665s/iter; left time: 1060.0281s
	iters: 300, epoch: 17 | loss: 0.0095370
	speed: 0.1641s/iter; left time: 1028.1355s
	iters: 400, epoch: 17 | loss: 0.0017847
	speed: 0.1650s/iter; left time: 1017.3010s
Epoch: 17 cost time: 77.96748948097229
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0005807
	speed: 0.6284s/iter; left time: 3768.9519s
	iters: 200, epoch: 18 | loss: 0.0256717
	speed: 0.1645s/iter; left time: 970.3905s
	iters: 300, epoch: 18 | loss: 0.0195146
	speed: 0.1677s/iter; left time: 972.1692s
	iters: 400, epoch: 18 | loss: 0.0034512
	speed: 0.1664s/iter; left time: 947.8708s
Epoch: 18 cost time: 77.64118361473083
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0012637
	speed: 0.6318s/iter; left time: 3493.0452s
	iters: 200, epoch: 19 | loss: 0.1846152
	speed: 0.1681s/iter; left time: 912.5062s
	iters: 300, epoch: 19 | loss: 0.0485770
	speed: 0.1671s/iter; left time: 890.4673s
	iters: 400, epoch: 19 | loss: 0.0006269
	speed: 0.1653s/iter; left time: 864.3238s
Epoch: 19 cost time: 78.23177075386047
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0100862
	speed: 0.6281s/iter; left time: 3178.0320s
	iters: 200, epoch: 20 | loss: 0.0076116
	speed: 0.1532s/iter; left time: 759.7069s
	iters: 300, epoch: 20 | loss: 0.0042786
	speed: 0.1554s/iter; left time: 755.4830s
	iters: 400, epoch: 20 | loss: 0.0072909
	speed: 0.1565s/iter; left time: 744.8426s
Epoch: 20 cost time: 73.48045587539673
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.981989 --> -0.987135).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0024894
	speed: 0.6030s/iter; left time: 2768.1843s
	iters: 200, epoch: 21 | loss: 0.0113975
	speed: 0.1660s/iter; left time: 745.6439s
	iters: 300, epoch: 21 | loss: 0.0970326
	speed: 0.1693s/iter; left time: 743.2666s
	iters: 400, epoch: 21 | loss: 0.0015318
	speed: 0.1692s/iter; left time: 725.8690s
Epoch: 21 cost time: 78.94860625267029
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0014552
	speed: 0.6401s/iter; left time: 2638.5160s
	iters: 200, epoch: 22 | loss: 0.0016117
	speed: 0.1644s/iter; left time: 661.1854s
	iters: 300, epoch: 22 | loss: 0.0036165
	speed: 0.1670s/iter; left time: 655.1066s
	iters: 400, epoch: 22 | loss: 0.0013254
	speed: 0.1663s/iter; left time: 635.7442s
Epoch: 22 cost time: 78.33363819122314
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0105990
	speed: 0.6438s/iter; left time: 2351.8790s
	iters: 200, epoch: 23 | loss: 0.0070910
	speed: 0.1648s/iter; left time: 585.6798s
	iters: 300, epoch: 23 | loss: 0.0001210
	speed: 0.1635s/iter; left time: 564.6143s
	iters: 400, epoch: 23 | loss: 0.0017232
	speed: 0.1183s/iter; left time: 396.8111s
Epoch: 23 cost time: 72.24283814430237
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0052259
	speed: 0.6281s/iter; left time: 1999.9269s
	iters: 200, epoch: 24 | loss: 0.0013836
	speed: 0.1603s/iter; left time: 494.4521s
	iters: 300, epoch: 24 | loss: 0.0021426
	speed: 0.1607s/iter; left time: 479.4261s
	iters: 400, epoch: 24 | loss: 0.0016861
	speed: 0.1536s/iter; left time: 442.9141s
Epoch: 24 cost time: 74.83265614509583
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0002584
	speed: 0.5987s/iter; left time: 1625.6061s
	iters: 200, epoch: 25 | loss: 0.0004059
	speed: 0.1557s/iter; left time: 407.1653s
	iters: 300, epoch: 25 | loss: 0.0058736
	speed: 0.1554s/iter; left time: 390.7713s
	iters: 400, epoch: 25 | loss: 0.0135882
	speed: 0.1630s/iter; left time: 393.5937s
Epoch: 25 cost time: 74.00567388534546
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0010604
	speed: 0.6302s/iter; left time: 1415.4381s
	iters: 200, epoch: 26 | loss: 0.0002320
	speed: 0.1558s/iter; left time: 334.4224s
	iters: 300, epoch: 26 | loss: 0.0000973
	speed: 0.1595s/iter; left time: 326.3611s
	iters: 400, epoch: 26 | loss: 0.0082798
	speed: 0.1601s/iter; left time: 311.5192s
Epoch: 26 cost time: 74.92090487480164
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0069392
	speed: 0.5887s/iter; left time: 1046.0618s
	iters: 200, epoch: 27 | loss: 0.0011984
	speed: 0.1491s/iter; left time: 250.0694s
	iters: 300, epoch: 27 | loss: 0.0038961
	speed: 0.1615s/iter; left time: 254.7228s
	iters: 400, epoch: 27 | loss: 0.0616428
	speed: 0.1578s/iter; left time: 233.0838s
Epoch: 27 cost time: 70.6604790687561
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0005329
	speed: 0.6297s/iter; left time: 823.7062s
	iters: 200, epoch: 28 | loss: 0.0008320
	speed: 0.1633s/iter; left time: 197.2133s
	iters: 300, epoch: 28 | loss: 0.0216247
	speed: 0.1618s/iter; left time: 179.2705s
	iters: 400, epoch: 28 | loss: 0.0173275
	speed: 0.1597s/iter; left time: 160.9306s
Epoch: 28 cost time: 75.48775815963745
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.057 Vali Acc: 0.981 Test Loss: 0.057 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1017575
	speed: 0.6055s/iter; left time: 507.9869s
	iters: 200, epoch: 29 | loss: 0.0038133
	speed: 0.1532s/iter; left time: 113.2269s
	iters: 300, epoch: 29 | loss: 0.0003654
	speed: 0.1532s/iter; left time: 97.9131s
	iters: 400, epoch: 29 | loss: 0.0621991
	speed: 0.1503s/iter; left time: 80.9894s
Epoch: 29 cost time: 71.67348647117615
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0011218
	speed: 0.6236s/iter; left time: 230.7167s
	iters: 200, epoch: 30 | loss: 0.2398481
	speed: 0.1656s/iter; left time: 44.7158s
	iters: 300, epoch: 30 | loss: 0.0017069
	speed: 0.1597s/iter; left time: 27.1455s
	iters: 400, epoch: 30 | loss: 0.0024341
	speed: 0.1593s/iter; left time: 11.1498s
Epoch: 30 cost time: 76.19015383720398
Epoch: 30, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9871355060034306
model parameter : 173354
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1145644
	speed: 0.5230s/iter; left time: 7306.5818s
	iters: 200, epoch: 1 | loss: 1.5320733
	speed: 0.5121s/iter; left time: 7103.8502s
	iters: 300, epoch: 1 | loss: 0.9230509
	speed: 0.5138s/iter; left time: 7075.8384s
	iters: 400, epoch: 1 | loss: 0.5206949
	speed: 0.5085s/iter; left time: 6952.2460s
Epoch: 1 cost time: 239.89771270751953
Epoch: 1, Steps: 469 | Train Loss: 1.453 Vali Loss: 0.553 Vali Acc: 0.868 Test Loss: 0.553 Test Acc: 0.868
Validation loss decreased (inf --> -0.868205).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5672569
	speed: 1.1744s/iter; left time: 15856.4837s
	iters: 200, epoch: 2 | loss: 0.2165191
	speed: 0.5113s/iter; left time: 6852.6836s
	iters: 300, epoch: 2 | loss: 0.1911847
	speed: 0.4520s/iter; left time: 6012.0051s
	iters: 400, epoch: 2 | loss: 0.0750439
	speed: 0.5038s/iter; left time: 6650.6468s
Epoch: 2 cost time: 228.97407174110413
Epoch: 2, Steps: 469 | Train Loss: 0.293 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
Validation loss decreased (-0.868205 --> -0.952828).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0361627
	speed: 1.1200s/iter; left time: 14596.9453s
	iters: 200, epoch: 3 | loss: 0.1056389
	speed: 0.4785s/iter; left time: 6189.0648s
	iters: 300, epoch: 3 | loss: 0.1557802
	speed: 0.4230s/iter; left time: 5428.1857s
	iters: 400, epoch: 3 | loss: 0.2866063
	speed: 0.4723s/iter; left time: 6013.6438s
Epoch: 3 cost time: 212.18520045280457
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.952828 --> -0.969124).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0650769
	speed: 1.1764s/iter; left time: 14780.7016s
	iters: 200, epoch: 4 | loss: 0.0173745
	speed: 0.4963s/iter; left time: 6185.8644s
	iters: 300, epoch: 4 | loss: 0.0567396
	speed: 0.5021s/iter; left time: 6207.8234s
	iters: 400, epoch: 4 | loss: 0.1988143
	speed: 0.4990s/iter; left time: 6119.5791s
Epoch: 4 cost time: 233.7300205230713
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.969124 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0125920
	speed: 1.2053s/iter; left time: 14577.7004s
	iters: 200, epoch: 5 | loss: 0.0178231
	speed: 0.5002s/iter; left time: 5999.4031s
	iters: 300, epoch: 5 | loss: 0.0343786
	speed: 0.4763s/iter; left time: 5665.2589s
	iters: 400, epoch: 5 | loss: 0.0811480
	speed: 0.3943s/iter; left time: 4650.3655s
Epoch: 5 cost time: 222.41678166389465
Epoch: 5, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.977415).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0181659
	speed: 1.2365s/iter; left time: 14375.0255s
	iters: 200, epoch: 6 | loss: 0.0304543
	speed: 0.5156s/iter; left time: 5943.1250s
	iters: 300, epoch: 6 | loss: 0.0081021
	speed: 0.5094s/iter; left time: 5820.5655s
	iters: 400, epoch: 6 | loss: 0.0127823
	speed: 0.5112s/iter; left time: 5789.5087s
Epoch: 6 cost time: 240.5383653640747
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.980845).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0063299
	speed: 1.2369s/iter; left time: 13800.3614s
	iters: 200, epoch: 7 | loss: 0.0078100
	speed: 0.4793s/iter; left time: 5300.1691s
	iters: 300, epoch: 7 | loss: 0.0243079
	speed: 0.4875s/iter; left time: 5341.9394s
	iters: 400, epoch: 7 | loss: 0.0076862
	speed: 0.5080s/iter; left time: 5515.2504s
Epoch: 7 cost time: 234.0513768196106
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.982275).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0045246
	speed: 1.2351s/iter; left time: 13200.5853s
	iters: 200, epoch: 8 | loss: 0.0113101
	speed: 0.5037s/iter; left time: 5332.7161s
	iters: 300, epoch: 8 | loss: 0.0034542
	speed: 0.5142s/iter; left time: 5392.8044s
	iters: 400, epoch: 8 | loss: 0.0052071
	speed: 0.5026s/iter; left time: 5221.1250s
Epoch: 8 cost time: 238.7532820701599
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0727543
	speed: 1.1977s/iter; left time: 12238.8791s
	iters: 200, epoch: 9 | loss: 0.0101886
	speed: 0.4850s/iter; left time: 4907.6802s
	iters: 300, epoch: 9 | loss: 0.0313932
	speed: 0.5072s/iter; left time: 5081.4118s
	iters: 400, epoch: 9 | loss: 0.3673497
	speed: 0.5120s/iter; left time: 5078.3191s
Epoch: 9 cost time: 233.92886233329773
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0032797
	speed: 1.2377s/iter; left time: 12067.1930s
	iters: 200, epoch: 10 | loss: 0.0037011
	speed: 0.5072s/iter; left time: 4894.1678s
	iters: 300, epoch: 10 | loss: 0.0019100
	speed: 0.5136s/iter; left time: 4904.5404s
	iters: 400, epoch: 10 | loss: 0.0051248
	speed: 0.5057s/iter; left time: 4778.4265s
Epoch: 10 cost time: 237.77174997329712
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.982847).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0053933
	speed: 1.1799s/iter; left time: 10950.8254s
	iters: 200, epoch: 11 | loss: 0.0008162
	speed: 0.5072s/iter; left time: 4656.9716s
	iters: 300, epoch: 11 | loss: 0.0063434
	speed: 0.5129s/iter; left time: 4657.6011s
	iters: 400, epoch: 11 | loss: 0.2798321
	speed: 0.5094s/iter; left time: 4575.1218s
Epoch: 11 cost time: 238.04244089126587
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0013498
	speed: 1.1708s/iter; left time: 10317.4512s
	iters: 200, epoch: 12 | loss: 0.0146551
	speed: 0.4987s/iter; left time: 4345.0974s
	iters: 300, epoch: 12 | loss: 0.0064933
	speed: 0.4835s/iter; left time: 4163.5133s
	iters: 400, epoch: 12 | loss: 0.0178587
	speed: 0.4741s/iter; left time: 4035.8214s
Epoch: 12 cost time: 222.95760703086853
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0035003
	speed: 1.1814s/iter; left time: 9856.7423s
	iters: 200, epoch: 13 | loss: 0.0035915
	speed: 0.4952s/iter; left time: 4082.0102s
	iters: 300, epoch: 13 | loss: 0.0149885
	speed: 0.4965s/iter; left time: 4042.6388s
	iters: 400, epoch: 13 | loss: 0.3996977
	speed: 0.4965s/iter; left time: 3993.2864s
Epoch: 13 cost time: 233.63716053962708
Epoch: 13, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0021851
	speed: 1.1553s/iter; left time: 9097.0444s
	iters: 200, epoch: 14 | loss: 0.0082758
	speed: 0.4838s/iter; left time: 3760.9138s
	iters: 300, epoch: 14 | loss: 0.0084434
	speed: 0.4611s/iter; left time: 3538.1429s
	iters: 400, epoch: 14 | loss: 0.0027652
	speed: 0.3962s/iter; left time: 3000.8792s
Epoch: 14 cost time: 216.0956792831421
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0006543
	speed: 1.1390s/iter; left time: 8434.0883s
	iters: 200, epoch: 15 | loss: 0.0009639
	speed: 0.5007s/iter; left time: 3657.2630s
	iters: 300, epoch: 15 | loss: 0.0071539
	speed: 0.5053s/iter; left time: 3641.0384s
	iters: 400, epoch: 15 | loss: 0.0018881
	speed: 0.5071s/iter; left time: 3603.1229s
Epoch: 15 cost time: 236.33471703529358
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983132).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0005037
	speed: 1.2190s/iter; left time: 8454.6764s
	iters: 200, epoch: 16 | loss: 0.0037572
	speed: 0.5062s/iter; left time: 3460.6119s
	iters: 300, epoch: 16 | loss: 0.0017524
	speed: 0.5088s/iter; left time: 3427.1909s
	iters: 400, epoch: 16 | loss: 0.0131378
	speed: 0.5069s/iter; left time: 3363.6308s
Epoch: 16 cost time: 237.42859840393066
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0189603
	speed: 1.1893s/iter; left time: 7691.4920s
	iters: 200, epoch: 17 | loss: 0.0398545
	speed: 0.5044s/iter; left time: 3211.5381s
	iters: 300, epoch: 17 | loss: 0.0013248
	speed: 0.5136s/iter; left time: 3218.5028s
	iters: 400, epoch: 17 | loss: 0.0015678
	speed: 0.4953s/iter; left time: 3054.7202s
Epoch: 17 cost time: 237.22096347808838
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983132 --> -0.984848).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0041672
	speed: 1.1929s/iter; left time: 7155.1658s
	iters: 200, epoch: 18 | loss: 0.0221123
	speed: 0.4950s/iter; left time: 2919.6169s
	iters: 300, epoch: 18 | loss: 0.0018608
	speed: 0.5138s/iter; left time: 2979.0142s
	iters: 400, epoch: 18 | loss: 0.0107483
	speed: 0.5082s/iter; left time: 2895.5017s
Epoch: 18 cost time: 236.8243110179901
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.984848 --> -0.985134).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0007850
	speed: 1.2323s/iter; left time: 6813.2821s
	iters: 200, epoch: 19 | loss: 0.0008978
	speed: 0.5112s/iter; left time: 2775.0756s
	iters: 300, epoch: 19 | loss: 0.0010396
	speed: 0.5132s/iter; left time: 2734.9291s
	iters: 400, epoch: 19 | loss: 0.0011695
	speed: 0.5082s/iter; left time: 2657.2403s
Epoch: 19 cost time: 239.76873540878296
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0035100
	speed: 1.1764s/iter; left time: 5952.5567s
	iters: 200, epoch: 20 | loss: 0.0085864
	speed: 0.4910s/iter; left time: 2435.1827s
	iters: 300, epoch: 20 | loss: 0.0006861
	speed: 0.4965s/iter; left time: 2413.2003s
	iters: 400, epoch: 20 | loss: 0.0017779
	speed: 0.4901s/iter; left time: 2332.9126s
Epoch: 20 cost time: 227.94366216659546
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
Validation loss decreased (-0.985134 --> -0.985705).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0009676
	speed: 1.1815s/iter; left time: 5424.3564s
	iters: 200, epoch: 21 | loss: 0.0093075
	speed: 0.4738s/iter; left time: 2128.0129s
	iters: 300, epoch: 21 | loss: 0.0007990
	speed: 0.4789s/iter; left time: 2103.0627s
	iters: 400, epoch: 21 | loss: 0.0007170
	speed: 0.4705s/iter; left time: 2018.8056s
Epoch: 21 cost time: 225.15848350524902
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0012991
	speed: 1.1642s/iter; left time: 4798.7504s
	iters: 200, epoch: 22 | loss: 0.0013208
	speed: 0.5020s/iter; left time: 2019.0240s
	iters: 300, epoch: 22 | loss: 0.0008062
	speed: 0.5144s/iter; left time: 2017.2930s
	iters: 400, epoch: 22 | loss: 0.0029588
	speed: 0.5108s/iter; left time: 1952.3840s
Epoch: 22 cost time: 234.27042198181152
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0003771
	speed: 1.2450s/iter; left time: 4548.0847s
	iters: 200, epoch: 23 | loss: 0.0280516
	speed: 0.5062s/iter; left time: 1798.5914s
	iters: 300, epoch: 23 | loss: 0.0016902
	speed: 0.5186s/iter; left time: 1790.7460s
	iters: 400, epoch: 23 | loss: 0.0008372
	speed: 0.5104s/iter; left time: 1711.5239s
Epoch: 23 cost time: 240.72338914871216
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0007758
	speed: 1.2375s/iter; left time: 3940.0981s
	iters: 200, epoch: 24 | loss: 0.0013488
	speed: 0.5087s/iter; left time: 1568.7693s
	iters: 300, epoch: 24 | loss: 0.0234849
	speed: 0.4974s/iter; left time: 1484.1507s
	iters: 400, epoch: 24 | loss: 0.0014238
	speed: 0.4930s/iter; left time: 1421.8282s
Epoch: 24 cost time: 236.20351934432983
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0003351
	speed: 1.1705s/iter; left time: 3177.8219s
	iters: 200, epoch: 25 | loss: 0.0049573
	speed: 0.5031s/iter; left time: 1315.5737s
	iters: 300, epoch: 25 | loss: 0.0009913
	speed: 0.5068s/iter; left time: 1274.6654s
	iters: 400, epoch: 25 | loss: 0.0017922
	speed: 0.5104s/iter; left time: 1232.5852s
Epoch: 25 cost time: 233.11055040359497
Epoch: 25, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0100389
	speed: 1.2160s/iter; left time: 2731.0381s
	iters: 200, epoch: 26 | loss: 0.0033794
	speed: 0.5137s/iter; left time: 1102.3391s
	iters: 300, epoch: 26 | loss: 0.0007458
	speed: 0.4819s/iter; left time: 985.9175s
	iters: 400, epoch: 26 | loss: 0.0047186
	speed: 0.4573s/iter; left time: 889.8796s
Epoch: 26 cost time: 229.18393445014954
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0015995
	speed: 1.1502s/iter; left time: 2043.9630s
	iters: 200, epoch: 27 | loss: 0.0025921
	speed: 0.4922s/iter; left time: 825.4868s
	iters: 300, epoch: 27 | loss: 0.0508746
	speed: 0.4995s/iter; left time: 787.7651s
	iters: 400, epoch: 27 | loss: 0.0006466
	speed: 0.4822s/iter; left time: 712.2762s
Epoch: 27 cost time: 229.48006868362427
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0016422
	speed: 1.1481s/iter; left time: 1501.7646s
	iters: 200, epoch: 28 | loss: 0.0005607
	speed: 0.4292s/iter; left time: 518.4187s
	iters: 300, epoch: 28 | loss: 0.0238719
	speed: 0.5070s/iter; left time: 561.8056s
	iters: 400, epoch: 28 | loss: 0.0013532
	speed: 0.5066s/iter; left time: 510.6598s
Epoch: 28 cost time: 226.80810165405273
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0025852
	speed: 1.2218s/iter; left time: 1025.0837s
	iters: 200, epoch: 29 | loss: 0.0030037
	speed: 0.5063s/iter; left time: 374.1424s
	iters: 300, epoch: 29 | loss: 0.0125671
	speed: 0.5075s/iter; left time: 324.2761s
	iters: 400, epoch: 29 | loss: 0.0016814
	speed: 0.5103s/iter; left time: 275.0562s
Epoch: 29 cost time: 238.3861894607544
Epoch: 29, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0006824
	speed: 1.2307s/iter; left time: 455.3493s
	iters: 200, epoch: 30 | loss: 0.0017163
	speed: 0.5095s/iter; left time: 137.5730s
	iters: 300, epoch: 30 | loss: 0.0001854
	speed: 0.5107s/iter; left time: 86.8274s
	iters: 400, epoch: 30 | loss: 0.0015628
	speed: 0.5113s/iter; left time: 35.7937s
Epoch: 30 cost time: 239.36754202842712
Epoch: 30, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 294090
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1184964
	speed: 0.3408s/iter; left time: 4761.8616s
	iters: 200, epoch: 1 | loss: 1.9038367
	speed: 0.3287s/iter; left time: 4559.0862s
	iters: 300, epoch: 1 | loss: 1.4226501
	speed: 0.3179s/iter; left time: 4378.4716s
	iters: 400, epoch: 1 | loss: 0.9170647
	speed: 0.2670s/iter; left time: 3649.9047s
Epoch: 1 cost time: 146.33784127235413
Epoch: 1, Steps: 469 | Train Loss: 1.607 Vali Loss: 0.698 Vali Acc: 0.834 Test Loss: 0.698 Test Acc: 0.834
Validation loss decreased (inf --> -0.833612).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3968810
	speed: 0.8353s/iter; left time: 11278.0804s
	iters: 200, epoch: 2 | loss: 0.4877094
	speed: 0.3175s/iter; left time: 4255.2982s
	iters: 300, epoch: 2 | loss: 0.2757632
	speed: 0.3179s/iter; left time: 4228.0856s
	iters: 400, epoch: 2 | loss: 0.0646413
	speed: 0.3158s/iter; left time: 4169.6927s
Epoch: 2 cost time: 148.74132108688354
Epoch: 2, Steps: 469 | Train Loss: 0.377 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
Validation loss decreased (-0.833612 --> -0.918522).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1089334
	speed: 0.8834s/iter; left time: 11512.9837s
	iters: 200, epoch: 3 | loss: 0.1666471
	speed: 0.3119s/iter; left time: 4034.0569s
	iters: 300, epoch: 3 | loss: 0.1612819
	speed: 0.3207s/iter; left time: 4115.3840s
	iters: 400, epoch: 3 | loss: 0.1488546
	speed: 0.3168s/iter; left time: 4033.3752s
Epoch: 3 cost time: 144.57048535346985
Epoch: 3, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.918522 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2929046
	speed: 0.8087s/iter; left time: 10160.5244s
	iters: 200, epoch: 4 | loss: 0.0744490
	speed: 0.3301s/iter; left time: 4114.5899s
	iters: 300, epoch: 4 | loss: 0.0555918
	speed: 0.3300s/iter; left time: 4079.6719s
	iters: 400, epoch: 4 | loss: 0.1319376
	speed: 0.3325s/iter; left time: 4077.6837s
Epoch: 4 cost time: 154.78899788856506
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.957117 --> -0.969410).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0526781
	speed: 0.9093s/iter; left time: 10997.5974s
	iters: 200, epoch: 5 | loss: 0.0337714
	speed: 0.3314s/iter; left time: 3974.9310s
	iters: 300, epoch: 5 | loss: 0.0099702
	speed: 0.3328s/iter; left time: 3958.2746s
	iters: 400, epoch: 5 | loss: 0.0579183
	speed: 0.3292s/iter; left time: 3882.3498s
Epoch: 5 cost time: 154.7723433971405
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.969410 --> -0.975128).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1088784
	speed: 0.8824s/iter; left time: 10258.8452s
	iters: 200, epoch: 6 | loss: 0.0491165
	speed: 0.3157s/iter; left time: 3638.7374s
	iters: 300, epoch: 6 | loss: 0.0419126
	speed: 0.3222s/iter; left time: 3681.6880s
	iters: 400, epoch: 6 | loss: 0.0755843
	speed: 0.3166s/iter; left time: 3586.1286s
Epoch: 6 cost time: 150.29059672355652
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0979360
	speed: 0.8676s/iter; left time: 9679.9076s
	iters: 200, epoch: 7 | loss: 0.0232818
	speed: 0.3141s/iter; left time: 3473.2304s
	iters: 300, epoch: 7 | loss: 0.0159958
	speed: 0.3150s/iter; left time: 3451.3216s
	iters: 400, epoch: 7 | loss: 0.0304179
	speed: 0.3110s/iter; left time: 3376.9654s
Epoch: 7 cost time: 138.27389574050903
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0363062
	speed: 0.7993s/iter; left time: 8543.2894s
	iters: 200, epoch: 8 | loss: 0.0932321
	speed: 0.3060s/iter; left time: 3240.1736s
	iters: 300, epoch: 8 | loss: 0.0052160
	speed: 0.3077s/iter; left time: 3226.8820s
	iters: 400, epoch: 8 | loss: 0.0184334
	speed: 0.2631s/iter; left time: 2733.4354s
Epoch: 8 cost time: 141.7978482246399
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975128 --> -0.975985).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0368814
	speed: 0.9142s/iter; left time: 9342.2090s
	iters: 200, epoch: 9 | loss: 0.0213383
	speed: 0.3351s/iter; left time: 3390.8500s
	iters: 300, epoch: 9 | loss: 0.0028217
	speed: 0.2992s/iter; left time: 2997.6360s
	iters: 400, epoch: 9 | loss: 0.0038112
	speed: 0.3152s/iter; left time: 3126.0135s
Epoch: 9 cost time: 150.8836019039154
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0036703
	speed: 0.9264s/iter; left time: 9032.1546s
	iters: 200, epoch: 10 | loss: 0.0038745
	speed: 0.3325s/iter; left time: 3208.8200s
	iters: 300, epoch: 10 | loss: 0.1070927
	speed: 0.3308s/iter; left time: 3159.2024s
	iters: 400, epoch: 10 | loss: 0.0016033
	speed: 0.3232s/iter; left time: 3054.4518s
Epoch: 10 cost time: 154.83439445495605
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.975985 --> -0.980274).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3827940
	speed: 0.8955s/iter; left time: 8310.9960s
	iters: 200, epoch: 11 | loss: 0.0003364
	speed: 0.3182s/iter; left time: 2921.4703s
	iters: 300, epoch: 11 | loss: 0.1392570
	speed: 0.3358s/iter; left time: 3049.6003s
	iters: 400, epoch: 11 | loss: 0.0053091
	speed: 0.3337s/iter; left time: 2997.2121s
Epoch: 11 cost time: 154.9498429298401
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0106993
	speed: 0.9406s/iter; left time: 8288.6140s
	iters: 200, epoch: 12 | loss: 0.0073635
	speed: 0.3388s/iter; left time: 2951.7133s
	iters: 300, epoch: 12 | loss: 0.0010460
	speed: 0.3321s/iter; left time: 2860.3163s
	iters: 400, epoch: 12 | loss: 0.0028824
	speed: 0.2904s/iter; left time: 2471.5137s
Epoch: 12 cost time: 152.54442620277405
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0504019
	speed: 0.9083s/iter; left time: 7578.1521s
	iters: 200, epoch: 13 | loss: 0.0026572
	speed: 0.3283s/iter; left time: 2706.2556s
	iters: 300, epoch: 13 | loss: 0.0170340
	speed: 0.3318s/iter; left time: 2701.6840s
	iters: 400, epoch: 13 | loss: 0.0023418
	speed: 0.3283s/iter; left time: 2640.7150s
Epoch: 13 cost time: 154.52445936203003
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0103049
	speed: 0.7965s/iter; left time: 6271.9824s
	iters: 200, epoch: 14 | loss: 0.0007951
	speed: 0.3241s/iter; left time: 2519.2759s
	iters: 300, epoch: 14 | loss: 0.1592506
	speed: 0.3233s/iter; left time: 2480.7309s
	iters: 400, epoch: 14 | loss: 0.1403335
	speed: 0.3230s/iter; left time: 2446.5469s
Epoch: 14 cost time: 145.8478820323944
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1741595
	speed: 0.8910s/iter; left time: 6597.9182s
	iters: 200, epoch: 15 | loss: 0.1448271
	speed: 0.3122s/iter; left time: 2280.5195s
	iters: 300, epoch: 15 | loss: 0.1087194
	speed: 0.3115s/iter; left time: 2243.9991s
	iters: 400, epoch: 15 | loss: 0.0002166
	speed: 0.3113s/iter; left time: 2212.0526s
Epoch: 15 cost time: 146.9023859500885
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.980274 --> -0.982275).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1908851
	speed: 0.8646s/iter; left time: 5997.1997s
	iters: 200, epoch: 16 | loss: 0.0043876
	speed: 0.2985s/iter; left time: 2040.5438s
	iters: 300, epoch: 16 | loss: 0.0067634
	speed: 0.2853s/iter; left time: 1921.9341s
	iters: 400, epoch: 16 | loss: 0.0009044
	speed: 0.3013s/iter; left time: 1999.5915s
Epoch: 16 cost time: 136.09043431282043
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0025317
	speed: 0.8194s/iter; left time: 5298.9072s
	iters: 200, epoch: 17 | loss: 0.0089272
	speed: 0.3169s/iter; left time: 2017.7235s
	iters: 300, epoch: 17 | loss: 0.0007651
	speed: 0.2831s/iter; left time: 1774.0354s
	iters: 400, epoch: 17 | loss: 0.0014797
	speed: 0.3287s/iter; left time: 2027.1182s
Epoch: 17 cost time: 147.54893326759338
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1391890
	speed: 0.9206s/iter; left time: 5521.5683s
	iters: 200, epoch: 18 | loss: 0.2311853
	speed: 0.3327s/iter; left time: 1962.4917s
	iters: 300, epoch: 18 | loss: 0.0004697
	speed: 0.3359s/iter; left time: 1947.7390s
	iters: 400, epoch: 18 | loss: 0.0003146
	speed: 0.3330s/iter; left time: 1897.1726s
Epoch: 18 cost time: 156.3912706375122
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0137068
	speed: 0.9210s/iter; left time: 5092.2694s
	iters: 200, epoch: 19 | loss: 0.0010431
	speed: 0.3332s/iter; left time: 1808.6852s
	iters: 300, epoch: 19 | loss: 0.0508312
	speed: 0.3362s/iter; left time: 1791.3973s
	iters: 400, epoch: 19 | loss: 0.0024219
	speed: 0.3294s/iter; left time: 1722.2046s
Epoch: 19 cost time: 157.35365962982178
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0176458
	speed: 0.8537s/iter; left time: 4319.6147s
	iters: 200, epoch: 20 | loss: 0.0034406
	speed: 0.3058s/iter; left time: 1516.7978s
	iters: 300, epoch: 20 | loss: 0.0005994
	speed: 0.3107s/iter; left time: 1509.9907s
	iters: 400, epoch: 20 | loss: 0.0007353
	speed: 0.3097s/iter; left time: 1474.3807s
Epoch: 20 cost time: 145.23931455612183
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0036295
	speed: 0.8893s/iter; left time: 4082.6020s
	iters: 200, epoch: 21 | loss: 0.0021526
	speed: 0.3234s/iter; left time: 1452.2178s
	iters: 300, epoch: 21 | loss: 0.0018363
	speed: 0.2889s/iter; left time: 1268.4425s
	iters: 400, epoch: 21 | loss: 0.0038689
	speed: 0.3219s/iter; left time: 1381.4659s
Epoch: 21 cost time: 145.45037961006165
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0333790
	speed: 0.8390s/iter; left time: 3458.2560s
	iters: 200, epoch: 22 | loss: 0.0008735
	speed: 0.2987s/iter; left time: 1201.1846s
	iters: 300, epoch: 22 | loss: 0.0011962
	speed: 0.3186s/iter; left time: 1249.7157s
	iters: 400, epoch: 22 | loss: 0.0004481
	speed: 0.3184s/iter; left time: 1216.7540s
Epoch: 22 cost time: 146.4491732120514
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.4034452
	speed: 0.8851s/iter; left time: 3233.4004s
	iters: 200, epoch: 23 | loss: 0.0702608
	speed: 0.3203s/iter; left time: 1138.2011s
	iters: 300, epoch: 23 | loss: 0.0008584
	speed: 0.2991s/iter; left time: 1032.7689s
	iters: 400, epoch: 23 | loss: 0.0003617
	speed: 0.2817s/iter; left time: 944.5172s
Epoch: 23 cost time: 143.26742887496948
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0010762
	speed: 0.8250s/iter; left time: 2626.8812s
	iters: 200, epoch: 24 | loss: 0.0485316
	speed: 0.2914s/iter; left time: 898.6967s
	iters: 300, epoch: 24 | loss: 0.0015447
	speed: 0.2808s/iter; left time: 837.7738s
	iters: 400, epoch: 24 | loss: 0.0007406
	speed: 0.2427s/iter; left time: 699.9181s
Epoch: 24 cost time: 125.39489221572876
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0016493
	speed: 0.7553s/iter; left time: 2050.5166s
	iters: 200, epoch: 25 | loss: 0.0028291
	speed: 0.2926s/iter; left time: 765.0318s
	iters: 300, epoch: 25 | loss: 0.0061545
	speed: 0.2862s/iter; left time: 719.8743s
	iters: 400, epoch: 25 | loss: 0.0014809
	speed: 0.2960s/iter; left time: 714.8139s
Epoch: 25 cost time: 138.00820636749268
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 87082
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1163301
	speed: 0.3183s/iter; left time: 4446.7429s
	iters: 200, epoch: 1 | loss: 1.5352426
	speed: 0.3289s/iter; left time: 4562.2395s
	iters: 300, epoch: 1 | loss: 0.9593073
	speed: 0.3307s/iter; left time: 4553.8320s
	iters: 400, epoch: 1 | loss: 0.5428687
	speed: 0.3307s/iter; left time: 4521.5060s
Epoch: 1 cost time: 151.9519271850586
Epoch: 1, Steps: 469 | Train Loss: 1.463 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (inf --> -0.875352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5286248
	speed: 0.9012s/iter; left time: 12167.9187s
	iters: 200, epoch: 2 | loss: 0.2397708
	speed: 0.3557s/iter; left time: 4767.4712s
	iters: 300, epoch: 2 | loss: 0.2178785
	speed: 0.3523s/iter; left time: 4685.7826s
	iters: 400, epoch: 2 | loss: 0.1107660
	speed: 0.3102s/iter; left time: 4095.4867s
Epoch: 2 cost time: 159.87377190589905
Epoch: 2, Steps: 469 | Train Loss: 0.309 Vali Loss: 0.206 Vali Acc: 0.942 Test Loss: 0.206 Test Acc: 0.942
Validation loss decreased (-0.875352 --> -0.941965).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0783060
	speed: 0.8651s/iter; left time: 11274.7862s
	iters: 200, epoch: 3 | loss: 0.1059243
	speed: 0.3264s/iter; left time: 4221.4269s
	iters: 300, epoch: 3 | loss: 0.1392229
	speed: 0.3241s/iter; left time: 4159.2158s
	iters: 400, epoch: 3 | loss: 0.2522588
	speed: 0.3190s/iter; left time: 4061.3599s
Epoch: 3 cost time: 151.22399044036865
Epoch: 3, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.941965 --> -0.965122).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0897444
	speed: 0.8555s/iter; left time: 10748.7073s
	iters: 200, epoch: 4 | loss: 0.0144050
	speed: 0.3072s/iter; left time: 3828.6740s
	iters: 300, epoch: 4 | loss: 0.0270760
	speed: 0.2672s/iter; left time: 3303.1403s
	iters: 400, epoch: 4 | loss: 0.2514344
	speed: 0.3131s/iter; left time: 3839.4859s
Epoch: 4 cost time: 139.32765698432922
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.965122 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0127791
	speed: 0.8494s/iter; left time: 10273.9968s
	iters: 200, epoch: 5 | loss: 0.0387283
	speed: 0.3475s/iter; left time: 4168.2615s
	iters: 300, epoch: 5 | loss: 0.0775123
	speed: 0.3457s/iter; left time: 4111.6824s
	iters: 400, epoch: 5 | loss: 0.1338078
	speed: 0.3517s/iter; left time: 4148.7831s
Epoch: 5 cost time: 163.3902463912964
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.971125 --> -0.975699).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0185621
	speed: 0.8922s/iter; left time: 10373.2486s
	iters: 200, epoch: 6 | loss: 0.0816614
	speed: 0.3529s/iter; left time: 4067.2171s
	iters: 300, epoch: 6 | loss: 0.0132870
	speed: 0.3524s/iter; left time: 4026.1769s
	iters: 400, epoch: 6 | loss: 0.0145546
	speed: 0.3418s/iter; left time: 3871.0736s
Epoch: 6 cost time: 158.49076581001282
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.979416).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0040248
	speed: 0.9070s/iter; left time: 10119.9567s
	iters: 200, epoch: 7 | loss: 0.0046182
	speed: 0.3354s/iter; left time: 3707.9997s
	iters: 300, epoch: 7 | loss: 0.0583124
	speed: 0.3371s/iter; left time: 3693.3992s
	iters: 400, epoch: 7 | loss: 0.0080912
	speed: 0.3402s/iter; left time: 3693.3617s
Epoch: 7 cost time: 158.71152782440186
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0052504
	speed: 0.9078s/iter; left time: 9702.5462s
	iters: 200, epoch: 8 | loss: 0.0082689
	speed: 0.3347s/iter; left time: 3543.5389s
	iters: 300, epoch: 8 | loss: 0.0029227
	speed: 0.2671s/iter; left time: 2801.0376s
	iters: 400, epoch: 8 | loss: 0.0054277
	speed: 0.3001s/iter; left time: 3117.8063s
Epoch: 8 cost time: 146.4503951072693
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0697674
	speed: 0.8831s/iter; left time: 9024.6254s
	iters: 200, epoch: 9 | loss: 0.0104291
	speed: 0.3186s/iter; left time: 3224.1247s
	iters: 300, epoch: 9 | loss: 0.0391225
	speed: 0.2631s/iter; left time: 2635.8000s
	iters: 400, epoch: 9 | loss: 0.4125290
	speed: 0.2804s/iter; left time: 2780.9178s
Epoch: 9 cost time: 142.58142042160034
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0034306
	speed: 0.8982s/iter; left time: 8757.1710s
	iters: 200, epoch: 10 | loss: 0.0039049
	speed: 0.3286s/iter; left time: 3170.5258s
	iters: 300, epoch: 10 | loss: 0.0070585
	speed: 0.3266s/iter; left time: 3119.1013s
	iters: 400, epoch: 10 | loss: 0.0033689
	speed: 0.3133s/iter; left time: 2960.5782s
Epoch: 10 cost time: 152.6503164768219
Epoch: 10, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979988).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0076706
	speed: 0.8563s/iter; left time: 7947.7699s
	iters: 200, epoch: 11 | loss: 0.0007690
	speed: 0.2483s/iter; left time: 2280.0760s
	iters: 300, epoch: 11 | loss: 0.0080800
	speed: 0.3033s/iter; left time: 2754.5056s
	iters: 400, epoch: 11 | loss: 0.1616527
	speed: 0.2689s/iter; left time: 2415.2458s
Epoch: 11 cost time: 132.91814160346985
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0063714
	speed: 0.7874s/iter; left time: 6938.3471s
	iters: 200, epoch: 12 | loss: 0.0086395
	speed: 0.3302s/iter; left time: 2876.6677s
	iters: 300, epoch: 12 | loss: 0.0127858
	speed: 0.3331s/iter; left time: 2868.9645s
	iters: 400, epoch: 12 | loss: 0.0671850
	speed: 0.3448s/iter; left time: 2934.5562s
Epoch: 12 cost time: 154.56150579452515
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0029648
	speed: 0.9190s/iter; left time: 7667.2171s
	iters: 200, epoch: 13 | loss: 0.0016266
	speed: 0.3338s/iter; left time: 2751.3707s
	iters: 300, epoch: 13 | loss: 0.0019331
	speed: 0.3328s/iter; left time: 2710.3702s
	iters: 400, epoch: 13 | loss: 0.0736290
	speed: 0.3382s/iter; left time: 2720.3403s
Epoch: 13 cost time: 154.3935432434082
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.979988 --> -0.987421).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0012424
	speed: 0.8465s/iter; left time: 6665.2620s
	iters: 200, epoch: 14 | loss: 0.0090292
	speed: 0.3315s/iter; left time: 2577.3795s
	iters: 300, epoch: 14 | loss: 0.0093431
	speed: 0.3138s/iter; left time: 2407.8481s
	iters: 400, epoch: 14 | loss: 0.0022916
	speed: 0.3170s/iter; left time: 2400.6968s
Epoch: 14 cost time: 147.53953766822815
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0006761
	speed: 0.8141s/iter; left time: 6028.3949s
	iters: 200, epoch: 15 | loss: 0.0043443
	speed: 0.2831s/iter; left time: 2068.0420s
	iters: 300, epoch: 15 | loss: 0.0115297
	speed: 0.3118s/iter; left time: 2246.8534s
	iters: 400, epoch: 15 | loss: 0.0010287
	speed: 0.3189s/iter; left time: 2265.7747s
Epoch: 15 cost time: 143.3818645477295
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0006313
	speed: 0.8409s/iter; left time: 5832.8010s
	iters: 200, epoch: 16 | loss: 0.0099899
	speed: 0.2515s/iter; left time: 1719.4426s
	iters: 300, epoch: 16 | loss: 0.0008655
	speed: 0.2953s/iter; left time: 1988.8564s
	iters: 400, epoch: 16 | loss: 0.0314315
	speed: 0.3049s/iter; left time: 2023.4792s
Epoch: 16 cost time: 137.96015524864197
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0299436
	speed: 0.7325s/iter; left time: 4737.0685s
	iters: 200, epoch: 17 | loss: 0.0401698
	speed: 0.3264s/iter; left time: 2078.0182s
	iters: 300, epoch: 17 | loss: 0.0021705
	speed: 0.3134s/iter; left time: 1964.3623s
	iters: 400, epoch: 17 | loss: 0.0019333
	speed: 0.3164s/iter; left time: 1951.4200s
Epoch: 17 cost time: 138.20877981185913
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0011668
	speed: 0.8044s/iter; left time: 4824.6936s
	iters: 200, epoch: 18 | loss: 0.0230486
	speed: 0.2794s/iter; left time: 1648.1194s
	iters: 300, epoch: 18 | loss: 0.0023607
	speed: 0.2932s/iter; left time: 1700.0882s
	iters: 400, epoch: 18 | loss: 0.0056254
	speed: 0.2582s/iter; left time: 1471.4757s
Epoch: 18 cost time: 124.26483535766602
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
Validation loss decreased (-0.987421 --> -0.989136).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0008851
	speed: 0.7112s/iter; left time: 3932.3680s
	iters: 200, epoch: 19 | loss: 0.0021072
	speed: 0.2953s/iter; left time: 1602.9209s
	iters: 300, epoch: 19 | loss: 0.0011464
	speed: 0.2936s/iter; left time: 1564.5299s
	iters: 400, epoch: 19 | loss: 0.0004291
	speed: 0.2894s/iter; left time: 1513.1365s
Epoch: 19 cost time: 138.45430874824524
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0009136
	speed: 0.7241s/iter; left time: 3663.8062s
	iters: 200, epoch: 20 | loss: 0.0109059
	speed: 0.2326s/iter; left time: 1153.5244s
	iters: 300, epoch: 20 | loss: 0.0046208
	speed: 0.2993s/iter; left time: 1454.5065s
	iters: 400, epoch: 20 | loss: 0.0013506
	speed: 0.3011s/iter; left time: 1433.2342s
Epoch: 20 cost time: 127.57606792449951
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0002600
	speed: 0.7943s/iter; left time: 3646.5051s
	iters: 200, epoch: 21 | loss: 0.0079696
	speed: 0.3280s/iter; left time: 1473.2720s
	iters: 300, epoch: 21 | loss: 0.0012681
	speed: 0.3260s/iter; left time: 1431.4799s
	iters: 400, epoch: 21 | loss: 0.0019452
	speed: 0.3271s/iter; left time: 1403.6646s
Epoch: 21 cost time: 152.40362095832825
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0098501
	speed: 0.8001s/iter; left time: 3298.2085s
	iters: 200, epoch: 22 | loss: 0.0012327
	speed: 0.2882s/iter; left time: 1159.2664s
	iters: 300, epoch: 22 | loss: 0.0012696
	speed: 0.2931s/iter; left time: 1149.5076s
	iters: 400, epoch: 22 | loss: 0.0011593
	speed: 0.2523s/iter; left time: 964.3727s
Epoch: 22 cost time: 127.07777738571167
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002249
	speed: 0.7190s/iter; left time: 2626.6058s
	iters: 200, epoch: 23 | loss: 0.0089753
	speed: 0.2837s/iter; left time: 1008.0867s
	iters: 300, epoch: 23 | loss: 0.0025715
	speed: 0.2750s/iter; left time: 949.4815s
	iters: 400, epoch: 23 | loss: 0.0163298
	speed: 0.2359s/iter; left time: 790.9338s
Epoch: 23 cost time: 121.78769779205322
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0008933
	speed: 0.6777s/iter; left time: 2157.6726s
	iters: 200, epoch: 24 | loss: 0.0006926
	speed: 0.3100s/iter; left time: 956.0740s
	iters: 300, epoch: 24 | loss: 0.0276912
	speed: 0.3067s/iter; left time: 915.1753s
	iters: 400, epoch: 24 | loss: 0.0019719
	speed: 0.3022s/iter; left time: 871.4059s
Epoch: 24 cost time: 132.56214666366577
Epoch: 24, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0008491
	speed: 0.8503s/iter; left time: 2308.6705s
	iters: 200, epoch: 25 | loss: 0.0036616
	speed: 0.3344s/iter; left time: 874.3397s
	iters: 300, epoch: 25 | loss: 0.0005039
	speed: 0.3348s/iter; left time: 841.9113s
	iters: 400, epoch: 25 | loss: 0.0019563
	speed: 0.3063s/iter; left time: 739.7267s
Epoch: 25 cost time: 151.1062798500061
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0024364
	speed: 0.8411s/iter; left time: 1889.1645s
	iters: 200, epoch: 26 | loss: 0.0149227
	speed: 0.3061s/iter; left time: 656.9793s
	iters: 300, epoch: 26 | loss: 0.0040625
	speed: 0.2997s/iter; left time: 613.2040s
	iters: 400, epoch: 26 | loss: 0.0073915
	speed: 0.2564s/iter; left time: 498.9676s
Epoch: 26 cost time: 139.11115646362305
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0017802
	speed: 0.7586s/iter; left time: 1348.1057s
	iters: 200, epoch: 27 | loss: 0.0046955
	speed: 0.2893s/iter; left time: 485.1498s
	iters: 300, epoch: 27 | loss: 0.0276129
	speed: 0.2958s/iter; left time: 466.5497s
	iters: 400, epoch: 27 | loss: 0.0003300
	speed: 0.2986s/iter; left time: 441.0177s
Epoch: 27 cost time: 136.5616319179535
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0049544
	speed: 0.7974s/iter; left time: 1043.0007s
	iters: 200, epoch: 28 | loss: 0.0005009
	speed: 0.2544s/iter; left time: 307.3270s
	iters: 300, epoch: 28 | loss: 0.0074777
	speed: 0.3005s/iter; left time: 332.9481s
	iters: 400, epoch: 28 | loss: 0.0053656
	speed: 0.2722s/iter; left time: 274.3499s
Epoch: 28 cost time: 130.5468783378601
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.989136649514008
model parameter : 294090
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1191337
	speed: 0.2180s/iter; left time: 3045.4475s
	iters: 200, epoch: 1 | loss: 1.9160653
	speed: 0.2015s/iter; left time: 2795.2269s
	iters: 300, epoch: 1 | loss: 1.4397806
	speed: 0.1644s/iter; left time: 2264.1955s
	iters: 400, epoch: 1 | loss: 0.9480471
	speed: 0.2052s/iter; left time: 2805.2490s
Epoch: 1 cost time: 93.70679473876953
Epoch: 1, Steps: 469 | Train Loss: 1.611 Vali Loss: 0.708 Vali Acc: 0.829 Test Loss: 0.708 Test Acc: 0.829
Validation loss decreased (inf --> -0.829324).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4183391
	speed: 0.6112s/iter; left time: 8252.8639s
	iters: 200, epoch: 2 | loss: 0.4806781
	speed: 0.1948s/iter; left time: 2610.7980s
	iters: 300, epoch: 2 | loss: 0.2815219
	speed: 0.1962s/iter; left time: 2610.1854s
	iters: 400, epoch: 2 | loss: 0.0766308
	speed: 0.1909s/iter; left time: 2519.6191s
Epoch: 2 cost time: 84.5035834312439
Epoch: 2, Steps: 469 | Train Loss: 0.387 Vali Loss: 0.250 Vali Acc: 0.915 Test Loss: 0.250 Test Acc: 0.915
Validation loss decreased (-0.829324 --> -0.914520).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1501869
	speed: 0.5262s/iter; left time: 6858.5296s
	iters: 200, epoch: 3 | loss: 0.2019196
	speed: 0.1673s/iter; left time: 2163.2926s
	iters: 300, epoch: 3 | loss: 0.1794067
	speed: 0.1468s/iter; left time: 1883.5194s
	iters: 400, epoch: 3 | loss: 0.1799457
	speed: 0.0739s/iter; left time: 941.1058s
Epoch: 3 cost time: 67.08666610717773
Epoch: 3, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.914520 --> -0.959118).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3017810
	speed: 0.6222s/iter; left time: 7817.2188s
	iters: 200, epoch: 4 | loss: 0.0527439
	speed: 0.2200s/iter; left time: 2741.5290s
	iters: 300, epoch: 4 | loss: 0.0680786
	speed: 0.2133s/iter; left time: 2636.9238s
	iters: 400, epoch: 4 | loss: 0.1411330
	speed: 0.2204s/iter; left time: 2702.8406s
Epoch: 4 cost time: 101.3985538482666
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.959118 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0794787
	speed: 0.6839s/iter; left time: 8271.5472s
	iters: 200, epoch: 5 | loss: 0.0175821
	speed: 0.1637s/iter; left time: 1963.4473s
	iters: 300, epoch: 5 | loss: 0.0161012
	speed: 0.2061s/iter; left time: 2451.2293s
	iters: 400, epoch: 5 | loss: 0.0174099
	speed: 0.2080s/iter; left time: 2453.2809s
Epoch: 5 cost time: 93.63849234580994
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973412 --> -0.973412).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1612583
	speed: 0.6480s/iter; left time: 7533.4232s
	iters: 200, epoch: 6 | loss: 0.0544430
	speed: 0.1981s/iter; left time: 2283.6522s
	iters: 300, epoch: 6 | loss: 0.0475742
	speed: 0.1939s/iter; left time: 2215.8851s
	iters: 400, epoch: 6 | loss: 0.1042255
	speed: 0.1754s/iter; left time: 1986.7815s
Epoch: 6 cost time: 88.50421166419983
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0820554
	speed: 0.6110s/iter; left time: 6816.8443s
	iters: 200, epoch: 7 | loss: 0.0483971
	speed: 0.2102s/iter; left time: 2324.0877s
	iters: 300, epoch: 7 | loss: 0.0156700
	speed: 0.2086s/iter; left time: 2285.7463s
	iters: 400, epoch: 7 | loss: 0.0131431
	speed: 0.2084s/iter; left time: 2262.9542s
Epoch: 7 cost time: 98.37566018104553
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
Validation loss decreased (-0.973412 --> -0.973984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1159549
	speed: 0.6413s/iter; left time: 6854.4366s
	iters: 200, epoch: 8 | loss: 0.1630308
	speed: 0.1701s/iter; left time: 1801.1839s
	iters: 300, epoch: 8 | loss: 0.0208781
	speed: 0.1866s/iter; left time: 1956.6323s
	iters: 400, epoch: 8 | loss: 0.0218766
	speed: 0.1928s/iter; left time: 2002.6640s
Epoch: 8 cost time: 87.7016372680664
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0998399
	speed: 0.6023s/iter; left time: 6154.6716s
	iters: 200, epoch: 9 | loss: 0.0179244
	speed: 0.1483s/iter; left time: 1500.4145s
	iters: 300, epoch: 9 | loss: 0.0055919
	speed: 0.1675s/iter; left time: 1678.0856s
	iters: 400, epoch: 9 | loss: 0.0037984
	speed: 0.1774s/iter; left time: 1759.2111s
Epoch: 9 cost time: 80.4572536945343
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.976271).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0022535
	speed: 0.5279s/iter; left time: 5147.4301s
	iters: 200, epoch: 10 | loss: 0.0061341
	speed: 0.1767s/iter; left time: 1705.3636s
	iters: 300, epoch: 10 | loss: 0.1417479
	speed: 0.1813s/iter; left time: 1731.4611s
	iters: 400, epoch: 10 | loss: 0.0044881
	speed: 0.1714s/iter; left time: 1619.9766s
Epoch: 10 cost time: 79.74037384986877
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.978558).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4530258
	speed: 0.5921s/iter; left time: 5495.3642s
	iters: 200, epoch: 11 | loss: 0.0007212
	speed: 0.1760s/iter; left time: 1615.8387s
	iters: 300, epoch: 11 | loss: 0.0418694
	speed: 0.2126s/iter; left time: 1930.6812s
	iters: 400, epoch: 11 | loss: 0.0156490
	speed: 0.2143s/iter; left time: 1924.5136s
Epoch: 11 cost time: 92.75383949279785
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0089869
	speed: 0.6684s/iter; left time: 5889.8236s
	iters: 200, epoch: 12 | loss: 0.0111065
	speed: 0.2115s/iter; left time: 1842.5660s
	iters: 300, epoch: 12 | loss: 0.0015151
	speed: 0.2176s/iter; left time: 1874.3368s
	iters: 400, epoch: 12 | loss: 0.0050441
	speed: 0.2124s/iter; left time: 1808.1546s
Epoch: 12 cost time: 96.95581030845642
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979416).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0183085
	speed: 0.6069s/iter; left time: 5063.7122s
	iters: 200, epoch: 13 | loss: 0.0010231
	speed: 0.2064s/iter; left time: 1701.6925s
	iters: 300, epoch: 13 | loss: 0.0109184
	speed: 0.2001s/iter; left time: 1629.0378s
	iters: 400, epoch: 13 | loss: 0.0023788
	speed: 0.1851s/iter; left time: 1489.0955s
Epoch: 13 cost time: 88.9256386756897
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0038708
	speed: 0.5605s/iter; left time: 4413.3903s
	iters: 200, epoch: 14 | loss: 0.0027141
	speed: 0.1996s/iter; left time: 1551.7685s
	iters: 300, epoch: 14 | loss: 0.1113940
	speed: 0.2010s/iter; left time: 1542.2345s
	iters: 400, epoch: 14 | loss: 0.2201937
	speed: 0.2024s/iter; left time: 1533.1553s
Epoch: 14 cost time: 94.32938194274902
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0253587
	speed: 0.5634s/iter; left time: 4171.6737s
	iters: 200, epoch: 15 | loss: 0.0263643
	speed: 0.1275s/iter; left time: 931.6822s
	iters: 300, epoch: 15 | loss: 0.2829841
	speed: 0.1453s/iter; left time: 1047.1405s
	iters: 400, epoch: 15 | loss: 0.0003190
	speed: 0.1689s/iter; left time: 1200.1423s
Epoch: 15 cost time: 70.69862151145935
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0688047
	speed: 0.5339s/iter; left time: 3702.9240s
	iters: 200, epoch: 16 | loss: 0.0032707
	speed: 0.1917s/iter; left time: 1310.6164s
	iters: 300, epoch: 16 | loss: 0.0030603
	speed: 0.1920s/iter; left time: 1293.5627s
	iters: 400, epoch: 16 | loss: 0.0005594
	speed: 0.1889s/iter; left time: 1253.4532s
Epoch: 16 cost time: 88.89755487442017
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0015495
	speed: 0.5633s/iter; left time: 3642.6752s
	iters: 200, epoch: 17 | loss: 0.0110622
	speed: 0.1774s/iter; left time: 1129.7756s
	iters: 300, epoch: 17 | loss: 0.0067421
	speed: 0.1742s/iter; left time: 1092.0005s
	iters: 400, epoch: 17 | loss: 0.0019139
	speed: 0.1625s/iter; left time: 1002.3362s
Epoch: 17 cost time: 82.15733408927917
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0034360
	speed: 0.5944s/iter; left time: 3565.0123s
	iters: 200, epoch: 18 | loss: 0.0024313
	speed: 0.1893s/iter; left time: 1116.4656s
	iters: 300, epoch: 18 | loss: 0.0050282
	speed: 0.2049s/iter; left time: 1188.0177s
	iters: 400, epoch: 18 | loss: 0.0013278
	speed: 0.2033s/iter; left time: 1158.2096s
Epoch: 18 cost time: 89.77538323402405
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0100928
	speed: 0.5899s/iter; left time: 3261.3791s
	iters: 200, epoch: 19 | loss: 0.0006843
	speed: 0.1726s/iter; left time: 936.8547s
	iters: 300, epoch: 19 | loss: 0.0220752
	speed: 0.1863s/iter; left time: 992.7934s
	iters: 400, epoch: 19 | loss: 0.0007891
	speed: 0.1890s/iter; left time: 988.1956s
Epoch: 19 cost time: 83.64729070663452
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0088102
	speed: 0.5481s/iter; left time: 2773.3887s
	iters: 200, epoch: 20 | loss: 0.0030593
	speed: 0.2031s/iter; left time: 1007.2987s
	iters: 300, epoch: 20 | loss: 0.0004175
	speed: 0.2103s/iter; left time: 1022.0782s
	iters: 400, epoch: 20 | loss: 0.0004985
	speed: 0.2041s/iter; left time: 971.4820s
Epoch: 20 cost time: 90.46902251243591
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0033240
	speed: 0.6194s/iter; left time: 2843.6042s
	iters: 200, epoch: 21 | loss: 0.0016648
	speed: 0.1598s/iter; left time: 717.5219s
	iters: 300, epoch: 21 | loss: 0.0061319
	speed: 0.1860s/iter; left time: 816.6903s
	iters: 400, epoch: 21 | loss: 0.0049739
	speed: 0.1988s/iter; left time: 853.2561s
Epoch: 21 cost time: 86.90745949745178
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0427628
	speed: 0.6282s/iter; left time: 2589.3243s
	iters: 200, epoch: 22 | loss: 0.0106233
	speed: 0.2108s/iter; left time: 847.9469s
	iters: 300, epoch: 22 | loss: 0.0007061
	speed: 0.1677s/iter; left time: 657.7856s
	iters: 400, epoch: 22 | loss: 0.0024661
	speed: 0.1877s/iter; left time: 717.5608s
Epoch: 22 cost time: 89.65334868431091
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3057899
	speed: 0.6065s/iter; left time: 2215.5722s
	iters: 200, epoch: 23 | loss: 0.0575088
	speed: 0.1937s/iter; left time: 688.1779s
	iters: 300, epoch: 23 | loss: 0.1332193
	speed: 0.1917s/iter; left time: 661.8486s
	iters: 400, epoch: 23 | loss: 0.0037380
	speed: 0.1632s/iter; left time: 547.2612s
Epoch: 23 cost time: 87.33562421798706
Epoch: 23, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981989).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0018980
	speed: 0.5445s/iter; left time: 1733.5977s
	iters: 200, epoch: 24 | loss: 0.0121413
	speed: 0.1756s/iter; left time: 541.6192s
	iters: 300, epoch: 24 | loss: 0.0014823
	speed: 0.1543s/iter; left time: 460.3051s
	iters: 400, epoch: 24 | loss: 0.0007749
	speed: 0.1691s/iter; left time: 487.7400s
Epoch: 24 cost time: 79.48651599884033
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0150394
	speed: 0.5409s/iter; left time: 1468.5568s
	iters: 200, epoch: 25 | loss: 0.0039334
	speed: 0.1419s/iter; left time: 371.1280s
	iters: 300, epoch: 25 | loss: 0.0009499
	speed: 0.1857s/iter; left time: 467.1110s
	iters: 400, epoch: 25 | loss: 0.0008842
	speed: 0.2096s/iter; left time: 506.0760s
Epoch: 25 cost time: 84.85188221931458
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0281308
	speed: 0.6513s/iter; left time: 1462.9077s
	iters: 200, epoch: 26 | loss: 0.0000687
	speed: 0.1671s/iter; left time: 358.5247s
	iters: 300, epoch: 26 | loss: 0.0012874
	speed: 0.1863s/iter; left time: 381.1549s
	iters: 400, epoch: 26 | loss: 0.0191620
	speed: 0.1913s/iter; left time: 372.2771s
Epoch: 26 cost time: 88.60632514953613
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0357215
	speed: 0.5868s/iter; left time: 1042.7354s
	iters: 200, epoch: 27 | loss: 0.0007408
	speed: 0.1781s/iter; left time: 298.6602s
	iters: 300, epoch: 27 | loss: 0.0020607
	speed: 0.1699s/iter; left time: 267.9041s
	iters: 400, epoch: 27 | loss: 0.0008581
	speed: 0.1623s/iter; left time: 239.6596s
Epoch: 27 cost time: 78.59803318977356
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983132).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0011147
	speed: 0.5546s/iter; left time: 725.3658s
	iters: 200, epoch: 28 | loss: 0.0011572
	speed: 0.1891s/iter; left time: 228.4849s
	iters: 300, epoch: 28 | loss: 0.0022105
	speed: 0.1581s/iter; left time: 175.2253s
	iters: 400, epoch: 28 | loss: 0.1100718
	speed: 0.0735s/iter; left time: 74.1353s
Epoch: 28 cost time: 64.04966759681702
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0027116
	speed: 0.2950s/iter; left time: 247.5114s
	iters: 200, epoch: 29 | loss: 0.0060416
	speed: 0.1474s/iter; left time: 108.9005s
	iters: 300, epoch: 29 | loss: 0.0115925
	speed: 0.1499s/iter; left time: 95.7763s
	iters: 400, epoch: 29 | loss: 0.0038876
	speed: 0.1501s/iter; left time: 80.9241s
Epoch: 29 cost time: 70.14349126815796
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0004825
	speed: 0.4888s/iter; left time: 180.8506s
	iters: 200, epoch: 30 | loss: 0.0010282
	speed: 0.1263s/iter; left time: 34.1093s
	iters: 300, epoch: 30 | loss: 0.0020547
	speed: 0.1595s/iter; left time: 27.1089s
	iters: 400, epoch: 30 | loss: 0.0059489
	speed: 0.1663s/iter; left time: 11.6430s
Epoch: 30 cost time: 72.2546637058258
Epoch: 30, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 87082
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1226780
	speed: 0.1299s/iter; left time: 1815.1308s
	iters: 200, epoch: 1 | loss: 1.5739146
	speed: 0.1297s/iter; left time: 1799.5592s
	iters: 300, epoch: 1 | loss: 1.0459765
	speed: 0.1062s/iter; left time: 1462.2549s
	iters: 400, epoch: 1 | loss: 0.6350994
	speed: 0.0961s/iter; left time: 1313.8963s
Epoch: 1 cost time: 57.22824692726135
Epoch: 1, Steps: 469 | Train Loss: 1.534 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (inf --> -0.822177).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6576381
	speed: 0.5501s/iter; left time: 7427.2394s
	iters: 200, epoch: 2 | loss: 0.3745463
	speed: 0.1646s/iter; left time: 2205.3136s
	iters: 300, epoch: 2 | loss: 0.2343592
	speed: 0.1686s/iter; left time: 2242.3740s
	iters: 400, epoch: 2 | loss: 0.1893777
	speed: 0.1640s/iter; left time: 2164.9051s
Epoch: 2 cost time: 77.93672275543213
Epoch: 2, Steps: 469 | Train Loss: 0.404 Vali Loss: 0.259 Vali Acc: 0.916 Test Loss: 0.259 Test Acc: 0.916
Validation loss decreased (-0.822177 --> -0.915664).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1020166
	speed: 0.4980s/iter; left time: 6489.8123s
	iters: 200, epoch: 3 | loss: 0.1869058
	speed: 0.1321s/iter; left time: 1707.8081s
	iters: 300, epoch: 3 | loss: 0.3507625
	speed: 0.1174s/iter; left time: 1507.2137s
	iters: 400, epoch: 3 | loss: 0.3094392
	speed: 0.1265s/iter; left time: 1610.2249s
Epoch: 3 cost time: 61.50383734703064
Epoch: 3, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.147 Vali Acc: 0.953 Test Loss: 0.147 Test Acc: 0.953
Validation loss decreased (-0.915664 --> -0.953400).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1348683
	speed: 0.4487s/iter; left time: 5637.7692s
	iters: 200, epoch: 4 | loss: 0.0279218
	speed: 0.1127s/iter; left time: 1404.1684s
	iters: 300, epoch: 4 | loss: 0.0642585
	speed: 0.1252s/iter; left time: 1548.2428s
	iters: 400, epoch: 4 | loss: 0.3444617
	speed: 0.1417s/iter; left time: 1737.5561s
Epoch: 4 cost time: 61.66029906272888
Epoch: 4, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.953400 --> -0.962263).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0154196
	speed: 0.4178s/iter; left time: 5053.8321s
	iters: 200, epoch: 5 | loss: 0.0231679
	speed: 0.1236s/iter; left time: 1482.1104s
	iters: 300, epoch: 5 | loss: 0.0453958
	speed: 0.1220s/iter; left time: 1451.2987s
	iters: 400, epoch: 5 | loss: 0.0358152
	speed: 0.1224s/iter; left time: 1443.5430s
Epoch: 5 cost time: 56.935465812683105
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
Validation loss decreased (-0.962263 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0250493
	speed: 0.3526s/iter; left time: 4099.3131s
	iters: 200, epoch: 6 | loss: 0.0732242
	speed: 0.0989s/iter; left time: 1139.9525s
	iters: 300, epoch: 6 | loss: 0.0495963
	speed: 0.0620s/iter; left time: 708.2926s
	iters: 400, epoch: 6 | loss: 0.1235445
	speed: 0.0836s/iter; left time: 946.4594s
Epoch: 6 cost time: 43.13070249557495
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.969124 --> -0.975128).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0185783
	speed: 0.4642s/iter; left time: 5179.1699s
	iters: 200, epoch: 7 | loss: 0.0171212
	speed: 0.1368s/iter; left time: 1512.2739s
	iters: 300, epoch: 7 | loss: 0.0523669
	speed: 0.1368s/iter; left time: 1499.1743s
	iters: 400, epoch: 7 | loss: 0.0118913
	speed: 0.1393s/iter; left time: 1512.4055s
Epoch: 7 cost time: 63.81832718849182
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0048434
	speed: 0.4234s/iter; left time: 4525.6283s
	iters: 200, epoch: 8 | loss: 0.0226220
	speed: 0.1238s/iter; left time: 1310.6155s
	iters: 300, epoch: 8 | loss: 0.0165257
	speed: 0.1239s/iter; left time: 1299.9724s
	iters: 400, epoch: 8 | loss: 0.0026785
	speed: 0.1116s/iter; left time: 1159.3009s
Epoch: 8 cost time: 56.05803179740906
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0351213
	speed: 0.3566s/iter; left time: 3644.2801s
	iters: 200, epoch: 9 | loss: 0.0130645
	speed: 0.1252s/iter; left time: 1266.4909s
	iters: 300, epoch: 9 | loss: 0.1191889
	speed: 0.1134s/iter; left time: 1135.7284s
	iters: 400, epoch: 9 | loss: 0.3064537
	speed: 0.0764s/iter; left time: 757.3229s
Epoch: 9 cost time: 47.58016562461853
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0059026
	speed: 0.3802s/iter; left time: 3707.1977s
	iters: 200, epoch: 10 | loss: 0.0075266
	speed: 0.1157s/iter; left time: 1116.6111s
	iters: 300, epoch: 10 | loss: 0.0104711
	speed: 0.1163s/iter; left time: 1110.9795s
	iters: 400, epoch: 10 | loss: 0.0099546
	speed: 0.1079s/iter; left time: 1019.3845s
Epoch: 10 cost time: 53.2330801486969
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0056639
	speed: 0.3811s/iter; left time: 3536.6747s
	iters: 200, epoch: 11 | loss: 0.0029455
	speed: 0.0886s/iter; left time: 813.0143s
	iters: 300, epoch: 11 | loss: 0.0366854
	speed: 0.0905s/iter; left time: 821.8946s
	iters: 400, epoch: 11 | loss: 0.2721013
	speed: 0.0785s/iter; left time: 704.9738s
Epoch: 11 cost time: 43.30484628677368
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.977129).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0045323
	speed: 0.2816s/iter; left time: 2481.1723s
	iters: 200, epoch: 12 | loss: 0.3809727
	speed: 0.1136s/iter; left time: 989.7725s
	iters: 300, epoch: 12 | loss: 0.0639383
	speed: 0.1161s/iter; left time: 999.8932s
	iters: 400, epoch: 12 | loss: 0.0059458
	speed: 0.1175s/iter; left time: 1000.3787s
Epoch: 12 cost time: 52.22810125350952
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977701).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0026364
	speed: 0.4039s/iter; left time: 3369.6262s
	iters: 200, epoch: 13 | loss: 0.0030956
	speed: 0.1169s/iter; left time: 963.6369s
	iters: 300, epoch: 13 | loss: 0.0070616
	speed: 0.1160s/iter; left time: 944.7398s
	iters: 400, epoch: 13 | loss: 0.1991224
	speed: 0.1151s/iter; left time: 925.6703s
Epoch: 13 cost time: 55.13565468788147
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.977701 --> -0.982561).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0016518
	speed: 0.3837s/iter; left time: 3021.5277s
	iters: 200, epoch: 14 | loss: 0.0060412
	speed: 0.0847s/iter; left time: 658.7170s
	iters: 300, epoch: 14 | loss: 0.0020953
	speed: 0.0591s/iter; left time: 453.5165s
	iters: 400, epoch: 14 | loss: 0.0022823
	speed: 0.0622s/iter; left time: 471.4323s
Epoch: 14 cost time: 39.066635608673096
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.982561 --> -0.982847).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0017371
	speed: 0.3808s/iter; left time: 2819.6011s
	iters: 200, epoch: 15 | loss: 0.0041323
	speed: 0.1080s/iter; left time: 789.1848s
	iters: 300, epoch: 15 | loss: 0.0141530
	speed: 0.1118s/iter; left time: 805.7642s
	iters: 400, epoch: 15 | loss: 0.0014116
	speed: 0.1099s/iter; left time: 780.5195s
Epoch: 15 cost time: 52.14252686500549
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0005997
	speed: 0.3797s/iter; left time: 2633.7214s
	iters: 200, epoch: 16 | loss: 0.0129669
	speed: 0.1080s/iter; left time: 738.5196s
	iters: 300, epoch: 16 | loss: 0.0026825
	speed: 0.0829s/iter; left time: 558.6732s
	iters: 400, epoch: 16 | loss: 0.0156281
	speed: 0.0668s/iter; left time: 443.2927s
Epoch: 16 cost time: 43.985406160354614
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1466669
	speed: 0.3328s/iter; left time: 2151.9226s
	iters: 200, epoch: 17 | loss: 0.0028963
	speed: 0.1002s/iter; left time: 637.7366s
	iters: 300, epoch: 17 | loss: 0.0007802
	speed: 0.1149s/iter; left time: 720.3849s
	iters: 400, epoch: 17 | loss: 0.0009488
	speed: 0.1100s/iter; left time: 678.4096s
Epoch: 17 cost time: 49.861170053482056
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0080173
	speed: 0.3811s/iter; left time: 2286.0625s
	iters: 200, epoch: 18 | loss: 0.0074082
	speed: 0.1089s/iter; left time: 642.5569s
	iters: 300, epoch: 18 | loss: 0.0027971
	speed: 0.0870s/iter; left time: 504.3994s
	iters: 400, epoch: 18 | loss: 0.0117930
	speed: 0.0722s/iter; left time: 411.3442s
Epoch: 18 cost time: 44.47352075576782
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0008589
	speed: 0.3379s/iter; left time: 1868.3311s
	iters: 200, epoch: 19 | loss: 0.0014547
	speed: 0.0877s/iter; left time: 476.2186s
	iters: 300, epoch: 19 | loss: 0.0007829
	speed: 0.0776s/iter; left time: 413.2817s
	iters: 400, epoch: 19 | loss: 0.0071877
	speed: 0.0743s/iter; left time: 388.7628s
Epoch: 19 cost time: 38.31266522407532
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0045161
	speed: 0.2854s/iter; left time: 1444.3077s
	iters: 200, epoch: 20 | loss: 0.0629384
	speed: 0.0767s/iter; left time: 380.4499s
	iters: 300, epoch: 20 | loss: 0.0018937
	speed: 0.0713s/iter; left time: 346.6155s
	iters: 400, epoch: 20 | loss: 0.0004933
	speed: 0.1200s/iter; left time: 571.1519s
Epoch: 20 cost time: 45.22699213027954
Epoch: 20, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0003322
	speed: 0.4410s/iter; left time: 2024.4936s
	iters: 200, epoch: 21 | loss: 0.0204961
	speed: 0.1260s/iter; left time: 565.7333s
	iters: 300, epoch: 21 | loss: 0.0113403
	speed: 0.1390s/iter; left time: 610.4776s
	iters: 400, epoch: 21 | loss: 0.0006960
	speed: 0.1304s/iter; left time: 559.7372s
Epoch: 21 cost time: 62.58629107475281
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0012393
	speed: 0.4179s/iter; left time: 1722.4385s
	iters: 200, epoch: 22 | loss: 0.0004048
	speed: 0.1215s/iter; left time: 488.4825s
	iters: 300, epoch: 22 | loss: 0.3872522
	speed: 0.1108s/iter; left time: 434.5937s
	iters: 400, epoch: 22 | loss: 0.0010444
	speed: 0.1129s/iter; left time: 431.4374s
Epoch: 22 cost time: 52.69239020347595
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.982847 --> -0.983133).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0004642
	speed: 0.4371s/iter; left time: 1596.9076s
	iters: 200, epoch: 23 | loss: 0.0337346
	speed: 0.1360s/iter; left time: 483.1726s
	iters: 300, epoch: 23 | loss: 0.0011152
	speed: 0.1305s/iter; left time: 450.6932s
	iters: 400, epoch: 23 | loss: 0.0051402
	speed: 0.1324s/iter; left time: 443.9062s
Epoch: 23 cost time: 62.44150686264038
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0010353
	speed: 0.4453s/iter; left time: 1417.6805s
	iters: 200, epoch: 24 | loss: 0.0115427
	speed: 0.1384s/iter; left time: 426.7308s
	iters: 300, epoch: 24 | loss: 0.0019226
	speed: 0.1307s/iter; left time: 389.9541s
	iters: 400, epoch: 24 | loss: 0.0129713
	speed: 0.1305s/iter; left time: 376.3952s
Epoch: 24 cost time: 61.52264475822449
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.983133 --> -0.983990).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0004654
	speed: 0.3789s/iter; left time: 1028.6295s
	iters: 200, epoch: 25 | loss: 0.0046336
	speed: 0.1125s/iter; left time: 294.0601s
	iters: 300, epoch: 25 | loss: 0.0003366
	speed: 0.0995s/iter; left time: 250.2246s
	iters: 400, epoch: 25 | loss: 0.0048422
	speed: 0.1332s/iter; left time: 321.6185s
Epoch: 25 cost time: 52.05330777168274
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
Validation loss decreased (-0.983990 --> -0.986277).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0036118
	speed: 0.3448s/iter; left time: 774.4582s
	iters: 200, epoch: 26 | loss: 0.0024098
	speed: 0.1136s/iter; left time: 243.7421s
	iters: 300, epoch: 26 | loss: 0.0012112
	speed: 0.1128s/iter; left time: 230.7245s
	iters: 400, epoch: 26 | loss: 0.0401566
	speed: 0.1156s/iter; left time: 225.0071s
Epoch: 26 cost time: 53.9068169593811
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0008774
	speed: 0.4005s/iter; left time: 711.7126s
	iters: 200, epoch: 27 | loss: 0.0311253
	speed: 0.1130s/iter; left time: 189.5064s
	iters: 300, epoch: 27 | loss: 0.0935832
	speed: 0.0994s/iter; left time: 156.8274s
	iters: 400, epoch: 27 | loss: 0.0005528
	speed: 0.0947s/iter; left time: 139.8118s
Epoch: 27 cost time: 48.74249863624573
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0018730
	speed: 0.3271s/iter; left time: 427.8310s
	iters: 200, epoch: 28 | loss: 0.0018487
	speed: 0.1190s/iter; left time: 143.7018s
	iters: 300, epoch: 28 | loss: 0.0088710
	speed: 0.1210s/iter; left time: 134.1119s
	iters: 400, epoch: 28 | loss: 0.0060562
	speed: 0.1201s/iter; left time: 121.0727s
Epoch: 28 cost time: 52.80329871177673
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0009182
	speed: 0.4058s/iter; left time: 340.4777s
	iters: 200, epoch: 29 | loss: 0.0062286
	speed: 0.1205s/iter; left time: 89.0563s
	iters: 300, epoch: 29 | loss: 0.0039949
	speed: 0.1209s/iter; left time: 77.2677s
	iters: 400, epoch: 29 | loss: 0.0016708
	speed: 0.1190s/iter; left time: 64.1496s
Epoch: 29 cost time: 55.62251663208008
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0007881
	speed: 0.3438s/iter; left time: 127.1915s
	iters: 200, epoch: 30 | loss: 0.0056732
	speed: 0.1124s/iter; left time: 30.3530s
	iters: 300, epoch: 30 | loss: 0.0001134
	speed: 0.1105s/iter; left time: 18.7884s
	iters: 400, epoch: 30 | loss: 0.0020350
	speed: 0.1158s/iter; left time: 8.1043s
Epoch: 30 cost time: 51.03037405014038
Epoch: 30, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9862778730703259
model parameter : 294090
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1307583
	speed: 0.1125s/iter; left time: 1571.9233s
	iters: 200, epoch: 1 | loss: 1.9838345
	speed: 0.0986s/iter; left time: 1367.7143s
	iters: 300, epoch: 1 | loss: 1.5414037
	speed: 0.0903s/iter; left time: 1242.9182s
	iters: 400, epoch: 1 | loss: 1.1088148
	speed: 0.0917s/iter; left time: 1253.3123s
Epoch: 1 cost time: 45.847628593444824
Epoch: 1, Steps: 469 | Train Loss: 1.690 Vali Loss: 0.868 Vali Acc: 0.770 Test Loss: 0.868 Test Acc: 0.770
Validation loss decreased (inf --> -0.769574).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5992368
	speed: 0.2941s/iter; left time: 3970.8082s
	iters: 200, epoch: 2 | loss: 0.4603106
	speed: 0.0732s/iter; left time: 981.0424s
	iters: 300, epoch: 2 | loss: 0.2826825
	speed: 0.0798s/iter; left time: 1061.3444s
	iters: 400, epoch: 2 | loss: 0.1843427
	speed: 0.0790s/iter; left time: 1043.1624s
Epoch: 2 cost time: 34.410805463790894
Epoch: 2, Steps: 469 | Train Loss: 0.514 Vali Loss: 0.303 Vali Acc: 0.908 Test Loss: 0.303 Test Acc: 0.908
Validation loss decreased (-0.769574 --> -0.908230).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1663847
	speed: 0.2884s/iter; left time: 3758.9417s
	iters: 200, epoch: 3 | loss: 0.2280288
	speed: 0.0594s/iter; left time: 768.0580s
	iters: 300, epoch: 3 | loss: 0.2589914
	speed: 0.0655s/iter; left time: 839.9227s
	iters: 400, epoch: 3 | loss: 0.2540412
	speed: 0.0651s/iter; left time: 829.4941s
Epoch: 3 cost time: 29.803043603897095
Epoch: 3, Steps: 469 | Train Loss: 0.211 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.908230 --> -0.955687).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4771243
	speed: 0.3066s/iter; left time: 3851.7472s
	iters: 200, epoch: 4 | loss: 0.1061622
	speed: 0.0787s/iter; left time: 981.5392s
	iters: 300, epoch: 4 | loss: 0.1496674
	speed: 0.0782s/iter; left time: 967.0134s
	iters: 400, epoch: 4 | loss: 0.1307617
	speed: 0.0783s/iter; left time: 959.7073s
Epoch: 4 cost time: 37.02801275253296
Epoch: 4, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.955687 --> -0.964264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0354114
	speed: 0.3167s/iter; left time: 3829.9163s
	iters: 200, epoch: 5 | loss: 0.0472828
	speed: 0.0572s/iter; left time: 686.1904s
	iters: 300, epoch: 5 | loss: 0.0376073
	speed: 0.0527s/iter; left time: 626.9744s
	iters: 400, epoch: 5 | loss: 0.0294627
	speed: 0.0698s/iter; left time: 823.5962s
Epoch: 5 cost time: 30.853014707565308
Epoch: 5, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.964264 --> -0.967695).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0223612
	speed: 0.3266s/iter; left time: 3796.5484s
	iters: 200, epoch: 6 | loss: 0.0544223
	speed: 0.0741s/iter; left time: 853.5327s
	iters: 300, epoch: 6 | loss: 0.0765816
	speed: 0.0768s/iter; left time: 877.0011s
	iters: 400, epoch: 6 | loss: 0.0847045
	speed: 0.0739s/iter; left time: 837.5369s
Epoch: 6 cost time: 35.8791766166687
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.967695 --> -0.972555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3622487
	speed: 0.3269s/iter; left time: 3647.4326s
	iters: 200, epoch: 7 | loss: 0.0238261
	speed: 0.0900s/iter; left time: 994.7671s
	iters: 300, epoch: 7 | loss: 0.0165028
	speed: 0.0756s/iter; left time: 828.3147s
	iters: 400, epoch: 7 | loss: 0.0869985
	speed: 0.0564s/iter; left time: 611.8690s
Epoch: 7 cost time: 35.32711219787598
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1472396
	speed: 0.2983s/iter; left time: 3187.8423s
	iters: 200, epoch: 8 | loss: 0.0701595
	speed: 0.0793s/iter; left time: 839.1448s
	iters: 300, epoch: 8 | loss: 0.0492426
	speed: 0.0773s/iter; left time: 810.8701s
	iters: 400, epoch: 8 | loss: 0.0550157
	speed: 0.0770s/iter; left time: 799.6855s
Epoch: 8 cost time: 36.8963303565979
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0485078
	speed: 0.3203s/iter; left time: 3273.3677s
	iters: 200, epoch: 9 | loss: 0.0210068
	speed: 0.0778s/iter; left time: 787.6658s
	iters: 300, epoch: 9 | loss: 0.0148504
	speed: 0.0645s/iter; left time: 645.8398s
	iters: 400, epoch: 9 | loss: 0.0089927
	speed: 0.0638s/iter; left time: 633.2306s
Epoch: 9 cost time: 33.27461075782776
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
Validation loss decreased (-0.972555 --> -0.975128).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0208765
	speed: 0.2571s/iter; left time: 2506.2429s
	iters: 200, epoch: 10 | loss: 0.0514668
	speed: 0.0530s/iter; left time: 511.0825s
	iters: 300, epoch: 10 | loss: 0.0837698
	speed: 0.0534s/iter; left time: 509.6795s
	iters: 400, epoch: 10 | loss: 0.0025585
	speed: 0.0694s/iter; left time: 655.3944s
Epoch: 10 cost time: 30.537310361862183
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.975128 --> -0.978273).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2973323
	speed: 0.3578s/iter; left time: 3320.6891s
	iters: 200, epoch: 11 | loss: 0.0003666
	speed: 0.0894s/iter; left time: 821.1305s
	iters: 300, epoch: 11 | loss: 0.0200062
	speed: 0.0868s/iter; left time: 788.4151s
	iters: 400, epoch: 11 | loss: 0.0046888
	speed: 0.0905s/iter; left time: 812.8900s
Epoch: 11 cost time: 41.83955001831055
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0096675
	speed: 0.3479s/iter; left time: 3065.6623s
	iters: 200, epoch: 12 | loss: 0.0723267
	speed: 0.0930s/iter; left time: 810.5364s
	iters: 300, epoch: 12 | loss: 0.0025107
	speed: 0.0868s/iter; left time: 747.1557s
	iters: 400, epoch: 12 | loss: 0.0060460
	speed: 0.0856s/iter; left time: 728.4576s
Epoch: 12 cost time: 41.46933317184448
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0809014
	speed: 0.3137s/iter; left time: 2617.5377s
	iters: 200, epoch: 13 | loss: 0.0015941
	speed: 0.0743s/iter; left time: 612.2671s
	iters: 300, epoch: 13 | loss: 0.0151070
	speed: 0.0799s/iter; left time: 650.4213s
	iters: 400, epoch: 13 | loss: 0.0053423
	speed: 0.0750s/iter; left time: 603.3256s
Epoch: 13 cost time: 36.605634450912476
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0084374
	speed: 0.3602s/iter; left time: 2836.4695s
	iters: 200, epoch: 14 | loss: 0.0012746
	speed: 0.0835s/iter; left time: 649.2193s
	iters: 300, epoch: 14 | loss: 0.1468216
	speed: 0.0921s/iter; left time: 706.9042s
	iters: 400, epoch: 14 | loss: 0.0740354
	speed: 0.0899s/iter; left time: 681.0035s
Epoch: 14 cost time: 41.5801043510437
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0119780
	speed: 0.3593s/iter; left time: 2660.3740s
	iters: 200, epoch: 15 | loss: 0.1902602
	speed: 0.0945s/iter; left time: 690.5444s
	iters: 300, epoch: 15 | loss: 0.0446410
	speed: 0.0846s/iter; left time: 609.2012s
	iters: 400, epoch: 15 | loss: 0.0052739
	speed: 0.0615s/iter; left time: 437.2781s
Epoch: 15 cost time: 37.56513500213623
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1695058
	speed: 0.2788s/iter; left time: 1933.8544s
	iters: 200, epoch: 16 | loss: 0.0215194
	speed: 0.0682s/iter; left time: 466.0913s
	iters: 300, epoch: 16 | loss: 0.0117749
	speed: 0.0621s/iter; left time: 418.4151s
	iters: 400, epoch: 16 | loss: 0.0009715
	speed: 0.0697s/iter; left time: 462.6208s
Epoch: 16 cost time: 32.26097106933594
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.978273 --> -0.983133).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0081255
	speed: 0.3050s/iter; left time: 1972.5482s
	iters: 200, epoch: 17 | loss: 0.0080282
	speed: 0.0795s/iter; left time: 506.0480s
	iters: 300, epoch: 17 | loss: 0.0329587
	speed: 0.0817s/iter; left time: 511.7345s
	iters: 400, epoch: 17 | loss: 0.0021293
	speed: 0.0827s/iter; left time: 509.8394s
Epoch: 17 cost time: 38.44892954826355
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.983133 --> -0.985705).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0237885
	speed: 0.3275s/iter; left time: 1964.5834s
	iters: 200, epoch: 18 | loss: 0.0034142
	speed: 0.0703s/iter; left time: 414.8900s
	iters: 300, epoch: 18 | loss: 0.0008092
	speed: 0.0558s/iter; left time: 323.4339s
	iters: 400, epoch: 18 | loss: 0.0083689
	speed: 0.0642s/iter; left time: 365.6629s
Epoch: 18 cost time: 33.58334565162659
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0052266
	speed: 0.3530s/iter; left time: 1951.6940s
	iters: 200, epoch: 19 | loss: 0.0093855
	speed: 0.0800s/iter; left time: 434.2338s
	iters: 300, epoch: 19 | loss: 0.0128287
	speed: 0.0701s/iter; left time: 373.3627s
	iters: 400, epoch: 19 | loss: 0.0035419
	speed: 0.0665s/iter; left time: 347.5864s
Epoch: 19 cost time: 35.653526067733765
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0283686
	speed: 0.2905s/iter; left time: 1470.1300s
	iters: 200, epoch: 20 | loss: 0.0047518
	speed: 0.0862s/iter; left time: 427.3288s
	iters: 300, epoch: 20 | loss: 0.0010098
	speed: 0.0824s/iter; left time: 400.5071s
	iters: 400, epoch: 20 | loss: 0.0022181
	speed: 0.0829s/iter; left time: 394.6050s
Epoch: 20 cost time: 38.096906661987305
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0034015
	speed: 0.3407s/iter; left time: 1564.2005s
	iters: 200, epoch: 21 | loss: 0.0091958
	speed: 0.0843s/iter; left time: 378.7410s
	iters: 300, epoch: 21 | loss: 0.0222717
	speed: 0.0848s/iter; left time: 372.5519s
	iters: 400, epoch: 21 | loss: 0.0143429
	speed: 0.0802s/iter; left time: 344.1750s
Epoch: 21 cost time: 39.579355239868164
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2300239
	speed: 0.2708s/iter; left time: 1116.2018s
	iters: 200, epoch: 22 | loss: 0.0151804
	speed: 0.0740s/iter; left time: 297.5027s
	iters: 300, epoch: 22 | loss: 0.0026284
	speed: 0.0757s/iter; left time: 297.0659s
	iters: 400, epoch: 22 | loss: 0.0051779
	speed: 0.0669s/iter; left time: 255.7409s
Epoch: 22 cost time: 33.053351640701294
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0866822
	speed: 0.2540s/iter; left time: 927.8655s
	iters: 200, epoch: 23 | loss: 0.0516051
	speed: 0.0618s/iter; left time: 219.4186s
	iters: 300, epoch: 23 | loss: 0.1849613
	speed: 0.0697s/iter; left time: 240.8423s
	iters: 400, epoch: 23 | loss: 0.0133730
	speed: 0.0659s/iter; left time: 220.9992s
Epoch: 23 cost time: 31.57897925376892
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0045078
	speed: 0.3022s/iter; left time: 962.0919s
	iters: 200, epoch: 24 | loss: 0.0024562
	speed: 0.0630s/iter; left time: 194.1566s
	iters: 300, epoch: 24 | loss: 0.0004496
	speed: 0.0551s/iter; left time: 164.4820s
	iters: 400, epoch: 24 | loss: 0.0041980
	speed: 0.0624s/iter; left time: 180.0699s
Epoch: 24 cost time: 30.71651792526245
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0098301
	speed: 0.3028s/iter; left time: 822.2280s
	iters: 200, epoch: 25 | loss: 0.0023525
	speed: 0.0748s/iter; left time: 195.5191s
	iters: 300, epoch: 25 | loss: 0.0312087
	speed: 0.0747s/iter; left time: 187.9434s
	iters: 400, epoch: 25 | loss: 0.0008546
	speed: 0.0721s/iter; left time: 174.0692s
Epoch: 25 cost time: 34.638991832733154
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0007613
	speed: 0.2319s/iter; left time: 520.7723s
	iters: 200, epoch: 26 | loss: 0.0003195
	speed: 0.0411s/iter; left time: 88.1302s
	iters: 300, epoch: 26 | loss: 0.0006555
	speed: 0.0567s/iter; left time: 115.9820s
	iters: 400, epoch: 26 | loss: 0.0098230
	speed: 0.0733s/iter; left time: 142.7086s
Epoch: 26 cost time: 26.41106152534485
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0219056
	speed: 0.3312s/iter; left time: 588.5811s
	iters: 200, epoch: 27 | loss: 0.0423719
	speed: 0.0892s/iter; left time: 149.6076s
	iters: 300, epoch: 27 | loss: 0.0257381
	speed: 0.0762s/iter; left time: 120.1381s
	iters: 400, epoch: 27 | loss: 0.0042511
	speed: 0.0669s/iter; left time: 98.8127s
Epoch: 27 cost time: 38.12854266166687
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 87082
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0206192
	speed: 0.2734s/iter; left time: 3820.0592s
	iters: 200, epoch: 1 | loss: 1.8344066
	speed: 0.2515s/iter; left time: 3488.2994s
	iters: 300, epoch: 1 | loss: 1.2217436
	speed: 0.1923s/iter; left time: 2647.5687s
	iters: 400, epoch: 1 | loss: 0.9693224
	speed: 0.1320s/iter; left time: 1804.1903s
Epoch: 1 cost time: 99.04510521888733
Epoch: 1, Steps: 469 | Train Loss: 1.559 Vali Loss: 0.651 Vali Acc: 0.851 Test Loss: 0.651 Test Acc: 0.851
Validation loss decreased (inf --> -0.851337).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5869403
	speed: 0.6653s/iter; left time: 8982.2995s
	iters: 200, epoch: 2 | loss: 0.4135450
	speed: 0.2712s/iter; left time: 3635.2591s
	iters: 300, epoch: 2 | loss: 0.1105028
	speed: 0.2747s/iter; left time: 3653.8304s
	iters: 400, epoch: 2 | loss: 0.2820153
	speed: 0.2579s/iter; left time: 3404.2013s
Epoch: 2 cost time: 119.64438104629517
Epoch: 2, Steps: 469 | Train Loss: 0.348 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.851337 --> -0.925955).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2802343
	speed: 0.4899s/iter; left time: 6384.8216s
	iters: 200, epoch: 3 | loss: 0.0938099
	speed: 0.2397s/iter; left time: 3099.9381s
	iters: 300, epoch: 3 | loss: 0.0795014
	speed: 0.2664s/iter; left time: 3419.2861s
	iters: 400, epoch: 3 | loss: 0.2283138
	speed: 0.2759s/iter; left time: 3513.6592s
Epoch: 3 cost time: 116.204430103302
Epoch: 3, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.925955 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2172476
	speed: 0.6987s/iter; left time: 8778.0164s
	iters: 200, epoch: 4 | loss: 0.0801476
	speed: 0.2014s/iter; left time: 2510.4674s
	iters: 300, epoch: 4 | loss: 0.0159571
	speed: 0.1754s/iter; left time: 2168.7568s
	iters: 400, epoch: 4 | loss: 0.2083344
	speed: 0.2889s/iter; left time: 3543.0447s
Epoch: 4 cost time: 114.1115894317627
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.957117 --> -0.968552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0882954
	speed: 0.7055s/iter; left time: 8533.1979s
	iters: 200, epoch: 5 | loss: 0.0589487
	speed: 0.1956s/iter; left time: 2346.0874s
	iters: 300, epoch: 5 | loss: 0.0157300
	speed: 0.2340s/iter; left time: 2783.4448s
	iters: 400, epoch: 5 | loss: 0.0740874
	speed: 0.1979s/iter; left time: 2334.7937s
Epoch: 5 cost time: 101.92583274841309
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0449264
	speed: 0.5320s/iter; left time: 6184.5468s
	iters: 200, epoch: 6 | loss: 0.0154027
	speed: 0.2508s/iter; left time: 2891.1539s
	iters: 300, epoch: 6 | loss: 0.1418118
	speed: 0.2464s/iter; left time: 2815.5374s
	iters: 400, epoch: 6 | loss: 0.0183744
	speed: 0.2290s/iter; left time: 2593.3964s
Epoch: 6 cost time: 112.10727119445801
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1150707
	speed: 0.5543s/iter; left time: 6184.1737s
	iters: 200, epoch: 7 | loss: 0.0226016
	speed: 0.1399s/iter; left time: 1546.6454s
	iters: 300, epoch: 7 | loss: 0.0688195
	speed: 0.3601s/iter; left time: 3945.4896s
	iters: 400, epoch: 7 | loss: 0.0069884
	speed: 0.3714s/iter; left time: 4032.7493s
Epoch: 7 cost time: 130.90473198890686
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.969410 --> -0.969410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0844397
	speed: 0.8759s/iter; left time: 9361.2056s
	iters: 200, epoch: 8 | loss: 0.0726263
	speed: 0.3530s/iter; left time: 3737.9066s
	iters: 300, epoch: 8 | loss: 0.0046115
	speed: 0.3273s/iter; left time: 3432.5650s
	iters: 400, epoch: 8 | loss: 0.0620140
	speed: 0.3109s/iter; left time: 3229.4160s
Epoch: 8 cost time: 157.5955250263214
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.972555).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0076906
	speed: 0.8535s/iter; left time: 8721.5931s
	iters: 200, epoch: 9 | loss: 0.0735049
	speed: 0.3515s/iter; left time: 3557.1599s
	iters: 300, epoch: 9 | loss: 0.0558802
	speed: 0.3455s/iter; left time: 3461.1966s
	iters: 400, epoch: 9 | loss: 0.0701118
	speed: 0.3325s/iter; left time: 3297.9839s
Epoch: 9 cost time: 162.08315467834473
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.973126).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0239557
	speed: 0.8550s/iter; left time: 8336.6232s
	iters: 200, epoch: 10 | loss: 0.0018930
	speed: 0.3641s/iter; left time: 3513.9431s
	iters: 300, epoch: 10 | loss: 0.0164991
	speed: 0.3656s/iter; left time: 3491.7296s
	iters: 400, epoch: 10 | loss: 0.0514457
	speed: 0.3711s/iter; left time: 3506.9604s
Epoch: 10 cost time: 171.3853144645691
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.973126 --> -0.977129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0034412
	speed: 0.8689s/iter; left time: 8064.1144s
	iters: 200, epoch: 11 | loss: 0.0043912
	speed: 0.3123s/iter; left time: 2866.8665s
	iters: 300, epoch: 11 | loss: 0.0223816
	speed: 0.3432s/iter; left time: 3116.8584s
	iters: 400, epoch: 11 | loss: 0.0458396
	speed: 0.3491s/iter; left time: 3135.1272s
Epoch: 11 cost time: 157.8973412513733
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0174984
	speed: 0.8486s/iter; left time: 7477.9050s
	iters: 200, epoch: 12 | loss: 0.0090914
	speed: 0.3539s/iter; left time: 3083.5146s
	iters: 300, epoch: 12 | loss: 0.0090688
	speed: 0.3274s/iter; left time: 2819.9856s
	iters: 400, epoch: 12 | loss: 0.0111326
	speed: 0.3048s/iter; left time: 2594.1086s
Epoch: 12 cost time: 157.89962792396545
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0079075
	speed: 0.8877s/iter; left time: 7405.9016s
	iters: 200, epoch: 13 | loss: 0.1169007
	speed: 0.3623s/iter; left time: 2986.0307s
	iters: 300, epoch: 13 | loss: 0.0424818
	speed: 0.3620s/iter; left time: 2947.9613s
	iters: 400, epoch: 13 | loss: 0.0012502
	speed: 0.3687s/iter; left time: 2965.2487s
Epoch: 13 cost time: 170.31618762016296
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977987).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0081367
	speed: 0.8184s/iter; left time: 6443.7601s
	iters: 200, epoch: 14 | loss: 0.7442667
	speed: 0.2353s/iter; left time: 1829.4351s
	iters: 300, epoch: 14 | loss: 0.0196947
	speed: 0.3299s/iter; left time: 2531.5507s
	iters: 400, epoch: 14 | loss: 0.2696014
	speed: 0.3597s/iter; left time: 2724.6527s
Epoch: 14 cost time: 149.18506264686584
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0064978
	speed: 0.8619s/iter; left time: 6382.2632s
	iters: 200, epoch: 15 | loss: 0.0035140
	speed: 0.3601s/iter; left time: 2630.6256s
	iters: 300, epoch: 15 | loss: 0.0736762
	speed: 0.3590s/iter; left time: 2586.5078s
	iters: 400, epoch: 15 | loss: 0.0167523
	speed: 0.3553s/iter; left time: 2524.6598s
Epoch: 15 cost time: 167.11119437217712
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.977987 --> -0.979130).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0037429
	speed: 0.8640s/iter; left time: 5992.9053s
	iters: 200, epoch: 16 | loss: 0.0007174
	speed: 0.3501s/iter; left time: 2393.1716s
	iters: 300, epoch: 16 | loss: 0.0047955
	speed: 0.3601s/iter; left time: 2425.7694s
	iters: 400, epoch: 16 | loss: 0.0032180
	speed: 0.3688s/iter; left time: 2447.6680s
Epoch: 16 cost time: 168.77699780464172
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980845).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0038162
	speed: 0.9040s/iter; left time: 5845.8889s
	iters: 200, epoch: 17 | loss: 0.0164900
	speed: 0.3653s/iter; left time: 2326.1527s
	iters: 300, epoch: 17 | loss: 0.0042793
	speed: 0.3415s/iter; left time: 2140.0664s
	iters: 400, epoch: 17 | loss: 0.0374846
	speed: 0.2671s/iter; left time: 1647.1845s
Epoch: 17 cost time: 158.72398257255554
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0021916
	speed: 0.8356s/iter; left time: 5011.7176s
	iters: 200, epoch: 18 | loss: 0.2465128
	speed: 0.3047s/iter; left time: 1796.8557s
	iters: 300, epoch: 18 | loss: 0.0007951
	speed: 0.3248s/iter; left time: 1882.9382s
	iters: 400, epoch: 18 | loss: 0.0014521
	speed: 0.3523s/iter; left time: 2007.6191s
Epoch: 18 cost time: 155.01446390151978
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0009001
	speed: 0.8634s/iter; left time: 4773.6488s
	iters: 200, epoch: 19 | loss: 0.0293643
	speed: 0.3698s/iter; left time: 2007.7734s
	iters: 300, epoch: 19 | loss: 0.0026876
	speed: 0.3560s/iter; left time: 1897.0678s
	iters: 400, epoch: 19 | loss: 0.0102730
	speed: 0.3641s/iter; left time: 1903.6792s
Epoch: 19 cost time: 169.14176297187805
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0112045
	speed: 0.8524s/iter; left time: 4313.0209s
	iters: 200, epoch: 20 | loss: 0.0023727
	speed: 0.3319s/iter; left time: 1646.2158s
	iters: 300, epoch: 20 | loss: 0.0914080
	speed: 0.3549s/iter; left time: 1724.9179s
	iters: 400, epoch: 20 | loss: 0.0015060
	speed: 0.3476s/iter; left time: 1654.6972s
Epoch: 20 cost time: 161.49594044685364
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.981989).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0016733
	speed: 0.8666s/iter; left time: 3978.5247s
	iters: 200, epoch: 21 | loss: 0.0015202
	speed: 0.3458s/iter; left time: 1552.9555s
	iters: 300, epoch: 21 | loss: 0.0014188
	speed: 0.3491s/iter; left time: 1532.8227s
	iters: 400, epoch: 21 | loss: 0.0006940
	speed: 0.3510s/iter; left time: 1506.0241s
Epoch: 21 cost time: 163.87618279457092
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0063667
	speed: 0.8310s/iter; left time: 3425.3900s
	iters: 200, epoch: 22 | loss: 0.0011004
	speed: 0.3255s/iter; left time: 1309.0191s
	iters: 300, epoch: 22 | loss: 0.0458137
	speed: 0.3293s/iter; left time: 1291.5164s
	iters: 400, epoch: 22 | loss: 0.0019563
	speed: 0.2704s/iter; left time: 1033.4421s
Epoch: 22 cost time: 150.66148328781128
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.981989 --> -0.984562).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0008901
	speed: 0.8955s/iter; left time: 3271.3291s
	iters: 200, epoch: 23 | loss: 0.0097860
	speed: 0.3612s/iter; left time: 1283.3469s
	iters: 300, epoch: 23 | loss: 0.0010700
	speed: 0.3692s/iter; left time: 1274.9522s
	iters: 400, epoch: 23 | loss: 0.0004856
	speed: 0.3673s/iter; left time: 1231.6846s
Epoch: 23 cost time: 170.8389904499054
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0009197
	speed: 0.8562s/iter; left time: 2726.2140s
	iters: 200, epoch: 24 | loss: 0.0078895
	speed: 0.3247s/iter; left time: 1001.2255s
	iters: 300, epoch: 24 | loss: 0.0962172
	speed: 0.3285s/iter; left time: 980.2007s
	iters: 400, epoch: 24 | loss: 0.0004506
	speed: 0.3585s/iter; left time: 1033.9074s
Epoch: 24 cost time: 159.36134886741638
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0116569
	speed: 0.8681s/iter; left time: 2356.7946s
	iters: 200, epoch: 25 | loss: 0.0334760
	speed: 0.3590s/iter; left time: 938.7256s
	iters: 300, epoch: 25 | loss: 0.0046742
	speed: 0.3515s/iter; left time: 883.9497s
	iters: 400, epoch: 25 | loss: 0.0003734
	speed: 0.3622s/iter; left time: 874.6424s
Epoch: 25 cost time: 168.3351535797119
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0251020
	speed: 0.8727s/iter; left time: 1960.1688s
	iters: 200, epoch: 26 | loss: 0.0104969
	speed: 0.3375s/iter; left time: 724.2272s
	iters: 300, epoch: 26 | loss: 0.0033394
	speed: 0.3577s/iter; left time: 731.9154s
	iters: 400, epoch: 26 | loss: 0.0002382
	speed: 0.3611s/iter; left time: 702.6835s
Epoch: 26 cost time: 164.542955160141
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0008112
	speed: 0.8921s/iter; left time: 1585.2397s
	iters: 200, epoch: 27 | loss: 0.0004462
	speed: 0.3531s/iter; left time: 592.0913s
	iters: 300, epoch: 27 | loss: 0.0031982
	speed: 0.3565s/iter; left time: 562.2126s
	iters: 400, epoch: 27 | loss: 0.0137520
	speed: 0.3606s/iter; left time: 532.6229s
Epoch: 27 cost time: 168.33253121376038
Epoch: 27, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0057668
	speed: 0.8504s/iter; left time: 1112.3138s
	iters: 200, epoch: 28 | loss: 0.0179664
	speed: 0.3347s/iter; left time: 404.3693s
	iters: 300, epoch: 28 | loss: 0.0000811
	speed: 0.3412s/iter; left time: 378.0230s
	iters: 400, epoch: 28 | loss: 0.0048300
	speed: 0.3555s/iter; left time: 358.3767s
Epoch: 28 cost time: 161.2652976512909
Epoch: 28, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0033101
	speed: 0.8752s/iter; left time: 734.2619s
	iters: 200, epoch: 29 | loss: 0.0039291
	speed: 0.3668s/iter; left time: 271.0700s
	iters: 300, epoch: 29 | loss: 0.0004036
	speed: 0.3655s/iter; left time: 233.5282s
	iters: 400, epoch: 29 | loss: 0.0010729
	speed: 0.3605s/iter; left time: 194.3058s
Epoch: 29 cost time: 170.10876965522766
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0003757
	speed: 0.8688s/iter; left time: 321.4581s
	iters: 200, epoch: 30 | loss: 0.0278172
	speed: 0.3262s/iter; left time: 88.0767s
	iters: 300, epoch: 30 | loss: 0.0002478
	speed: 0.2783s/iter; left time: 47.3134s
	iters: 400, epoch: 30 | loss: 0.0015833
	speed: 0.3294s/iter; left time: 23.0572s
Epoch: 30 cost time: 151.31014561653137
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 147466
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0948353
	speed: 0.2423s/iter; left time: 3385.1385s
	iters: 200, epoch: 1 | loss: 1.6820445
	speed: 0.2293s/iter; left time: 3181.3011s
	iters: 300, epoch: 1 | loss: 1.2875922
	speed: 0.2280s/iter; left time: 3139.3680s
	iters: 400, epoch: 1 | loss: 0.8986992
	speed: 0.2288s/iter; left time: 3128.3163s
Epoch: 1 cost time: 109.17356729507446
Epoch: 1, Steps: 469 | Train Loss: 1.597 Vali Loss: 0.718 Vali Acc: 0.814 Test Loss: 0.718 Test Acc: 0.814
Validation loss decreased (inf --> -0.814172).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6427900
	speed: 0.6482s/iter; left time: 8752.3131s
	iters: 200, epoch: 2 | loss: 0.4462635
	speed: 0.2134s/iter; left time: 2860.3267s
	iters: 300, epoch: 2 | loss: 0.2076925
	speed: 0.2116s/iter; left time: 2814.5564s
	iters: 400, epoch: 2 | loss: 0.2936215
	speed: 0.2095s/iter; left time: 2765.4251s
Epoch: 2 cost time: 102.09754180908203
Epoch: 2, Steps: 469 | Train Loss: 0.402 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
Validation loss decreased (-0.814172 --> -0.918808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0992910
	speed: 0.6436s/iter; left time: 8388.2230s
	iters: 200, epoch: 3 | loss: 0.0863626
	speed: 0.2302s/iter; left time: 2977.3909s
	iters: 300, epoch: 3 | loss: 0.2848565
	speed: 0.2380s/iter; left time: 3053.8236s
	iters: 400, epoch: 3 | loss: 0.1090379
	speed: 0.2315s/iter; left time: 2948.0674s
Epoch: 3 cost time: 110.42499780654907
Epoch: 3, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.136 Vali Acc: 0.958 Test Loss: 0.136 Test Acc: 0.958
Validation loss decreased (-0.918808 --> -0.958261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1497450
	speed: 0.6564s/iter; left time: 8247.5446s
	iters: 200, epoch: 4 | loss: 0.1048597
	speed: 0.2306s/iter; left time: 2874.7867s
	iters: 300, epoch: 4 | loss: 0.0097589
	speed: 0.2378s/iter; left time: 2939.5451s
	iters: 400, epoch: 4 | loss: 0.0221495
	speed: 0.2311s/iter; left time: 2834.6861s
Epoch: 4 cost time: 110.2559175491333
Epoch: 4, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.958261 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1402594
	speed: 0.6384s/iter; left time: 7721.7627s
	iters: 200, epoch: 5 | loss: 0.0722748
	speed: 0.2055s/iter; left time: 2464.4327s
	iters: 300, epoch: 5 | loss: 0.0282411
	speed: 0.2171s/iter; left time: 2582.4959s
	iters: 400, epoch: 5 | loss: 0.0937133
	speed: 0.2063s/iter; left time: 2433.0684s
Epoch: 5 cost time: 101.21988129615784
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0779342
	speed: 0.6493s/iter; left time: 7549.0540s
	iters: 200, epoch: 6 | loss: 0.3849086
	speed: 0.2220s/iter; left time: 2559.0925s
	iters: 300, epoch: 6 | loss: 0.0232759
	speed: 0.2335s/iter; left time: 2667.7984s
	iters: 400, epoch: 6 | loss: 0.0037771
	speed: 0.2251s/iter; left time: 2549.7831s
Epoch: 6 cost time: 107.94013094902039
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
Validation loss decreased (-0.971983 --> -0.972269).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0479964
	speed: 0.6498s/iter; left time: 7250.1110s
	iters: 200, epoch: 7 | loss: 0.0249587
	speed: 0.2220s/iter; left time: 2454.2057s
	iters: 300, epoch: 7 | loss: 0.0239454
	speed: 0.1550s/iter; left time: 1697.9940s
	iters: 400, epoch: 7 | loss: 0.0080072
	speed: 0.2167s/iter; left time: 2352.8664s
Epoch: 7 cost time: 99.45715951919556
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0043646
	speed: 0.6346s/iter; left time: 6782.1748s
	iters: 200, epoch: 8 | loss: 0.0176354
	speed: 0.2235s/iter; left time: 2366.2065s
	iters: 300, epoch: 8 | loss: 0.0030801
	speed: 0.2155s/iter; left time: 2259.9899s
	iters: 400, epoch: 8 | loss: 0.0134508
	speed: 0.2257s/iter; left time: 2344.7179s
Epoch: 8 cost time: 105.02204418182373
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.972269 --> -0.978844).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0137364
	speed: 0.6547s/iter; left time: 6689.9996s
	iters: 200, epoch: 9 | loss: 0.0230688
	speed: 0.2378s/iter; left time: 2406.4056s
	iters: 300, epoch: 9 | loss: 0.2370289
	speed: 0.2392s/iter; left time: 2396.5746s
	iters: 400, epoch: 9 | loss: 0.0335266
	speed: 0.2340s/iter; left time: 2320.6265s
Epoch: 9 cost time: 110.31956434249878
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0064018
	speed: 0.6595s/iter; left time: 6429.7794s
	iters: 200, epoch: 10 | loss: 0.0504046
	speed: 0.2335s/iter; left time: 2252.8524s
	iters: 300, epoch: 10 | loss: 0.0310626
	speed: 0.2363s/iter; left time: 2256.8265s
	iters: 400, epoch: 10 | loss: 0.0642842
	speed: 0.2258s/iter; left time: 2133.4664s
Epoch: 10 cost time: 107.12524127960205
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0131028
	speed: 0.6013s/iter; left time: 5580.9627s
	iters: 200, epoch: 11 | loss: 0.0112589
	speed: 0.2140s/iter; left time: 1964.3875s
	iters: 300, epoch: 11 | loss: 0.0041026
	speed: 0.2368s/iter; left time: 2150.6349s
	iters: 400, epoch: 11 | loss: 0.0243429
	speed: 0.2346s/iter; left time: 2106.6897s
Epoch: 11 cost time: 105.53229546546936
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0215722
	speed: 0.6500s/iter; left time: 5727.4848s
	iters: 200, epoch: 12 | loss: 0.0106209
	speed: 0.2299s/iter; left time: 2002.9644s
	iters: 300, epoch: 12 | loss: 0.0367355
	speed: 0.2370s/iter; left time: 2040.9084s
	iters: 400, epoch: 12 | loss: 0.2653088
	speed: 0.2376s/iter; left time: 2022.2651s
Epoch: 12 cost time: 110.26354312896729
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0854154
	speed: 0.6626s/iter; left time: 5528.4223s
	iters: 200, epoch: 13 | loss: 0.0127542
	speed: 0.2334s/iter; left time: 1924.0228s
	iters: 300, epoch: 13 | loss: 0.0024402
	speed: 0.2338s/iter; left time: 1904.0922s
	iters: 400, epoch: 13 | loss: 0.0857444
	speed: 0.2249s/iter; left time: 1808.6247s
Epoch: 13 cost time: 108.75777816772461
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0008138
	speed: 0.6237s/iter; left time: 4910.8812s
	iters: 200, epoch: 14 | loss: 0.0038474
	speed: 0.2351s/iter; left time: 1827.4305s
	iters: 300, epoch: 14 | loss: 0.0078193
	speed: 0.2329s/iter; left time: 1787.4878s
	iters: 400, epoch: 14 | loss: 0.0255871
	speed: 0.1789s/iter; left time: 1355.1022s
Epoch: 14 cost time: 101.11735367774963
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0240889
	speed: 0.6122s/iter; left time: 4533.3926s
	iters: 200, epoch: 15 | loss: 0.0062370
	speed: 0.2261s/iter; left time: 1651.9336s
	iters: 300, epoch: 15 | loss: 0.0030230
	speed: 0.2243s/iter; left time: 1616.4318s
	iters: 400, epoch: 15 | loss: 0.0052654
	speed: 0.2220s/iter; left time: 1577.4367s
Epoch: 15 cost time: 105.78339576721191
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.981131).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0551021
	speed: 0.6260s/iter; left time: 4341.9394s
	iters: 200, epoch: 16 | loss: 0.0648688
	speed: 0.2192s/iter; left time: 1498.6965s
	iters: 300, epoch: 16 | loss: 0.0203572
	speed: 0.2116s/iter; left time: 1425.2058s
	iters: 400, epoch: 16 | loss: 0.0018019
	speed: 0.2068s/iter; left time: 1372.5951s
Epoch: 16 cost time: 99.67427492141724
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.981131 --> -0.983704).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0073907
	speed: 0.5913s/iter; left time: 3823.8174s
	iters: 200, epoch: 17 | loss: 0.1051069
	speed: 0.1525s/iter; left time: 971.0774s
	iters: 300, epoch: 17 | loss: 0.0071335
	speed: 0.1777s/iter; left time: 1113.3968s
	iters: 400, epoch: 17 | loss: 0.0012431
	speed: 0.2155s/iter; left time: 1329.2763s
Epoch: 17 cost time: 91.25328922271729
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0009756
	speed: 0.6028s/iter; left time: 3615.7467s
	iters: 200, epoch: 18 | loss: 0.0571432
	speed: 0.2154s/iter; left time: 1270.5115s
	iters: 300, epoch: 18 | loss: 0.0014902
	speed: 0.1402s/iter; left time: 813.0842s
	iters: 400, epoch: 18 | loss: 0.0118118
	speed: 0.0790s/iter; left time: 450.1951s
Epoch: 18 cost time: 77.01087760925293
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1593910
	speed: 0.5968s/iter; left time: 3299.6318s
	iters: 200, epoch: 19 | loss: 0.0024478
	speed: 0.2183s/iter; left time: 1185.1942s
	iters: 300, epoch: 19 | loss: 0.0014058
	speed: 0.2228s/iter; left time: 1187.3750s
	iters: 400, epoch: 19 | loss: 0.1432285
	speed: 0.2260s/iter; left time: 1181.6900s
Epoch: 19 cost time: 102.99972534179688
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983704 --> -0.984848).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0279123
	speed: 0.5755s/iter; left time: 2911.7957s
	iters: 200, epoch: 20 | loss: 0.0023853
	speed: 0.2236s/iter; left time: 1109.0007s
	iters: 300, epoch: 20 | loss: 0.0029446
	speed: 0.2155s/iter; left time: 1047.3507s
	iters: 400, epoch: 20 | loss: 0.1279603
	speed: 0.2112s/iter; left time: 1005.2143s
Epoch: 20 cost time: 102.38367557525635
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0008280
	speed: 0.5868s/iter; left time: 2693.7965s
	iters: 200, epoch: 21 | loss: 0.0028079
	speed: 0.1941s/iter; left time: 871.7866s
	iters: 300, epoch: 21 | loss: 0.0072790
	speed: 0.2253s/iter; left time: 989.1947s
	iters: 400, epoch: 21 | loss: 0.1393490
	speed: 0.2208s/iter; left time: 947.4646s
Epoch: 21 cost time: 97.80594229698181
Epoch: 21, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0041990
	speed: 0.6210s/iter; left time: 2559.8612s
	iters: 200, epoch: 22 | loss: 0.0006007
	speed: 0.2035s/iter; left time: 818.6302s
	iters: 300, epoch: 22 | loss: 0.0775761
	speed: 0.1939s/iter; left time: 760.4286s
	iters: 400, epoch: 22 | loss: 0.0009955
	speed: 0.2129s/iter; left time: 813.6742s
Epoch: 22 cost time: 99.12670230865479
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0093534
	speed: 0.6273s/iter; left time: 2291.5133s
	iters: 200, epoch: 23 | loss: 0.0045565
	speed: 0.2260s/iter; left time: 803.1186s
	iters: 300, epoch: 23 | loss: 0.0015708
	speed: 0.2242s/iter; left time: 774.0442s
	iters: 400, epoch: 23 | loss: 0.0036888
	speed: 0.1977s/iter; left time: 662.9661s
Epoch: 23 cost time: 100.56002020835876
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0009802
	speed: 0.5967s/iter; left time: 1899.9936s
	iters: 200, epoch: 24 | loss: 0.4487813
	speed: 0.2188s/iter; left time: 674.7039s
	iters: 300, epoch: 24 | loss: 0.0068829
	speed: 0.2228s/iter; left time: 664.7210s
	iters: 400, epoch: 24 | loss: 0.0018560
	speed: 0.2269s/iter; left time: 654.4891s
Epoch: 24 cost time: 104.49330759048462
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.984848 --> -0.985705).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0068829
	speed: 0.5781s/iter; left time: 1569.6212s
	iters: 200, epoch: 25 | loss: 0.0150904
	speed: 0.2229s/iter; left time: 582.7780s
	iters: 300, epoch: 25 | loss: 0.0049133
	speed: 0.2133s/iter; left time: 536.4371s
	iters: 400, epoch: 25 | loss: 0.0065652
	speed: 0.2183s/iter; left time: 527.0768s
Epoch: 25 cost time: 101.37891602516174
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0139501
	speed: 0.6089s/iter; left time: 1367.5799s
	iters: 200, epoch: 26 | loss: 0.0039298
	speed: 0.1930s/iter; left time: 414.1069s
	iters: 300, epoch: 26 | loss: 0.0041913
	speed: 0.2108s/iter; left time: 431.2444s
	iters: 400, epoch: 26 | loss: 0.0025888
	speed: 0.2213s/iter; left time: 430.5598s
Epoch: 26 cost time: 98.02708673477173
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0822283
	speed: 0.4991s/iter; left time: 886.8682s
	iters: 200, epoch: 27 | loss: 0.0012720
	speed: 0.2161s/iter; left time: 362.3277s
	iters: 300, epoch: 27 | loss: 0.0127167
	speed: 0.1929s/iter; left time: 304.1330s
	iters: 400, epoch: 27 | loss: 0.0004182
	speed: 0.1868s/iter; left time: 275.8379s
Epoch: 27 cost time: 84.3970935344696
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0016241
	speed: 0.5981s/iter; left time: 782.2596s
	iters: 200, epoch: 28 | loss: 0.0007844
	speed: 0.2141s/iter; left time: 258.6909s
	iters: 300, epoch: 28 | loss: 0.0033364
	speed: 0.2110s/iter; left time: 233.8434s
	iters: 400, epoch: 28 | loss: 0.0176417
	speed: 0.2186s/iter; left time: 220.3813s
Epoch: 28 cost time: 98.74690818786621
Epoch: 28, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0002425
	speed: 0.5605s/iter; left time: 470.2575s
	iters: 200, epoch: 29 | loss: 0.0006377
	speed: 0.2110s/iter; left time: 155.9067s
	iters: 300, epoch: 29 | loss: 0.0004476
	speed: 0.2147s/iter; left time: 137.2094s
	iters: 400, epoch: 29 | loss: 0.0018767
	speed: 0.2175s/iter; left time: 117.2418s
Epoch: 29 cost time: 100.03375816345215
Epoch: 29, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0084159
	speed: 0.5592s/iter; left time: 206.9167s
	iters: 200, epoch: 30 | loss: 0.0089673
	speed: 0.1859s/iter; left time: 50.1801s
	iters: 300, epoch: 30 | loss: 0.0020074
	speed: 0.2152s/iter; left time: 36.5760s
	iters: 400, epoch: 30 | loss: 0.0014076
	speed: 0.2088s/iter; left time: 14.6162s
Epoch: 30 cost time: 93.5761787891388
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9857061177815895
model parameter : 43946
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0223305
	speed: 0.2306s/iter; left time: 3221.9213s
	iters: 200, epoch: 1 | loss: 1.8330299
	speed: 0.2006s/iter; left time: 2783.0653s
	iters: 300, epoch: 1 | loss: 1.2225474
	speed: 0.2114s/iter; left time: 2911.1642s
	iters: 400, epoch: 1 | loss: 0.9737693
	speed: 0.2301s/iter; left time: 3145.3662s
Epoch: 1 cost time: 102.83769798278809
Epoch: 1, Steps: 469 | Train Loss: 1.565 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (inf --> -0.850193).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5919987
	speed: 0.6043s/iter; left time: 8158.8237s
	iters: 200, epoch: 2 | loss: 0.4307806
	speed: 0.2174s/iter; left time: 2914.1523s
	iters: 300, epoch: 2 | loss: 0.1172749
	speed: 0.1921s/iter; left time: 2554.8690s
	iters: 400, epoch: 2 | loss: 0.3318764
	speed: 0.2256s/iter; left time: 2978.1787s
Epoch: 2 cost time: 100.85884404182434
Epoch: 2, Steps: 469 | Train Loss: 0.361 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
Validation loss decreased (-0.850193 --> -0.919380).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2910025
	speed: 0.6176s/iter; left time: 8049.2357s
	iters: 200, epoch: 3 | loss: 0.0911322
	speed: 0.1823s/iter; left time: 2357.5989s
	iters: 300, epoch: 3 | loss: 0.0991922
	speed: 0.1836s/iter; left time: 2356.5287s
	iters: 400, epoch: 3 | loss: 0.3204298
	speed: 0.1701s/iter; left time: 2165.6222s
Epoch: 3 cost time: 88.27753686904907
Epoch: 3, Steps: 469 | Train Loss: 0.168 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.919380 --> -0.959118).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2208490
	speed: 0.5174s/iter; left time: 6500.5556s
	iters: 200, epoch: 4 | loss: 0.1673768
	speed: 0.2374s/iter; left time: 2958.7795s
	iters: 300, epoch: 4 | loss: 0.0141918
	speed: 0.2279s/iter; left time: 2818.1920s
	iters: 400, epoch: 4 | loss: 0.1559245
	speed: 0.2413s/iter; left time: 2959.3286s
Epoch: 4 cost time: 106.98632860183716
Epoch: 4, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.959118 --> -0.968552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0865280
	speed: 0.5794s/iter; left time: 7007.5353s
	iters: 200, epoch: 5 | loss: 0.0346371
	speed: 0.2155s/iter; left time: 2585.2570s
	iters: 300, epoch: 5 | loss: 0.0321941
	speed: 0.2209s/iter; left time: 2627.6681s
	iters: 400, epoch: 5 | loss: 0.0708852
	speed: 0.2246s/iter; left time: 2649.2778s
Epoch: 5 cost time: 103.58186554908752
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0534666
	speed: 0.5669s/iter; left time: 6591.2760s
	iters: 200, epoch: 6 | loss: 0.0391115
	speed: 0.1950s/iter; left time: 2247.7351s
	iters: 300, epoch: 6 | loss: 0.0974381
	speed: 0.2269s/iter; left time: 2591.9908s
	iters: 400, epoch: 6 | loss: 0.0076389
	speed: 0.2175s/iter; left time: 2463.2393s
Epoch: 6 cost time: 98.9474458694458
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1701647
	speed: 0.6186s/iter; left time: 6901.7740s
	iters: 200, epoch: 7 | loss: 0.0153849
	speed: 0.2029s/iter; left time: 2243.0504s
	iters: 300, epoch: 7 | loss: 0.0939263
	speed: 0.2196s/iter; left time: 2405.6293s
	iters: 400, epoch: 7 | loss: 0.0061093
	speed: 0.2272s/iter; left time: 2466.9998s
Epoch: 7 cost time: 103.47863745689392
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.968838).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1246664
	speed: 0.6358s/iter; left time: 6795.4874s
	iters: 200, epoch: 8 | loss: 0.1062573
	speed: 0.2236s/iter; left time: 2367.7309s
	iters: 300, epoch: 8 | loss: 0.0216050
	speed: 0.1818s/iter; left time: 1907.0610s
	iters: 400, epoch: 8 | loss: 0.0104076
	speed: 0.1883s/iter; left time: 1955.9710s
Epoch: 8 cost time: 97.62669324874878
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0054536
	speed: 0.6108s/iter; left time: 6241.8583s
	iters: 200, epoch: 9 | loss: 0.1683509
	speed: 0.2252s/iter; left time: 2278.6975s
	iters: 300, epoch: 9 | loss: 0.0377647
	speed: 0.2131s/iter; left time: 2134.9578s
	iters: 400, epoch: 9 | loss: 0.0707294
	speed: 0.2043s/iter; left time: 2026.1362s
Epoch: 9 cost time: 100.07147526741028
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.968838 --> -0.972269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0124415
	speed: 0.5992s/iter; left time: 5842.2312s
	iters: 200, epoch: 10 | loss: 0.0027593
	speed: 0.2312s/iter; left time: 2230.6650s
	iters: 300, epoch: 10 | loss: 0.0091164
	speed: 0.2309s/iter; left time: 2204.6787s
	iters: 400, epoch: 10 | loss: 0.3932536
	speed: 0.1194s/iter; left time: 1128.7025s
Epoch: 10 cost time: 97.1786732673645
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.972269 --> -0.977987).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0017623
	speed: 0.5580s/iter; left time: 5179.2557s
	iters: 200, epoch: 11 | loss: 0.0065003
	speed: 0.2211s/iter; left time: 2029.9780s
	iters: 300, epoch: 11 | loss: 0.0232260
	speed: 0.2034s/iter; left time: 1846.9911s
	iters: 400, epoch: 11 | loss: 0.1192319
	speed: 0.2121s/iter; left time: 1904.9604s
Epoch: 11 cost time: 98.03349351882935
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0301221
	speed: 0.5427s/iter; left time: 4781.9497s
	iters: 200, epoch: 12 | loss: 0.0087361
	speed: 0.1687s/iter; left time: 1469.4476s
	iters: 300, epoch: 12 | loss: 0.0109411
	speed: 0.1980s/iter; left time: 1705.4733s
	iters: 400, epoch: 12 | loss: 0.0114135
	speed: 0.2084s/iter; left time: 1773.8982s
Epoch: 12 cost time: 88.88740229606628
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0077306
	speed: 0.5786s/iter; left time: 4827.1669s
	iters: 200, epoch: 13 | loss: 0.1132615
	speed: 0.1965s/iter; left time: 1619.9681s
	iters: 300, epoch: 13 | loss: 0.0052599
	speed: 0.1925s/iter; left time: 1567.5465s
	iters: 400, epoch: 13 | loss: 0.0026825
	speed: 0.1928s/iter; left time: 1550.3830s
Epoch: 13 cost time: 94.17551302909851
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0145289
	speed: 0.6105s/iter; left time: 4807.4648s
	iters: 200, epoch: 14 | loss: 0.6186743
	speed: 0.2222s/iter; left time: 1727.6795s
	iters: 300, epoch: 14 | loss: 0.0253463
	speed: 0.2153s/iter; left time: 1652.3829s
	iters: 400, epoch: 14 | loss: 0.2820342
	speed: 0.1535s/iter; left time: 1162.9563s
Epoch: 14 cost time: 86.04237771034241
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0072154
	speed: 0.4163s/iter; left time: 3082.8437s
	iters: 200, epoch: 15 | loss: 0.0041933
	speed: 0.2121s/iter; left time: 1549.1921s
	iters: 300, epoch: 15 | loss: 0.0326235
	speed: 0.2150s/iter; left time: 1549.2111s
	iters: 400, epoch: 15 | loss: 0.0121244
	speed: 0.2129s/iter; left time: 1512.5645s
Epoch: 15 cost time: 98.20796775817871
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.977987 --> -0.978272).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0061376
	speed: 0.5131s/iter; left time: 3558.6642s
	iters: 200, epoch: 16 | loss: 0.0013184
	speed: 0.2223s/iter; left time: 1519.5724s
	iters: 300, epoch: 16 | loss: 0.0054704
	speed: 0.2102s/iter; left time: 1415.9275s
	iters: 400, epoch: 16 | loss: 0.0037315
	speed: 0.2216s/iter; left time: 1470.7238s
Epoch: 16 cost time: 98.51217532157898
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978844).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0058467
	speed: 0.5942s/iter; left time: 3842.9820s
	iters: 200, epoch: 17 | loss: 0.0099270
	speed: 0.1902s/iter; left time: 1211.2301s
	iters: 300, epoch: 17 | loss: 0.0038245
	speed: 0.2305s/iter; left time: 1444.6882s
	iters: 400, epoch: 17 | loss: 0.0282297
	speed: 0.2218s/iter; left time: 1367.7161s
Epoch: 17 cost time: 100.78220438957214
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0010280
	speed: 0.6234s/iter; left time: 3739.4188s
	iters: 200, epoch: 18 | loss: 0.2907808
	speed: 0.1932s/iter; left time: 1139.3047s
	iters: 300, epoch: 18 | loss: 0.0049459
	speed: 0.1844s/iter; left time: 1069.4006s
	iters: 400, epoch: 18 | loss: 0.0008381
	speed: 0.1988s/iter; left time: 1132.8204s
Epoch: 18 cost time: 95.53152656555176
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0007563
	speed: 0.5888s/iter; left time: 3255.6846s
	iters: 200, epoch: 19 | loss: 0.0037248
	speed: 0.1483s/iter; left time: 805.2610s
	iters: 300, epoch: 19 | loss: 0.0014490
	speed: 0.1387s/iter; left time: 739.1830s
	iters: 400, epoch: 19 | loss: 0.0068460
	speed: 0.1578s/iter; left time: 825.1041s
Epoch: 19 cost time: 77.06095457077026
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0358672
	speed: 0.5353s/iter; left time: 2708.6107s
	iters: 200, epoch: 20 | loss: 0.0119025
	speed: 0.2111s/iter; left time: 1046.9758s
	iters: 300, epoch: 20 | loss: 0.0681063
	speed: 0.2142s/iter; left time: 1041.0189s
	iters: 400, epoch: 20 | loss: 0.0040736
	speed: 0.2101s/iter; left time: 1000.1247s
Epoch: 20 cost time: 96.62430238723755
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.980274).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0007227
	speed: 0.5112s/iter; left time: 2346.9335s
	iters: 200, epoch: 21 | loss: 0.0016411
	speed: 0.2120s/iter; left time: 951.9201s
	iters: 300, epoch: 21 | loss: 0.0007119
	speed: 0.2122s/iter; left time: 931.5685s
	iters: 400, epoch: 21 | loss: 0.0004236
	speed: 0.2048s/iter; left time: 878.6437s
Epoch: 21 cost time: 96.38001942634583
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0169144
	speed: 0.5013s/iter; left time: 2066.4796s
	iters: 200, epoch: 22 | loss: 0.0019122
	speed: 0.1729s/iter; left time: 695.4771s
	iters: 300, epoch: 22 | loss: 0.0176480
	speed: 0.1091s/iter; left time: 427.7042s
	iters: 400, epoch: 22 | loss: 0.0017737
	speed: 0.2018s/iter; left time: 771.3118s
Epoch: 22 cost time: 79.68456745147705
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.980274 --> -0.981417).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0008388
	speed: 0.6059s/iter; left time: 2213.3753s
	iters: 200, epoch: 23 | loss: 0.0013095
	speed: 0.1906s/iter; left time: 677.0318s
	iters: 300, epoch: 23 | loss: 0.0019562
	speed: 0.1990s/iter; left time: 687.2972s
	iters: 400, epoch: 23 | loss: 0.0005187
	speed: 0.2319s/iter; left time: 777.5536s
Epoch: 23 cost time: 99.81905150413513
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0038575
	speed: 0.6323s/iter; left time: 2013.0952s
	iters: 200, epoch: 24 | loss: 0.0116913
	speed: 0.2334s/iter; left time: 719.8699s
	iters: 300, epoch: 24 | loss: 0.1307465
	speed: 0.2060s/iter; left time: 614.7448s
	iters: 400, epoch: 24 | loss: 0.0022348
	speed: 0.2006s/iter; left time: 578.5324s
Epoch: 24 cost time: 102.27897024154663
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.983132).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0477311
	speed: 0.5595s/iter; left time: 1518.9868s
	iters: 200, epoch: 25 | loss: 0.0299557
	speed: 0.2388s/iter; left time: 624.3940s
	iters: 300, epoch: 25 | loss: 0.0014757
	speed: 0.2412s/iter; left time: 606.6740s
	iters: 400, epoch: 25 | loss: 0.0004478
	speed: 0.2402s/iter; left time: 580.1055s
Epoch: 25 cost time: 111.51934146881104
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0083141
	speed: 0.6474s/iter; left time: 1454.0289s
	iters: 200, epoch: 26 | loss: 0.0077344
	speed: 0.2402s/iter; left time: 515.4965s
	iters: 300, epoch: 26 | loss: 0.0030366
	speed: 0.2357s/iter; left time: 482.2431s
	iters: 400, epoch: 26 | loss: 0.0012125
	speed: 0.2363s/iter; left time: 459.8720s
Epoch: 26 cost time: 112.38953042030334
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0026197
	speed: 0.6589s/iter; left time: 1170.8689s
	iters: 200, epoch: 27 | loss: 0.0009654
	speed: 0.2464s/iter; left time: 413.2544s
	iters: 300, epoch: 27 | loss: 0.0075865
	speed: 0.2518s/iter; left time: 397.1130s
	iters: 400, epoch: 27 | loss: 0.0007392
	speed: 0.2479s/iter; left time: 366.2061s
Epoch: 27 cost time: 114.58222341537476
Epoch: 27, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0063806
	speed: 0.6227s/iter; left time: 814.5188s
	iters: 200, epoch: 28 | loss: 0.0359506
	speed: 0.2359s/iter; left time: 284.9579s
	iters: 300, epoch: 28 | loss: 0.0000733
	speed: 0.2261s/iter; left time: 250.4654s
	iters: 400, epoch: 28 | loss: 0.0015244
	speed: 0.2394s/iter; left time: 241.3183s
Epoch: 28 cost time: 110.45716738700867
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0034241
	speed: 0.6495s/iter; left time: 544.9402s
	iters: 200, epoch: 29 | loss: 0.0087164
	speed: 0.2374s/iter; left time: 175.4338s
	iters: 300, epoch: 29 | loss: 0.0004977
	speed: 0.2419s/iter; left time: 154.5766s
	iters: 400, epoch: 29 | loss: 0.0038719
	speed: 0.2404s/iter; left time: 129.5530s
Epoch: 29 cost time: 111.75617361068726
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0003184
	speed: 0.6510s/iter; left time: 240.8709s
	iters: 200, epoch: 30 | loss: 0.0026548
	speed: 0.2419s/iter; left time: 65.3151s
	iters: 300, epoch: 30 | loss: 0.0001976
	speed: 0.2418s/iter; left time: 41.1115s
	iters: 400, epoch: 30 | loss: 0.0013651
	speed: 0.2454s/iter; left time: 17.1773s
Epoch: 30 cost time: 114.68976378440857
Epoch: 30, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 147466
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0961225
	speed: 0.1803s/iter; left time: 2518.6618s
	iters: 200, epoch: 1 | loss: 1.6872835
	speed: 0.1614s/iter; left time: 2238.4576s
	iters: 300, epoch: 1 | loss: 1.2888461
	speed: 0.1620s/iter; left time: 2231.2720s
	iters: 400, epoch: 1 | loss: 0.9074265
	speed: 0.1585s/iter; left time: 2166.4593s
Epoch: 1 cost time: 77.29968404769897
Epoch: 1, Steps: 469 | Train Loss: 1.604 Vali Loss: 0.732 Vali Acc: 0.819 Test Loss: 0.732 Test Acc: 0.819
Validation loss decreased (inf --> -0.819318).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6400415
	speed: 0.5018s/iter; left time: 6774.7470s
	iters: 200, epoch: 2 | loss: 0.4453926
	speed: 0.1666s/iter; left time: 2233.2737s
	iters: 300, epoch: 2 | loss: 0.2194016
	speed: 0.1654s/iter; left time: 2200.6250s
	iters: 400, epoch: 2 | loss: 0.2920313
	speed: 0.1630s/iter; left time: 2152.1003s
Epoch: 2 cost time: 76.33011484146118
Epoch: 2, Steps: 469 | Train Loss: 0.413 Vali Loss: 0.250 Vali Acc: 0.909 Test Loss: 0.250 Test Acc: 0.909
Validation loss decreased (-0.819318 --> -0.908803).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1160278
	speed: 0.5132s/iter; left time: 6688.4226s
	iters: 200, epoch: 3 | loss: 0.0995160
	speed: 0.1662s/iter; left time: 2149.1237s
	iters: 300, epoch: 3 | loss: 0.2796903
	speed: 0.1641s/iter; left time: 2106.4005s
	iters: 400, epoch: 3 | loss: 0.1212163
	speed: 0.1604s/iter; left time: 2042.8782s
Epoch: 3 cost time: 77.03691935539246
Epoch: 3, Steps: 469 | Train Loss: 0.183 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
Validation loss decreased (-0.908803 --> -0.946253).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1124143
	speed: 0.5155s/iter; left time: 6476.5491s
	iters: 200, epoch: 4 | loss: 0.1190616
	speed: 0.1653s/iter; left time: 2060.5628s
	iters: 300, epoch: 4 | loss: 0.0149253
	speed: 0.1631s/iter; left time: 2016.2345s
	iters: 400, epoch: 4 | loss: 0.0100058
	speed: 0.1596s/iter; left time: 1957.2423s
Epoch: 4 cost time: 77.02435731887817
Epoch: 4, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.946253 --> -0.967695).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1869282
	speed: 0.5348s/iter; left time: 6468.7568s
	iters: 200, epoch: 5 | loss: 0.0921233
	speed: 0.1689s/iter; left time: 2025.7890s
	iters: 300, epoch: 5 | loss: 0.0320421
	speed: 0.1651s/iter; left time: 1963.9940s
	iters: 400, epoch: 5 | loss: 0.0578352
	speed: 0.1625s/iter; left time: 1917.0150s
Epoch: 5 cost time: 78.7543957233429
Epoch: 5, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0323927
	speed: 0.4207s/iter; left time: 4890.6123s
	iters: 200, epoch: 6 | loss: 0.1986771
	speed: 0.1445s/iter; left time: 1665.2297s
	iters: 300, epoch: 6 | loss: 0.0438646
	speed: 0.1535s/iter; left time: 1753.7972s
	iters: 400, epoch: 6 | loss: 0.0063538
	speed: 0.1566s/iter; left time: 1774.1521s
Epoch: 6 cost time: 71.22725868225098
Epoch: 6, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.967695 --> -0.970268).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0247712
	speed: 0.4878s/iter; left time: 5442.7556s
	iters: 200, epoch: 7 | loss: 0.0455242
	speed: 0.1627s/iter; left time: 1798.7592s
	iters: 300, epoch: 7 | loss: 0.0522919
	speed: 0.1550s/iter; left time: 1697.8255s
	iters: 400, epoch: 7 | loss: 0.0103743
	speed: 0.1595s/iter; left time: 1731.7531s
Epoch: 7 cost time: 74.30482697486877
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.970268 --> -0.970554).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0040840
	speed: 0.5021s/iter; left time: 5366.8959s
	iters: 200, epoch: 8 | loss: 0.0135563
	speed: 0.1538s/iter; left time: 1628.7797s
	iters: 300, epoch: 8 | loss: 0.0052249
	speed: 0.1623s/iter; left time: 1702.4740s
	iters: 400, epoch: 8 | loss: 0.0176491
	speed: 0.1503s/iter; left time: 1560.9461s
Epoch: 8 cost time: 74.32270574569702
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970554 --> -0.975700).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0073587
	speed: 0.5086s/iter; left time: 5197.2907s
	iters: 200, epoch: 9 | loss: 0.0721898
	speed: 0.1573s/iter; left time: 1592.1544s
	iters: 300, epoch: 9 | loss: 0.1209691
	speed: 0.1620s/iter; left time: 1623.1364s
	iters: 400, epoch: 9 | loss: 0.0229992
	speed: 0.1671s/iter; left time: 1657.1522s
Epoch: 9 cost time: 75.8415515422821
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0960829
	speed: 0.5141s/iter; left time: 5012.9611s
	iters: 200, epoch: 10 | loss: 0.1393249
	speed: 0.1690s/iter; left time: 1631.1306s
	iters: 300, epoch: 10 | loss: 0.0052842
	speed: 0.1586s/iter; left time: 1515.0944s
	iters: 400, epoch: 10 | loss: 0.0378653
	speed: 0.1546s/iter; left time: 1461.0720s
Epoch: 10 cost time: 75.01830053329468
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.975700 --> -0.978272).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0616544
	speed: 0.3980s/iter; left time: 3694.1748s
	iters: 200, epoch: 11 | loss: 0.0238107
	speed: 0.1325s/iter; left time: 1216.3928s
	iters: 300, epoch: 11 | loss: 0.0151364
	speed: 0.1596s/iter; left time: 1449.5586s
	iters: 400, epoch: 11 | loss: 0.0200154
	speed: 0.1680s/iter; left time: 1508.9589s
Epoch: 11 cost time: 65.4208390712738
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978272 --> -0.978272).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0227344
	speed: 0.5076s/iter; left time: 4473.2478s
	iters: 200, epoch: 12 | loss: 0.0055669
	speed: 0.1641s/iter; left time: 1429.6971s
	iters: 300, epoch: 12 | loss: 0.1251462
	speed: 0.1585s/iter; left time: 1364.8999s
	iters: 400, epoch: 12 | loss: 0.1965527
	speed: 0.1591s/iter; left time: 1354.3837s
Epoch: 12 cost time: 76.27104616165161
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0583861
	speed: 0.5146s/iter; left time: 4293.2245s
	iters: 200, epoch: 13 | loss: 0.0171711
	speed: 0.1591s/iter; left time: 1311.5384s
	iters: 300, epoch: 13 | loss: 0.0025380
	speed: 0.1651s/iter; left time: 1344.1067s
	iters: 400, epoch: 13 | loss: 0.0417973
	speed: 0.1655s/iter; left time: 1330.8250s
Epoch: 13 cost time: 76.40035390853882
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0023879
	speed: 0.5183s/iter; left time: 4081.2956s
	iters: 200, epoch: 14 | loss: 0.0028808
	speed: 0.1694s/iter; left time: 1317.1739s
	iters: 300, epoch: 14 | loss: 0.0457526
	speed: 0.1669s/iter; left time: 1280.8824s
	iters: 400, epoch: 14 | loss: 0.0132857
	speed: 0.1637s/iter; left time: 1239.6166s
Epoch: 14 cost time: 78.40026450157166
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0339352
	speed: 0.5302s/iter; left time: 3926.1253s
	iters: 200, epoch: 15 | loss: 0.0079607
	speed: 0.1514s/iter; left time: 1105.7745s
	iters: 300, epoch: 15 | loss: 0.0027501
	speed: 0.1574s/iter; left time: 1133.8219s
	iters: 400, epoch: 15 | loss: 0.0018311
	speed: 0.1607s/iter; left time: 1141.9503s
Epoch: 15 cost time: 74.75520968437195
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.981131).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0561874
	speed: 0.4897s/iter; left time: 3396.5937s
	iters: 200, epoch: 16 | loss: 0.0769653
	speed: 0.1701s/iter; left time: 1162.5596s
	iters: 300, epoch: 16 | loss: 0.0043478
	speed: 0.1671s/iter; left time: 1125.4880s
	iters: 400, epoch: 16 | loss: 0.0021736
	speed: 0.1588s/iter; left time: 1053.5963s
Epoch: 16 cost time: 76.15053248405457
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0218095
	speed: 0.5140s/iter; left time: 3323.7747s
	iters: 200, epoch: 17 | loss: 0.0057412
	speed: 0.1590s/iter; left time: 1012.5530s
	iters: 300, epoch: 17 | loss: 0.0029071
	speed: 0.1597s/iter; left time: 1000.8703s
	iters: 400, epoch: 17 | loss: 0.0018361
	speed: 0.1657s/iter; left time: 1021.7965s
Epoch: 17 cost time: 76.44441747665405
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.983133).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0006372
	speed: 0.5114s/iter; left time: 3067.4138s
	iters: 200, epoch: 18 | loss: 0.1864972
	speed: 0.1655s/iter; left time: 976.1096s
	iters: 300, epoch: 18 | loss: 0.0014661
	speed: 0.1655s/iter; left time: 959.3580s
	iters: 400, epoch: 18 | loss: 0.0105906
	speed: 0.1593s/iter; left time: 907.9218s
Epoch: 18 cost time: 76.42963552474976
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0893318
	speed: 0.4348s/iter; left time: 2404.2052s
	iters: 200, epoch: 19 | loss: 0.0042590
	speed: 0.1655s/iter; left time: 898.7700s
	iters: 300, epoch: 19 | loss: 0.0044951
	speed: 0.1586s/iter; left time: 845.1207s
	iters: 400, epoch: 19 | loss: 0.1339677
	speed: 0.1656s/iter; left time: 865.9732s
Epoch: 19 cost time: 70.54927182197571
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0075952
	speed: 0.4923s/iter; left time: 2491.2072s
	iters: 200, epoch: 20 | loss: 0.0023983
	speed: 0.1447s/iter; left time: 717.6995s
	iters: 300, epoch: 20 | loss: 0.0798057
	speed: 0.1542s/iter; left time: 749.3187s
	iters: 400, epoch: 20 | loss: 0.0562159
	speed: 0.1457s/iter; left time: 693.6765s
Epoch: 20 cost time: 70.95874381065369
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0028468
	speed: 0.5048s/iter; left time: 2317.6587s
	iters: 200, epoch: 21 | loss: 0.0023000
	speed: 0.1598s/iter; left time: 717.8269s
	iters: 300, epoch: 21 | loss: 0.0214609
	speed: 0.1543s/iter; left time: 677.4107s
	iters: 400, epoch: 21 | loss: 0.1555892
	speed: 0.1585s/iter; left time: 680.2998s
Epoch: 21 cost time: 74.1820707321167
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0028660
	speed: 0.4962s/iter; left time: 2045.2742s
	iters: 200, epoch: 22 | loss: 0.0014721
	speed: 0.1572s/iter; left time: 632.1012s
	iters: 300, epoch: 22 | loss: 0.0338683
	speed: 0.1586s/iter; left time: 622.1300s
	iters: 400, epoch: 22 | loss: 0.0004133
	speed: 0.1546s/iter; left time: 590.8396s
Epoch: 22 cost time: 73.6803207397461
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0403800
	speed: 0.4375s/iter; left time: 1598.1777s
	iters: 200, epoch: 23 | loss: 0.0047769
	speed: 0.1133s/iter; left time: 402.5547s
	iters: 300, epoch: 23 | loss: 0.0075539
	speed: 0.1646s/iter; left time: 568.3226s
	iters: 400, epoch: 23 | loss: 0.0050105
	speed: 0.1566s/iter; left time: 525.0595s
Epoch: 23 cost time: 64.194655418396
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0011225
	speed: 0.5082s/iter; left time: 1617.9849s
	iters: 200, epoch: 24 | loss: 0.1284318
	speed: 0.1685s/iter; left time: 519.7073s
	iters: 300, epoch: 24 | loss: 0.0004452
	speed: 0.1643s/iter; left time: 490.1471s
	iters: 400, epoch: 24 | loss: 0.0013320
	speed: 0.1518s/iter; left time: 437.8149s
Epoch: 24 cost time: 75.43993139266968
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0604738
	speed: 0.4887s/iter; left time: 1326.8701s
	iters: 200, epoch: 25 | loss: 0.0061486
	speed: 0.1574s/iter; left time: 411.5225s
	iters: 300, epoch: 25 | loss: 0.0038452
	speed: 0.1492s/iter; left time: 375.3598s
	iters: 400, epoch: 25 | loss: 0.0098114
	speed: 0.1652s/iter; left time: 398.8472s
Epoch: 25 cost time: 74.19353818893433
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0025459
	speed: 0.5184s/iter; left time: 1164.2457s
	iters: 200, epoch: 26 | loss: 0.0029900
	speed: 0.1578s/iter; left time: 338.6288s
	iters: 300, epoch: 26 | loss: 0.0412488
	speed: 0.1603s/iter; left time: 327.9212s
	iters: 400, epoch: 26 | loss: 0.0010985
	speed: 0.1614s/iter; left time: 314.0547s
Epoch: 26 cost time: 75.64903998374939
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1590534
	speed: 0.5015s/iter; left time: 891.1697s
	iters: 200, epoch: 27 | loss: 0.0016029
	speed: 0.1601s/iter; left time: 268.4135s
	iters: 300, epoch: 27 | loss: 0.0044010
	speed: 0.1635s/iter; left time: 257.7802s
	iters: 400, epoch: 27 | loss: 0.0001250
	speed: 0.1569s/iter; left time: 231.7627s
Epoch: 27 cost time: 74.84620356559753
Epoch: 27, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 43946
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.0292575
	speed: 0.0917s/iter; left time: 1281.6781s
	iters: 200, epoch: 1 | loss: 1.8606002
	speed: 0.1079s/iter; left time: 1497.3411s
	iters: 300, epoch: 1 | loss: 1.3044380
	speed: 0.1278s/iter; left time: 1759.5552s
	iters: 400, epoch: 1 | loss: 1.0344448
	speed: 0.1379s/iter; left time: 1884.5742s
Epoch: 1 cost time: 56.193830490112305
Epoch: 1, Steps: 469 | Train Loss: 1.609 Vali Loss: 0.769 Vali Acc: 0.826 Test Loss: 0.769 Test Acc: 0.826
Validation loss decreased (inf --> -0.826465).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6992126
	speed: 0.4520s/iter; left time: 6102.7621s
	iters: 200, epoch: 2 | loss: 0.5090846
	speed: 0.1286s/iter; left time: 1723.7756s
	iters: 300, epoch: 2 | loss: 0.1605885
	speed: 0.1295s/iter; left time: 1721.9635s
	iters: 400, epoch: 2 | loss: 0.3518546
	speed: 0.1252s/iter; left time: 1653.1264s
Epoch: 2 cost time: 59.87665390968323
Epoch: 2, Steps: 469 | Train Loss: 0.441 Vali Loss: 0.321 Vali Acc: 0.905 Test Loss: 0.321 Test Acc: 0.905
Validation loss decreased (-0.826465 --> -0.905085).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3427041
	speed: 0.4352s/iter; left time: 5672.5889s
	iters: 200, epoch: 3 | loss: 0.1839734
	speed: 0.1294s/iter; left time: 1673.5260s
	iters: 300, epoch: 3 | loss: 0.1733857
	speed: 0.1359s/iter; left time: 1743.6023s
	iters: 400, epoch: 3 | loss: 0.2883157
	speed: 0.1385s/iter; left time: 1763.6718s
Epoch: 3 cost time: 63.27408146858215
Epoch: 3, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.905085 --> -0.941107).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2037090
	speed: 0.4560s/iter; left time: 5729.4668s
	iters: 200, epoch: 4 | loss: 0.1623798
	speed: 0.0823s/iter; left time: 1026.3704s
	iters: 300, epoch: 4 | loss: 0.0342218
	speed: 0.0983s/iter; left time: 1215.7967s
	iters: 400, epoch: 4 | loss: 0.2433534
	speed: 0.1445s/iter; left time: 1771.7602s
Epoch: 4 cost time: 55.671433448791504
Epoch: 4, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.153 Vali Acc: 0.961 Test Loss: 0.153 Test Acc: 0.961
Validation loss decreased (-0.941107 --> -0.960547).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0664051
	speed: 0.4789s/iter; left time: 5792.4064s
	iters: 200, epoch: 5 | loss: 0.0354190
	speed: 0.1449s/iter; left time: 1738.1344s
	iters: 300, epoch: 5 | loss: 0.0396123
	speed: 0.1381s/iter; left time: 1642.8814s
	iters: 400, epoch: 5 | loss: 0.1695930
	speed: 0.1390s/iter; left time: 1638.9329s
Epoch: 5 cost time: 67.07858753204346
Epoch: 5, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.960547 --> -0.963406).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1021735
	speed: 0.4731s/iter; left time: 5499.7958s
	iters: 200, epoch: 6 | loss: 0.0188812
	speed: 0.1419s/iter; left time: 1635.6721s
	iters: 300, epoch: 6 | loss: 0.2629116
	speed: 0.1457s/iter; left time: 1664.2183s
	iters: 400, epoch: 6 | loss: 0.0151800
	speed: 0.1379s/iter; left time: 1561.3687s
Epoch: 6 cost time: 65.84819746017456
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1476217
	speed: 0.4820s/iter; left time: 5378.0800s
	iters: 200, epoch: 7 | loss: 0.0491162
	speed: 0.1364s/iter; left time: 1507.7076s
	iters: 300, epoch: 7 | loss: 0.0512764
	speed: 0.1366s/iter; left time: 1497.0606s
	iters: 400, epoch: 7 | loss: 0.0137361
	speed: 0.1408s/iter; left time: 1528.3543s
Epoch: 7 cost time: 65.67842721939087
Epoch: 7, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
Validation loss decreased (-0.963406 --> -0.966265).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0740395
	speed: 0.4571s/iter; left time: 4885.9480s
	iters: 200, epoch: 8 | loss: 0.2109428
	speed: 0.1375s/iter; left time: 1455.9041s
	iters: 300, epoch: 8 | loss: 0.0157735
	speed: 0.1388s/iter; left time: 1455.7387s
	iters: 400, epoch: 8 | loss: 0.0103560
	speed: 0.1465s/iter; left time: 1522.1252s
Epoch: 8 cost time: 66.9809877872467
Epoch: 8, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0054141
	speed: 0.4846s/iter; left time: 4951.8239s
	iters: 200, epoch: 9 | loss: 0.2864254
	speed: 0.1493s/iter; left time: 1510.6124s
	iters: 300, epoch: 9 | loss: 0.1031261
	speed: 0.1455s/iter; left time: 1457.5142s
	iters: 400, epoch: 9 | loss: 0.0652878
	speed: 0.1375s/iter; left time: 1363.9718s
Epoch: 9 cost time: 67.30069375038147
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.967123).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0197704
	speed: 0.4728s/iter; left time: 4609.6394s
	iters: 200, epoch: 10 | loss: 0.0052641
	speed: 0.1395s/iter; left time: 1346.2559s
	iters: 300, epoch: 10 | loss: 0.0077939
	speed: 0.1452s/iter; left time: 1387.1125s
	iters: 400, epoch: 10 | loss: 0.0939285
	speed: 0.1422s/iter; left time: 1343.7095s
Epoch: 10 cost time: 66.08852696418762
Epoch: 10, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.967123 --> -0.972269).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0112597
	speed: 0.4754s/iter; left time: 4411.7298s
	iters: 200, epoch: 11 | loss: 0.0115485
	speed: 0.1359s/iter; left time: 1247.8229s
	iters: 300, epoch: 11 | loss: 0.0056132
	speed: 0.1396s/iter; left time: 1267.5058s
	iters: 400, epoch: 11 | loss: 0.0524456
	speed: 0.1451s/iter; left time: 1302.9564s
Epoch: 11 cost time: 66.59952926635742
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0499970
	speed: 0.4774s/iter; left time: 4207.2821s
	iters: 200, epoch: 12 | loss: 0.0252072
	speed: 0.1445s/iter; left time: 1258.6891s
	iters: 300, epoch: 12 | loss: 0.0111827
	speed: 0.1343s/iter; left time: 1156.6039s
	iters: 400, epoch: 12 | loss: 0.0357977
	speed: 0.1338s/iter; left time: 1139.2903s
Epoch: 12 cost time: 65.82944989204407
Epoch: 12, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.972269 --> -0.975413).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0101516
	speed: 0.4596s/iter; left time: 3834.0760s
	iters: 200, epoch: 13 | loss: 0.0374510
	speed: 0.1404s/iter; left time: 1157.3830s
	iters: 300, epoch: 13 | loss: 0.0077425
	speed: 0.1385s/iter; left time: 1127.5405s
	iters: 400, epoch: 13 | loss: 0.0014355
	speed: 0.1385s/iter; left time: 1113.6151s
Epoch: 13 cost time: 65.15699505805969
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1257762
	speed: 0.4892s/iter; left time: 3851.7184s
	iters: 200, epoch: 14 | loss: 0.7023977
	speed: 0.1429s/iter; left time: 1111.0810s
	iters: 300, epoch: 14 | loss: 0.0120360
	speed: 0.1494s/iter; left time: 1146.5324s
	iters: 400, epoch: 14 | loss: 0.4408574
	speed: 0.1483s/iter; left time: 1123.4509s
Epoch: 14 cost time: 68.34185552597046
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0136284
	speed: 0.4072s/iter; left time: 3015.5882s
	iters: 200, epoch: 15 | loss: 0.0246188
	speed: 0.1161s/iter; left time: 847.8085s
	iters: 300, epoch: 15 | loss: 0.0623602
	speed: 0.1294s/iter; left time: 932.3704s
	iters: 400, epoch: 15 | loss: 0.0126237
	speed: 0.1372s/iter; left time: 974.6705s
Epoch: 15 cost time: 55.195847034454346
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.975413 --> -0.978844).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0128196
	speed: 0.4612s/iter; left time: 3199.1592s
	iters: 200, epoch: 16 | loss: 0.0016384
	speed: 0.1303s/iter; left time: 891.0660s
	iters: 300, epoch: 16 | loss: 0.0084086
	speed: 0.1343s/iter; left time: 904.7782s
	iters: 400, epoch: 16 | loss: 0.0016442
	speed: 0.1358s/iter; left time: 901.1829s
Epoch: 16 cost time: 63.42978835105896
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0024659
	speed: 0.4541s/iter; left time: 2936.3599s
	iters: 200, epoch: 17 | loss: 0.0329253
	speed: 0.1292s/iter; left time: 822.8440s
	iters: 300, epoch: 17 | loss: 0.0052721
	speed: 0.1394s/iter; left time: 873.6712s
	iters: 400, epoch: 17 | loss: 0.0966965
	speed: 0.1225s/iter; left time: 755.3306s
Epoch: 17 cost time: 62.16680288314819
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0022702
	speed: 0.4244s/iter; left time: 2545.4328s
	iters: 200, epoch: 18 | loss: 0.3657189
	speed: 0.1287s/iter; left time: 759.0082s
	iters: 300, epoch: 18 | loss: 0.0013223
	speed: 0.1316s/iter; left time: 763.2092s
	iters: 400, epoch: 18 | loss: 0.0015277
	speed: 0.1239s/iter; left time: 706.1899s
Epoch: 18 cost time: 59.439621925354004
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0010541
	speed: 0.4379s/iter; left time: 2421.0447s
	iters: 200, epoch: 19 | loss: 0.0285644
	speed: 0.0797s/iter; left time: 432.7098s
	iters: 300, epoch: 19 | loss: 0.0075432
	speed: 0.0527s/iter; left time: 280.9158s
	iters: 400, epoch: 19 | loss: 0.0168123
	speed: 0.1307s/iter; left time: 683.4066s
Epoch: 19 cost time: 47.80112147331238
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1134501
	speed: 0.4452s/iter; left time: 2252.6605s
	iters: 200, epoch: 20 | loss: 0.0240726
	speed: 0.1188s/iter; left time: 589.2963s
	iters: 300, epoch: 20 | loss: 0.0400618
	speed: 0.0617s/iter; left time: 300.0294s
	iters: 400, epoch: 20 | loss: 0.0017592
	speed: 0.0739s/iter; left time: 351.5701s
Epoch: 20 cost time: 48.82921290397644
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.978844).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0027873
	speed: 0.4535s/iter; left time: 2081.9784s
	iters: 200, epoch: 21 | loss: 0.0035070
	speed: 0.1180s/iter; left time: 529.7674s
	iters: 300, epoch: 21 | loss: 0.0013043
	speed: 0.1066s/iter; left time: 468.1729s
	iters: 400, epoch: 21 | loss: 0.0022943
	speed: 0.1148s/iter; left time: 492.4060s
Epoch: 21 cost time: 55.762136459350586
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0667289
	speed: 0.4422s/iter; left time: 1822.6585s
	iters: 200, epoch: 22 | loss: 0.0007307
	speed: 0.1274s/iter; left time: 512.5952s
	iters: 300, epoch: 22 | loss: 0.1627417
	speed: 0.1253s/iter; left time: 491.3400s
	iters: 400, epoch: 22 | loss: 0.0022156
	speed: 0.1383s/iter; left time: 528.7408s
Epoch: 22 cost time: 62.45538330078125
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0002878
	speed: 0.4557s/iter; left time: 1664.6582s
	iters: 200, epoch: 23 | loss: 0.0020317
	speed: 0.1288s/iter; left time: 457.5978s
	iters: 300, epoch: 23 | loss: 0.0012452
	speed: 0.1286s/iter; left time: 444.0963s
	iters: 400, epoch: 23 | loss: 0.0009755
	speed: 0.1179s/iter; left time: 395.3313s
Epoch: 23 cost time: 58.50138306617737
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.981131).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0058038
	speed: 0.4241s/iter; left time: 1350.2965s
	iters: 200, epoch: 24 | loss: 0.0113564
	speed: 0.1333s/iter; left time: 411.0120s
	iters: 300, epoch: 24 | loss: 0.0102496
	speed: 0.1399s/iter; left time: 417.5737s
	iters: 400, epoch: 24 | loss: 0.0029583
	speed: 0.1334s/iter; left time: 384.7236s
Epoch: 24 cost time: 63.766316652297974
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1172951
	speed: 0.4628s/iter; left time: 1256.4539s
	iters: 200, epoch: 25 | loss: 0.0606938
	speed: 0.1417s/iter; left time: 370.6561s
	iters: 300, epoch: 25 | loss: 0.0043480
	speed: 0.1335s/iter; left time: 335.6734s
	iters: 400, epoch: 25 | loss: 0.0042443
	speed: 0.1273s/iter; left time: 307.4804s
Epoch: 25 cost time: 62.882185220718384
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0225444
	speed: 0.4138s/iter; left time: 929.4655s
	iters: 200, epoch: 26 | loss: 0.0142088
	speed: 0.1288s/iter; left time: 276.4372s
	iters: 300, epoch: 26 | loss: 0.0034646
	speed: 0.1287s/iter; left time: 263.3978s
	iters: 400, epoch: 26 | loss: 0.0006202
	speed: 0.1375s/iter; left time: 267.6455s
Epoch: 26 cost time: 61.554810523986816
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0110824
	speed: 0.4498s/iter; left time: 799.3118s
	iters: 200, epoch: 27 | loss: 0.0020601
	speed: 0.1222s/iter; left time: 204.9145s
	iters: 300, epoch: 27 | loss: 0.0045018
	speed: 0.1387s/iter; left time: 218.7367s
	iters: 400, epoch: 27 | loss: 0.0008339
	speed: 0.1354s/iter; left time: 199.9666s
Epoch: 27 cost time: 62.155190229415894
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0024485
	speed: 0.3981s/iter; left time: 520.6704s
	iters: 200, epoch: 28 | loss: 0.0673491
	speed: 0.1123s/iter; left time: 135.6030s
	iters: 300, epoch: 28 | loss: 0.0080163
	speed: 0.1367s/iter; left time: 151.4107s
	iters: 400, epoch: 28 | loss: 0.0017830
	speed: 0.1297s/iter; left time: 130.7156s
Epoch: 28 cost time: 57.58958411216736
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0034860
	speed: 0.3711s/iter; left time: 311.3520s
	iters: 200, epoch: 29 | loss: 0.0057693
	speed: 0.1304s/iter; left time: 96.3857s
	iters: 300, epoch: 29 | loss: 0.0008076
	speed: 0.1256s/iter; left time: 80.2268s
	iters: 400, epoch: 29 | loss: 0.0036688
	speed: 0.1223s/iter; left time: 65.9063s
Epoch: 29 cost time: 60.21745586395264
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0008314
	speed: 0.4112s/iter; left time: 152.1551s
	iters: 200, epoch: 30 | loss: 0.0617223
	speed: 0.0999s/iter; left time: 26.9696s
	iters: 300, epoch: 30 | loss: 0.0017143
	speed: 0.1091s/iter; left time: 18.5510s
	iters: 400, epoch: 30 | loss: 0.0008259
	speed: 0.1251s/iter; left time: 8.7601s
Epoch: 30 cost time: 53.39785671234131
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 147466
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 2.1015584
	speed: 0.1100s/iter; left time: 1537.3246s
	iters: 200, epoch: 1 | loss: 1.7061635
	speed: 0.0889s/iter; left time: 1233.6468s
	iters: 300, epoch: 1 | loss: 1.4061260
	speed: 0.0923s/iter; left time: 1271.5439s
	iters: 400, epoch: 1 | loss: 0.9744328
	speed: 0.0890s/iter; left time: 1216.4668s
Epoch: 1 cost time: 44.43087577819824
Epoch: 1, Steps: 469 | Train Loss: 1.663 Vali Loss: 0.834 Vali Acc: 0.801 Test Loss: 0.834 Test Acc: 0.801
Validation loss decreased (inf --> -0.800735).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7539337
	speed: 0.3501s/iter; left time: 4726.7610s
	iters: 200, epoch: 2 | loss: 0.5239593
	speed: 0.0840s/iter; left time: 1126.0957s
	iters: 300, epoch: 2 | loss: 0.2795240
	speed: 0.0710s/iter; left time: 944.7223s
	iters: 400, epoch: 2 | loss: 0.3236260
	speed: 0.0824s/iter; left time: 1087.9432s
Epoch: 2 cost time: 36.563151836395264
Epoch: 2, Steps: 469 | Train Loss: 0.497 Vali Loss: 0.329 Vali Acc: 0.883 Test Loss: 0.329 Test Acc: 0.883
Validation loss decreased (-0.800735 --> -0.882787).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1480143
	speed: 0.3467s/iter; left time: 4519.1751s
	iters: 200, epoch: 3 | loss: 0.1012993
	speed: 0.0940s/iter; left time: 1216.0944s
	iters: 300, epoch: 3 | loss: 0.3363984
	speed: 0.0877s/iter; left time: 1125.0430s
	iters: 400, epoch: 3 | loss: 0.2004256
	speed: 0.0920s/iter; left time: 1171.8239s
Epoch: 3 cost time: 42.5446240901947
Epoch: 3, Steps: 469 | Train Loss: 0.236 Vali Loss: 0.200 Vali Acc: 0.934 Test Loss: 0.200 Test Acc: 0.934
Validation loss decreased (-0.882787 --> -0.933960).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2156866
	speed: 0.3593s/iter; left time: 4514.6938s
	iters: 200, epoch: 4 | loss: 0.1627783
	speed: 0.0859s/iter; left time: 1071.0567s
	iters: 300, epoch: 4 | loss: 0.0167259
	speed: 0.0950s/iter; left time: 1174.8898s
	iters: 400, epoch: 4 | loss: 0.0302988
	speed: 0.0866s/iter; left time: 1062.1249s
Epoch: 4 cost time: 40.03108024597168
Epoch: 4, Steps: 469 | Train Loss: 0.159 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.933960 --> -0.960547).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1620499
	speed: 0.2403s/iter; left time: 2907.0281s
	iters: 200, epoch: 5 | loss: 0.1412897
	speed: 0.0820s/iter; left time: 983.0376s
	iters: 300, epoch: 5 | loss: 0.0788874
	speed: 0.0863s/iter; left time: 1026.5347s
	iters: 400, epoch: 5 | loss: 0.0510341
	speed: 0.0954s/iter; left time: 1125.2844s
Epoch: 5 cost time: 41.453712701797485
Epoch: 5, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0810813
	speed: 0.3863s/iter; left time: 4490.9677s
	iters: 200, epoch: 6 | loss: 0.1556989
	speed: 0.1017s/iter; left time: 1171.7582s
	iters: 300, epoch: 6 | loss: 0.0713450
	speed: 0.0916s/iter; left time: 1046.3864s
	iters: 400, epoch: 6 | loss: 0.0123881
	speed: 0.1024s/iter; left time: 1159.4293s
Epoch: 6 cost time: 46.49052381515503
Epoch: 6, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.960547 --> -0.965122).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0950473
	speed: 0.3836s/iter; left time: 4280.2604s
	iters: 200, epoch: 7 | loss: 0.0638034
	speed: 0.0987s/iter; left time: 1090.9830s
	iters: 300, epoch: 7 | loss: 0.1179056
	speed: 0.1006s/iter; left time: 1102.5085s
	iters: 400, epoch: 7 | loss: 0.0099100
	speed: 0.0853s/iter; left time: 926.5504s
Epoch: 7 cost time: 44.71312642097473
Epoch: 7, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0074863
	speed: 0.3471s/iter; left time: 3709.5378s
	iters: 200, epoch: 8 | loss: 0.0825794
	speed: 0.0782s/iter; left time: 827.5321s
	iters: 300, epoch: 8 | loss: 0.0071809
	speed: 0.1009s/iter; left time: 1058.5632s
	iters: 400, epoch: 8 | loss: 0.0329497
	speed: 0.0920s/iter; left time: 956.0270s
Epoch: 8 cost time: 42.48048973083496
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.965122 --> -0.974842).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0076417
	speed: 0.3793s/iter; left time: 3876.5212s
	iters: 200, epoch: 9 | loss: 0.0369691
	speed: 0.0958s/iter; left time: 969.6276s
	iters: 300, epoch: 9 | loss: 0.1989210
	speed: 0.0906s/iter; left time: 907.5758s
	iters: 400, epoch: 9 | loss: 0.0097626
	speed: 0.0997s/iter; left time: 988.6627s
Epoch: 9 cost time: 44.73419260978699
Epoch: 9, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0772350
	speed: 0.3701s/iter; left time: 3608.2300s
	iters: 200, epoch: 10 | loss: 0.1890171
	speed: 0.0934s/iter; left time: 901.6873s
	iters: 300, epoch: 10 | loss: 0.0224747
	speed: 0.0769s/iter; left time: 734.6989s
	iters: 400, epoch: 10 | loss: 0.1610725
	speed: 0.0793s/iter; left time: 749.0927s
Epoch: 10 cost time: 40.408238649368286
Epoch: 10, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0404882
	speed: 0.3562s/iter; left time: 3306.1364s
	iters: 200, epoch: 11 | loss: 0.0084025
	speed: 0.0945s/iter; left time: 867.4782s
	iters: 300, epoch: 11 | loss: 0.0226716
	speed: 0.0996s/iter; left time: 904.6986s
	iters: 400, epoch: 11 | loss: 0.0554635
	speed: 0.0929s/iter; left time: 834.6918s
Epoch: 11 cost time: 44.14288806915283
Epoch: 11, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0079835
	speed: 0.2801s/iter; left time: 2467.8816s
	iters: 200, epoch: 12 | loss: 0.0156874
	speed: 0.0877s/iter; left time: 763.8555s
	iters: 300, epoch: 12 | loss: 0.1938346
	speed: 0.0883s/iter; left time: 760.0849s
	iters: 400, epoch: 12 | loss: 0.0372443
	speed: 0.0820s/iter; left time: 698.3850s
Epoch: 12 cost time: 41.20804953575134
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0950866
	speed: 0.3263s/iter; left time: 2722.6052s
	iters: 200, epoch: 13 | loss: 0.0266388
	speed: 0.0679s/iter; left time: 559.7271s
	iters: 300, epoch: 13 | loss: 0.0077425
	speed: 0.0653s/iter; left time: 532.0208s
	iters: 400, epoch: 13 | loss: 0.0475738
	speed: 0.0561s/iter; left time: 451.0849s
Epoch: 13 cost time: 31.341960430145264
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975699).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0039620
	speed: 0.3043s/iter; left time: 2396.3030s
	iters: 200, epoch: 14 | loss: 0.0068261
	speed: 0.0815s/iter; left time: 633.8478s
	iters: 300, epoch: 14 | loss: 0.0123323
	speed: 0.0971s/iter; left time: 745.1019s
	iters: 400, epoch: 14 | loss: 0.0451540
	speed: 0.0965s/iter; left time: 730.7473s
Epoch: 14 cost time: 41.317564487457275
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977129).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0371681
	speed: 0.3842s/iter; left time: 2844.6365s
	iters: 200, epoch: 15 | loss: 0.0294513
	speed: 0.0956s/iter; left time: 698.6334s
	iters: 300, epoch: 15 | loss: 0.0050451
	speed: 0.0926s/iter; left time: 666.9205s
	iters: 400, epoch: 15 | loss: 0.0130669
	speed: 0.0976s/iter; left time: 693.2369s
Epoch: 15 cost time: 45.114537715911865
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979702).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0566059
	speed: 0.2977s/iter; left time: 2064.7482s
	iters: 200, epoch: 16 | loss: 0.0145853
	speed: 0.0435s/iter; left time: 297.4655s
	iters: 300, epoch: 16 | loss: 0.0116470
	speed: 0.0347s/iter; left time: 233.4292s
	iters: 400, epoch: 16 | loss: 0.0085417
	speed: 0.0906s/iter; left time: 601.1447s
Epoch: 16 cost time: 30.022963047027588
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981703).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2097620
	speed: 0.4082s/iter; left time: 2640.1141s
	iters: 200, epoch: 17 | loss: 0.0034780
	speed: 0.0995s/iter; left time: 633.7714s
	iters: 300, epoch: 17 | loss: 0.0068596
	speed: 0.0909s/iter; left time: 569.9564s
	iters: 400, epoch: 17 | loss: 0.0017655
	speed: 0.1035s/iter; left time: 638.0226s
Epoch: 17 cost time: 47.0656304359436
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0007531
	speed: 0.3944s/iter; left time: 2365.6189s
	iters: 200, epoch: 18 | loss: 0.0453731
	speed: 0.0946s/iter; left time: 558.1359s
	iters: 300, epoch: 18 | loss: 0.0006562
	speed: 0.0965s/iter; left time: 559.6047s
	iters: 400, epoch: 18 | loss: 0.0151703
	speed: 0.0890s/iter; left time: 507.2530s
Epoch: 18 cost time: 44.64393925666809
Epoch: 18, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1081519
	speed: 0.3528s/iter; left time: 1950.8107s
	iters: 200, epoch: 19 | loss: 0.0070371
	speed: 0.0911s/iter; left time: 494.6677s
	iters: 300, epoch: 19 | loss: 0.0288488
	speed: 0.1034s/iter; left time: 550.8472s
	iters: 400, epoch: 19 | loss: 0.2038649
	speed: 0.1004s/iter; left time: 524.8081s
Epoch: 19 cost time: 45.42613196372986
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982561).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0069198
	speed: 0.3877s/iter; left time: 1961.8629s
	iters: 200, epoch: 20 | loss: 0.0042873
	speed: 0.1022s/iter; left time: 506.8280s
	iters: 300, epoch: 20 | loss: 0.0084050
	speed: 0.1097s/iter; left time: 533.0087s
	iters: 400, epoch: 20 | loss: 0.1309052
	speed: 0.1033s/iter; left time: 491.6147s
Epoch: 20 cost time: 48.42276906967163
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0047773
	speed: 0.4093s/iter; left time: 1879.1329s
	iters: 200, epoch: 21 | loss: 0.0109791
	speed: 0.0912s/iter; left time: 409.5522s
	iters: 300, epoch: 21 | loss: 0.1687352
	speed: 0.0973s/iter; left time: 427.3609s
	iters: 400, epoch: 21 | loss: 0.1490010
	speed: 0.0868s/iter; left time: 372.3873s
Epoch: 21 cost time: 43.73598575592041
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0043712
	speed: 0.3907s/iter; left time: 1610.4930s
	iters: 200, epoch: 22 | loss: 0.0065090
	speed: 0.1095s/iter; left time: 440.3443s
	iters: 300, epoch: 22 | loss: 0.2865449
	speed: 0.1062s/iter; left time: 416.4055s
	iters: 400, epoch: 22 | loss: 0.0006645
	speed: 0.0981s/iter; left time: 374.8116s
Epoch: 22 cost time: 49.40397882461548
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0465586
	speed: 0.3945s/iter; left time: 1441.1898s
	iters: 200, epoch: 23 | loss: 0.0095275
	speed: 0.1031s/iter; left time: 366.1448s
	iters: 300, epoch: 23 | loss: 0.0099434
	speed: 0.0952s/iter; left time: 328.7158s
	iters: 400, epoch: 23 | loss: 0.0141917
	speed: 0.0934s/iter; left time: 313.2703s
Epoch: 23 cost time: 44.143662452697754
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0024425
	speed: 0.2576s/iter; left time: 820.2884s
	iters: 200, epoch: 24 | loss: 0.1355781
	speed: 0.0760s/iter; left time: 234.4247s
	iters: 300, epoch: 24 | loss: 0.0024859
	speed: 0.0708s/iter; left time: 211.4092s
	iters: 400, epoch: 24 | loss: 0.0319830
	speed: 0.0833s/iter; left time: 240.3686s
Epoch: 24 cost time: 36.45728135108948
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0592958
	speed: 0.3624s/iter; left time: 983.9630s
	iters: 200, epoch: 25 | loss: 0.0033982
	speed: 0.0923s/iter; left time: 241.2438s
	iters: 300, epoch: 25 | loss: 0.0073494
	speed: 0.0944s/iter; left time: 237.3844s
	iters: 400, epoch: 25 | loss: 0.0511536
	speed: 0.0854s/iter; left time: 206.2484s
Epoch: 25 cost time: 43.20409870147705
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0005549
	speed: 0.3778s/iter; left time: 848.6406s
	iters: 200, epoch: 26 | loss: 0.0012446
	speed: 0.0961s/iter; left time: 206.1828s
	iters: 300, epoch: 26 | loss: 0.0019364
	speed: 0.0975s/iter; left time: 199.5042s
	iters: 400, epoch: 26 | loss: 0.0065518
	speed: 0.0959s/iter; left time: 186.6597s
Epoch: 26 cost time: 44.618685483932495
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.3494580
	speed: 0.3325s/iter; left time: 590.8781s
	iters: 200, epoch: 27 | loss: 0.0029162
	speed: 0.0910s/iter; left time: 152.6557s
	iters: 300, epoch: 27 | loss: 0.0211312
	speed: 0.0920s/iter; left time: 145.0083s
	iters: 400, epoch: 27 | loss: 0.0002462
	speed: 0.0566s/iter; left time: 83.5808s
Epoch: 27 cost time: 36.135682821273804
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0025120
	speed: 0.3669s/iter; left time: 479.9305s
	iters: 200, epoch: 28 | loss: 0.0056476
	speed: 0.1073s/iter; left time: 129.5883s
	iters: 300, epoch: 28 | loss: 0.1155322
	speed: 0.1010s/iter; left time: 111.8733s
	iters: 400, epoch: 28 | loss: 0.0016837
	speed: 0.1052s/iter; left time: 106.0357s
Epoch: 28 cost time: 49.1422438621521
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0032722
	speed: 0.3857s/iter; left time: 323.6224s
	iters: 200, epoch: 29 | loss: 0.0005972
	speed: 0.0923s/iter; left time: 68.2006s
	iters: 300, epoch: 29 | loss: 0.0003132
	speed: 0.0881s/iter; left time: 56.2646s
	iters: 400, epoch: 29 | loss: 0.0027961
	speed: 0.0746s/iter; left time: 40.1934s
Epoch: 29 cost time: 41.32994866371155
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_TimesNet_UEA_ftM_sl8_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 43946
model size : 0.33MB
